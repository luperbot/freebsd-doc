<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>2.5. Parallelism</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="PMake &#8212; A Tutorial" /><link rel="up" href="basics.html" title="Chapter 2. The Basics of PMake" /><link rel="prev" href="comments.html" title="2.4. Comments" /><link rel="next" href="writeanddebug.html" title="2.6. Writing and Debugging a Makefile" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2.5. Parallelism</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="comments.html">Prev</a> </td><th width="60%" align="center">Chapter 2. The Basics of PMake</th><td width="20%" align="right"> <a accesskey="n" href="writeanddebug.html">Next</a></td></tr></table><hr /></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="parellelism"></a>2.5. Parallelism</h2></div></div></div><p><span class="application">PMake</span> was specifically designed
      to re-create several targets at once, when possible. You do not
      have to do anything special to cause this to happen (unless
      <span class="application">PMake</span> was configured to not act in
      parallel, in which case you will have to make use of the
      <code class="option">-L</code> and <code class="option">-J</code> flags (see below)),
      but you do have to be careful at times.</p><p>There are several problems you are likely to encounter.  One
      is that some makefiles (and programs) are written in such a way
      that it is impossible for two targets to be made at once.  The
      program <span class="application">xstr</span>, for example, always
      modifies the files <code class="filename">strings</code> and
      <code class="filename">x.c</code>.  There is no way to change it.  Thus
      you cannot run two of them at once without something being
      trashed.  Similarly, if you have commands in the makefile that
      always send output to the same file, you will not be able to
      make more than one target at once unless you change the file you
      use.  You can, for instance, add a <code class="literal">$$$$</code> to
      the end of the file name to tack on the process ID of the shell
      executing the command (each <code class="literal">$$</code> expands to a
      single <code class="literal">$</code>, thus giving you the shell variable
      <code class="literal">$$</code>).  Since only one shell is used for all
      the commands, you will get the same file name for each command
      in the script.</p><p>The other problem comes from improperly-specified
      dependencies that worked in <span class="application">Make</span>
      because of its sequential, depth-first way of examining them.
      While I do not want to go into depth on how
      <span class="application">PMake</span> works (look in <a class="xref" href="gods.html" title="Chapter 4. PMake for Gods">Chapter 4, <em>PMake for Gods</em></a> if you are interested), I will warn you that
      files in two different levels of the dependency tree may be
      examined in a different order in
      <span class="application">PMake</span> than they were in
      <span class="application">Make</span>.
      For example, given the makefile:</p><pre class="programlisting">a               :

b c b           : d</pre><p><span class="application">PMake</span> will examine the targets in
      the order <code class="buildtarget">c</code>,
      <code class="buildtarget">d</code>, <code class="buildtarget">b</code>,
      <code class="buildtarget">a</code>.  If the makefile's author expected
      <span class="application">PMake</span> to abort before making
      <code class="buildtarget">c</code> if an error occurred while making
      <code class="buildtarget">b</code>, or if <code class="buildtarget">b</code>
      needed to exist before <code class="buildtarget">c</code> was made,
      (s)he will be sorely disappointed.  The dependencies are
      incomplete, since in both these cases,
      <code class="buildtarget">c</code> would depend on
      <code class="buildtarget">b</code>.  So watch out.</p><p>Another problem you may face is that, while
      <span class="application">PMake</span> is set up to handle the output
      from multiple jobs in a graceful fashion, the same is not so for
      input.  It has no way to regulate input to different jobs, so if
      you use the redirection from <code class="filename">/dev/tty</code> I
      mentioned earlier, you must be careful not to run two of the
      jobs at once.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="comments.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="basics.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="writeanddebug.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">2.4. Comments </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 2.6. Writing and Debugging a Makefile</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>