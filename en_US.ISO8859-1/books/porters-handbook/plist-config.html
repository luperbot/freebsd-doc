<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>7.3. Configuration Files</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD Porter's Handbook" /><link rel="up" href="plist.html" title="Chapter 7. Advanced pkg-plist Practices" /><link rel="prev" href="plist-cleaning.html" title="7.2. Empty Directories" /><link rel="next" href="plist-dynamic.html" title="7.4. Dynamic Versus Static Package List" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7.3. Configuration Files</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="plist-cleaning.html">Prev</a> </td><th width="60%" align="center">Chapter 7. Advanced <code class="filename">pkg-plist</code> Practices</th><td width="20%" align="right"> <a accesskey="n" href="plist-dynamic.html">Next</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="plist-config"></a>7.3. Configuration Files</h2></div></div></div><p>If the port installs configuration files to
      <code class="filename">PREFIX/etc</code> (or elsewhere) do
      <span class="emphasis"><em>not</em></span> list them in
      <code class="filename">pkg-plist</code>.  That will cause
      <code class="command">pkg delete</code> to remove files that have been carefully
      edited by the user, and a re-installation will wipe them
      out.</p><p>Instead, install sample files with a
      <code class="filename"><em class="replaceable"><code>filename</code></em>.sample</code>
      extension. The <code class="literal">@sample</code> macro automates this,
      see <a class="xref" href="plist-keywords.html#plist-keywords-sample" title="7.6.7. @sample file">Section 7.6.7, &#8220;<code class="literal">@sample</code>
	<em class="replaceable"><code>file</code></em>&#8221;</a> for what it does
      exactly.  For each sample file, add a line to
      <code class="filename">pkg-plist</code>:</p><pre class="programlisting">@sample etc/orbit.conf.sample</pre><p>If there is a very good reason not to install a working
      configuration file by default, only list the sample filename in
      <code class="filename">pkg-plist</code>, without the <code class="literal">@sample
	</code> part, and add a <a class="link" href="pkg-files.html#porting-message" title="8.1. pkg-message">message</a> pointing out that the
      user must copy and edit the file before the software will
      work.</p><div xmlns="" class="tip"><h3 class="admontitle">Tip: </h3><p xmlns="http://www.w3.org/1999/xhtml">When a port installs its configuration in a subdirectory
	of <code class="filename">${PREFIX}/etc</code>, use
	<code class="varname">ETCDIR</code>, which defaults to
	<code class="literal">${PREFIX}/etc/${PORTNAME}</code>, it can be
	overridden in the ports <code class="filename">Makefile</code> if there
	is a convention for the port to use some other directory.  The
	<code class="literal">%%ETCDIR%%</code> macro will be used in its
	stead in <code class="filename">pkg-plist</code>.</p></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The sample configuration files should always have the
	<code class="filename">.sample</code> suffix.  If for some historical
	reason using the standard suffix is not possible, use
	this construct:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">@unexec if cmp -s %D/etc/orbit.conf-dist %D/etc/orbit.conf; then rm -f %D/etc/orbit.conf; fi
etc/orbit.conf-dist
@exec if [ ! -f %D/etc/orbit.conf ] ; then cp -p %D/%F %B/orbit.conf; fi</pre><p xmlns="http://www.w3.org/1999/xhtml">The order of these lines is important.  On deinstallation,
	the sample file is compared to the actual configuration file.
	If these files are identical, no changes have been made by the
	user and the actual file can be safely deleted.  Because the
	sample file must still exist for the comparison, the
	<code class="literal">@unexec</code> line comes before the sample
	configuration file name.  On installation, if an actual
	configuration file is not already present, the sample file is
	copied to the actual file.  The sample file must be present
	before it can be copied, so the <code class="literal">@exec</code> line
	comes after the sample configuration file name.</p><p xmlns="http://www.w3.org/1999/xhtml">To debug any issues, temporarily remove the
	<code class="literal">-s</code> flag to <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cmp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">cmp</span>(1)</span></a> for more
	output.</p><p xmlns="http://www.w3.org/1999/xhtml">See <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg-create&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pkg-create</span>(8)</span></a> for more information on
	<code class="literal">%D</code> and related substitution markers.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="plist-cleaning.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="plist.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="plist-dynamic.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">7.2. Empty Directories </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 7.4. Dynamic Versus Static Package List</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>