<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>3. 准备工作 - mfsBSD</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 操作系统在无远程控制台下的远程安装" /><link rel="up" href="index.html" title="FreeBSD 操作系统在无远程控制台下的远程安装" /><link rel="prev" href="intro.html" title="2. 简介" /><link rel="next" href="installation.html" title="4. FreeBSD 操作系统的安装" /><link rel="copyright" href="trademarks.html" title="法律通告" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3. 准备工作 - <span class="application">mfsBSD</span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="intro.html">上一页</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="installation.html">下一页</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="preparation"></a>3. 准备工作 - <span class="application">mfsBSD</span></h2></div></div></div><p>在 FreeBSD 可能安装到目标系统上之前，
      需要先构建一个最小化的从磁盘启动的 FreeBSD 操作系统映像文件。
      此方法中新系统必须能够从网络访问，
      并且安装的其他过程能够在没有远程访问到系统控制台的情况下完成。</p><p><span class="application">mfsBSD</span> 设置工具能够被用来构建一个微小的
      FreeBSD 映像。如 <span class="application">mfsBSD</span> 名字的含义
      (<span class="quote">“<span class="quote">mfs</span>”</span> 的意思是 <span class="quote">“<span class="quote">memory file system</span>”</span> 内存文件系统)，
      最后的映像全部从随机存储器运行。多亏了这个特性，
      磁盘的操作将不会有任何限制，因此它能够被用来安装一个完整的 FreeBSD 操作系统。
      <span class="application">mfsBSD</span> 的主页在
      <code class="uri"><a class="uri" href="http://people.freebsd.org/~mm/mfsbsd/" target="_top">http://people.freebsd.org/~mm/mfsbsd/</a></code>，
      包含了指向最新释出的设置工具。</p><p>请注意关于 <span class="application">mfsBSD</span>
      内幕以及它所有的适用都超出了本文的内容，
      感兴趣的读者应该去查阅 <span class="application">mfs</span>
      的原始文档得到更多详细内容。</p><p>下载并解压出最新的 <span class="application">mfsBSD</span>
      版本，并改变自己的当前工作目录到存在 <span class="application">mfsBSD</span>
      脚本文件的目录：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>fetch http://people.freebsd.org/~mm/mfsbsd/mfsbsd-latest.tar.gz</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>tar xvzf mfsbsd-1.0-beta1.tar.gz</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd mfsbsd-1.0-beta1/</code></strong></pre><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mfsbsd-config"></a>3.1. <span class="application">mfsBSD</span> 的配置</h3></div></div></div><p>引导 <span class="application">mfsBSD</span> 之前，
        必须设置一些重要的配置选项。
        最重要的是我们必须有正确地，自然地，网络配置。
        最适合的方法配置网络选项取决于我们是否事先知道我们会用到的网络接口，
        而且网络接口驱动程序应被系统为我们的硬件载入。
        我们将看到 <span class="application">mfsBSD</span>
        如何能够在任一种情况下被配置。</p><p>另外一件重要的事情是设置 <code class="systemitem">root</code> 的密码。
        这将通过编辑 <code class="filename">conf/rootpw.conf</code> 文件来完成。
        请记住该文件将把你的密码保存在简单的文本中，
        所以在此我们不推荐你使用真实的密码。然而，
        这只是一个临时使用一次的密码，你可以在随后安装好的系统中更改它。</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63492688"></a>3.1.1. 编辑 <code class="filename">conf/interfaces.conf</code> 的方法</h4></div></div></div><p>如果我们安装好的网卡是未知类型的，
          我们可以使用 <span class="application">mfsBSD</span> 的自动探测功能。
          <span class="application">mfsBSD</span> 启动脚本能够探测到正确的驱动来使用，
          基于网络接口的 MAC 地址，我们假设在
          <code class="filename">conf/interfaces.conf</code> 文件中设置如下选项：</p><pre class="programlisting">initconf_interfaces="ext1"
initconf_mac_ext1="00:00:00:00:00:00"
initconf_ip_ext1="192.168.0.2"
initconf_netmask_ext1="255.255.255.0"</pre><p>别忘了添加 <code class="literal">defaultrouter</code>
          信息到 <code class="filename">conf/rc.conf</code> 文件中：</p><pre class="programlisting">defaultrouter="192.168.0.1"</pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63505616"></a>3.1.2. 编辑 <code class="filename">conf/rc.conf</code> 的方法</h4></div></div></div><p>当网络接口的驱动是已知类型的，使用
          <code class="filename">conf/rc.conf</code> 文件添加联网选项会更加方便。
          该文件的语法跟 FreeBSD 中标准的 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> 文件的语法相同。</p><p>例如，当你知道被使用的将是一个 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=re&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">re</span>(4)</span></a> 网络接口设备，
          你可以在 <code class="filename">conf/rc.conf</code> 文件中设置如下选项：</p><pre class="programlisting">defaultrouter="192.168.0.1"
ifconfig_re0="inet 192.168.0.2 netmask 255.255.255.0"</pre></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mfsbsd-build"></a>3.2. 构建一个 <span class="application">mfsBSD</span> 映像</h3></div></div></div><p>构建一个 <span class="application">mfsBSD</span>
        映像文件的过程是非常简单明了的。</p><p>第一步是挂载 FreeBSD 的安装 <acronym class="acronym">CD</acronym>，
        或者挂载安装 <acronym class="acronym">ISO</acronym> 文件到
        <code class="filename">/cdrom</code>。
        因为例子的缘故，在文章中我们将假定你下载的是 FreeBSD 7.0-RELEASE
        <acronym class="acronym">ISO</acronym> 文件。使用 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a>
        实用程序挂载 <acronym class="acronym">ISO</acronym> 映像文件到
        <code class="filename">/cdrom</code> 目录非常简单：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t vnode -u 10 -f 7.0-RELEASE-amd64-disc1.iso</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount_cd9660 /dev/md10 /cdrom</code></strong></pre><p>紧接着，构建可启动的 <span class="application">mfsBSD</span>
        映像：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make BASE=/cdrom/7.0-RELEASE</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">上面的 <code class="command">make</code> 命令必须在
          <span class="application">mfsBSD</span> 目录树的最高一层运行，也就是：
          <code class="filename">~/mfsbsd-1.0-beta1/</code>。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63557072"></a>3.3. 启动 <span class="application">mfsBSD </span></h3></div></div></div><p>现在 <span class="application">mfsBSD</span> 映像已经准备好了，
        必须把它上传到远程的一个正在运行的急救系统上或者一个预安装了
        <span class="trademark">Linux</span>® 发行版的系统上。最适合做这个工作的工具是
        <span class="application">scp</span>：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>scp disk.img root@192.168.0.2:.</code></strong></pre><p>想要正确的引导 <span class="application">mfsBSD</span> 映像，
        必须把它安放在机器的第一块（可启动）设备上。
        这可能会和使用的例子我们假定的一样，第一块可启动磁盘设备是
        <code class="filename">sda</code>：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/root/disk.img of=/dev/sda bs=1m</code></strong></pre><p>如果一切正常，该映像现在应该存在于第一块设备的
        <acronym class="acronym">MBR</acronym>（主引导区）而机器也应该能够被启动了。
        使用工具 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ping&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ping</span>(8)</span></a> 来查看机器是否被正确启动。
        一旦它回复在线状态，就应该能够使用 <code class="systemitem">root</code>
        用户和配置好的密码通过 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a> 来访问它了。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="intro.html">上一页</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="installation.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">2. 简介 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 4. FreeBSD 操作系统的安装</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文档和其它文档可从这里下载：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>如果对于FreeBSD有问题，请先阅读
    <a href="http://www.FreeBSD.org/docs.html">文档</a>，如不能解决再联系
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    关于本文档的问题请发信联系
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>