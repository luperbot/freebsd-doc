<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>12.14. 使用 BROKEN、 FORBIDDEN 或 IGNORE 阻止用户安装 port</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD Porter 手册" /><link rel="up" href="porting-dads.html" title="第 12 章 该做什么和不该做什么" /><link rel="prev" href="dads-readme.html" title="12.13. README.html" /><link rel="next" href="dads-deprecated.html" title="12.15. 使用 DEPRECATED 或 EXPIRATION_DATE 表示某个 port 将被删除" /><link rel="copyright" href="trademarks.html" title="法律声明" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">12.14. 使用 <code class="varname">BROKEN</code>、
	  <code class="varname">FORBIDDEN</code> 或 <code class="varname">IGNORE</code>
	  阻止用户安装 port</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="dads-readme.html">上一页</a> </td><th width="60%" align="center">第 12 章 该做什么和不该做什么</th><td width="20%" align="right"> <a accesskey="n" href="dads-deprecated.html">下一页</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-noinstall"></a>12.14. 使用 <code class="varname">BROKEN</code>、
	  <code class="varname">FORBIDDEN</code> 或 <code class="varname">IGNORE</code>
	  阻止用户安装 port</h2></div></div></div><p>某些时候会需要阻止用户安装某个 port。
	  想要告诉用户某个 port 不应被安装， 有许多可以在 port 的
	  <code class="filename">Makefile</code> 中使用的
	  <code class="command">make</code> 变量。 下列
	  <code class="command">make</code> 的值， 将是在用户试图安装时得到的提示信息。
	  务请使用正确的 <code class="command">make</code> 变量，
	  因为每一个都表达了截然不同的意义， 而且许多自动化系统， 例如
	<a class="link" href="build-cluster.html" title="14.4. 位于 pointyhat.FreeBSD.org 的 FreeBSD Port 联编集群">port 联编集群</a>、
	<a class="link" href="keeping-up.html#freshports" title="14.1. FreshPorts">FreshPorts</a>， 以及
	<a class="link" href="portsmon.html" title="14.6. FreeBSD 的 Ports 追踪系统">portsmon</a>， 都依赖于
	  <code class="filename">Makefile</code> 的正确性。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="dads-noinstall-variables"></a>12.14.1. 变量</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">BROKEN</code> 专门用于表达目前无法正确编译、
	      安装或卸载这类问题。 如果是临时性的问题， 则可以使用它。</p><p>如果进行了相关的配置， 则联编集群仍将尝试联编它，
	      以确认导致问题的深层问题是否已被解决。 (不过， 一般情况下，
	      联编集群并不会这样做。)</p><p>举例来说， 当 port 发生下述情况时， 应使用
	      <code class="varname">BROKEN</code>：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>无法编译 (does not compile)</p></li><li class="listitem"><p>无法正确进行配置或安装操作</p></li><li class="listitem"><p>在
		  <code class="filename">${LOCALBASE}</code> 以外的地方安装文件</p></li><li class="listitem"><p>卸载时无法删除所安装的全部文件 (不过，
		  留下用户改过的文件可接受的， 因为可能希望这样作)</p></li></ul></div></li><li class="listitem"><p><code class="varname">FORBIDDEN</code> 用于表示 ports 中包含安全漏洞，
	      或者可能会给安装了这个 port 的 FreeBSD
	      系统带来严重的安全隐患 (例如： 一个很不安全的程序，
	      或包含了能够被轻易攻陷的服务的软件)。 如果发现了安全漏洞，
	      而其作者没有发布升级版本， 则应立即把那个
	      port 标记为 <code class="varname">FORBIDDEN</code>。
	      理想情况下， 包含安全漏洞的 port 应被尽快升级，
	      以便减少包含漏洞的 FreeBSD 主机的数量
	      (我们希望保持良好的安全记录)， 然而，
	      有时在安全漏洞的披露和软件更新之间可能会有一个间隔，
	      此时应予以说明。 除了安全之外， 请不要以任何其它理由将 port 标记为
	      <code class="varname">FORBIDDEN</code>。</p></li><li class="listitem"><p><code class="varname">IGNORE</code> 用来表示 port
	      由于某些其它原因不应予以联编。 如果认为发生了结构性的问题，
	      则应使用它。 任何情况下，
	      联编集群都不会联编标记为
	      <code class="varname">IGNORE</code> 的 port。 以下是使用
	      <code class="varname">IGNORE</code> 的一些例子：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>能够编译但无法正常运行</p></li><li class="listitem"><p>无法与运行的 FreeBSD 版本一同工作</p></li><li class="listitem"><p>联编时需要 FreeBSD 内核的源代码，
		  但用户没有安装它们</p></li><li class="listitem"><p>由于授权原因， 必须手工下载 distfile</p></li><li class="listitem"><p>无法与的某个已安装的 port 一同工作 (例如， port 依赖于
		  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache21/pkg-descr">www/apache21</a> 而安装的则是
		  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache13/pkg-descr">www/apache13</a>)</p></li></ul></div><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">如果 port 与某个已经安装的
		port 冲突 (例如， 它们在同一位置安装同名但功能不同的文件)，
		则应 <a class="link" href="conflicts.html" title="5.13. 处理冲突">使用
		<code class="varname">CONFLICTS</code> 来标记它</a>。
		<code class="varname">CONFLICTS</code> 将自动地设置
		<code class="varname">IGNORE</code>。</p></div></li><li class="listitem"><p>如果 port 只应在某些平台上标记为 <code class="varname">IGNORE</code>，
	      还有另外两个方便使用的
	      <code class="varname">IGNORE</code> 变量可供选择：
	      <code class="varname">ONLY_FOR_ARCHS</code> 和
	      <code class="varname">NOT_FOR_ARCHS</code>。 例如：</p><pre class="programlisting">ONLY_FOR_ARCHS= i386 amd64</pre><pre class="programlisting">NOT_FOR_ARCHS= alpha ia64 sparc64</pre><p>可以使用 <code class="varname">ONLY_FOR_ARCHS_REASON</code> 和
	      <code class="varname">NOT_FOR_ARCHS_REASON</code> 来配置定制的
	      <code class="varname">IGNORE</code> 消息。 此外， 还可以使用
	      <code class="varname">ONLY_FOR_ARCHS_REASON_<em class="replaceable"><code>ARCH</code></em></code>
	      和
	      <code class="varname">NOT_FOR_ARCHS_REASON_<em class="replaceable"><code>ARCH</code></em></code>
	      来分别指定与具体平台有关的信息。</p></li><li class="listitem"><p>如果 port 会下载并安装用于 i386 的预编译二进制文件， 则应设置
	      <code class="varname">IA32_BINARY_PORT</code>。 如果设置了这个变量，
	      则系统会检查是否已经在
	      <code class="filename">/usr/lib32</code> 目录中安装了
	      IA32 版本的函数库， 以及内核是否提供了 IA32 兼容支持。
	      如果这些依赖条件不满足， 则会自动设置
	      <code class="varname">IGNORE</code>。</p></li></ul></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="dads-noinstall-notes"></a>12.14.2. 实现说明</h3></div></div></div><p>这些字串不应使用引号括起来。 此外， 由于显示给用户的方式不同，
	    这些字串的措辞也应有所不同。 例如：</p><pre class="programlisting">BROKEN= this port is unsupported on FreeBSD 5.x</pre><pre class="programlisting">IGNORE= is unsupported on FreeBSD 5.x</pre><p>它们分别会在
	    <code class="command">make describe</code> 时产生下面的输出：</p><pre class="programlisting">===&gt;  foobar-0.1 is marked as broken: this port is unsupported on FreeBSD 5.x.</pre><pre class="programlisting">===&gt;  foobar-0.1 is unsupported on FreeBSD 5.x.</pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="dads-readme.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="porting-dads.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="dads-deprecated.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">12.13. <code class="filename">README.html</code> </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 12.15. 使用 <code class="varname">DEPRECATED</code>
	  或 <code class="varname">EXPIRATION_DATE</code> 表示某个 port 将被删除</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文档和其它文档可从这里下载：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>如果对于FreeBSD有问题，请先阅读
    <a href="http://www.FreeBSD.org/docs.html">文档</a>，如不能解决再联系
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    关于本文档的问题请发信联系
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>