<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>3. 準備 - mfsBSD</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="遠端安裝 FreeBSD 作業系統而不必接 Remote Console" /><link rel="up" href="index.html" title="遠端安裝 FreeBSD 作業系統而不必接 Remote Console" /><link rel="prev" href="intro.html" title="2. 介紹" /><link rel="next" href="installation.html" title="4. FreeBSD 作業系統的安裝" /><link rel="copyright" href="trademarks.html" title="法律聲明" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3. 準備 - <span class="application">mfsBSD</span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="intro.html">前一頁</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="installation.html">下一頁</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="preparation"></a>3. 準備 - <span class="application">mfsBSD</span></h2></div></div></div><p>在裝 FreeBSD 之前，要先打造最小化的 FreeBSD 作業系統 image 檔，
      以便可以從硬碟上開機。  如此一來，新的系統就可以透過網路來操作，
      而剩下來的安裝部分即可不必透過 console。</p><p>而 <span class="application">mfsBSD</span> 這套工具就是用來打造小型的
      FreeBSD image 檔。  <span class="application">mfsBSD</span> (名字其中
      <span class="quote">“<span class="quote">mfs</span>”</span> 就是 <span class="quote">“<span class="quote">memory file system</span>”</span>)所建造出來的
      整套系統會透過 ramdisk 方式來運作。  由於此一特色，硬碟的部分就不受限，
      因此可以用來安裝完整的 FreeBSD 作業系統。  <span class="application">mfsBSD</span>
      的首頁位於 <code class="uri"><a class="uri" href="http://people.freebsd.org/~mm/mfsbsd/" target="_top">http://people.freebsd.org/~mm/mfsbsd/</a></code>，
      其中連結有該工具的最新 release 部分。</p><p>請注意：<span class="application">mfsBSD</span> 內部運作方式的細節，不
      在本文介紹範圍之內。  若對這方面有興趣的讀者，可至
      <span class="application">mfsBSD</span> 官網查閱相關文件。</p><p>首先下載最新的 <span class="application">mfsBSD</span> 並解壓縮之，
      然後切到解壓縮後的工作目錄，也就是 <span class="application">mfsBSD</span>
      script 檔所在處：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>fetch http://people.freebsd.org/~mm/mfsbsd/mfsbsd-latest.tar.gz</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>tar xvzf mfsbsd-1.0-beta1.tar.gz</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd mfsbsd-1.0-beta1/</code></strong></pre><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mfsbsd-config"></a>3.1. 設定 <span class="application">mfsBSD</span></h3></div></div></div><p>在將 <span class="application">mfsBSD</span> 開機之前，
	有幾個重要設定要先設妥。  此時最重要的設定，很明顯就是網路設定。
	到底網路怎麼設最好，則取決於所處的網路環境，
	以及該網路卡會以哪一種驅動程式載入而定。  我們將會看到
	<span class="application">mfsBSD</span> 如何在任何網路情況下進行設定。</p><p>另一件重要事就是設定 <code class="systemitem">root</code> 密碼。
	這點可以透過 <code class="filename">conf/rootpw.conf</code> 來完成。
	請切記：該檔密碼是以明文方式存放，因此不建議放真正平常有在用的密碼。
	然而這密碼只是臨時密碼而已，可以在之後開機時再做更換。</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63407184"></a>3.1.1. 設定網路(<code class="filename">conf/interfaces.conf</code> 方式)</h4></div></div></div><p>若對要裝的機器網卡為何還不知道是哪一款，但可以善加利用
	  <span class="application">mfsBSD</span> 的自動偵測功能。
	  <span class="application">mfsBSD</span> 的開機 script 會根據網卡的 MAC
	  位址範圍來偵測正確的驅動程式，像是下列的
	  <code class="filename">conf/interfaces.conf</code> 設定內容：</p><pre class="programlisting">initconf_interfaces="ext1"
initconf_mac_ext1="00:00:00:00:00:00"
initconf_ip_ext1="192.168.0.2"
initconf_netmask_ext1="255.255.255.0"</pre><p>別忘了在 <code class="filename">conf/rc.conf</code> 內要加上
	  <code class="literal">defaultrouter</code> 的相關設定：</p><pre class="programlisting">defaultrouter="192.168.0.1"</pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63419216"></a>3.1.2. 設定網路(<code class="filename">conf/rc.conf</code> 方式)</h4></div></div></div><p>若已經知道網卡是哪一種，那麼要設定網路的話直接改
	  <code class="filename">conf/rc.conf</code> 會比較方便。
	  該檔設定語法與 FreeBSD 標準的 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> 是一致的。</p><p>舉個例子，若知道該機器網卡是用 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=re&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">re</span>(4)</span></a>，那麼就在
	  <code class="filename">conf/rc.conf</code> 做下列類似設定：</p><pre class="programlisting">defaultrouter="192.168.0.1"
ifconfig_re0="inet 192.168.0.2 netmask 255.255.255.0"</pre></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mfsbsd-build"></a>3.2. 打造 <span class="application">mfsBSD</span> image</h3></div></div></div><p>打造 <span class="application">mfsBSD</span>
	image 檔的過程相當簡單。</p><p>首先是把 FreeBSD 安裝光碟或者安裝用的 <acronym class="acronym">ISO</acronym> image
	檔丟到 <code class="filename">/cdrom</code>。
	為維持所有例子的一致，本文假設都是用 FreeBSD 7.0-RELEASE
	<acronym class="acronym">ISO</acronym>。  而把 ISO image 檔掛載到 <code class="filename">/cdrom</code> 目錄相當簡單，
	就是用 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a>：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t vnode -u 10 -f 7.0-RELEASE-amd64-disc1.iso</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount_cd9660 /dev/md10 /cdrom</code></strong></pre><p>接著就開始打造可開機的 <span class="application">mfsBSD</span>
	image：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make BASE=/cdrom/7.0-RELEASE</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">上述的 <code class="command">make</code> 指令要在
	  <span class="application">mfsBSD</span> 的最上層目錄執行，比方說 <code class="filename">~/mfsbsd-1.0-beta1/</code>。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63473872"></a>3.3. <span class="application">mfsBSD</span> 開動</h3></div></div></div><p>現在 <span class="application">mfsBSD</span> image 已經備妥，
	要上傳到遠端機器的救急系統或者預先安裝的 <span class="trademark">Linux</span>® distribution。
	要完成這工作最適合的工具就是 <span class="application">scp</span>：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>scp disk.img root@192.168.0.2:.</code></strong></pre><p>為了能順利啟動 <span class="application">mfsBSD</span> image，
	要把檔案放在欲安裝機器的第一顆(可開機)硬碟上。
	假設例子的第一顆開機硬碟代號為 <code class="filename">sda</code>，
	那麼作法就類似下面這樣：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/root/disk.img of=/dev/sda bs=1m</code></strong></pre><p>若一切順利，該 image 檔現在應該會在第一顆硬碟的
	<acronym class="acronym">MBR</acronym> 磁區並可以開始進行重開機了。  可以用
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ping&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ping</span>(8)</span></a> 工具來檢測該機器開機完畢與否。  一旦 ping 到之後，
	就可以透過 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a> 連進去，並且用 <code class="systemitem">root</code>
	以及剛設定的密碼登入。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="intro.html">前一頁</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="installation.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">2. 介紹 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 4. FreeBSD 作業系統的安裝</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文及其他文件，可由此下載：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>若有 FreeBSD 方面疑問，請先閱讀
    <a href="http://www.FreeBSD.org/docs.html">FreeBSD 相關文件</a>，如不能解決的話，再洽詢
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;。<br></br>
    關於本文件的問題，請洽詢
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;。</small></p></body></html>