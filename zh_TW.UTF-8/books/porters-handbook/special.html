<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>章 6. Special considerations</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD Porter's Handbook" /><link rel="up" href="index.html" title="FreeBSD Porter's Handbook" /><link rel="prev" href="install.html" title="5.14. Installing files" /><link rel="next" href="porting-restrictions.html" title="6.2. Ports with distribution restrictions" /><link rel="copyright" href="trademarks.html" title="Legal Notice" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">章 6. Special considerations</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="install.html">前一頁</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="porting-restrictions.html">下一頁</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="special"></a>章 6. Special considerations</h1></div></div></div><div class="toc"><div class="toc-title">內容目錄</div><dl class="toc"><dt><span class="sect1"><a href="special.html#porting-shlibs">6.1. Shared Libraries</a></span></dt><dt><span class="sect1"><a href="porting-restrictions.html">6.2. Ports with distribution restrictions</a></span></dt><dt><span class="sect1"><a href="building.html">6.3. Building mechanisms</a></span></dt><dt><span class="sect1"><a href="using-autotools.html">6.4. Using GNU autotools</a></span></dt><dt><span class="sect1"><a href="using-gettext.html">6.5. Using GNU <code class="literal">gettext</code></a></span></dt><dt><span class="sect1"><a href="using-perl.html">6.6. Using <code class="literal">perl</code></a></span></dt><dt><span class="sect1"><a href="using-x11.html">6.7. Using X11</a></span></dt><dt><span class="sect1"><a href="using-gnome.html">6.8. Using GNOME</a></span></dt><dt><span class="sect1"><a href="using-kde.html">6.9. Using KDE</a></span></dt><dt><span class="sect1"><a href="using-java.html">6.10. Using Java</a></span></dt><dt><span class="sect1"><a href="using-php.html">6.11. Web applications, Apache and PHP</a></span></dt><dt><span class="sect1"><a href="using-python.html">6.12. Using Python</a></span></dt><dt><span class="sect1"><a href="using-emacs.html">6.13. Using Emacs</a></span></dt><dt><span class="sect1"><a href="using-ruby.html">6.14. Using Ruby</a></span></dt><dt><span class="sect1"><a href="using-sdl.html">6.15. Using SDL</a></span></dt><dt><span class="sect1"><a href="using-wx.html">6.16. Using <span class="application">wxWidgets</span></a></span></dt><dt><span class="sect1"><a href="using-lua.html">6.17. Using <span class="application">Lua</span></a></span></dt><dt><span class="sect1"><a href="using-xfce.html">6.18. Using Xfce</a></span></dt><dt><span class="sect1"><a href="using-databases.html">6.19. Using databases</a></span></dt><dt><span class="sect1"><a href="rc-scripts.html">6.20. Starting and stopping services (rc scripts)</a></span></dt></dl></div><p>There are some more things you have to take into account when you
	create a port.  This section explains the most common of those.</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-shlibs"></a>6.1. Shared Libraries</h2></div></div></div><p>If your port installs one or more shared libraries, define a
	  <code class="varname">USE_LDCONFIG</code> make variable, which will instruct
	  a <code class="filename">bsd.port.mk</code> to run
	  <code class="literal">${LDCONFIG} -m</code> on the directory where the
	  new library is installed (usually
	  <code class="filename">PREFIX/lib</code>) during
	  <code class="buildtarget">post-install</code> target to register it into the
	  shared library cache.  This variable, when defined, will also
	  facilitate addition of an appropriate
	  <code class="literal">@exec /sbin/ldconfig -m</code> and
	  <code class="literal">@unexec /sbin/ldconfig -R</code> pair into your
	  <code class="filename">pkg-plist</code> file, so that a user who installed
	  the package can start using the shared library immediately and
	  de-installation will not cause the system to still believe the
	  library is there.</p><pre class="programlisting">USE_LDCONFIG= yes</pre><p>If you need, you can override the default directory
	  by setting the <code class="varname">USE_LDCONFIG</code>
	  value to a list of directories into which
	  shared libraries are to be installed.  For example if your port
	  installs shared libraries into
	  <code class="filename">PREFIX/lib/foo</code> and
	  <code class="filename">PREFIX/lib/bar</code> directories
	  you could use the following in your
	  <code class="filename">Makefile</code>:</p><pre class="programlisting">USE_LDCONFIG= ${PREFIX}/lib/foo ${PREFIX}/lib/bar</pre><p>Please
	  double-check, often this is not necessary at all or can be avoided
	  through <code class="literal">-rpath</code> or setting <code class="envar">LD_RUN_PATH</code>
	  during linking (see <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/moscow_ml/pkg-descr">lang/moscow_ml</a>
	  for an example), or through a shell-wrapper which sets
	  <code class="varname">LD_LIBRARY_PATH</code> before invoking the binary, like
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/mozilla/pkg-descr">www/mozilla</a> does.</p><p>When installing 32-bit libraries on 64-bit system, use
	  <code class="varname">USE_LDCONFIG32</code> instead.</p><p>Try to keep shared library version numbers in the
	  <code class="filename">libfoo.so.0</code> format.  Our runtime linker only
	  cares for the major (first) number.</p><p>When the major library version number increments in the update
	  to the new port version, all other ports that link to the affected
	  library should have their <code class="varname">PORTREVISION</code> incremented,
	  to force recompilation with the new library version.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="install.html">前一頁</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="porting-restrictions.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">5.14. Installing files </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 6.2. Ports with distribution restrictions</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文及其他文件，可由此下載：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>若有 FreeBSD 方面疑問，請先閱讀
    <a href="http://www.FreeBSD.org/docs.html">FreeBSD 相關文件</a>，如不能解決的話，再洽詢
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;。<br></br>
    關於本文件的問題，請洽詢
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;。</small></p></body></html>