<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>28.3. sendmail Configuration</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 使用手冊" /><link rel="up" href="mail.html" title="章 28. 電子郵件" /><link rel="prev" href="mail-using.html" title="28.2. 使用電子郵件" /><link rel="next" href="mail-changingmta.html" title="28.4. Changing Your Mail Transfer Agent" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">28.3. <span class="application">sendmail</span> Configuration</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mail-using.html">前一頁</a> </td><th width="60%" align="center">章 28. 電子郵件</th><td width="20%" align="right"> <a accesskey="n" href="mail-changingmta.html">下一頁</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="sendmail"></a>28.3. <span class="application">sendmail</span> Configuration</h2></div><div><span class="authorgroup">Contributed by <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Christopher</span> <span class="surname">Shumway</span></span>. </span></div></div></div><a id="idp86701264" class="indexterm"></a><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sendmail</span>(8)</span></a> is the default Mail Transfer Agent (MTA) in
      FreeBSD.  <span class="application">sendmail</span>'s job is to accept
      mail from Mail User Agents (<acronym class="acronym">MUA</acronym>) and deliver it
      to the appropriate mailer as defined by its configuration file.
      <span class="application">sendmail</span> can also accept network
      connections and deliver mail to local mailboxes or deliver it to
      another program.</p><p><span class="application">sendmail</span> uses the following
      configuration files:</p><a id="idp86705104" class="indexterm"></a><a id="idp86706000" class="indexterm"></a><a id="idp86706896" class="indexterm"></a><a id="idp86707792" class="indexterm"></a><a id="idp86708816" class="indexterm"></a><a id="idp86709712" class="indexterm"></a><a id="idp86710608" class="indexterm"></a><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Filename</th><th>Function</th></tr></thead><tbody><tr><td>
	      <code class="filename">/etc/mail/access</code>
	    </td><td><span class="application">sendmail</span> access database
 	      file</td></tr><tr><td>
	      <code class="filename">/etc/mail/aliases</code>
	    </td><td>Mailbox aliases</td></tr><tr><td>
	      <code class="filename">/etc/mail/local-host-names</code>
	    </td><td>Lists of hosts <span class="application">sendmail</span>
	    accepts mail for</td></tr><tr><td>
	      <code class="filename">/etc/mail/mailer.conf</code>
	    </td><td>Mailer program configuration</td></tr><tr><td>
	      <code class="filename">/etc/mail/mailertable</code>
	    </td><td>Mailer delivery table</td></tr><tr><td>
	      <code class="filename">/etc/mail/sendmail.cf</code>
	    </td><td><span class="application">sendmail</span> master
	    configuration file</td></tr><tr><td>
	      <code class="filename">/etc/mail/virtusertable</code>
	    </td><td>Virtual users and domain tables</td></tr></tbody></table></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86738768"></a>28.3.1. <code class="filename">/etc/mail/access</code></h3></div></div></div><p>The access database defines what host(s) or IP addresses
      have access to the local mail server and what kind of access
      they have.  Hosts can be listed as <code class="option">OK</code>,
      <code class="option">REJECT</code>, <code class="option">RELAY</code> or simply passed
      to <span class="application">sendmail</span>'s error handling routine with a given mailer error.
      Hosts that are listed as <code class="option">OK</code>, which is the
      default, are allowed to send mail to this host as long as the
      mail's final destination is the local machine.  Hosts that are
      listed as <code class="option">REJECT</code> are rejected for all mail
      connections.  Hosts that have the <code class="option">RELAY</code> option
      for their hostname are allowed to send mail for any destination
      through this mail server.</p><div class="example"><a id="idp86742608"></a><div class="example-title">範例 28.1. Configuring the <span class="application">sendmail</span>
  	  Access Database</div><div class="example-contents"><pre class="programlisting">cyberspammer.com                550 We do not accept mail from spammers
FREE.STEALTH.MAILER@            550 We do not accept mail from spammers
another.source.of.spam          REJECT
okay.cyberspammer.com           OK
128.32                          RELAY</pre></div></div><br class="example-break" /><p>In this example we have five entries.  Mail senders that
     match the left hand side of the table are affected by the action
     on the right side of the table.  The first two examples give an
     error code to <span class="application">sendmail</span>'s error
     handling routine.  The message is printed to the remote host when
     a mail matches the left hand side of the table.  The next entry
     rejects mail from a specific host on the Internet,
     <code class="systemitem">another.source.of.spam</code>.  The next entry accepts
     mail connections from a host
     <code class="systemitem">okay.cyberspammer.com</code>, which is more exact than
     the <code class="systemitem">cyberspammer.com</code> line above.  More specific
     matches override less exact matches.  The last entry allows
     relaying of electronic mail from hosts with an IP address that
     begins with <code class="systemitem">128.32</code>.  These hosts would be able
     to send mail through this mail server that are destined for other
     mail servers.</p><p>When this file is updated, you need to run
     <code class="command">make</code> in <code class="filename">/etc/mail/</code> to
     update the database.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86764624"></a>28.3.2. <code class="filename">/etc/mail/aliases</code></h3></div></div></div><p>The aliases database contains a list of virtual mailboxes
      that are expanded to other user(s), files, programs or other
      aliases.  Here are a few examples that can be used in
      <code class="filename">/etc/mail/aliases</code>:</p><div class="example"><a id="idp86766160"></a><div class="example-title">範例 28.2. Mail Aliases</div><div class="example-contents"><pre class="programlisting">root: localuser
ftp-bugs: joe,eric,paul
bit.bucket:  /dev/null
procmail: "|/usr/local/bin/procmail"</pre></div></div><br class="example-break" /><p>The file format is simple; the mailbox name on the left
	side of	the colon is expanded to the target(s) on the right.
	The
	first example simply expands the mailbox <code class="systemitem">root</code>
	to the mailbox <code class="systemitem">localuser</code>, which is then
	looked up again in the aliases database.  If no match is found,
	then the message is delivered to the local user
	<code class="systemitem">localuser</code>.  The next example shows a mail
	list.  Mail to the mailbox <code class="systemitem">ftp-bugs</code> is
	expanded to the three local mailboxes <code class="systemitem">joe</code>,
	<code class="systemitem">eric</code>, and <code class="systemitem">paul</code>.  Note
	that a remote mailbox could be specified as <code class="email">&lt;<a xmlns="" class="email" href="mailto:user@example.com">user@example.com</a>&gt;</code>.  The
	next example shows writing mail to a file, in this case
	<code class="filename">/dev/null</code>.  The last example shows sending
	mail to a program, in this case the mail message is written to the
	standard input of <code class="filename">/usr/local/bin/procmail</code>
	through a <span class="trademark">UNIX</span>® pipe.</p><p>When this file is updated, you need to run
   <code class="command">make</code> in <code class="filename">/etc/mail/</code> to
   update the database.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86778576"></a>28.3.3. <code class="filename">/etc/mail/local-host-names</code></h3></div></div></div><p>This is a list of hostnames <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sendmail</span>(8)</span></a> is to accept as
      the local host name.  Place any domains or hosts that
      <span class="application">sendmail</span> is to be receiving mail for.
      For example, if this mail server was to accept mail for the
      domain <code class="systemitem">example.com</code> and the host
      <code class="systemitem">mail.example.com</code>, its
      <code class="filename">local-host-names</code> might look something like
      this:</p><pre class="programlisting">example.com
mail.example.com</pre><p>When this file is updated, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sendmail</span>(8)</span></a> needs to be
    restarted to read the changes.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86784080"></a>28.3.4. <code class="filename">/etc/mail/sendmail.cf</code></h3></div></div></div><p><span class="application">sendmail</span>'s master configuration
      file, <code class="filename">sendmail.cf</code> controls the overall
      behavior of <span class="application">sendmail</span>, including everything
      from rewriting e-mail addresses to printing rejection messages to
      remote mail servers.  Naturally, with such a diverse role, this
      configuration file is quite complex and its details are a bit
      out of the scope of this section.  Fortunately, this file rarely
      needs to be changed for standard mail servers.</p><p>The master <span class="application">sendmail</span> configuration
      file can be built from <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=m4&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">m4</span>(1)</span></a> macros that define the features
      and behavior of <span class="application">sendmail</span>.  Please see
      <code class="filename">/usr/src/contrib/sendmail/cf/README</code> for
      some of the details.</p><p>When changes to this file are made,
      <span class="application">sendmail</span> needs to be restarted for
      the changes to take effect.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86789456"></a>28.3.5. <code class="filename">/etc/mail/virtusertable</code></h3></div></div></div><p>The <code class="filename">virtusertable</code> maps mail addresses for
      virtual domains and
      mailboxes to real mailboxes.  These mailboxes can be local,
      remote, aliases defined in
      <code class="filename">/etc/mail/aliases</code> or files.</p><div class="example"><a id="idp86795600"></a><div class="example-title">範例 28.3. Example Virtual Domain Mail Map</div><div class="example-contents"><pre class="programlisting">root@example.com                root
postmaster@example.com          postmaster@noc.example.net
@example.com                    joe</pre></div></div><br class="example-break" /><p>In the above example, we have a mapping for a domain
      <code class="systemitem">example.com</code>.  This file is processed in a
      first match order down the file.  The first item maps
      <code class="email">&lt;<a xmlns="" class="email" href="mailto:root@example.com">root@example.com</a>&gt;</code> to the local mailbox <code class="systemitem">root</code>.  The next entry maps
      <code class="email">&lt;<a xmlns="" class="email" href="mailto:postmaster@example.com">postmaster@example.com</a>&gt;</code> to the mailbox <code class="systemitem">postmaster</code> on the host
      <code class="systemitem">noc.example.net</code>.  Finally, if nothing from <code class="systemitem">example.com</code> has
      matched so far, it will match the last mapping, which matches
      every other mail message addressed to someone at
      <code class="systemitem">example.com</code>.
      This will be mapped to the local mailbox <code class="systemitem">joe</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail-using.html">前一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">上一層</a></td><td width="40%" align="right"> <a accesskey="n" href="mail-changingmta.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">28.2. 使用電子郵件 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 28.4. Changing Your Mail Transfer Agent</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文及其他文件，可由此下載：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>若有 FreeBSD 方面疑問，請先閱讀
    <a href="http://www.FreeBSD.org/docs.html">FreeBSD 相關文件</a>，如不能解決的話，再洽詢
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;。<br></br>
    關於本文件的問題，請洽詢
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;。</small></p></body></html>