<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>28.4. Changing Your Mail Transfer Agent</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 使用手冊" /><link rel="up" href="mail.html" title="章 28. 電子郵件" /><link rel="prev" href="sendmail.html" title="28.3. sendmail Configuration" /><link rel="next" href="mail-trouble.html" title="28.5. Troubleshooting" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">28.4. Changing Your Mail Transfer Agent</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="sendmail.html">前一頁</a> </td><th width="60%" align="center">章 28. 電子郵件</th><td width="20%" align="right"> <a accesskey="n" href="mail-trouble.html">下一頁</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mail-changingmta"></a>28.4. Changing Your Mail Transfer Agent</h2></div><div><span class="authorgroup">Written by <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Andrew</span> <span class="surname">Boothman</span></span>. </span></div><div><span class="authorgroup">Information taken from e-mails written by <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Gregory</span> <span class="surname">Neil Shapiro</span></span>. </span></div></div></div><a id="idp86879696" class="indexterm"></a><p>As already mentioned, FreeBSD comes with
      <span class="application">sendmail</span> already installed as your
      MTA (Mail Transfer Agent).  Therefore by default it is
      in charge of your outgoing and incoming mail.</p><p>However, for a variety of reasons, some system
      administrators want to change their system's MTA.  These
      reasons range from simply wanting to try out another MTA to
      needing a specific feature or package which relies on another
      mailer.  Fortunately, whatever the reason, FreeBSD makes it
      easy to make the change.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86882000"></a>28.4.1. Install a New MTA</h3></div></div></div><p>You have a wide choice of MTAs available.  A good
	starting point is the
	<a class="link" href="ports.html" title="章 5. 軟體套件管理篇：Packages 及 Ports 機制">FreeBSD Ports Collection</a> where
	you will be able to find many.  Of course you are free to use
	any MTA you want from any location, as long as you can make
	it run under FreeBSD.</p><p>Start by installing your new MTA.  Once it is installed
	it gives you a chance to decide if it really fulfills your
	needs, and also gives you the opportunity to configure your
	new software before getting it to take over from
	<span class="application">sendmail</span>.  When doing this, you
	should be sure that installing the new software will not attempt
	to overwrite system binaries such as
	<code class="filename">/usr/bin/sendmail</code>.  Otherwise, your new
	mail software has essentially been put into service before
	you have configured it.</p><p>Please refer to your chosen MTA's documentation for
	information on how to configure the software you have
	chosen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mail-disable-sendmail"></a>28.4.2. Disable <span class="application">sendmail</span></h3></div></div></div><p>The procedure used to start
	<span class="application">sendmail</span> changed significantly
	between 4.5-RELEASE, 4.6-RELEASE, and later releases.
	Therefore, the procedure used to disable it is subtly
	different.</p><div xmlns="" class="warning"><h3 class="admontitle">警告: </h3><p xmlns="http://www.w3.org/1999/xhtml">If you disable <span class="application">sendmail</span>'s
	    outgoing mail service, it is important that you replace it
	    with an alternative mail delivery system.  If
	    you choose not to, system functions such as <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=periodic&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">periodic</span>(8)</span></a>
	    will be unable to deliver their results by e-mail as they
	    would normally expect to.  Many parts of your system may
	    expect to have a functional
	    <span class="application">sendmail</span>-compatible system.  If
	    applications continue to use
	    <span class="application">sendmail</span>'s binaries to try to send
	    e-mail after you have disabled them, mail could go into an
	    inactive <span class="application">sendmail</span> queue, and
	    never be delivered.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86890320"></a>28.4.2.1. FreeBSD 4.5-STABLE before 2002/4/4 and Earlier
	  (Including 4.5-RELEASE and Earlier)</h4></div></div></div><p>Enter:</p><pre class="programlisting">sendmail_enable="NO"</pre><p>into <code class="filename">/etc/rc.conf</code>.  This will disable
	  <span class="application">sendmail</span>'s incoming mail service,
	  but if <code class="filename">/etc/mail/mailer.conf</code> (see below)
	  is not changed, <span class="application">sendmail</span> will
	  still be used to send e-mail.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86893904"></a>28.4.2.2. FreeBSD 4.5-STABLE after 2002/4/4
	  (Including 4.6-RELEASE and Later)</h4></div></div></div><p>In order to completely disable
	  <span class="application">sendmail</span>, including the outgoing
	  mail service, you must use</p><pre class="programlisting">sendmail_enable="NONE"</pre><p>in <code class="filename">/etc/rc.conf.</code></p><p>If you only want to disable
	  <span class="application">sendmail</span>'s incoming mail service,
	  you should set</p><pre class="programlisting">sendmail_enable="NO"</pre><p>in <code class="filename">/etc/rc.conf</code>.  However, if
	  incoming mail is disabled, local delivery will still
	  function.  More information on
	  <span class="application">sendmail</span>'s startup options is
	  available from the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc.sendmail</span>(8)</span></a> manual page.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86899536"></a>28.4.2.3. FreeBSD 5.0-STABLE and Later</h4></div></div></div><p>In order to completely disable
	  <span class="application">sendmail</span>, including the outgoing
	  mail service, you must use</p><pre class="programlisting">sendmail_enable="NO"
sendmail_submit_enable="NO"
sendmail_outbound_enable="NO"
sendmail_msp_queue_enable="NO"</pre><p>in <code class="filename">/etc/rc.conf.</code></p><p>If you only want to disable
	  <span class="application">sendmail</span>'s incoming mail service,
	  you should set</p><pre class="programlisting">sendmail_enable="NO"</pre><p>in <code class="filename">/etc/rc.conf</code>.  More information on
	  <span class="application">sendmail</span>'s startup options is
	  available from the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc.sendmail</span>(8)</span></a> manual page.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86913616"></a>28.4.3. Running Your New MTA on Boot</h3></div></div></div><p>You may have a choice of two methods for running your
	new MTA on boot, again depending on what version of FreeBSD
	you are running.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86914640"></a>28.4.3.1. FreeBSD 4.5-STABLE before 2002/4/11
	  (Including 4.5-RELEASE and Earlier)</h4></div></div></div><p>Add a script to
	  <code class="filename">/usr/local/etc/rc.d/</code> that
	  ends in <code class="filename">.sh</code> and is executable by
	  <code class="systemitem">root</code>.  The script should accept <code class="literal">start</code> and
	  <code class="literal">stop</code> parameters.  At startup time the
	  system scripts will execute the command</p><pre class="programlisting">/usr/local/etc/rc.d/supermailer.sh start</pre><p>which you can also use to manually start the server.  At
	  shutdown time, the system scripts will use the
	  <code class="literal">stop</code> option, running the command</p><pre class="programlisting">/usr/local/etc/rc.d/supermailer.sh stop</pre><p>which you can also use to manually stop the server
	  while the system is running.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86923984"></a>28.4.3.2. FreeBSD 4.5-STABLE after 2002/4/11
	  (Including 4.6-RELEASE and Later)</h4></div></div></div><p>With later versions of FreeBSD, you can use the
	  above method or you can set</p><pre class="programlisting">mta_start_script="filename"</pre><p>in <code class="filename">/etc/rc.conf</code>, where
	  <em class="replaceable"><code>filename</code></em> is the name of some
	  script that you want executed at boot to start your
	  MTA.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86926800"></a>28.4.4. Replacing <span class="application">sendmail</span> as
       the System's Default Mailer</h3></div></div></div><p>The program <span class="application">sendmail</span> is so ubiquitous
	as standard software on <span class="trademark">UNIX</span>® systems that some software
	just assumes it is already installed and configured.
	For this reason, many alternative MTA's provide their own compatible
	implementations of the <span class="application">sendmail</span>
	command-line interface; this facilitates using them as
	<span class="quote">“<span class="quote">drop-in</span>”</span> replacements for <span class="application">sendmail</span>.</p><p>Therefore, if you are using an alternative mailer,
	you will need to make sure that software trying to execute
	standard <span class="application">sendmail</span> binaries such as
	<code class="filename">/usr/bin/sendmail</code> actually executes
	your chosen mailer instead.  Fortunately, FreeBSD provides
	a system called <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mailwrapper&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mailwrapper</span>(8)</span></a> that does this job for
	you.</p><p>When <span class="application">sendmail</span> is operating as installed, you will
	find something like the following
	in <code class="filename">/etc/mail/mailer.conf</code>:</p><pre class="programlisting">sendmail	 /usr/libexec/sendmail/sendmail
send-mail	/usr/libexec/sendmail/sendmail
mailq		/usr/libexec/sendmail/sendmail
newaliases	/usr/libexec/sendmail/sendmail
hoststat	/usr/libexec/sendmail/sendmail
purgestat	/usr/libexec/sendmail/sendmail</pre><p>This means that when any of these common commands
	(such as <code class="filename">sendmail</code> itself) are run,
	the system actually invokes a copy of mailwrapper named <code class="filename">sendmail</code>, which
	checks <code class="filename">mailer.conf</code> and
	executes <code class="filename">/usr/libexec/sendmail/sendmail</code>
	instead.  This system makes it easy to change what binaries
	are actually executed when these default <code class="filename">sendmail</code> functions
	are invoked.</p><p>Therefore if you wanted
	<code class="filename">/usr/local/supermailer/bin/sendmail-compat</code>
	to be run instead of <span class="application">sendmail</span>, you could change
	<code class="filename">/etc/mail/mailer.conf</code> to read:</p><pre class="programlisting">sendmail	 /usr/local/supermailer/bin/sendmail-compat
send-mail	/usr/local/supermailer/bin/sendmail-compat
mailq		/usr/local/supermailer/bin/mailq-compat
newaliases	/usr/local/supermailer/bin/newaliases-compat
hoststat	/usr/local/supermailer/bin/hoststat-compat
purgestat	/usr/local/supermailer/bin/purgestat-compat</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86938448"></a>28.4.5. Finishing</h3></div></div></div><p>Once you have everything configured the way you want it, you should
	  either kill the <span class="application">sendmail</span> processes that
	  you no longer need and start the processes belonging to your new
	  software, or simply reboot.  Rebooting will also
	  give you the opportunity to ensure that you have correctly
	  configured your system to start your new MTA automatically on boot.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sendmail.html">前一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">上一層</a></td><td width="40%" align="right"> <a accesskey="n" href="mail-trouble.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">28.3. <span class="application">sendmail</span> Configuration </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 28.5. Troubleshooting</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文及其他文件，可由此下載：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>若有 FreeBSD 方面疑問，請先閱讀
    <a href="http://www.FreeBSD.org/docs.html">FreeBSD 相關文件</a>，如不能解決的話，再洽詢
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;。<br></br>
    關於本文件的問題，請洽詢
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;。</small></p></body></html>