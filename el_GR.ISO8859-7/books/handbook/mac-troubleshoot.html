<?xml version="1.0" encoding="iso-8859-7" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-7" /><title>17.16. Troubleshooting the MAC Framework</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Εγχειρίδιο του FreeBSD" /><link rel="up" href="mac.html" title="Κεφάλαιο 17. Υποχρεωτικός Έλεγχος Πρόσβασης" /><link rel="prev" href="mac-userlocked.html" title="17.15. User Lock Down" /><link rel="next" href="audit.html" title="Κεφάλαιο 18. Έλεγχος Συμβάντων Ασφαλείας" /><link rel="copyright" href="legalnotice.html" title="Νομική Σημείωση" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">17.16. Troubleshooting the MAC Framework</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mac-userlocked.html">Προηγ</a> </td><th width="60%" align="center">Κεφάλαιο 17. Υποχρεωτικός Έλεγχος Πρόσβασης</th><td width="20%" align="right"> <a accesskey="n" href="audit.html">Επόμενο</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mac-troubleshoot"></a>17.16. Troubleshooting the MAC Framework</h2></div></div></div><a id="idp89746512" class="indexterm"></a><p>During the development stage, a few users reported problems
      with normal configuration.  Some of these problems
      are listed below:</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89747664"></a>17.16.1. The <code class="option">multilabel</code> option cannot be enabled on
	<code class="filename">/</code></h3></div></div></div><p>The <code class="option">multilabel</code> flag does not stay
	enabled on my root (<code class="filename">/</code>) partition!</p><p>It seems that one out of every fifty users has this
	problem, indeed, we had this problem during our initial
	configuration.  Further observation of this so called
	<span class="quote">«<span class="quote">bug</span>»</span> has lead me to believe that it is a
	result of either incorrect documentation or misinterpretation
	of the documentation.  Regardless of why it happened, the
	following steps may be taken to resolve it:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Edit <code class="filename">/etc/fstab</code> and set the root
	    partition at <code class="option">ro</code> for read-only.</p></li><li class="step"><p>Reboot into single user mode.</p></li><li class="step"><p>Run <code class="command">tunefs</code> <code class="option">-l enable</code>
	    on <code class="filename">/</code>.</p></li><li class="step"><p>Reboot the system into normal mode.</p></li><li class="step"><p>Run <code class="command">mount</code> <code class="option">-urw</code>
	  <code class="filename">/</code> and change the <code class="option">ro</code>
	  back to <code class="option">rw</code> in <code class="filename">/etc/fstab</code>
	  and reboot the system again.</p></li><li class="step"><p>Double-check the output from the
	  <code class="command">mount</code> to ensure that
	  <code class="option">multilabel</code> has been properly set on the
	  root file system.</p></li></ol></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89773520"></a>17.16.2. Cannot start a X11 server after <acronym class="acronym">MAC</acronym></h3></div></div></div><p>After establishing a secure environment with
	<acronym class="acronym">MAC</acronym>, I am no longer able to start
	X!</p><p>This could be caused by the <acronym class="acronym">MAC</acronym>
	<code class="literal">partition</code> policy or by a mislabeling in
	one of the <acronym class="acronym">MAC</acronym> labeling policies.  To
	debug, try the following:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Check the error message; if the user is in the
	    <code class="literal">insecure</code> class, the
	    <code class="literal">partition</code> policy may be the culprit.
	    Try setting the user's class back to the
	    <code class="literal">default</code> class and rebuild the database
	    with the <code class="command">cap_mkdb</code> command.  If this
	    does not alleviate the problem, go to step two.</p></li><li class="step"><p>Double-check the label policies.  Ensure that the
	    policies are set correctly for the user in question, the
	    X11 application, and
	    the <code class="filename">/dev</code>
	    entries.</p></li><li class="step"><p>If neither of these resolve the problem, send the
	    error message and a description of your environment to
	    the TrustedBSD discussion lists located at the
	    <a class="link" href="http://www.TrustedBSD.org" target="_top">TrustedBSD</a>
	    website or to the <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-questions" target="_top">ηλεκτρονική λίστα γενικών ερωτήσεων του FreeBSD</a>
	    mailing list.</p></li></ol></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89782608"></a>17.16.3. Error: <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=_secure_path&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">_secure_path</span>(3)</span></a> cannot stat <code class="filename">.login_conf</code></h3></div></div></div><p>When I attempt to switch from the <code class="systemitem">root</code>
	to another user in the system, the error message
	<span class="errorname">_secure_path: unable to state .login_conf</span>.</p><p>This message is usually shown when the user has a higher
	label setting then that of the user whom they are attempting to
	become.  For instance a user on the system,
	<code class="systemitem">joe</code>, has a	default label of
	<code class="option">biba/low</code>.  The <code class="systemitem">root</code> user,
	who has a label of <code class="option">biba/high</code>, cannot view
	<code class="systemitem">joe</code>'s home directory.  This will happen
	regardless if <code class="systemitem">root</code> has used the
	<code class="command">su</code> command to become <code class="systemitem">joe</code>,
	or not.  In this scenario, the Biba integrity model will not
	permit <code class="systemitem">root</code> to view objects set at a lower
	integrity level.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89790416"></a>17.16.4. The <code class="systemitem">root</code> username is broken!</h3></div></div></div><p>In normal or even single user mode, the
	<code class="systemitem">root</code> is not recognized.  The
	<code class="command">whoami</code> command returns 0 (zero) and
	<code class="command">su</code> returns <span class="errorname">who are you?</span>.
	What could be going on?</p><p>This can happen if a labeling policy has been disabled,
	either by a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span></a> or the policy module was unloaded.
	If the policy is being disabled or has been temporarily
	disabled, then the login capabilities database needs to be
	reconfigured with the <code class="option">label</code> option being
	removed.  Double check the <code class="filename">login.conf</code>
	file to ensure that all <code class="option">label</code> options have
	been removed and rebuild the database with the
	<code class="command">cap_mkdb</code> command.</p><p>This may also happen if a policy restricts access to the
	<code class="filename">master.passwd</code> file or database.  Usually
	caused by an administrator altering the file under a label
	which conflicts with the general policy being used by the
	system.  In these cases, the user information would be read
	by the system and access would be blocked as the file has
	inherited the new label.  Disable the policy via a
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span></a> and everything should return to normal.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mac-userlocked.html">Προηγ</a> </td><td width="20%" align="center"><a accesskey="u" href="mac.html">Πάνω</a></td><td width="40%" align="right"> <a accesskey="n" href="audit.html">Επόμενο</a></td></tr><tr><td width="40%" align="left" valign="top">17.15. User Lock Down </td><td width="20%" align="center"><a accesskey="h" href="index.html">Αρχή</a></td><td width="40%" align="right" valign="top"> Κεφάλαιο 18. Έλεγχος Συμβάντων Ασφαλείας</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Αυτό το κείμενο, και άλλα κείμενα, μπορεί να βρεθεί στο
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Για ερωτήσεις σχετικά με το FreeBSD, διαβάστε την
    <a href="http://www.FreeBSD.org/docs.html">τεκμηρίωση</a> πριν να επικοινωνήσετε με την
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Για ερωτήσεις σχετικά με αυτή την τεκμηρίωση, στείλτε e-mail στην
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>