<?xml version="1.0" encoding="iso-8859-7" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-7" /><title>30.4. Το Packet Filter (PF) και το ALTQ του OpenBSD</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Εγχειρίδιο του FreeBSD" /><link rel="up" href="firewalls.html" title="Κεφάλαιο 30. Firewalls" /><link rel="prev" href="firewalls-apps.html" title="30.3. Προγράμματα Firewall" /><link rel="next" href="firewalls-ipf.html" title="30.5. Το IPFILTER (IPF) Firewall" /><link rel="copyright" href="legalnotice.html" title="Νομική Σημείωση" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">30.4. Το Packet Filter (PF) και το <acronym class="acronym">ALTQ</acronym> του
      OpenBSD</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="firewalls-apps.html">Προηγ</a> </td><th width="60%" align="center">Κεφάλαιο 30. Firewalls</th><td width="20%" align="right"> <a accesskey="n" href="firewalls-ipf.html">Επόμενο</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="firewalls-pf"></a>30.4. Το Packet Filter (PF) και το <acronym class="acronym">ALTQ</acronym> του
      OpenBSD</h2></div><div><span class="authorgroup">Αναθεωρήθηκε και ενημερώθηκε από τον <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">John</span> <span class="surname">Ferrell</span></span>. </span></div></div></div><a id="idp98794192" class="indexterm"></a><p>Τον Ιούλιο του 2003, η εφαρμογή firewall του OpenBSD (γνωστή ως
      <acronym class="acronym">PF</acronym>) μεταφέρθηκε στο FreeBSD και έγινε διαθέσιμη στην
      Συλλογή των Ports.  Το FreeBSD 5.3 που κυκλοφόρησε το 2004, ήταν η
      πρώτη επίσημη έκδοση η οποία περιείχε το <acronym class="acronym">PF</acronym> ως
      τμήμα του βασικού πλέον συστήματος.  Το <acronym class="acronym">PF</acronym> είναι
      ένα ολοκληρωμένο firewall, με πλήθος χαρακτηριστικών, το οποίο επίσης
      διαθέτει προαιρετικά υποστήριξη για το <acronym class="acronym">ALTQ</acronym>
      (Alternate Queuing).  Το <acronym class="acronym">ALTQ</acronym> προσφέρει υπηρεσίες
      Διασφάλισης Ποιότητας (Quality of Service,
      <acronym class="acronym">QoS</acronym>).</p><p>Το OpenBSD Project κάνει εξαιρετική δουλειά στη συντήρηση του
      <a class="link" href="http://www.openbsd.org/faq/pf/" target="_top">PF FAQ</a>.  Για το
      λόγο αυτό, η παρούσα ενότητα του Εγχειριδίου εστιάζει κυρίως στις
      ιδιαιτερότητες του <acronym class="acronym">PF</acronym> όσο αφορά το FreeBSD, ενώ παρέχει
      και μερικές γενικές πληροφορίες σχετικά με τη χρήση του.  Για πιο
      λεπτομερείς πληροφορίες σχετικά με τη χρήση του <acronym class="acronym">PF</acronym>,
      παρακαλούμε διαβάστε το <a class="link" href="http://www.openbsd.org/faq/pf/" target="_top">PF FAQ</a>.</p><p>Περισσότερες πληροφορίες σχετικά με το <acronym class="acronym">PF</acronym> στο
      FreeBSD μπορείτε να βρείτε στο <code class="uri"><a class="uri" href="http://pf4freebsd.love2party.net/" target="_top">http://pf4freebsd.love2party.net/</a></code>.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98801616"></a>30.4.1. Χρησιμοποιώντας τα Αρθρώματα Πυρήνα για το PF</h3></div></div></div><p>Για να φορτώσετε το άρθρωμα πυρήνα για το PF, προσθέστε την
	παρακάτω γραμμή στο στο <code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">pf_enable="YES"</pre><p>Εκτελέστε έπειτα το script εκκίνησης για να φορτώσετε το
	άρθρωμα:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/pf start</code></strong></pre><p>Σημειώστε ότι το άρθρωμα PF δεν πρόκειται να φορτωθεί αν δεν
	βρει το καθορισμένο αρχείο κανόνων.  Το προεπιλεγμένο αρχείο είναι
	το <code class="filename">/etc/pf.conf</code>.  Αν το αρχείο κανόνων βρίσκεται
	σε κάποια άλλη τοποθεσία, μπορείτε να την καθορίσετε προσθέτοντας
	μια γραμμή όπως την παρακάτω στο
	<code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">pf_rules="<em class="replaceable"><code>/path/to/pf.conf</code></em>"</pre><p>Μπορείτε να βρείτε ένα παράδειγμα του αρχείου
	<code class="filename">pf.conf</code> στον κατάλογο <code class="filename">/usr/share/examples/pf</code></p><p>Το άρθρωμα <acronym class="acronym">PF</acronym> μπορεί επίσης να φορτωθεί
	χειροκίνητα από την γραμμή εντολών:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kldload pf.ko</code></strong></pre><p>Η υποστήριξης καταγραφής του PF παρέχεται από το άρθρωμα
	<code class="literal">pflog.ko</code> και μπορείτε να την φορτώσετε
	προσθέτοντας την παρακάτω γραμμή στο
	<code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">pflog_enable="YES"</pre><p>Εκτελέστε έπειτα το script εκκίνησης για να φορτώσετε το
	άρθρωμα:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/pflog start</code></strong></pre><p>Αν χρειάζεστε κάποιο από τα προχωρημένα χαρακτηριστικά του
	<acronym class="acronym">PF</acronym>, θα πρέπει να μεταγλωττίσετε την υποστήριξη
	για το <acronym class="acronym">PF</acronym> απευθείας μέσα στον πυρήνα.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98813904"></a>30.4.2. Επιλογές του PF για τον Πυρήνα</h3></div></div></div><a id="idp98814544" class="indexterm"></a><a id="idp98815696" class="indexterm"></a><a id="idp98816848" class="indexterm"></a><p>Αν και δεν είναι απαραίτητο να μεταγλωττίσετε την υποστήριξη
	<acronym class="acronym">PF</acronym> μέσα στον πυρήνα του FreeBSD, ίσως να θέλετε να
	χρησιμοποιήσετε ένα από τα προχωρημένα χαρακτηριστικά του PF το
	οποίο δεν περιλαμβάνεται στο άρθρωμα του πυρήνα: το <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfsync&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pfsync</span>(4)</span></a>.
	Πρόκειται για μια ψευδο-συσκευή η οποία αποκαλύπτει συγκεκριμένες
	αλλαγές στον πίνακα καταστάσεων που χρησιμοποιείται από το
	<acronym class="acronym">PF</acronym>.  Μπορεί να συνδυαστεί με το <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=carp&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">carp</span>(4)</span></a> για
	να δημιουργηθούν με το <acronym class="acronym">PF</acronym> firewalls με δυνατότητα
	αυτόματης αλλαγής σε περίπτωση αποτυχίας (failover).  Περισσότερες
	πληροφορίες σχετικά με το <acronym class="acronym">CARP</acronym> μπορείτε να βρείτε
	στο <a class="xref" href="carp.html" title="31.12. Common Access Redundancy Protocol (CARP)">Τμήμα 31.12, «Common Access Redundancy Protocol (CARP)»</a> του Εγχειριδίου.</p><p>Μπορείτε να δείτε όλες τις επιλογές πυρήνα για το
	<acronym class="acronym">PF</acronym> στο αρχείο
	<code class="filename">/usr/src/sys/conf/NOTES</code>.  Οι επιλογές φαίνονται
	επίσης παρακάτω:</p><pre class="programlisting">device pf
device pflog
device pfsync</pre><p>Η επιλογή <code class="literal">device pf</code> ενεργοποιεί την υποστήριξη
	για το firewall <span class="quote">«<span class="quote">Packet Filter</span>»</span> (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pf&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pf</span>(4)</span></a>).</p><p>Η επιλογή <code class="literal">device pflog</code> ενεργοποιεί την
	προαιρετική ψευδο-δικτυακή συσκευή <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pflog&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pflog</span>(4)</span></a> που μπορεί να
	χρησιμοποιηθεί για την καταγραφή της κίνησης σε ένα <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bpf&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bpf</span>(4)</span></a>
	descriptor.  Ο δαίμονας <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pflogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pflogd</span>(8)</span></a> μπορεί να αποθηκεύσει την
	καταγραφή αυτή στο σκληρό δίσκο.</p><p>Η επιλογή <code class="literal">device pfsync</code> ενεργοποιεί την
	προαιρετική ψευδό-δικτυακή συσκευή <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfsync&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pfsync</span>(4)</span></a> η οποία
	χρησιμοποιείται για να ανιχνεύει
	<span class="quote">«<span class="quote">αλλαγές κατάστασης</span>»</span>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98838992"></a>30.4.3. Επιλογές στο <code class="filename">rc.conf</code></h3></div></div></div><p>Το <acronym class="acronym">PF</acronym> και το <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pflog&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pflog</span>(4)</span></a> μπορούν να
	ρυθμιστούν κατά την εκκίνηση με τις παρακάτω καταχωρίσεις στο
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>:</p><pre class="programlisting">pf_enable="YES"                 # Enable PF (load module if required)
pf_rules="/etc/pf.conf"         # rules definition file for pf
pf_flags=""                     # additional flags for pfctl startup
pflog_enable="YES"              # start pflogd(8)
pflog_logfile="/var/log/pflog"  # where pflogd should store the logfile
pflog_flags=""                  # additional flags for pflogd startup</pre><p>Αν πίσω από αυτό το firewall υπάρχει κάποιο τοπικό δίκτυο (LAN)
	προς το οποίο επιθυμείτε να προωθήσετε πακέτα, ή αν θέλετε να
	χρησιμοποιήσετε NAT, θα χρειαστείτε επίσης και την παρακάτω
	επιλογή:</p><pre class="programlisting">gateway_enable="YES"            # Enable as LAN gateway</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98843472"></a>30.4.4. Δημιουργία Κανόνων Φιλτραρίσματος</h3></div></div></div><p>Το <acronym class="acronym">PF</acronym> διαβάζει τις ρυθμίσεις του από το
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pf.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">pf.conf</span>(5)</span></a> (η προεπιλεγμένη τοποθεσία είναι στο
	<code class="filename">/etc/pf.conf</code>) και τροποποιεί, απορρίπτει ή
	αποδέχεται πακέτα σύμφωνα με τους κανόνες και τους ορισμούς που
	περιέχονται σε αυτό.  Η εγκατάσταση του FreeBSD περιλαμβάνει αρκετά
	υποδείγματα αρχείων ρύθμισης, στην τοποθεσία
	<code class="filename">/usr/share/examples/pf/</code>.  Παρακαλούμε να
	διαβάσετε το <a class="link" href="http://www.openbsd.org/faq/pf/" target="_top">PF FAQ</a> για πλήρη
	ανάλυση των κανόνων του <acronym class="acronym">PF</acronym>.</p><div xmlns="" class="warning"><h3 class="admontitle">Προειδοποίηση: </h3><p xmlns="http://www.w3.org/1999/xhtml">Καθώς διαβάζετε το <a class="link" href="http://www.openbsd.org/faq/pf/" target="_top">PF FAQ</a>,
	  να έχετε υπόψη σας ότι διαφορετικές εκδόσεις του FreeBSD περιέχουν
	  διαφορετικές εκδόσεις του PF.  Τη δεδομένη στιγμή, το
	  FreeBSD 8.<em class="replaceable"><code>X</code></em> και οι προηγούμενες
	  εκδόσεις χρησιμοποιούν την ίδια έκδοση του <acronym class="acronym">PF</acronym>
	  που χρησιμοποιεί και το OpenBSD 4.1.
	  Το FreeBSD 9.<em class="replaceable"><code>X</code></em> και νεώτερες
	  εκδόσεις χρησιμοποιούν την ίδια έκδοση του
	  <acronym class="acronym">PF</acronym> με το OpenBSD 4.5.</p></div><p>Η <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-pf" target="_top">ηλεκτρονική λίστα του FreeBSD για το packet filter firewall</a> είναι ένα καλό μέρος για να κάνετε ερωτήσεις
	σχετικές με τη ρύθμιση και τη λειτουργία του <acronym class="acronym">PF</acronym>
	firewall.  Μη ξεχάσετε να ελέγξετε τα αρχεία της λίστας πριν
	ξεκινήσετε τις ερωτήσεις!</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98864080"></a>30.4.5. Δουλεύοντας με το PF</h3></div></div></div><p>Χρησιμοποιήστε το <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pfctl</span>(8)</span></a> για να ελέγξετε το
	<acronym class="acronym">PF</acronym>.  Παρακάτω θα βρείτε κάποιες χρήσιμες εντολές
	(βεβαιωθείτε ότι έχετε διαβάσει τη σελίδα manual του <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pfctl</span>(8)</span></a> για
	να δείτε όλες τις διαθέσιμες επιλογές):</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Εντολή</th><th>Σκοπός</th></tr></thead><tbody><tr><td><code class="command">pfctl -e</code></td><td>Ενεργοποίηση του PF</td></tr><tr><td><code class="command">pfctl -d</code></td><td>Απενεργοποίηση του PF</td></tr><tr><td><code class="command">pfctl -F all -f /etc/pf.conf</code></td><td>Διαγραφή όλων των κανόνων (nat, filter, state, table,
		κ.λ.π.) και εκ νέου ανάγνωση από το αρχείο
		<code class="filename">/etc/pf.conf</code></td></tr><tr><td><code class="command">pfctl -s [ rules | nat | state ]</code></td><td>Εκτύπωση αναφοράς σχετικά με τους κανόνες του φίλτρου,
		του NAT, ή του πίνακα κατάστασης</td></tr><tr><td><code class="command">pfctl -vnf /etc/pf.conf</code></td><td>Ελέγχει το <code class="filename">/etc/pf.conf</code> για λάθη,
		αλλά δεν φορτώνει τους κανόνες</td></tr></tbody></table></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98881616"></a>30.4.6. Ενεργοποίηση του <acronym class="acronym">ALTQ</acronym></h3></div></div></div><p>Το <acronym class="acronym">ALTQ</acronym> διατίθεται μόνο αν μεταγλωττίσετε
	απευθείας την υποστήριξη του μέσα στον πυρήνα του FreeBSD.
	Το <acronym class="acronym">ALTQ</acronym> δεν υποστηρίζεται από όλα τα προγράμματα
	οδήγησης καρτών δικτύου.  Παρακαλούμε δείτε τη σελίδα manual του
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=altq&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">altq</span>(4)</span></a> για τη λίστα των οδηγών που υποστηρίζονται στην έκδοση
	του FreeBSD που διαθέτετε.</p><p>Οι παρακάτω επιλογές του πυρήνα ενεργοποιούν το
	<acronym class="acronym">ALTQ</acronym> και παρέχουν επιπρόσθετες λειτουργίες:</p><pre class="programlisting">options         ALTQ
options         ALTQ_CBQ        # Class Bases Queuing (CBQ)
options         ALTQ_RED        # Random Early Detection (RED)
options         ALTQ_RIO        # RED In/Out
options         ALTQ_HFSC       # Hierarchical Packet Scheduler (HFSC)
options         ALTQ_PRIQ       # Priority Queuing (PRIQ)
options         ALTQ_NOPCC      # Required for SMP build</pre><p>Η γραμμή <code class="literal">options ALTQ</code> ενεργοποιεί το πλαίσιο
	λειτουργιών <acronym class="acronym">ALTQ</acronym>.</p><p>Η γραμμή <code class="literal">options ALTQ_CBQ</code> ενεργοποιεί το
	<span class="emphasis"><em>Class Based Queuing</em></span> (<acronym class="acronym">CBQ</acronym>).
	Το <acronym class="acronym">CBQ</acronym> σας επιτρέπει να χωρίσετε το εύρος ζώνης
	μιας σύνδεσης σε διαφορετικές κλάσεις ή ουρές, ώστε να δίνονται
	προτεραιότητες στην κίνηση ανάλογα με τους κανόνες του φίλτρου.</p><p>Η γραμμή <code class="literal">options ALTQ_RED</code> ενεργοποιεί το
	<span class="emphasis"><em>Random Early Detection</em></span> (<acronym class="acronym">RED</acronym>).
	Το <acronym class="acronym">RED</acronym> χρησιμοποιείται για να αποφευχθεί η
	συμφόρηση του δικτύου.  Για το σκοπό αυτό, το <acronym class="acronym">RED</acronym>
	μετράει το μήκος της ουράς και το συγκρίνει με το μέγιστο και
	ελάχιστο όριο της.  Αν η ουρά είναι πάνω από το μέγιστο, όλα
	τα νέα πακέτα θα απορρίπτονται.  Σύμφωνα και με το όνομα του, το
	<acronym class="acronym">RED</acronym> απορρίπτει πακέτα από διάφορες συνδέσεις με
	τυχαίο τρόπο.</p><p>Η γραμμή <code class="literal">options ALTQ_RIO</code> ενεργοποιεί το
	<span class="emphasis"><em>Random Early Detection In and Out</em></span>.</p><p>Η γραμμή <code class="literal">options ALTQ_HFSC</code> ενεργοποιεί το
	<span class="emphasis"><em>Hierarchical Fair Service Curve Packet Scheduler</em></span>.
	Για περισσότερες πληροφορίες σχετικά με το <acronym class="acronym">HFSC</acronym>
	δείτε: <code class="uri"><a class="uri" href="http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html" target="_top">http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html</a></code>.</p><p>Η γραμμή <code class="literal">options ALTQ_PRIQ</code> ενεργοποιεί το
	<span class="emphasis"><em>Priority Queuing</em></span> (<acronym class="acronym">PRIQ</acronym>).
	Το <acronym class="acronym">PRIQ</acronym> πάντοτε περνάει πρώτα την κίνηση με τη
	μεγαλύτερη προτεραιότητα.</p><p>Η γραμμή <code class="literal">options ALTQ_NOPCC</code> ενεργοποιεί την
	υποστήριξη <acronym class="acronym">SMP</acronym> για το <acronym class="acronym">ALTQ</acronym>.
	Η επιλογή αυτή απαιτείται σε συστήματα <acronym class="acronym">SMP</acronym>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="firewalls-apps.html">Προηγ</a> </td><td width="20%" align="center"><a accesskey="u" href="firewalls.html">Πάνω</a></td><td width="40%" align="right"> <a accesskey="n" href="firewalls-ipf.html">Επόμενο</a></td></tr><tr><td width="40%" align="left" valign="top">30.3. Προγράμματα Firewall </td><td width="20%" align="center"><a accesskey="h" href="index.html">Αρχή</a></td><td width="40%" align="right" valign="top"> 30.5. Το IPFILTER (IPF) Firewall</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Αυτό το κείμενο, και άλλα κείμενα, μπορεί να βρεθεί στο
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Για ερωτήσεις σχετικά με το FreeBSD, διαβάστε την
    <a href="http://www.FreeBSD.org/docs.html">τεκμηρίωση</a> πριν να επικοινωνήσετε με την
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Για ερωτήσεις σχετικά με αυτή την τεκμηρίωση, στείλτε e-mail στην
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>