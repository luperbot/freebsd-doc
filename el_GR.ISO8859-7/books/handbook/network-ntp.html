<?xml version="1.0" encoding="iso-8859-7" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-7" /><title>29.10. Συγχρονισμός Ρολογιού Συστήματος με NTP</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Εγχειρίδιο του FreeBSD" /><link rel="up" href="network-servers.html" title="Κεφάλαιο 29. Εξυπηρετητές Δικτύου" /><link rel="prev" href="network-samba.html" title="29.9. File and Print Services for Microsoft(R) Windows(R) clients (Samba)" /><link rel="next" href="firewalls.html" title="Κεφάλαιο 30. Firewalls" /><link rel="copyright" href="legalnotice.html" title="Νομική Σημείωση" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">29.10. Συγχρονισμός Ρολογιού Συστήματος με NTP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-samba.html">Προηγ</a> </td><th width="60%" align="center">Κεφάλαιο 29. Εξυπηρετητές Δικτύου</th><td width="20%" align="right"> <a accesskey="n" href="firewalls.html">Επόμενο</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-ntp"></a>29.10. Συγχρονισμός Ρολογιού Συστήματος με NTP</h2></div><div><span class="authorgroup">Συνεισφορά του <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Hukins</span></span>. </span></div></div></div><a id="idp98608336" class="indexterm"></a><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98608848"></a>29.10.1. Σύνοψη</h3></div></div></div><p>Με το πέρασμα του χρόνου, το ρολόι συστήματος ενός υπολογιστή έχει
	την τάση να αποσυγχρονίζεται. Το Πρωτόκολο Χρονισμού Δικτύων (Network
	Time Protocol ή NTP) παρέχει ένα τρόπο για να εξασφαλίσετε την
	ακρίβεια του clock σας. </p><p>Πολλές διαδικτυακές υπηρεσίες βασίζονται ή ωφελούνται σε μεγάλο
	βαθμό από την ακρίβεια του ρολογιού συστήματος ενός υπολογιστή.  Για
	παράδειγμα, ένας εξυπηρετητής web μπορεί να δεχθεί αιτήσεις για
	αποστολή ενός αρχείου όταν το αρχείο αυτό έχει τροποποιηθεί μέχρι
	κάποια συγκεκριμένη ώρα. Σε ένα περιβάλλον τοπικού δικτύου, είναι
	θεμελιώδης αρχή οι υπολογιστές που θα διαμοιραστούν αρχεία από τον
	ίδιο διακομιστή αρχείων να έχουν συγχρονισμένα ρολόγια, έτσι ώστε τα
	χρονικά χαρακτηριστικά του αρχείου να συμφωνούν.  Επίσης διεργασίες
	όπως η <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a> βασίζονται σε ένα ακριβές ρολόι ώστε να μπορούν να
	τρέχουν εντολές στους προκαθορισμένους χρόνους.</p><a id="idp98611024" class="indexterm"></a><p>Το FreeBSD διατίθεται με τον εξυπηρετητή <acronym class="acronym">NTP</acronym> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a>, ο οποίος μπορεί να
	χρησιμοποιηθεί για να συγχρονίζει το ρολόι συστήματος του υπολογιστή
	σας, εξετάζοντας άλλους εξυπηρετητές <acronym class="acronym">NTP</acronym> ή να παρέχει ο ίδιος υπηρεσίες συγχρονισμού σε
	άλλα μηχανήματα.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98614608"></a>29.10.2. Επιλογή των Κατάλληλων Εξυπηρετητών NTP</h3></div></div></div><a id="idp98615248" class="indexterm"></a><p>Για να συγχρονίσετε το ρολόι συστήματος του υπολογιστή σας θα
	πρέπει να βρείτε έναν ή περισσότερους
	διαθέσιμους <acronym class="acronym">NTP</acronym>
	εξυπηρετητές για να χρησιμοποιήσετε. Ο διαχειριστής δικτύου ή ο ISP
	σας μπορεί να έχουν εγκαταστήσει κάποιον εξυπηρετητή NTP για αυτό το
	σκοπό - ελέγξτε την τεκμηρίωση τους να δείτε αν υπάρχει
	τέτοια περίπτωση. Επιπλέον, υπάρχει
	μία <a class="link" href="http://ntp.isc.org/bin/view/Servers/WebHome" target="_top">online
	λίστα εξυπηρετητών δημόσιας πρόσβασης</a>, που μπορείτε να
	χρησιμοποιήσετε για να βρείτε έναν κοντινό εξυπηρετητή NTP.  Όποιον
	εξυπηρετητή κι αν επιλέξετε, ενημερωθείτε για την πολιτική χρήσης του
	και ζητήστε άδεια να τον χρησιμοποιήσετε αν χρειάζεται τέτοια
	άδεια.</p><p> Είναι καλή ιδέα να επιλέξετε πολλούς εξυπηρετητές NTP, οι οποίοι
	να μην συνδέονται μεταξύ τους, στην περίπτωση που κάποιος από τους
	εξυπηρετητές που χρησιμοποιείτε γίνει απρόσιτος ή το ρολόι του είναι
	ανακριβές.  Ο εξυπηρετητής <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> του FreeBSD χειρίζεται έξυπνα τις
	απαντήσεις που λαμβάνει από τους υπόλοιπους εξυπηρετητές -
	ευνοεί τους πιο αξιόπιστους και δείχνει μικρότερη προτίμηση στους
	λιγότερο αξιόπιστους εξυπηρετητές.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98619088"></a>29.10.3. Ρυθμίστε Το Μηχάνημα Σας</h3></div></div></div><a id="idp98619728" class="indexterm"></a><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98629200"></a>29.10.3.1. Βασικές Ρυθμίσεις</h4></div></div></div><a id="idp98629840" class="indexterm"></a><p>Αν επιθυμείτε να συγχρονίζεται το clock σας μόνο κατά την
	  εκκίνηση λειτουργίας του μηχανήματος, τότε μπορείτε να
	  χρησιμοποιήσετε το <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a>. Αυτός ο τρόπος συγχρονισμού
	  είναι κατάλληλος για μηχανήματα desktop τα οποία κάνουν επανακκίνηση
	  ανά τακτά χρονικά διαστήματα και μόνο σε ειδικές περιπτώσεις έχουν
	  ανάγκη συγχρονισμού.  Αντιθέτως, τα υπόλοιπα μηχανήματα θα πρέπει να
	  τρέχουν την διεργασία <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a>.</p><p>Είναι καλή πρακτική τα μηχανήματα που τρέχουν <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> να
	  χρησιμοποιούν και το <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a> κατά τη διάρκεια εκκίνησης
	  τους.  Το <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> μεταβάλλει το clock βαθμιαία, ενώ το
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a> ρυθμίζει άμεσα το clock ανεξάρτητα από το πόσο
	  μεγάλη είναι η χρονική διαφορά μεταξύ πραγματικής και τρέχουσας ώρας
	  του clock του μηχανήματος.</p><p>Για να ενεργοποιήσετε το <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a> κατά την εκκίνηση,
	  προσθέστε <code class="literal">ntpdate_enable="YES"</code>
	  στο <code class="filename">/etc/rc.conf</code>.  Θα πρέπει να προσδιορίσετε
	  στο <code class="varname">ntpdate_flags</code> όλους τους διακομιστές με τους
	  οποίους επιθυμείτε να συγχρονίζεστε και όλα τα flag που θέλετε να
	  συνοδεύουν το<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98639312"></a>29.10.3.2. Γενικές Ρυθμίσεις</h4></div></div></div><a id="idp98639952" class="indexterm"></a><p>Οι ρυθμίσεις του NTP βρίσκονται στο
	  αρχείο <code class="filename">/etc/ntp.conf</code> και είναι στη μορφή που
	  περιγράφεται στο <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ntp.conf</span>(5)</span></a>. Ακολουθεί ένα απλό
	  παράδειγμα:</p><pre class="programlisting">server ntplocal.example.com prefer
server timeserver.example.org
server ntp2a.example.net

driftfile /var/db/ntp.drift</pre><p>Η επιλογή <code class="literal">server</code> προσδιορίζει ποιοι
	  εξυπηρετητές θα χρησιμοποιηθούν, παραθέτοντας έναν σε κάθε
	  γραμμή. Αν ένας εξυπηρετητής φέρει το
	  πρόθεμα <code class="literal">prefer</code>, όπως συμβαίνει με
	  τον <code class="systemitem">ntplocal.example.com</code>, τότε αυτός ο
	  εξυπηρετητής είναι ο προτιμώμενος. Θα απορριφθεί η απάντηση από τον
	  προτιμώμενο εξυπηρετητή σε περίπτωση που διαφέρει σημαντικά από
	  όλους τους άλλους εξυπηρετητές, Σε περίπτωση που δεν υπάρχει μεγάλη
	  απόκλιση θα χρησιμοποιηθεί δίχως να ληφθούν υπόψιν οι άλλες
	  απαντήσεις. Το πρόθεμα <code class="literal">prefer</code> συνήθως
	  χρησιμοποιείται με εξυπηρετητές NTP ακριβείας, όπως αυτοί που φέρουν
	  ειδικούς μηχανισμούς παρακολούθησης χρονισμού.</p><p>Η επιλογή <code class="literal">driftfile</code> προσδιορίζει ποιό αρχείο
	  χρησιμοποιείται για να διατηρεί τη συχνότητα διόρθωσης του clock του
	  συστήματος. Το πρόγραμμα <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> χρησιμοποιεί αυτόματα αυτή τη
	  τιμή για να αντισταθμίζει τις φυσικές αποκλίσεις του clock,
	  επιτρέποντας του να διατηρεί μια λογική ρύθμιση, ακόμη κι αν του
	  απαγορευτεί για κάποιο χρονικό διάστημα η πρόσβαση προς όλες τις
	  εξωτερικές πηγές συγχρονισμού.</p><p>Η επιλογή <code class="literal">driftfile</code> προσδιορίζει ποιό αρχείο
	  χρησιμοποιείται για να αποθηκεύει πληροφορίες σχετικά με τις
	  προηγούμενες απαντήσεις από τους εξυπηρετητές NTP. Αυτό το αρχείο
	  περιέχει εσωτερικές πληροφορίες του NTP. Δεν θα έπρεπε να
	  τροποποιείτε από καμμία άλλη διεργασία.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98651984"></a>29.10.3.3. Έλεγχος Πρόσβασης στον Εξυπηρετητή Σας</h4></div></div></div><p>Προεπιλεγμένα, ο εξυπηρετητής σας NTP θα είναι προσβάσιμος από
	  όλους τους κόμβους στο διαδίκτυο. Η
	  επιλογή <code class="literal">restrict</code>
	  στο <code class="filename">/etc/ntp.conf</code> σας επιτρέπει να ελέγχετε
	  ποια μηχανήματα θα μπορούν να έχουν πρόσβαση στον εξυπηρετή
	  σας. </p><p>Αν επιθυμείτε να απορρίψετε την πρόσβαση προς τον εξυπηρετητή
	  σας NTP για όλα τα μηχανήματα, προσθέστε την ακόλουθη γραμμή
	  στο <code class="filename">/etc/ntp.conf</code>:</p><pre class="programlisting">restrict default ignore</pre><p>Αν θέλετε μόνο να επιτρέψετε τον συγχρονισμό του εξυπηρετητή σας
	  με μηχανήματα εντός του δικτύου σας, αλλά δίχως δυνατότητα ρύθμισης
	  του εξυπηρετητή ή να γίνουν ομοιόβαθμα με άδεια συγχρονισμού, τότε
	  αντιθέτως προσθέστε:</p><pre class="programlisting">restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap</pre><p>όπου <code class="systemitem">192.168.1.0</code> είναι η
	  διεύθυνση IP του δικτύου
	  και <code class="systemitem">255.255.255.0</code> είναι η μάσκα του
	  δικτύου σας.</p><p>Το <code class="filename">/etc/ntp.conf</code> μπορεί να περιέχει
	  πολλαπλές επιλογές <code class="literal">restrict</code>. Για περισσότερες
	  πληροφορίες, δείτε την υποενότητα <code class="literal">Υποστήριξη Ελέγχου
	  Πρόσβασης (Access Control Support)</code>, υποενότητα του
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ntp.conf</span>(5)</span></a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98700880"></a>29.10.4. Εκτέλεση του NTP Εξυπηρετητή Σας</h3></div></div></div><p>Για να βεβαιωθείτε πως ο εξυπηρετητής NTP θα ξεκινάει κατά την
	διάρκεια εκκίνησης του συστήματος, προσθέστε τη
	γραμμή <code class="literal">ntpd_enable="YES"</code>στο<code class="filename">/etc/rc.conf</code>.
	Για να ξεκινήσετε τον εξυπηρετητή δίχως να επανεκκινήσετε το μηχάνημα
	σας, τρέξτε <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> προσδιορίζοντας κάθε επιπρόσθετη παράμετρο
	από τα <code class="varname">ntpd_flags</code>
	στο <code class="filename">/etc/rc.conf</code>. Για παράδειγμα:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ntpd -p /var/run/ntpd.pid</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98705232"></a>29.10.5. Χρήση του ntpd με Προσωρινή Σύνδεση στο Ίντερνετ</h3></div></div></div><p>Το πρόγραμμα <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> δεν χρειάζεται μια μόνιμη σύνδεση στο
	Ίντερνετ για να δουλέψει σωστά. Αν έχετε μια προσωρινή σύνδεση που
	είναι ρυθμισμένη να κάνει κλήσεις μέσω τηλεφώνου (dial out on demand),
	είναι καλό να μην είναι η κίνηση δεδομένων του NTP το αίτιο της κλήσης
	ή αυτή που θα κρατάει ενεργή την σύνδεση. Αν χρησιμοποιείτε PPP
	χρήστη, μπορείτε να χρησιμοποιήσετε <code class="literal">φίλτρα</code> στους
	κώδικες παραπομπής του <code class="filename">/etc/ppp/ppp.conf</code>, όπως
	για παράδειγμα:</p><pre class="programlisting"> set filter dial 0 deny udp src eq 123
 # Prevent NTP traffic from initiating dial out
 set filter dial 1 permit 0 0
 set filter alive 0 deny udp src eq 123
 # Prevent incoming NTP traffic from keeping the connection open
 set filter alive 1 deny udp dst eq 123
 # Prevent outgoing NTP traffic from keeping the connection open
 set filter alive 2 permit 0/0 0/0</pre><p>Για περισσότερες λεπτομέρειες δείτε το <code class="literal">PACKET
	FILTERING</code> στην ενότητα <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppp&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ppp</span>(8)</span></a> και τα παραδείγματα
	στο <code class="filename">/usr/share/examples/ppp/</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Σημείωση: </h3><p xmlns="http://www.w3.org/1999/xhtml">Σημείωση: Μερικοί ISP μπλοκάρουν την χρήση θύρας με χαμηλό
	  αριθμό, εμποδίζοντας στο NTP να δουλεύει αφού οι απαντήσεις δεν
	  φτάνουν ποτέ στο μηχάνημα σας.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98715344"></a>29.10.6. Περαιτέρω Πληροφορίες</h3></div></div></div><p>Η τεκμηρίωση για τους εξυπηρετητές NTP διατίθεται και σε φόρμα
	HTML στο <code class="filename">/usr/share/doc/ntp/</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-samba.html">Προηγ</a> </td><td width="20%" align="center"><a accesskey="u" href="network-servers.html">Πάνω</a></td><td width="40%" align="right"> <a accesskey="n" href="firewalls.html">Επόμενο</a></td></tr><tr><td width="40%" align="left" valign="top">29.9. File and Print Services for <span class="trademark">Microsoft</span>(R) <span class="trademark">Windows</span>(R) clients (Samba) </td><td width="20%" align="center"><a accesskey="h" href="index.html">Αρχή</a></td><td width="40%" align="right" valign="top"> Κεφάλαιο 30. Firewalls</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Αυτό το κείμενο, και άλλα κείμενα, μπορεί να βρεθεί στο
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Για ερωτήσεις σχετικά με το FreeBSD, διαβάστε την
    <a href="http://www.FreeBSD.org/docs.html">τεκμηρίωση</a> πριν να επικοινωνήσετε με την
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Για ερωτήσεις σχετικά με αυτή την τεκμηρίωση, στείλτε e-mail στην
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>