<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>20.7. Het labelen van schijven</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="GEOM.html" title="Hoofdstuk 20. GEOM: Modulair schijftransformatie raamwerk" /><link rel="prev" href="geom-ggate.html" title="20.6. GEOM Gate netwerk apparaten" /><link rel="next" href="geom-gjournal.html" title="20.8. UFS logboeken door middel van GEOM" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">20.7. Het labelen van schijven</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="geom-ggate.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 20. GEOM: Modulair schijftransformatie raamwerk</th><td width="20%" align="right"> <a accesskey="n" href="geom-gjournal.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="geom-glabels"></a>20.7. Het labelen van schijven</h2></div></div></div><a id="idp81332944" class="indexterm"></a><a id="idp81333456" class="indexterm"></a><p>Tijdens het initialiseren van het systeem zal de FreeBSD kernel
      apparaatknooppunten creëren nadat het een apparaat gevonden
      heeft.  Deze manier om te zoeken naar apparaten levert wat
      problemen op bijvoorbeeld wanneer er een nieuwe schijf wordt
      toegevoegd via <acronym class="acronym">USB</acronym>.  Het is hoogst
      waarschijnlijk dat een flash apparaat een apparaatknooppunt
      krijgt van <code class="filename">da0</code>, waarna de originele
      <code class="filename">da0</code> op schuift naar
      <code class="filename">da1</code>.  Dit levert problemen op als
      bestandssystemen worden gekoppeld als ze gedefinieerd zijn in
      <code class="filename">/etc/fstab</code>, dit kan zelfs ertoe leiden dat
      het systeem niet opstart.</p><p>Een mogelijke oplossing hiervoor is om de
      <acronym class="acronym">SCSI</acronym> schijven een vaste plek te geven op
      een bepaalde volgorde, zodat zodra er een nieuwe schijf
      geplaatst wordt, deze een ongebruikt apparaatknooppunt
      toegewezen krijgt.  Maar wat als er <acronym class="acronym">USB</acronym>
      apparaten zijn die de primaire <acronym class="acronym">SCSI</acronym> schijf
      vervangt?  Dit gebeurd omdat <acronym class="acronym">USB</acronym> apparaten
      meestal eerder gevonden worden dan een <acronym class="acronym">SCSI</acronym>
      kaart.  Een oplossing hiervoor is om de apparaten pas toe te
      voegen als het systeem reeds gestart is, een andere methode kan
      zijn om alleen een enkele <acronym class="acronym">ATA</acronym> schijf te
      koppelen en nooit <acronym class="acronym">SCSI</acronym> schijven door middel
      van <code class="filename">/etc/fstab</code>.</p><p>Maar er is een betere oplossing beschikbaar.  Door het gebruik
      van <code class="command">glabel</code> kunnen beheerders en gebruikers een
      label toevoegen aan een schijf, en deze labels gebruiken in
      <code class="filename">/etc/fstab</code>.  Omdat <code class="command">glabel</code>
      het label bewaard in de laatste sector van de schijf, kan het
      label bewaard blijven ook na een reboot en kan het
      bestandssysteem altijd gekoppeld worden ongeacht welk
      apparaatknooppunt toegekend is aan het apparaat.</p><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">Uiteraard hoeft een label niet permanent te zijn, het
	<code class="command">glabel</code> programma kan zowel tijdelijke als
	permanente labels aanmaken.  Alleen een permanent label blijft
	beschikbaar ook na een reboot.  Zie de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=glabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">glabel</span>(8)</span></a>
	handleiding voor meer informatie over de verschillen tussen de
	labeltypes.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81347408"></a>20.7.1. Label types en voorbeelden</h3></div></div></div><p>Er zijn twee type labels: een generiek label en een
	bestandssysteemlabel.  Labels kunnen permanent of tijdelijk
	zijn.  Permanente labels kunnen met de commando's <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tunefs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">tunefs</span>(8)</span></a>
	of <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> aangemaakt worden.  Ze zullen vervolgens worden
	aangemaakt in een submap van
	<code class="filename">/dev</code>, welke genoemd wordt
	naar het bestandssysteemtype.  Bijvoorbeeld
	<acronym class="acronym">UFS</acronym>2 labels worden geplaatst in de map
	<code class="filename">/dev/ufs</code>.  Permanente
	labels kunnen ook worden aangemaakt met het commando
	<code class="command">glabel label</code>.  Deze zijn niet specifiek voor
	het bestandssysteem, en zullen in de map <code class="filename">/dev/label</code> aangemaakt
	worden.</p><p>Een tijdelijk label verdwijnt na een herstart van het
	systeem.  Deze labels worden gecreëerd in
	<code class="filename">/dev/label</code> en zijn
	perfect voor experimenten.  Een tijdelijk kan met het commando
	<code class="command">glabel create</code> worden aangemaakt.  Lees voor
	meer informatie de handleidingpagina van <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=glabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">glabel</span>(8)</span></a>.</p><p>Om een permanent label te schrijven voor een
	<acronym class="acronym">UFS</acronym>2-bestandssysteem zonder de huidige data
	te vernietigen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>tunefs -L home /dev/da3</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Waarschuwing: </h3><p xmlns="http://www.w3.org/1999/xhtml">Als het bestandssyteem vol is kan dit leiden tot data
	  corruptie; echter als het bestandssysteem vol is zou het
	  hoofddoel moeten zijn om oude achtergebleven bestanden weg
	  te halen in plaats van het toevoegen van labels.</p></div><p>Er zou nu een label moeten bestaan in
	<code class="filename">/dev/ufs</code>, welke
	toegevoegd kan worden aan het <code class="filename">/etc/fstab</code>
	bestand:</p><pre class="programlisting">/dev/ufs/home	/home            ufs     rw              2      2</pre><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">Het bestandssysteem mag niet aangekoppeld zijn op het
	  moment dat <code class="command">tunefs</code> gebruikt wordt.</p></div><p>Nu kan het bestandssysteem net als normaal worden gekoppeld:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /home</code></strong></pre><p>Vanaf dit moment is het mogelijk om, zolang de
	<code class="filename">geom_label.ko</code> geladen wordt tijdens het
	opstarten van het systeem, of als deze is meegecompileerd door
	middel van de <code class="literal">GEOM_LABEL</code> optie in de kernel,
	het apparaatknooppunt te wijzigen zonder ernstige gevolgen voor
	het systeem.</p><p>Bestandssystemen kunnen ook een standaard label mee krijgen
	door gebruik te maken van de <code class="option">-L</code> optie met het
	<code class="command">newfs</code> commando.  Zie de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a>
	handleiding voor meer informatie.</p><p>Het volgende commando kan worden gebruikt om een label te
	verwijderen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>glabel destroy home</code></strong></pre><p>Het volgende voorbeeld laat zien hoe de partities van een
	opstartschijf gelabeld worden.</p><div class="example"><a id="idp81369680"></a><div class="example-title">Voorbeeld 20.1. Partities op de opstartschijf labelen</div><div class="example-contents"><p>Door de partities op de opstartschijf permanent te labelen
	  zou het systeem in staat moeten zijn om normaal door te gaan
	  met opstarten, zelfs als de schijf verplaatst is naar een
	  andere controller of is overgeplaatst naar een ander systeem.
	  In dit voorbeeld wordt aangenomen dat er een enkele
	  <acronym class="acronym">ATA</acronym>-schijf wordt gebruikt, die momenteel
	  als <code class="filename">ad0</code> door het systeem wordt
	  herkend.  Het wordt ook aangenomen dat het standaard
	  partitieschema van FreeBSD wordt gebruikt, met de
	  bestandssystemen <code class="filename">/</code>,
	  <code class="filename">/var</code>,
	  <code class="filename">/usr</code>, en
	  <code class="filename">/tmp</code>, alsmede een
	  wisselpartitie.</p><p>Start het systeem opnieuw op, en druk bij de
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=loader&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">loader</span>(8)</span></a>-prompt op 4 om in enkele gebruikersmodus op te
	  starten.  Geef dan de volgende commando's:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>glabel label rootfs /dev/ad0s1a</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1a is label/rootfs
<code class="prompt">#</code> <strong class="userinput"><code>glabel label var /dev/ad0s1d</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1d is label/var
<code class="prompt">#</code> <strong class="userinput"><code>glabel label usr /dev/ad0s1f</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1f is label/usr
<code class="prompt">#</code> <strong class="userinput"><code>glabel label tmp /dev/ad0s1e</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1e is label/tmp
<code class="prompt">#</code> <strong class="userinput"><code>glabel label swap /dev/ad0s1b</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1b is label/swap
<code class="prompt">#</code> <strong class="userinput"><code>exit</code></strong></pre><p>Het systeem zal doorgaan met opstarten in
	  meergebruikersmodus.  Bewerk, nadat het opstarten is voltooid,
	  <code class="filename">/etc/fstab</code> en vervang de conventionele
	  namen door de respectievelijke labels.  Het uiteindelijke
	  bestand <code class="filename">/etc/fstab</code> zal er als volgt
	  uitzien:</p><pre class="programlisting"># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/label/swap          none            swap    sw              0       0
/dev/label/rootfs        /               ufs     rw              1       1
/dev/label/tmp           /tmp            ufs     rw              2       2
/dev/label/usr           /usr            ufs     rw              2       2
/dev/label/var           /var            ufs     rw              2       2</pre><p>Het systeem kan nu worden herstart.  Als alles goed ging,
	  zal het normaal opstarten en zal <code class="command">mount</code> dit
	  laten zien:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount</code></strong>
/dev/label/rootfs on / (ufs, local)
devfs on /dev (devfs, local)
/dev/label/tmp on /tmp (ufs, local, soft-updates)
/dev/label/usr on /usr (ufs, local, soft-updates)
/dev/label/var on /var (ufs, local, soft-updates)</pre></div></div><br class="example-break" /><p>Beginnend met FreeBSD 7.2 ondersteunt de klasse <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=glabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">glabel</span>(8)</span></a>
	een nieuw labeltype voor <acronym class="acronym">UFS</acronym>-bestandssystemen,
	gebaseerd op het unieke id van het bestandssysteem,
	<code class="literal">ufsid</code>.  Deze labels kunnen in de map <code class="filename">/dev/ufsid</code> gevonden worden en
	worden automatisch tijdens het opstarten aangemaakt.  Het is
	mogelijk om de <code class="literal">ufsid</code>-labels te gebruiken om
	partities aan te koppelen door middel van de faciliteit
	<code class="filename">/etc/fstab</code>.  Gebruik <code class="command">glabel
	  status</code> om een lijst van bestandssystemen en hun
	overeenkomende <code class="literal">ufsid</code>-labels te ontvangen:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>glabel status</code></strong>
                  Name  Status  Components
ufsid/486b6fc38d330916     N/A  ad4s1d
ufsid/486b6fc16926168e     N/A  ad4s1f</pre><p>In het bovenstaande voorbeeld representeert
	<code class="filename">ad4s1d</code> het bestandssysteem <code class="filename">/var</code>, terwijl
	<code class="filename">ad4s1f</code> het bestandssysteem <code class="filename">/usr</code> representeert.  Door gebruik
	te maken van de gegeven <code class="literal">ufsid</code>-waarden kunnen
	deze partities nu aangekoppeld worden met de volgende regels in
	<code class="filename">/etc/fstab</code>:</p><pre class="programlisting">/dev/ufsid/486b6fc38d330916	/var	ufs	rw	2	2
/dev/ufsid/486b6fc16926168e	/usr	ufs	rw	2	2</pre><p>Elke partitie met een <code class="literal">ufsid</code>-label kan op
	deze manier worden aangekoppeld, waardoor het niet meer nodig is
	om handmatig permanente labels voor ze aan te maken, terwijl er
	nog steeds van de voordelen van apparaatnaam-onafhankelijk
	aankoppelen genoten kan worden.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="geom-ggate.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="GEOM.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="geom-gjournal.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">20.6. GEOM Gate netwerk apparaten </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 20.8. UFS logboeken door middel van GEOM</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>