<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>15.8. OpenSSL</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="security.html" title="Hoofdstuk 15. Beveiliging" /><link rel="prev" href="kerberos5.html" title="15.7. Kerberos5" /><link rel="next" href="ipsec.html" title="15.9. VPN via IPsec" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.8. OpenSSL</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="kerberos5.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 15. Beveiliging</th><td width="20%" align="right"> <a accesskey="n" href="ipsec.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="openssl"></a>15.8. OpenSSL</h2></div><div><span class="authorgroup">Geschreven door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><a id="idp77589584" class="indexterm"></a><a id="idp77590736" class="indexterm"></a><p>Een toepassing die bij FreeBSD zit die veel gebruikers over het
      hoofd zien is <span class="application">OpenSSL</span>.
      <span class="application">OpenSSL</span> biedt een versleutelde
      transportlaag bovenop de normale communicatielaag.  Daardoor
      biedt het de mogelijkheid met veel netwerktoepassingen en
      diensten verweven te raken.</p><p>Een aantal toepassingen van
      <span class="application">OpenSSL</span> zijn versleutelde
      autenticatie van mailcliënten, webgebaseerde transacties als
      creditcardbetalingen en nog veel meer.   Veel ports zoals
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache22/pkg-descr">www/apache22</a> en
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/mail/claws-mail/pkg-descr">mail/claws-mail</a>
      bieden tijdens het compileren ondersteuning om
      <span class="application">OpenSSL</span> in te bouwen.</p><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">In de meeste gevallen zal de Portscollectie proberen de
	port <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/openssl/pkg-descr">security/openssl</a> te
	bouwen, tenzij de make variabele
	<code class="varname">WITH_OPENSSL_BASE</code> expliciet naar
	<span class="quote">&#8220;<span class="quote">yes</span>&#8221;</span> is gezet.</p></div><p>De versie van <span class="application">OpenSSL</span> die bij FreeBSD
      zit ondersteunt Secure Sockets Layer v2/v3 (SSLv2/SSLv3),
      Transport Layer Security v1 (TLSv1) netwerkbeveiligingsprotocollen
      en kan gebruikt worden als generieke versleutelingsbibliotheek.</p><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">Hoewel <span class="application">OpenSSL</span> ondersteuning
	biedt voor het <acronym class="acronym">IDEA</acronym> algoritme, is dat
	standaard uitgeschakeld in verband met patenten in de Verenigde Staten.
	Om het te gebruiken dient de licentie gelezen te worden en, als
	de restricties aanvaardbaar zijn, dient de make-variabele
	<code class="varname">MAKE_IDEA</code> ingesteld te worden in
	<code class="filename">make.conf</code>.</p></div><p>Een van de meest gebruikte toepassingen van
      <span class="application">OpenSSL</span> is het leveren van
      certificaten voor gebruik met softwaretoepassingen.  Deze
      certificaten verzekeren dat de eigenschappen van een bedrijf
      of individu geldig zijn en niet vervalst.  Als het certificaat
      in kwestie niet geldig verklaard is door een van de
      <span class="quote">&#8220;<span class="quote">Certificate Authorities</span>&#8221;</span> of
      <acronym class="acronym">CA</acronym>'s, dan komt er een waarschuwing.  Een
      Certificate Authority is een bedrijf, zoals <a class="link" href="http://www.verisign.com" target="_top">VeriSign</a>, dat
      certificaten ondertekent zodat de eigenschappen van een bedrijf
      of individu geldig verklaard kunnen worden.  Dit proces kost geld
      en het is zeker geen voorwaarde voor het gebruik van
      certificaten.  Het stelt wel de meer paranoïde gebruikers
      gerust.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77605712"></a>15.8.1. Certificaten maken</h3></div></div></div><a id="idp77606352" class="indexterm"></a><p>Voor het maken van certificaten is het volgende commando
	beschikbaar:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl req -new -nodes -out req.pem -keyout cert.pem</code></strong>
Generating a 1024 bit RSA private key
................
.......................................
writing new private key to 'cert.pem'
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:<strong class="userinput"><code>US</code></strong>
State or Province Name (full name) [Some-State]:<strong class="userinput"><code>PA</code></strong>
Locality Name (eg, city) []:<strong class="userinput"><code>Pittsburgh</code></strong>
Organization Name (eg, company) [Internet Widgits Pty Ltd]:<strong class="userinput"><code>My Company</code></strong>
Organizational Unit Name (eg, section) []:<strong class="userinput"><code>Systems Administrator</code></strong>
Common Name (eg, YOUR name) []:<strong class="userinput"><code>localhost.example.org</code></strong>
Email Address []:<strong class="userinput"><code>trhodes@FreeBSD.org</code></strong>

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:<strong class="userinput"><code>SOME PASSWORD</code></strong>
An optional company name []:<strong class="userinput"><code>Another Name</code></strong></pre><p>Let op dat het antwoord direct na <span class="quote">&#8220;<span class="quote">Common
	  Name</span>&#8221;</span> een domeinnaam weergeeft.  De prompt wil
	dat er een servernaam wordt ingegeven voor het
	verificatieproces.  Het plaatsen van iets anders dan een
	domeinnaam zorgt ervoor dat het certificaat waardeloos wordt.
	Er zijn ook andere opties als verloopdatum, andere
	versleutelingsalgoritmes, etc, beschikbaar.  Een volledige
	lijst is na te lezen in de handleiding van
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=openssl&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">openssl</span>(1)</span></a>.</p><p>Er horen nu twee bestanden te staan in de map waarin het
	voorgaande commando is uitgevoerd.  Het certificaatverzoek,
	<code class="filename">req.pem</code>, kan naar een certificaat
	autoriteit gestuurd worden die de bijgevoegde gegevens kan
	valideren, het verzoek kan tekenen en het certificaat kan
	retourneren.  Het tweede bestand heet
	<code class="filename">cert.pem</code> en is de geheime sleutel voor het
	certificaat.  Deze dient zorgvuldig beschermd te worden.  Als
	de geheime sleutel in de handen van anderen valt kan die
	gebruikt worden om de identiteit van de eigenaar (of server)
	aan te nemen.</p><p>In gevallen waar ondertekening door een
	<acronym class="acronym">CA</acronym> niet vereist is, kan een zelfondertekend
	certificaat gemaakt worden.  Maak als eerste de
	<acronym class="acronym">RSA</acronym> sleutel:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl dsaparam -rand -genkey -out myRSA.key 1024</code></strong></pre><p>Hierna kan de <acronym class="acronym">CA</acronym> sleutel gemaakt
	worden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl gendsa -des3 -out myca.key myRSA.key</code></strong></pre><p>Deze sleutel kan gebruikt worden om een certificaat te
	maken:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl req -new -x509 -days 365 -key myca.key -out new.crt</code></strong></pre><p>Er zouden nu twee bestanden bijgekomen moeten zijn in de
	map: een certificaatautoriteit ondertekeningsbestand
	<code class="filename">myca.key</code> en <code class="filename">new.crt</code>,
	het certificaat zelf.  Deze moeten in een map geplaatst worden,
	bij voorkeur onder <code class="filename">/etc</code>
	waar alleen <code class="systemitem">root</code> kan lezen.  De rechten
	0700 zijn hier prima en die kunnen ingesteld worden met
	<code class="command">chmod</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77627216"></a>15.8.2. Certificaten gebruiken: een voorbeeld</h3></div></div></div><p>En wat kunnen deze bestanden?  Een prima toepassing zou
	het versleutelen van verbindingen naar de
	<span class="application">Sendmail</span> <acronym class="acronym">MTA</acronym>
	kunnen zijn.  Daardoor zouden gebruikers niet langer platte
	tekst hoeven te autenticeren om mail te sturen via de lokale
	<acronym class="acronym">MTA</acronym>.</p><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">Dit is niet de best denkbare toepassing omdat sommige
	  <acronym class="acronym">MUA</acronym>'s de gebruiker een foutmelding geven
	  als ze het certificaat niet lokaal geïnstalleerd hebben.
	  De documentatie bij de software geeft meer informatie over
	  het installeren van certificaten.</p></div><p>De volgende regels moeten opgenomen worden in het lokale
	<code class="filename">.mc</code> bestand:</p><pre class="programlisting">dnl SSL Options
define(`confCACERT_PATH',`/etc/certs')dnl
define(`confCACERT',`/etc/certs/new.crt')dnl
define(`confSERVER_CERT',`/etc/certs/new.crt')dnl
define(`confSERVER_KEY',`/etc/certs/myca.key')dnl
define(`confTLS_SRV_OPTIONS', `V')dnl</pre><p><code class="filename">/etc/certs/</code> is de
	map die gebruikt wordt voor het lokaal opslaan van certificaten
	en sleutels.  De laatste voorwaarde het is opnieuw aanmaken van
	het lokale <code class="filename">.cf</code> bestand.  Dit gaat door
	eenvoudigweg <code class="command">make
	install</code> te typen in de map
	<code class="filename">/etc/mail</code>.  Laat dat
	volgen door <code class="command">make
	install</code> waardoor de daemon
	<span class="application">Sendmail</span> herstart zou moeten
	worden.</p><p>Als alles goed is gegaan, dan staan er geen foutmeldingen
	<code class="filename">/var/log/maillog</code> en is
	<span class="application">Sendmail</span> zichtbaar in de
	proceslijst.</p><p>Maak als eenvoudige test een verbinding met de mailserver
	met <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=telnet&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">telnet</span>(1)</span></a>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>telnet example.com 25</code></strong>
Trying 192.0.34.166...
Connected to <code class="systemitem">example.com</code>.
Escape character is '^]'.
220 <code class="systemitem">example.com</code> ESMTP Sendmail 8.12.10/8.12.10; Tue, 31 Aug 2004 03:41:22 -0400 (EDT)
<strong class="userinput"><code>ehlo example.com</code></strong>
250-example.com Hello example.com [192.0.34.166], pleased to meet you
250-ENHANCEDSTATUSCODES
250-PIPELINING
250-8BITMIME
250-SIZE
250-DSN
250-ETRN
250-AUTH LOGIN PLAIN
250-STARTTLS
250-DELIVERBY
250 HELP
<strong class="userinput"><code>quit</code></strong>
221 2.0.0 <code class="systemitem">example.com</code> closing connection
Connection closed by foreign host.</pre><p>Als de regel <span class="quote">&#8220;<span class="quote">STARTTLS</span>&#8221;</span> verschijnt in de
	uitvoer dan werkt alles correct.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="kerberos5.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="security.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="ipsec.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">15.7. <span class="application">Kerberos5</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 15.9. VPN via IPsec</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>