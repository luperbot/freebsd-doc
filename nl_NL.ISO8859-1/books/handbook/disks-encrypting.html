<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>19.16. Schijfpartities versleutelen</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="disks.html" title="Hoofdstuk 19. Opslag" /><link rel="prev" href="quotas.html" title="19.15. Bestandssysteemquota" /><link rel="next" href="swap-encrypting.html" title="19.17. Het versleutelen van de wisselbestand ruimte" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">19.16. Schijfpartities versleutelen</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="quotas.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 19. Opslag</th><td width="20%" align="right"> <a accesskey="n" href="swap-encrypting.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="disks-encrypting"></a>19.16. Schijfpartities versleutelen</h2></div><div><span class="authorgroup">Bijgedragen door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Lucky</span> <span class="surname">Green</span></span>. </span></div></div></div><a id="idp80540112" class="indexterm"></a><p>FreeBSD biedt uitstekende on-line bescherming tegen onbevoegde
      gegevenstoegang.  Bestandsrechten en Mandatory Access Control
      (MAC) (zie <a class="xref" href="mac.html" title="Hoofdstuk 17. Verplichte Toegangscontrole (MAC)">Hoofdstuk 17, <em>Verplichte Toegangscontrole (MAC)</em></a>) helpen voorkomen dat onbevoegde
      derde partijen toegang tot de gegevens krijgen als het
      besturingssysteem actief is en de computer aanstaat.  De door het
      besturingssysteem afgedwongen rechten zijn echter niet relevant
      als een aanvaller fysieke toegang tot een computer heeft en deze
      de harde schijf van de computer in een ander systeem kan plaatsen
      om de gevoelige gegevens te kopiëren en te
      analyseren.</p><p>Afgezien van hoe een aanvaller in het bezit van een harde
      schijf of een uitgezette computer gekomen is, kan
      <span class="application">GEOM Based Disk Encryption (gbde)</span> de
      gegevens op het bestandssysteem van de computer zelfs tegen
      hooggemotiveerde aanvallers met aanzienlijke middelen beschermen.
      In tegenstelling tot lastige versleutelmethoden die alleen losse
      bestanden versleutelen, versleutelt
      <span class="application">gbde</span> gehele bestandssystemen op een
      transparante manier.  De harde schijf komt nooit in aanraking met
      klare tekst.</p><p>Los van hoe een aanvaller in het bezit van een harde schijf
      of een uitgezette computer gekomen is, kunnen de cryptografische
      subsystemen <span class="application">GEOM Based Disk Encryption
	(gbde)</span> en <code class="command">geli</code> in FreeBSD
      gegevens op bestandssystemen van een computer beschermen tegen
      zelfs de meer gemotiveerde belagers die ook nog eens adequate
      middelen hebben.  Anders dan met lastige versleutelingsmethoden
      die alleen individuele bestanden versleutelen, versleutelen
      <code class="command">gbde</code> en <code class="command">geli</code> transparant
      complete bestandssystemen.  Er komt nooit platte tekst op een
      harde schijf.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80549584"></a>19.16.1. Schijven versleutelen met
	<span class="application">gbde</span></h3></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p class="title"><strong>Word <code class="systemitem">root</code></strong></p><p>Het instellen van <span class="application">gbde</span>
	    vereist beheerdersrechten.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>su -</code></strong>
Password:</pre></li><li class="step"><p class="title"><strong>Voeg ondersteuning voor <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gbde&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">gbde</span>(4)</span></a> aan het
	    kernelinstellingenbestand toe</strong></p><p>Voeg de volgende regel toe aan het
	    kernelinstellingenbestand:</p><p><code class="literal">options GEOM_BDE</code></p><p>Herbouw de kernel opnieuw zoals beschreven in <a class="xref" href="kernelconfig.html" title="Hoofdstuk 9. De FreeBSD-kernel instellen">Hoofdstuk 9, <em>De FreeBSD-kernel instellen</em></a>.</p><p>Start op met de nieuwe kernel.</p></li><li class="step"><p>Een alternatief voor het hercompileren van de kernel
	    is door gebruik te maken van <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kldload&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">kldload</span>(8)</span></a> om
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gbde&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">gbde</span>(4)</span></a> te laden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kldload geom_bde</code></strong></pre></li></ol></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80560720"></a>19.16.1.1. Versleutelde harde schijf voorbereiden</h4></div></div></div><p>In het volgende voorbeeld wordt aangenomen dat er een
	  nieuwe harde schijf aan het systeem wordt toegevoegd die een
	  enkele versleutelde partitie zal bevatten.  Deze partitie
	  wordt aangekoppeld als <code class="filename">/private</code>.
	  <span class="application">gbde</span> kan ook gebruikt worden om
	  <code class="filename">/home</code> en <code class="filename">/var/mail</code>
	  te versleutelen, maar daarvoor zijn complexere instructies
	  nodig die buiten het bereik van deze inleiding vallen.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p class="title"><strong>Voeg een nieuwe harde schijf toe</strong></p><p>Voeg de nieuwe harde schijf toe zoals beschreven in
	      <a class="xref" href="disks-adding.html" title="19.3. Schijven toevoegen">Paragraaf 19.3, &#8220;Schijven toevoegen&#8221;</a>.  In dit voorbeeld is een
	      nieuwe harde schijfpartitie toegevoegd als
	      <code class="filename">/dev/ad4s1c</code>.  De apparaten
	      <code class="filename">/dev/ad0s1*</code>
	      stellen bestaande standaard FreeBSD partities van het
	      voorbeeldsysteem voor.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ls /dev/ad*</code></strong>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4</pre></li><li class="step"><p class="title"><strong>Maak een map aan voor gbde lockbestanden</strong></p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /etc/gbde</code></strong></pre><p>Het lockbestand voor <span class="application">gbde</span>
	      bevat informatie die <span class="application">gbde</span>
	      nodig heeft om toegang te krijgen tot versleutelde
	      partities.  Zonder toegang tot de lockbestand is
	      <span class="application">gbde</span> niet in staat om de
	      gegevens die op de versleutelde partitie staan te
	      ontsleutelen zonder aanzienlijke handmatige tussenkomst die
	      niet door de software ondersteund wordt.  Elke versleutelde
	      partitie gebruikt een ander lockbestand.</p></li><li class="step"><p class="title"><strong>Initialiseer de gbde-partitie</strong></p><p>Een <span class="application">gbde</span>-partitie dient
	      geïnitialiseerd te worden voordat deze kan worden
	      gebruikt.  Deze initialisatie dient slechts eenmalig
	      uitgevoerd te worden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>gbde init /dev/ad4s1c -i -L /etc/gbde/ad4s1c.lock</code></strong></pre><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gbde&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gbde</span>(8)</span></a> opent een tekstverwerker om verschillende
	      instellingen in een sjabloon te kunnen instellen.  Stel de
	      sector_size in op 2048 als UFS of UFS2 wordt
	      gebruikt:</p><pre class="programlisting"># $FreeBSD: src/sbin/gbde/template.txt,v 1.1 2002/10/20 11:16:13 phk Exp $
#
# Sector size is the smallest unit of data which can be read or written.
# Making it too small decreases performance and decreases available space.
# Making it too large may prevent filesystems from working.  512 is the
# minimum and always safe.  For UFS, use the fragment size
#
sector_size	=	2048
[...]</pre><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gbde&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gbde</span>(8)</span></a> vraagt twee keer om de wachtwoordzin
	      voor het beveiligen van de gegevens.  De wachtwoordzin
	      dient beide keren hetzelfde te zijn.  De mogelijkheid van
	      <span class="application">gbde</span> om de gegevens te
	      beveiligen is geheel afhankelijk de gekozen
	      wachtwoordzin.
	      <a href="#ftn.idp80583760" class="footnote" id="idp80583760"><sup class="footnote">[10]</sup></a></p><p>Het commando <code class="command">gbde init</code> maakt een
	      lockbestand aan voor de
	      <span class="application">gbde</span>-partitie die in dit
	      voorbeeld is opgeslagen als
	      <code class="filename">/etc/gbde/ad4s1c.lock</code>.
	      <span class="application">gdbde</span> slotbestanden moeten
	      eindigen op <span class="quote">&#8220;<span class="quote">.lock</span>&#8221;</span> om correct door het
	      opstartscript <code class="filename">/etc/rc.d/gbde</code>
	      gedetecteerd te worden.</p><div xmlns="" class="caution"><h3 class="admontitle">Let op: </h3><p xmlns="http://www.w3.org/1999/xhtml"><span class="application">gbde</span> lockbestanden
		<span class="emphasis"><em>moeten</em></span> samen met de inhoud van
		versleutelde partities geback-upped worden.  Hoewel het
		verwijderen van een lockbestand op zich een gedreven
		aanvaller er niet van weerhoudt een
		<span class="application">gbde</span> partitie te
		ontsleutelen, is de wettige eigenaar zonder het
		lockbestand niet in staat om de gegevens op de
		versleutelde partitie te benaderen zonder een
		aanzienlijke hoeveelheid werk die in het geheel niet
		ondersteund wordt door <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gbde&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gbde</span>(8)</span></a> of de ontwerper
		ervan.</p></div></li><li class="step"><p class="title"><strong>Koppel de versleutelde partitie aan de kernel</strong></p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</code></strong></pre><p>Er wordt om de wachtwoordzin gevraagd die gekozen is
	      tijdens de initialisatie van de versleutelde partitie.  Het
	      nieuwe versleutelde apparaat verschijnt in
	      <code class="filename">/dev</code> als
	      <code class="filename">/dev/apparaatnaam.bde</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ls /dev/ad*</code></strong>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4        /dev/ad4s1c.bde</pre></li><li class="step"><p class="title"><strong>Maak een bestandssysteem op het versleutelde
	      apparaat</strong></p><p>Nu het versleutelde apparaat aan de kernel gekoppeld
	      is, kan een bestandssysteem op het apparaat aangemaakt
	      worden.  Met <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> kan een bestandssysteem op het
	      versleutelde apparaat aangemaakt wordne.  Aangezien het
	      veel sneller is om een nieuw UFS2 bestandssysteem te
	      initialiseren dan om een oud UFS1 bestandssysteem te
	      initialiseren, is het aan te raden om <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> met de
	      optie <code class="option">-O2</code> te gebruiken.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>newfs -U -O2 /dev/ad4s1c.bde</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">Voer <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> uit op een aangekoppelde
		<span class="application">gbde</span>-partitie die
		geïndificeerd wordt door de uitbreiding
		<code class="filename">*.bde</code> op
		de apparaatnaam.</p></div></li><li class="step"><p class="title"><strong>Mount de versleutelde partitie</strong></p><p>Maak een koppelpunt voor het versleutelde
	      bestandssysteem aan:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /private</code></strong></pre><p>Mount het versleutelde bestandssysteem:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /dev/ad4s1c.bde /private</code></strong></pre></li><li class="step"><p class="title"><strong>Controleer of het versleutelde bestandssysteem
	      beschikbaar is</strong></p><p>Het versleutelde bestandssysteem is nu zichtbaar
	      met <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=df&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">df</span>(1)</span></a> en gebruiksklaar:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>df -H</code></strong>
Filesystem        Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a      1037M    72M   883M     8%    /
/devfs            1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f       8.1G    55K   7.5G     0%    /home
/dev/ad0s1e      1037M   1.1M   953M     0%    /tmp
/dev/ad0s1d       6.1G   1.9G   3.7G    35%    /usr
/dev/ad4s1c.bde   150G   4.1K   138G     0%    /private</pre></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80619856"></a>19.16.1.2. Bestaande versleutelde bestandssystemen aankoppelen</h4></div></div></div><p>Elke keer nadat het systeem is opgestart dient elk
	  versleuteld bestandssysteem opnieuw aan de kernel gekoppeld
	  te worden, op fouten gecontroleerd te worden, en aangekoppeld
	  te worden voordat de bestandssystemen gebruikt kunnen worden.
	  De benodigde commando's dienen als de gebruiker
	  <code class="systemitem">root</code> uitgevoerd te worden.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p class="title"><strong>Koppel de gbde-partitie aan de kernel</strong></p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</code></strong></pre><p>Er wordt om de wachtwoordzin gevraagd die gekozen is
	      tijdens de initialisatie van de versleutelde
	      <span class="application">gbde</span>-partitie.</p></li><li class="step"><p class="title"><strong>Controleer het bestandssysteem op fouten</strong></p><p>Aangezien het nog niet mogelijk is om versleutelde
	      bestandssystemen op te nemen in
	      <code class="filename">/etc/fstab</code> voor automatische controle,
	      dienen de bestandssystemen voordat ze aangekoppeld worden
	      handmatig op fouten gecontroleerd te worden door
	      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a> uit te voeren:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>fsck -p -t ffs /dev/ad4s1c.bde</code></strong></pre></li><li class="step"><p class="title"><strong>Mount het versleutelde bestandssysteem</strong></p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /dev/ad4s1c.bde /private</code></strong></pre><p>Het versleutelde bestandssysteem is nu klaar voor
	      gebruik.</p></li></ol></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80629712"></a>19.16.1.2.1. Versleutelde partities automatisch aankoppelen</h5></div></div></div><p>Het is mogelijk om een script aan te maken om
	    automatisch een versleutelde partitie aan te koppelen, op
	    fouten te controleren en aan te koppelen, maar vanwege
	    veiligheidsredenen dient het script niet het wachtwoord
	    voor <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gbde&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gbde</span>(8)</span></a> te bevatten.  In plaats hiervan wordt het
	    aangeraden om zulke scripts handmatig uit te voeren en het
	    wachtwoord via de console of <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a> te geven.</p><p>Als alternatief, wordt er een <code class="filename">rc.d</code>
	    script bijgeleverd.  De argumenten kunnen via <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>
	    doorgegeven worden.  Bijvoorbeeld:</p><pre class="programlisting">gbde_autoattach_all="YES"
gbde_devices="ad4s1c"
gbde_lockdir="/etc/gbde"</pre><p>Hierdoor is het noodzakelijk dat de wachtwoordzin voor
	    <span class="application">gbde</span> bij het starten wordt
	    ingegeven.  Na het invoeren van de juiste wachtwoordzin
	    wordt de met <span class="application">gbde</span> versleutelde
	    partitie automatisch aangekoppeld.  Dit kan erg handig zijn
	    bij het gebruik van <span class="application">gbde</span> op
	    notebooks.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80636112"></a>19.16.1.3. Door gbde gebruikte cryptografische
	  beschermingen</h4></div></div></div><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gbde&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gbde</span>(8)</span></a> versleutelt de sectorlading door gebruik te
	  maken van 128-bit AES in CBC-modus.  Elke sector op de schijf
	  wordt met een andere AES-sleutel versleuteld.  Meer
	  informatie over het cryptografische ontwerp van
	  <span class="application">gbde</span>, inclusief de methode die
	  gebruikt wordt om de sectorsleutels van de door de gebruiker
	  gegeven wachtwoordzin af te leiden, staan in
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gbde&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">gbde</span>(4)</span></a>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80639056"></a>19.16.1.4. Compatibiliteitspunten</h4></div></div></div><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysinstall&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysinstall</span>(8)</span></a> is niet compatibel met apparaten die
	  met <span class="application">gbde</span> versleuteld zijn.  Alle
	  <code class="filename">*.bde</code>
	  apparaten moeten van de kernel ontkoppeld worden voordat
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysinstall&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysinstall</span>(8)</span></a> gebruikt wordt om te voorkomen dat het
	  crasht tijdens het initiële zoeken naar apparaten.  Om
	  het versleutelde apparaat dat in dit voorbeeld gebruikt wordt
	  te ontkoppelen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>gbde detach /dev/ad4s1c</code></strong></pre></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80651728"></a>19.16.2. Schijfversleuteling met <code class="command">geli</code></h3></div><div><span class="authorgroup">Bijgedragen door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Daniel</span> <span class="surname">Gerzo</span></span>. </span></div></div></div><p>Een alternatieve cryptografische GEOM klassie is beschikbaar
	- <code class="command">geli</code>.  Deze wordt
	op het moment ontwikkeld door Pawel Jakub Dawidek <code class="email">&lt;<a xmlns="" class="email" href="mailto:pjd@FreeBSD.org">pjd@FreeBSD.org</a>&gt;</code>.  <code class="command">geli</code>
	verschilt van <code class="command">gbde</code> in de mogelijkheden en in
	het gebruik van een andere methode voor het
	versleutelen.</p><p>De meest belangrijke mogelijkheden van <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=geli&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">geli</span>(8)</span></a>
	zijn:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Gebruikt het <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=crypto&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">crypto</span>(9)</span></a> framework;  als
	    cryptografische hardware aanwezig is, gebruikt
	    <code class="command">geli</code> die automatisch;</p></li><li class="listitem"><p>Ondersteunt meedere cryptografische algoritmen.  Op dit
	    moment AES, Blowfish en 3DES;</p></li><li class="listitem"><p>Staat toe dat de root-partitie wordt versleuteld.  De
	    wachtwoordzin die wordt gebruikt om de root-partitie te
	    versleutelen wordt opgevraagd tijdens het starten van een
	    systeem;</p></li><li class="listitem"><p>Staat het gebruik van twee onafhankelijke sleutels toe,
	    bijvoorbeeld een <span class="quote">&#8220;<span class="quote">sleutel</span>&#8221;</span> en een
	    <span class="quote">&#8220;<span class="quote">bedrijfssleutel</span>&#8221;</span>);</p></li><li class="listitem"><p><code class="command">geli</code> is snel;  het werkt met
	    sector-naar-sector versleuteling;</p></li><li class="listitem"><p>Ondersteunt back-up en restore van Master Keys.  Als
	    een gebruiker sleutels moet vernietigen, is het mogelijk
	    weer toegang te krijgen tot de gegevens door sleutels uit
	    een back-up te halen;</p></li><li class="listitem"><p>Ondersteunt het koppelen van een schijf met een
	    willekeurige, eenmalige sleutel.  Handig voor
	    swap-partities en tijdelijke bestandssystemen.</p></li></ul></div><p>Meer mogelijkheden van <code class="command">geli</code> staan
	beschreven in de handleiding van <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=geli&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">geli</span>(8)</span></a>.</p><p>De volgende stappen beschrijven hoe ondersteuning voor
	<code class="command">geli</code> in de FreeBSD-kernel ingeschakeld kan
	worden en hoe een nieuwe <code class="command">geli</code>
	versleutelingsvoorziening gemaakt kan worden.</p><p>Het is noodzakelijk super-user rechten te hebben omdat
	de kernel wordt aangepast.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p class="title"><strong>Toevoegen van <code class="command">geli</code>-ondersteuning</strong></p><p>Voeg de volgende regels toe aan het bestand met
	    kernelinstellingen:</p><pre class="programlisting">options GEOM_ELI
device crypto</pre><p>Herbouw de kernel zoals beschreven is in <a class="xref" href="kernelconfig.html" title="Hoofdstuk 9. De FreeBSD-kernel instellen">Hoofdstuk 9, <em>De FreeBSD-kernel instellen</em></a>.</p><p>De <code class="command">geli</code>-module kan ook bij het
	    opstarten geladen worden.  Voeg de volgende regel toe aan
	    <code class="filename">/boot/loader.conf</code>:</p><pre class="programlisting">geom_eli_load="YES"</pre><p>Nu hoort <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=geli&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">geli</span>(8)</span></a> door de kernel ondersteund te
	    worden.</p></li><li class="step"><p class="title"><strong>Een Master Key genereren</strong></p><p>Het volgende voorbeeld beschrijft hoe een
	    sleutelbestand te maken, dat wordt gebruikt als onderdeel
	    van de Master Key voor de versleutelde dienst die wordt
	    aangekoppeld onder <code class="filename">/private</code>.  Het sleutelbestand
	    zorgt voor wat willekeurige gegevens die worden gebruikt
	    om de Master Key te versleutelen.  De Master Key wordt ook
	    door een wachtwoordzin beschermd.  De sectorgrootte van de
	    dienst wordt 4 kB.  Ook wordt beschreven hoe de
	    <code class="command">geli</code>-dienst te koppelen, er een
	    bestandsysteem op te maken, dat aan te koppelen, hoe ermee
	    te werken en tenslotte hoe te ontkoppelen.</p><p>Het wordt aangeraden een grotere sectorgrootte in te
	    stellen (zoals 4 kB) voor betere prestaties.</p><p>De Master Key wordt beschermd door een wachtwoordzin en
	    de gegevensbron voor het sleutelbestand wordt
	    <code class="filename">/dev/random</code>.  De sectorgrootte van
	    <code class="filename">/dev/da2.eli</code>, die als dienst wordt
	    aangeduid, wordt 4 kB.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/dev/random of=/root/da2.key bs=64 count=1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>geli init -s 4096 -K /root/da2.key /dev/da2</code></strong>
Enter new passphrase:
Reenter new passphrase:</pre><p>Het is niet verplicht om zowel een wachtwoordzijn als
	    een sleutelbestand te gebruiken.  De methodes kunnen
	    onafhankelijk van elkaar gebruikt worden.</p><p>Als een sleutelbestand wordt opgegeven als
	    <span class="quote">&#8220;<span class="quote">-</span>&#8221;</span>, wordt de standaardinvoer gebruikt.  In
	    het onderstaande voorbeeld wordt aangegeven hoe meer dan
	    een sleutelbestand kan worden gebruikt.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cat sleutelbestand1 sleutelbestand2 sleutelbestand3 | geli init -K - /dev/da2</code></strong></pre></li><li class="step"><p class="title"><strong>De dienst koppelen met de gemaakte sleutel</strong></p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>geli attach -k /root/da2.key /dev/da2</code></strong>
Enter passphrase:</pre><p>Het nieuwe platte tekst-apparaat wordt
	    <code class="filename">/dev/da2.eli</code>
	    genoemd.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ls /dev/da2*</code></strong>
/dev/da2  /dev/da2.eli</pre></li><li class="step"><p class="title"><strong>Het nieuwe bestandssysteem maken</strong></p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/dev/random of=/dev/da2.eli bs=1m</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>newfs /dev/da2.eli</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/da2.eli /private</code></strong></pre><p>Het versleutelde bestandssysteem moet nu zichtbaar zijn
	    voor <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=df&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">df</span>(1)</span></a> en beschikbaar zijn voor gebruik:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>df -H</code></strong>
Filesystem     Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a    248M    89M   139M    38%    /
/devfs         1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f    7.7G   2.3G   4.9G    32%    /usr
/dev/ad0s1d    989M   1.5M   909M     0%    /tmp
/dev/ad0s1e    3.9G   1.3G   2.3G    35%    /var
/dev/da2.eli   150G   4.1K   138G     0%    /private</pre></li><li class="step"><p class="title"><strong>De dienst afkoppelen</strong></p><p>Als het werk met de versleutelde partitie is
	    afgehandeld en de <code class="filename">/private</code>-partitie niet langer
	    nodig is, dan is het verstandig te overwegen de met
	    <code class="command">geli</code> versleutelde partitie af te koppelen
	    van het bestandssysteem en de kernel.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>umount /private</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>geli detach da2.eli</code></strong></pre></li></ol></div><p>Meer informatie over <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=geli&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">geli</span>(8)</span></a> staat in de
	handleiding.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80708304"></a>19.16.2.1. Gebruik maken van het <code class="filename">geli</code>
	  <code class="filename">rc.d</code> script.</h4></div></div></div><p>Bij <code class="command">geli</code> hoort een <code class="filename">rc.d</code>
	  script dat gebruikt kan worden om het gebruik van
	  <code class="command">geli</code> te vereenvoudigen.  Een voorbeeld van
	  hoe <code class="command">geli</code> met <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> ingesteld
	  kan worden volgt:</p><pre class="programlisting">geli_devices="da2"
geli_da2_flags="-p -k /root/da2.key"</pre><p>Hiermee wordt <code class="filename">/dev/da2</code> ingesteld als
	  <code class="command">geli</code>-dienst met Master Key-bestand
	  <code class="filename">/root/da2.key</code> en <code class="command">geli</code>
	  gebruikt geen wachtwoordzin als de dienst wordt gekoppeld
	  (dit kan alleen gebruikt worden als <code class="option">-P</code> is meegegeven
	  tijdens de <code class="literal">geli init</code> fase van
	  <code class="command">geli</code>).  Een systeem ontkoppelt de
	  <code class="command">geli</code>-dienst van de kernel voordat het
	  afsluit.</p><p>Meer informatie over het instellen van rc.d staat in
	  het onderdeel over <a class="link" href="configtuning-rcd.html" title="12.7. Gebruik van rc met FreeBSD">rc.d</a>.</p></div></div><div class="footnotes"><br /><hr class="footnote-hr" /><div id="ftn.idp80583760" class="footnote"><p><a href="#idp80583760" class="para"><sup class="para">[10] </sup></a>Tips met betrekking tot het kiezen van veilige
		  wachtwoordzinnen die gemakkelijk te onthouden zijn
		  staan op de website <a class="link" href="http://world.std.com/~reinhold/diceware.html" target="_top">
		    Diceware Passphrase</a>.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="quotas.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="disks.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="swap-encrypting.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">19.15. Bestandssysteemquota </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 19.17. Het versleutelen van de wisselbestand ruimte</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>