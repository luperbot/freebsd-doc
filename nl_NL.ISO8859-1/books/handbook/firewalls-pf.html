<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>30.4. De OpenBSD Packet Filter (PF) en ALTQ</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="firewalls.html" title="Hoofdstuk 30. Firewalls" /><link rel="prev" href="firewalls-apps.html" title="30.3. Firewallsoftware" /><link rel="next" href="firewalls-ipf.html" title="30.5. De IPFILTER (IPF) firewall" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">30.4. De OpenBSD Packet Filter (PF) en <acronym class="acronym">ALTQ</acronym></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="firewalls-apps.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 30. Firewalls</th><td width="20%" align="right"> <a accesskey="n" href="firewalls-ipf.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="firewalls-pf"></a>30.4. De OpenBSD Packet Filter (PF) en <acronym class="acronym">ALTQ</acronym></h2></div><div><span class="authorgroup">Herzien en bijgewerkt door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">John</span> <span class="surname">Ferrell</span></span>. </span></div></div></div><a id="idp87983568" class="indexterm"></a><p>Vanaf juli 2003 is de OpenBSD firewalltoepassing
      <acronym class="acronym">PF</acronym> geporteerd naar FreeBSD en beschikbaar gekomen
      in de FreeBSD Portscollectie.  In 2004 was FreeBSD 5.3 de
      eerste release die <acronym class="acronym">PF</acronym> bevatte is integraal
      onderdeel van het basissysteem.  <acronym class="acronym">PF</acronym> is een
      complete en volledige firewall die optioneel
      <acronym class="acronym">ALTQ</acronym> bevat (Alternate Queuing).
      <acronym class="acronym">ALTQ</acronym> biedt Quality of Service
      (<acronym class="acronym">QoS</acronym>) functionaliteit.</p><p>het OpenBSD Project levert een uitstekend werk wat betreft het
      onderhouden van de <a class="link" href="http://www.openbsd.org/faq/pf/" target="_top">PF FAQ</a>.  Zodoende
      zal deze sectie van het handboek zich richten op
      <acronym class="acronym">PF</acronym> met betrekking tot FreeBSD terwijl het ook wat
      algemene informatie over het gebruik zal geven.  Voor
      gedetailleerde gebruikersinformatie wordt naar de <a class="link" href="http://www.openbsd.org/faq/pf/" target="_top">PF FAQ</a> verwezen.</p><p>Meer informatie over <acronym class="acronym">PF</acronym> voor FreeBSD staat op
      <code class="uri"><a class="uri" href="http://pf4freebsd.love2party.net/" target="_top">http://pf4freebsd.love2party.net/</a></code>.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87990480"></a>30.4.1. De laadbare kernelmodules voor PF gebruiken</h3></div></div></div><p>Voeg de volgende regel toe aan <code class="filename">/etc/rc.conf</code> om
	de kernelmodule PF te laden:</p><pre class="programlisting">pf_enable="YES"</pre><p>Draai vervolgens het opstartscript om de module te laden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service pf start</code></strong></pre><p>Merk op dat de PF module niet laadt als het het instellingenbestand
	met de regelverzameling niet kan vinden.  De standaardlocatie is
	<code class="filename">/etc/pf.conf</code>.  Als de regelverzameling voor PF zich
	elders bevindt, kan PF worden verteld om daar te kijken een regel
	analoog aan de volgende aan <code class="filename">/etc/rc.conf</code> toe te
	voegen:</p><pre class="programlisting">pf_rules="<em class="replaceable"><code>/pad/naar/pf.conf</code></em>"</pre><p>Het voorbeeld <code class="filename">pf.conf</code> bestand
	kan gevonden worden in <code class="filename">/usr/share/examples/pf</code></p><p>De module <acronym class="acronym">PF</acronym> kan ook handmatig vanaf de
	opdrachtregel geladen worden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kldload pf.ko</code></strong></pre><p>Logondersteuning voor PF wordt geleverd door
	<code class="literal">pflog.ko</code> en kan worden geladen door de volgende regel
	aan <code class="filename">/etc/rc.conf</code> toe te voegen:</p><pre class="programlisting">pflog_enable="YES"</pre><p>Draai vervolgens het opstartscript om de module te laden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service pflog start</code></strong></pre><p>Als u andere mogelijkheden van <acronym class="acronym">PF</acronym> nodig heeft
	dient u ondersteuning voor <acronym class="acronym">PF</acronym> in de kernel te
	compileren.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88006608"></a>30.4.2. Kernelopties voor PF</h3></div></div></div><a id="idp88007248" class="indexterm"></a><a id="idp88008400" class="indexterm"></a><a id="idp88009552" class="indexterm"></a><p>Hoewel het niet nodig is om ondersteuning voor
	<acronym class="acronym">PF</acronym> in de kernel te compileren, biedt dit wel
	de mogelijkheid om van een van PF's geavanceerde mogelijkheden
	gebruik te maken die niet in de laadbare module zitten, namelijk
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfsync&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pfsync</span>(4)</span></a>, dat een pseudo-apparaat is dat zekere
	veranderingen aan de toestandstabel die door
	<acronym class="acronym">PF</acronym> wordt gebruikt prijsgeeft.  Het kan worden
	gecombineerd met <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=carp&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">carp</span>(4)</span></a> om failover firewalls aan te maken
	die gebruik maken van <acronym class="acronym">PF</acronym>.  Meer informatie
	over <acronym class="acronym">CARP</acronym> kan gevonden worden in <a class="xref" href="carp.html" title="31.13. Common Address Redundancy Protocol (CARP)">Paragraaf 31.13, &#8220;Common Address Redundancy Protocol (CARP)&#8221;</a> van het Handboek.</p><p>De kernelopties voor <acronym class="acronym">PF</acronym> kunnen gevonden
	worden in <code class="filename">/usr/src/sys/conf/NOTES</code> en zijn
	hieronder gereproduceerd:</p><pre class="programlisting">device pf
device pflog
device pfsync</pre><p>De optie <code class="literal">device pf</code> schakelt ondersteuning
	voor de <span class="quote">&#8220;<span class="quote">Packet Filter</span>&#8221;</span> firewall (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pf&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pf</span>(4)</span></a>) in.</p><p>De optie <code class="literal">device pflog</code> schakelt het
	optionele <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pflog&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pflog</span>(4)</span></a> pseudo-netwerkapparaat in dat gebruikt
	kan worden om verkeer te loggen naar een <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bpf&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bpf</span>(4)</span></a>
	descriptor.  De <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pflogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pflogd</span>(8)</span></a> daemon kan gebruikt worden om
	de logboekinformatie naar schijf te schrijven.</p><p>De optie <code class="literal">device pfsync</code> schakelt het
	optionele <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfsync&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pfsync</span>(4)</span></a> pseudo netwerkapparaat in waarmee de
	toestandswijzigingen gemonitord kunnen worden.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88031184"></a>30.4.3. Beschikbare opties voor <code class="filename">rc.conf</code></h3></div></div></div><p>De volgende <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> statements stellen
	<acronym class="acronym">PF</acronym> en <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pflog&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pflog</span>(4)</span></a> in tijdens het opstarten:</p><pre class="programlisting">pf_enable="YES"                 # Schakel PF in (laad module als nodig)
pf_rules="/etc/pf.conf"         # bestand met regels voor pf
pf_flags=""                     # aanvullende vragen voor opstarten pfctl
pflog_enable="YES"              # start pflogd(8)
pflog_logfile="/var/log/pflog"  # waar pflogd het logboekbestand moet opslaan
pflog_flags=""                  # aanvullende vlaggen voor opstarten pflogd</pre><p>Als er een LAN achter de firewall staat en er pakketten
	doorgestuurd moeten worden naar computers op het LAN of als
	NAT actief is, dan is de volgende optie ook nodig:</p><pre class="programlisting">gateway_enable="YES"            # Schakel in als LAN gateway</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88035664"></a>30.4.4. Filterregels aanmaken</h3></div></div></div><p><acronym class="acronym">PF</acronym> leest de instelregels van
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pf.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">pf.conf</span>(5)</span></a> (standaard <code class="filename">/etc/pf.conf</code>) en
	het verandert, verwijdert, of geeft pakketten door aan de hand
	van de regels of definities die daar zijn gespecificeerd.  De
	FreeBSD-installatie bevat een aantal voorbeeldbestanden in
	<code class="filename">/usr/share/examples/pf/</code>.  In de <a class="link" href="http://www.openbsd.org/faq/pf/" target="_top">PF FAQ</a> staat een
	complete behandeling van de <acronym class="acronym">PF</acronym> regels.</p><div xmlns="" class="warning"><h3 class="admontitle">Waarschuwing: </h3><p xmlns="http://www.w3.org/1999/xhtml">Houd tijdens het doornemen van de <a class="link" href="http://www.openbsd.org/faq/pf" target="_top">PF FAQ</a> in de gaten dat
	  verschillende versies van FreeBSD verschillende versies van PF kunnen
	  bevatten.  Momenteel gebruikt FreeBSD 8.<em class="replaceable"><code>X</code></em>
	  dezelfde versie van <acronym class="acronym">PF</acronym> als OpenBSD 4.1.
	  FreeBSD 9.<em class="replaceable"><code>X</code></em> en hoger gebruiken dezelfde
	  versie van PF als OpenBSD 4.5.</p></div><p>De <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-pf" target="_top">FreeBSD pakketfilter mailinglijst</a> is een goede plaats om vragen over het instellen
	en draaien van de <acronym class="acronym">PF</acronym> firewall te stellen.
	Vergeet niet de mailinglijstarchieven te controleren alvorens
	vragen te stellen!</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88043472"></a>30.4.5. Werken met PF</h3></div></div></div><p>Gebruik <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pfctl</span>(8)</span></a> om <acronym class="acronym">PF</acronym> te beheren.
	Hieronder staan wat nuttige commando's (bekijk de hulppagina
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pfctl</span>(8)</span></a> voor alle beschikbare opties):</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>Commando</th><th>Doel</th><th> </th><th> </th></tr></thead><tbody><tr><td><code class="command">pfctl -e</code></td><td>PF aanzetten</td><td> </td><td> </td></tr><tr><td><code class="command">pfctl -d</code></td><td>PF uitzetten</td><td> </td><td> </td></tr><tr><td><code class="command">pfctl -F all -f /etc/pf.conf</code></td><td>Spoel alle regels door (nat, filter, toestand,
		tabel, etc.) en herlaad vanuit het bestand
		<code class="filename">/etc/pf.conf</code></td><td><code class="command">pfctl -s [ rules | nat | state ]</code></td><td>Rapporteer over de filterregels, NAT-regels, of
		toestandstabel</td></tr><tr><td><code class="command">pfctl -vnf /etc/pf.conf</code></td><td>Controleer <code class="filename">/etc/pf.conf</code> op
		fouten, maar laad de regelverzameling niet</td><td> </td><td> </td></tr></tbody></table></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88074960"></a>30.4.6. <acronym class="acronym">ALTQ</acronym> inschakelen</h3></div></div></div><p><acronym class="acronym">ALTQ</acronym> is alleen beschikbaar ondersteuning
	ervoor in de FreeBSD Kernel te compileren.  <acronym class="acronym">ALTQ</acronym>
	wordt niet door alle netwerkkaartstuurprogramma's ondersteund.
	In <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=altq&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">altq</span>(4)</span></a> staat een lijst met ondersteunde
	stuurprogramma's voor de betreffende versie.</p><p>Met de volgende opties wordt <acronym class="acronym">ALTQ</acronym>
	ingeschakeld en additionele functionaliteit toegevoegd:</p><pre class="programlisting">options         ALTQ
options         ALTQ_CBQ        # Class Bases Queuing (CBQ)
options         ALTQ_RED        # Random Early Detection (RED)
options         ALTQ_RIO        # RED In/Out
options         ALTQ_HFSC       # Hierarchical Packet Scheduler (HFSC)
options         ALTQ_PRIQ       # Priority Queuing (PRIQ)
options         ALTQ_NOPCC      # Required for SMP build</pre><p><code class="literal">options ALTQ</code> schakelt het
	<acronym class="acronym">ALTQ</acronym> raamwerk in.</p><p><code class="literal">options ALTQ_CBQ</code> schakelt <span class="emphasis"><em>Class Based
	  Queuing</em></span> (<acronym class="acronym">CBQ</acronym>) in.  Met
	<acronym class="acronym">CBQ</acronym> kan de bandbreedte van een verbinding
	worden opgedeeld in verschillende klassen of wachtrijen om
	verkeer te prioriteren op basis van filterregels.</p><p><code class="literal">options ALTQ_RED</code> schakelt <span class="emphasis"><em>Random Early
	  Detection</em></span> (<acronym class="acronym">RED</acronym>) in.
	<acronym class="acronym">RED</acronym> wordt gebruikt om netwerkverstopping te
	voorkomen.  <acronym class="acronym">RED</acronym> doet dit door de lengte van de
	wachtrij te meten en die te vergelijken met de minimale en maximale
	drempelwaarden voor de wachtrij.  Als de wachtrij groter is
	dan de maximale waarde worden alle nieuwe pakketten genegeerd.
	Het werkt naar zijn naam, dus <acronym class="acronym">RED</acronym> negeert
	willekeurig pakketten van verschillende verbindingen.</p><p><code class="literal">options ALTQ_RIO</code> schakelt <span class="emphasis"><em>Random Early
	  Detection In and Out</em></span> in.</p><p><code class="literal">options ALTQ_HFSC</code> schakelt de
	<span class="emphasis"><em>Hierarchical Fair Service Curve Packet Scheduler</em></span>
	in.  Meer informatie over <acronym class="acronym">HFSC</acronym> staat op <code class="uri"><a class="uri" href="http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html" target="_top">http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html</a></code>.</p><p><code class="literal">options ALTQ_PRIQ</code> schakelt <span class="emphasis"><em>Priority
	  Queuing</em></span> (<acronym class="acronym">PRIQ</acronym>) in.
	<acronym class="acronym">PRIQ</acronym> laat verkeer dat in een hogere wachtrij staat
	altijd eerder door.</p><p><code class="literal">options ALTQ_NOPCC</code> schakelt
	<acronym class="acronym">SMP</acronym> ondersteuning voor
	<acronym class="acronym">ALTQ</acronym> in.  Deze optie is verplicht op
	<acronym class="acronym">SMP</acronym> systemen.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="firewalls-apps.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="firewalls.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="firewalls-ipf.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">30.3. Firewallsoftware </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 30.5. De IPFILTER (IPF) firewall</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>