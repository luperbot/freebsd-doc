<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>24.9. Meerdere machines bijwerken</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="updating-upgrading.html" title="Hoofdstuk 24. FreeBSD updaten en upgraden" /><link rel="prev" href="make-delete-old.html" title="24.8. Het verwijderen van overbodige bestanden, directories en bibliotheken" /><link rel="next" href="dtrace.html" title="Hoofdstuk 25. DTrace" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">24.9. Meerdere machines bijwerken</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="make-delete-old.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 24. FreeBSD updaten en upgraden</th><td width="20%" align="right"> <a accesskey="n" href="dtrace.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="small-lan"></a>24.9. Meerdere machines bijwerken</h2></div><div><span class="authorgroup">Bijgedragen door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Mike</span> <span class="surname">Meyer</span></span>. </span></div></div></div><a id="idp83424208" class="indexterm"></a><p>Als er meerdere machines zijn die dezelfde broncode
      bijhouden, lijkt het downloaden van alle broncode en alles overal
      opnieuw bouwen zonde van de bronnen: harde schijfruimte, netwerk
      bandbreedte, en processorbelasting.  Dit klopt en de oplossing is
      om alles op één machine te doen terwijl de overige
      machines het uitgevoerde werk benaderen via NFS.  Nu wordt een
      methode beschreven waarmee dit gedaan kan worden.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="small-lan-preliminaries"></a>24.9.1. Benodigdheden</h3></div></div></div><p>Als eerste moet er een groep van machines gekozen worden
	die dezelfde set aan binaire bestanden zal draaien, hier een
	<span class="emphasis"><em>bouwgroep</em></span>.  Elke machine kan een eigen
	afwijkende kernel hebben maar moet dezelfde binaire
	gebruikersbestanden draaien.  Uit die groep moet een machine
	gekozen worden die de <span class="emphasis"><em>bouwmachine</em></span> wordt.
	Dit wordt de machine waar de wereld en kernel op gebouwd
	worden.  In het meest ideale geval is dit een snelle machine
	die genoeg processorkracht vrij heeft om <code class="command">make
	  buildworld</code> en <code class="command">make buildkernel</code>
	te draaien.  Er moet ook een machine gekozen worden die de
	<span class="emphasis"><em>testmachine</em></span> wordt waarop alle bijgewerkte
	software wordt test voordat die in productie wordt genomen.
	Dit <span class="emphasis"><em>moet</em></span> een machine zijn die voor langere
	tijd down mag zijn.  Dit kan de bouwmachine zijn maar dat hoeft
	niet per se.</p><p>Alle machines in deze bouwgroep moeten ingesteld worden om
	<code class="filename">/usr/obj</code> en <code class="filename">/usr/src</code>
	vanaf dezelfde machine te mounten op hetzelfde punt.  In het
	meest ideale geval zijn dit twee verschillende schijven op de
	bouwmachine, maar ze kunnen ook door middel van NFS op die
	machine gemount zijn.  Als er meerdere bouwgroepen zijn, dan
	moet <code class="filename">/usr/src</code> op één
	bouwmachine staan en door middel van NFS gemount worden op de
	overige machines.</p><p>Zorg er als laatste voor dat
	<code class="filename">/etc/make.conf</code> en
	<code class="filename">/etc/src.conf</code> op alle machines in de
	bouwgroep het eens zijn met de bouwmachine.  Dat betekent dat
	de bouwmachine alle delen van het basissysteem moet bouwen die
	elke machine in de bouwgroep installeert.  Ook heeft elke
	bouwmachine zijn kernelnaam ingesteld met
	<code class="varname">KERNCONF</code> in
	<code class="filename">/etc/make.conf</code> en de bouwmachine moet ze
	allemaal hebben in <code class="varname">KERNCONF</code>, zijn eigen
	kernel eerst.  De bouwmachine moet de instellingenbestanden
	voor elke machine in
	<code class="filename">/usr/src/sys/arch/conf</code>
	hebben als deze machine de kernels voor de overige machines
	gaat bouwen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="small-lan-base-system"></a>24.9.2. Basissysteem</h3></div></div></div><p>Nu kan één systeem alles bouwen.  Bouw de
	kernel en wereld zoals beschreven in <a class="xref" href="makeworld.html#make-buildworld" title="24.7.7.2. Basissysteem compileren">Paragraaf 24.7.7.2, &#8220;Basissysteem compileren&#8221;</a> op de bouwmachine, maar installeer
	niets.  Zodra de bouw klaar is, moet op de testmachine de
	kernel geïnstalleerd en getest worden.  Als deze machine
	<code class="filename">/usr/src</code> en <code class="filename">/usr/obj</code>
	mount via NFS, moet na een herstart in single-user modus het
	netwerk ingeschakeld worden zodat de mounts opnieuw gemaakt
	kunnen worden.  De makkelijkste manier om dit te doen is om te
	starten in multi-user modus en daar
	<code class="command">shutdown now</code> starten om in single-user modus
	te komen.  Eenmaal daar aangekomen kunnen de nieuwe kernel en
	de wereld geïnstalleerd worden en kan daarna normaal
	<code class="command">mergemaster</code> gestart worden.  Zodra dit klaar
	is, kan de machine opnieuw gestart worden om naar multi-user
	modus terug te keren.</p><p>Nadat zeker is dat alles op de testmachine correct werkt,
	kan dezelfde procedure gebruikt worden om de nieuwe software op
	elke machine te installeren in de bouwgroep.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="small-lan-ports"></a>24.9.3. Ports</h3></div></div></div><p>Dezelfde ideeën kunnen gebruikt worden voor de ports.
	De eerste kritieke stap is om <code class="filename">/usr/ports</code>
	te mounten op alle machines in de bouwgroep.  Daarna kan
	<code class="filename">/etc/make.conf</code> correct ingesteld worden
	om de distfiles te delen.  De variabele
	<code class="varname">DISTDIR</code> moet wijzen naar een gedeelde map
	waarin geschreven kan worden door de gebruiker waar
	<code class="systemitem">root</code> naar wijst in de NFS mounts.  Op elke
	machine moet <code class="varname">WRKDIRPREFIX</code> naar een lokale
	bouwmap wijzen.  Als er pakketten gebouwd en gedistribueerd
	worden moet <code class="varname">PACKAGES</code> naar een map wijzen
	gelijkvormig aan de instelling voor
	<code class="varname">DISTDIR</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="make-delete-old.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="updating-upgrading.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="dtrace.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">24.8. Het verwijderen van overbodige bestanden, directories en
      bibliotheken </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> Hoofdstuk 25. DTrace</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>