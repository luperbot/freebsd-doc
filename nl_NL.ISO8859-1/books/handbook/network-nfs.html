<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>29.3. Netwerkbestandssysteem (NFS)</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="network-servers.html" title="Hoofdstuk 29. Netwerkdiensten" /><link rel="prev" href="network-inetd.html" title="29.2. De inetd &#8220;Super-Server&#8221;" /><link rel="next" href="network-nis.html" title="29.4. Netwerkinformatiesysteem (NIS/YP)" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">29.3. Netwerkbestandssysteem (NFS)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-inetd.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 29. Netwerkdiensten</th><td width="20%" align="right"> <a accesskey="n" href="network-nis.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-nfs"></a>29.3. Netwerkbestandssysteem (NFS)</h2></div><div><span class="authorgroup">Gereorganiseerd en verbeterd door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div><div><span class="authorgroup">Geschreven door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Bill</span> <span class="surname">Swingle</span></span>. </span></div></div></div><a id="idp86361040" class="indexterm"></a><p>Het Netwerkbestandssysteem (Network File System) is een van
      de vele bestandssystemen die FreeBSD ondersteunt.  Het staat ook wel
      bekend als <acronym class="acronym">NFS</acronym>.
      Met <acronym class="acronym">NFS</acronym> is het
      mogelijk om mappen en bestanden met anderen in een netwerk te
      delen.  Door het gebruik van <acronym class="acronym">NFS</acronym> kunnen gebruikers en
      programma's bij bestanden op andere systemen op bijna dezelfde
      manier als bij hun eigen lokale bestanden.</p><p>De grootste voordelen van <acronym class="acronym">NFS</acronym> zijn:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Lokale werkstations gebruiken minder schijfruimte omdat
	  veel gebruikte data op één machine opgeslagen
	  kan worden en nog steeds toegankelijk is voor gebruikers via
	  het netwerk;</p></li><li class="listitem"><p>Gebruikers hoeven niet op iedere machine een thuismap te
	  hebben.  Thuismappen kunnen op de <acronym class="acronym">NFS</acronym>
	  server staan en op het hele netwerk beschikbaar zijn;</p></li><li class="listitem"><p>Opslagapparaten als floppydisks, CD-ROM drives en
	  <span class="trademark">Zip</span>® drives kunnen door andere machines op een netwerk
	  gebruikt worden.  Hierdoor kan het aantal drives met
	  verwijderbare media in een netwerk verkleind worden.</p></li></ul></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86367952"></a>29.3.1. Hoe <acronym class="acronym">NFS</acronym> werkt</h3></div></div></div><p><acronym class="acronym">NFS</acronym> bestaat uit tenminste twee
	hoofdonderdelen: een server en een of meer cliënten.  De
	cliënt benadert de gegevens die op een servermachine zijn
	opgeslagen via een netwerk.  Om dit mogelijk te maken moeten er
	een aantal processen ingesteld en gestart worden.</p><p>Op de server moeten de volgende daemons draaien:</p><a id="idp86370000" class="indexterm"></a><a id="idp86371152" class="indexterm"></a><a id="idp86372304" class="indexterm"></a><a id="idp86377168" class="indexterm"></a><a id="idp86377808" class="indexterm"></a><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Daemon</th><th>Beschrijving</th></tr></thead><tbody><tr><td><span class="application">nfsd</span></td><td>De <acronym class="acronym">NFS</acronym>-daemon die verzoeken van
		de <acronym class="acronym">NFS</acronym> cliënten afhandelt.</td></tr><tr><td><span class="application">mountd</span></td><td>De <acronym class="acronym">NFS</acronym> koppeldaemon die
		doorgestuurde verzoeken van <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=nfsd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">nfsd</span>(8)</span></a>
		uitvoert.</td></tr><tr><td><span class="application">rpcbind</span></td><td>Deze daemon geeft voor
		<acronym class="acronym">NFS</acronym>-cliënten aan welke poort de
		<acronym class="acronym">NFS</acronym>-server gebruikt.</td></tr></tbody></table></div><p>Op de cliënt kan ook een daemon draaien:
	<span class="application">nfsiod</span>.  De daemon
	<span class="application">nfsiod</span> handelt verzoeken van de
	<acronym class="acronym">NFS</acronym>-server af.  Dit is optioneel en kan de
	prestaties verbeteren, maar het is niet noodzakelijk voor een
	normale en correcte werking.  Meer informatie staat in
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=nfsiod&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">nfsiod</span>(8)</span></a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-configuring-nfs"></a>29.3.2. <acronym class="acronym">NFS</acronym> instellen</h3></div></div></div><a id="idp86404688" class="indexterm"></a><p><acronym class="acronym">NFS</acronym> instellen gaat redelijk rechtlijnig.
	Alle processen die moeten draaien kunnen meestarten bij het
	opstarten door een paar wijzigingen in
	<code class="filename">/etc/rc.conf</code>.</p><p>Op de <acronym class="acronym">NFS</acronym> server dienen de volgende
	opties in <code class="filename">/etc/rc.conf</code> te staan:</p><pre class="programlisting">rpcbind_enable="YES"
nfs_server_enable="YES"
mountd_flags="-r"</pre><p><span class="application">mountd</span> start automatisch als de
	<acronym class="acronym">NFS</acronym> server is ingeschakeld.</p><p>Op de cliënt dient de volgende optie in
	<code class="filename">/etc/rc.conf</code> te staan:</p><pre class="programlisting">nfs_client_enable="YES"</pre><p>In het bestand <code class="filename">/etc/exports</code> staat
	beschreven welke bestandssystemen <acronym class="acronym">NFS</acronym> moet
	exporteren (soms heet dat ook wel delen of
	<span class="quote">&#8220;<span class="quote">sharen</span>&#8221;</span>).  Iedere regel in
	<code class="filename">/etc/exports</code> slaat op een bestandssysteem
	dat wordt geëxporteerd en welke machines toegang hebben
	tot dat bestandssysteem.  Samen met machines die toegang hebben,
	kunnen ook toegangsopties worden aangegeven.  Er zijn veel
	opties beschikbaar, maar hier worden er maar een paar
	beschreven.  Alle opties staan beschreven in
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exports&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">exports</span>(5)</span></a>.</p><p>Nu volgen een aantal voorbeelden voor
	<code class="filename">/etc/exports</code>:</p><a id="idp86422480" class="indexterm"></a><p>Het volgende voorbeeld geeft een beeld van hoe een
	bestandssysteem te exporteren, hoewel de instellingen
	afhankelijk zijn van de omgeving en het netwerk.  Om
	bijvoorbeeld de map <code class="filename">/cdrom</code> te exporteren
	naar drie machines die dezelfde domeinnaam hebben als de server
	(vandaar dat de machinenamen geef domeinachtervoegsel hebben)
	of in <code class="filename">/etc/hosts</code> staan.  De vlag
	<code class="option">-ro</code> exporteert het bestandssysteem als
	alleen&#8211;lezen.  Door die vlag kan een ander systeem niet
	schrijven naar het geëxporteerde bestandssysteem.</p><pre class="programlisting">/cdrom -ro host1 host2 host3</pre><p>Het volgende voorbeeld exporteert
	<code class="filename">/home</code> naar drie hosts op basis van
	IP-adres.  Dit heeft zin als er een privaat netwerk bestaat,
	zonder dat er een <acronym class="acronym">DNS</acronym> server is ingesteld.
	Optioneel kan <code class="filename">/etc/hosts</code> gebruikt worden
	om interne hostnamen in te stellen.  Er is meer informatie te
	vinden in <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hosts&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">hosts</span>(5)</span></a>.  Met de vlag <code class="option">-alldirs</code>
	mogen submappen ook koppelpunten zijn.  De submap wordt dan niet
	feitelijk aangekoppeld, maar de cliënt koppelt dan alleen
	de submappen aan die verplicht of nodig zijn.</p><pre class="programlisting">/home  -alldirs  10.0.0.2 10.0.0.3 10.0.0.4</pre><p>Het volgende voorbeeld exporteert <code class="filename">/a</code>
	zo dat twee cliënten uit verschillende domeinen bij het
	bestandssysteem mogen.  Met de vlag
	<code class="option">&#8211;maproot=root</code> mag de gebruiker op het
	andere systeem gegevens naar het geëxporteerde
	bestandssysteem schrijven als <code class="systemitem">root</code>.  Als
	de vlag <code class="option">-maproot=root</code> niet wordt gebruikt, dan
	kan een gebruiker geen bestanden wijzigen op het
	geëxporteerde bestandssysteem, zelfs niet als een gebruiker
	daar <code class="systemitem">root</code> is.</p><pre class="programlisting">/a  -maproot=root  host.example.com box.example.org</pre><p>Om een cliënt toegang te geven tot een
	geëxporteerd bestandssysteem, moet die cliënt daar
	rechten voor hebben.  De cliënt moet daarvoor genoemd
	worden in <code class="filename">/etc/exports</code>.</p><p>In <code class="filename">/etc/exports</code> staat iedere regel voor
	de exportinformatie van één bestandssysteem naar
	één host.  Per bestandssysteem mag een host maar
	één keer genoemd worden en mag maar
	één standaard hebben.  Stel bijvoorbeeld dat
	<code class="filename">/usr</code> een enkel bestandssysteem is.  Dan is
	de volgende <code class="filename">/etc/exports</code> niet geldig:</p><pre class="programlisting">&gt;# Werkt niet als /usr 1 bestandssysteem is
/usr/src   client
/usr/ports client</pre><p>Eén bestandssysteem, <code class="filename">/usr</code>,
	heeft twee regels waarin exports naar dezelfde host worden
	aangegeven, <code class="systemitem">client</code>.  In deze situatie is de
	juiste instelling:</p><pre class="programlisting">/usr/src /usr/ports  client</pre><p>De eigenschappen van een bestandssysteem dat naar een
	bepaalde host wordt geëxporteerd moeten allemaal op
	één regel staan.  Regels waarop geen cliënt
	wordt aangegeven worden behandeld als een enkele host.  Dit
	beperkt hoe bestandssysteem geëxporteerd kunnen worden,
	maar dat blijkt meestal geen probleem te zijn.</p><p>Het volgende voorbeeld is een geldige exportlijst waar
	<code class="filename">/usr</code> en <code class="filename">/exports</code>
	lokale bestandssystemen zijn:</p><pre class="programlisting"># Exporteer src en ports naar client01 en client02,
# maar alleen client01 heeft er rootprivileges
/usr/src /usr/ports -maproot=root    client01
/usr/src /usr/ports               client02
# De cliëntmachines hebben rootrechten en kunnen overal aankoppelen
# op /exports. Iedereen in de wereld kan /exports/obj als alleen-lezen aankoppelen.
/exports -alldirs -maproot=root      client01 client02
/exports/obj -ro</pre><p>De daemon <span class="application">mountd</span> moet gedwongen
	worden om het bestand <code class="filename">/etc/exports</code> te
	controleren steeds wanneer het is aangepast, zodat de
	veranderingen effectief kunnen worden.  Dit kan worden bereikt
	door òfwel een HUP-signaal naar de draaiende daemon te
	sturen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kill -HUP `cat /var/run/mountd.pid`</code></strong></pre><p>of door het <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a> script <code class="command">mountd</code> met
	de juiste parameter aan te roepen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service mountd onereload</code></strong></pre><p>Raadpleeg <a class="xref" href="configtuning-rcd.html" title="12.7. Gebruik van rc met FreeBSD">Paragraaf 12.7, &#8220;Gebruik van rc met FreeBSD&#8221;</a> voor meer
	informatie over het gebruik van rc-scripts.</p><p>Het is ook mogelijk een machine te herstarten, zodat FreeBSD
	alles netjes in kan stellen, maar dat is niet nodig.  Het
	uitvoeren van de volgende commando's als
	<code class="systemitem">root</code> hoort hetzelfde resultaat te
	hebben.</p><p>Op de <acronym class="acronym">NFS</acronym> server:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>rpcbind</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>nfsd -u -t -n 4</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mountd -r</code></strong></pre><p>Op de <acronym class="acronym">NFS</acronym> cliënt:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>nfsiod -n 4</code></strong></pre><p>Nu is alles klaar om feitelijk het netwerkbestandssysteem
	aan te koppelen.  In de volgende voorbeelden is de naam van de
	server <code class="systemitem">server</code> en de naam van de cliënt is
	<code class="systemitem">client</code>.  Om een netwerkbestandssysteem slechts
	tijdelijk aan te koppelen of om alleen te testen, kan een
	commando als het onderstaande als <code class="systemitem">root</code> op
	de cliënt uitgevoerd worden:</p><a id="idp86467152" class="indexterm"></a><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount server:/home /mnt</code></strong></pre><p>Hiermee wordt de map <code class="filename">/home</code> op de server
	aangekoppeld op <code class="filename">/mnt</code> op de cliënt.
	Als alles juist is ingesteld, zijn nu in
	<code class="filename">/mnt</code> op de cliënt de bestanden van de
	server zichtbaar.</p><p>Om een netwerkbestandssysteem iedere keer als een computer
	opstart aan te koppelen, kan het bestandssysteem worden
	toegevoegd aan het bestand <code class="filename">/etc/fstab</code>:</p><pre class="programlisting">server:/home	/mnt	nfs	rw	0	0</pre><p>Alle beschikbare opties staan in <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fstab&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">fstab</span>(5)</span></a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86477520"></a>29.3.3. Op slot zetten</h3></div></div></div><p>Voor sommige applicaties (b.v.
	<span class="application">mutt</span>) is het nodig dat bestanden op
	slot staan om correct te werken.  In het geval van
	<acronym class="acronym">NFS</acronym>, kan <span class="application">rpc.lockd</span>
	worden gebruikt voor het op slot zetten van bestanden.  Voeg het
	volgende toe aan het bestand <code class="filename">/etc/rc.conf</code>
	op zowel de cliënt als de server om het aan te zetten (het
	wordt aangenomen dat de <acronym class="acronym">NFS</acronym>-cliënt en
	-server reeds zijn geconfigureerd):</p><pre class="programlisting">rpc_lockd_enable="YES"
rpc_statd_enable="YES"</pre><p>Start de applicatie met:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service lockd start</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>service statd start</code></strong></pre><p>Als echt op slot zetten tussen de
	<acronym class="acronym">NFS</acronym>-cliënten en de
	<acronym class="acronym">NFS</acronym>-server niet nodig is, is het mogelijk om
	de <acronym class="acronym">NFS</acronym>-cliënt bestanden lokaal op slot
	te laten zetten door <code class="option">-L</code> aan <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount_nfs</span>(8)</span></a>
	door te geven.  In de handleidingpagina <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount_nfs</span>(8)</span></a> staan
	verdere details.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86486736"></a>29.3.4. Mogelijkheden voor gebruik</h3></div></div></div><p><acronym class="acronym">NFS</acronym> is voor veel doeleinden in te zetten.
	Een aantal voorbeelden:</p><a id="idp86488016" class="indexterm"></a><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Een aantal machines een CD-ROM of andere media laten
	    delen.  Dat is goedkoper en vaak ook handiger, bijvoorbeeld
	    bij het installeren van software op meerdere
	    machines;</p></li><li class="listitem"><p>Op grote netwerken kan het praktisch zijn om een
	    centrale <acronym class="acronym">NFS</acronym> server in te richten,
	    waarop alle thuismappen staan.  Die thuismappen kunnen dan
	    geëxporteerd worden, zodat gebruikers altijd
	    dezelfde thuismap hebben, op welk werkstation ze ook
	    aanmelden;</p></li><li class="listitem"><p>Meerdere machines kunnen een gezamenlijke map
	    <code class="filename">/usr/ports/distfiles</code> hebben.  Dan is
	    het mogelijk om een port op meerdere machines te
	    installeren, zonder op iedere machine de broncode te hoeven
	    downloaden.</p></li></ul></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-amd"></a>29.3.5. Automatisch aankoppelen met
	<span class="application">amd</span></h3></div><div><span class="authorgroup">Geschreven door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Wylie</span> <span class="surname">Stilwell</span></span>. </span></div><div><span class="authorgroup">Herschreven door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Chern</span> <span class="surname">Lee</span></span>. </span></div></div></div><a id="idp86497232" class="indexterm"></a><a id="idp86497744" class="indexterm"></a><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=amd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">amd</span>(8)</span></a> (de automatic mounter daemon) koppelt
	automatisch netwerkbestandssystemen aan als er aan een bestand
	of map binnen dat bestandssysteem wordt gerefereerd.
	<span class="application">amd</span> ontkoppelt ook bestandssystemen
	die een bepaalde tijd niet gebruikt worden.  Het gebruikt van
	<span class="application">amd</span> is een aantrekkelijk en eenvoudig
	alternatief ten opzichte van permanente koppelingen, die meestal
	in <code class="filename">/etc/fstab</code> staan.</p><p><span class="application">amd</span> werkt door zichzelf als
	NFS-server te koppelen aan de mappen <code class="filename">/host</code>
	en <code class="filename">/net</code>.  Als binnen die mappen een bestand
	wordt geraadpleegd, dan zoekt <span class="application">amd</span> de
	bijbehorende netwerkkoppeling op en koppelt die automatisch aan.
	<code class="filename">/net</code> wordt gebruikt om een
	geëxporteerd bestandssysteem van een IP-adres aan te
	koppelen, terwijl <code class="filename">/host</code> wordt gebruikt om
	een geëxporteerd bestandssysteem van een hostnaam aan te
	koppelen.</p><p>Het raadplegen van een bestand in
	<code class="filename">/host/foobar/usr</code> geeft
	<span class="application">amd</span> aan dat die moet proberen de
	<code class="filename">/usr</code> export op de host
	<code class="systemitem">foobar</code> aan te koppelen.</p><div class="example"><a id="idp86513232"></a><div class="example-title">Voorbeeld 29.2. Een export aankoppelen met
	  <span class="application">amd</span></div><div class="example-contents"><p>De beschikbare koppelingen van een netwerkhost zijn te
	  bekijken met <code class="command">showmount</code>.  Om bijvoorbeeld
	  de koppelingen van de host <code class="systemitem">foobar</code> te
	  bekijken:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>showmount -e foobar</code></strong>
Exports list on foobar:
/usr                               10.10.10.0
/a                                 10.10.10.0
<code class="prompt">%</code> <strong class="userinput"><code>cd /host/foobar/usr</code></strong></pre></div></div><br class="example-break" /><p>Zoals in het bovenstaande voorbeeld te zien is, toont
	<code class="command">showmount</code> <code class="filename">/usr</code> als een
	export.  Als er naar de map
	<code class="filename">/host/foobar/usr</code> wordt gegaan, probeert
	<span class="application">amd</span> de hostnaam
	<code class="systemitem">foobar</code> te resolven en de gewenste export
	automatisch aan te koppelen.</p><p><span class="application">amd</span> kan gestart worden door de
	opstartscript door de volgende regel in
	<code class="filename">/etc/rc.conf</code> te plaatsen:</p><pre class="programlisting">amd_enable="YES"</pre><p>Er kunnen ook nog opties meegegeven worden aan
	<span class="application">amd</span> met de optie
	<code class="varname">amd_flags</code>.  Standaard staat
	<code class="varname">amd_flags</code> ingesteld op:</p><pre class="programlisting">amd_flags="-a /.amd_mnt -l syslog /host /etc/amd.map /net /etc/amd.map"</pre><p>In het bestand <code class="filename">/etc/amd.map</code> staan
	de standaardinstellingen waarmee exports aangekoppeld worden.
	In het bestand <code class="filename">/etc/amd.conf</code> staan een
	aantal van de meer gevorderde instellingen van
	<span class="application">amd</span>.</p><p>In <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=amd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">amd</span>(8)</span></a> en <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=amd.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">amd.conf</span>(5)</span></a> staat meer
	informatie.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-nfs-integration"></a>29.3.6. Problemen bij samenwerking met andere systemen</h3></div><div><span class="authorgroup">Geschreven door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">John</span> <span class="surname">Lind</span></span>. </span></div></div></div><p>Bepaalde Ethernet adapters voor ISA PC systemen kennen
	limieten die tot serieuze netwerkproblemen kunnen leiden, in
	het bijzonder met NFS.  Dit probleem is niet specifiek voor
	FreeBSD, maar het kan op FreeBSD wel voor komen.</p><p>Het probleem ontstaat bijna altijd als (FreeBSD) PC-systemen
	netwerken met hoog presterende werkstations, zoals van Silicon
	Graphics, Inc. en Sun Microsystems, Inc.  De NFS-koppeling werkt
	prima en wellicht lukken een aantal acties ook, maar dan ineens
	lijkt de server niet meer te reageren voor de cliënt,
	hoewel verzoeken van en naar andere systemen gewoon verwerkt
	worden.  Dit gebeurt op een cliëntsysteem, of de
	cliënt nu het FreeBSD systeem is of het werkstation.  Op veel
	systemen is er geen manier om de cliënt netjes af te
	sluiten als dit probleem is ontstaan.  Vaak is de enige
	mogelijkheid een reset van de cliënt, omdat het probleem
	met NFS niet opgelost kan worden.</p><p>Hoewel de enige <span class="quote">&#8220;<span class="quote">correcte</span>&#8221;</span> oplossing de
	aanschaf van een snellere en betere Ethernet adapter voor het
	FreeBSD systeem is, is er zo om het probleem heen te werken dat het
	werkbaar is.  Als FreeBSD de <span class="emphasis"><em>server</em></span> is, kan de
	optie <code class="option">-w=1024</code> gebruikt worden bij het
	aankoppelen door de cliënt.  Als het FreeBSD systeem de
	<span class="emphasis"><em>cliënt</em></span> is, dan dient het
	NFS-bestandssysteem aangekoppeld te worden met de optie
	<code class="option"> r=1024</code>.  Deze opties kunnen het vierde
	veld zijn in een regel in <code class="filename">fstab</code> voor
	automatische aankoppelingen en bij handmatige aankoppelingen met
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> kan de parameter <code class="option">-o</code> gebruikt
	worden.</p><p>Soms wordt een ander probleem voor dit probleem versleten,
	als servers en cliënten zich op verschillende netwerken
	bevinden.  Als dat het geval is, dan dient
	<span class="emphasis"><em>vastgesteld</em></span> te worden dat routers de
	<acronym class="acronym">UDP</acronym> informatie op de juiste wijze routeren,
	omdat er anders nooit NFS-verkeer gerouteerd kan worden.</p><p>In de volgende voorbeelden is <code class="systemitem">fastws</code> de
	host(interface)naam van een hoog presterend werkstation en
	<code class="systemitem">freebox</code> is de host(interface)naam van een FreeBSD
	systeem met een Ethernet adapter die mindere prestaties levert.
	<code class="filename">/sharedfs</code> wordt het geëxporteerde
	NFS-bestandssysteem (zie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exports&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">exports</span>(5)</span></a>) en
	<code class="filename">/project</code> wordt het koppelpunt voor het
	geëxporteerde bestandssysteem op de cliënt.</p><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">In sommige gevallen kunnen applicaties beter draaien als
	  extra opties als <code class="option">hard</code> of
	  <code class="option">soft</code> en <code class="option">bg</code> gebruikt
	  worden.</p></div><p>Voorbeelden voor het FreeBSD systeem (<code class="systemitem">freebox</code>)
	als de cliënt in <code class="filename">/etc/fstab</code> op
	<code class="systemitem">freebox</code>:</p><pre class="programlisting">fastws:/sharedfs /project nfs rw,-r=1024 0 0</pre><p>Als een handmatig aankoppelcommando op
	<code class="systemitem">freebox</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -t nfs -o -r=1024 fastws:/sharedfs /project</code></strong></pre><p>Voorbeelden voor het FreeBSD systeem als de server in
	<code class="filename">/etc/fstab</code> op
	<code class="systemitem">fastws</code>:</p><pre class="programlisting">freebox:/sharedfs /project nfs rw,-w=1024 0 0</pre><p>Als een handmatig aankoppelcommando op
	<code class="systemitem">fastws</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -t nfs -o -w=1024 freebox:/sharedfs /project</code></strong></pre><p>Bijna iedere 16&#8211;bit Ethernet adapter werkt zonder de
	hierboven beschreven restricties op de lees- en
	schrijfgrootte.</p><p>Voor wie het wil weten wordt nu beschreven wat er gebeurt
	als de fout ontstaan, wat ook duidelijk maakt waarom het niet
	hersteld kan worden.  NFS werkt meestal met een
	<span class="quote">&#8220;<span class="quote">block</span>&#8221;</span>grootte van 8 K (hoewel het mogelijk
	is dat er kleinere fragmenten worden verwerkt).  Omdat de
	maximale grootte van een Ethernet pakket rond de 1500 bytes
	ligt, wordt een <span class="quote">&#8220;<span class="quote">block</span>&#8221;</span> opgesplitst in meerdere
	Ethernetpakketten, hoewel het hoger in de code nog steeds
	één eenheid is, en wordt ontvangen, samengevoegd en
	<span class="emphasis"><em>bevestigd</em></span> als een eenheid.  De hoog
	presterende werkstations kunnen de pakketten waaruit een
	NFS-eenheid bestaat bijzonder snel naar buiten pompen.  Op de
	kaarten met minder capaciteit worden de eerdere pakketten door
	de latere pakketten van dezelfde eenheid ingehaald voordat ze
	bij die host zijn aangekomen en daarom kan de eenheid niet
	worden samengesteld en bevestigd.  Als gevolg daarvan ontstaat
	er op het werkstation een timeout en probeert die de eenheid
	opnieuw te sturen, maar dan weer de hele eenheid van 8 K,
	waardoor het proces wordt herhaald, ad infinitum.</p><p>Door de grootte van de eenheid kleiner te houden dan de
	grootte van een Ethernet pakket, is het zeker dat elk
	Ethernetpakket dat compleet is aangekomen bevestigd kan worden,
	zodat de deadlock niet ontstaat.</p><p>Toch kan een PC systeem nog wel overrompeld worden als hoog
	presterende werkstations er op inhakken, maar met de betere
	netwerkkaarten valt het dan in ieder geval niet om door de NFS
	<span class="quote">&#8220;<span class="quote">eenheden</span>&#8221;</span>.  Als het systeem toch wordt
	overrompeld, dan worden de betrokken eenheden opnieuw verstuurd
	en dan is de kans groot dat ze worden ontvangen, samengevoegd en
	bevestigd.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-inetd.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="network-servers.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="network-nis.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">29.2. De <span class="application">inetd</span>
      <span class="quote">&#8220;<span class="quote">Super-Server</span>&#8221;</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 29.4. Netwerkinformatiesysteem (NIS/YP)</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>