<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>19.14. Snapshots van bestandssystemen</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="disks.html" title="Hoofdstuk 19. Opslag" /><link rel="prev" href="disks-virtual.html" title="19.13. Netwerk-, geheugen-, en bestandsgebaseerde bestandssystemen" /><link rel="next" href="quotas.html" title="19.15. Bestandssysteemquota" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">19.14. Snapshots van bestandssystemen</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="disks-virtual.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 19. Opslag</th><td width="20%" align="right"> <a accesskey="n" href="quotas.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="snapshots"></a>19.14. Snapshots van bestandssystemen</h2></div><div><span class="authorgroup">Bijgedragen door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><a id="idp80418896" class="indexterm"></a><p>FreeBSD biedt een mogelijkheid om samen met <a class="link" href="configtuning-disk.html#soft-updates" title="12.13.2. Softupdates">Soft Updates</a>: snapshots van
      bestandssystemen.</p><p>Snapshots bieden de mogelijkheid om beelden van een
      gespecificeerd bestandssysteem te maken en ze als bestand te
      behandelen.  Snapshotbestanden moeten aangemaakt worden in het
      bestandssysteem waarop de handeling wordt uitgevoerd en er mogen
      niet meer dan 20 snapshots per bestandssysteem worden aangemaakt.
      Actieve snapshots worden opgeslagen in het superblok zodat ze
      persistent zijn met afkoppel- en heraankoppelbewerkingen en met
      het opnieuw opstarten van het systeem.  Als een snapshot niet
      langer nodig is, kan het met het standaardcommando <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rm&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rm</span>(1)</span></a>
      worden verwijderd.  Snapshots kunnen in elke volgorde verwijderd
      worden, alhoewel misschien niet alle gebruikte ruimte
      teruggewonnen wordt omdat sommige vrijgegeven blokken mogelijk
      door een ander snapshot geclaimd worden.</p><p>De onveranderlijke bestandsvlag <code class="option">snapshot</code>
      wordt door <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mksnap_ffs</span>(8)</span></a> ingesteld nadat het snapshotbestand
      initieel is aangemaakt.  Het commando <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=unlink&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">unlink</span>(1)</span></a> maakt een
      uitzondering voor snapshotbestanden aangezien het toestaat dat ze
      verwijderd worden.</p><p>Snapshotbestanden worden aangemaakt met <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a>.  Om
      een snapshot van <code class="filename">/var</code> in het bestand
      <code class="filename">/var/snapshot/snap</code> te plaatsen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -o -o snapshot /var/snapshot/snap /var</code></strong></pre><p>Als alternatief kan <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mksnap_ffs</span>(8)</span></a> gebruikt worden om een
      snapshot aan te maken:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mksnap_ffs /var /var/snapshot/snap</code></strong></pre><p>Snapshotbestanden kunnen gezocht worden op een
      bestandssysteem (bijvoorbeeld <code class="filename">/var</code>) door
      gebruik te maken van het commando <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=find&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">find</span>(1)</span></a>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>find /var -flags snapshot</code></strong></pre><p>Nadat een snapshot is aangemaakt, kan het voor een aantal
      dingen gebruikt worden:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Sommige systeembeheerders gebruiken een snapshotbestand
	  voor back-updoeleinden, omdat het snapshot naar CD's of band
	  overgezet kan worden;</p></li><li class="listitem"><p>De bestandssysteem integriteit controle, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a>
	  kan gebruikt worden op het snapshot.  Ervan uitgaande dat het
	  bestandssysteem schoon was toen het werd aangekoppeld, zou dit
	  altijd een schoon (en onveranderlijk) resultaat moeten
	  opleveren.  Dit is in principe wat het
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a>-achtergrondsproces doet;</p></li><li class="listitem"><p>Het commando <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a> draaien op het snapshot.  Er
	  wordt een dump teruggegeven die consistent is met het
	  bestandssysteem en tijdsstempel van het snapshot.
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a> kan ook in één commando een
	  snapshot maken, een dumpbeeld aanmaken en daarna het snapshot
	  verwijderen door gebruik te maken van de vlag
	  <code class="option">-L</code>;</p></li><li class="listitem"><p>Het snapshot kan met <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> als bevroren beeld van
	  het bestandssysteem worden aangekoppeld.  Om het snapshot
	  <code class="filename">/var/snapshot/snap</code> aan te koppelen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t vnode -f /var/snapshot/snap -u 4</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount -r /dev/md4 /mnt</code></strong></pre></li></ul></div><p>Het is nu mogelijk om door de structuur van het bevroren
      bestandssysteem <code class="filename">/var</code> te lopen dat
      aangekoppeld is op <code class="filename">/mnt</code>.  Alles zal initieel
      in dezelfde toestand verkeren als op het moment dat het snapshot
      werd aangemaakt.  De enige uitzondering hierop is dat eerdere
      snapshots als bestanden met lengte nul verschijnen.  Als een
      snapshot niet meer nodig is, kan het als volgt afgekoppeld
      worden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>umount /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mdconfig -d -u 4</code></strong></pre><p>Meer informatie over <code class="option">softupdates</code> en
      snapshots van bestandssystemen, inclusief technische documenten,
      staat op de website van Marshall Kirk McKusick op <code class="uri"><a class="uri" href="http://www.mckusick.com/" target="_top">http://www.mckusick.com/</a></code>.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="disks-virtual.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="disks.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="quotas.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">19.13. Netwerk-, geheugen-, en bestandsgebaseerde
      bestandssystemen </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 19.15. Bestandssysteemquota</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>