<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>27.3. Kernel-PPP gebruiken</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="ppp-and-slip.html" title="Hoofdstuk 27. PPP en SLIP" /><link rel="prev" href="userppp.html" title="27.2. Gebruikmaken van gebruiker-PPP" /><link rel="next" href="ppp-troubleshoot.html" title="27.4. Het problemen oplossen van PPP-verbindingen" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">27.3. Kernel-PPP gebruiken</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="userppp.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 27. PPP en SLIP</th><td width="20%" align="right"> <a accesskey="n" href="ppp-troubleshoot.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="ppp"></a>27.3. Kernel-PPP gebruiken</h2></div><div><span class="authorgroup">Delen origineel bijgedragen door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Gennady B.</span> <span class="surname">Sorokopud</span></span> en <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Robert</span> <span class="surname">Huff</span></span>. </span></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84902992"></a>27.3.1. Het opzetten van kernel-PPP</h3></div></div></div><div xmlns="" class="warning"><h3 class="admontitle">Waarschuwing: </h3><p xmlns="http://www.w3.org/1999/xhtml">Deze sectie geldt en is alleen geldig voor FreeBSD 7.X.</p></div><a id="idp84904528" class="indexterm"></a><p>Voordat u begint met het opzetten van PPP op uw machine,
	zorg ervoor dat het <code class="command">pppd</code> commando zich
	bevindt in de map <code class="filename">/usr/sbin</code>
	en dat de map <code class="filename">/etc/ppp</code>
	bestaat.</p><p><code class="command">pppd</code> kan in twee verschillende modes
	werken:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Als een <span class="quote">&#8220;<span class="quote">cliënt</span>&#8221;</span> &#8212; u wilt uw
	    machine verbinden met de buitenwereld via een seriële
	    PPP-verbinding of een modemlijn.</p></li><li class="listitem"><p>Als een <span class="quote">&#8220;<span class="quote">server</span>&#8221;</span><a id="idp84910032" class="indexterm"></a> &#8212; uw machine bevind
	    zich in het netwerk en wordt gebruikt om andere computers
	    te verbinden door middel van PPP.</p></li></ol></div><p>In beide gevallen moet u een bestand met opties instellen
	(<code class="filename">/etc/ppp/options</code> of
	<code class="filename">~/.ppprc</code> als er meer dan één
	gebruiker is op uw machine die gebruik maakt van PPP).</p><p>U heeft ook enige modem/seriële software nodig
	(<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/comms/kermit/pkg-descr">comms/kermit</a> wordt
	aanbevolen), zodat u de andere kant kunt bellen en een
	verbinding kunt opzetten.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84913360"></a>27.3.2. Gebruik maken van <code class="command">pppd</code> als
	cliënt</h3></div><div><span class="authorgroup">Gebaseerd op informatie geleverd door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Trev</span> <span class="surname">Roydhouse</span></span>. </span></div></div></div><a id="idp84916176" class="indexterm"></a><a id="idp84917328" class="indexterm"></a><p>De volgende <code class="filename">/etc/ppp/options</code> kan
	gebruikt worden om met een Cisco terminal server PPP lijn
	verbinding te maken.</p><pre class="programlisting">crtscts         # Schakel hardware flow controle in
modem           # modem controle lijn
noipdefault     # De PPP-server aan de andere kant moet uw IP-adres
                # opgeven, als de machine aan de andere kant uw IP
                # adres niet meegeeft tijdens de IPCP onderhandeling
                # moet deze optie worden verwijderd
passive         # Wacht op LCP pakketten
domain ppp.foo.com      # Vul uw domein naam hier in

:<em class="replaceable"><code>remote_ip</code></em>    # Vul het IP-adres van de PPP
                # server in deze wordt gebruikt om pakketten te
                # routeren via de PPP link.  Als u de noipdefault optie
                # niet heeft aangegeven verander dan deze regel in
                # <em class="replaceable"><code>local_ip</code></em>:<em class="replaceable"><code>remote_ip</code></em>

defaultroute    # Vul dit in als u wilt dat de PPP server de standaard
                # router wordt</pre><p>Om verbinding te maken:</p><a id="idp84925008" class="indexterm"></a><a id="idp84925520" class="indexterm"></a><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Bel naar de machine aan de andere kant door middel van
	    <span class="application">Kermit</span> (of een ander modem
	    programma), en vul uw gebruikersnaam en wachtwoord in (of
	    wat er ook nodig is om de verbinding op te brengen met de
	    machine aan de andere kant).</p></li><li class="step"><p>Stop <span class="application">Kermit</span> (zonder de lijn
	    op te hangen).</p></li><li class="step"><p>Type het volgende:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/usr/sbin/pppd /dev/tty01 19200</code></strong></pre><p>Wees er zeker van dat de juiste snelheid en het juiste
	    apparaat wordt aangesproken.</p></li></ol></div><p>Uw computer is nu verbonden met PPP.  Als de connectie
	faalt, kan de <code class="option">debug</code> optie worden meegegeven
	in het <code class="filename">/etc/ppp/options</code> bestand waarna op
	de console berichten kunnen worden geraadpleegd om het probleem
	te achterhalen.</p><p>Het volgende <code class="filename">/etc/ppp/pppup</code> script
	zal alle drie de stappen automatisch doen:</p><pre class="programlisting">#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ "X${pid}" != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi

ifconfig ppp0 down
ifconfig ppp0 delete

kermit -y /etc/ppp/kermit.dial
pppd /dev/tty01 19200</pre><a id="idp84933200" class="indexterm"></a><p><code class="filename">/etc/ppp/kermit.dial</code> is een
	<span class="application">Kermit</span> script dat belt en alle
	benodigde authorisaties doet op de machine aan de andere
	kant (een voorbeeld van zo'n script is bijgevoegd aan het
	einde van dit document).</p><p>Gebruik het volgende <code class="filename">/etc/ppp/pppdown</code>
	script om de PPP lijn af te breken:</p><pre class="programlisting">#!/bin/sh
pid=`pgrep pppd`
if [ X${pid} != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill -TERM ${pid}
fi

pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi

/sbin/ifconfig ppp0 down
/sbin/ifconfig ppp0 delete
kermit -y /etc/ppp/kermit.hup
/etc/ppp/ppptest</pre><p>Controleer of <code class="command">pppd</code> nog steeds draait door
	het uitvoeren van <code class="filename">/usr/etc/ppp/ppptest</code>,
	welke er als volgend uitziet:</p><pre class="programlisting">#!/bin/sh
pid=`pgrep pppd`
if [ X${pid} != "X" ] ; then
        echo 'pppd running: PID=' ${pid-NONE}
else
        echo 'No pppd running.'
fi
set -x
netstat -n -I ppp0
ifconfig ppp0</pre><p>Om het modem op te hangen, voer het
	<code class="filename">/etc/ppp/kermit.hup</code> script uit
	welke het volgende bevat:</p><pre class="programlisting">set line /dev/tty01	; vul hier uw modem in
set speed 19200
set file type binary
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none

pau 1
out +++
inp 5 OK
out ATH0\13
echo \13
exit</pre><p>Hier is een alternatieve methode welke gebruik maakt
	van <code class="command">chat</code> in plaats van
	<code class="command">kermit</code>:</p><p>De volgende twee regels zijn voldoende om een
	<code class="command">pppd</code> verbinding op te zetten.</p><p><code class="filename">/etc/ppp/options</code>:</p><pre class="programlisting">/dev/cuad1 115200

crtscts         # Schakel hardware flow controle in
modem           # modem controle lijn
connect "/usr/bin/chat -f /etc/ppp/login.chat.script"
noipdefault     # De PPP server aan de andere kant moet uw IP-adres
                # opgeven, als de machine aan de andere kant uw IP
                # adres niet meegeeft tijdens de IPCP onderhandeling
                # moet deze optie worden verwijderd
passive         # Wacht op LCP pakketten
domain <em class="replaceable"><code>your.domain</code></em>   # Vul uw domein naam hier in

:<em class="replaceable"><code>remote_ip</code></em>    # Vul het IP-adres van de PPP
                # server in deze wordt gebruikt om pakketten te
                # routeren via de PPP link.  Als u de noipdefault optie
                # niet heeft aangegeven verander dan deze regel in
                # <em class="replaceable"><code>local_ip</code></em>:<em class="replaceable"><code>remote_ip</code></em>

defaultroute    # Vul dit in als u wilt dat de PPP server de standaard
                # router wordt</pre><p><code class="filename">/etc/ppp/login.chat.script</code>:</p><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">Het volgende moet op één regel.</p></div><pre class="programlisting">ABORT BUSY ABORT 'NO CARRIER' "" AT OK ATDT<em class="replaceable"><code>telefoon.nummer</code></em>
  CONNECT "" TIMEOUT 10 ogin:-\\r-ogin: <em class="replaceable"><code>login-id</code></em>
  TIMEOUT 5 sword: <em class="replaceable"><code>password</code></em></pre><p>Zodra deze zijn geïnstalleerd en correct aangepast is
	het enige dat gedaan moet worden, het starten van
	<code class="command">pppd</code> zoals volgt:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pppd</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84952272"></a>27.3.3. Gebruik maken van <code class="command">pppd</code> als
	server</h3></div></div></div><p><code class="filename">/etc/ppp/options</code> moet ongeveer het
	volgende bevatten:</p><pre class="programlisting">crtscts                         # Hardware flow controle
netmask 255.255.255.0           # netmask (niet vereist)
192.114.208.20:192.114.208.165  # IP's van lokale en niet lokale hosten
                                # het lokale IP moet anders zijn dan
                                # degeen die is toegewezen aan de
                                # Ethernet (of andere) interface op uw
                                # machine.  remote IP is het IP-adres
                                # dat wordt toegewezen aan de machine
                                # aan de andere kant
domain ppp.foo.com              # uw domein
passive                         # Wacht op LCP
modem                           # modem lijn</pre><p>Het volgende <code class="filename">/etc/ppp/pppserv</code> script
	zal <span class="application">pppd</span> vertellen zich te gedragen
	als server:</p><pre class="programlisting">#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ "X${pid}" != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi

# reset ppp interface
ifconfig ppp0 down
ifconfig ppp0 delete

# enable autoanswer mode
kermit -y /etc/ppp/kermit.ans

# run ppp
pppd /dev/tty01 19200</pre><p>Gebruik dit <code class="filename">/etc/ppp/pppservdown</code> script
	om de server te stoppen:</p><pre class="programlisting">#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ "X${pid}" != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi
ifconfig ppp0 down
ifconfig ppp0 delete

kermit -y /etc/ppp/kermit.noans</pre><p>Het volgende <span class="application">Kermit</span> script
	(<code class="filename">/etc/ppp/kermit.ans</code>) zal het automatisch
	beantwoorden van uw modem in of uitschakelen.  Het moet eruit
	zien als volgend:</p><pre class="programlisting">set line /dev/tty01
set speed 19200
set file type binary
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none

pau 1
out +++
inp 5 OK
out ATH0\13
inp 5 OK
echo \13
out ATS0=1\13   ; Verander dit in out ATS0=0\13 als u automatisch
                ; beantwoorden wilt uitschakelen
inp 5 OK
echo \13
exit</pre><p>Een script genaamd <code class="filename">/etc/ppp/kermit.dial</code>
	wordt gebruikt voor het bellen en authenticeren van de machine
	aan de andere kant.  U moet deze aanpassen aan uw wensen.  Vul in
	dit script uw inlognaam en wachtwoord in, u moet ook het input
	statement aanpassen afhankelijk hoe uw modem antwoordt en de
	communicatie van de machine aan de andere kant.</p><pre class="programlisting">;
; Vul de seriële lijn in welke verbonden is met het modem
;
set line /dev/tty01
;
; Stel het modem snelheid in:
;
set speed 19200
set file type binary            ; volledige 8 bit bestands xfer
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none
set modem hayes
set dial hangup off
set carrier auto                ; Daarna stel SET CARRIER in indien nodig
set dial display on             ; Stel daarna SET DIAL in indien nodig
set input echo on
set input timeout proceed
set input case ignore
def \%x 0                       ; login prompt teller
goto slhup

:slcmd                          ; stel het modem in op commandomodus
echo Stel het modem in op commandomodus.
clear                           ; Verwijder ongelezen karakters uit de input buffer
pause 1
output +++                      ; hayes escape sequence
input 1 OK\13\10                ; wacht op OK
if success goto slhup
output \13
pause 1
output at\13
input 1 OK\13\10
if fail goto slcmd              ; Als het modem niet antwoordt met OK, probeer het opnieuw

:slhup                          ; hang de telefoon op
clear                           ; Verwijder ongelezen karakters uit de input buffer
pause 1
echo De telefoon wordt opgehangen.
output ath0\13                  ; hayes command voo on hook
input 2 OK\13\10
if fail goto slcmd              ; Als er geen OK antwoord is, stel het modem in op commandomodus

:sldial                         ; Draai het nummer
pause 1
echo Bellen.
output atdt9,550311\13\10               ; put phone number here
assign \%x 0                    ; zero the time counter

:look
clear                           ; Verwijder ongelezen karakters uit de input buffer
increment \%x                   ; Tel de seconden
input 1 {CONNECT }
if success goto sllogin
reinput 1 {NO CARRIER\13\10}
if success goto sldial
reinput 1 {NO DIALTONE\13\10}
if success goto slnodial
reinput 1 {\255}
if success goto slhup
reinput 1 {\127}
if success goto slhup
if &lt; \%x 60 goto look
else goto slhup

:sllogin                        ; login
assign \%x 0                    ; Stel de tijd teller in op nul
pause 1
echo Zoeken naar de login prompt

:slloop
increment \%x                   ; Tel de seconden
clear                           ; Verwijder ongelezen karakters uit de input buffer
output \13
;
; Stel hier de verwachte login prompt in:
;
input 1 {Username: }
if success goto sluid
reinput 1 {\255}
if success goto slhup
reinput 1 {\127}
if success goto slhup
if &lt; \%x 10 goto slloop         ; Probeer 10 x om een login prompt te krijgen
else goto slhup                 ; Hang op en probeer het nogmaals als er 10 mislukte pogingen zijn

:sluid
;
; Vul hier uw gebruikersnaam in:
;
output ppp-login\13
input 1 {Password: }
;
; Vul hier uw wachtwoord in:
;
output ppp-password\13
input 1 {Entering SLIP mode.}
echo
quit

:slnodial
echo \7Er is geen kiestoon, controleer de telefoon lijn!\7
exit 1

; local variables:
; mode: csh
; comment-start: "; "
; comment-start-skip: "; "
; end:</pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="userppp.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="ppp-and-slip.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="ppp-troubleshoot.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">27.2. Gebruikmaken van gebruiker-PPP </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 27.4. Het problemen oplossen van
      <acronym class="acronym">PPP</acronym>-verbindingen</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>