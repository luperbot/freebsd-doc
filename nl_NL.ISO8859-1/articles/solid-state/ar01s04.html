<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>4. Een bestandssysteem uit het niets opbouwen</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD en Solid State Apparaten" /><link rel="up" href="index.html" title="FreeBSD en Solid State Apparaten" /><link rel="prev" href="ro-fs.html" title="3. Het rc-deelsysteem en alleen-lezen bestandssystemen" /><link rel="next" href="strategies.html" title="5. Systeemstragiën voor kleine en alleen-lezen omgevingen." /><link rel="copyright" href="trademarks.html" title="Juridische kennisgeving" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4. Een bestandssysteem uit het niets opbouwen</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ro-fs.html">Terug</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="strategies.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="idp63684432"></a>4. Een bestandssysteem uit het niets opbouwen</h2></div></div></div><p>Omdat ATA-compatibele compact-flash-kaarten door FreeBSD als
      normale IDE harde schijven worden gezien, kunt u theoretisch FreeBSD
      vanaf het netwerk installeren door de floppies kern en mfsroot of
      een CD te gebruiken.</p><p>Zelfs een kleine installatie van FreeBSD die normale
      installatieprocedures gebruikt kan echter een systeem produceren
      met een omvang van meer dan 200 MB.  Omdat de meeste mensen
      kleinere flash-geheugenapparaten zullen gebruiken (128 MB wordt als
      redelijk groot gezien - 32 of zelfs 16 MB is gebruikelijk) is een
      installatie dat de normale mechanismen gebruikt niet
      mogelijk er is simpelweg niet genoeg schijfruimte voor zelfs
      de kleinste van de conventionele installaties.</p><p>De gemakkelijkste manier om over deze beperking heen te komen
      is om FreeBSD met conventionele middelen naar een normale harde
      schijf te installeren.  Kleedt, nadat de installatie voltooid is,
      het besturingssysteem uit tot een grootte die op uw flash-medium
      past, en pak vervolgens het gehele bestandssysteem in.  De volgende
      stappen leiden u door het proces heen van een normaal flash-geheugen
      voorbereiden op uw ingepakte bestandssysteem.  Omdat er geen normale
      installatie wordt uitgevoerd, moeten bewerkingen zoals partitioneren,
      labelen, het aanmaken van bestandssystemen, etcetera met de hand
      uitgevoerd worden.  Naast de floppies kern en mfsroot heeft u ook
      de floppy fixit nodig.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p class="title"><strong>Het flash-media-apparaat partitioneren</strong></p><p>Kies nadat er met de floppies kern en mfsroot is opgestart
	  <code class="literal">custom</code> uit het installatiemenu.  Kies
	  <code class="literal">partition</code> in het aangepaste
	  installatiemenu.  In het partitiemenu dient u alle bestaande
	  partities te wissen met de toets <span class="keycap"><strong>d</strong></span>.  Maak
	  nadat alle bestaande partities gewist zijn een partitie aan
	  met de toets <span class="keycap"><strong>c</strong></span> en accepteer de
	  standaardwaarde voor de grootte van de partitie.  Zorg ervoor
	  dat het type van de partitie op <code class="literal">165</code> is
	  ingesteld wanneer daar naar wordt gevraagd.  Schrijf nu deze
	  partitietabel naar schijf door op de toets <span class="keycap"><strong>w</strong></span>
	  te drukken (dit is een verborgen optie op dit scherm).  Wanneer
	  u een ATA-compatibele flash-kaart gebruikt, dient u de
	  opstartbeheerder van FreeBSD te gebruiken.  Druk nu op de toets
	  <span class="keycap"><strong>q</strong></span> om het partitiemenu te verlaten.  Het menu
	  van de opstartbeheerder wordt nog een keer aan u getoond -
	  herhaal de keuze die u eerder heeft gemaakt.</p></li><li class="step"><p class="title"><strong>De bestandssystemen op uw flash-geheugenapparaat
	  aanmaken</strong></p><p>Verlaat het aangepaste installatiemenu, en kies van het
	  hoofdinstallatiemenu de optie <code class="literal">fixit</code>.  Geef
	  na het binnengaan van de fixit-omgeving het volgende
	  commando:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>disklabel -e /dev/ad0c</code></strong></pre><p>Op dit punt bent u de tekstverwerker vi binnengegaan onder
	  toezien van het commando disklabel.  Vervolgens dient u een
	  regel met <code class="literal">a:</code> aan het einde van het
	  bestand toe te voegen.  Deze regel dient er als volgt uit te
	  zien:</p><pre class="programlisting">a:      <em class="replaceable"><code>123456</code></em>  0       4.2BSD  0       0</pre><p>Hierbij is <em class="replaceable"><code>123456</code></em> een getal dat
	  exact gelijk is aan het getal in de bestaande regel met
	  <code class="literal">c:</code> voor de grootte.  In feite dupliceert u
	  de bestaande regel met <code class="literal">c:</code> als een regel met
	  <code class="literal">a:</code>, met daarbij <code class="literal">4.2BSD</code>
	  als type van het bestandssysteem.  Sla het bestand op en
	  verlaat de tekstverwerker.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>disklabel -B -r /dev/ad0c</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>newfs /dev/ad0a</code></strong></pre></li><li class="step"><p class="title"><strong>Uw bestandssysteem op het flash-medium plaatsen</strong></p><p>Koppel het nieuw voorbereide flash-medium aan:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /dev/ad0a /flash</code></strong></pre><p>Activeer deze machine in het netwerk zodat we ons
	  tar-bestand kunnen overzenden en het op het bestandssysteem
	  van het flash-medium kunnen uitpakken.  Een manier om dit te
	  doen is:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig xl0 192.168.0.10 netmask 255.255.255.0</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>route add default 192.168.0.1</code></strong></pre><p>Nu de machine op het netwerk is, kan het tar-bestand
	  worden overgezonden.  U kunt nu tegen een dilemma aanlopen -
	  als bijvoorbeeld uw flash-geheugen 128 MB groot is, en uw
	  tar-bestand groter is dan 64 MB, kan uw tar-bestand niet op
	  het zelfde moment op het flash-medium staan als dan wanneer u
	  het uitpakt - u zult schijfruimte tekort komen.  Een oplossing
	  voor dit probleem is, wanneer u FTP gebruikt, om het bestand
	  uitpakt terwijl u het over FTP verzendt.  Als u de overdracht
	  op deze manier aanpakt, zult u nooit het tar-bestand en de
	  inhoud ervan op hetzelfde moment op uw schijf hebben:</p><pre class="screen"><code class="prompt">ftp&gt;</code> <strong class="userinput"><code>get tar-bestand.tar "| tar xvf -"</code></strong></pre><p>Als uw tar-bestand met gzip is ingepakt, kunt u dit ook
	  voor elkaar krijgen:</p><pre class="screen"><code class="prompt">ftp&gt;</code> <strong class="userinput"><code>get tar-bestand.tar "| zcat | tar xvf -"</code></strong></pre><p>Nadat de inhoud van uw ge-tar-de bestandssysteem op het
	  bestandssysteem van uw flash-geheugen staan, kunt u het
	  flash-geheugen afkoppelen en opnieuw opstarten:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>umount /flash</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>exit</code></strong></pre><p>Aangenomen dat u uw bestandssysteem correct heeft
	  geconfigureerd toen het gebouwd werd op de normale harde
	  schijf (met uw bestandssystemen als alleen-lezen aangekoppeld
	  en met de nodige opties in de kernel gecompileerd) zou u nu
	  succesvol uw embedded FreeBSD-systeem moeten kunnen
	  opstarten.</p></li></ol></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ro-fs.html">Terug</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="strategies.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">3. Het <code class="literal">rc</code>-deelsysteem en alleen-lezen
      bestandssystemen </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 5. Systeemstragiën voor kleine en alleen-lezen
      omgevingen.</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>