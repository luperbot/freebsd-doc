<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>9.4. Advanced Printer Setup</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Podrêcznik FreeBSD" /><link rel="up" href="printing.html" title="Rozdzia³ 9. Printing" /><link rel="prev" href="printing-intro-setup.html" title="9.3. Basic Setup" /><link rel="next" href="printing-using.html" title="9.5. Using Printers" /><link rel="copyright" href="legalnotice.html" title="Informacja Prawna" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">9.4. Advanced Printer Setup</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="printing-intro-setup.html">Poprzedni</a> </td><th width="60%" align="center">Rozdzia³ 9. Printing</th><td width="20%" align="right"> <a accesskey="n" href="printing-using.html">Nastêpny</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="printing-advanced"></a>9.4. Advanced Printer Setup</h2></div></div></div><p>This section describes filters for printing specially formatted
      files, header pages, printing across networks, and restricting and
      accounting for printer usage.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-filter-intro"></a>9.4.1. Filters</h3></div></div></div><a id="idp81408080" class="indexterm"></a><p>Although <span class="application">LPD</span> handles network protocols,
	queuing, access control,
        and other aspects of printing, most of the <span class="emphasis"><em>real</em></span>
        work happens in the <span class="emphasis"><em>filters</em></span>.  Filters are
        programs that communicate with the printer and handle its device
        dependencies and special requirements.  In the simple printer setup,
        we installed a plain text filter-an extremely simple one that
        should work with most printers (section <a class="link" href="printing-intro-setup.html#printing-textfilter" title="9.3.1.5.6. Installing the Text Filter">Installing the Text
          Filter</a>).</p><p>However, in order to take advantage of format conversion, printer
        accounting, specific printer quirks, and so on, you should understand
        how filters work.  It will ultimately be the filter's responsibility
        to handle these aspects.  And the bad news is that most of the time
        <span class="emphasis"><em>you</em></span> have to provide filters yourself.  The good
        news is that many are generally available; when they are not, they are
        usually easy to write.</p><p>Also, FreeBSD comes with one,
        <code class="filename">/usr/libexec/lpr/lpf</code>, that works with many
        printers that can print plain text.  (It handles backspacing and tabs
        in the file, and does accounting, but that is about all it does.)
        There are also several filters and filter components in the FreeBSD
        Ports Collection.</p><p>Here is what you will find in this section:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Section <a class="link" href="printing-advanced.html#printing-advanced-filters" title="9.4.1.1. How Filters Work">How Filters
              Work</a>, tries to give an overview of a filter's role in the
            printing process.  You should read this section to get an
            understanding of what is happening <span class="quote">"<span class="quote">under the hood</span>"</span>
            when <span class="application">LPD</span> uses filters.  This knowledge
	    could help you anticipate
            and debug problems you might encounter as you install more and
            more filters on each of your printers.</p></li><li class="listitem"><p><span class="application">LPD</span> expects every printer to be
	    able to print plain text by
            default.  This presents a problem for <span class="trademark">PostScript</span>(R) (or other
            language-based printers) which cannot directly print plain text.
            Section <a class="link" href="printing-advanced.html#printing-advanced-if-conversion" title="9.4.1.2. Accommodating Plain Text Jobs on PostScript(R) Printers">Accommodating
              Plain Text Jobs on <span class="trademark">PostScript</span>(R) Printers</a> tells you what you
            should do to overcome this problem.  You should read this
            section if you have a <span class="trademark">PostScript</span>(R) printer.</p></li><li class="listitem"><p><span class="trademark">PostScript</span>(R) is a popular output format for many programs.
            Some people even write <span class="trademark">PostScript</span>(R) code directly.  Unfortunately,
            <span class="trademark">PostScript</span>(R) printers are expensive.  Section <a class="link" href="printing-advanced.html#printing-advanced-ps" title="9.4.1.3. Simulating PostScript(R) on Non PostScript(R) Printers">Simulating <span class="trademark">PostScript</span>(R) on
              Non <span class="trademark">PostScript</span>(R) Printers</a> tells how you can further modify
            a printer's text filter to accept and print <span class="trademark">PostScript</span>(R) data on a
            <span class="emphasis"><em>non <span class="trademark">PostScript</span>(R)</em></span> printer.  You should read
            this section if you do not have a <span class="trademark">PostScript</span>(R) printer.</p></li><li class="listitem"><p>Section <a class="link" href="printing-advanced.html#printing-advanced-convfilters" title="9.4.1.4. Conversion Filters">Conversion
              Filters</a> tells about a way you can automate the conversion
            of specific file formats, such as graphic or typesetting data,
            into formats your printer can understand.  After reading this
            section, you should be able to set up your printers such that
            users can type <code class="command">lpr -t</code> to print troff data, or
            <code class="command">lpr -d</code> to print <span class="application">TeX</span> DVI data, or <code class="command">lpr
              -v</code> to print raster image data, and so forth.  I
            recommend reading this section.</p></li><li class="listitem"><p>Section <a class="link" href="printing-advanced.html#printing-advanced-of" title="9.4.1.5. Output Filters">Output
              Filters</a> tells all about a not often used feature of
	    <span class="application">LPD</span>:
            output filters.  Unless you are printing header pages (see <a class="link" href="printing-advanced.html#printing-advanced-header-pages" title="9.4.2. Header Pages">Header Pages</a>),
            you can probably skip that section altogether.</p></li><li class="listitem"><p>Section <a class="link" href="printing-advanced.html#printing-advanced-lpf" title="9.4.1.6. lpf: a Text Filter">lpf: a Text
              Filter</a> describes <code class="command">lpf</code>, a fairly
            complete if simple text filter for line printers (and laser
            printers that act like line printers) that comes with FreeBSD.  If
            you need a quick way to get printer accounting working for plain
            text, or if you have a printer which emits smoke when it sees
            backspace characters, you should definitely consider
            <code class="command">lpf</code>.</p></li></ul></div><div xmlns="" class="note"><h3 class="admontitle">Uwaga: </h3><p xmlns="http://www.w3.org/1999/xhtml">A copy of the various scripts described below can be
	  found in the <code class="filename">/usr/share/examples/printing</code>
	  directory.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-filters"></a>9.4.1.1. How Filters Work</h4></div></div></div><p>As mentioned before, a filter is an executable program started
          by <span class="application">LPD</span> to handle the device-dependent part of
	  communicating with the printer.</p><p>When <span class="application">LPD</span> wants to print a file in a
	  job, it starts a filter
          program.  It sets the filter's standard input to the file to print,
          its standard output to the printer, and its standard error to the
          error logging file (specified in the <code class="literal">lf</code>
          capability in <code class="filename">/etc/printcap</code>, or
          <code class="filename">/dev/console</code> by default).</p><a id="idp81469264" class="indexterm"></a><p>Which filter <span class="application">LPD</span> starts and the
	  filter's arguments depend on
          what is listed in the <code class="filename">/etc/printcap</code> file and
          what arguments the user specified for the job on the
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> command line.  For example, if the user typed
          <code class="command">lpr -t</code>, <span class="application">LPD</span> would
	  start the troff filter, listed
          in the <code class="literal">tf</code> capability for the destination printer.
          If the user wanted to print plain text, it would start the
          <code class="literal">if</code> filter (this is mostly true: see <a class="link" href="printing-advanced.html#printing-advanced-of" title="9.4.1.5. Output Filters">Output Filters</a> for
          details).</p><p>There are three kinds of filters you can specify in
          <code class="filename">/etc/printcap</code>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The <span class="emphasis"><em>text filter</em></span>, confusingly called the
              <span class="emphasis"><em>input filter</em></span> in
	      <span class="application">LPD</span> documentation, handles
              regular text printing.  Think of it as the default filter.
	      <span class="application">LPD</span>
              expects every printer to be able to print plain text by default,
              and it is the text filter's job to make sure backspaces, tabs,
              or other special characters do not confuse the printer.  If you
              are in an environment where you have to account for printer
              usage, the text filter must also account for pages printed,
              usually by counting the number of lines printed and comparing
              that to the number of lines per page the printer supports.  The
              text filter is started with the following argument list:

              </p><div class="cmdsynopsis"><p><code class="command">filter-name</code> [-c]  -w<em class="replaceable"><code>width</code></em>   -l<em class="replaceable"><code>length</code></em>   -i<em class="replaceable"><code>indent</code></em>   -n <em class="replaceable"><code>login</code></em>   -h <em class="replaceable"><code>host</code></em>   <em class="replaceable"><code>acct-file</code></em> </p></div><p>

              where

              </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-c</code></span></dt><dd><p>appears if the job is submitted with <code class="command">lpr
                        -l</code></p></dd><dt><span class="term"><em class="replaceable"><code>width</code></em></span></dt><dd><p>is the value from the <code class="literal">pw</code> (page
                      width) capability specified in
                      <code class="filename">/etc/printcap</code>, default 132</p></dd><dt><span class="term"><em class="replaceable"><code>length</code></em></span></dt><dd><p>is the value from the <code class="literal">pl</code> (page
                      length) capability, default 66</p></dd><dt><span class="term"><em class="replaceable"><code>indent</code></em></span></dt><dd><p>is the amount of the indentation from <code class="command">lpr
                        -i</code>, default 0</p></dd><dt><span class="term"><em class="replaceable"><code>login</code></em></span></dt><dd><p>is the account name of the user printing the
                      file</p></dd><dt><span class="term"><em class="replaceable"><code>host</code></em></span></dt><dd><p>is the host name from which the job was
                      submitted</p></dd><dt><span class="term"><em class="replaceable"><code>acct-file</code></em></span></dt><dd><p>is the name of the accounting file from the
                      <code class="literal">af</code> capability.</p></dd></dl></div><p>
            </p></li><li class="listitem"><a id="idp81514576" class="indexterm"></a><p>A <span class="emphasis"><em>conversion filter</em></span> converts a specific
              file format into one the printer can render onto paper.  For
              example, ditroff typesetting data cannot be directly printed,
              but you can install a conversion filter for ditroff files to
              convert the ditroff data into a form the printer can digest and
              print.  Section <a class="link" href="printing-advanced.html#printing-advanced-convfilters" title="9.4.1.4. Conversion Filters">Conversion
                Filters</a> tells all about them. Conversion filters also
              need to do accounting, if you need printer accounting.
              Conversion filters are started with the following arguments:

              </p><div class="cmdsynopsis"><p><code class="command">filter-name</code>  -x<em class="replaceable"><code>pixel-width</code></em>   -y<em class="replaceable"><code>pixel-height</code></em>   -n <em class="replaceable"><code>login</code></em>   -h <em class="replaceable"><code>host</code></em>   <em class="replaceable"><code>acct-file</code></em> </p></div><p>

              where <em class="replaceable"><code>pixel-width</code></em> is the value
              from the px capability (default 0) and
              <em class="replaceable"><code>pixel-height</code></em> is the value from the
              py capability (default 0).</p></li><li class="listitem"><p>The <span class="emphasis"><em>output filter</em></span> is used only if there
              is no text filter, or if header pages are enabled. In my
              experience, output filters are rarely used.  Section <a class="link" href="printing-advanced.html#printing-advanced-of" title="9.4.1.5. Output Filters">Output Filters</a> describe
              them.  There are only two arguments to an output filter:

              </p><div class="cmdsynopsis"><p><code class="command">filter-name</code>  -w<em class="replaceable"><code>width</code></em>   -l<em class="replaceable"><code>length</code></em> </p></div><p>

              which are identical to the text filters <code class="option">-w</code> and
              <code class="option">-l</code> arguments.</p></li></ul></div><p>Filters should also <span class="emphasis"><em>exit</em></span> with the
          following exit status:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">exit 0</span></dt><dd><p>If the filter printed the file successfully.</p></dd><dt><span class="term">exit 1</span></dt><dd><p>If the filter failed to print the file but wants
		<span class="application">LPD</span> to
                try to print the file again.  <span class="application">LPD</span>
		will restart a filter if it exits with this status.</p></dd><dt><span class="term">exit 2</span></dt><dd><p>If the filter failed to print the file and does not want
                <span class="application">LPD</span> to try again.
		<span class="application">LPD</span> will throw out the file.</p></dd></dl></div><p>The text filter that comes with the FreeBSD release,
          <code class="filename">/usr/libexec/lpr/lpf</code>, takes advantage of the
          page width and length arguments to determine when to send a form
          feed and how to account for printer usage.  It uses the login, host,
          and accounting file arguments to make the accounting entries.</p><p>If you are shopping for filters, see if they are LPD-compatible.
          If they are, they must support the argument lists described above.
          If you plan on writing filters for general use, then have them
          support the same argument lists and exit codes.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-if-conversion"></a>9.4.1.2. Accommodating Plain Text Jobs on <span class="trademark">PostScript</span>(R) Printers</h4></div></div></div><a id="idp81541584" class="indexterm"></a><p>If you are the only user of your computer and <span class="trademark">PostScript</span>(R) (or
          other language-based) printer, and you promise to never send plain
          text to your printer and to never use features of various programs
          that will want to send plain text to your printer, then you do not
          need to worry about this section at all.</p><p>But, if you would like to send both <span class="trademark">PostScript</span>(R) and plain text
          jobs to the printer, then you are urged to augment your printer
          setup.  To do so, we have the text filter detect if the arriving job
          is plain text or <span class="trademark">PostScript</span>(R).  All <span class="trademark">PostScript</span>(R) jobs must start with
          <code class="literal">%!</code> (for other printer languages, see your printer
          documentation).  If those are the first two characters in the job,
          we have <span class="trademark">PostScript</span>(R), and can pass the rest of the job directly.  If
          those are not the first two characters in the file, then the filter
          will convert the text into <span class="trademark">PostScript</span>(R) and print the result.</p><p>How do we do this?</p><a id="idp81546704" class="indexterm"></a><p>If you have got a serial printer, a great way to do it is to
          install <code class="command">lprps</code>.  <code class="command">lprps</code> is a
          <span class="trademark">PostScript</span>(R) printer filter which performs two-way communication with
          the printer.  It updates the printer's status file with verbose
          information from the printer, so users and administrators can see
          exactly what the state of the printer is (such as <span class="errorname">toner
            low</span> or <span class="errorname">paper jam</span>).  But more
          importantly, it includes a program called <code class="command">psif</code>
          which detects whether the incoming job is plain text and calls
          <code class="command">textps</code> (another program that comes with
          <code class="command">lprps</code>) to convert it to <span class="trademark">PostScript</span>(R).  It then uses
          <code class="command">lprps</code> to send the job to the printer.</p><p><code class="command">lprps</code> is part of the FreeBSD Ports Collection
          (see <a class="link" href="ports.html" title="Rozdzia³ 4. Instalacja programów: pakiety i porty">The Ports Collection</a>).  You can
          fetch, build and install it yourself, of course.  After installing
          <code class="command">lprps</code>, just specify the pathname to the
          <code class="command">psif</code> program that is part of
          <code class="command">lprps</code>.  If you installed <code class="command">lprps</code>
          from the Ports Collection, use the following in the serial
          <span class="trademark">PostScript</span>(R) printer's entry in
          <code class="filename">/etc/printcap</code>:</p><pre class="programlisting">:if=/usr/local/libexec/psif:</pre><p>You should also specify the <code class="literal">rw</code> capability;
          that tells <span class="application">LPD</span> to open the printer in
	  read-write mode.</p><p>If you have a parallel <span class="trademark">PostScript</span>(R) printer (and therefore cannot
          use two-way communication with the printer, which
          <code class="command">lprps</code> needs), you can use the following shell
          script as the text filter:</p><pre class="programlisting">#!/bin/sh
#
#  psif - Print PostScript or plain text on a PostScript printer
#  Script version; NOT the version that comes with lprps
#  Installed in /usr/local/libexec/psif
#

IFS="" read -r first_line
first_two_chars=`expr "$first_line" : '\(..\)'`

if [ "$first_two_chars" = "%!" ]; then
    #
    #  PostScript job, print it.
    #
    echo "$first_line" &amp;&amp; cat &amp;&amp; printf "\004" &amp;&amp; exit 0
    exit 2
else
    #
    #  Plain text, convert it, then print it.
    #
    ( echo "$first_line"; cat ) | /usr/local/bin/textps &amp;&amp; printf "\004" &amp;&amp; exit 0
    exit 2
fi</pre><p>In the above script, <code class="command">textps</code> is a program we
          installed separately to convert plain text to <span class="trademark">PostScript</span>(R).  You can
          use any text-to-<span class="trademark">PostScript</span>(R) program you wish.  The FreeBSD Ports
          Collection (see <a class="link" href="ports.html" title="Rozdzia³ 4. Instalacja programów: pakiety i porty">The Ports Collection</a>)
          includes a full featured text-to-<span class="trademark">PostScript</span>(R) program called
          <code class="literal">a2ps</code> that you might want to investigate.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-ps"></a>9.4.1.3. Simulating <span class="trademark">PostScript</span>(R) on Non <span class="trademark">PostScript</span>(R) Printers</h4></div></div></div><a id="idp81617872" class="indexterm"></a><a id="idp81619024" class="indexterm"></a><p><span class="trademark">PostScript</span>(R) is the <span class="emphasis"><em>de facto</em></span> standard for
          high quality typesetting and printing.  <span class="trademark">PostScript</span>(R) is, however, an
          <span class="emphasis"><em>expensive</em></span> standard. Thankfully, Aladdin
          Enterprises has a free <span class="trademark">PostScript</span>(R) work-alike called
          <span class="application">Ghostscript</span> that runs with FreeBSD.
          Ghostscript can read most <span class="trademark">PostScript</span>(R) files and can render their
          pages onto a variety of devices, including many brands of
          non-PostScript printers.  By installing Ghostscript and using a
          special text filter for your printer, you can make your
          non <span class="trademark">PostScript</span>(R) printer act like a real <span class="trademark">PostScript</span>(R) printer.</p><p>Ghostscript is in the FreeBSD Ports Collection, if you
          would like to install it from there.  You can fetch, build, and
          install it quite easily yourself, as well.</p><p>To simulate <span class="trademark">PostScript</span>(R), we have the text filter detect if it is
          printing a <span class="trademark">PostScript</span>(R) file.  If it is not, then the filter will pass
          the file directly to the printer; otherwise, it will use Ghostscript
          to first convert the file into a format the printer will
          understand.</p><p>Here is an example: the following script is a text filter
          for Hewlett Packard DeskJet 500 printers.  For other printers,
          substitute the <code class="option">-sDEVICE</code> argument to the
          <code class="command">gs</code> (Ghostscript) command.  (Type <code class="command">gs
            -h</code> to get a list of devices the current installation of
          Ghostscript supports.)</p><pre class="programlisting">#!/bin/sh
#
#  ifhp - Print Ghostscript-simulated PostScript on a DeskJet 500
#  Installed in /usr/local/libexec/ifhp

#
#  Treat LF as CR+LF (to avoid the "staircase effect" on HP/PCL
#  printers):
#
printf "\033&amp;k2G" || exit 2

#
#  Read first two characters of the file
#
IFS="" read -r first_line
first_two_chars=`expr "$first_line" : '\(..\)'`

if [ "$first_two_chars" = "%!" ]; then
    #
    #  It is PostScript; use Ghostscript to scan-convert and print it.
    #
    /usr/local/bin/gs -dSAFER -dNOPAUSE -q -sDEVICE=djet500 \
      -sOutputFile=- - &amp;&amp; exit 0
else
    #
    #  Plain text or HP/PCL, so just print it directly; print a form feed
    #  at the end to eject the last page.
    #
    echo "$first_line" &amp;&amp; cat &amp;&amp; printf "\033&amp;l0H" &amp;&amp;
exit 0
fi

exit 2</pre><p>Finally, you need to notify <span class="application">LPD</span> of
	  the filter via the <code class="literal">if</code> capability:</p><pre class="programlisting">:if=/usr/local/libexec/ifhp:</pre><p>That is it.  You can type <code class="command">lpr plain.text</code> and
          <code class="filename">lpr whatever.ps</code> and both should print
          successfully.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-convfilters"></a>9.4.1.4. Conversion Filters</h4></div></div></div><p>After completing the simple setup described in <a class="link" href="printing-intro-setup.html#printing-simple" title="9.3.1. Simple Printer Setup">Simple Printer Setup</a>, the first
          thing you will probably want to do is install conversion filters for
          your favorite file formats (besides plain ASCII text).</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81636560"></a>9.4.1.4.1. Why Install Conversion Filters?</h5></div></div></div><a id="idp81637200" class="indexterm"></a><p>Conversion filters make printing various kinds of files easy.
            As an example, suppose we do a lot of work with the <span class="application">TeX</span>
            typesetting system, and we have a <span class="trademark">PostScript</span>(R) printer.  Every time
            we generate a DVI file from <span class="application">TeX</span>, we cannot print it directly until
            we convert the DVI file into <span class="trademark">PostScript</span>(R).  The command sequence
            goes like this:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>dvips seaweed-analysis.dvi</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>lpr seaweed-analysis.ps</code></strong></pre><p>By installing a conversion filter for DVI files, we can skip
            the hand conversion step each time by having
	    <span class="application">LPD</span> do it for us.
            Now, each time we get a DVI file, we are just one step away from
            printing it:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>lpr -d seaweed-analysis.dvi</code></strong></pre><p>We got <span class="application">LPD</span> to do the DVI file
	    conversion for us by specifying
            the <code class="option">-d</code> option.  Section <a class="link" href="printing-using.html#printing-lpr-options-format" title="9.5.4.1. Formatting and Conversion Options">Formatting and Conversion
              Options</a> lists the conversion options.</p><p>For each of the conversion options you want a printer to
            support, install a <span class="emphasis"><em>conversion filter</em></span> and
            specify its pathname in <code class="filename">/etc/printcap</code>.  A
            conversion filter is like the text filter for the simple printer
            setup (see section <a class="link" href="printing-intro-setup.html#printing-textfilter" title="9.3.1.5.6. Installing the Text Filter">Installing
              the Text Filter</a>) except that instead of printing plain
            text, the filter converts the file into a format the printer can
            understand.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81652304"></a>9.4.1.4.2. Which Conversion Filters Should I Install?</h5></div></div></div><p>You should install the conversion filters you expect to use.
            If you print a lot of DVI data, then a DVI conversion filter is in
            order.  If you have got plenty of troff to print out, then you
            probably want a troff filter.</p><p>The following table summarizes the filters that
	    <span class="application">LPD</span> works
            with, their capability entries for the
            <code class="filename">/etc/printcap</code> file, and how to invoke them
            with the <code class="command">lpr</code> command:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>File type</th><th><code class="filename">/etc/printcap</code> capability</th><th><code class="command">lpr</code> option</th></tr></thead><tbody><tr><td>cifplot</td><td><code class="literal">cf</code></td><td><code class="option">-c</code></td></tr><tr><td>DVI</td><td><code class="literal">df</code></td><td><code class="option">-d</code></td></tr><tr><td>plot</td><td><code class="literal">gf</code></td><td><code class="option">-g</code></td></tr><tr><td>ditroff</td><td><code class="literal">nf</code></td><td><code class="option">-n</code></td></tr><tr><td>FORTRAN text</td><td><code class="literal">rf</code></td><td><code class="option">-f</code></td></tr><tr><td>troff</td><td><code class="literal">tf</code></td><td><code class="option">-f</code></td></tr><tr><td>raster</td><td><code class="literal">vf</code></td><td><code class="option">-v</code></td></tr><tr><td>plain text</td><td><code class="literal">if</code></td><td>none, <code class="option">-p</code>, or
                    <code class="option">-l</code></td></tr></tbody></table></div><p>In our example, using <code class="command">lpr -d</code> means the
            printer needs a <code class="literal">df</code> capability in its entry in
            <code class="filename">/etc/printcap</code>.</p><a id="idp81683792" class="indexterm"></a><p>Despite what others might contend, formats like FORTRAN text
            and plot are probably obsolete.  At your site, you can give new
            meanings to these or any of the formatting options just by
            installing custom filters.  For example, suppose you would like to
            directly print Printerleaf files (files from the Interleaf desktop
            publishing program), but will never print plot files.  You could
            install a Printerleaf conversion filter under the
            <code class="literal">gf</code> capability and then educate your users that
            <code class="command">lpr -g</code> mean <span class="quote">"<span class="quote">print Printerleaf
            files.</span>"</span></p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81685840"></a>9.4.1.4.3. Installing Conversion Filters</h5></div></div></div><p>Since conversion filters are programs you install outside of
            the base FreeBSD installation, they should probably go under
            <code class="filename">/usr/local</code>.  The directory
            <code class="filename">/usr/local/libexec</code> is a popular location,
            since they are specialized programs that only
	    <span class="application">LPD</span> will run;
            regular users should not ever need to run them.</p><p>To enable a conversion filter, specify its pathname under the
            appropriate capability for the destination printer in
            <code class="filename">/etc/printcap</code>.</p><p>In our example, we will add the DVI conversion filter to the
            entry for the printer named <code class="literal">bamboo</code>.  Here is
            the example <code class="filename">/etc/printcap</code> file again, with
            the new <code class="literal">df</code> capability for the printer
            <code class="literal">bamboo</code>.</p><pre class="programlisting">#
#  /etc/printcap for host rose - added df filter for bamboo
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre><p>The DVI filter is a shell script named
            <code class="filename">/usr/local/libexec/psdf</code>.  Here is that
            script:</p><pre class="programlisting">#!/bin/sh
#
#  psdf - DVI to PostScript printer filter
#  Installed in /usr/local/libexec/psdf
#
# Invoked by lpd when user runs lpr -d
#
exec /usr/local/bin/dvips -f | /usr/local/libexec/lprps "$@"</pre><p>This script runs <code class="command">dvips</code> in filter mode (the
            <code class="option">-f</code> argument) on standard input, which is the job
            to print.  It then starts the <span class="trademark">PostScript</span>(R) printer filter
            <code class="command">lprps</code> (see section <a class="link" href="printing-advanced.html#printing-advanced-if-conversion" title="9.4.1.2. Accommodating Plain Text Jobs on PostScript(R) Printers">Accommodating Plain
              Text Jobs on <span class="trademark">PostScript</span>(R) Printers</a>) with the arguments
	    <span class="application">LPD</span>
            passed to this script. <code class="command">lprps</code> will use those
            arguments to account for the pages printed.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81700432"></a>9.4.1.4.4. More Conversion Filter Examples</h5></div></div></div><p>Since there is no fixed set of steps to install conversion
            filters, let me instead provide more examples.  Use these as
            guidance to making your own filters.  Use them directly, if
            appropriate.</p><p>This example script is a raster (well, GIF file, actually)
            conversion filter for a Hewlett Packard LaserJet III-Si
            printer:</p><pre class="programlisting">#!/bin/sh
#
#  hpvf - Convert GIF files into HP/PCL, then print
#  Installed in /usr/local/libexec/hpvf

PATH=/usr/X11R6/bin:$PATH; export PATH
giftopnm | ppmtopgm | pgmtopbm | pbmtolj -resolution 300 \
    &amp;&amp; exit 0 \
    || exit 2</pre><p>It works by converting the GIF file into a portable anymap,
            converting that into a portable graymap, converting that into a
            portable bitmap, and converting that into LaserJet/PCL-compatible
            data.</p><p>Here is the <code class="filename">/etc/printcap</code> file with an
            entry for a printer using the above filter:</p><pre class="programlisting">#
#  /etc/printcap for host orchid
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sh:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/hpif:\
        :vf=/usr/local/libexec/hpvf:</pre><p>The following script is a conversion filter for troff data
            from the groff typesetting system for the <span class="trademark">PostScript</span>(R) printer named
            <code class="literal">bamboo</code>:</p><pre class="programlisting">#!/bin/sh
#
#  pstf - Convert groff's troff data into PS, then print.
#  Installed in /usr/local/libexec/pstf
#
exec grops | /usr/local/libexec/lprps "$@"</pre><p>The above script makes use of <code class="command">lprps</code> again
            to handle the communication with the printer.  If the printer were
            on a parallel port, we would use this script instead:</p><pre class="programlisting">#!/bin/sh
#
#  pstf - Convert groff's troff data into PS, then print.
#  Installed in /usr/local/libexec/pstf
#
exec grops</pre><p>That is it.  Here is the entry we need to add to
            <code class="filename">/etc/printcap</code> to enable the filter:</p><pre class="programlisting">:tf=/usr/local/libexec/pstf:</pre><p>Here is an example that might make old hands at FORTRAN blush.
            It is a FORTRAN-text filter for any printer that can directly
            print plain text.  We will install it for the printer
            <code class="literal">teak</code>:</p><pre class="programlisting">#!/bin/sh
#
# hprf - FORTRAN text filter for LaserJet 3si:
# Installed in /usr/local/libexec/hprf
#

printf "\033&amp;k2G" &amp;&amp; fpr &amp;&amp; printf "\033&amp;l0H" &amp;&amp;
 exit 0
exit 2</pre><p>And we will add this line to the
            <code class="filename">/etc/printcap</code> for the printer
            <code class="literal">teak</code> to enable this filter:</p><pre class="programlisting">:rf=/usr/local/libexec/hprf:</pre><p>Here is one final, somewhat complex example.  We will add a
            DVI filter to the LaserJet printer <code class="literal">teak</code>
            introduced earlier.  First, the easy part: updating
            <code class="filename">/etc/printcap</code> with the location of the DVI
            filter:</p><pre class="programlisting">:df=/usr/local/libexec/hpdf:</pre><p>Now, for the hard part: making the filter.  For that, we need
            a DVI-to-LaserJet/PCL conversion program.  The FreeBSD Ports
            Collection (see <a class="link" href="ports.html" title="Rozdzia³ 4. Instalacja programów: pakiety i porty">The Ports Collection</a>)
            has one: <code class="command">dvi2xx</code> is the name of the package.
            Installing this package gives us the program we need,
            <code class="command">dvilj2p</code>, which converts DVI into LaserJet IIp,
            LaserJet III, and LaserJet 2000 compatible codes.</p><p><code class="command">dvilj2p</code> makes the filter
            <code class="command">hpdf</code> quite complex since
            <code class="command">dvilj2p</code> cannot read from standard input.  It
            wants to work with a filename. What is worse, the filename has to
            end in <code class="filename">.dvi</code> so using
            <code class="filename">/dev/fd/0</code> for standard input is problematic.
            We can get around that problem by linking (symbolically) a
            temporary file name (one that ends in <code class="filename">.dvi</code>)
            to <code class="filename">/dev/fd/0</code>, thereby forcing
            <code class="command">dvilj2p</code> to read from standard input.</p><p>The only other fly in the ointment is the fact that we cannot
            use <code class="filename">/tmp</code> for the temporary link. Symbolic
            links are owned by user and group <code class="systemitem">bin</code>.  The
            filter runs as user <code class="systemitem">daemon</code>.  And the
            <code class="filename">/tmp</code> directory has the sticky bit set. The
            filter can create the link, but it will not be able clean up when
            done and remove it since the link will belong to a different
            user.</p><p>Instead, the filter will make the symbolic link in the current
            working directory, which is the spooling directory (specified by
            the <code class="literal">sd</code> capability in
            <code class="filename">/etc/printcap</code>).  This is a perfect place for
            filters to do their work, especially since there is (sometimes)
            more free disk space in the spooling directory than under
            <code class="filename">/tmp</code>.</p><p>Here, finally, is the filter:</p><pre class="programlisting">#!/bin/sh
#
#  hpdf - Print DVI data on HP/PCL printer
#  Installed in /usr/local/libexec/hpdf

PATH=/usr/local/bin:$PATH; export PATH

#
#  Define a function to clean up our temporary files.  These exist
#  in the current directory, which will be the spooling directory
#  for the printer.
#
cleanup() {
   rm -f hpdf$$.dvi
}

#
#  Define a function to handle fatal errors: print the given message
#  and exit 2.  Exiting with 2 tells LPD to do not try to reprint the
#  job.
#
fatal() {
    echo "$@" 1&gt;&amp;2
    cleanup
    exit 2
}

#
#  If user removes the job, LPD will send SIGINT, so trap SIGINT
#  (and a few other signals) to clean up after ourselves.
#
trap cleanup 1 2 15

#
#  Make sure we are not colliding with any existing files.
#
cleanup

#
#  Link the DVI input file to standard input (the file to print).
#
ln -s /dev/fd/0 hpdf$$.dvi || fatal "Cannot symlink /dev/fd/0"

#
#  Make LF = CR+LF
#
printf "\033&amp;k2G" || fatal "Cannot initialize printer"

#
#  Convert and print.  Return value from dvilj2p does not seem to be
#  reliable, so we ignore it.
#
dvilj2p -M1 -q -e- dfhp$$.dvi

#
#  Clean up and exit
#
cleanup
exit 0</pre></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-autoconv"></a>9.4.1.4.5. Automated Conversion: an Alternative to Conversion
            Filters</h5></div></div></div><p>All these conversion filters accomplish a lot for your
            printing environment, but at the cost forcing the user to specify
            (on the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> command line) which one to use.
            If your users are not particularly computer literate, having to
            specify a filter option will become annoying.  What is worse,
            though, is that an incorrectly specified filter option may run a
            filter on the wrong type of file and cause your printer to spew
            out hundreds of sheets of paper.</p><p>Rather than install conversion filters at all, you might want
            to try having the text filter (since it is the default filter)
            detect the type of file it has been asked to print and then
            automatically run the right conversion filter.  Tools such as
            <code class="command">file</code> can be of help here.  Of course, it will
            be hard to determine the differences between
            <span class="emphasis"><em>some</em></span> file types-and, of course, you can
            still provide conversion filters just for them.</p><a id="idp81733456" class="indexterm"></a><a id="idp81733968" class="indexterm"></a><p>The FreeBSD Ports Collection has a text filter that performs
            automatic conversion called <code class="command">apsfilter</code>.  It can
            detect plain text, <span class="trademark">PostScript</span>(R), and DVI files, run the proper
            conversions, and print.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-of"></a>9.4.1.5. Output Filters</h4></div></div></div><p>The <span class="application">LPD</span> spooling system supports one
	  other type of filter that
          we have not yet explored: an output filter.  An output filter is
          intended for printing plain text only, like the text filter, but
          with many simplifications.  If you are using an output filter but no
          text filter, then:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="application">LPD</span> starts an output filter once
	      for the entire job instead
              of once for each file in the job.</p></li><li class="listitem"><p><span class="application">LPD</span> does not make any provision
	      to identify the start or the
              end of files within the job for the output filter.</p></li><li class="listitem"><p><span class="application">LPD</span> does not pass the user's
	      login or host to the filter, so
              it is not intended to do accounting.  In fact, it gets only two
              arguments:</p><div class="cmdsynopsis"><p><code class="command">filter-name</code>  -w<em class="replaceable"><code>width</code></em>   -l<em class="replaceable"><code>length</code></em> </p></div><p>Where <em class="replaceable"><code>width</code></em> is from the
              <code class="literal">pw</code> capability and
              <em class="replaceable"><code>length</code></em> is from the
              <code class="literal">pl</code> capability for the printer in
              question.</p></li></ul></div><p>Do not be seduced by an output filter's simplicity.  If you
          would like each file in a job to start on a different page an output
          filter <span class="emphasis"><em>will not work</em></span>.  Use a text filter (also
          known as an input filter); see section <a class="link" href="printing-intro-setup.html#printing-textfilter" title="9.3.1.5.6. Installing the Text Filter">Installing the Text Filter</a>.
          Furthermore, an output filter is actually <span class="emphasis"><em>more
            complex</em></span> in that it has to examine the byte stream being
          sent to it for special flag characters and must send signals to
          itself on behalf of <span class="application">LPD</span>.</p><p>However, an output filter is <span class="emphasis"><em>necessary</em></span> if
          you want header pages and need to send escape sequences or other
          initialization strings to be able to print the header page.  (But it
          is also <span class="emphasis"><em>futile</em></span> if you want to charge header
          pages to the requesting user's account, since
	  <span class="application">LPD</span> does not give any
          user or host information to the output filter.)</p><p>On a single printer, <span class="application">LPD</span>
	  allows both an output filter and text or other filters.  In
	  such cases, <span class="application">LPD</span> will start the
	  output filter
          to print the header page (see section <a class="link" href="printing-advanced.html#printing-advanced-header-pages" title="9.4.2. Header Pages">Header Pages</a>)
          only.  <span class="application">LPD</span> then expects the
	  output filter to <span class="emphasis"><em>stop
            itself</em></span> by sending two bytes to the filter: ASCII 031
          followed by ASCII 001.  When an output filter sees these two bytes
          (031, 001), it should stop by sending <code class="literal">SIGSTOP</code>
	  to itself.  When
	  <span class="application">LPD</span>'s
          done running other filters, it will restart the output filter by
          sending <code class="literal">SIGCONT</code> to it.</p><p>If there is an output filter but <span class="emphasis"><em>no</em></span> text
          filter and <span class="application">LPD</span> is working on a plain
	  text job, <span class="application">LPD</span> uses the output
          filter to do the job.  As stated before, the output filter will
          print each file of the job in sequence with no intervening form
          feeds or other paper advancement, and this is probably
          <span class="emphasis"><em>not</em></span> what you want.  In almost all cases, you
          need a text filter.</p><p>The program <code class="command">lpf</code>, which we introduced earlier
          as a text filter, can also run as an output filter.  If you need a
          quick-and-dirty output filter but do not want to write the byte
          detection and signal sending code, try <code class="command">lpf</code>.  You
          can also wrap <code class="command">lpf</code> in a shell script to handle any
          initialization codes the printer might require.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-lpf"></a>9.4.1.6. <code class="command">lpf</code>: a Text Filter</h4></div></div></div><p>The program <code class="filename">/usr/libexec/lpr/lpf</code> that comes
          with FreeBSD binary distribution is a text filter (input filter)
          that can indent output (job submitted with <code class="command">lpr
            -i</code>), allow literal characters to pass (job submitted
          with <code class="command">lpr -l</code>), adjust the printing position for
          backspaces and tabs in the job, and account for pages printed.  It
          can also act like an output filter.</p><p><code class="command">lpf</code> is suitable for many printing
          environments.  And although it has no capability to send
          initialization sequences to a printer, it is easy to write a shell
          script to do the needed initialization and then execute
          <code class="command">lpf</code>.</p><a id="idp81810256" class="indexterm"></a><a id="idp81810768" class="indexterm"></a><p>In order for <code class="command">lpf</code> to do page accounting
          correctly, it needs correct values filled in for the
          <code class="literal">pw</code> and <code class="literal">pl</code> capabilities in the
          <code class="filename">/etc/printcap</code> file.  It uses these values to
          determine how much text can fit on a page and how many pages were in
          a user's job.  For more information on printer accounting, see <a class="link" href="printing-advanced.html#printing-advanced-acct" title="9.4.5. Accounting for Printer Usage">Accounting for Printer
            Usage</a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-header-pages"></a>9.4.2. Header Pages</h3></div></div></div><p>If you have <span class="emphasis"><em>lots</em></span> of users, all of them using
        various printers, then you probably want to consider <span class="emphasis"><em>header
          pages</em></span> as a necessary evil.</p><a id="idp81816528" class="indexterm"></a><a id="idp81817680" class="indexterm"></a><p>Header pages, also known as <span class="emphasis"><em>banner</em></span> or
        <span class="emphasis"><em>burst pages</em></span> identify to whom jobs belong after
        they are printed.  They are usually printed in large, bold letters,
        perhaps with decorative borders, so that in a stack of printouts they
        stand out from the real documents that comprise users' jobs.  They
        enable users to locate their jobs quickly.  The obvious drawback to a
        header page is that it is yet one more sheet that has to be printed
        for every job, their ephemeral usefulness lasting not more than a few
        minutes, ultimately finding themselves in a recycling bin or rubbish
        heap.  (Note that header pages go with each job, not each file in a
        job, so the paper waste might not be that bad.)</p><p>The <span class="application">LPD</span> system can provide header
	pages automatically for your
        printouts <span class="emphasis"><em>if</em></span> your printer can directly print
       plain text.  If you have a <span class="trademark">PostScript</span>(R) printer, you will need an
        external program to generate the header page; see <a class="link" href="printing-advanced.html#printing-advanced-header-pages-ps" title="9.4.2.4. Header Pages on PostScript(R) Printers">Header Pages on
          <span class="trademark">PostScript</span>(R) Printers</a>.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-header-pages-enabling"></a>9.4.2.1. Enabling Header Pages</h4></div></div></div><p>In the <a class="link" href="printing-intro-setup.html#printing-simple" title="9.3.1. Simple Printer Setup">Simple Printer
            Setup</a> section, we turned off header pages by specifying
          <code class="literal">sh</code> (meaning <span class="quote">"<span class="quote">suppress header</span>"</span>) in the
          <code class="filename">/etc/printcap</code> file.  To enable header pages for
          a printer, just remove the <code class="literal">sh</code> capability.</p><p>Sounds too easy, right?</p><p>You are right.  You <span class="emphasis"><em>might</em></span> have to provide
          an output filter to send initialization strings to the printer.
          Here is an example output filter for Hewlett Packard PCL-compatible
          printers:</p><pre class="programlisting">#!/bin/sh
#
#  hpof - Output filter for Hewlett Packard PCL-compatible printers
#  Installed in /usr/local/libexec/hpof

printf "\033&amp;k2G" || exit 2
exec /usr/libexec/lpr/lpf</pre><p>Specify the path to the output filter in the
          <code class="literal">of</code> capability.  See the <a class="link" href="printing-advanced.html#printing-advanced-of" title="9.4.1.5. Output Filters">Output Filters</a> section for more
          information.</p><p>Here is an example <code class="filename">/etc/printcap</code> file for
          the printer <code class="literal">teak</code> that we introduced earlier; we
          enabled header pages and added the above output filter:</p><pre class="programlisting">#
#  /etc/printcap for host orchid
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/hpif:\
        :vf=/usr/local/libexec/hpvf:\
        :of=/usr/local/libexec/hpof:</pre><p>Now, when users print jobs to <code class="literal">teak</code>, they get
          a header page with each job.  If users want to spend time searching
          for their printouts, they can suppress header pages by submitting
          the job with <code class="command">lpr -h</code>; see the <a class="link" href="printing-using.html#printing-lpr-options-misc" title="9.5.4.3. Header Page Options">Header Page Options</a> section for
          more <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> options.</p><div xmlns="" class="note"><h3 class="admontitle">Uwaga: </h3><p xmlns="http://www.w3.org/1999/xhtml"><span class="application">LPD</span> prints a form feed character
	    after the header page. If
            your printer uses a different character or sequence of characters
            to eject a page, specify them with the <code class="literal">ff</code>
            capability in <code class="filename">/etc/printcap</code>.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-header-pages-controlling"></a>9.4.2.2. Controlling Header Pages</h4></div></div></div><p>By enabling header pages, <span class="application">LPD</span> will
	  produce a <span class="emphasis"><em>long
            header</em></span>, a full page of large letters identifying the
          user, host, and job.  Here is an example (kelly printed the job
          named outline from host <code class="systemitem">rose</code>):</p><pre class="programlisting">      k                   ll       ll
      k                    l        l
      k                    l        l
      k   k     eeee       l        l     y    y
      k  k     e    e      l        l     y    y
      k k      eeeeee      l        l     y    y
      kk k     e           l        l     y    y
      k   k    e    e      l        l     y   yy
      k    k    eeee      lll      lll     yyy y
                                               y
                                          y    y
                                           yyyy


                                   ll
                          t         l        i
                          t         l
       oooo    u    u   ttttt       l       ii     n nnn     eeee
      o    o   u    u     t         l        i     nn   n   e    e
      o    o   u    u     t         l        i     n    n   eeeeee
      o    o   u    u     t         l        i     n    n   e
      o    o   u   uu     t  t      l        i     n    n   e    e
       oooo     uuu u      tt      lll      iii    n    n    eeee









      r rrr     oooo     ssss     eeee
      rr   r   o    o   s    s   e    e
      r        o    o    ss      eeeeee
      r        o    o      ss    e
      r        o    o   s    s   e    e
      r         oooo     ssss     eeee







                                              Job:  outline
                                              Date: Sun Sep 17 11:04:58 1995</pre><p><span class="application">LPD</span> appends a form feed after this
	  text so the job starts on a
          new page (unless you have <code class="literal">sf</code> (suppress form
          feeds) in the destination printer's entry in
          <code class="filename">/etc/printcap</code>).</p><p>If you prefer, <span class="application">LPD</span> can make a
	  <span class="emphasis"><em>short header</em></span>;
          specify <code class="literal">sb</code> (short banner) in the
          <code class="filename">/etc/printcap</code> file. The header page will look
          like this:</p><pre class="programlisting">rose:kelly  Job: outline  Date: Sun Sep 17 11:07:51 1995</pre><p>Also by default, <span class="application">LPD</span> prints the
	  header page first, then the job.
          To reverse that, specify <code class="literal">hl</code> (header last) in
          <code class="filename">/etc/printcap</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-header-pages-accounting"></a>9.4.2.3. Accounting for Header Pages</h4></div></div></div><p>Using <span class="application">LPD</span>'s built-in header pages
	  enforces a particular paradigm
          when it comes to printer accounting: header pages must be
          <span class="emphasis"><em>free of charge</em></span>.</p><p>Why?</p><p>Because the output filter is the only external program that will
          have control when the header page is printed that could do
          accounting, and it is not provided with any <span class="emphasis"><em>user or
            host</em></span> information or an accounting file, so it has no
          idea whom to charge for printer use.  It is also not enough to just
          <span class="quote">"<span class="quote">add one page</span>"</span> to the text filter or any of the
          conversion filters (which do have user and host information) since
          users can suppress header pages with <code class="command">lpr -h</code>.
          They could still be charged for header pages they did not print.
          Basically, <code class="command">lpr -h</code> will be the preferred option of
          environmentally-minded users, but you cannot offer any incentive to
          use it.</p><p>It is <span class="emphasis"><em>still not enough</em></span> to have each of the
          filters generate their own header pages (thereby being able to
          charge for them).  If users wanted the option of suppressing the
          header pages with <code class="command">lpr -h</code>, they will still get
          them and be charged for them since <span class="application">LPD</span>
	  does not pass any knowledge
          of the <code class="option">-h</code> option to any of the filters.</p><p>So, what are your options?</p><p>You can:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Accept <span class="application">LPD</span>'s paradigm and make
	      header pages free.</p></li><li class="listitem"><p>Install an alternative to <span class="application">LPD</span>,
	      such as
		<span class="application">LPRng</span>. Section
              <a class="link" href="printing-lpd-alternatives.html" title="9.6. Alternatives to the Standard Spooler">Alternatives to the
                Standard Spooler</a> tells more about other spooling
              software you can substitute for <span class="application">LPD</span>.
	    </p></li><li class="listitem"><p>Write a <span class="emphasis"><em>smart</em></span> output filter. Normally,
              an output filter is not meant to do anything more than
              initialize a printer or do some simple character conversion.  It
              is suited for header pages and plain text jobs (when there is no
              text (input) filter).  But, if there is a text filter for the
              plain text jobs, then <span class="application">LPD</span> will start
	      the output filter only for
              the header pages.  And the output filter can parse the header
              page text that <span class="application">LPD</span> generates to
	      determine what user and host to
              charge for the header page.  The only other problem with this
              method is that the output filter still does not know what
              accounting file to use (it is not passed the name of the file
              from the <code class="literal">af</code> capability), but if you have a
              well-known accounting file, you can hard-code that into the
              output filter.  To facilitate the parsing step, use the
              <code class="literal">sh</code> (short header) capability in
              <code class="filename">/etc/printcap</code>.  Then again, all that might
              be too much trouble, and users will certainly appreciate the
              more generous system administrator who makes header pages
              free.</p></li></ul></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-header-pages-ps"></a>9.4.2.4. Header Pages on <span class="trademark">PostScript</span>(R) Printers</h4></div></div></div><p>As described above, <span class="application">LPD</span> can generate
	  a plain text header page
          suitable for many printers.  Of course, <span class="trademark">PostScript</span>(R) cannot directly
          print plain text, so the header page feature of
	  <span class="application">LPD</span> is
          useless-or mostly so.</p><p>One obvious way to get header pages is to have every conversion
          filter and the text filter generate the header page. The filters
          should use the user and host arguments to generate a suitable
          header page.  The drawback of this method is that users will always
          get a header page, even if they submit jobs with <code class="command">lpr
            -h</code>.</p><p>Let us explore this method.  The following script takes three
          arguments (user login name, host name, and job name) and makes a
          simple <span class="trademark">PostScript</span>(R) header page:</p><pre class="programlisting">#!/bin/sh
#
#  make-ps-header - make a PostScript header page on stdout
#  Installed in /usr/local/libexec/make-ps-header
#

#
#  These are PostScript units (72 to the inch).  Modify for A4 or
#  whatever size paper you are using:
#
page_width=612
page_height=792
border=72

#
#  Check arguments
#
if [ $# -ne 3 ]; then
    echo "Usage: `basename $0` &lt;user&gt; &lt;host&gt; &lt;job&gt;" 1&gt;&amp;2
    exit 1
fi

#
#  Save these, mostly for readability in the PostScript, below.
#
user=$1
host=$2
job=$3
date=`date`

#
#  Send the PostScript code to stdout.
#
exec cat &lt;&lt;EOF
%!PS

%
%  Make sure we do not interfere with user's job that will follow
%
save

%
%  Make a thick, unpleasant border around the edge of the paper.
%
$border $border moveto
$page_width $border 2 mul sub 0 rlineto
0 $page_height $border 2 mul sub rlineto
currentscreen 3 -1 roll pop 100 3 1 roll setscreen
$border 2 mul $page_width sub 0 rlineto closepath
0.8 setgray 10 setlinewidth stroke 0 setgray

%
%  Display user's login name, nice and large and prominent
%
/Helvetica-Bold findfont 64 scalefont setfont
$page_width ($user) stringwidth pop sub 2 div $page_height 200 sub moveto
($user) show

%
%  Now show the boring particulars
%
/Helvetica findfont 14 scalefont setfont
/y 200 def
[ (Job:) (Host:) (Date:) ] {
200 y moveto show /y y 18 sub def }
forall

/Helvetica-Bold findfont 14 scalefont setfont
/y 200 def
[ ($job) ($host) ($date) ] {
        270 y moveto show /y y 18 sub def
} forall

%
% That is it
%
restore
showpage
EOF</pre><p>Now, each of the conversion filters and the text filter can call
          this script to first generate the header page, and then print the
          user's job.  Here is the DVI conversion filter from earlier in this
          document, modified to make a header page:</p><pre class="programlisting">#!/bin/sh
#
#  psdf - DVI to PostScript printer filter
#  Installed in /usr/local/libexec/psdf
#
#  Invoked by lpd when user runs lpr -d
#

orig_args="$@"

fail() {
    echo "$@" 1&gt;&amp;2
    exit 2
}

while getopts "x:y:n:h:" option; do
    case $option in
        x|y)  ;; # Ignore
        n)    login=$OPTARG ;;
        h)    host=$OPTARG ;;
        *)    echo "LPD started `basename $0` wrong." 1&gt;&amp;2
              exit 2
              ;;
    esac
done

[ "$login" ] || fail "No login name"
[ "$host" ] || fail "No host name"

( /usr/local/libexec/make-ps-header $login $host "DVI File"
  /usr/local/bin/dvips -f ) | eval /usr/local/libexec/lprps $orig_args</pre><p>Notice how the filter has to parse the argument list in order to
          determine the user and host name.  The parsing for the other
          conversion filters is identical.  The text filter takes a slightly
          different set of arguments, though (see section <a class="link" href="printing-advanced.html#printing-advanced-filters" title="9.4.1.1. How Filters Work">How      Filters
            Work</a>).</p><p>As we have mentioned before, the above scheme, though fairly
          simple, disables the <span class="quote">"<span class="quote">suppress header page</span>"</span> option (the
          <code class="option">-h</code> option) to <code class="command">lpr</code>.  If users
          wanted to save a tree (or a few pennies, if you charge for header
          pages), they would not be able to do so, since every filter's going
          to print a header page with every job.</p><p>To allow users to shut off header pages on a per-job basis, you
          will need to use the trick introduced in section <a class="link" href="printing-advanced.html#printing-advanced-header-pages-accounting" title="9.4.2.3. Accounting for Header Pages">Accounting for
            Header Pages</a>: write an output filter that parses the
          LPD-generated header page and produces a <span class="trademark">PostScript</span>(R) version.  If the
          user submits the job with <code class="command">lpr -h</code>, then
	  <span class="application">LPD</span> will
          not generate a header page, and neither will your output filter.
          Otherwise, your output filter will read the text from
	  <span class="application">LPD</span> and send
          the appropriate header page <span class="trademark">PostScript</span>(R) code to the printer.</p><p>If you have a <span class="trademark">PostScript</span>(R) printer on a serial line, you can make
          use of <code class="command">lprps</code>, which comes with an output filter,
          <code class="command">psof</code>, which does the above.  Note that
          <code class="command">psof</code> does not charge for header pages.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-network-printers"></a>9.4.3. Networked Printing</h3></div></div></div><a id="idp81887824" class="indexterm"></a><a id="idp81888976" class="indexterm"></a><p>FreeBSD supports networked printing: sending jobs to remote
        printers.  Networked printing generally refers to two different
        things:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Accessing a printer attached to a remote host.  You install a
            printer that has a conventional serial or parallel interface on
            one host.  Then, you set up <span class="application">LPD</span> to
	    enable access to the printer
            from other hosts on the network. Section <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Printers Installed on Remote Hosts">Printers Installed on
              Remote Hosts</a> tells how to do this.</p></li><li class="listitem"><p>Accessing a printer attached directly to a network.  The
            printer has a network interface in addition (or in place of) a
            more conventional serial or parallel interface.  Such a printer
            might work as follows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>It might understand the <span class="application">LPD</span>
		protocol and can even queue
                jobs from remote hosts.  In this case, it acts just like a
                regular host running <span class="application">LPD</span>.  Follow
		the same procedure in
                section <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Printers Installed on Remote Hosts">Printers
                  Installed on Remote Hosts</a> to set up such a
                printer.</p></li><li class="listitem"><p>It might support a data stream network connection. In this
                case, you <span class="quote">"<span class="quote">attach</span>"</span> the printer to one host on the
                network by making that host responsible for spooling jobs and
                sending them to the printer. Section <a class="link" href="printing-advanced.html#printing-advanced-network-net-if" title="9.4.3.2. Printers with Networked Data Stream Interfaces">Printers with
                  Networked Data Stream Interfaces</a> gives some
                suggestions on installing such printers.</p></li></ul></div></li></ul></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-network-rm"></a>9.4.3.1. Printers Installed on Remote Hosts</h4></div></div></div><p>The <span class="application">LPD</span> spooling system has built-in
	  support for sending jobs to
          other hosts also running <span class="application">LPD</span> (or are
	  compatible with <span class="application">LPD</span>).  This
          feature enables you to install a printer on one host and make it
          accessible from other hosts.  It also works with printers that have
          network interfaces that understand the
	  <span class="application">LPD</span> protocol.</p><p>To enable this kind of remote printing, first install a printer
          on one host, the <span class="emphasis"><em>printer host</em></span>, using the simple
          printer setup described in the <a class="link" href="printing-intro-setup.html#printing-simple" title="9.3.1. Simple Printer Setup">Simple
            Printer Setup</a> section.  Do any advanced setup in <a class="link" href="printing-advanced.html" title="9.4. Advanced Printer Setup">Advanced Printer Setup</a> that you
          need.  Make sure to test the printer and see if it works with the
          features of <span class="application">LPD</span> you have enabled.
	  Also ensure that the
          <span class="emphasis"><em>local host</em></span> has authorization to use the
	  <span class="application">LPD</span>
          service in the <span class="emphasis"><em>remote host</em></span> (see <a class="link" href="printing-advanced.html#printing-advanced-restricting-remote" title="9.4.4.4. Restricting Jobs from Remote Printers">Restricting Jobs
            from Remote Printers</a>).</p><a id="idp81903568" class="indexterm"></a><a id="idp81904720" class="indexterm"></a><p>If you are using a printer with a network interface that is
          compatible with <span class="application">LPD</span>, then the
	  <span class="emphasis"><em>printer host</em></span> in
          the discussion below is the printer itself, and the
          <span class="emphasis"><em>printer name</em></span> is the name you configured for the
          printer.  See the documentation that accompanied your printer and/or
          printer-network interface.</p><div xmlns="" class="tip"><h3 class="admontitle">Podpowied¼: </h3><p xmlns="http://www.w3.org/1999/xhtml">If you are using a Hewlett Packard Laserjet then the printer
            name <code class="literal">text</code> will automatically perform the LF to
            CRLF conversion for you, so you will not require the
            <code class="filename">hpif</code> script.</p></div><p>Then, on the other hosts you want to have access to the printer,
          make an entry in their <code class="filename">/etc/printcap</code> files with
          the following:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Name the entry anything you want.  For simplicity, though,
              you probably want to use the same name and aliases as on the
              printer host.</p></li><li class="listitem"><p>Leave the <code class="literal">lp</code> capability blank, explicitly
              (<code class="literal">:lp=:</code>).</p></li><li class="listitem"><p>Make a spooling directory and specify its location in the
              <code class="literal">sd</code> capability.  <span class="application">LPD</span>
	      will store jobs here
              before they get sent to the printer host.</p></li><li class="listitem"><p>Place the name of the printer host in the
              <code class="literal">rm</code> capability.</p></li><li class="listitem"><p>Place the printer name on the <span class="emphasis"><em>printer
                host</em></span> in the <code class="literal">rp</code>
              capability.</p></li></ol></div><p>That is it.  You do not need to list conversion filters, page
          dimensions, or anything else in the
          <code class="filename">/etc/printcap</code> file.</p><p>Here is an example.  The host <code class="systemitem">rose</code> has two
          printers, <code class="literal">bamboo</code> and <code class="literal">rattan</code>.
          We will enable users on the host <code class="systemitem">orchid</code> to print
          to those printers.
          Here is the <code class="filename">/etc/printcap</code> file for
          <code class="systemitem">orchid</code> (back from section <a class="link" href="printing-advanced.html#printing-advanced-header-pages-enabling" title="9.4.2.1. Enabling Header Pages">Enabling Header
            Pages</a>).  It already had the entry for the printer
          <code class="literal">teak</code>; we have added entries for the two printers
          on the host <code class="systemitem">rose</code>:</p><pre class="programlisting">#
#  /etc/printcap for host orchid - added (remote) printers on rose
#

#
#  teak is local; it is connected directly to orchid:
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/ifhp:\
        :vf=/usr/local/libexec/vfhp:\
        :of=/usr/local/libexec/ofhp:

#
#  rattan is connected to rose; send jobs for rattan to rose:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=/var/spool/lpd/rattan:

#
#  bamboo is connected to rose as well:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=/var/spool/lpd/bamboo:</pre><p>Then, we just need to make spooling directories on
          <code class="systemitem">orchid</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir -p /var/spool/lpd/rattan /var/spool/lpd/bamboo</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chmod 770 /var/spool/lpd/rattan /var/spool/lpd/bamboo</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chown daemon:daemon /var/spool/lpd/rattan /var/spool/lpd/bamboo</code></strong></pre><p>Now, users on <code class="systemitem">orchid</code> can print to
          <code class="literal">rattan</code> and <code class="literal">bamboo</code>.  If, for
          example, a user on <code class="systemitem">orchid</code> typed

          </p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>lpr -P bamboo -d sushi-review.dvi</code></strong></pre><p>

          the <span class="application">LPD</span> system on <code class="systemitem">orchid</code>
	  would copy the job to the spooling
          directory <code class="filename">/var/spool/lpd/bamboo</code> and note that it was a
          DVI job.  As soon as the host <code class="systemitem">rose</code> has room in its
          <code class="literal">bamboo</code> spooling directory, the two
	  <span class="application">LPDs</span> would transfer the
          file to <code class="systemitem">rose</code>.  The file would wait in <code class="systemitem">rose</code>'s
          queue until it was finally printed.  It would be converted from DVI to
          <span class="trademark">PostScript</span>(R) (since <code class="literal">bamboo</code> is a <span class="trademark">PostScript</span>(R) printer) on
          <code class="systemitem">rose</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-network-net-if"></a>9.4.3.2. Printers with Networked Data Stream Interfaces</h4></div></div></div><p>Often, when you buy a network interface card for a printer, you
          can get two versions: one which emulates a spooler (the more
          expensive version), or one which just lets you send data to it as if
          you were using a serial or parallel port (the cheaper version).
          This section tells how to use the cheaper version. For the more
          expensive one, see the previous section <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Printers Installed on Remote Hosts">Printers Installed on
            Remote Hosts</a>.</p><p>The format of the <code class="filename">/etc/printcap</code> file lets
          you specify what serial or parallel interface to use, and (if you
          are using a serial interface), what baud rate, whether to use flow
          control, delays for tabs, conversion of newlines, and more.  But
          there is no way to specify a connection to a printer that is
          listening on a TCP/IP or other network port.</p><p>To send data to a networked printer, you need to develop a
          communications program that can be called by the text and conversion
          filters.  Here is one such example: the script
          <code class="command">netprint</code> takes all data on standard input and
          sends it to a network-attached printer.  We specify the hostname of
          the printer as the first argument and the port number to which to
          connect as the second argument to <code class="command">netprint</code>.  Note
          that this supports one-way communication only (FreeBSD to printer);
          many network printers support two-way communication, and you might
          want to take advantage of that (to get printer status, perform
          accounting, etc.).</p><pre class="programlisting">#!/usr/bin/perl
#
#  netprint - Text filter for printer attached to network
#  Installed in /usr/local/libexec/netprint
#
$#ARGV eq 1 || die "Usage: $0 &lt;printer-hostname&gt; &lt;port-number&gt;";

$printer_host = $ARGV[0];
$printer_port = $ARGV[1];

require 'sys/socket.ph';

($ignore, $ignore, $protocol) = getprotobyname('tcp');
($ignore, $ignore, $ignore, $ignore, $address)
    = gethostbyname($printer_host);

$sockaddr = pack('S n a4 x8', &amp;AF_INET, $printer_port, $address);

socket(PRINTER, &amp;PF_INET, &amp;SOCK_STREAM, $protocol)
    || die "Can't create TCP/IP stream socket: $!";
connect(PRINTER, $sockaddr) || die "Can't contact $printer_host: $!";
while (&lt;STDIN&gt;) { print PRINTER; }
exit 0;</pre><p>We can then use this script in various filters.  Suppose we had
          a Diablo 750-N line printer connected to the network.  The printer
          accepts data to print on port number 5100.  The host name of the
          printer is scrivener.  Here is the text filter for the
          printer:</p><pre class="programlisting">#!/bin/sh
#
#  diablo-if-net - Text filter for Diablo printer `scrivener' listening
#  on port 5100.   Installed in /usr/local/libexec/diablo-if-net
#
exec /usr/libexec/lpr/lpf "$@" | /usr/local/libexec/netprint scrivener 5100</pre></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-restricting"></a>9.4.4. Restricting Printer Usage</h3></div></div></div><a id="idp81963216" class="indexterm"></a><p>This section gives information on restricting printer usage. The
        <span class="application">LPD</span> system lets you control who can access
	a printer, both locally or
        remotely, whether they can print multiple copies, how large their jobs
        can be, and how large the printer queues can get.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-restricting-copies"></a>9.4.4.1. Restricting Multiple Copies</h4></div></div></div><p>The <span class="application">LPD</span> system makes it easy for
	  users to print multiple copies
          of a file.  Users can print jobs with <code class="command">lpr -#5</code>
          (for example) and get five copies of each file in the job.  Whether
          this is a good thing is up to you.</p><p>If you feel multiple copies cause unnecessary wear and tear on
          your printers, you can disable the <code class="option">-#</code> option to
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> by adding the <code class="literal">sc</code> capability to the
          <code class="filename">/etc/printcap</code> file.  When users submit jobs
          with the <code class="option">-#</code> option, they will see:</p><pre class="screen">lpr: multiple copies are not allowed</pre><p>Note that if you have set up access to a printer remotely (see
          section <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Printers Installed on Remote Hosts">Printers
            Installed on Remote Hosts</a>), you need the
          <code class="literal">sc</code> capability on the remote
          <code class="filename">/etc/printcap</code> files as well, or else users will
          still be able to submit multiple-copy jobs by using another
          host.</p><p>Here is an example.  This is the
          <code class="filename">/etc/printcap</code> file for the host
          <code class="systemitem">rose</code>.  The printer <code class="literal">rattan</code> is
          quite hearty, so we will allow multiple copies, but the laser
          printer <code class="literal">bamboo</code> is a bit more delicate, so we will
          disable multiple copies by adding the <code class="literal">sc</code>
          capability:</p><pre class="programlisting">#
#  /etc/printcap for host rose - restrict multiple copies on bamboo
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre><p>Now, we also need to add the <code class="literal">sc</code> capability on
          the host <code class="systemitem">orchid</code>'s
          <code class="filename">/etc/printcap</code> (and while we are at it, let us
          disable multiple copies for the printer
          <code class="literal">teak</code>):</p><pre class="programlisting">#
#  /etc/printcap for host orchid - no multiple copies for local
#  printer teak or remote printer bamboo
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:sc:\
        :if=/usr/local/libexec/ifhp:\
        :vf=/usr/local/libexec/vfhp:\
        :of=/usr/local/libexec/ofhp:

rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=/var/spool/lpd/rattan:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=/var/spool/lpd/bamboo:sc:</pre><p>By using the <code class="literal">sc</code> capability, we prevent the
          use of <code class="command">lpr -#</code>, but that still does not prevent
          users from running <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a>
          multiple times, or from submitting the same file multiple times in
          one job like this:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>lpr forsale.sign forsale.sign forsale.sign forsale.sign forsale.sign</code></strong></pre><p>There are many ways to prevent this abuse (including ignoring
          it) which you are free to explore.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-restricting-access"></a>9.4.4.2. Restricting Access to Printers</h4></div></div></div><p>You can control who can print to what printers by using the <span class="trademark">UNIX</span>(R)
          group mechanism and the <code class="literal">rg</code> capability in
          <code class="filename">/etc/printcap</code>.  Just place the users you want
          to have access to a printer in a certain group, and then name that
          group in the <code class="literal">rg</code> capability.</p><p>Users outside the group (including <code class="systemitem">root</code>)
	  will be greeted with

          <span class="errorname">lpr: Not a member of the restricted group</span>

          if they try to print to the controlled printer.</p><p>As with the <code class="literal">sc</code> (suppress multiple copies)
          capability, you need to specify <code class="literal">rg</code> on remote
          hosts that also have access to your printers, if you feel it is
          appropriate (see section <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Printers Installed on Remote Hosts">Printers Installed on
            Remote Hosts</a>).</p><p>For example, we will let anyone access the printer
          <code class="literal">rattan</code>, but only those in group
          <code class="literal">artists</code> can use <code class="literal">bamboo</code>.  Here
          is the familiar <code class="filename">/etc/printcap</code> for host
          <code class="systemitem">rose</code>:</p><pre class="programlisting">#
#  /etc/printcap for host rose - restricted group for bamboo
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre><p>Let us leave the other example
          <code class="filename">/etc/printcap</code> file (for the host
          <code class="systemitem">orchid</code>) alone.  Of course, anyone on
          <code class="systemitem">orchid</code> can print to <code class="literal">bamboo</code>.  It
          might be the case that we only allow certain logins on
          <code class="systemitem">orchid</code> anyway, and want them to have access to the
          printer.  Or not.</p><div xmlns="" class="note"><h3 class="admontitle">Uwaga: </h3><p xmlns="http://www.w3.org/1999/xhtml">There can be only one restricted group per printer.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-restricting-sizes"></a>9.4.4.3. Controlling Sizes of Jobs Submitted</h4></div></div></div><a id="idp82005712" class="indexterm"></a><p>If you have many users accessing the printers, you probably need
          to put an upper limit on the sizes of the files users can submit to
          print.  After all, there is only so much free space on the
          filesystem that houses the spooling directories, and you also need
          to make sure there is room for the jobs of other users.</p><a id="idp82006608" class="indexterm"></a><p><span class="application">LPD</span> enables you to limit the maximum
	  byte size a file in a job
          can be with the <code class="literal">mx</code> capability. The units are in
          <code class="literal">BUFSIZ</code> blocks, which are 1024 bytes.  If you put
	  a zero for this
          capability, there will be no limit on file size; however, if no
          <code class="literal">mx</code> capability is specified, then a default limit
          of 1000 blocks will be used.</p><div xmlns="" class="note"><h3 class="admontitle">Uwaga: </h3><p xmlns="http://www.w3.org/1999/xhtml">The limit applies to <span class="emphasis"><em>files</em></span> in a job, and
            <span class="emphasis"><em>not</em></span> the total job size.</p></div><p><span class="application">LPD</span> will not refuse a file that is
	  larger than the limit you
          place on a printer.  Instead, it will queue as much of the file up
          to the limit, which will then get printed.  The rest will be
          discarded.  Whether this is correct behavior is up for
          debate.</p><p>Let us add limits to our example printers
          <code class="literal">rattan</code> and <code class="literal">bamboo</code>.  Since
          those artists' <span class="trademark">PostScript</span>(R) files tend to be large, we will limit them
          to five megabytes. We will put no limit on the plain text line
          printer:</p><pre class="programlisting">#
#  /etc/printcap for host rose
#

#
#  No limit on job size:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:mx#0:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

#
#  Limit of five megabytes:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:mx#5000:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre><p>Again, the limits apply to the local users only.  If you have
          set up access to your printers remotely, remote users will not get
          those limits.  You will need to specify the <code class="literal">mx</code>
          capability in the remote <code class="filename">/etc/printcap</code> files as
          well.  See section <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Printers Installed on Remote Hosts">Printers Installed      on
            Remote Hosts</a> for more information on remote
          printing.</p><p>There is another specialized way to limit job sizes from remote
          printers; see section <a class="link" href="printing-advanced.html#printing-advanced-restricting-remote" title="9.4.4.4. Restricting Jobs from Remote Printers">Restricting Jobs
            from Remote Printers</a>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-restricting-remote"></a>9.4.4.4. Restricting Jobs from Remote Printers</h4></div></div></div><p>The <span class="application">LPD</span> spooling system provides
	  several ways to restrict print
          jobs submitted from remote hosts:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Host restrictions</span></dt><dd><p>You can control from which remote hosts a local
		<span class="application">LPD</span> accepts requests with the files
                <code class="filename">/etc/hosts.equiv</code> and
                <code class="filename">/etc/hosts.lpd</code>.
		<span class="application">LPD</span> checks to see if an
                incoming request is from a host listed in either one of these
                files.  If not, <span class="application">LPD</span> refuses the
		request.</p><p>The format of these files is simple: one host name per
                line.  Note that the file
                <code class="filename">/etc/hosts.equiv</code> is also used by the
                  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ruserok&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">ruserok</span>(3)</span></a> protocol, and affects programs like
                  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rsh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rsh</span>(1)</span></a> and <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rcp</span>(1)</span></a>, so be careful.</p><p>For example, here is the
                <code class="filename">/etc/hosts.lpd</code> file on the host
                <code class="systemitem">rose</code>:</p><pre class="programlisting">orchid
violet
madrigal.fishbaum.de</pre><p>This means <code class="systemitem">rose</code> will accept requests from
                the hosts <code class="systemitem">orchid</code>, <code class="systemitem">violet</code>,
                and <code class="systemitem">madrigal.fishbaum.de</code>. If any
                other host tries to access <code class="systemitem">rose</code>'s
                <span class="application">LPD</span>, the job will be refused.</p></dd><dt><span class="term">Size restrictions</span></dt><dd><p>You can control how much free space there needs to remain
                on the filesystem where a spooling directory resides.  Make a
                file called <code class="filename">minfree</code> in the spooling
                directory for the local printer.  Insert in that file a number
                representing how many disk blocks (512 bytes) of free space
                there has to be for a remote job to be accepted.</p><p>This lets you insure that remote users will not fill your
                filesystem.  You can also use it to give a certain priority to
                local users: they will be able to queue jobs long after the
                free disk space has fallen below the amount specified in the
                <code class="filename">minfree</code> file.</p><p>For example, let us add a <code class="filename">minfree</code>
                file for the printer <code class="literal">bamboo</code>.  We examine
                <code class="filename">/etc/printcap</code> to find the spooling
                directory for this printer; here is <code class="literal">bamboo</code>'s
                entry:</p><pre class="programlisting">bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:mx#5000:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:mx#5000:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre><p>The spooling directory is given in the <code class="literal">sd</code>
                capability.  We will make three megabytes (which is 6144 disk blocks)
                the amount of free disk space that must exist on the filesystem for
                <span class="application">LPD</span> to accept remote jobs:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>echo 6144 &gt; /var/spool/lpd/bamboo/minfree
              </code></strong></pre></dd><dt><span class="term">User restrictions</span></dt><dd><p>You can control which remote users can print to local
                printers by specifying the <code class="literal">rs</code> capability in
                <code class="filename">/etc/printcap</code>.  When
                <code class="literal">rs</code> appears in the entry for a
                locally-attached printer, <span class="application">LPD</span> will
		accept jobs from remote
                hosts <span class="emphasis"><em>if</em></span> the user submitting the job also
                has an account of the same login name on the local host.
                Otherwise, <span class="application">LPD</span> refuses the job.</p><p>This capability is particularly useful in an environment
                where there are (for example) different departments sharing a
                network, and some users transcend departmental boundaries.  By
                giving them accounts on your systems, they can use your
                printers from their own departmental systems.  If you would
                rather allow them to use <span class="emphasis"><em>only</em></span> your
                printers and not your computer resources, you can give them
                <span class="quote">"<span class="quote">token</span>"</span> accounts, with no home directory and a
                useless shell like <code class="filename">/usr/bin/false</code>.</p></dd></dl></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-acct"></a>9.4.5. Accounting for Printer Usage</h3></div></div></div><a id="idp82055760" class="indexterm"></a><p>So, you need to charge for printouts.  And why not? Paper and ink
        cost money.  And then there are maintenance costs-printers are
        loaded with moving parts and tend to break down.  You have examined
        your printers, usage patterns, and maintenance fees and have come up
        with a per-page (or per-foot, per-meter, or per-whatever) cost.  Now,
        how do you actually start accounting for printouts?</p><p>Well, the bad news is the <span class="application">LPD</span> spooling
	system does not provide
        much help in this department.  Accounting is highly dependent on the
        kind of printer in use, the formats being printed, and
        <span class="emphasis"><em>your</em></span> requirements in charging for printer
        usage.</p><p>To implement accounting, you have to modify a printer's text
        filter (to charge for plain text jobs) and the conversion filters (to
        charge for other file formats), to count pages or query the printer
        for pages printed.  You cannot get away with using the simple output
        filter, since it cannot do accounting.  See section <a class="link" href="printing-advanced.html#printing-advanced-filter-intro" title="9.4.1. Filters">Filters</a>.</p><p>Generally, there are two ways to do accounting:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="emphasis"><em>Periodic accounting</em></span> is the more common
            way, possibly because it is easier.  Whenever someone prints a
            job, the filter logs the user, host, and number of pages to an
            accounting file.  Every month, semester, year, or whatever time
            period you prefer, you collect the accounting files for the
            various printers, tally up the pages printed by users, and charge
            for usage.  Then you truncate all the logging files, starting with
            a clean slate for the next period.</p></li><li class="listitem"><p><span class="emphasis"><em>Timely accounting</em></span> is less common,
            probably because it is more difficult.  This method has the
            filters charge users for printouts as soon as they use the
            printers.  Like disk quotas, the accounting is immediate. You can
            prevent users from printing when their account goes in the red,
            and might provide a way for users to check and adjust their
            <span class="quote">"<span class="quote">print quotas.</span>"</span> But this method requires some database
            code to track users and their quotas.</p></li></ul></div><p>The <span class="application">LPD</span> spooling system supports both
	methods easily: since you
        have to provide the filters (well, most of the time), you also have to
        provide the accounting code.  But there is a bright side: you have
        enormous flexibility in your accounting methods.  For example, you
        choose whether to use periodic or timely accounting. You choose what
        information to log: user names, host names, job types, pages printed,
        square footage of paper used, how long the job took to print, and so
        forth.  And you do so by modifying the filters to save this
        information.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82063312"></a>9.4.5.1. Quick and Dirty Printer Accounting</h4></div></div></div><p>FreeBSD comes with two programs that can get you set up with
          simple periodic accounting right away.  They are the text filter
          <code class="command">lpf</code>, described in section <a class="link" href="printing-advanced.html#printing-advanced-lpf" title="9.4.1.6. lpf: a Text Filter">lpf: a Text Filter</a>, and
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a>, a program to gather and total
          entries from printer accounting files.</p><p>As mentioned in the section on filters (<a class="link" href="printing-advanced.html#printing-advanced-filters" title="9.4.1.1. How Filters Work">Filters</a>),
	  <span class="application">LPD</span> starts
          the text and the conversion filters with the name of the accounting
          file to use on the filter command line.  The filters can use this
          argument to know where to write an accounting file entry.  The name
          of this file comes from the <code class="literal">af</code> capability in
          <code class="filename">/etc/printcap</code>, and if not specified as an
          absolute path, is relative to the spooling directory.</p><p><span class="application">LPD</span> starts <code class="command">lpf</code>
	  with page width and length
          arguments (from the <code class="literal">pw</code> and <code class="literal">pl</code>
          capabilities).  <code class="command">lpf</code> uses these arguments to
          determine how much paper will be used.  After sending the file to
          the printer, it then writes an accounting entry in the accounting
          file.  The entries look like this:</p><pre class="programlisting">2.00 rose:andy
3.00 rose:kelly
3.00 orchid:mary
5.00 orchid:mary
2.00 orchid:zhang</pre><p>You should use a separate accounting file for each printer, as
          <code class="command">lpf</code> has no file locking logic built into it, and
          two <code class="command">lpf</code>s might corrupt each other's entries if
          they were to write to the same file at the same time.  An easy way
          to insure a separate accounting file for each printer is to use
          <code class="literal">af=acct</code> in <code class="filename">/etc/printcap</code>.
          Then, each accounting file will be in the spooling directory for a
          printer, in a file named <code class="filename">acct</code>.</p><p>When you are ready to charge users for printouts, run the
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> program.  Just change to the spooling directory for
          the printer you want to collect on and type <code class="literal">pac</code>.
          You will get a dollar-centric summary like the following:</p><pre class="screen">  Login               pages/feet   runs    price
orchid:kelly                5.00    1   $  0.10
orchid:mary                31.00    3   $  0.62
orchid:zhang                9.00    1   $  0.18
rose:andy                   2.00    1   $  0.04
rose:kelly                177.00  104   $  3.54
rose:mary                  87.00   32   $  1.74
rose:root                  26.00   12   $  0.52

total                     337.00  154   $  6.74</pre><p>These are the arguments <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> expects:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-P<em class="replaceable"><code>printer</code></em></code></span></dt><dd><p>Which <em class="replaceable"><code>printer</code></em> to summarize.
                This option works only if there is an absolute path in the
                <code class="literal">af</code> capability in
                <code class="filename">/etc/printcap</code>.</p></dd><dt><span class="term"><code class="option">-c</code></span></dt><dd><p>Sort the output by cost instead of alphabetically by user
                name.</p></dd><dt><span class="term"><code class="option">-m</code></span></dt><dd><p>Ignore host name in the accounting files.  With this
                option, user <code class="systemitem">smith</code> on host
                <code class="systemitem">alpha</code> is the same user
                <code class="systemitem">smith</code> on host <code class="systemitem">gamma</code>.
                Without, they are different users.</p></dd><dt><span class="term"><code class="option">-p<em class="replaceable"><code>price</code></em></code></span></dt><dd><p>Compute charges with <em class="replaceable"><code>price</code></em>
                dollars per page or per foot instead of the price from the
                <code class="literal">pc</code> capability in
                <code class="filename">/etc/printcap</code>, or two cents (the
                default).  You can specify <em class="replaceable"><code>price</code></em> as
                a floating point number.</p></dd><dt><span class="term"><code class="option">-r</code></span></dt><dd><p>Reverse the sort order.</p></dd><dt><span class="term"><code class="option">-s</code></span></dt><dd><p>Make an accounting summary file and truncate the
                accounting file.</p></dd><dt><span class="term"><em class="replaceable"><code>name</code></em>
              <em class="replaceable"><code>...</code></em></span></dt><dd><p>Print accounting information for the given user
                <em class="replaceable"><code>names</code></em> only.</p></dd></dl></div><p>In the default summary that <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> produces, you see the
          number of pages printed by each user from various hosts.  If, at
          your site, host does not matter (because users can use any host),
          run <code class="command">pac -m</code>, to produce the following
          summary:</p><pre class="screen">  Login               pages/feet   runs    price
andy                        2.00    1   $  0.04
kelly                     182.00  105   $  3.64
mary                      118.00   35   $  2.36
root                       26.00   12   $  0.52
zhang                       9.00    1   $  0.18

total                     337.00  154   $  6.74</pre><p>To compute the dollar amount due,
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> uses the <code class="literal">pc</code> capability in the
          <code class="filename">/etc/printcap</code> file (default of 200, or 2 cents
          per page).  Specify, in hundredths of cents, the price per page or
          per foot you want to charge for printouts in this capability.  You
          can override this value when you run <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> with the
          <code class="option">-p</code> option.  The units for the <code class="option">-p</code>
          option are in dollars, though, not hundredths of cents.  For
          example,

          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pac -p1.50</code></strong></pre><p>

          makes each page cost one dollar and fifty cents.  You can really
          rake in the profits by using this option.</p><p>Finally, running <code class="command">pac -s</code> will save the summary
          information in a summary accounting file, which is named the same as
          the printer's accounting file, but with <code class="literal">_sum</code>
          appended to the name.  It then truncates the accounting file.  When
          you run <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> again, it rereads the
          summary file to get starting totals, then adds information from the
          regular accounting file.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82111056"></a>9.4.5.2. How Can You Count Pages Printed?</h4></div></div></div><p>In order to perform even remotely accurate accounting, you need
          to be able to determine how much paper a job uses.  This is the
          essential problem of printer accounting.</p><p>For plain text jobs, the problem is not that hard to solve: you
          count how many lines are in a job and compare it to how many lines
          per page your printer supports.  Do not forget to take into account
          backspaces in the file which overprint lines, or long logical lines
          that wrap onto one or more additional physical lines.</p><p>The text filter <code class="command">lpf</code> (introduced in <a class="link" href="printing-advanced.html#printing-advanced-lpf" title="9.4.1.6. lpf: a Text Filter">lpf: a Text Filter</a>) takes
          into account these things when it does accounting.  If you are
          writing a text filter which needs to do accounting, you might want
          to examine <code class="command">lpf</code>'s source code.</p><p>How do you handle other file formats, though?</p><p>Well, for DVI-to-LaserJet or DVI-to-<span class="trademark">PostScript</span>(R) conversion, you
          can have your filter parse the diagnostic output of
          <code class="command">dvilj</code> or <code class="command">dvips</code> and look to see
          how many pages were converted.  You might be able to do similar
          things with other file formats and conversion programs.</p><p>But these methods suffer from the fact that the printer may not
          actually print all those pages.  For example, it could jam, run out
          of toner, or explode-and the user would still get
          charged.</p><p>So, what can you do?</p><p>There is only one <span class="emphasis"><em>sure</em></span> way to do
          <span class="emphasis"><em>accurate</em></span> accounting.  Get a printer that can
          tell you how much paper it uses, and attach it via a serial line or
          a network connection.  Nearly all <span class="trademark">PostScript</span>(R) printers support this
          notion.  Other makes and models do as well (networked Imagen laser
          printers, for example).  Modify the filters for these printers to
          get the page usage after they print each job and have them log
          accounting information based on that value
          <span class="emphasis"><em>only</em></span>.  There is no line counting nor
          error-prone file examination required.</p><p>Of course, you can always be generous and make all printouts
          free.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="printing-intro-setup.html">Poprzedni</a> </td><td width="20%" align="center"><a accesskey="u" href="printing.html">Pocz±tek rozdzia³u</a></td><td width="40%" align="right"> <a accesskey="n" href="printing-using.html">Nastêpny</a></td></tr><tr><td width="40%" align="left" valign="top">9.3. Basic Setup </td><td width="20%" align="center"><a accesskey="h" href="index.html">Spis tre¶ci</a></td><td width="40%" align="right" valign="top"> 9.5. Using Printers</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>