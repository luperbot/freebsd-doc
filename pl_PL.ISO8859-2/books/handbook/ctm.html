<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>A.4. Using CTM</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Podrêcznik FreeBSD" /><link rel="up" href="mirrors.html" title="Dodatek A. Obtaining FreeBSD" /><link rel="prev" href="anoncvs.html" title="A.3. Anonymous CVS" /><link rel="next" href="cvsup.html" title="A.5. Using CVSup" /><link rel="copyright" href="legalnotice.html" title="Informacja Prawna" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">A.4. Using CTM</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="anoncvs.html">Poprzedni</a> </td><th width="60%" align="center">Dodatek A. Obtaining FreeBSD</th><td width="20%" align="right"> <a accesskey="n" href="cvsup.html">Nastêpny</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="ctm"></a>A.4. Using CTM</h2></div></div></div><a id="idp97557200" class="indexterm"></a><p><span class="application">CTM</span> is a method for keeping a
	remote directory tree in sync with a central one.  It has been
	developed for usage with FreeBSD's source trees, though other
	people may find it useful for other purposes as time goes by.
	Little, if any, documentation currently exists at this time on the
	process of creating deltas, so contact the <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-users" target="_top">ctm-users</a> mailing list for more
	information and if you wish to use <span class="application">CTM</span>
	for other things.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97559504"></a>A.4.1. Why Should I Use <span class="application">CTM</span>?</h3></div></div></div><p><span class="application">CTM</span> will give you a local copy of
	  the FreeBSD source trees.  There are a number of
	  <span class="quote">"<span class="quote">flavors</span>"</span> of the tree available.  Whether you wish
	  to track the entire CVS tree or just one of the branches,
	  <span class="application">CTM</span> can provide you the information.
	  If you are an active developer on FreeBSD, but have lousy or
	  non-existent TCP/IP connectivity, or simply wish to have the
	  changes automatically sent to you,
	  <span class="application">CTM</span> was made for you.  You will need
	  to obtain up to three deltas per day for the most  active
	  branches.  However, you should consider having them sent by
	  automatic email.  The sizes of the updates are always kept as
	  small as possible.  This is typically less than 5K, with an
	  occasional (one in ten) being 10-50K and every now and then a
	  large 100K+ or more coming around.</p><p>You will also need to make yourself aware of the various
	  caveats related to working directly from the development sources
	  rather than a pre-packaged release.  This is particularly true
	  if you choose the <span class="quote">"<span class="quote">current</span>"</span> sources.  It is
	  recommended that you read <a class="link" href="current-stable.html#current" title="21.2.1. Staying Current with FreeBSD">Staying
	  current with FreeBSD</a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97563856"></a>A.4.2. What Do I Need to Use
	  <span class="application">CTM</span>?</h3></div></div></div><p>You will need two things: The <span class="application">CTM</span>
	  program, and the initial deltas to feed it (to get up to
	  <span class="quote">"<span class="quote">current</span>"</span> levels).</p><p>The <span class="application">CTM</span> program has been part of
	  FreeBSD ever since version 2.0 was released, and lives in
	  <code class="filename">/usr/src/usr.sbin/ctm</code> if you have a copy
	  of the source available.</p><p>The <span class="quote">"<span class="quote">deltas</span>"</span> you feed
	  <span class="application">CTM</span> can be had two ways, FTP or
	  email.  If you have general FTP access to the Internet then the
	  following FTP sites support access to
	  <span class="application">CTM</span>:</p><p><code class="uri"><a class="uri" href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/" target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/</a></code></p><p>or see section <a class="link" href="ctm.html#mirrors-ctm" title="A.4.9. CTM Mirrors">mirrors</a>.</p><p>FTP the relevant directory and fetch the
	  <code class="filename">README</code> file, starting from there.</p><p>If you wish to get your deltas via email:</p><p>Subscribe to one of the
	  <span class="application">CTM</span> distribution lists.
	  <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-cvs-cur" target="_top">ctm-cvs-cur</a> supports the entire CVS tree.
	  <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-src-cur" target="_top">ctm-src-cur</a> supports the head of the development
	  branch.  <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-src-4" target="_top">ctm-src-4</a> supports the 4.X release
	  branch, etc..  (If you do not know how to subscribe yourself
	  to a list, click on the list name above or go to
	  <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo" target="_top">http://lists.FreeBSD.org/mailman/listinfo</a> and click on the list that you
	  wish to subscribe to.  The list page should contain all of
	  the necessary subscription instructions.)</p><p>When you begin receiving your <span class="application">CTM</span>
	  updates in the mail, you may use the
	  <code class="command">ctm_rmail</code> program to unpack and apply them.
	  You can actually use the <code class="command">ctm_rmail</code> program
	  directly from a entry in <code class="filename">/etc/aliases</code> if
	  you want to have the process run in a fully automated fashion.
	  Check the <code class="command">ctm_rmail</code> manual page for more
	  details.</p><div xmlns="" class="note"><h3 class="admontitle">Uwaga: </h3><p xmlns="http://www.w3.org/1999/xhtml">No matter what method you use to get the
	    <span class="application">CTM</span> deltas, you should subscribe to
	    the <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-announce" target="_top">ctm-announce</a> mailing list.  In
	    the future, this will be the only place where announcements
	    concerning the operations of the
	    <span class="application">CTM</span> system will be posted.  Click
	    on the list name above and follow the instructions
	    to subscribe to the
	    list.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97579088"></a>A.4.3. Using <span class="application">CTM</span> for the First
	  Time</h3></div></div></div><p>Before you can start using <span class="application">CTM</span>
	  deltas, you will need to get to a starting point for the deltas
	  produced subsequently to it.</p><p>First you should determine what you already have.  Everyone
	  can start from an <span class="quote">"<span class="quote">empty</span>"</span> directory.  You must use
	  an initial <span class="quote">"<span class="quote">Empty</span>"</span> delta to start off your
	  <span class="application">CTM</span> supported tree.  At some point it
	  is intended that one of these <span class="quote">"<span class="quote">started</span>"</span> deltas be
	  distributed on the CD for your convenience, however, this does
	  not currently happen.</p><p>Since the trees are many tens of megabytes, you should
	  prefer to start from something already at hand.  If you have a
	  -RELEASE CD, you can copy or extract an initial source from it.
	  This will save a significant transfer of data.</p><p>You can recognize these <span class="quote">"<span class="quote">starter</span>"</span> deltas by the
	  <code class="literal">X</code> appended to the number
	  (<code class="filename">src-cur.3210XEmpty.gz</code> for instance).  The
	  designation following the <code class="literal">X</code> corresponds to
	  the origin of your initial <span class="quote">"<span class="quote">seed</span>"</span>.
	  <code class="filename">Empty</code> is an empty directory.  As a rule a
	  base transition from <code class="literal">Empty</code> is produced
	  every 100 deltas.  By the way, they are large! 70 to 80
	  Megabytes of <code class="command">gzip</code>'d data is common for the
	  <code class="filename">XEmpty</code> deltas.</p><p>Once you have picked a base delta to start from, you will also
	  need all deltas with higher numbers following it.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97592016"></a>A.4.4. Using <span class="application">CTM</span> in Your Daily
	  Life</h3></div></div></div><p>To apply the deltas, simply say:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /where/ever/you/want/the/stuff</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ctm -v -v /where/you/store/your/deltas/src-xxx.*</code></strong></pre><p><span class="application">CTM</span> understands deltas which have
	  been put through <code class="command">gzip</code>, so you do not need to
	  <code class="command">gunzip</code> them first, this saves disk space.</p><p>Unless it feels very secure about the entire process,
	  <span class="application">CTM</span> will not touch your tree.  To
	  verify a delta you can also use the <code class="option">-c</code> flag and
	  <span class="application">CTM</span> will not actually touch your
	  tree; it will merely verify the integrity of the delta and see
	  if it would apply cleanly to your current tree.</p><p>There are other options to <span class="application">CTM</span>
	  as well, see the manual pages or look in the sources for more
	  information.</p><p>That is really all there is to it.  Every time you get a new
	  delta, just run it through <span class="application">CTM</span> to
	  keep your sources up to date.</p><p>Do not remove the deltas if they are hard to download again.
	  You just might want to keep them around in case something bad
	  happens.  Even if you only have floppy disks, consider using
	  <code class="command">fdwrite</code> to make a copy.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97604688"></a>A.4.5. Keeping Your Local Changes</h3></div></div></div><p>As a developer one would like to experiment with and change
	  files in the source tree.  <span class="application">CTM</span>
	  supports local modifications in a limited way: before checking
	  for the presence of a file <code class="filename">foo</code>, it first
	  looks for <code class="filename">foo.ctm</code>.  If this file exists,
	  <span class="application">CTM</span> will operate on it instead of
	  <code class="filename">foo</code>.</p><p>This behavior gives us a simple way to maintain local
	  changes:  simply copy the files you plan to modify to the
	  corresponding file names with a <code class="filename">.ctm</code>
	  suffix.  Then you can freely hack  the code, while <span class="application">CTM</span> keeps the
	  <code class="filename">.ctm</code> file up-to-date.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97609296"></a>A.4.6. Other Interesting <span class="application">CTM</span> Options</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97610320"></a>A.4.6.1. Finding Out Exactly What Would Be Touched by an
	    Update</h4></div></div></div><p>You can determine the list of changes that
	    <span class="application">CTM</span> will make on your source
	    repository using the <code class="option">-l</code> option to
	    <span class="application">CTM</span>.</p><p>This is useful if you would like to keep logs of the
	    changes, pre- or post- process the modified files in any
	    manner, or just are feeling a tad paranoid.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97613136"></a>A.4.6.2. Making Backups Before Updating</h4></div></div></div><p>Sometimes you may want to backup all the files that would
	    be changed by a <span class="application">CTM</span> update.</p><p>Specifying the <code class="option">-B backup-file</code> option
	    causes <span class="application">CTM</span> to backup all files that
	    would be touched by a given <span class="application">CTM</span>
	    delta to <code class="filename">backup-file</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97616592"></a>A.4.6.3. Restricting the Files Touched by an Update</h4></div></div></div><p>Sometimes you would be interested in restricting the scope
	    of a given <span class="application">CTM</span> update, or may be
	    interested in extracting just a few files from a sequence of
	    deltas.</p><p>You can control the list of files that
	    <span class="application">CTM</span> would operate on by specifying
	    filtering regular expressions using the <code class="option">-e</code>
	    and <code class="option">-x</code> options.</p><p>For example, to extract an up-to-date copy of
	    <code class="filename">lib/libc/Makefile</code> from your collection of
	    saved <span class="application">CTM</span> deltas, run the commands:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /where/ever/you/want/to/extract/it/</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ctm -e '^lib/libc/Makefile' ~ctm/src-xxx.*</code></strong></pre><p>For every file specified in a
	    <span class="application">CTM</span> delta, the <code class="option">-e</code>
	    and <code class="option">-x</code> options are applied in the order given
	    on the command line.  The file is processed by
	    <span class="application">CTM</span> only if it is marked as
	    eligible after all the <code class="option">-e</code> and
	    <code class="option">-x</code> options are applied to it.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97629520"></a>A.4.7. Future Plans for <span class="application">CTM</span></h3></div></div></div><p>Tons of them:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Use some kind of authentication into the <span class="application">CTM</span> system, so
	      as to allow detection of spoofed <span class="application">CTM</span> updates.</p></li><li class="listitem"><p>Clean up the options to <span class="application">CTM</span>,
	      they became confusing and counter intuitive.</p></li></ul></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97634128"></a>A.4.8. Miscellaneous Stuff</h3></div></div></div><p>There is a sequence of deltas for the
	  <code class="literal">ports</code> collection too, but interest has not
	  been all that high yet.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mirrors-ctm"></a>A.4.9. CTM Mirrors</h3></div></div></div><p><a class="link" href="ctm.html" title="A.4. Using CTM">CTM</a>/FreeBSD is available via anonymous
      FTP from the following mirror sites.  If you choose to obtain <span class="application">CTM</span> via
      anonymous FTP, please try to use a site near you.</p><p>In case of problems, please contact the <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-users" target="_top">ctm-users</a>
      mailing list.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">California, Bay Area, official source</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li></ul></div></dd><dt><span class="term">South Africa, backup server for old deltas</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/" target="_top">ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/</a></code></p></li></ul></div></dd><dt><span class="term">Taiwan/R.O.C.</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li></ul></div></dd></dl></div><p>If you did not find a mirror near to you or the mirror is
      incomplete, try to use a search engine such as
      <a class="link" href="http://www.alltheweb.com/" target="_top">alltheweb</a>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="anoncvs.html">Poprzedni</a> </td><td width="20%" align="center"><a accesskey="u" href="mirrors.html">Pocz±tek rozdzia³u</a></td><td width="40%" align="right"> <a accesskey="n" href="cvsup.html">Nastêpny</a></td></tr><tr><td width="40%" align="left" valign="top">A.3. Anonymous CVS </td><td width="20%" align="center"><a accesskey="h" href="index.html">Spis tre¶ci</a></td><td width="40%" align="right" valign="top"> A.5. Using CVSup</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>