<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>7.2. Configuración de la tarjeta de sonido</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manual de FreeBSD" /><link rel="up" href="multimedia.html" title="Capítulo 7. Multimedia" /><link rel="prev" href="multimedia.html" title="Capítulo 7. Multimedia" /><link rel="next" href="sound-mp3.html" title="7.3. Sonido MP3" /><link rel="copyright" href="legalnotice.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7.2. Configuración de la tarjeta de sonido</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="multimedia.html">Anterior</a> </td><th width="60%" align="center">Capítulo 7. Multimedia</th><td width="20%" align="right"> <a accesskey="n" href="sound-mp3.html">Siguiente</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="sound-setup"></a>7.2. Configuración de la tarjeta de sonido</h2></div><div><span class="authorgroup">Escrito por <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Moses</span> <span class="surname">Moore</span></span>. </span></div><div><span class="authorgroup">Ampliado para FreeBSD 5.X por <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Marc</span> <span class="surname">Fonvieille</span></span>. </span></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="sound-device"></a>7.2.1. Configuración del sistema </h3></div></div></div><a id="idp71550672" class="indexterm"></a><a id="idp71551184" class="indexterm"></a><a id="idp71551696" class="indexterm"></a><p>Antes de nada tendrá que saber a ciencia cierta el
      modelo de tarjeta que tiene, qué chip utiliza y si es PCI
      o ISA.  FreeBSD admite una amplia variedad de tarjetas, tanto PCI como
      ISA.  Consulte la lista de dispositivos de sonido que puede usar
      en FreeBSD en las <a class="link" href="http://www.FreeBSD.org/releases/10.1R/hardware.html" target="_top">Hardware Notes</a>.  Las
      «Hardware Notes» le dirán también
      qué controlador es el que hace funcionar su tarjeta.</p><a id="idp71553104" class="indexterm"></a><p>Para poder usar su dispositivo de sonido en FreeBSD tiene que
      cargar el controlador de dispositivo adecuado, cosa que puede
      hacerse de dos maneras.  La forma más fácil es
      cargar el módulo del kernel correspondiente a su tarjeta
      de sonido mediante <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kldload&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">kldload</span>(8)</span></a>.  Puede hacerlo en su shell
      con la siguiente orden</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kldload snd_emu10k1</code></strong></pre><p>o añadiendo la línea apropiada al fichero
      <code class="filename">/boot/loader.conf</code>:</p><pre class="programlisting">snd_emu10k1_load="YES"</pre><p>Ambos ejemplos son para una tarjeta de sonido
      Creative <span class="trademark">SoundBlaster</span>® Live!.  Encontrará una lista de
      módulos de sonido que puede cargar del mismo modo en
      <code class="filename">/boot/defaults/loader.conf</code>.  Si no está
      del todo seguro sobre el controlador que debe usar pruebe con el
      módulo <code class="filename">snd_driver</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kldload snd_driver</code></strong></pre><p>Se trata de un «metacontrolador» que carga en
      memoria todos los controladores más habituales.  De este modo
      acelerará notablemente el proceso de detectar cuál es
      el controlador perfecto para su hardware.  También
      puede cargar todos los controladores de sonido desde
      <code class="filename">/boot/loader.conf</code>.</p><p>Si quiere saber qué controlador se corresponde
      con su tarjeta de sonido una vez cargado el «metadriver»
      <code class="filename">snd_driver</code> debe comprobar el contenido de
      <code class="filename">/dev/sndstat</code> mediante la orden
      <code class="command">cat /dev/sndstat</code>.</p><p>El segundo método es compilar de forma estática
      el soporte para su tarjeta de sonido dentro de un kernel
      personalizado.  En la siguiente sección encontrará
      la información necesaria para añadir a su kernel
      el soporte que necesita su hardware.  Para más información
      sobre la compilación de un kernel consulte el <a class="xref" href="kernelconfig.html" title="Capítulo 8. Configuración del kernel de FreeBSD">Capítulo 8, <em>Configuración del kernel de FreeBSD</em></a>.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp71595984"></a>7.2.1.1. Configuración de un kernel personalizado con soporte de sonido</h4></div></div></div><p>Lo primero que hay que hacer es añadir el
        controlador del «framework» de sonido
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sound&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sound</span>(4)</span></a> al kernel;  tendrá que añadir
	la siguiente línea a su fichero de configuración
	del kernel:</p><pre class="programlisting">device sound</pre><p>Una vez hecho esto tiene que añadir el soporte
        para su tarjeta de sonido.  Evidentemente tendrá que
	saber exactamente qué controlador es el que hace
	funcionar su tarjeta.  Consulte la lista de dispositivos de
	sonido soportados que encontrará en las <a class="link" href="http://www.FreeBSD.org/releases/10.1R/hardware.html" target="_top">Hardware Notes</a> y elija
	el controlador perfecto para su tarjeta.  Por ejemplo una
	una tarjeta de sonido Creative <span class="trademark">SoundBlaster</span>® Live! usará
	el controlador <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=snd_emu10k1&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">snd_emu10k1</span>(4)</span></a>.  Siguiendo con el ejemplo,
	si queremos añadir soporte para esta tarjeta agregaremos
	lo siguiente:</p><pre class="programlisting">device snd_emu10k1</pre><p>Por favor, lea la página de manual del controlador
        si tiene dudas con la sintaxis.  La sintaxis específica
	para la configuración en el kernel de cada tarjeta de
	sonido soportada existente puede encontrarse también
	en <code class="filename">/usr/src/sys/conf/NOTES</code>.</p><p>Las tarjetas ISA no PnP pueden requerir que se le
        facilite al kernel la información de la
	configuración de la tarjeta (IRQ, puerto de E/S, etc).  Esto
	se hace modificando el fichero
	<code class="filename">/boot/device.hints</code>.  Durante el proceso de
	arranque <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=loader&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">loader</span>(8)</span></a> leerá este fichero y le
	pasará los parámetros al kernel.  Veamos un ejemplo:
	una vieja tarjeta Creative <span class="trademark">SoundBlaster</span>® 16 ISA no PnP
	utilizará el controlador <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=snd_sbc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">snd_sbc</span>(4)</span></a> junto con
	<code class="literal">snd_sb16</code>.  En el caso de esta tarjeta
	habrá que añadir las siguientes líneas
	al fichero de configuración del kernel</p><pre class="programlisting">device snd_sbc
device snd_sb16</pre><p>y añadir lo siguiente a
	<code class="filename">/boot/device.hints</code>:</p><pre class="programlisting">hint.sbc.0.at="isa"
hint.sbc.0.port="0x220"
hint.sbc.0.irq="5"
hint.sbc.0.drq="1"
hint.sbc.0.flags="0x15"</pre><p>La tarjeta del ejemplo usa el puerto de E/S <code class="literal">0x220</code>
	I/O port y la IRQ <code class="literal">5</code>.</p><p>La sintaxis a utilizar en
	<code class="filename">/boot/device.hints</code> se explica en
	la página de manual de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sound&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sound</span>(4)</span></a> y en la del
	controlador en cuestión.</p><p>En el ejemplo se muestran los parámetros por
        omisión.  En ciertos casos habrá que usar
	otra IRQ o usar otros parámetros para hacer funcionar
	la tarjeta de sonido.  Consulte la página de manual de
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=snd_sbc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">snd_sbc</span>(4)</span></a> para más información sobre esta
	tarjeta.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="sound-testing"></a>7.2.2. Cómo probar su tarjeta de sonido</h3></div></div></div><p>Una vez que haya reiniciado con su kernel personalizado, o
      tras cargar el mólo del kernel necesario la tarjeta de
      sonido aparecerá en el búfer de mensajes del sistema
      (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dmesg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dmesg</span>(8)</span></a>); deberí ser algo muy parecido a esto:</p><pre class="screen">pcm0: &lt;Intel ICH3 (82801CA)&gt; port 0xdc80-0xdcbf,0xd800-0xd8ff irq 5 at device 31.5 on pci0
pcm0: [GIANT-LOCKED]
pcm0: &lt;Cirrus Logic CS4205 AC97 Codec&gt;</pre><p>Puede comprobar el estado de la tarjeta de sonido en
      el fichero <code class="filename">/dev/sndstat</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cat /dev/sndstat</code></strong>
FreeBSD Audio Driver (newpcm)
Installed devices:
pcm0: &lt;Intel ICH3 (82801CA)&gt; at io 0xd800, 0xdc80 irq 5 bufsz 16384
kld snd_ich (1p/2r/0v channels duplex default)</pre><p>El resultado en su sistema seguramente será distinto.  Si
      no aparecen dispositivos <code class="filename">pcm</code> revise todo el
      proceso a ver dónde está el error.  Revise su fichero
      de configuración del kernel nuevamente y compruebe que
      eligió el controlador de dispositivo adecuado.  Tiene una
      lista de problemas habituales en la <a class="xref" href="sound-setup.html#troubleshooting" title="7.2.2.1. Problemas habituales">Sección 7.2.2.1, &#8220;Problemas habituales&#8221;</a>.</p><p>Si todo ha ido bien ya tiene una tarjeta de sonido funcionando
      en su sistema.  Si los pins de salida de sonido de su CD-ROM o DVD-ROM
      están colocados correctamente puede poner un CD en la unidad
      y reproducirlo con <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cdcontrol&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">cdcontrol</span>(1)</span></a>.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>cdcontrol -f /dev/acd0 play 1</code></strong></pre><p>Hay muchas aplicaciones como <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/workman/pkg-descr">audio/workman</a> que le ofrecerán
      un interfaz más amigable.  Si quiere escuchar ficheros MP3
      puede instalar, por ejemplo,
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/mpg123/pkg-descr">audio/mpg123</a>.</p><p>Hay otra via aún más rápida de probar su
      tarjeta de sonido.  Envíe datos a
      to <code class="filename">/dev/dsp</code> del siguiente modo:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>cat fichero &gt; /dev/dsp</code></strong></pre><p>donde <code class="filename">fichero</code>
      puede ser cualquier fichero.  Esta orden producirá ruido,
      lo que confirmará que la tarjeta de sonido funciona.</p><p>Puede manejar los niveles de la tarjeta de sonido con <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mixer&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mixer</span>(8)</span></a>.
      Tiene todos los detalles en la página de manual de
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mixer&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mixer</span>(8)</span></a>.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="troubleshooting"></a>7.2.2.1. Problemas habituales</h4></div></div></div><a id="idp67000144" class="indexterm"></a><a id="idp67000656" class="indexterm"></a><a id="idp67001168" class="indexterm"></a><a id="idp67001680" class="indexterm"></a><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Error</th><th>Solution</th></tr></thead><tbody><tr><td><span class="errorname">sb_dspwr(XX) timed out</span></td><td><p>El puerto de E/S no ha sido configurado correctamente.</p></td></tr><tr><td><span class="errorname">bad irq XX</span></td><td><p>No ha elegido correctamente la IRQ.  Asegúrese
  	        de que la IRQ que ha elegido y la IRQ del sonido son la misma.</p></td></tr><tr><td><span class="errorname">xxx: gus pcm not attached, out of memory</span></td><td><p>No queda memoria suficiente en el sistema para poder
	        usar el dispositivo.</p></td></tr><tr><td><span class="errorname">xxx: can't open /dev/dsp!</span></td><td><p>Compruebe si hay otra aplicación utilizando
	        (y por tanto ocupando) el dispositivo.  Escriba
	        <code class="command">fstat | grep dsp</code>.  Los sospechosos
                habituales son <span class="application">esound</span> y
		el sistema de sonido de <span class="application">KDE</span>.
                </p></td></tr></tbody></table></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="sound-multiple-sources"></a>7.2.3. Cómo utilizar múltiples fuentes de sonido</h3></div><div><span class="authorgroup">Escrito por <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Munish</span> <span class="surname">Chopra</span></span>. </span></div></div></div><p>Disponer de múltiples fuentes de sonido puede ser muy
      útil, por ejemplo cuando
      <span class="application">esound</span> o
      <span class="application">artsd</span> no permiten compartir el dispositivo
      de sonido con otra aplicación.</p><p>FreeBSD permite hacerlo gracias a los <span class="emphasis"><em>Virtual Sound
      Channels</em></span> (<code class="literal">canales virtuales de sonido</code>),
      que se activan mediante <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span></a>.  Los canales virtuales
      permiten multiplexar la reproducción de sonido de su tarjeta
      mezclando el sonido en el kernel.</p><p>El número de canales virtuales se configura utilizando
      dos sysctl; como <code class="systemitem">root</code> escriba lo siguiente:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl hw.snd.pcm0.vchans=4</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sysctl hw.snd.maxautovchans=4</code></strong></pre><p>En el ejemplo anterior se han creado cuatro canales virtuales, una
      cantidad muy razonable para el uso normal.
      <code class="varname">hw.snd.pcm0.vchans</code> es el número de canales
      virtuales de que dispone <code class="filename">pcm0</code>; puede configurarlo
      en cuanto el dispositivo sea reconocido por el sistema.
      <code class="literal">hw.snd.maxautovchans</code> es el número de canales
      virtuales que se le asignan a un nuevo dispositivo de audio cuando se
      conecta al sistema mediante <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kldload&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">kldload</span>(8)</span></a>.  Puesto que el
      módulo <code class="filename">pcm</code> puede cargarse independientemente
      de los controladores de hardware
      <code class="varname">hw.snd.maxautovchans</code> puede almacenar cuántos
      canales virtuales tienen asignados los dispositivos que se vayan
      conectando al sistema.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">No es posible modificar el número de canales virtuales
        de un dispositivo que esté en marcha.  Cierre antes todos
	los programas que estén utilizando el dispositivo, como
	reproductores de música o dæmons de sonido.</p></div><p>Si no usa <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">devfs</span>(5)</span></a> tendrá que configurar sus
      aplicaciones para que apunten a
      <code class="filename">/dev/dsp0</code>.<em class="replaceable"><code>x</code></em>,
      donde <em class="replaceable"><code>x</code></em> es un número entre 0 y 3 si
      <code class="varname">hw.snd.pcm.0.vchans</code> tiene un valor de 4 como en el
      ejemplo anterior.  Si se estuviera usando
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">devfs</span>(5)</span></a> en el ejemplo anterior cualquier programa que pidiera
      <code class="filename">/dev/dsp0</code> sería atendido de
      forma totalmente transparente.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp71809360"></a>7.2.4. Asignación a los canales de mezcla de valores por omisión</h3></div><div><span class="authorgroup">Escrito por <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Josef</span> <span class="surname">El-Rayes</span></span>. </span></div></div></div><p>Los valores por defecto de los distintos canales de mezcla
      están fijados en el código del controlador
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pcm&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pcm</span>(4)</span></a>.  Hay distintas aplicaciones y dæmons
      que le permitirán asignar valores al mezclador y que
      permanezcan entre uso y uso, pero no es una solución
      demasiado limpia.  Puede asignar valores por omisión a
      las mezclas a nivel de controlador definiendo los valores
      apropiados en <code class="filename">/boot/device.hints</code>.  Veamos
      un ejemplo:</p><pre class="programlisting">hint.pcm.0.vol="50"</pre><p>Esto asignará al canal de volumen un valor por
      omisión de 50 al cargar el módulo
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pcm&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pcm</span>(4)</span></a>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="multimedia.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="multimedia.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="sound-mp3.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Capítulo 7. Multimedia </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 7.3. Sonido MP3</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>