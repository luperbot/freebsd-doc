<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>29.5. Puenteado</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manual de FreeBSD" /><link rel="up" href="advanced-networking.html" title="Capítulo 29. Networking avanzado" /><link rel="prev" href="network-bluetooth.html" title="29.4. Bluetooth" /><link rel="next" href="network-nfs.html" title="29.6. NFS" /><link rel="copyright" href="legalnotice.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">29.5. Puenteado</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-bluetooth.html">Anterior</a> </td><th width="60%" align="center">Capítulo 29. Networking avanzado</th><td width="20%" align="right"> <a accesskey="n" href="network-nfs.html">Siguiente</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-bridging"></a>29.5. Puenteado</h2></div><div><span class="authorgroup">Escrito por <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Steve</span> <span class="surname">Peterson</span></span>. </span></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82405712"></a>29.5.1. Introducción</h3></div></div></div><a id="idp82406352" class="indexterm"></a><a id="idp82406864" class="indexterm"></a><p>Algunas veces resulta útil dividir una red física
        (como por ejemplo un segmento Ethernet) en dos segmentos de red
        separados, sin tener que crear subredes IP y sin utilizar una pasarela
        para comunicar ambos segmentos.  El dispositivo que realiza esta
        función se denomina <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span>.  Un sistema FreeBSD
	con dos interfaces de red puede actuar como un <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span>
        o puente entre ambas.</p><p>El <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span> funciona de tal forma que aprende las
        direcciones de la capa MAC (direcciones Ethernet) de los nodos que se
        encuentran conectados a cada interfaz de red de tal forma que
	sólo se reenvía tráfico entre los segmentos de
        red cuando las direcciones fuente y destino se encuentran separadas en
        segmentos distintos.</p><p>En varios aspectos se puede comparar un <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span> con
        un <span class="quote">&#8220;<span class="quote">switch</span>&#8221;</span> de pocos puertos.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82414800"></a>29.5.2. Situaciones donde el puenteado resulta adecuado</h3></div></div></div><p>Existen al menos dos situaciones típicas donde se puede
        utilizar la funcionalidad proporcionada por los <span class="quote">&#8220;<span class="quote">
        bridges</span>&#8221;</span>.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82416208"></a>29.5.2.1. Tráfico de gran volumen en un segmentos de red</h4></div></div></div><p>La primera situación surge cuando nos encontramos con un
          segmento de red congestionado pero por las razones que sean no
          queremos subdividir la red e interconectar las nuevas subredes
          mediante un <span class="quote">&#8220;<span class="quote">route</span>&#8221;</span>.</p><p>Vamos a considerar un ejemplo de un periódico donde los
          departamentos editoriales y de producción utilizan la misma
          subred.  Los usuarios de la editorial utilizan el servidor
          <code class="systemitem">A</code> como servidor de ficheros y los de
          producción utilizan el servidor <code class="systemitem">B</code>.  Se
          Se utiliza una red Ethernet para conectar ambos departamentos y se
          ha detectado que la alta utilización del enlace está
          ralentizando el funcionamiento de la red.</p><p>Si los usuarios de la editorial pudieran agregarse en un
          segmento de red mientras que los usuarios de producción se
          localizaran en otro se podrían conectar ambos segmentos
	  mediante un <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span>.  Sólo se utilizará
          el <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span> para encaminar tráfico de red
          destinado a interfaces que se encuentren en el <span class="emphasis"><em>
	  otro</em></span> lado del <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span>, reduciendo de esta
	  forma la congestión en cada nuevo segmento.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82425040"></a>29.5.2.2. Cortafuegos de filtrado/conformación de tráfico
          </h4></div></div></div><a id="idp82425808" class="indexterm"></a><a id="idp82426320" class="indexterm"></a><p>La segunda situación típica se produce cuando se
          necesita un cortafuegos pero no la Traducción de Direcciones
	  de Red (NAT).</p><p>A continuación se muestra un ejemplo. Una
          pequeña compañía se comunica con su ISP
          utilizando DSL o ISDN. Dicha compañía posee 13
          13 direcciones IP globalmente accesibles delegadas por su ISP y tiene
          10 ordenadores en funcionamiento.  En esta situación un
          un cortafuegos basado en un <span class="quote">&#8220;<span class="quote">router</span>&#8221;</span> resulta
	  difícil debido a la distribución del espacio de
          direccionamiento disponible (subnetting).</p><a id="idp82427984" class="indexterm"></a><a id="idp82428496" class="indexterm"></a><a id="idp82429008" class="indexterm"></a><p>Un cortafuegos implementado sobre un <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span> se
	  puede utilizar en el camino de bajado desde el ISP hasta las
	  oficinas de la compañía sin necesidad de tener en
	  cuenta ningún aspecto relacionado con la
          distribución de las direcciones IP.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82430544"></a>29.5.3. Configuración de un <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span></h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82431440"></a>29.5.3.1. Selección de la interfaz de red</h4></div></div></div><p>Un <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span> necesita al menos dos tarjetas de red
	  situadas en dos segmentos de red para su funcionamiento.  Por
          desgracia no todas las interfaces de red pueden usarse para el
	  puenteo.  Consulte <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bridge&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bridge</span>(4)</span></a>, ahín encontrará
	  más información sobre qué tarjetas puede
	  usar.</p><p>Por favor, instale y pruebe las dos tarjetas de red antes de
          continuar.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82434256"></a>29.5.3.2. Cambios en la configuración del núcleo</h4></div></div></div><a id="idp82434896" class="indexterm"></a><p>Para activar el soporte de <span class="quote">&#8220;<span class="quote">bridging</span>&#8221;</span> en el
	  núcleo añada</p><pre class="programlisting">options BRIDGE</pre><p>al fichero de configuración del núcleo y
          recompile el kernel.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82437712"></a>29.5.3.3. Soporte de cortafuegos</h4></div></div></div><a id="idp82438352" class="indexterm"></a><p>Si se desea utilizar el <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span> como un
	  cortafuegos, se debe añadir además la opción
          <code class="literal">IPFIREWALL</code>.  Lea el capílo de
	  firewalls  para obtener
	  información general sobre cómo configurar el
	  bridge para que actúe además como cortafuegos.</p><p>Si además queremos que los paquetes que no sean IP (por
          ejemplo paquetes ARP) puedan atravesar el <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span>
          deberemos añadir la opción
          <code class="literal">IPFIREWALL_DEFAULT_TO_ACCEPT</code>.  Tenga en cuenta
          opción modifica el comportamiento del cortafuegos de tal
          forma que por defecto aceptará cualquier paquete.  Hay que
	  tener cuidado para asegurarse de que el comportamiento esperado del
          cortafuegos, que reside en el conjunto de reglas que se hayan
          definido, no se vea afectado por este cambio.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82445776"></a>29.5.3.4. Soporte de conformado de tráfico</h4></div></div></div><p>Si se quiere utilizar el <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span> como un
	  conformador de tráfico, es decir, como un elemento capaz de
          adaptar los distintos flujos según determinados patrones, se
          debe añadir la opción
          <code class="literal">DUMMYNET</code> a la configuración del
          núcleo.  Se ruega consultar <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dummynet&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">dummynet</span>(4)</span></a> para obtener
          más información al respecto.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82448592"></a>29.5.4. Cómo activar el <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span></h3></div></div></div><p>Añadir la línea:</p><pre class="programlisting">net.link.ether.bridge=1</pre><p>en <code class="filename">/etc/sysctl.conf</code> para habilitar el
        soporte de <span class="quote">&#8220;<span class="quote">bridging</span>&#8221;</span> en tiempo de ejecución y la
        línea:</p><pre class="programlisting">net.link.ether.bridge_cfg=<em class="replaceable"><code>if1</code></em>,<em class="replaceable"><code>if2</code></em></pre><p>Para activar el <span class="quote">&#8220;<span class="quote">bridging</span>&#8221;</span> en las interfaces
        especificadas (sustituya
	<em class="replaceable"><code>if1</code></em> y
	<em class="replaceable"><code>if2</code></em> con los nombres de sus interfaces de
        red).  Si deseamos filtrar los paquetes puenteados utilizando
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ipfw</span>(8)</span></a>, debemos añadir también:</p><pre class="programlisting">net.link.ether.bridge_ipfw=1</pre><p>En FreeBSD 5.2-RELEASE y posteriores, se debe utilizar las
        siguientes líneas en lugar de las anteriores:</p><pre class="programlisting">net.link.ether.bridge.enable=1
net.link.ether.bridge.config=<em class="replaceable"><code>if1</code></em>,<em class="replaceable"><code>if2</code></em>
net.link.ether.bridge.ipfw=1</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82457040"></a>29.5.5. Información adicional</h3></div></div></div><p>Si queremos ser capaces de conectarnos al <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span>
        mediante <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=telnet&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">telnet</span>(1)</span></a> se puede asignar una dirección IP a
        una de las tarjetas de red del <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span>.  Por amplio
	consenso se considera una mala idea asignar más de una
        dirección IP al <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span>.</p><p>Si poseemos varios <span class="quote">&#8220;<span class="quote">bridges</span>&#8221;</span> en nuestra red
        sólamente puede existir un único camino entre
        cualesquiera dos máquinas de nuestra red.
	Técnicamente hablando esto significa que no existe soporte para
        gestión de enlace mediante mecanismos basados en
        árboles de recubrimiento mínimos (<span class="quote">&#8220;<span class="quote">spanning
        tree</span>&#8221;</span>).</p><p>Un <span class="quote">&#8220;<span class="quote">bridge</span>&#8221;</span> puede añadir latencia a los tiempos
        de respuesta de la orden <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ping&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ping</span>(8)</span></a>, especialmente cuando
        el tráfico tiene que viajar de un segmento de red al
        otro.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-bluetooth.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="advanced-networking.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="network-nfs.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">29.4. Bluetooth </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 29.6. NFS</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>