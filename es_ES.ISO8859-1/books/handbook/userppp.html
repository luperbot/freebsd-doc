<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>25.2. Uso de User PPP</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manual de FreeBSD" /><link rel="up" href="ppp-and-slip.html" title="Capítulo 25. PPP y SLIP" /><link rel="prev" href="ppp-and-slip.html" title="Capítulo 25. PPP y SLIP" /><link rel="next" href="ppp.html" title="25.3. Uso de Kernel PPP" /><link rel="copyright" href="legalnotice.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">25.2. Uso de User PPP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ppp-and-slip.html">Anterior</a> </td><th width="60%" align="center">Capítulo 25. PPP y SLIP</th><td width="20%" align="right"> <a accesskey="n" href="ppp.html">Siguiente</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="userppp"></a>25.2. Uso de User PPP</h2></div><div><span class="authorgroup">Originalmente contribuido por <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Brian</span> <span class="surname">Somers</span></span>. </span></div><div><span class="authorgroup">Con apoyo de <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Nik</span> <span class="surname">Clayton</span></span>, <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Dirk</span> <span class="surname">Frömberg</span></span>, <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Peter</span> <span class="surname">Childs</span></span> y <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80131920"></a>25.2.1. User PPP</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80132560"></a>25.2.1.1. Aclaraciones</h4></div></div></div><p>Este documento asume que usted cuenta con lo siguiente:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a id="ppp-isp" class="indexterm"></a><a id="ppp-ppp2" class="indexterm"></a><p>Una cuenta activa con un Proveedor del Servicio de Internet
          (ISP&#8212;por sus siglas en inglées), que usted
          utliza para conectarse.</p></li><li class="listitem"><p>Adicionalmente, un módem o algún otro
          dispositivo, conectado a su sistema, y configurado
          correctamente, que le permite realizar la conexión
          con su ISP.</p></li><li class="listitem"><p>El número telefónico de su proveedor.</p></li><li class="listitem"><a id="ppp-pap" class="indexterm"></a><a id="ppp-chap" class="indexterm"></a><a id="ppp-unix" class="indexterm"></a><a id="ppp-login" class="indexterm"></a><a id="ppp-password" class="indexterm"></a><p>Su nombre de usuario y contraseña. (Ya sea un nombre
          de usuario y/o contraseña estilo UNIX, o bien para uso
          por medio de PAP o CHAP)</p></li><li class="listitem"><a id="ppp-nameserver" class="indexterm"></a><p>La dirección IP de uno o más servidores
          de nombres (DNS). Normalmente, estos serán provistos
          por su proveedor de Internet. Si su proveedor no le ha
          dado esta información, puede utilizar la opción
          <code class="command">enable dns</code> en su fichero
          <code class="filename">ppp.conf</code>, para indicarle a
          <span class="application">ppp</span> que configure el DNS por
          usted. Esta característica depende del sistema de
          negociación de DNS que mantenga su proveedor de
          Internet.</p></li></ul></div><p>La siguiente información puede ser que haya sido
      provista por su proveedor de servicios de internet, pero
      no es completamente necesaria:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>La dirección IP del gateway (pasarela de salida)
          de su PSI. El gateway es la máquina a la cual usted
          se conectará y será la
          <span class="emphasis"><em>ruta por default</em></span>. Si usted no cuenta
          con esta información, puede inventar uno y al intentar
          conectarse, el servidor de su PSI, este nos indicará
          cual es el valor correcto.</p><p>Esta dirección IP, es referida por
          <span class="application">ppp</span> como
	      <code class="literal">HISADDR</code>.</p></li><li class="listitem"><p>La mascara de red (netmask) que debe utilizar. Si su PSI no
          le ha provisto de una, puede utilizar sin problema <code class="systemitem">255.255.255.255</code>.</p></li><li class="listitem"><a id="ppp-statis-ip" class="indexterm"></a><p>Si su PSI, le ha provisto de una dirección de IP
          estática y un nombre de host, puede capturarla. De otra
          forma podemos dejar que el servidor asigne cualquier IP que
          corresponda.</p></li></ul></div><p>Si usted no cuenta con alguna de la información que hemos
      comentado, le recomendamos contactar con su PSI para requerirla.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">En el transcurso de la presente sección, algunos
        ejemplos muestran el contenido de archivos de configuración
        los cuales presentan una numeración. Estos números
        sirven como ayuda y referencia a cada línea, pero estos no
        deben de estar presentes en el archivo original. Una sangría
        adecuada, así como espacios adecuados, también son
        de suma importancia.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80157904"></a>25.2.1.2. Preparando el Kernel</h4></div></div></div><p>Como se comento anteriormente, la aplicación
          <span class="application">ppp</span> utiliza el dispositivo
          <code class="filename">tun</code>. Si este dispositivo no ha sido
          compilado dentro del kernel, <span class="application">ppp</span>
          lo cargará como módulo cuando sea requerido. El
          dispositivo tun es dinámico, de tal forma que se
          generara de acuerdo a la demanda que tenga (usted no esta
          limitado por el kernel).</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Vale la pena hacer notar que el controlador tun, crea los
      dispositivos de acuerdo a sus necesidades, por lo que el comando
      <code class="command">ifconfig -a</code>, no necesariamente mostrará
      los dispositivos <code class="filename">tun</code>.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80161744"></a>25.2.1.3. Verificando el dispositivo <code class="filename">tun</code></h4></div></div></div><p>Bajo circunstancias normales, la mayoría de los usuarios
      sólo utilizaran un dispositivo <code class="filename">tun</code>
	  (<code class="filename">/dev/tun0</code>).  En lo sucesivo podemos hacer
      referencia a <code class="filename">tun0</code> con la expresión
	  <code class="filename">tunN</code> donde  <code class="literal">N</code>
	  es el número que corresponde en su sistema.</p><p>Para instalaciones de FreeBSD que no tienen el habilitado el DEVFS
      la existencia de <code class="filename">tun0</code> debe ser verificada
      (esto no es necesario si se cuenta habilitada la opción DEVFS
      ya que los nodos de dispositivos seán creados en función
      a las necesidades).</p><p>La forma más sencilla de verificar si el dispositivo
      <code class="filename">tun0</code> se encuentra configurado
      correctamente, es la de rehacer el dispositivo. Para hacer esto
      simplemente siga los siguientes pasos:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /dev</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sh MAKEDEV tun0</code></strong></pre><p>Si usted necesita 16 dispositivos tun en su kernel, deberá
      crearlos. Esto puede hacerse de la siguiente manera:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /dev</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sh MAKEDEV tun15</code></strong></pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80178768"></a>25.2.1.4. Configuración de la Resolución de Nombres</h4></div></div></div><a id="ppp-resolver" class="indexterm"></a><a id="ppp-hostname" class="indexterm"></a><a id="ppp-hosts" class="indexterm"></a><p>La resolución es la parte del sistema que busca una
	  dirección IP en los nombres de servidores (host) y
	  viceversa. Puede ser configurado para que busque en "mapas" que
	  describen la IP del servidor en uno de dos lugares, el primero
	  es un archivo llamado <code class="filename">/etc/hosts</code>.
	  Lea <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hosts&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">hosts</span>(5)</span></a> para más información al
	  respecto. El segundo es el Servicio de Nombres de Dominio de
	  Internet (DNS-Internet Domain Name Service), el cual es una
	  base de datos de distribución. Para mayor información
	  con respecto a los DNS, referirse a dns.</p><p>La resolución de nombres es un sistema que por medio de
	  llamadas, realiza el mapeo de nombres, pero es necesario inidicarle donde
	  debe buscar la información. Para versiones de FreeBSD anteriores
	  a la 5.0, esto es hecho al editar el archivo <code class="filename">/etc/host.conf</code>.
	  La versión 5.0 de FreeBSD utiliza el archivo <code class="filename">/etc/nsswitch.conf</code>.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80222032"></a>25.2.1.4.1. Edición del archivo <code class="filename">/etc/host.conf</code></h5></div></div></div><p>Para versiones de FreeBSD anteriores a la 5.0, este archivo
	    debe contener las siguientes dos líneas (en este orden):</p><pre class="programlisting">hosts
bind</pre><p>Esto le indica a la resolución que busque en primer
	    término en el archivo <code class="filename">/etc/hosts</code>, y
	    posteriormente en el DNS, si el nombre no fué localizado</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80224592"></a>25.2.1.4.2. Editando el archivo <code class="filename">/etc/nsswitch.conf</code></h5></div></div></div><p>Para versiones de FreeBSD 5.0 y posteriores, este archivo debe
	    contener, al menos, la siguiente línea:</p><pre class="programlisting">hosts: files, dns</pre><p>Esto le indica a la resolución de nombres, que
	    busque en primer lugar en el archivo <code class="filename">/etc/hosts</code>,
	    y en caso de que el nombre no haya sido localizado, busque en
	    el DNS.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80227152"></a>25.2.1.4.3. Editando el archivo <code class="filename">/etc/hosts</code></h5></div></div></div><p>Este archivo puede contener direcciones IP, así como
	    el nombre de las máquinas de su red local. Como mínimo
	    debe contar con la información de la máquina que
	    correrá ppp. Asumiendo que su ordenador se llama
	    <code class="systemitem">foo.bar.com</code> con la dirección
	    IP <code class="systemitem">10.0.0.1</code>, el archivo
	    <code class="filename">/etc/hosts</code> debiese contener:</p><pre class="programlisting">127.0.0.1	localhost.bar.com	localhost
::1	localhost.bar.com	localhost
10.0.0.1	foo.bar.com		foo</pre><p>Las primeras dos líneas definen el alias del
	    <code class="systemitem">localhost</code>, como sinónimo de la maquina
	    actual. Independientemente de su propia dirección IP, la
	    dirección IP en estas líneas siempre debe ser <code class="systemitem">127.0.0.1</code> y <code class="systemitem">::1</code>.
	    La última línea especifica el nombre <code class="systemitem">
	    foo.bar.com</code> (asi como <code class="systemitem">foo</code> para acortarlo), para
	    la dirección <code class="systemitem">10.0.0.1</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">La dirección <code class="systemitem">127.0.0.1</code> y el nombre
		<code class="systemitem">localhost</code> son conocidos como direcciones "loopback"
		las cuales hacen un "loopback" (salto de regreso) a la maquina local.</p></div><p>Si su proveedor de Internet, le asigna una dirección IP
	    fija, asín como un nombre, y usted no lo utiliza como nombre
	    del host, añada esto también al archivo
	    <code class="filename">/etc/hosts</code>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80264912"></a>25.2.1.4.4. Editando el archivo <code class="filename">/etc/resolv.conf</code></h5></div></div></div><p>El archivo <code class="filename">/etc/resolv.conf</code>, le indica a la
	    resolución de nombres, como comportarse. Normalmente deberá
	    de incluir la(s) siguiente(s) línea(s):</p><pre class="programlisting">domain <em class="replaceable"><code>ejemplo.com</code></em>
nameserver <em class="replaceable"><code>x.x.x.x</code></em>
nameserver <em class="replaceable"><code>y.y.y.y</code></em></pre><p>Donde <em class="replaceable"><code>x.x.x.x</code></em> y
	    <em class="replaceable"><code>y.y.y.y</code></em> deben reemplazarse con las direcciones
	    <acronym class="acronym">IP</acronym> de los servidores DNS, de su
	    <acronym class="acronym">ISP</acronym>.  Puede ser que esta información se la
	    hayan entregado al suscribirse o no, pero una rápida llamada a su
	    <acronym class="acronym">ISP</acronym> debe resolver esto.</p><p>Tambié puede configurar su sistema, de tal forma que
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslog&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">syslog</span>(3)</span></a> provee de un login para su conección por
	    <span class="application">PPP</span>.  Sólo añada:</p><pre class="programlisting">
	  !ppp
	  *.*        /var/log/ppp.log</pre><p>al fichero <code class="filename">/etc/syslog.conf</code>.  En la
	    mayoría de los casos esto funciona bien.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80281680"></a>25.2.1.5. Configuración Automática de
          <span class="application">PPP</span></h4></div></div></div><a id="idp80282704" class="indexterm"></a><p>Ambos, <code class="command">ppp</code> así como <code class="command">pppd</code>
	  (la implementación del kernel para PPP), utilizan la
	  configuración de los archivos localizados en el directorio
	  <code class="filename">/etc/ppp</code>.
	  Ejemplos para ppp, pueden encontrarse en:
	  <code class="filename">/usr/share/examples/ppp/</code>.</p><p>Para efecto de configurar correctamente <code class="command">ppp</code>, es
	  necesario editar varios ficheros, dependiendo de sus necesidades. La
	  manera en que edite dichos archivos, depende en la forma que utilice su
	  PSI (Proveedor de Servicios de Internet) para brindarle conexión,
	  ya sea por medio de una dirección IP estática o bien una IP
	  dinámica (ya sea que cada vez que se conecta obtiene una nueva
	  dirección).</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="userppp-staticIP"></a>25.2.1.5.1. PPP y direcciones de IP estáticas (fijas)</h5></div></div></div><a id="idp80286928" class="indexterm"></a><p>Será necesario editar el archivo de configuración;
	  <code class="filename">/etc/ppp/ppp.conf</code>. Y deberá quedar de una
	  manera similar al ejemplo que se describe a continuación.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Las líneas que terminan con <code class="literal">:</code>, deben
	      comenzar en la primer columna del archivo &#8212; el resto de las
	      líneas deberán utilizar sangría como se muestra,
	      utilizando espacios o bien el tabulador.  La mayor parte de la
	      información que requiere ingresar aqui, se mostro en el
	      marcado manual anterior.</p></div><pre class="programlisting">1     default:
2       set log Phase Chat LCP IPCP CCP tun command
3       ident user-ppp VERSION (built COMPILATIONDATE)
4       set device /dev/cuaa0
5       set speed 115200
6       set dial "ABORT BUSY ABORT NO\\sCARRIER TIMEOUT 5 \
7                 \"\" AT OK-AT-OK ATE1Q0 OK \\dATDT\\T TIMEOUT 40 CONNECT"
8       set timeout 180
9       enable dns
10
11    provider:
12      set phone "(123) 456 7890"
13      set authname foo
14      set authkey bar
15      set login "TIMEOUT 10 \"\" \"\" gin:--gin: \\U word: \\P col: ppp"
16      set timeout 300
17      set ifaddr <em class="replaceable"><code>x.x.x.x</code></em> <em class="replaceable"><code>y.y.y.y</code></em> 255.255.255.255 0.0.0.0
18      add default HISADDR</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term">Línea 1:</span></dt><dd><p>Identifica la entrada por omisión a utilizar.
		  Los comandos descritos en esta parte, serán ejecutados de
		  manera automática cuando se ejecute ppp.</p></dd><dt><span class="term">Línea 2:</span></dt><dd><p>Habilita los par´metros de acceso. Cuando la
		  configuración trabaja sin problemas, esta línea
		  deberá quedar de la siguiente forma:

	          </p><pre class="programlisting">set log phase tun</pre><p>

			  para efecto de evitar avisos masivos del sistema (logs).</p></dd><dt><span class="term">Línea 3:</span></dt><dd><p>Esta línea le indica a PPP como identificarse ante el puerto.
		  PPP se identifica, si tiene algun problema para efecto de establecer
		  la conexión, en esta identificación, PPP provee de
		  cierta información que puede resultar util para detectar el
		  probelma.</p></dd><dt><span class="term">Línea 4:</span></dt><dd><p>Le indica a PPP cual es el dispositivo a utilizar para realizar
		  la conexión, o bien al que esta conectado el módem.
		  El dispositivo <code class="filename">COM1</code> es
		  <code class="filename">/dev/cuaa0</code> y
		  <code class="filename">COM2</code> es
		  <code class="filename">/dev/cuaa1</code>.</p></dd><dt><span class="term">Línea 5:</span></dt><dd><p>Establece la velocidad a utilizar en la conexión.
		  Si la velocidad de 115200 no trabaja correctamente (la cual
		  deberia con cualquier módem normal), intente con una
		  velocidad inferior, como puede ser 38400.</p></dd><dt><span class="term">Líneas 6 y 7:</span></dt><dd><a id="idp80301904" class="indexterm"></a><p>La cadena de inicialización. El modo User PPP, utiliza
		  y espera enviar-recibir, la información utilizando una
		  sintaxis similar a la descrita en el programa <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chat&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">chat</span>(8)</span></a>. Favor
		  de consultar la página de ayuda para conocer las opciones
		  de este lenguaje.</p><p>Nota: Este comando continua en la siguiente línea, para
		  facilitar su lectura. Cualquier comando en el archivo
		  <code class="filename">ppp.conf</code> puede utilizar este formato, siempre
		  y cuando el último caracter de la línea sea una
		  diagonal invertida "\".</p></dd><dt><span class="term">Línea 8:</span></dt><dd><p>Establece el tiempo de espera que debe tratar de realizar la
		  conexión. Por omisión se establecen 180 segundos, por
		  lo que esta línea se deja por pura estética.</p></dd><dt><span class="term">Línea 9:</span></dt><dd><p>Esta línea le indica a PPP, que solicite confirmación
		  al puerto, sobre la configuración de la resolución local.
		  Si usted esta corriendo un servidor local de nombres, deberá
		  comentar o eliminar esta línea.</p></dd><dt><span class="term">Línea 10:</span></dt><dd><p>Una línea en blanco, para facilitar la lectura. Las
		  líneas en blanco son ignoradas por PPP.</p></dd><dt><span class="term">Línea 11:</span></dt><dd><p>Identifica el incio de datos para un <span class="quote">&#8220;<span class="quote">proveedor</span>&#8221;</span>
		  determinado, de servicios de internet.  Este podrá ser cambiado
		  por el nombre de su <acronym class="acronym">ISP</acronym>, de tal forma que en lo
		  sucesivo utilice la opción <code class="option">load ISP</code>, para
		  iniciar una sesión.</p></dd><dt><span class="term">Línea 12:</span></dt><dd><p>Indica el numero telefónico del proveedor.
		  Pueden indicarse varios numeros a utilizar, utilizando el signo
		  de dos puntos (<code class="literal">:</code>) o bien la barra
		  (<code class="literal">|</code>) como separador. La diferencia entre
		  estos dos separadores, es detallada en el <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppp&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ppp</span>(8)</span></a>. Pero
		  en resumen, se puede decir que si se desean utilizar varios
		  numeros de manera aleatoria se debe utilizar los dos puntos,
		  pero si se desea siempre utilizar el primer numero y en caso
		  de falla el siguiente y así sucesivamente, se debe utilizar
		  la barra. Es importante que todo lo que se refiere a numeros
		  telefonicos, este entre comillas como se muestra.  Es
		  importante que si piensa usar espacios en los numeros, haga
		  uso de estas comillas (<code class="literal">"</code>).  La falta de
		  estas pueden ocasionar un simple error.</p></dd><dt><span class="term">Líneas 13 y 14:</span></dt><dd><p>Identifica el nombre de usuario y su contraseña. Cuando
		  uno se conecta utilizando un login de tipo Unix, estos valores hacen
		  referencia al comando <code class="command">set login</code>, utilizando las
		  variables \U y \P. Cuando la conexión es utilizando algún
		  metodo como PAP o CHAP, estos valores, son utilizados al momento de la
		  autentificación.</p></dd><dt><span class="term">Línea 15:</span></dt><dd><a id="idp80318800" class="indexterm"></a><a id="idp80319312" class="indexterm"></a><p>Si usted esta utilizando el metodo PAP o CHAP, no habrá
		  un login en este punto, y esta línea deberá ser
		  comentada (utilizando el símbolo <code class="literal">#</code> al
		  principio de la línea) o bien eliminada por completo.
		  Vea la parte
		  <a class="link" href="userppp.html#userppp-PAPnCHAP" title="25.2.1.5.5. Autentificación por medio de PAP y CHAP">Autentificación con PAP y CHAP
		  </a> para más detalles.</p><p>La cadena de acceso (login), utiliza la misma sintáxis que
          se utiliza en la cadena de marcado. En este ejemplo, la cadena sirve
          para un servicio, en el cual el inicio de sesión se ve algo
          así como lo siguiente:</p><pre class="screen">Proveedor de servicios X
login: <em class="replaceable"><code>foo</code></em>
password: <em class="replaceable"><code>bar</code></em>
protocol: ppp</pre><p>Es recomendable editar el script, para que se ajuste a sus propias
		  necesidades. Cuando cree este script por primera vez, asegurese de
		  haber habilitado la parte que se refiere a al acceso por medio de
		  <span class="quote">&#8220;<span class="quote">chat</span>&#8221;</span>, para efecto de poder dar seguimiento al curso de
		  la conexión y la resolución de la misma.</p></dd><dt><span class="term">Línea 16:</span></dt><dd><a id="idp80324688" class="indexterm"></a><p>Establece el tiempo por defecto en el que se perderá la
		  conexión (en segundos). En este caso la conexión
		  será cortada de forma automática, después de
		  300 segundos de inactividad. Si no desea habilitar esta función
		  establezca este valor en cero o bien utilice el comando en línea
		  <code class="option">-ddial</code>.</p></dd><dt><span class="term">Línea 17:</span></dt><dd><a id="idp80327120" class="indexterm"></a><p>Indica la dirección de la interfaz. La cadena que aparece
		  como <em class="replaceable"><code>x.x.x.x.</code></em>, debe se cambiada por la
		  dirección asignada por su PSI. La línea que aparece como
		  <em class="replaceable"><code>y.y.y.y.</code></em>, debe se substituida por la
		  direcció IP especificada por su PSI, como servidor de salida o
		  pasarela (gateway)(la maquina a la cual se va a conectar). Si su PSI
		  no le ha indicado una dirección de este tipo, puede utilizar
		  <code class="systemitem">10.0.0.2/0</code>. Si usted necesita utilizar
		  una dirección <span class="quote">&#8220;<span class="quote">aleatoria</span>&#8221;</span>, asegurese de crear el
		  fichero <code class="filename">/etc/ppp/ppp.linkup</code>, siguiendo las
		  instrucciones de <a class="link" href="userppp.html#userppp-dynamicIP" title="25.2.1.5.2. PPP y direcciones de IP Dinámicas (Variables)">PPP y las
		  direcciones de IP Dinámicas</a>, para su llenado. Si esta
		  línea es omitida, <code class="command">ppp</code>, no podrá
		  ejecutarse en el modo <code class="option">-auto</code>.</p></dd><dt><span class="term">Línea 18:</span></dt><dd><p>Añade una ruta por omisión al servidor de salida
		  de su PSI. La palabra especial <code class="literal">HISADDR</code> se
		  reemplaza con la dirección del gateway indicado por su PSI,
		  que esta en la línea 9, de otra forma <code class="literal">HISADDR</code>
		  no será inicializado.</p><p>Si no desea ejecutar <code class="command">ppp</code> en modo
		  <code class="option">-auto</code>, esta línea deberá pasar al
		  archivo <code class="filename">ppp.linkup</code>.</p></dd></dl></div><p>No hay necesidad de editar el archivo <code class="filename">ppp.linkup</code>
	    si usted cuenta con una dirección IP estática y se esta
	    ejecutando ppp en modo <code class="option">-auto</code>, en virtud de que para
	    efecto de realizar la conexión sus mapas de ruteo debe estar
	    correctas. De cualquier forma puede ser que usted desee ejecutar
	    algun programa/comando, posterior a la conexión. Este es
	    explicado con más detalle posteriormente, cuando se vea el
	    ejemplo de sendmail.</p><p>Ejemplo de los archivos de configuración, se pueden
	    encontrar en el directorio; <code class="filename">/usr/share/examples/ppp</code>.
	    </p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="userppp-dynamicIP"></a>25.2.1.5.2. PPP y direcciones de IP Dinámicas (Variables)</h5></div></div></div><a id="idp80342608" class="indexterm"></a><a id="idp80347984" class="indexterm"></a><p>Si su proveedor de servicios, no le asigna una dirección de IP
	    fija, será necesario configurar a <code class="command">ppp</code>, de tal
	    forma que al momento de realizar la conexión, negocie tanto la
	    dirección local, como la remota. Esto se lleva a cabo al
	    <span class="quote">&#8220;<span class="quote">adivinar</span>&#8221;</span> una dirección IP y permitiendo a
	    <code class="command">ppp</code> que la establezca correctamente, usando el
	    Protocolo de Configuración de IP (IPCP), una vez que se ha
	    conectado. La configuración que debe tener el archivo
	    <code class="filename">ppp.conf</code>, es la misma que la utilizada en
	    <a class="link" href="userppp.html#userppp-staticIP" title="25.2.1.5.1. PPP y direcciones de IP estáticas (fijas)">PPP y direcciones de IP fijas</a>,
	    salvo el siguiente cambio:</p><pre class="programlisting">17      set ifaddr 10.0.0.1/0 10.0.0.2/0 255.255.255.255</pre><p>Una vez más, no debe incluir el numero de línea, este
	    sólo es una referencia. Así mismo deberá existir
	    sangrado, de cuando menos 1 espacio.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Línea 17:</span></dt><dd><p>El numero siguiente a la diagonal (<code class="literal">/</code>), es el
		  numero de bits de la dirección en la cual ppp insistirá
		  en conectarse. Puede ser que usted desee utilizar numeros de IP que
		  sean más apropiados, para ajustar a sus necesiadades, pero el
		  ejemplo descrito anteriormente siempre podrá utilizarse.</p><p>El último argumento (<code class="literal">0.0.0.0</code>), le
		  indica a PPP, que inicie las negociaciones, utilizando como
		  dirección <code class="systemitem">0.0.0.0</code>, en lugar de
		  que utilice <code class="systemitem">10.0.0.1</code>, lo cual es
		  necesario con algunos proveedores. No utilice la dirección
		  <code class="literal">0.0.0.0</code> como el primer argumento, para el comando
		  <code class="command">set ifaddr</code>, ya que impide que PPP configure de
		  forma correcta el sistema, cuando se utiliza en modo
		  <code class="option">-auto</code>.</p></dd></dl></div><p>Si usted no esta ejecutando PPP en modo <code class="option">-auto</code>,
	    deberá editar su archivo <code class="filename">/etc/ppp/ppp.linkup</code>.
	    El archivo <code class="filename">ppp.linkup</code>, es utilizado una vez que se
	    ha realizado la conexión. En este punto, <code class="command">ppp</code>
	    habrá negociado una dirección de interfaz, y será
	    posible ahora, añadir las entradas para la las tablas de ruteo:
	    </p><pre class="programlisting">1     provider:
2      add default HISADDR</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term">Línea 1:</span></dt><dd><p>Al establecer (<code class="command">ppp</code>) una conexión,
		  buscará en <code class="filename">ppp.linkup</code> una entrada, de
		  acuerdo a las siguientes reglas. Primero, tratar de encontrar una
		  entrada que sea igual a la utilizada en el archivo
		  <code class="filename">ppp.conf</code>. Si esto falla, buscar una IP con la
		  dirección de nuestro gateway. Esta entrada es una etiqueta
		  de tipo IP, de cuatro-octetos. Si aun después de esto no se
		  ha detectado la entrada correcta, buscar la entrada
		  <code class="literal">MYADDR</code>.</p></dd><dt><span class="term">Línea 2:</span></dt><dd><p>Esta línea le indica a <code class="command">ppp</code> que
		  añada una ruta por omisión, que este dirigida hacia
		  <code class="literal">HISADDR</code>.
		  <code class="literal">HISADDR</code> será reemplazada, con la IP del
		  gateway, como se negocio por IPCP.</p></dd></dl></div><p>Para ver un detalle más preciso de esto, puede consultar
	    la entrada de <code class="literal">pmdemand</code> en los archivos de ejemplo
	    <code class="filename">/usr/share/examples/ppp/ppp.conf.sample</code> así
	    como <code class="filename">/usr/share/examples/ppp/ppp.linkup.sample</code>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80367568"></a>25.2.1.5.3. Recibiendo Llamadas Externas</h5></div></div></div><a id="idp80368208" class="indexterm"></a><p>Cuando se configure <span class="application">ppp</span>, para recibir
	    llamadas externas, en una maquina conectada a un LAN (Red de Area Local),
	    debe decidir si se va a permitir el envío de paquetes a la LAN. Si
	    es así, debe asignar un numero de IP de su red local y utilizar el
	    comando <code class="command">enable proxy</code> en el archivo de configuracion
	    <code class="filename">/etc/ppp/ppp.conf</code>. También deberá
	    asegurarse que en su archivo <code class="filename">/etc/rc.conf</code> cuente
	    con la línea:</p><pre class="programlisting">gateway_enable="YES"</pre><div class="sect5"><div xmlns="" class="titlepage"><div><div><h6 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80371280"></a>25.2.1.5.3.1. ?Qué getty utilizar?</h6></div></div></div><p>El enlace
	      Configurando FreeBSD para Servicios de Marcado provee de una buena
              descripció, sobre la configuración de estos servicios,
              basado en <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=getty&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">getty</span>(8)</span></a>.</p><p>Una alternativa para el comando <code class="command">getty</code>
	      es <a class="link" href="http://www.leo.org/~doering/mgetty/index.html" target="_top">mgetty
	      </a>, el cual es una versión más inteligente de getty
	      diseñada para servicios de marcado telefonico.</p><p>Una de las principales ventajas de <code class="command">mgetty</code> es
	      que, de hecho <span class="emphasis"><em>platica</em></span> con los modems, esto es,
	      significativo, ya que si el puerto esta desactivado en su
	      <code class="filename">/etc/ttys</code> el modem no responderá el
	      llamado.</p><p>Las últimas versiones de <code class="command">mgetty</code>
	      (de la 0.99beta y sucesivas), también cuentan con soporte
	      para la detección automática de llamados de PPP,
	      permitiendo el acceso a servidores de una manera más sencilla
	      (sin uso de tanto scripts).</p><p>Puede referirse a <a class="link" href="userppp.html#userppp-mgetty" title="25.2.1.5.4.1. mgetty y AutoPPP">Mgetty y
	      AutoPPP</a> para más información con respecto
	      al comando <code class="command">mgetty</code>.</p></div><div class="sect5"><div xmlns="" class="titlepage"><div><div><h6 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80390480"></a>25.2.1.5.3.2. Permisos de <span class="application">PPP</span></h6></div></div></div><p>El comando <code class="command">ppp</code> normalmente debe ser ejecutado
	      por root (superusuario). Si de cualquier forma, usted desea permitir
	      que <code class="command">ppp</code> pueda ser ejecutado en modo servidor, por
	      un usuario regular, como se describe a continuación,
	      deberá otorgar los permisos necesarios a ese usuario al
	      añadirlo al grupo <code class="systemitem">network</code>, en el fichero
	      <code class="filename">/etc/groups</code>.</p><p>También será necesario darle acceso a una o
	      más partes del archivo de configuración, haciendo
	      uso del comando <code class="command">allow</code>, como se ve
	      a continuación:</p><pre class="programlisting">allow users fred mary</pre><p>Si el comando es utilizado en la sección
	      <code class="literal">default</code>, esto le dará a el(los)
	      usuario(s) especificado(s),  acceso a todo.</p></div><div class="sect5"><div xmlns="" class="titlepage"><div><div><h6 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80399824"></a>25.2.1.5.3.3. Shells  de PPP para Usuarios de IP Dinámica</h6></div></div></div><a id="idp80400464" class="indexterm"></a><p>Cree un fichero llamado:
	      <code class="filename">/etc/ppp/ppp-shell</code> y que contenga
	      lo siguiente:</p><pre class="programlisting">#!/bin/sh
IDENT=`echo $0 | sed -e 's/^.*-\(.*\)$/\1/'`
CALLEDAS="$IDENT"
TTY=`tty`

if [ x$IDENT = xdialup ]; then
        IDENT=`basename $TTY`
fi

echo "PPP for $CALLEDAS on $TTY"
echo "Starting PPP for $IDENT"

exec /usr/sbin/ppp -direct $IDENT</pre><p>Este script deberá ser ejecutable. Ahora cree un
	      enláce simbólico llamado <code class="filename">ppp-dialup</code>
	      a este script, utilizando los siguientes comandos:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ln -s ppp-shell /etc/ppp/ppp-dialup</code></strong></pre><p>Deberá utilizar este script como
	      <span class="emphasis"><em>shell</em></span> para todos los usuarios que realicen
	      conexión.
		  Este es un ejemplo del fichero <code class="filename">/etc/password</code>
		  para un usuario con acceso a PPP, con nombre de usuario
		  <code class="systemitem">pchilds</code> (recuerde no editar directamente el
		  fichero password, utilice <code class="command">vipw</code>).</p><pre class="programlisting">pchilds:*:1011:300:Peter Childs PPP:/home/ppp:/etc/ppp/ppp-dialup</pre><p>Cree un directorio llamado <code class="filename">/home/ppp</code> que
	      contenga los siguentes archivos de 0 bytes:</p><pre class="screen">-r--r--r--   1 root     wheel           0 May 27 02:23 .hushlogin
-r--r--r--   1 root     wheel           0 May 27 02:22 .rhosts</pre><p>los cuales impiden que <code class="filename">/etc/motd</code> sea
	      desplegado.</p></div><div class="sect5"><div xmlns="" class="titlepage"><div><div><h6 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80412496"></a>25.2.1.5.3.4. Shells de PPP para Usuarios de IP Estática</h6></div></div></div><a id="idp80413136" class="indexterm"></a><p>Cree el fichero <code class="filename">ppp-shell</code> al igual
	      que el mencionado con anterioridad, y por cada cuenta donde
	      se tenga asignada una IP estática, cree un enlace
	      simbólico al fichero <code class="filename">ppp-shell</code>.</p><p>Por ejemplo, si usted cuenta con tres usuarios que utilicen
	      este servicio; <code class="systemitem">fred</code>, <code class="systemitem">sam</code>
	      y <code class="systemitem">mary</code>, los cuales redirecciona a una red de
	      clase C, habria que hacer lo siguiente:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-fred</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-sam</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-mary</code></strong></pre><p>Cada uno de los usuarios señalados, deberán
	      de contar con el enlace a su shell-script como se indicó
	      (por ejemplo, el usuario <code class="systemitem">mary</code>, debe contar
	      con su enlace al fichero <code class="filename">/etc/ppp/ppp-mary</code>).</p></div><div class="sect5"><div xmlns="" class="titlepage"><div><div><h6 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80420688"></a>25.2.1.5.3.5. Configurando <code class="filename">ppp.conf</code> para Usuarios
	      de IP-Dinámica</h6></div></div></div><p>El archivo <code class="filename">/etc/ppp/ppp.conf</code> deberá
	      contener algo similar a lo siguiente:</p><pre class="programlisting">default:
  set debug phase lcp chat
  set timeout 0

ttyd0:
  set ifaddr 203.14.100.1 203.14.100.20 255.255.255.255
  enable proxy

ttyd1:
  set ifaddr 203.14.100.1 203.14.100.21 255.255.255.255
  enable proxy</pre><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Tomar en cuenta el sangrado, ya que es importante.</p></div><p>La sección <code class="literal">default:</code> es cargada
	      para cada sesión. Para cada línea que exista y
	      habilite el marcado, en el fichero <code class="filename">/etc/ttys</code>,
	      se deberá crear una entrada similar a la línea
	      <code class="literal">ttyd0:</code> mencionada arriba. Cada línea
	      debera contar con su propia dirección IP, de sus direcciones
	      IP disponibles para asignar dinámicamente.</p></div><div class="sect5"><div xmlns="" class="titlepage"><div><div><h6 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80425296"></a>25.2.1.5.3.6. Configurando <code class="filename">ppp.conf</code> para Usuarios
	      de IP Estática</h6></div></div></div><p>Junto con el contenido del fichero de ejemplo
	      <code class="filename">/usr/share/examples/ppp/ppp.conf</code> mencionado
	      anteriormente, deberá agregar una sección para cada
	      usuario asignado estáticamente.
	      Continuaremos con nuestro ejemplo con los usuarios
	      <code class="systemitem">fred</code>, <code class="systemitem">sam</code> y
	      <code class="systemitem">mary</code>.</p><pre class="programlisting">fred:
  set ifaddr 203.14.100.1 203.14.101.1 255.255.255.255

sam:
  set ifaddr 203.14.100.1 203.14.102.1 255.255.255.255

mary:
  set ifaddr 203.14.100.1 203.14.103.1 255.255.255.255</pre><p>El archivo <code class="filename">/etc/ppp/ppp.linkup</code>
	      deberá de contener también información
	      del ruteo, para cada IP estática, si es necesario. Las
	      líneas a continuación añadirán una
	      ruta a la dirección <code class="systemitem">203.14.101.0</code>
	      de clase C, por medio del ppp link del cliente.</p><pre class="programlisting">fred:
  add 203.14.101.0 netmask 255.255.255.0 HISADDR

sam:
  add 203.14.102.0 netmask 255.255.255.0 HISADDR

mary:
  add 203.14.103.0 netmask 255.255.255.0 HISADDR</pre></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80443344"></a>25.2.1.5.4. Algo más de <code class="command">mgetty</code>, AutoPPP, y
	    Extensiones MS</h5></div></div></div><div class="sect5"><div xmlns="" class="titlepage"><div><div><h6 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="userppp-mgetty"></a>25.2.1.5.4.1. <code class="command">mgetty</code> y AutoPPP</h6></div></div></div><a id="idp80445392" class="indexterm"></a><a id="idp80446416" class="indexterm"></a><a id="idp80446928" class="indexterm"></a><p>Configurando y compilando <code class="command">mgetty</code> con
	      la opción <code class="literal">AUTO_PPP</code> habilitada, permite
	      a <code class="command">mgetty</code> detectar la fase LCP de conexiones PPP
	      y automáticamente enviarlo a un shel de ppp. Aun con esto,
	      y debido a que no se ingresa el nombre de usuario y contraseña,
	      es necesario autntificarse por medio de PAP o CHAP.</p><p>Esta sección asume que el usuaio ha configurado,
	      compilado e instalado correctamente una versión de
	      <code class="command">mgetty</code>, con la opción
	      <code class="literal">Auto_PPP</code> (v0.99beta o posterior).</p><p>Asegurese de que su fichero
	      <code class="filename">/usr/local/etc/mgetty+sendfax/login.conf</code>
	      contiene la siguiente línea en él:</p><pre class="programlisting">/AutoPPP/ -     -		      /etc/ppp/ppp-pap-dialup</pre><p>Esto le indicará a <code class="command">mgetty</code> que ejecute
	      el script <code class="filename">ppp-pap-dialup</code>, para efecto de detectar
	      conexiones de tipo PPP.</p><p>Cree un fichero llamado
	      <code class="filename">/etc/ppp/ppp-pap-dialup</code> que contenga
	      las siguientes líneas (el fichero deberá
	      ser ejecutable):</p><pre class="programlisting">#!/bin/sh
exec /usr/sbin/ppp -direct pap$IDENT</pre><p>Para cada línea de marcado habilitada en
	      <code class="filename">/etc/ttys</code>, cree la entrada
	      correspondiente en <code class="filename">/etc/ppp/ppp.conf</code>.
	      Esto co-existirá pacíficamente con las
	      definiciaones que se hayan hecho, de acuerdo a lo mostrado
	      en la parte de arriba.</p><pre class="programlisting">pap:
  enable pap
  set ifaddr 203.14.100.1 203.14.100.20-203.14.100.40
  enable proxy</pre><p>Cada usuario que ingrese al sistema utilizando este
	      metodo, deberá de contar con su clave de usuario,
	      así como su contraseña, en el archivo
	      <code class="filename">/etc/ppp/ppp.secret</code>, o bien agrege
	      la siguiente opción, para efecto de que se pueda realizar
	      la autentificación por medio de PAP, directamente
	      del fichero <code class="filename">/etc/password</code>.</p><pre class="programlisting">enable passwdauth</pre><p>Si desea asignar una dirección IP fija a
	      algunos usuarios, puede especificar el número como
	      un tercer argumento en el fichero
	      <code class="filename">/etc/ppp/ppp.secrets</code>. Vea el archivo
	      <code class="filename">/usr/share/examples/ppp/ppp.secret.sample</code>
	      para obtener ejemplos más detallados de esto.</p></div><div class="sect5"><div xmlns="" class="titlepage"><div><div><h6 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80462160"></a>25.2.1.5.4.2. Extensiones de MS</h6></div></div></div><a id="idp80462800" class="indexterm"></a><a id="idp80463312" class="indexterm"></a><a id="idp80463824" class="indexterm"></a><p>Es posible configurar PPP, para efecto de que
	      brinde a DNS y a NetBIOS, direcciones de servidores
	      de nombres de forma automática.</p><p>Para efecto de habilitar estas extensiones con PPP
	      versión 1.x, las siguientes líneas
	      deberán añadirse a la sección relevante
	      de <code class="filename">/etc/ppp/ppp.conf</code>.</p><pre class="programlisting">enable msext
set ns 203.14.100.1 203.14.100.2
set nbns 203.14.100.5</pre><p>Y para versiones de PPP 2 y posteriores:</p><pre class="programlisting">accept dns
set dns 203.14.100.1 203.14.100.2
set nbns 203.14.100.5</pre><p>Esto le indicará a los clientes, las direcciones
	      del servidor primario y secundario y el servidor-host para
	      NetBIOS.</p><p>Si la línea <code class="literal">set dns</code>, es omitida
	      en versiones 2 y posteriores, PPP utilizará los valores
	      que encuentre en <code class="filename">/etc/resolv.conf</code>.</p></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="userppp-PAPnCHAP"></a>25.2.1.5.5. Autentificación por medio de PAP y CHAP</h5></div></div></div><a id="idp80473680" class="indexterm"></a><a id="idp80474192" class="indexterm"></a><p>Algunos proveedores de internet tienen su sistema
	    configurado para que cada usuario al conecatrse sean
	    autentificados por medio de PAP o CHAP. Si este es el caso,
	    al momento de realizar la conexion, no aparecerá
	    un <code class="prompt">login:</code>, sino que comenzará a
	    comunicarse PPP inmediatamente.</p><p>El metodo PAP es menos seguro que CHAP, pero la seguridad
	    normalmente no se toma mucho en cuenta en este tipo de
	    conexiones, en funcion de que al enviarse la información
	    de contraseña en texto plano, por medio de una
	    línea serial, no deja mucho espacio para que los
	    crackers <span class="quote">&#8220;<span class="quote">husmeen</span>&#8221;</span>.</p><p>Haciendo referencia a lo que vimos de
	    <a class="link" href="userppp.html#userppp-staticIP" title="25.2.1.5.1. PPP y direcciones de IP estáticas (fijas)">PPP y Direcciones de IP
	    Fijas</a> o bien <a class="link" href="userppp.html#userppp-dynamicIP" title="25.2.1.5.2. PPP y direcciones de IP Dinámicas (Variables)">PPP y Direcciones
	    de IP Dinámicas</a>, habría que aplicar los
	    siguientes cambios:</p><pre class="programlisting">7       set login
&#8230;
12      set authname <em class="replaceable"><code>MiNombreDeUsuario</code></em>
13      set authkey <em class="replaceable"><code>MiContraseña</code></em></pre><div class="variablelist"><dl class="variablelist"><dt><span class="term">Línea 7:</span></dt><dd><p>Su PSI normalmente requerirá que usted ingrese
		  al sistema, cuando se utiliza PAP o CHAP. Por esta
		  razón debemos deshabilitar la línea que
		  corresponde a <span class="quote">&#8220;<span class="quote">set login</span>&#8221;</span>.</p></dd><dt><span class="term">Línea 12:</span></dt><dd><p>Esta línea especifíca a PAP/CHAP su nombre
		  de usuario. Usted deberá cambiar el valor a quedar el
		  nombre correcto en el campo;
		  <em class="replaceable"><code>MiNombreDeUsuario</code></em>.</p></dd><dt><span class="term">Línea 13:</span></dt><dd><a id="idp80483920" class="indexterm"></a><p>Esta línea especifíca su contraseña
		  de PAP/CHAP. Es necesario que usted cambie el valor a quedar
		  el dato correcto, en el campo;
		  <em class="replaceable"><code>MiContraseña</code></em>. Quizás
		  sea recomendable que añada una línea a quedar:</p><pre class="programlisting">15      accept PAP</pre><p>o</p><pre class="programlisting">15      accept CHAP</pre><p>la intención de esto es para hacerlo obvio,
		  aunque en realidad PAP y CHAP son aceptadas por
		  omisión.</p></dd></dl></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80487504"></a>25.2.1.5.6. Cambiando la configuración de <code class="command">ppp</code>
	    sobre la marcha (al vuelo)</h5></div></div></div><p>Es posible hablar con el programa <code class="command">ppp</code>
	    mientras se esta ejecutando en segundo plano, pero sólo
	    si se ha habilitado un puerto de diagnóstico. Para
	    hacer esto, añada lo siguiente a su
	    configuración:</p><pre class="programlisting">set server /var/run/ppp-tun<em class="replaceable"><code>%d</code></em> DiagnosticPassword 0177</pre><p>Esto le indicará a PPP que preste
	    atención al socket del dominio-Unix, solicitando a
	    los usuarios su contraseña, antes de permitir el acceso.
	    La variable <code class="literal">%d</code> deberá ser reemplazada
	    por el numero de dispositivo <code class="filename">tun</code> que
	    este utilizando (ej. <code class="filename">tun0</code>).</p><p>Una vez que se a configurado el socket, se puede utilizar
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pppctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pppctl</span>(8)</span></a> en scripts que deseen manipular el programa.
	    </p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="userppp-final"></a>25.2.1.6. Configuración Final del Sistema</h4></div></div></div><a id="idp80493904" class="indexterm"></a><p>Ahora usted cuenta con un <code class="command">ppp</code> configurado,
	  pero es necesario hacer algunas cosas, antes de que este disponible
	  para trabajar. Todas ellas giran entorno a la edición del
	  fichero <code class="filename">/etc/rc.conf</code>.</p><p>En primer lugar es importante que se asegure que ha asignado
	  un nombre a su maquina. Esto se hace asignandolo en la línea
	  de <code class="literal">hostname=</code>, por ejemplo:</p><pre class="programlisting">hostname="foo.ejemplo.com"</pre><p>Si su Proveedor de Servicios de Internet (PSI), le ha
	  provisto de una dirección fija y un nombre de host, es
	  recomendable que utilice este como su
	  <code class="literal">hostname</code>.</p><p>Localice la línea que se refiera a sus dispositivos
	  de red, la cual es <code class="literal">network_interfaces</code>.
      Si desea configurar su sistema para marcar a su PSI a petición,
      asegurese de que el dispositivo <code class="filename">tun0</code> este
      en la lista, de otra forma eliminelo.</p><pre class="programlisting">network_interfaces="lo0 tun0" ifconfig_tun0=</pre><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">La variable <code class="literal">ifconfig_tun0</code> debe permanecer
	    en blanco (vacia), y deberá crearse un fichero llamado
	    <code class="filename">/etc/start_if.tun0</code> que contenga la siguiente
	    línea:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">ppp -auto MiSistema</pre><p xmlns="http://www.w3.org/1999/xhtml">Este script se ejecuta cuando se esta configurando la red,
	    inicializando el demonio de ppp de modo automático. Si
	    usted cuenta con una LAN (red de área local), de la cual
	    esta maquina sea la pasarela (gateway), es tambien recomendable
	    que utilice la opción <code class="option">-alias</code>. Referirse
	    a la página de ayuda (man) para mayores detalles.</p></div><p>Especifique el programa router a <code class="literal">NO</code>, con
	  la siguiente línea en su fichero
	  <code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">router_enable="NO"</pre><a id="idp80511952" class="indexterm"></a><p>Es importante que el demonio <code class="command">routed</code>
	  no se inicialice por default, en virtud de que
	  <code class="command">routed</code> tiende a eliminar las variables
	  creadas por <code class="command">ppp</code>.</p><p>Probablemente valga la pena asegurarse de que la
	  línea <code class="literal">sendmail_flags</code>, no incluya
	  la opción <code class="option">-q</code>, ya que de ser así
	  <code class="command">sendmail</code> intentará localizar los
	  parámetros de la red de vex en cuando, ocasionando que realice
	  llamados al exterior. Puede intentar esto:</p><pre class="programlisting">sendmail_flags="-bd"</pre><a id="idp80516432" class="indexterm"></a><p>La parte negativa de esta conifguración es que tiene
	  que forzar a <code class="command">sendmail</code> a re-examinar los llamados
	  del servidor de correo, cada vez que <code class="command">ppp</code> realiza
	  una conexión, con el siguiente comando:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/usr/sbin/sendmail -q</code></strong></pre><p>Puede utilizar el comando <code class="command">!bg</code> en el fichero
	  <code class="filename">ppp.linkup</code> para hacer esto de manera
	  automática:</p><pre class="programlisting">1     provider:
2       delete ALL
3       add 0 0 HISADDR
4       !bg sendmail -bd -q30m</pre><a id="idp80521040" class="indexterm"></a><p>Si usted no desea hacer esto, es posible establecer un
	  <span class="quote">&#8220;<span class="quote">dfilter</span>&#8221;</span> (filtro), para bloquear el tráfico al
	  servidor de salida de correo (SMTP). Favor de referirse a los archivos
	  de ejemplos para mayor detalle al respecto.</p><p>Ahora lo único que queda pendiente de hacerse es
	  reiniciar el equipo. Una vez reiniciado el equipo, puede teclear:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ppp</code></strong></pre><p>y posteriormente <code class="command">dial proveedor</code> para iniciar
	  la sesión, o bien si desea que <code class="command">ppp</code> inicie la
	  sesión automáticamente, cuando haya una petición de salida
	  (y no haya creado el fichero <code class="filename">start_if.tun0</code>), puede
	  teclear:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ppp -auto proveedor</code></strong></pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80526160"></a>25.2.1.7. Summario</h4></div></div></div><p>A manera de recapitulación, podemos decir que para
	  configurar ppp por primera ocasión, debemos:</p><p>Por parte del Cliente:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Asegurese de que existe el dispositivo <code class="filename">tun</code>
	      dentro de su kernel.</p></li><li class="step"><p>Asegurses de que el dispositivo
	      <code class="filename">tunX</code>, se encuentra
	      disponible, bajo el directorio <code class="filename">/dev</code>.</p></li><li class="step"><p>Cree una entrada en su fichero
	      <code class="filename">/etc/ppp/ppp.conf</code>. Con el fichero de ejemplo
	      <code class="filename">pmdemand</code> debe ser suficiente para la mayoria de
	      proveedores.</p></li><li class="step"><p>Si cuenta con una dirección de IP dinámica, cree
	      una entrada en el fichero <code class="filename">/etc/ppp/ppp.linkup</code>
	      .</p></li><li class="step"><p>Actualice su fichero <code class="filename">/etc/rc.conf</code>.</p></li><li class="step"><p>Cree un archivo script llamado <code class="filename">start_if.tun0</code>
	      si requiere servicio de conexión a solicitud.</p></li></ol></div><p>Por parte del Servidor:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Asegurese de que dentro de su kernel exista el dispositivo
	      <code class="filename">tun</code>.</p></li><li class="step"><p>Asegurses de que el dispositivo
	      <code class="filename">tunX</code>, se encuentra
	      disponible, bajo el directorio <code class="filename">/dev</code>.</p></li><li class="step"><p>Cree una entrada en el fichero <code class="filename">/etc/passwd</code>
	      (usando el programa <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vipw&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">vipw</span>(8)</span></a>).</p></li><li class="step"><p>Cree un perfil en el directorio home de este usuario, que ejecute
	      <code class="command">ppp -direct direct-server</code> o algo
	      similar.</p></li><li class="step"><p>Cree una entrada en el fichero
	      <code class="filename">/etc/ppp/ppp.conf</code>. El fichero de ejemplo
	      <code class="filename">direct-server</code> debe ser suficiente para
	      darse una idea.</p></li><li class="step"><p>Cree una entrada en el fichero
	      <code class="filename">/etc/ppp/ppp.linkup</code>.</p></li><li class="step"><p>Actualice su fichero <code class="filename">/etc/rc.conf</code>.</p></li></ol></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ppp-and-slip.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="ppp-and-slip.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="ppp.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Capítulo 25. PPP y SLIP </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 25.3. Uso de Kernel PPP</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>