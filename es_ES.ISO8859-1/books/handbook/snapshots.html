<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>18.13. Instantáneas (&#8220;snapshots&#8221;) de sistemas de ficheros</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manual de FreeBSD" /><link rel="up" href="disks.html" title="Capítulo 18. Almacenamiento" /><link rel="prev" href="disks-virtual.html" title="18.12. Sistemas de ficheros en red, memoria y respaldados en fichero" /><link rel="next" href="quotas.html" title="18.14. Cuotas en sistemas de ficheros" /><link rel="copyright" href="legalnotice.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">18.13. Instantáneas (<span class="quote">&#8220;<span class="quote">snapshots</span>&#8221;</span>) de sistemas
      de ficheros</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="disks-virtual.html">Anterior</a> </td><th width="60%" align="center">Capítulo 18. Almacenamiento</th><td width="20%" align="right"> <a accesskey="n" href="quotas.html">Siguiente</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="snapshots"></a>18.13. Instantáneas (<span class="quote">&#8220;<span class="quote">snapshots</span>&#8221;</span>) de sistemas
      de ficheros</h2></div><div><span class="authorgroup">Escrito por <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><a id="idp78342608" class="indexterm"></a><p>FreeBSD 5.0 ofrece una característica relacionada
        con
        <a class="link" href="soft-updates.html" title="11.3. &#8220;Soft Updates&#8221;">Soft Updates</a>: las
        instantáneas del sistema de ficheros.</p><p>Las instantáneas permiten a un usuario crear
        imágenes de uno o más sistemas de ficheros dados, y
        tratarlas como un fichero.  Los ficheros de instantánea
        deben crearse en el sistema de ficheros en el que se realiza la
        acción, y un usuario puede crear hasta 20 (veinte)
        instantáneas por sistema de ficheros.  Las
        instantáneas activas se graban en el superbloque, lo que
        hace que sigan ahí independientemente de montajes,
        remontajes y reinicios del sistema.  Cuando ya no necesite
        una instantánea puede borrarla con <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rm&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rm</span>(1)</span></a>.
        Las instantáneas pueden borrarse en cualquier orden pero
        puede que no pueda recuperar todo el espacio debido a que otra
        instantánea puede reclamar algunos bloques liberados.</p><p>La bandera inalterable de fichero <code class="option">snapshot</code>
        se activa con <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mksnap_ffs</span>(8)</span></a> después de la creación
        inicial de un fichero de instantánea.  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=unlink&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">unlink</span>(1)</span></a>
        hace una excepción con los ficheros de instantánea,
        ya que permite que se les borre.</p><p>Las instantáneas se crean con <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a>.
        Veamos un ejemplo.  Vamos a colocar una instantánea de
        <code class="filename">/var</code> en
        <code class="filename">/var/snapshot/snap</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -u -o snapshot /var/snapshot/snap /var</code></strong></pre><p>También puede usar <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mksnap_ffs</span>(8)</span></a> para
        crear una instantánea:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mksnap_ffs /var /var/snapshot/snap</code></strong></pre><p>Si busca ficheros de instantánea en un sistema de
        de ficheros (por ejemplo <code class="filename">/var</code>) puede usar
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=find&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">find</span>(1)</span></a>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>find /var -flags snapshot</code></strong></pre><p>Una instantánea tiene distintos usos:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Algunos administradores usan un fichero de
            instantánea como respaldo, puesto que la instantánea
            puede guardarse en CD o cinta.</p></li><li class="listitem"><p>Integridad de ficheros; <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a> puede ejecutarse
            en una instantánea.  Asumiendo que el sistema de
            ficheros estuviera limpio cuando se montó se debe
            obtener un resultado limpio (e intacto).  En esencia el
            proceso <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a> hace esto mismo en segundo plano.</p></li><li class="listitem"><p>Ejecución de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a> en la instantánea.
            Se obtendrá un dump consistente con el sistema de
            ficheros y los sellos de hora de la instantánea.
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a> también puede leer una instantánea,
            crear una imagen dump y eliminar la instantánea en
            un comando usando la opción
            <code class="option">-L</code>.</p></li><li class="listitem"><p>Ejecutar un <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> contra la instantánea
            como una imagen congelada del sistema de ficheros.
            Para montar la instantánea
            <code class="filename">/var/snapshot/snap</code> ejecute:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t vnode -f /var/snapshot/snap -u 4</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount -r /dev/md4 /mnt</code></strong></pre></li></ul></div><p>Podrá recorrer la jerarquía de su sistema de
        ficheros <code class="filename">/var</code> congelado montado en
        <code class="filename">/mnt</code>.  Todo estará en el mismo estado
        en el que estaba cuando creó la instantánea.
        La única excepción es que cualquier
        instantánea anterior aparecerá como un fichero
        de longitud cero.  Cuando haya acabado de usar una
        instantánea puede desmontarla con:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>umount /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mdconfig -d -u 4</code></strong></pre><p>Para más información sobre
        <code class="option">softupdates</code> e instantáneas de sistemas
        ficheros, incluyendo textos técnicos, visite el sitio
        web de Marshall Kirk McKusick:
	<code class="uri"><a class="uri" href="http://www.mckusick.com/" target="_top">http://www.mckusick.com/</a></code>.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="disks-virtual.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="disks.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="quotas.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">18.12. Sistemas de ficheros en red, memoria y respaldados en fichero </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 18.14. Cuotas en sistemas de ficheros</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>