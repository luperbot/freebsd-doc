<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>27.4. Sustitución del Agente de Transferencia de Correo</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manual de FreeBSD" /><link rel="up" href="mail.html" title="Capítulo 27. Correo Electrónico" /><link rel="prev" href="sendmail.html" title="27.3. Configuración de sendmail" /><link rel="next" href="mail-trouble.html" title="27.5. Depuración de Problemas" /><link rel="copyright" href="legalnotice.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">27.4. Sustitución del Agente de Transferencia de Correo</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="sendmail.html">Anterior</a> </td><th width="60%" align="center">Capítulo 27. Correo Electrónico</th><td width="20%" align="right"> <a accesskey="n" href="mail-trouble.html">Siguiente</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mail-changingmta"></a>27.4. Sustitución del Agente de Transferencia de Correo</h2></div><div><span class="authorgroup">Escrito por <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Andrew</span> <span class="surname">Boothman</span></span>. </span></div><div><span class="authorgroup">Información obtenida de correos escritos por <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Gregory</span> <span class="surname">Neil Shapiro</span></span>. </span></div></div></div><a id="idp81222352" class="indexterm"></a><p>Como ya se ha comentado FreeBSD viene con <span class="application">
      sendmail</span> ya instalado como agente de transferencia de
      correo por defecto.  De esta forma <span class="application">sendmail</span>
      se encarga de gestionar el correo entrante y saliente.</p><p>No obstante, debido a distintas razones algunos administradores de
      sistemas prefieren utilizar otro MTA.
      Estas razones varían desde simplemente querer probar otros
      programas de transferencia de correo, hasta la necesidad
      de utilizar un determinado programa que hace uso de una función
      específica de un agente determinado.  Por suerte
      cualesquiera que sean estas razones FreeBSD posee un sencillo
      procedimiento para sustituir a
      <span class="application">sendmail</span>.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81229648"></a>27.4.1. Instalación de un nuevo MTA</h3></div></div></div><p>Existen una amplia gama de MTA alternativos a <span class="application">
        sendmail</span>. Un buen punto de partida es el <a class="link" href="ports.html" title="Capítulo 4. Instalación de aplicaciones: «packages» y ports">Sistema de Ports de FreeBSD</a>,
        donde se pueden localizar varios.  Por supuesto el usuario tiene
        libertad para utilizar cualquier MTA, siempre y cuando se pueda
        ejecutar en FreeBSD sin problemas.</p><p>Lo primero es instalar el nuevo MTA.  Una vez que está
        instalado normalmente se tiene la oportunidad para decidir si
        realmente cubre las necesidades y también se tiene la
        oportunidad de configurar el nuevo software antes de sustituir a
        <span class="application">sendmail</span>.  El usuario debe tener en cuenta
        que el nuevo MTA puede sobreescribir algunos binarios del sistema como
        por ejemplo <code class="filename">/usr/bin/sendmail</code>.
	En cualquier caso el nuevo software de correo
        suele entrar en funcionamiento con una configuración
        por defecto.</p><p>Por favor, recuerde que se recomienda leer la documentación
        del MTA seleccionado para obtener más
        información.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81233232"></a>27.4.2. Desactivación de la aplicación <span class="application">
        sendmail</span></h3></div></div></div><p>El procedimiento utilizado para ejecutar
	<span class="application">sendmail</span> cambió significativamente
        entre las releases 4.5-RELEASE y 4.6-RELEASE.
        De esta forma el procedimiento utilizado para la desactivación
        hoy en día es
        sutílmente distinto al utilizado en dichas distribuciones.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81234896"></a>27.4.2.1. FreeBSD 4.5-STABLE antes de 2002/4/4 y anteriores
	  (Incluyendo 4.5-RELEASE y anteriores)</h4></div></div></div><p>Introducir:</p><pre class="programlisting">sendmail_enable="NO"</pre><p>dentro de <code class="filename">/etc/rc.conf</code>.  Esta variable
          desactiva el servicio de recepción de correo de
	  <span class="application">sendmail</span>,
	  pero salvo que se modifique (ver más adelante) el
          fichero <code class="filename">/etc/mail/mailer.conf</code>
	  <span class="application">sendmail</span> todavía será
          la aplicación elegida para enviar correo
          electrónico.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81250768"></a>27.4.2.2. FreeBSD 4.5-STABLE desde de 2002/4/4
	  (Incluyendo 4.6-RELEASE y posteriores)</h4></div></div></div><p>Para poder desactivar completamente
	  <span class="application">sendmail</span> haga lo siguiente:</p><pre class="programlisting">sendmail_enable="NONE"</pre><p>dentro del fichero <code class="filename">/etc/rc.conf.</code></p><div xmlns="" class="warning"><h3 class="admontitle">Aviso: </h3><p xmlns="http://www.w3.org/1999/xhtml"> Se desactiva el servicio de correo de salida de
            <span class="application">sendmail</span>.
	    Es importanque que se reemplace con un sistema de entrega de
            correo alternativo que sea totalmente funcional.
            En caso contrario funciones del sistema FreeBSD tales como
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=periodic&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">periodic</span>(8)</span></a> no podrán entregar sus resultados por
            correo eletrónico tal y como normalmente hacen.
            Varias partes del sistema FreeBSD esperan disponer de un sistema
            de correo funcional compatible con
            sendmail.  Si las aplicaciones continúan utilizando los
            binarios de <span class="application">sendmail</span>
	    para realizar envíos de correo después de su
            desactivación el correo podría ser almacenado en una
            cola inactiva de <span class="application">sendmail</span>, en cuyo caso
            nunca se entregaría.</p></div><p>Si sólo se quiere desactivar el servicio de correo de
          entrada de <span class="application">sendmail</span>, basta con establecer
	  la variable:</p><pre class="programlisting">sendmail_enable="NO"</pre><p>dentro de <code class="filename">/etc/rc.conf</code>.
          En <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc.sendmail</span>(8)</span></a> tiene más información sobre
          las opciones de arranque de <span class="application">
          sendmail</span>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81263440"></a>27.4.3. Ejecución del nuevo MTA en el arranque</h3></div></div></div><p>Existen dos métodos alternativos para ejecutar el nuevo
        MTA en el arranque, dependiendo
        de la versión de FreeBSD que se esté ejecutando.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81264464"></a>27.4.3.1. FreeBSD 4.5-STABLE antes de 2002/4/11
	  (Incluyendo 4.5-RELEASE y anteriores)</h4></div></div></div><p>Se debe añadir un script en
	  <code class="filename">/usr/local/etc/rc.d/</code> cuyo nombre termine en
	  <code class="filename">.sh</code> y que sea ejecutable por
	  <code class="systemitem">root</code>.  El script debe aceptar los
          parámetros <code class="literal">start</code> y
	  <code class="literal">stop</code>.  Cuando el sistema FreeBSD se está
          inicializando, los scripts de arranque
          ejecutarán el siguiente comando:</p><pre class="programlisting">/usr/local/etc/rc.d/supermailer.sh start</pre><p>La misma orden se puede utilizar también para ejecutar
          el servidor de forma manual.
          Cuando el sistema se está reiniciando los scripts del sistema
          ejecutan los ficheros ubicados en
          <code class="filename">/usr/local/etc/rc.d/</code> utilizando la opción
	  <code class="literal">stop</code>, en nuestro caso:</p><pre class="programlisting">/usr/local/etc/rc.d/supermailer.sh stop</pre><p>Dicho comando tambíen se puede utilizar para detener el
          servidor de correo de forma manual cuando el
          sistema FreeBSD se ejecuta con normalidad.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81270096"></a>27.4.3.2. FreeBSD 4.5-STABLE después de 2002/4/11
	  (Incluyendo 4.6-RELEASE y posteriores)</h4></div></div></div><p>Con las últimas versiones de FreeBSD se puede utilizar el
          método anterior pero también se puede
          especificar</p><pre class="programlisting">mta_start_script="nombre_de_fichero"</pre><p>dentro de <code class="filename">/etc/rc.conf</code>, donde
	  <em class="replaceable"><code>nombre_de_fichero</code></em> es el nombre de
          algún script que se ejecuta en tiempo de arranque
          para inicializar el nuevo MTA.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81272912"></a>27.4.4. Sustitución de <span class="application">sendmail</span> como el
        agente de transporte de correo predeterminado.</h3></div></div></div><p>El programa <span class="application">sendmail</span> es tan
        imprescindible y es utilizado por tal multitud de programas en
        los sistemas <span class="trademark">UNIX</span>® que algunos programas simplemente asumen que
        <span class="application">sendmail</span> se encuentra instalado y
        configurado dentro del sistema.
	Por esta razón varios MTAs alternativos proporcionan su propia
        implementación de la interfaz de línea de comandos que
        posée <span class="application">sendmail</span>; esto facilita que se
        puedan utilizar como sustitutos de <span class="application">sendmail</span>
        sin mayores dificultades.</p><p>Por lo tanto si desea utilizar un agente de transporte de correo
        alternativo debe asegurarse de que todo software que intente ejecutar
	binario de <span class="application">sendmail</span> estándar,
        <code class="filename">/usr/bin/sendmail</code>, realmente ejecute el nuevo MTA
        en su lugar. Por fortuna FreeBSD proporciona un sistema llamado
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mailwrapper&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mailwrapper</span>(8)</span></a> que realiza precisamente esta tarea.</p><p>Cuando <span class="application">sendmail</span> está funcionando
        se debe localizar algo como lo siguiente dentro del fichero
        <code class="filename">/etc/mail/mailer.conf</code>:</p><pre class="programlisting">sendmail	 /usr/libexec/sendmail/sendmail
send-mail	/usr/libexec/sendmail/sendmail
mailq		/usr/libexec/sendmail/sendmail
newaliases	/usr/libexec/sendmail/sendmail
hoststat	/usr/libexec/sendmail/sendmail
purgestat	/usr/libexec/sendmail/sendmail</pre><p>Esto significa que cuando cualquiera de estos comandos
	(por ejemplo <code class="filename">sendmail</code> mísmamente)
        se ejecutan el sistema ejecutará en su lugar una copia del
        el sistema ejecuta en su lugar una copia del <span class="quote">&#8220;<span class="quote">
        mailwrapper</span>&#8221;</span> denominada <code class="filename">sendmail</code>
        que chequea el fichero <code class="filename">mailer.conf</code> y ejecuta
        <code class="filename">/usr/libexec/sendmail/sendmail</code>.
        Este sistema permite cambiar de una forma sencilla los binarios que
        se ejecutan realmente cuando se invocan las funciones de
        <code class="filename">sendmail</code>.</p><p>Si se quiere que ejecutar
        <code class="filename">/usr/local/supermailer/bin/sendmail-compat</code>
	en lugar de <span class="application">sendmail</span> se puede cambiar el
	fichero <code class="filename">/etc/mail/mailer.conf</code> para que contenga
        lo siguiente:</p><pre class="programlisting">sendmail	 /usr/local/supermailer/bin/sendmail-compat
send-mail	/usr/local/supermailer/bin/sendmail-compat
mailq		/usr/local/supermailer/bin/mailq-compat
newaliases	/usr/local/supermailer/bin/newaliases-compat
hoststat	/usr/local/supermailer/bin/hoststat-compat
purgestat	/usr/local/supermailer/bin/purgestat-compat</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81284816"></a>27.4.5. Últimos Pasos</h3></div></div></div><p>Una vez que todo estáconfigurado a su gusto
          hay que matar los procesos de <span class="application">sendmail</span>
          que ya no se necesitan y ejecutar los procesos pertenecientes al
          nuevo software de MTA, o utilizar la opción más
          sencilla: reiniciar la máquina.  Reinicar la máquina
          nos brinda la oportunidad de comprobar que se ha configurado
          correctamente el arranque del sistema para que ejecute de forma
          automática el nuevo MTA.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sendmail.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="mail-trouble.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">27.3. Configuración de <span class="application">sendmail</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 27.5. Depuración de Problemas</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>