<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>27.10. Autentificación utilizando SMTP</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manual de FreeBSD" /><link rel="up" href="mail.html" title="Capítulo 27. Correo Electrónico" /><link rel="prev" href="SMTP-dialup.html" title="27.9. Utilización del correo con una conexión mediante módem analógico (dial-up)" /><link rel="next" href="mail-agents.html" title="27.11. Agente de Correo de Usuario" /><link rel="copyright" href="legalnotice.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">27.10. Autentificación utilizando SMTP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="SMTP-dialup.html">Anterior</a> </td><th width="60%" align="center">Capítulo 27. Correo Electrónico</th><td width="20%" align="right"> <a accesskey="n" href="mail-agents.html">Siguiente</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="SMTP-Auth"></a>27.10. Autentificación utilizando SMTP</h2></div><div><span class="authorgroup">Escrito por <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">James</span> <span class="surname">Gorham</span></span>. </span></div></div></div><p>La autentificación mediante SMTP puede proporcionarnos
      diversas ventajas.  Añade una capa adicional de seguridad a
      a <span class="application">sendmail</span> y además proporciona a los
      usuarios móviles (usuarios que cambian de máquina)
      la posibilidad de mantener el mismo servidor de correo sin necesidad de
      reconfigurar sus agentes de usuario de correo cada vez que se
      trasladan.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Instalar <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/cyrus-sasl/pkg-descr">security/cyrus-sasl</a>
	  desde los ports.  Se puede encontrar dicho port en
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/cyrus-sasl/pkg-descr">security/cyrus-sasl</a>.
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/cyrus-sasl/pkg-descr">security/cyrus-sasl</a> posée
          varias opciones en tiempo de compilación pero para el
          método en particular  que se va a explicar en esta
          sección basta con asegurarse de seleccionar
          la opción <code class="option">pwcheck</code>.</p></li><li class="step"><p>Después de instalar <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/cyrus-sasl/pkg-descr">security/cyrus-sasl</a>,
	  edite <code class="filename">/usr/local/lib/sasl/Sendmail.conf</code>
	  (o créelo si no existe) y añada la siguiente
          línea:</p><pre class="programlisting">pwcheck_method: passwd</pre><p>Este método activa la autentificación de
          <span class="application">sendmail</span> contra nuestra base de
	  datos de FreeBSD, <code class="filename">passwd</code>.
          Esto nos evita el problema de tener que crear un nuevo conjunto de
          usuarios y contraseñas  para cada usuario que necesite
          validarse mediante SMTP y además nos permite mantener el
          mismo <span class="quote">&#8220;<span class="quote">login</span>&#8221;</span> y contraseña que los usuarios
          utilizan para acceder a sus cuentas para el acceso al correo
          electrónico.</p></li><li class="step"><p>Editar<code class="filename">/etc/make.conf</code> y añadir las
          siguientes líneas:</p><pre class="programlisting">SENDMAIL_CFLAGS=-I/usr/local/include/sasl1 -DSASL
SENDMAIL_LDFLAGS=-L/usr/local/lib
SENDMAIL_LDADD=-lsasl</pre><p>Estas líneas proporcionan a <span class="application">
        sendmail</span> las opciones de configuración necesarias
	para enlazar con <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/cyrus-sasl/pkg-descr">cyrus-sasl</a> en
        tiempo de compilación.  Debemos asegurarnos de que <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/cyrus-sasl/pkg-descr">cyrus-sasl</a> ha sido instalado correctamente
	recompilar <span class="application">sendmail</span>.</p></li><li class="step"><p>Recompile <span class="application">sendmail</span> utilizando el
          siguiente comando:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/usr.sbin/sendmail</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make cleandir</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make obj</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make install</code></strong></pre><p>La compilación de <span class="application">sendmail</span> no
          debería dar problemas siempre y cuando
	  <code class="filename">/usr/src</code> no haya cambiado sustancialmente y
          siempre y cuando las bibliotecas compartidas
          necesarias se encuentren disponibles.</p></li><li class="step"><p>Una vez que <span class="application">sendmail</span> se ha compilado
          y reinstalado con correctamente debemos editar el fichero
	  <code class="filename">/etc/mail/freebsd.mc</code> (o el fichero que se
	  utilice como <code class="filename">.mc</code> de referencia.  Hay
          administradores que  escogen utilizar la salida de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hostname&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">hostname</span>(1)</span></a>
          como el nombre del fichero <code class="filename">.mc</code> que se utiliza
          para la configuración de sendmail por motivos de
          uniformidad ).  Añada las siguientes líneas a dicho
          fichero:</p><pre class="programlisting">dnl set SASL options
TRUST_AUTH_MECH(`GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl
define(`confAUTH_MECHANISMS', `GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl
define(`confDEF_AUTH_INFO', `/etc/mail/auth-info')dnl</pre><p>Estas opciones configuran los distintos métodos
        de que dispone <span class="application">sendmail</span> para validar a
        los usuarios de correo.  Si se desea utilizar otro método
        distinto a <span class="application">pwcheck</span> por favor consulte
        la documentación.</p></li><li class="step"><p>Para terminar ejecutamos <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> mientras nos encontramos
          dentro de <code class="filename">/etc/mail</code>.
	  Este comando trata el fichero <code class="filename">.mc</code> y crea el
          fichero <code class="filename">.cf</code> correspondiente
          (con el mismo nombre que el anterior pero terminado en .cf).
          A continuación se utiliza el comando <code class="command">
          make install restart</code>, el cual copia el fichero .cf
          recién generado al fichero <code class="filename">
          sendmail.cf</code> y a continuación reinicia
          <span class="application">sendmail</span>.
	  Para más información sobre este proceso puede
          consultarse el contenido de
          <code class="filename">/etc/mail/Makefile</code>.</p></li></ol></div><p>Si todo lo anteriormente comentado ha funcionado correctamente
       deberíamos ser capaces de introducir la información de
      nuestro <span class="quote">&#8220;<span class="quote">login</span>&#8221;</span> en nuestro cliente de correo y enviar un
      mensaje de prueba.  Para investigar más a fondo estos temas se
      puede habilitar la opción <code class="option">LogLevel</code> de
      <span class="application">sendmail</span> al valor 13 y observar detenidamente
      el archivo <code class="filename">/var/log/maillog</code> en busca de posibles
      mensajes de error.</p><p>Puede ser necesario añadir las siguientes líneas al
      fichero <code class="filename">/etc/rc.conf</code> de modo que el servicio
      explicado en esta sección se encuentre disponible
      automáticamente desde el arranque:</p><pre class="programlisting">sasl_pwcheck_enable="YES"
sasl_pwcheck_program="/usr/local/sbin/pwcheck"</pre><p>Esto permite que la inicialización de <acronym class="acronym">SMTP_AUTH</acronym> se produzca durante el arranque del sistema.</p><p>Para más información por favor visite la página
      <a class="link" href="http://www.sendmail.org/~ca/email/auth.html" target="_top">
      autentificación <acronym class="acronym">SMTP</acronym></a>
       de <span class="application">sendmail</span>·</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="SMTP-dialup.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="mail-agents.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">27.9. Utilización del correo con una conexión mediante módem analógico (dial-up) </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 27.11. Agente de Correo de Usuario</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>