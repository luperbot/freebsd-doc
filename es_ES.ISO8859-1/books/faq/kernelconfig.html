<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>Capítulo 7. Configuración del Kernel</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Preguntas más frecuentes de FreeBSD 4.X, 5.X y 6.X" /><link rel="up" href="index.html" title="Preguntas más frecuentes de FreeBSD 4.X, 5.X y 6.X" /><link rel="prev" href="applications.html" title="Capítulo 6. Aplicaciones de usuario" /><link rel="next" href="admin.html" title="Capítulo 8. Administración de sistema" /><link rel="copyright" href="legalnotice.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Capítulo 7. Configuración del Kernel</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="applications.html">Anterior</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="admin.html">Siguiente</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="kernelconfig"></a>Capítulo 7. Configuración del Kernel</h1></div></div></div><div class="qandaset"><a id="idp67683024"></a><dl><dt>7.1. <a href="kernelconfig.html#idp67683280">Me gustaría personalizar mi kernel. ?Es difícil?</a></dt><dt>7.2. <a href="kernelconfig.html#idp67705552">La compilación del kernel falla por "_hw_float is
        missing."</a></dt><dt>7.3. <a href="kernelconfig.html#idp67713872">Conflicto de interrupciones con tarjeta serie multi-port.</a></dt><dt>7.4. <a href="kernelconfig.html#idp67716944">?Cómo activo el soporte para discos QIC-40/80?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp67683280"></a><a id="make-kernel"></a><p><strong>7.1.</strong></p></td><td align="left" valign="top"><p>Me gustaría personalizar mi kernel. ?Es difícil?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>No!, primero, necesitas la distribución completa de fuentes o,
        por lo menos, la distribución de fuentes del kernel. De esta manera
        tienes los fuentes necesarios para crearte un nuevo kernel. Al
        contrario que muchos Unix comerciales, nosotros tenemos la política
        de <acronym class="acronym">NO</acronym> vender nuestro kernel en formato binario.</p><p>La instalación de los fuentes ocupa un poco más de
        espacio, pero te permite consultar los fuentes del kernel en caso de
        dificultad o entender que está ocurriendo realmente en la
        ejecución del sistema.</p><p>Una vez tienes instalada la distribución completa de fuentes, o
        por lo menos la del kernel, haz lo siguiente como root:</p><p>
        </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p> <code class="command">cd /usr/src/sys/i386/conf</code></p></li><li class="listitem"><p> <span class="emphasis"><em>cp GENERIC MYKERNEL</em></span></p></li><li class="listitem"><p> <span class="emphasis"><em>vi MYKERNEL</em></span></p></li><li class="listitem"><p> <span class="emphasis"><em>config MYKERNEL</em></span></p></li><li class="listitem"><p> <span class="emphasis"><em>cd ../../compile/MYKERNEL</em></span></p></li><li class="listitem"><p> <span class="emphasis"><em>make depend</em></span></p></li><li class="listitem"><p> <span class="emphasis"><em>make all</em></span></p></li><li class="listitem"><p> <span class="emphasis"><em>make install</em></span></p></li><li class="listitem"><p> <span class="emphasis"><em>reboot</em></span></p></li></ol></div><p>
        </p><p>El paso 2 no es necesario si todavía tienes un archivo de
        configuración del kernel de una release anterior de FreeBSD
        2.X. - simplemente, copia el archivo antiguo y examínalo
        cuidadosamente para asegurar que no haya cambiado la sintaxis
        da algún driver, o haya alguno anticuado.</p><p>Un buen archivo de configuración para consultar es <acronym class="acronym">LINT</acronym>,
        el cual contiene ejemplos documentados para todas las posibles
        opciones del kernel. El archivo de configuración <acronym class="acronym">GENERIC</acronym> se
        usa para crear el kernel "por defacto" que es el que estarás
        usando si no has creado ninguno nuevo.</p><p>Si no necesitas hacer ningún cambio al archivo <acronym class="acronym">GENERIC</acronym>,
        puedes saltar al paso 3, donde personalizas el kernel para tu
        sistema. El paso 8 solo debe ejecutarse si los pasos 6 y 7 se
        han realizado de manera satisfactoria. Esto copiará una
        imágen del nuevo kernel a <code class="filename">/kernel</code> y
        <span class="emphasis"><em>realizará una copia del antiguo kernel en</em></span>
        <code class="filename">/kernel.old</code>. Es muy importante recordar esto por si el
        nuevo kernel falla en algun momento - puedes seleccionar <code class="filename">kernel.old</code>
        en el prompt de arranque. Al hacer un reboot, por defecto se cargará el
        nuevo kernel.</p><p>Si la compilación en el paso 7 falla por alguna razón, es
        recomendable que empieces desde el paso 4 substituyendo
        <acronym class="acronym">GENERIC</acronym> por <acronym class="acronym">MYKERNEL</acronym>. Si puedes generar el kernel
        <acronym class="acronym">GENERIC</acronym>, significa que algo en tu archivo de configuración
        es incorrecto (o has decubierto un bug). Si la compilación del
        kernel <acronym class="acronym">GENERIC</acronym> falla, posiblemente tengas los fuentes
        corruptos.</p><p>Finalmente, si necesitas ver los mensajes originales de arranque
        del sistema para compilar un nuevo kernel, ejecuta el comando
        <a class="link" href="http://www.FreeBSD.org/cgi/man.cgi?dmesg" target="_top">dmesg</a>. Este
        comando debe imprimir en pantalla todos los
        mensajes producidos por el kernel al arrancar, los cuales te
        pueden servir en la configuración de tu nuevo kernel.</p><p><acronym class="acronym">NOTA</acronym> Recomendamos hacer un historial fechado de los kernel
        que vayas creando, de la manera <code class="filename">kernel.YYMMDD</code> una vez estén
        funcionando correctamente. De esta manera, si la próxima vez que
        juegues con el kernel algo no funciona, puedes arrancar desde el
        último kernel correcto. Esto es especialmente importante si ahora
        estás arrancando desde una controladora no soportada por el kernel
        GENERIC (si, experiencia personal).</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp67705552"></a><a id="idp67705808"></a><p><strong>7.2.</strong></p></td><td align="left" valign="top"><p>La compilación del kernel falla por "<span class="symbol">_hw_float</span> is
        missing."</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Dejame adivinar. Has borrado
        <a class="link" href="http://www.FreeBSD.org/cgi/man.cgi?npx(4)" target="_top">npx0</a>
        de tu archivo de configuración porque no tienes coprocesador
        matemático, no? Mal hecho :-) El dispositivo <span class="emphasis"><em>npx0</em></span> es
        <acronym class="acronym">OBLIGATORIO</acronym>. Aunque no tengas coprocesador, debes incluir
        el dispositivo <span class="emphasis"><em>npx0</em></span></p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp67713872"></a><a id="idp67714128"></a><p><strong>7.3.</strong></p></td><td align="left" valign="top"><p>Conflicto de interrupciones con tarjeta serie multi-port.</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Cuando compilo el kernel con drivers para tarjetas serie
        multipuerto, el sistema me dice que sólo el primer puerto es
        testeado y el resto son obviados debido a conflictos de
        interrupción. Cómo soluciono esto?</p><p>El problema en este caso es que FreeBSD tiene código interno que
        evita caidas del sistema por conflictos de hardware o software. La
        manera de solucionar esto es dejar en blanco la entrada correspondiente
        a la irq en todos los puertos excepto en uno. Aquí tienes un
        ejemplo:</p><p>
        </p><div class="literallayout"><p>        #<br />
        # Multiport high-speed serial line - 16550 UARTS<br />
        #<br />
        device sio2 at isa? port 0x2a0 tty irq 5 flags 0x501 vector siointr<br />
        device sio3 at isa? port 0x2a8 tty flags 0x501 vector siointr<br />
        device sio4 at isa? port 0x2b0 tty flags 0x501 vector siointr<br />
        device sio5 at isa? port 0x2b8 tty flags 0x501 vector siointr<br />
        </p></div><p>
        </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp67716944"></a><a id="idp67717200"></a><p><strong>7.4.</strong></p></td><td align="left" valign="top"><p>?Cómo activo el soporte para discos QIC-40/80?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Necesitas "descomentar" la siguiente línea en el archivo
        genérico de configuración (o añadirla en tu propio
        archivo), añade un <code class="literal">flags 0x1</code> en la línea
        <a class="link" href="http://www.FreeBSD.org/cgi/man.cgi?fdc(4)" target="_top">fdc</a>
        y recompila.</p><p>
        </p><div class="literallayout"><p><br />
controller  fdc0  at isa? port "IO_FD1" bio irq 6 drq 2 flags 0x1 vector fdintr<br />
disk        fd0   at fdc0 drive 0                       ^^^^^^^^^<br />
disk        fd1   at fdc0 drive 1<br />
#tape       ft0   at fdc0 drive 2<br />
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br />
        </p></div><p>
        </p><p>A continuación, crea un nuevo dispositivo llamado
        <code class="filename">/dev/ft0</code> entrando en el directorio <code class="filename">/dev</code>
        y ejecutando el comando:</p><p>
        </p><div class="literallayout"><p>        sh ./MAKEDEV ft0<br />
        </p></div><p>
        </p><p>Para el primer dispositivo. <span class="emphasis"><em>ft1</em></span> para el
        segundo y así para todos los dispositivos de este tipo que tengas.</p><p>Tendrás un dispositivo llamado <code class="filename">/dev/ft0</code>, al cual puedes
        escribir a través de un programa especial de manejo llamado
        <span class="emphasis"><em>ft</em></span> - mira el man en
        <a class="link" href="http://www.FreeBSD.org/cgi/man.cgi?ft" target="_top">ft</a>
        para más detalles.</p><p>Versiones anteriores a la <code class="option">-current</code> tenían algunos problemas
        al encontrase con cintas en mal estado; si tienes problemas en los
        que parece que la cinta se rebovina siempre al llegar al mismo
        lugar, intenta utilizar la última versión del programa
        <span class="emphasis"><em>ft</em></span> que encontrarás en
        <code class="filename">/usr/src/sbin/ft</code> en <code class="option">-current</code>.</p></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="applications.html">Anterior</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="admin.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Capítulo 6. Aplicaciones de usuario </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> Capítulo 8. Administración de sistema</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>