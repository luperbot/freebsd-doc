<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>9.4. Magasszintû nyomtatóbeállítás</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="printing.html" title="9. fejezet - Nyomtatás" /><link rel="prev" href="printing-intro-setup.html" title="9.3. Kezdeti beállítások" /><link rel="next" href="printing-using.html" title="9.5. A nyomtatók használata" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">9.4. Magasszintû
      nyomtatóbeállítás</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="printing-intro-setup.html">Vissza</a> </td><th width="60%" align="center">9. fejezet - Nyomtatás</th><td width="20%" align="right"> <a accesskey="n" href="printing-using.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="printing-advanced"></a>9.4. Magasszintû
      nyomtatóbeállítás</h2></div></div></div><p>Ebben a szakaszban olyan szûrõket mutatunk be,
      amelyek speciálisan formázott
      állományok, fejléclapok,
      hálózati nyomtatás, nyomtatási
      nyilvántartás vagy szabályozás
      esetén használhatóak.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-filter-intro"></a>9.4.1. Szûrõk</h3></div></div></div><a id="idp82079824" class="indexterm"></a><p>Noha az <span class="application">LPD</span> képes
	hálózati protokollokat, nyomtatási sorokat,
	hozzáférést és sok minden más
	nyomtatási feladatot kezelni, a
	<span class="emphasis"><em>tényleges</em></span> munka legnagyobb
	része a <span class="emphasis"><em>szûrõkben</em></span> (filter)
	történik.  A szûrõk olyan programok,
	amelyek tartják a kapcsolatot a nyomtatóval
	és megbirkóznak annak
	eszközfüggõségeivel és
	különleges igényeivel.  Az egyszerû
	beállítás során egy primitív
	szövegszûrõt állítottunk be
	(lásd <a class="link" href="printing-intro-setup.html#printing-textfilter" title="9.3.1.5.6. A szövegszûrõ telepítése">A
	  szövegszûrõ telepítése</a>)
	- ami annyira egyszerû, hogy szinte minden
	nyomtatón mûködnie kell.</p><p>Azonban mindahhoz, hogy ki tudjuk használni a
	különbözõ átalakítási,
	nyilvántartási lehetõségeket, valamint
	a nyomtatók különlegességeit és
	egyebeit, meg kell értenünk a szûrõk
	pontos mûködését.  Az elõbb
	említett feladatok ugyanis teljesen a szûrõ
	kezében vannak.  Ezzel kapcsolatban azonban rossz
	hír, hogy ezeket a szûrõket
	<span class="emphasis"><em>nekünk</em></span> kell megírnunk.  A
	jó hír ellenben az, hogy könnyen
	találunk ilyen szûrõket, vagy ha éppen
	nem lelnénk valamelyiket, akkor is gyorsan meg tudjuk
	ezeket írni.</p><p>Sõt, a FreeBSD alapból tartalmaz is egyet, amit a
	<code class="filename">/usr/libexec/lpr/lpf</code> helyen találunk
	meg, és sok olyan nyomtatóval képes
	együttmûködni, amelyek nyers szöveget tudnak
	nyomtatni.  (Kezeli az állományokban
	felbukkanó törléseket és
	tabulálásokat, valamint képes
	nyilvántartást vezetni, de semmi többet.)
	Rajta kívül még számos
	szûrõt és szûrõelemet is
	találhatunk a FreeBSD
	Portgyûjteményében.</p><p>Lássuk, mit tartogat számunkra ez a
	rész:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A <a class="link" href="printing-advanced.html#printing-advanced-filters" title="9.4.1.1. Hogyan mûködnek a szûrõk?">Hogyan
	      mûködnek a szûrõk?</a>
	    címû szakaszban megpróbálunk
	    egyfajta áttekintést adni a szûrõk
	    nyomtatási folyamatban betöltött
	    szerepérõl.  Mindenképpen érdemes
	    elolvasnunk ezt a szakaszt, mivel ebben derül ki, hogy
	    valójában mi is történik a
	    <span class="quote">"<span class="quote">függöny mögött</span>"</span>, vagyis
	    amikor az <span class="application">LPD</span> használja
	    ezeket a szûrõket.  Ezzel a tudással el
	    tudjuk kerülni vagy éppen nyakon tudjuk
	    csípni azokat a problémákat, amelyek a
	    nyomtatóinkhoz telepített szûrõk
	    hozzáadása során
	    adódhatnak.</p></li><li class="listitem"><p>Az <span class="application">LPD</span> alapból arra
	    számít, hogy minden nyomtató
	    képes nyers szöveget nyomtatni.  Ez gondot okoz
	    a <span class="trademark">PostScript</span>(R) (és minden más nyelv
	    alapú) nyomtatók esetén, mivel azok nem
	    képesek nyers szöveget nyomtatni.  <a class="link" href="printing-advanced.html#printing-advanced-if-conversion" title="9.4.1.2. Szöveges nyomtatási feladatok PostScript(R) nyomtatókon"> Szöveges
	      nyomtatási feladatok <span class="trademark">PostScript</span>(R)
	      nyomtatókon</a> címû szakaszban
	    viszont fény derül rá, hogyan
	    kerekedjünk felül ezen.  Feltétlenül
	    olvassuk el, ha <span class="trademark">PostScript</span>(R) nyomtatónk van.</p></li><li class="listitem"><p>A <span class="trademark">PostScript</span>(R) számos program közkedvelt
	    kimeneti formátuma, sõt gyakran maguk a
	    felhasználók is szeretnek ilyen programokat
	    írni.  Sajnos azonban a <span class="trademark">PostScript</span>(R) nyomtatók
	    egyáltalán nem olcsók.  A <a class="link" href="printing-advanced.html#printing-advanced-ps" title="9.4.1.3. PostScript(R) szimulációja nem PostScript(R) nyomtatókon"><span class="trademark">PostScript</span>(R)
	      szimulációja nem <span class="trademark">PostScript</span>(R)
	      nyomtatókon</a> címû szakaszban
	    megtudhatjuk, miképp tudjuk úgy
	    módosítani a szûrõt, hogy
	    <span class="emphasis"><em>nem <span class="trademark">PostScript</span>(R)</em></span> nyomtatókon is
	    tudjunk <span class="trademark">PostScript</span>(R) programokkal nyomtatni.  Ezt a szakaszt
	    akkor érdemes elolvasni, ha nincs <span class="trademark">PostScript</span>(R)
	    nyomtatónk.</p></li><li class="listitem"><p>A <a class="link" href="printing-advanced.html#printing-advanced-convfilters" title="9.4.1.4. Konverziós szûrõk">Konverziós szûrõk</a>
	    címû szakaszban eláruljuk, miként
	    lehetséges automatizálni a
	    különbözõ
	    állományformátumok és a
	    nyomtatók által érthetõ
	    formátumok közti konverziókat, legyen az
	    grafikus vagy betûszedésre vonatkozó
	    adat.  A szakasz elolvasása során
	    megismerjük, hogyan tudjuk a nyomtatónkat
	    képessé tenni az
	    <code class="command">lpr -t</code> paranccsal troff
	    adatok, vagy a <code class="command">lpr -d</code>
	    paranccsal a <span class="application">TeX</span> DVI állományainak, esetleg
	    az <code class="command">lpr -v</code> paranccsal
	    raszteres képek nyomtatására és
	    így tovább.  Csak ajánlani tudjuk ennek
	    elolvasását.</p></li><li class="listitem"><p>A <a class="link" href="printing-advanced.html#printing-advanced-of" title="9.4.1.5. Kimeneti szûrõk">Kimeneti
	      szûrõk</a> címû szakaszban
	    kivesézzük az <span class="application">LPD</span>
	    egyik kevésbé használt
	    lehetõségét is, a kimeneti
	    szûrõket.  Hacsak nem fejléclapokat akarunk
	    készíteni (lásd <a class="link" href="printing-advanced.html#printing-advanced-header-pages" title="9.4.2. Fejléclapok">Fejléclapok</a>),
	    akkor ezt a szakaszt nyugodtan kihagyhatjuk.</p></li><li class="listitem"><p><a class="link" href="printing-advanced.html#printing-advanced-lpf" title="9.4.1.6. Az lpf szövegszûrõ">Az lpf
	      szövegszûrõ</a> szakaszban
	    bemutatásra kerül a FreeBSD-ben alapból
	    megtalálható <code class="command">lpf</code>
	    szûrõ, amely egy sornyomtatóknál
	    (vagy az így viselkedõ
	    lézernyomtatóknál)
	    használható egyszerû
	    szövegszûrõ.  Ha nyers szövegek
	    nyomtatásánál meg akarjuk oldani a
	    nyomtatási feladatok
	    nyilvántartását, vagy a
	    törlés karakter láttán a
	    nyomtatónk füstölni kezdene, akkor
	    mindenképpen érdemes belemerülnünk
	    az <code class="command">lpf</code> titkaiba.</p></li></ul></div><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">A most következõ szkriptek mindegyike
	  megtalálható a <code class="filename">/usr/share/examples/printing</code>
	  könyvtárban.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-filters"></a>9.4.1.1. Hogyan mûködnek a szûrõk?</h4></div></div></div><p>Ahogy már korábban is jeleztük, a
	  szûrõ egy olyan végrehajtható program,
	  amelyet az <span class="application">LPD</span> indít el,
	  amikor a nyomtatóval eszközfüggetlen
	  módon kommunikál.</p><p>Amikor az <span class="application">LPD</span> egy feladat
	  elvégzése során ki akar nyomtatni egy
	  állományt, akkor elindít egy ilyen
	  szûrõprogramot.  A szûrõ szabványos
	  bemenetére elküldi a kinyomtatandó
	  állományt, a szabványos kimenetét
	  a nyomtatóra, a szabványos hibajelzéseit
	  pedig egy naplóállományba
	  irányítja (ez utóbbit az
	  <code class="filename">/etc/printcap</code> állományban
	  az <code class="literal">lf</code> tulajdonsággal adhatjuk meg,
	  vagy alapértelmezés szerinti a
	  <code class="filename">/dev/console</code> állományba
	  kerül).</p><a id="idp82128080" class="indexterm"></a><p>Az <span class="application">LPD</span> a használni
	  kívánt szûrõt és annak
	  paramétereit az <code class="filename">/etc/printcap</code>
	  állományban felsoroltak vagy az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a>
	  parancssorában megadottak szerint választja ki.
	  Például, ha a felhasználó a
	  <code class="command">lpr -t</code> parancsot adja ki,
	  akkor az <span class="application">LPD</span> a
	  célként megadott nyomtatónál
	  szereplõ <code class="literal">tf</code> tulajdonság
	  által megadott troff szûrõt kezdi el
	  használni.  Amennyiben a felhasználó
	  egyszerûen csak nyers szöveget akar nyomtatni, akkor
	  az <code class="literal">if</code> szûrõnek kellene elindulnia
	  (ez viszont csak részben igaz: lásd <a class="link" href="printing-advanced.html#printing-advanced-of" title="9.4.1.5. Kimeneti szûrõk">Kimeneti szûrõk</a>).
	  </p><p>Háromfajta szûrõ jelenhet meg az
	  <code class="filename">/etc/printcap</code>
	  állományban:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A <span class="emphasis"><em>szövegszûrõ</em></span>
	      (text filter), ami a hagyományos szöveges
	      nyomtatásért felelõs, és amit az
	      <span class="application">LPD</span>
	      dokumentációjában érdekes
	      módon <span class="emphasis"><em>bemeneti
	      szûrõnek</em></span> (input filter)
	      hívnak.  Mivel az <span class="application">LPD</span>
	      arra számít, hogy minden nyomtató
	      alapból képes kinyomtatni bármilyen
	      nyers szöveget, ezért a
	      szövegszûrõ feladata, hogy a
	      nyomtató számára gondoskodjon a
	      tabulátorok, törlések és
	      más egyéb speciális karakterek
	      megfelelõ kezelésérõl.  Emellett
	      ha olyan helyen vagyunk, ahol szükség van a
	      nyomtatási feladatok
	      nyilvántartására is, a
	      szövegszûrõ ennek megoldására
	      is képes, méghozzá úgy, hogy
	      összeszámolja a kinyomtatott sorokat,
	      és elosztja ezeket a nyomtató által
	      oldalanként nyomtatott sorok
	      számával.  Egy szövegszûrõ a
	      következõ paraméterekkel indulhat:</p><div class="cmdsynopsis"><p><code class="command">szûrõnév</code> [-c]  -w
	      <em class="replaceable"><code>szélesség</code></em>   -l
	      <em class="replaceable"><code>hossz</code></em>   -i
	      <em class="replaceable"><code>behúzás</code></em>   -n
	      <em class="replaceable"><code>hozzáférés</code></em>   -h
	      <em class="replaceable"><code>gépnév</code></em>   <em class="replaceable"><code>nyilvántartás</code></em> </p></div><p>ahol a</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-c</code></span></dt><dd><p>akkor jelenik meg, ha egy nyomtatási feladatot az
		      <code class="command">lpr -l</code>
		      paranccsal adunk át</p></dd><dt><span class="term"><em class="replaceable"><code>szélesség</code></em></span></dt><dd><p>az <code class="filename">/etc/printcap</code>
		      állományban definiált
		      <code class="literal">pw</code> (page width, avagy
		      oldalszélesség) tulajdonság
		      értéke, ami
		      alapbeállítás szerint
		      132</p></dd><dt><span class="term"><em class="replaceable"><code>hossz</code></em></span></dt><dd><p>a <code class="literal">pl</code> (page length, avagy
		      oldalhossz) tulajdonság
		      értéke, amely az
		      alapbeállítás szerint
		      66</p></dd><dt><span class="term"><em class="replaceable"><code>behúzás</code></em></span></dt><dd><p>az <code class="command">lpr -i</code>
		      parancs megadása során használt
		      behúzás mértéke, ami
		      alapból 0</p></dd><dt><span class="term"><em class="replaceable"><code>hozzáférés</code></em></span></dt><dd><p>a nyomtatást végzõ
		      felhasználó
		      hozzáférésének
		      megnevezése</p></dd><dt><span class="term"><em class="replaceable"><code>gépnév</code></em></span></dt><dd><p>a gép neve, amirõl a
		      nyomtatási feladat érkezett</p></dd><dt><span class="term"><em class="replaceable"><code>nyilvántartás</code></em></span></dt><dd><p>ez a nyilvántartást
		      tároló állomány
		      <code class="literal">af</code> tulajdonsággal
		      definiált neve</p></dd></dl></div></li><li class="listitem"><a id="idp82169808" class="indexterm"></a><p>A <span class="emphasis"><em>konverziós
	      szûrõk</em></span> (conversion filter) egy adott
	      állományformátumot hoznak a
	      nyomtató számára értelmes
	      formára.  Például ditroff adatok
	      közvetlenül ugyan nem nyomtathatóak,
	      azonban a ditroff állományokhoz tudunk
	      telepíteni egy olyan szûrõt, amely a
	      ditroff adatokat a nyomtató számára
	      is emészthetõ és nyomtatható
	      formájúvá teszi.  A <a class="link" href="printing-advanced.html#printing-advanced-convfilters" title="9.4.1.4. Konverziós szûrõk">Konverziós
		szûrõk</a> címû szakasz tud
	      ezekrõl többet mondani.  Ilyen esetekben
	      kérhetünk nyilvántartást.  A
	      konverziós szûrõk az alábbi
	      paraméterekkel indulhatnak:</p><div class="cmdsynopsis"><p><code class="command">szûrõnév</code>  -x
	      <em class="replaceable"><code>pixelszélesség</code></em>   -y
	      <em class="replaceable"><code>pixelmagasság</code></em>   -n
	      <em class="replaceable"><code>hozzáférés</code></em>   -h
	      <em class="replaceable"><code>gépnév</code></em>   <em class="replaceable"><code>nyilvántartás</code></em> </p></div><p>ahol a
	      <em class="replaceable"><code>pixelszélesség</code></em> a
	      <code class="literal">px</code> tulajdonság
	      értékébõl (ami alapból
	      0), a <em class="replaceable"><code>pixelmagasság</code></em> a
	      <code class="literal">py</code> tulajdonság
	      értékébõl (ami alapból
	      szintén 0) származik.</p></li><li class="listitem"><p>A <span class="emphasis"><em>kimeneti szûrõ</em></span>
	      (output filter), ami csak akkor aktív, ha a
	      szövegszûrõ nem, vagy ha
	      engedélyeztük fejléclapok
	      nyomtatását.  Tapasztalatom szerint az ilyen
	      szûrõket ritkán használják.
	      A <a class="link" href="printing-advanced.html#printing-advanced-of" title="9.4.1.5. Kimeneti szûrõk">Kimeneti
		szûrõk</a> címû szakasz mutatja
	      be a mûködésüket.  Ekkor
	      csupán két paraméterünk
	      van:</p><div class="cmdsynopsis"><p><code class="command">szûrõnév</code>  -w
	      <em class="replaceable"><code>szélesség</code></em>   -l
	      <em class="replaceable"><code>hosszúság</code></em> </p></div><p>amik rendre megegyeznek a szövegszûrõk
	      <code class="option">-w</code> és <code class="option">-l</code>
	      paramétereivel.</p></li></ul></div><p>A szûrõk <span class="emphasis"><em>ki is tudnak
	  lépni</em></span> a következõ kódokkal
	  (exit status):</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">0</span></dt><dd><p>A szûrõ sikeresen kinyomtatta az
		állományt.</p></dd><dt><span class="term">1</span></dt><dd><p>A szûrõnek nem sikerült kinyomtatnia
		az állományt, azonban szeretné, ha
		az <span class="application">LPD</span> újból
		megpróbálkozna vele.  Az
		<span class="application">LPD</span> tehát ebben
		 az esetben újraindítja a
		szûrõt.</p></dd><dt><span class="term">2</span></dt><dd><p>A szûrõnek nem sikerült kinyomtatnia
		az állományt, és nem is
		kívánja újra
		megpróbálni.  Ekkor az
		<span class="application">LPD</span> eldobja az
		állományt.</p></dd></dl></div><p>A FreeBSD kiadásokban megtalálható
	  <code class="filename">/usr/libexec/lpr/lpf</code>
	  szövegszûrõ képes a kapott
	  szélesség és hossz paraméterekkel
	  megállapítani az oldaltöréseket
	  és a nyomtató használatát
	  nyilvántartani, amihez a
	  hozzáférés, gépnév
	  és nyilvántartás adatait használja
	  fel.</p><p>Amikor majd igyekszünk mellé újabb
	  szûrõket beszerezni, ne felejtsük el
	  ellenõrizni, hogy együtt tudnak-e mûködni
	  az <span class="application">LPD</span>-vel.  Ha a válasz
	  igen, akkor a fentebb említett paraméterek
	  mindegyikét ismerniük kell.  Az
	  általános használatra készült
	  szûrõk készítése során
	  mi magunknak is be kell tartanunk ezeket az
	  elvárásokat.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-if-conversion"></a>9.4.1.2. Szöveges nyomtatási feladatok <span class="trademark">PostScript</span>(R)
	  nyomtatókon</h4></div></div></div><a id="idp82206672" class="indexterm"></a><p>Ha csak egyedül dolgozunk a
	  számítógépen és
	  <span class="trademark">PostScript</span>(R) (vagy bármilyen más nyelvet
	  ismerõ) nyomtatónk van, valamint
	  megígérjük, hogy soha nem küldünk
	  sem mi, sem pedig nem küldetünk semmilyen más
	  programmal nyers szöveget a nyomtatóra, akkor
	  átléphetjük ezt a szakaszt.</p><p>Ha viszont egyaránt akarunk küldeni
	  <span class="trademark">PostScript</span>(R) programot és nyers szöveget
	  tartalmazó nyomtatási feladatot a
	  nyomtatónak, akkor ehhez kénytelenek vagyunk a
	  rendszerünket beállítani.
	  Elõször is szükségünk van
	  szövegszûrõre, ami megállapítja,
	  hogy a frissen érkezett nyomtatási feladat nyers
	  szöveget vagy <span class="trademark">PostScript</span>(R) programot tartalmaz-e.  Minden
	  <span class="trademark">PostScript</span>(R)-alapú feladat a <code class="literal">%!</code>
	  karaktersorozattal kezdõdik (a többi esetben
	  olvassuk a nyomtató leírását).
	  Szóval, ha a nyomtatandó állomány
	  elsõ két karaktere ilyen, akkor egy <span class="trademark">PostScript</span>(R)
	  programmal van dolgunk és közvetlenül
	  továbbküldhetjük a nyomtatási
	  feladatot a nyomtatónak.  Minden más esetben a
	  szûrõnek elõbb át kell alakítania
	  a szöveget <span class="trademark">PostScript</span>(R) nyelvre.</p><p>Hogyan érhetjük el mindezt?</p><a id="idp82216144" class="indexterm"></a><p>Ha soros nyomtatónk van, akkor erre a feladatra az
	  <code class="command">lprps</code> parancs tökéletes.  Az
	  <code class="command">lprps</code> egy olyan <span class="trademark">PostScript</span>(R)
	  szûrõ, amely mind a két irányban
	  képes közvetíteni.  Folyamatosan
	  rögzíti egy állományba a
	  nyomtató állapotát, így a
	  felhasználók és rendszergazdák
	  pontosan látják a nyomtató jelenlegi
	  állapotát (például
	  <span class="errorname">toner low</span> (a toner hamarosan kifogy)
	  vagy <span class="errorname">paper jam</span> (a papír
	  beragadt)).  Ami viszont sokkal lényegesebb, hogy a
	  <code class="command">psif</code> nevû program képes
	  megmondani az érkezõ nyomtatási feladat
	  valódi típusát, és ennek
	  megfelelõen meg tudja hívni nyers szöveg
	  átalakítására a
	  <code class="command">textps</code> (egy másik program, amit a
	  <code class="command">lprps</code> mellé kapunk) parancsot.
	  Ezután az <code class="command">lprps</code> elküldi a
	  feladatot a nyomtatónak.</p><p>Az <code class="command">lprps</code> a FreeBSD
	  Portgyûjteményének része
	  (lásd <a class="link" href="ports.html" title="4. fejezet - Alkalmazások telepítése: csomagok és portok">A
	  Portgyûjtemény</a>), ezért a
	  használni kívánt papír
	  méretétõl függõen pillanatok
	  alatt magunk is letölhetjük, fordíthatjuk
	  és telepíthetjük a <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/print/lprps-a4/pkg-descr">print/lprps-a4</a> és <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/print/lprps-letter/pkg-descr">print/lprps-letter</a> csomagok
	  valamelyikét.  Az <code class="command">lprps</code>
	  telepítése után egyszerûen csak
	  adjuk meg a <code class="command">psif</code> elérési
	  útvonalát.  Ha tehát
	  telepítettük a Portgyûjteménybõl
	  az <code class="command">lprps</code> csomagot, akkor egy soros portra
	  csatlakozó <span class="trademark">PostScript</span>(R) nyomtató esetén
	  ezt kell beírnunk az <code class="filename">/etc/printcap</code>
	  állományba:</p><pre class="programlisting">:if=<code class="filename">/usr/local/libexec/psif</code>:</pre><p>Ezenkívül még az <code class="literal">rw</code>
	  tulajdonsággal meg kell mondanunk az
	  <span class="application">LPD</span>-nek, hogy a nyomtatót
	  írásra és olvasásra nyissa
	  meg.</p><p>Amennyiben a <span class="trademark">PostScript</span>(R) nyomtatónk a
	  párhuzamos porton csatlakozik (és amiért
	  a nyomtatónk nem képes az
	  <code class="command">lprps</code> által igényelt
	  kétirányú kommunikációra),
	  szövegszûrõként a következõ
	  szkriptet fogjuk használni:</p><pre class="programlisting">#!/bin/sh
#
#  psif - PostScript vagy nyers szöveg nyomtatása PostScript nyomtatón
#  Ez a szkriptes változat, NEM pedig az lprps-hez mellékelt szûrõ
#  (a /usr/local/libexec/psif állomány)!
#

IFS="" read -r first_line
first_two_chars=`expr "$first_line" : '\(..\)'`

if [ "$first_two_chars" = "%!" ]; then
    #
    #  PostScript: nyomtassuk ki.
    #
    echo "$first_line" &amp;&amp; cat &amp;&amp; printf "\004" &amp;&amp; exit 0
    exit 2
else
    #
    #  Nyers szöveg: alakítsuk át, majd nyomtassuk ki.
    #
    ( echo "$first_line"; cat ) | /usr/local/bin/textps &amp;&amp; printf "\004" &amp;&amp; exit 0
    exit 2
fi</pre><p>A fentebb szereplõ szkriptben a
	  <code class="command">textps</code> programot használjuk a nyers
	  szövegek <span class="trademark">PostScript</span>(R) programokra
	  alakításához, de helyette
	  bármilyen más konvertáló programot
	  is igénybe vehetünk.  A FreeBSD
	  Portgyûjteményében (lásd <a class="link" href="ports.html" title="4. fejezet - Alkalmazások telepítése: csomagok és portok"> A Portgyûjtemény</a>)
	  találhatunk erre a célra egy
	  <code class="literal">a2ps</code> nevû programot is, amit esetleg
	  érdemes lehet közelebbrõl
	  megnéznünk.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-ps"></a>9.4.1.3. <span class="trademark">PostScript</span>(R) szimulációja nem <span class="trademark">PostScript</span>(R)
	  nyomtatókon</h4></div></div></div><a id="idp82237264" class="indexterm"></a><a id="idp82238416" class="indexterm"></a><p>A <span class="trademark">PostScript</span>(R) a magas színvonalú
	  betûszedés és nyomtatás <span class="emphasis"><em>de
	  facto</em></span> szabványa.  Emellett azonban a
	  <span class="trademark">PostScript</span>(R) egy <span class="emphasis"><em>költséges</em></span>
	  szabvány is.  Az Aladdin Enterprises-nak hála
	  azonban létezik egy hozzá hasonló szabad
	  szoftver, a <span class="application">Ghostscript</span>, amely
	  képes FreeBSD-n is futni.  A
	  <span class="application">Ghostscript</span> képes a
	  legtöbb <span class="trademark">PostScript</span>(R) állomány
	  olvasására, megjelenítésére
	  mindenféle eszközökön, beleértve
	  a <span class="trademark">PostScript</span>(R)et nem ismerõ nyomtatókat is.  A
	  <span class="application">Ghostscript</span> és egy
	  speciális szövegszûrõ
	  telepítésével el tudjuk érni, hogy
	  egy nem <span class="trademark">PostScript</span>(R) nyomtató valódi
	  <span class="trademark">PostScript</span>(R) nyomtatóként viselkedjen.</p><p>Ha telepíteni szeretnénk, a
	  <span class="application">Ghostscript</span>
	  megtalálható a FreeBSD
	  Portgyûjteményében.  Innen tehát
	  magunk is könnyedén le tudjuk tölteni,
	  fordítani és telepíteni.</p><p>A <span class="trademark">PostScript</span>(R) nyomtatás
	  szimulációjához elõször egy
	  szûrõ segítségével észre
	  kell vennünk, hogy egy <span class="trademark">PostScript</span>(R)
	  formátumú állományt
	  készülünk kinyomtatni.  Ha nem ilyen a
	  nyomtatási feladat, akkor egyenesen a nyomtatóra
	  küldjük, azonban minden más esetben
	  elõször a <span class="application">Ghostscript</span>
	  segítségével átalakítjuk
	  egy olyan formátumba, amit a nyomtató is
	  képes feldolgozni.</p><p>Nézzünk erre egy példát: a most
	  következõ szövegszûrõ a Hewlett
	  Packard DeskJet 500-as nyomtatóihoz
	  használható.  Más nyomtató
	  esetén cseréljük ki a <code class="command">gs</code>
	  (<span class="application">Ghostscript</span>) parancs
	  <code class="option">-sDEVICE</code> paraméterét a neki
	  megfelelõre.  (A telepített
	  <span class="application">Ghostscript</span> által ismert
	  nyomtatók listáját a
	  <code class="command">gs -h</code> paranccsal
	  kérdezhetjük le.)</p><pre class="programlisting">#!/bin/sh
#
#  ifhp - Ghostscripttel szimulált Postscript nyomtatás DeskJet 500-on
#  Helye: /usr/local/libexec/ifhp

#
#  LF karaktereket CR+LF-ként kezeljük (elkerülve ezzel a HP/PCL
#  nyomtatókon a "lépcsõzést"):
#
printf "\033&amp;k2G" || exit 2

#
#  Az állomány elsõ két karakterének beolvasása
#
IFS="" read -r first_line
first_two_chars=`expr "$first_line" : '\(..\)'`

if [ "$first_two_chars" = "%!" ]; then
    #
    #  Ez PostScript: küldjük át a Ghostscripten és nyomtassuk ki.
    #
    /usr/local/bin/gs -dSAFER -dNOPAUSE -q -sDEVICE=djet500 \
      -sOutputFile=- - &amp;&amp; exit 0
else
    #
    #  Nyers szöveg vagy HP/PCL, ezért küldjük át közvetlenül. Az utolsó
    #  lap kidobásához küldünk még egy lapdobást is.
    #
    echo "$first_line" &amp;&amp; cat &amp;&amp; printf "\033&amp;l0H" &amp;&amp;
exit 0
fi

exit 2</pre><p>Befejezésül az <code class="literal">if</code>
	  tulajdonságon keresztül
	  értesítenünk kell errõl a
	  szûrõrõl az <span class="application">LPD</span>-t
	  is:</p><pre class="programlisting">:if=<code class="filename">/usr/local/libexec/ifhp</code>:</pre><p>Készen is vagyunk!  Most már nyugodtan
	  beírhatjuk, hogy
	  <code class="command">lpr sima.szöveg</code>
	  vagy
	  <code class="command">lpr akármi.ps</code>,
	  mind a kettõnek ki kell tudnia
	  nyomtatódnia.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-convfilters"></a>9.4.1.4. Konverziós szûrõk</h4></div></div></div><p>Miután elvégeztük az <a class="link" href="printing-intro-setup.html#printing-simple" title="9.3.1. Alacsonyszintû nyomtatóbeállítás">Alacsonyszintû
	    nyomtatóbeállítás</a>
	  címû szakaszban leírt
	  beállításokat, a (nyers ASCII szöveg
	  mellett) kedvenc állományformátumainkhoz
	  is minden bizonnyal szeretnénk telepíteni
	  néhány konverziós
	  szûrõt.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82258896"></a>9.4.1.4.1. Miért használjunk konverziós
	    szûrõket?</h5></div></div></div><a id="idp82259536" class="indexterm"></a><p>A konverziós szûrõk
	    segítségével állományok
	    mindenféle formátumait könnyen ki tudjuk
	    nyomtatni.  Például tegyük fel, hogy
	    sokat dolgozunk a <span class="application">TeX</span> betûszedõ rendszerrel
	    és egy <span class="trademark">PostScript</span>(R) nyomtatónk van.  Minden
	    alkalommal, amikor egy DVI állományt hozunk
	    létre a <span class="application">TeX</span> forrásból, azt
	    közvetlenül még nem tudjuk a
	    nyomtatóra küldeni.  Ehhez a következõ
	    parancsokat kell kiadnunk:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>dvips hínár-elemzés.dvi</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>lpr hínár-elemzés.ps</code></strong></pre><p>Ha telepítünk egy konverziós
	    szûrõt a DVI állományokhoz, meg
	    tudjuk spórolni ezt a manuális
	    átalakítási lépést azzal,
	    hogy átadjuk ezt a feladatot az
	    <span class="application">LPD</span>-nek.  Így
	    ezután mindig, amikor egy DVI állományt
	    akarunk kinyomtatni, csupán egyetlen
	    lépésre lesz
	    szükségünk:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>lpr -d hínár-elemzés.dvi</code></strong></pre><p>Az <span class="application">LPD</span>-nek a
	    <code class="option">-d</code> paraméterrel adjuk meg, hogy a
	    nyomtatás elõtt hajtsa végre a DVI
	    átalakítását.  A <a class="link" href="printing-using.html#printing-lpr-options-format" title="9.5.4.1. Formázási és konverziós beállítások">Formázási
	      és konverziós
	      beállítások</a> címû
	    szakaszban találjuk meg a többi
	    konverziós opciót.</p><p>Minden olyan konverziós
	    beállításhoz, amit használni
	    szeretnénk a nyomtatóval,
	    telepítenünk kell egy
	    <span class="emphasis"><em>konverziós szûrõt</em></span>
	    (conversion filter) és meg kell adnunk a nevét
	    az <code class="filename">/etc/printcap</code>
	    állományban.  A konverziós
	    szûrõk az egyszerû
	    nyomtatóbeállításnál
	    szereplõ szövegszûrõkhöz
	    hasonlítanak (lásd <a class="link" href="printing-intro-setup.html#printing-textfilter" title="9.3.1.5.6. A szövegszûrõ telepítése">A szövegszûrõ
	      telepítése</a> szakasz) azzal a
	    kivétellel, hogy a nyers szövegek
	    kinyomtatása helyett ezek a szûrõk a
	    nyomtató számára értelmes
	    formátumra alakítják az
	    állományokat.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82277840"></a>9.4.1.4.2. Milyen konverziós szûrõket
	    érdemes telepíteni?</h5></div></div></div><p>Olyan konverziós szûrõket
	    telepítsünk, amelyekre gyakran
	    szükségünk lehet.  Ha például
	    sok DVI adatot szeretnénk nyomtatni a
	    jövõben, akkor használjunk DVI
	    konverziós szûrõt, vagy ha sok troff
	    formátumú adatot nyomtatunk, akkor minden
	    bizonnyal jól fog jönni egy troff
	    szûrõ.</p><p>A következõ táblázat foglalja
	    össze azokat a szûrõket, amelyekkel az
	    <span class="application">LPD</span> képes
	    együttmûködni.  Megtudhatjuk, hogy az
	    <code class="filename">/etc/printcap</code> állományban
	    melyik tulajdonság tartozik hozzájuk és
	    hogyan hívjuk meg ezeket az <code class="command">lpr</code>
	    paranccsal:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Állománytípus</th><th>Tulajdonság az
		    <code class="filename">/etc/printcap</code>
		    állományban</th><th>Az <code class="command">lpr</code>
		    kapcsolója</th></tr></thead><tbody><tr><td>cifplot</td><td><code class="literal">cf</code></td><td><code class="option">-c</code></td></tr><tr><td>DVI</td><td><code class="literal">df</code></td><td><code class="option">-d</code></td></tr><tr><td>plot</td><td><code class="literal">gf</code></td><td><code class="option">-g</code></td></tr><tr><td>ditroff</td><td><code class="literal">nf</code></td><td><code class="option">-n</code></td></tr><tr><td>FORTRAN forrás</td><td><code class="literal">rf</code></td><td><code class="option">-f</code></td></tr><tr><td>troff</td><td><code class="literal">tf</code></td><td><code class="option">-f</code></td></tr><tr><td>raster</td><td><code class="literal">vf</code></td><td><code class="option">-v</code></td></tr><tr><td>nyers szöveg</td><td><code class="literal">if</code></td><td>nincs, <code class="option">-p</code>, vagy
		    <code class="option">-l</code></td></tr></tbody></table></div><p>A példánkban tehát a
	    <code class="command">lpr -d</code> parancs
	    használata arra utal, hogy a nyomtatónak az
	    <code class="filename">/etc/printcap</code>
	    állományból a <code class="literal">df</code>
	    tulajdonságára van
	    szüksége.</p><a id="idp82313936" class="indexterm"></a><p>Minden hadakozás ellenére
	    állíthatjuk, hogy a FORTRAN források
	    és a plot által használt szövegek
	    formátuma napjainkra már elavultnak
	    tekinthetõ.  Ezért ezekhez az opciókhoz a
	    saját szûrõinkkel tetszõleges
	    formázási lehetõségeket
	    rendelhetünk.  Például, ha Printerleaf
	    (az Interleaf asztali kiadványszerkesztõ
	    formátuma) állományokat
	    szeretnénk közvetlenül nyomtatni, akkor
	    valószínûleg nem lesz
	    szükségünk plot állományokra.
	    Ezért a <code class="literal">gf</code> tulajdonságnak
	    megadhatunk egy Printerleaf konverziós
	    szûrõt, amelyen keresztül aztán a
	    felhasználók az
	    <code class="command">lpr -g</code> paranccsal
	    Printerleaf állományokat tudnak
	    nyomtatni.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82315728"></a>9.4.1.4.3. Konverziós szûrõk
	    telepítése</h5></div></div></div><p>Mivel a konverziós szûrõk az alap FreeBSD
	    rendszeren kívülre kerülnek, ezért
	    ezeket minden valószínûség szerint
	    valahol a <code class="filename">/usr/local</code>
	    könyvtárban találjuk meg.  Ezen
	    belül is általában a
	    <code class="filename">/usr/local/libexec</code>
	    könyvtárban fordulnak elõ, mivel ezeket
	    csak az <span class="application">LPD</span> futtatja, senki
	    másnak nincs rájuk
	    szüksége.</p><p>A konverziós szûrõk
	    aktiválásához az
	    <code class="filename">/etc/printcap</code> állományban
	    egyszerûen adjuk meg az alkalmas
	    tulajdonságoknak megfelelõ szûrõk
	    elérési útvonalait.</p><p>A példánkban most felveszünk egy DVI
	    konverziós szûrõt a
	    <code class="literal">bamboo</code> nevû nyomtatóhoz.  Itt
	    ismét láthatjuk a korábban
	    használt <code class="filename">/etc/printcap</code>
	    állományt, ahol most azonban a
	    <code class="literal">bamboo</code> nevû
	    nyomtatónál hozzáadtunk egy
	    <code class="literal">df</code> tulajdonságot:</p><pre class="programlisting">#
#  /etc/printcap (rose) -  egy df szûrõ hozzáadása a bamboo
#  nevû nyomtatóhoz
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<code class="filename">/var/spool/lpd/rattan</code>:\
        :lp=<code class="filename">/dev/lpt0</code>:\
        :if=<code class="filename">/usr/local/libexec/if-simple</code>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<code class="filename">/var/spool/lpd/bamboo</code>:\
        :lp=<code class="filename">/dev/ttyd5</code>:ms#-parenb cs8 clocal crtscts:rw:\
        :if=<code class="filename">/usr/local/libexec/psif</code>:\
        :df=<code class="filename">/usr/local/libexec/psdf</code>:</pre><p>A DVI szûrõ ebben az esetben a
	    <code class="filename">/usr/local/libexec/psdf</code> néven
	    elérhetõ aprócska szkript.  Ezt
	    találhatjuk benne:</p><pre class="programlisting">#!/bin/sh
#
#  psdf - DVI szûrõ PostScript nyomtatóhoz
#  Helye: /usr/local/libexec/psdf
#
# Az lpr -d parancs hatására hívódik meg
#
exec /usr/local/bin/dvips -f | /usr/local/libexec/lprps "$@"</pre><p>A szkript a <code class="command">dvips</code> parancsot
	    szûrõként futtatja (az <code class="option">-f</code>
	    paraméterrel) a szabványos bemenetrõl,
	    ahova a nyomtatási feladatot is kapja.  Ezután
	    elindítja az <code class="command">lprps</code> <span class="trademark">PostScript</span>(R)
	    szûrõt (lásd a <a class="link" href="printing-advanced.html#printing-advanced-if-conversion" title="9.4.1.2. Szöveges nyomtatási feladatok PostScript(R) nyomtatókon">Szöveges
	      nyomtatási feladatok <span class="trademark">PostScript</span>(R)
	      nyomtatókon</a> címû szakaszt) az
	    <span class="application">LPD</span> által átadott
	    paraméterekkel.  Az <code class="command">lprps</code> parancs
	    ezekkel a paraméterekkel tartja nyilván az
	    így kinyomtatott lapokat.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82337488"></a>9.4.1.4.4. További példák konverziós
	    szûrõkre</h5></div></div></div><p>A konverziós szûrõk
	    telepítésének nincs bevált
	    receptje, ezért ebben a szakaszban bemutatunk
	    rájuk néhány mûködõ
	    illusztrációt.  Ezeket tudjuk
	    felhasználni saját szûrõk
	    elkészítésére.  Vagy ha
	    megtehetjük, használjuk közvetlenül
	    ezeket.</p><p>Ebben a példa szkriptben Hewlett Packard LaserJet
	    III-Si nyomtatókhoz hozunk létre raszteres
	    (pontosabban GIF formátumú) konverziós
	    szûrõt:</p><pre class="programlisting">#!/bin/sh
#
#  hpvf - GIF állományokat konvertál át HP/PCL-be, majd kinyomtatja
#  Helye: /usr/local/libexec/hpvf

PATH=/usr/X11R6/bin:$PATH; export PATH
giftopnm | ppmtopgm | pgmtopbm | pbmtolj -resolution 300 \
    &amp;&amp; exit 0 \
    || exit 2</pre><p>Úgy mûködik, hogy a GIF
	    állományt elõször PNM (portable
	    anymap), utána PGM (portable graymap), majd PBM
	    (portable bitmap) formátumúra alakítja,
	    amibõl végül LaserJet/PCL-kompatibilis adat
	    lesz.</p><p>Ez lesz a hozzá tartozó
	    <code class="filename">/etc/printcap</code>
	    állomány:</p><pre class="programlisting">#
#  /etc/printcap (orchid)
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=<code class="filename">/dev/lpt0</code>:sh:sd=<code class="filename">/var/spool/lpd/teak</code>:mx#0:\
        :if=<code class="filename">/usr/local/libexec/hpif</code>:\
        :vf=<code class="filename">/usr/local/libexec/hpvf</code>:</pre><p>A most következõ szkript a groff
	    betûszedû rendszerbõl érkezõ
	    troff adatokat alakítja át a
	    <code class="literal">bamboo</code> nevû <span class="trademark">PostScript</span>(R)
	    nyomtató számára:</p><pre class="programlisting">#!/bin/sh
#
#  pstf - a groff troff adait alakítja PS-re, majd kinyomtatja
#  Helye: /usr/local/libexec/pstf
#
exec grops | /usr/local/libexec/lprps "$@"</pre><p>A szkript az <code class="command">lprps</code> parancs
	    segítségével kommunikál a
	    nyomtatóval.  Ha a nyomtatónk
	    párhuzamos porton csatlakozik, akkor helyette ezt a
	    szkriptet használjuk:</p><pre class="programlisting">#!/bin/sh
#
#  pstf - a groff troff adatait alakítja PS-re, majd kinyomtatja
#  Helye: /usr/local/libexec/pstf
#
exec grops</pre><p>Kész is!  A szûrõ
	    életrekeltéséhez mindössze ennyit
	    kell beillesztenünk az
	    <code class="filename">/etc/printcap</code>
	    állományba:</p><pre class="programlisting">:tf=<code class="filename">/usr/local/libexec/pstf</code>:</pre><p>Most pedig jöjjön a FORTRAN szerelmeseinek
	    szívét megmelengetõ szkript.  Ez egy
	    olyan szövegszûrõ, amely bármelyik
	    nyers szöveget közvetlenül kezelni
	    tudó nyomtató esetén mûködik.
	    A <code class="literal">teak</code> nevû nyomtatóhoz
	    helyezzük be:</p><pre class="programlisting">#!/bin/sh
#
# hprf - FORTRAN szövegszûrõ LaserJet 3si-hez
# Helye: /usr/local/libexec/hprf
#

printf "\033&amp;k2G" &amp;&amp; fpr &amp;&amp; printf "\033&amp;l0H" &amp;&amp;
 exit 0
exit 2</pre><p>Az <code class="filename">/etc/printcap</code>
	    állományban a <code class="literal">teak</code>
	    nyomtatóhoz a következõ sor
	    beírásával tudjuk engedélyezni
	    ezt a szûrõt:</p><pre class="programlisting">:rf=<code class="filename">/usr/local/libexec/hprf</code>:</pre><p>Most pedig következzen egy utolsó, de az
	    eddigieknél valamivel összetettebb példa.
	    Ebben a korábban bemutatott <code class="literal">teak</code>
	    nevû LaserJet nyomtatóhoz fogunk
	    hozzáadni egy DVI szûrõt.
	    Elõször is következzen a mûvelet
	    egyszerûbb része: bõvítsük ki
	    az <code class="filename">/etc/printcap</code>
	    állományt a DVI szûrõ
	    helyének megadásával:</p><pre class="programlisting">:df=<code class="filename">/usr/local/libexec/hpdf</code>:</pre><p>Ezután következzék a nehezebb
	    rész: a szûrõ
	    elkészítése.  Ehhez
	    szükségünk lesz egy DVI-rõl
	    LaserJet/PCL-re alakító programra.  A FreeBSD
	    Portgyûjteményében (lásd <a class="link" href="ports.html" title="4. fejezet - Alkalmazások telepítése: csomagok és portok">A Portgyûjtemény</a>)
	    találunk is egyet: a csomag neve <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/print/dvi2xx/pkg-descr">print/dvi2xx</a>.  A csomag
	    telepítésével megkapjunk a nekünk
	    kellõ <code class="command">dvilj2p</code> programot, ami
	    képes DVI-t LaserJet IIp, LaserJet III és a
	    LaserJet 2000 típusok által ismert
	    kódokra fordítani.</p><p>A <code class="command">dvilj2p</code>
	    felhasználásától
	    függetlenül a <code class="command">hpdf</code> néven
	    létrehozni kívánt szûrõnk
	    még így is bonyolult lesz, hiszen a
	    <code class="command">dvilj2p</code> nem tud olvasni a
	    szabványos bemenetrõl, hanem mindenáron
	    egy állománnyal akar dolgozni.  Sõt,
	    olyan állománnyal, amelynek
	    <code class="filename">.dvi</code> kiterjesztése van,
	    ezért még a <code class="filename">/dev/fd/0</code> (vagyis a
	    szabványos bemenethez tartozó
	    eszközleíró) használata is
	    akadályokba ütközik.</p><p>Üröm még az örömünkben,
	    hogy a <code class="filename">/tmp</code>
	    könyvtárat sem tudjuk felhasználni
	    ideiglenes link létrehozására: a
	    szimbolikus linkeket a <code class="systemitem">bin</code>
	    felhasználó és csoport birtokolja, a
	    szûrõt pedig a <code class="systemitem">daemon</code>
	    felhasználó futtatja.  A <code class="filename">/tmp</code> könyvtárban
	    rááadásul csak a tulajdonosaik
	    képesek állományokat átnevezni
	    vagy törölni (sticky bit).  Ezért a
	    szûrõ ugyan létre tudna hozni egy linket,
	    azonban ezt a feladata végeztével nem lesz
	    majd képes törölni, mivel a link egy
	    másik felhasználóhoz tartozik.</p><p>Ezért a szûrõ az aktuális
	    könyvtárban fogja létrehozni ezt a
	    szimbolikus linket, ami jelen esetünkben a
	    nyomtatási rendszer által használt
	    könyvtár lesz (ezt az
	    <code class="filename">/etc/printcap</code> állomány
	    <code class="literal">sd</code> tulajdonságával adjuk
	    meg).  Itt remekül el tudják végezni a
	    feladataikat a szûrõk, különösen
	    mivel (néha) több hely van itt, mint a <code class="filename">/tmp</code>
	    könyvtárban.</p><p>Végül lássuk magát a
	    szûrõt:</p><pre class="programlisting">#!/bin/sh
#
#  hpdf - DVI adat nyomtatása HP/PCL nyomtatón
#  Helye: /usr/local/libexec/hpdf

PATH=/usr/local/bin:$PATH; export PATH

#
#  Létrehozunk egy függvényt az átmeneti állományok törlésére. Ezek
#  az aktuális könyvtárban jönnek létre, ami pedig a nyomtatási
#  rendszer adott nyomtatóhoz tartozó könyvtára lesz.
#
cleanup() {
   rm -f hpdf$$.dvi
}

#
#  Létrehozunk egy függvényt a súlyos hibák kezelésére: írassunk ki
#  egy adott üzenetet és lépjünk ki a 2-es hibakóddal.  Ezzel üzenünk
#  az LPD-nek, hogy ne hajtsa végre újra a nyomtatási feladatot.
#
fatal() {
    echo "$@" 1&gt;&amp;2
    cleanup
    exit 2
}

#
#  Ha a felhasználó eltávolítja a nyomtatási feladatot a sorból, akkor az
#  LPD egy SIGINT jelzést fog küldeni, ezért próbáljuk meg azt elkapni
#  (néhány más egyéb jelzéssel együtt), így még tudjuk törölni az
#  ideiglenesen # létrehozott állományokat.
#
trap cleanup 1 2 15

#
#  Gondoskodjunk róla, hogy a feladat megkezdésekor még egyetlen
#  használt állomány sem létezik.
#
cleanup

#
#  Kössük össze a szabványos bemenetet egy DVI állománnyal (amit
#  majd nyomtatni akarunk).
#
ln -s /dev/fd/0 hpdf$$.dvi || fatal "Cannot symlink /dev/fd/0"

#
#  LF = CR+LF
#
printf "\033&amp;k2G" || fatal "Cannot initialize printer"

#
#  Alakítsuk át az adatot és nyomtassunk. A dvilj2p által visszaadott érték
#  nem túlságosan megbízható, ezért ne is foglalkozzunk vele.
#
dvilj2p -M1 -q -e- dfhp$$.dvi

#
#  Takarítsunk el magunk után és lépjünk ki szabályosan
#
cleanup
exit 0</pre></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-autoconv"></a>9.4.1.4.5. Automatikus konverziók: a konverziós
	    szûrõk helyett</h5></div></div></div><p>A konverziós szûrõk sokat
	    segítenek egy kényelmes nyomtatási
	    környezet kialakításában, azonban
	    a használatukhoz a felhasználóknak (az
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> parancson keresztül) egyenként
	    hivatkozniuk kell rájuk.  Ha a rendszerünk
	    felhasználói nem eléggé
	    mûveltek számítástechnikai
	    téren, akkor még egy szûrõ
	    megadása is zavaró lehet számukra.  Ami
	    még ennél is rosszabb, hogy egy rosszul
	    megadott szûrõ hatására a
	    nyomtató sem fogja jól kezelni az adott
	    állomány formátumát és
	    erre válaszul akár többszáz lapot
	    is pillanatok alatt kiköphet
	    magából.</p><p>A konverziós szûrõk
	    telepítése helyett gyakran csak egy
	    (alapértelmezett) szövegszûrõre van
	    szükségünk, amely kideríti a
	    nyomtatandó állomány pontos
	    formátumát és magától
	    elindítja a neki megfelelõ konverziós
	    szûrõt.  Ilyen esetekben például a
	    <code class="command">file</code> parancs pont a hasznunkra
	    válhat.  Persze <span class="emphasis"><em>bizonyos</em></span>
	    állománytípusok közt nagyon
	    nehéz különbséget tenni - de
	    ezekre továbbra is adhatunk még
	    külön konverziós szûrõket.</p><a id="idp82363984" class="indexterm"></a><a id="idp82364496" class="indexterm"></a><p>A FreeBSD Portgyûjteményében
	    találhatunk egy <code class="command">apsfilter</code>
	    elnevezésû szövegszûrõt
	    (<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/print/apsfilter/pkg-descr">print/apsfilter</a>), ami
	    képes ilyen automatikus konverzióra.
	    Képes felismerni a nyers szöveget, <span class="trademark">PostScript</span>(R)
	    programokat, DVI és szinte bármilyen
	    formátumú állományokat,
	    lefuttatni rájuk a megfelelõ
	    átalakításokat, majd kinyomtatni
	    ezeket.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-of"></a>9.4.1.5. Kimeneti szûrõk</h4></div></div></div><p>Az <span class="application">LPD</span> nyomtatási
	  rendszer kezel egy eddig még nem tárgyalt
	  szûrõtípust is: ez a kimeneti
	  szûrõ.  A kimeneti szûrõ a
	  szövegszûrõhöz hasonlóan csak nyers
	  szöveg nyomtatására használatos, de
	  tartalmaz néhány
	  egyszerûsítést.  Ha kizárólag
	  csak kimeneti szûrõket alkalmazunk, akkor:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Az <span class="application">LPD</span> az egész
	      nyomtatási feladathoz egyetlen kimeneti
	      szûrõt fog használni, nem pedig minden
	      állományhoz külön.</p></li><li class="listitem"><p>Az <span class="application">LPD</span> a kimeneti
	      szûrõ számára nem nyújt
	      semmilyen segítséget a nyomtatási feladaton
	      belül szereplõ állományok
	      kezdetének vagy végének
	      megállapításában.</p></li><li class="listitem"><p>Az <span class="application">LPD</span> a szûrõnek
	      nem adja át sem a felhasználó
	      hozzáférését, sem pedig
	      gépnevét, ezért
	      nyilvántartásra nem alkalmas.  Mindent
	      összegezve lényegében csak két
	      paramétert kap meg:</p><div class="cmdsynopsis"><p><code class="command">szûrõnév</code>  -w<em class="replaceable"><code>szélesség</code></em>   -l<em class="replaceable"><code>hossz</code></em> </p></div><p>ahol a
	      <em class="replaceable"><code>szélesség</code></em> a
	      kérdéses nyomtató
	      <code class="literal">pw</code>
	      tulajdonságából, a
	      <em class="replaceable"><code>hossz</code></em> pedig a
	      <code class="literal">pl</code> tulajdonságából
	      származik.</p></li></ul></div><p>Ne bûvöljön el minket a szûrõ
	  egyszerûsége!  Ha például a
	  nyomtatási feladatban minden állományt
	  újabb lapon szeretnénk kezdeni, akkor azt
	  kimeneti szûrõvel <span class="emphasis"><em>nem tudjuk
	  megoldani</em></span>.  Erre a célra használjunk
	  szövegszûrõt (másik nevén
	  bemeneti szûrõt), lásd <a class="link" href="printing-intro-setup.html#printing-textfilter" title="9.3.1.5.6. A szövegszûrõ telepítése">A szövegszûrõ
	    telepítése</a> szakaszt.
	  Továbbá, a kimeneti szûrõ
	  valójában <span class="emphasis"><em>sokkal
	  bonyolultabb</em></span> abban a tekintetben, hogy a
	  beérkezõ adatok közül neki kell
	  kikeresnie a speciális jelentéssel
	  bíró karaktereket ugyanúgy, ahogy az
	  <span class="application">LPD</span> helyett saját
	  magának kell küldenie a jelzéseket.</p><p>Azonban a kimeneti szûrõk használata
	  <span class="emphasis"><em>elkerülhetetlen</em></span>, ha
	  például fejléclapokat akarunk nyomtatni,
	  és esetleg még különbözõ
	  inicializálásra használatos
	  speciális kódokat vagy karakterláncokat
	  akarunk ez elõtt kiküldeni.  (Ellenben
	  <span class="emphasis"><em>badarság</em></span> a
	  fejléclapoktól követelni a
	  felhasználó adatait, hiszen az
	  <span class="application">LPD</span> a kimeneti szûrõnek
	  nem ad semmilyen erre vonatkozó
	  információt.)</p><p>Egyetlen nyomtató esetén az
	  <span class="application">LPD</span> egyaránt
	  lehetõvé teszi kimeneti, szöveg- és
	  más egyéb szûrõk
	  használatát.  Ilyenkor az
	  <span class="application">LPD</span> a kimeneti szûrõn
	  keresztül csak a fejlécet tartalmazó oldal
	  (lásd a <a class="link" href="printing-advanced.html#printing-advanced-header-pages" title="9.4.2. Fejléclapok">Fejléclapok</a>
	    szakaszt) nyomtatását indítja el.  Ezt
	  követõen az <span class="application">LPD</span> arra
	  számít, hogy a kimeneti szûrõ
	  két karakter, az ASCII 031 és az ezt
	  követõ ASCII 001, hatására
	  <span class="emphasis"><em>leállítja magát</em></span>.
	  Amikor tehát a kimeneti szûrõ
	  érzékeli ezt a két karaktert (031, 001),
	  akkor a <code class="literal">SIGSTOP</code> jelzéssel le kell
	  állnia.  Miután az
	  <span class="application">LPD</span> lefuttatta a többi
	  szûrõt, a <code class="literal">SIGCONT</code>
	  jelzéssel újraindítja a kimeneti
	  szûrõt.</p><p>Ha van kimeneti szûrõnk, de
	  <span class="emphasis"><em>nincs</em></span> szövegszûrõnk, akkor
	  az <span class="application">LPD</span> minden további
	  feldolgozás nélkül továbbadja a
	  nyomtatási feladatot a kimeneti szûrõnek.
	  Ahogy már korábban is említettük, a
	  kimeneti szûrõ a nyomtatási feladatban
	  levõ összes állományt egymás
	  után nyomtatja ki, lapdobások vagy
	  bármilyen más papírmozgatás
	  nélkül, ezért
	  valószínûleg <span class="emphasis"><em>nem</em></span> ez
	  kell nekünk.  Az esetek túlnyomó
	  részében ehhez elég egy
	  szövegszûrõ.</p><p>A korábban szövegszûrõként
	  beharangozott <code class="command">lpf</code> program kimeneti
	  szûrõként is képes
	  funkcionálni.  Ha szükségünk lenne egy
	  gyorsan összecsapható kimeneti szûrõre,
	  és nem akarunk a speciális karakterek, valamint a
	  jelzések küldésével elidõzni,
	  akkor próbálkozzunk az <code class="command">lpf</code>
	  használatával.  Az <code class="command">lpf</code>
	  parancsot mellesleg becsomagolhatjuk egy olyan szkriptbe is,
	  amely elvégzi a nyomtató számára
	  szükséges inicializálást.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-lpf"></a>9.4.1.6. Az <code class="command">lpf</code>
	  szövegszûrõ</h4></div></div></div><p>A FreeBSD bináris terjesztéséhez
	  mellékelt <code class="filename">/usr/libexec/lpr/lpf</code>
	  program egy szövegszûrõ (bemeneti
	  szûrõ), amely képes (az <code class="command">lpr
	  -i</code> paranccsal hozzáadott
	  nyomtatási feladatokat) tabulálni, (az
	  <code class="command">lpr -l</code> paranccsal felvett
	  nyomtatási feladatokban) a
	  vezérlõkaraktereket figyelemen kívül
	  hagyni, a nyomtatási feladatban elõforduló
	  törlések és behúzások
	  nyomtatási pozícióját
	  igazítani és nyilvántartani a
	  kinyomtatott lapokat.  Kimeneti szûrõként is
	  tud viselkedni.</p><p>Az <code class="command">lpf</code> szûrõ rengeteg
	  nyomtatási környezetben
	  felhasználható.  Habár nem képes a
	  nyomtatónak inicializáló jelsorozatokat
	  küldeni, mégis könnyû olyan szkriptet
	  írni, amely elvégzi ezeket a
	  hiányzó kezdeti
	  beállításokat, majd lefuttatja az
	  <code class="command">lpf</code> szûrõt.</p><a id="idp82408912" class="indexterm"></a><a id="idp82409424" class="indexterm"></a><p>Az <code class="command">lpf</code> akkor lesz képes helyesen
	  számolni a kinyomtatott lapokat, ha ehhez az
	  <code class="filename">/etc/printcap</code> állományban
	  jól töltjük ki a <code class="literal">pw</code>
	  és <code class="literal">pl</code> tulajdonságokat.  Ezen
	  értékek segítségével
	  határozható meg ugyanis, hogy mennyi szöveg
	  fért rá egy lapra és így mennyi
	  lapot emésztett fel az adott felhasználó
	  által küldött nyomtatási feladat.  A
	  nyomtatás nyilvántartásával
	  kapcsolatban <a class="link" href="printing-advanced.html#printing-advanced-acct" title="9.4.5. A nyomtató használatának nyilvántartása">A nyomtató használatának
	    nyilvántartása</a> címû
	  szakaszt érdemes elolvasni.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-header-pages"></a>9.4.2. Fejléclapok</h3></div></div></div><p>Ha <span class="emphasis"><em>nagyon sok</em></span>
	felhasználónk van, és sok
	különbözõ nyomtatót is
	használnak, akkor elõbb vagy utóbb minden
	bizonnyal elkerülhetetlenné fog válni a
	<span class="emphasis"><em>fejléclapok</em></span>
	használata.</p><a id="idp82415184" class="indexterm"></a><a id="idp82416464" class="indexterm"></a><p>A fejléc-, vagy más néven
	<span class="emphasis"><em>munka-</em></span> vagy
	<span class="emphasis"><em>elválasztó lapok</em></span>
	segítik elõ az elvégzett nyomtatási
	feladatok azonosítását.  A többi
	dokumentumtól eltérõ módon,
	általában dekoratív keretben, nagy, vastag
	betûkkel nyomtatódnak ki, hogy a halomnyi
	papír között a felhasználók
	könnyedén megtalálhassák az
	elküldött nyomtatási feladataik
	eredményét.  Természetesen a
	fejléclapok nyilvánvaló
	hátulütõje, hogy így minden
	nyomtatási feladathoz még egy lappal többet
	kell elhasználni és mivel gyakorlatilag
	néhány percnél tovább nincs is
	rájuk szükség, meglehetõsen hamar a
	kukába kerülnek.  (A fejléclapok
	nyomtatási feladatonként jönnek létre,
	nem pedig a nyomtatási feladatokban levõ
	állományokhoz egyenként, ezért nem
	is akkora pazarlás ez.)</p><p>Az <span class="application">LPD</span> rendszer képes
	magától fejléclapokat
	készíteni a nyomtatásokhoz,
	<span class="emphasis"><em>amennyiben</em></span> a nyomtatónk képes
	közvetlenül nyers szöveget nyomtatni.  Ha
	<span class="trademark">PostScript</span>(R) nyomtatónk van, akkor ennek
	legyártásához egy külsõ programra
	van szükségünk, lásd a <a class="link" href="printing-advanced.html#printing-advanced-header-pages-ps" title="9.4.2.4. Fejléclapok PostScript(R) nyomtatókon">Fejléclapok
	  <span class="trademark">PostScript</span>(R) nyomtatókon</a> szakaszt.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-header-pages-enabling"></a>9.4.2.1. A fejléclapok engedélyezése</h4></div></div></div><p>Az <a class="link" href="printing-intro-setup.html#printing-simple" title="9.3.1. Alacsonyszintû nyomtatóbeállítás">Alacsonyszintû
	    nyomtatóbeállítás</a>
	  címû szakaszban az
	  <code class="filename">/etc/printcap</code> állományban a
	  <code class="literal">sh</code> (úgy mint <span class="quote">"<span class="quote">suppress
	  header</span>"</span>) tulajdonsággal kikapcsoltuk a
	  fejléclapokat.  A fejléclapok
	  engedélyezéséhez mindössze el kell
	  távolítanunk ezt az <code class="literal">sh</code>
	  tulajdonságot.</p><p>Ez túl egyszerû, nemde?</p><p>Igen, ez így van.
	  <span class="emphasis"><em>Elõfordulhat</em></span>, hogy
	  szükségünk van még egy olyan kimeneti
	  szûrõre is, amely inicializáló
	  karaktereket küld a nyomtatónak.  Íme egy
	  példa ehhez a Hewlett Packard PCL-kompatibilis
	  nyomtatói esetére:</p><pre class="programlisting">#!/bin/sh
#
#  hpof - Kimeneti szûrõ Hewlett Packard PCL-kompatibilis nyomtatókhoz
#  Helye: /usr/local/libexec/hpof

printf "\033&amp;k2G" || exit 2
exec /usr/libexec/lpr/lpf</pre><p>Az <code class="literal">of</code> tulajdonsággal adjuk meg a
	  kimeneti szûrõt.  A <a class="link" href="printing-advanced.html#printing-advanced-of" title="9.4.1.5. Kimeneti szûrõk">Kimeneti
	    szûrõk</a> szakaszban errõl
	  részletesebben is olvashatunk.</p><p>A korábban ismertetett <code class="literal">teak</code>
	  nevû nyomtatóhoz most az alábbi minta
	  <code class="filename">/etc/printcap</code> állományt
	  mellékeljük.  Itt engedélyeztük a
	  fejléclapokat és hozzátettük az
	  iménti kimeneti szûrõt:</p><pre class="programlisting">#
#  /etc/printcap (orchid)
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=<code class="filename">/dev/lpt0</code>:sd=<code class="filename">/var/spool/lpd/teak</code>:mx#0:\
        :if=<code class="filename">/usr/local/libexec/hpif</code>:\
        :vf=<code class="filename">/usr/local/libexec/hpvf</code>:\
        :of=<code class="filename">/usr/local/libexec/hpof</code>:</pre><p>Mostantól kezdve, amikor a
	  felhasználók a <code class="literal">teak</code>
	  nyomtatón akarnak nyomtatni, minden nyomtatási
	  feladathoz kapni fognak egy fejléclapot.  Amennyiben a
	  kedves felhasználók mégis keresgetni
	  akarják a nyomtatásaikat, az <code class="command">lpr
	  -h</code> paranccsal tetszõleges
	  módon letilthatják azokat.  Az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a>
	  többi hasonló opcióját <a class="link" href="printing-using.html#printing-lpr-options-misc" title="9.5.4.3. A fejléclapok beállításai">A fejléclapokhoz
	    tartozó beállítások</a>
	  szakaszban találjuk.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Az <span class="application">LPD</span> minden
	    fejléclap után egy lapdobást küld.
	    Ha erre a célra a nyomtatónk egy
	    eltérõ karaktert vagy karaktersorozatot
	    használ, akkor azt az
	    <code class="filename">/etc/printcap</code> állomány
	    <code class="literal">ff</code> tulajdonságával
	    határozhatjuk meg.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-header-pages-controlling"></a>9.4.2.2. A fejléclapok vezérlése</h4></div></div></div><p>A fejléclapok engedélyezésével
	  az <span class="application">LPD</span> egy ún.
	  <span class="emphasis"><em>hosszú fejlécet</em></span> fog
	  készíteni, vagyis a felhasználót,
	  a gépet és a nyomtatási feladatot
	  jól azonosító, egész lapot
	  kitöltõ óriási betûket.  Erre egy
	  példa (amiben a <code class="systemitem">rose</code> nevû
	  géprõl <code class="systemitem">kelly</code> küldte az
	  <span class="quote">"<span class="quote">outline</span>"</span> elnevezésû
	  nyomtatási feladatot):</p><pre class="screen">      k                   ll       ll
      k                    l        l
      k                    l        l
      k   k     eeee       l        l     y    y
      k  k     e    e      l        l     y    y
      k k      eeeeee      l        l     y    y
      kk k     e           l        l     y    y
      k   k    e    e      l        l     y   yy
      k    k    eeee      lll      lll     yyy y
                                               y
                                          y    y
                                           yyyy


                                   ll
                          t         l        i
                          t         l
       oooo    u    u   ttttt       l       ii     n nnn     eeee
      o    o   u    u     t         l        i     nn   n   e    e
      o    o   u    u     t         l        i     n    n   eeeeee
      o    o   u    u     t         l        i     n    n   e
      o    o   u   uu     t  t      l        i     n    n   e    e
       oooo     uuu u      tt      lll      iii    n    n    eeee









      r rrr     oooo     ssss     eeee
      rr   r   o    o   s    s   e    e
      r        o    o    ss      eeeeee
      r        o    o      ss    e
      r        o    o   s    s   e    e
      r         oooo     ssss     eeee







                                              Job:  outline
                                              Date: Sun Sep 17 11:04:58 1995</pre><p>Ezt követõen az <span class="application">LPD</span>
	  elküld még egy lapdobást is, ezért
	  maga a nyomtatási feladat eredménye egy
	  új oldalon fog kezdõdni (kivéve, ha az
	  <code class="filename">/etc/printcap</code> állományban
	  az adott nyomtatóhoz tartozó bejegyzésben
	  megadtuk az <code class="literal">sf</code> (úgy mint
	  <span class="quote">"<span class="quote">suppress form feeds</span>"</span>, vagyis a lapdobások
	  letiltása) tulajdonságot.</p><p>Ha úgy jobban tetszik, akkor az
	  <code class="filename">/etc/printcap</code> állományban a
	  <code class="literal">sb</code> tulajdonsággal az
	  <span class="application">LPD</span> utasítható
	  <span class="emphasis"><em>rövid fejlécek</em></span>
	  készítésére is.  Ilyenkor a
	  fejléclap tartalma mindössze ennyi lesz:</p><pre class="screen">rose:kelly  Job: outline  Date: Sun Sep 17 11:07:51 1995</pre><p>Alapértelmezés szerint az
	  <span class="application">LPD</span> elõször a
	  fejléclapot, majd a nyomtatási feladatot
	  végzi el.  Ezt a sorrendet az
	  <code class="filename">/etc/printcap</code> állományban a
	  <code class="literal">hl</code> (header last) tulajdonsággal meg
	  tudjuk fordítani.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-header-pages-accounting"></a>9.4.2.3. A nyomtató használatának
	  nyilvántartása</h4></div></div></div><p>Az <span class="application">LPD</span> által
	  felkínált fejléclapok használata
	  során egyetlen irányelv
	  érvényesül a
	  nyilvántartásukban: a fejléclapok
	  <span class="emphasis"><em>költségmentesek</em></span>.</p><p>De miért?</p><p>Azért, mert kizárólag csak a kimeneti
	  szûrõ képes a fejléclapok
	  viselkedését irányítani, ami
	  viszont nem képes semmiféle
	  nyilvántartásra, hiszen nem kapja meg az ehhez
	  szükséges <span class="emphasis"><em>felhasználói-
	  vagy gépnév</em></span>
	  információkat, illetve
	  nyilvántartásokat.  Emiatt fogalma sincs
	  róla, hogy kit terhel az adott nyomtató
	  használata.  Úgy sem tudjuk megoldani a
	  problémát, ha a szöveg- vagy
	  konverziós szûrõkben (ahol már
	  rendelkezésünkre állnak a
	  felhasználó és a gépének
	  adatai) <span class="quote">"<span class="quote">növeljük a lapok számát
	  eggyel</span>"</span> a nyomtatási feladatban, mivel a
	  felhasználók az <code class="command">lpr
	  -h</code> parancs
	  használatával kedvük szerint
	  letilthatják a fejléclapokat.  Ezt ugyan
	  alapvetõen a természetet óvni
	  kívánó felhasználók
	  részesítik elõnyben, de ettõl
	  függetlenül sem erõszakolhatjuk rá
	  mindenkire.</p><p><span class="emphasis"><em>Az sem elég</em></span>, ha minden
	  szûrõ létrehozza a saját
	  fejlécét (amiért aztán
	  pénzt kérhetnénk).  Mivel ha a
	  felhasználók az
	  <code class="command">lpr -h</code>
	  paranccsal le akarják tiltani a fejlécek
	  használatát, attól a
	  szûrõkhöz még mindig
	  létrejönnek, hiszen az
	  <span class="application">LPD</span> a <code class="option">-h</code>
	  opcióról semmilyen
	  értesítést nem küld át a
	  szûrõknek.</p><p>Nos, ilyenkor mitévõk legyünk?</p><p>A lehetõségeink:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Elfogadjuk az <span class="application">LPD</span>
	      elvét, és nem számítunk fel
	      költséget a fejléclapokra.</p></li><li class="listitem"><p>Az <span class="application">LPD</span> helyett egy
	      másik nyomtatási rendszert
	      használunk, például az
	      <span class="application">LPRng</span> rendszert.  A <a class="link" href="printing-lpd-alternatives.html" title="9.6. Más nyomtatási rendszerek">Más
		nyomtatási rendszerek</a> címû
	      szakaszban kiderül, milyen alternatívák
	      érhetõek el az <span class="application">LPD</span>
	      kiváltására.</p></li><li class="listitem"><p>Írjunk mi magunk egy
	      <span class="emphasis"><em>intelligens</em></span> kimeneti
	      szûrõt.  Normális esetben a kimeneti
	      szûrõk nem valók másra,
	      csupán a nyomtató alaphelyzetbe
	      hozására vagy egyszerûbb
	      karakterkonverziók
	      elvégzésére.  Fejléclapokhoz
	      és nyers szöveget tartalmazó
	      nyomtatási feladathoz remekül
	      használható (ahol nincs szöveg- (avagy
	      bemeneti) szûrõ).  Azonban ha a nyers
	      szövegekhez van szövegszûrõnk, akkor
	      az <span class="application">LPD</span> a kimeneti
	      szûrõt csak a fejléclapokhoz
	      indítja el.  Emellett a kimeneti szûrõ az
	      <span class="application">LPD</span> által
	      generált fejléc szövegébõl
	      képes megmondani, melyik
	      felhasználóhoz és géphez
	      tartozik a szóbanforgó fejléc.  A
	      módszer egyetlen bökkenõje, hogy a
	      nyilvántartásokat tároló
	      állományról viszont még
	      így se tudunk semmilyen információt
	      szerezni (mivel nem kapjuk meg az <code class="literal">af</code>
	      tulajdonsággal beállított
	      állomány nevét).  Ha azonban egy
	      rendszerszinten elérhetõ
	      állományba mentjük ezeket az adatokat,
	      akkor akár bele is drótozhatjuk ezt a
	      kimeneti szûrõbe.  A kimeneti szûrõnek
	      az adatok megtalálásában ilyenkor
	      úgy tudunk segíteni, ha az
	      <code class="filename">/etc/printcap</code>
	      állományban az <code class="literal">sh</code>
	      (rövid fejléc) tulajdonságot
	      állítjuk be.  De ez igazából
	      sok hûhó semmiért, és a
	      felhasználók is jobban megbecsülik az
	      olyan nagylelkû rendszergazdát, aki nem
	      számítja fel nekik a
	      fejléclapokat.</p></li></ul></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-header-pages-ps"></a>9.4.2.4. Fejléclapok <span class="trademark">PostScript</span>(R)
	  nyomtatókon</h4></div></div></div><p>Ahogy arról már korábban is
	  szó esett, az <span class="application">LPD</span>
	  képes többféle nyomtató
	  számára is megfelelõ, nyers
	  szövegû fejléclapokat
	  készíteni.  Persze a <span class="trademark">PostScript</span>(R)
	  közvetlenül nem képes nyers szövegek
	  nyomtatására, ezért az
	  <span class="application">LPD</span> ezen lehetõsége
	  lényegében használhatatlan -
	  többnyire.</p><p>Ilyen helyzetben a fejléclapok
	  használatának nyilvánvaló
	  módja, hogy minden szövegszûrõt
	  fejlécek gyártására
	  utasítunk.  Ezek a szûrõk a
	  felhasználóról és a
	  gépérõl kapott
	  információkból össze tudják
	  állítani a megfelelõ fejléclapot.  A
	  megoldás hátránya, hogy ez még
	  olyankor is megtörténik, amikor a
	  felhasználók az
	  <code class="command">lpr -h</code> paranccsal
	  küldik a nyomtatási feladataikat.</p><p>Kísérletezzünk egy kicsit ezzel a
	  módszerrel!  A most következõ szkript
	  három paramétert fogad el (a
	  felhasználó hozzáférést, a
	  gép és a nyomtatási feladat
	  nevét), majd ezekbõl létrehoz egy
	  egyszerû <span class="trademark">PostScript</span>(R) formátumú
	  fejlécet:</p><pre class="programlisting">#!/bin/sh
#
#  make-ps-header - PostScript fejléc létrehozása a szabvány kimenetre
#  Helye: /usr/local/libexec/make-ps-header
#

#
#  Ezek itt a PostScript által használt egységekben vannak megadva
#  (72/col vagy 28/cm).  Írjuk át az általunk használt papírméretre,
#  A4-re vagy amit éppen használunk:
#
page_width=612
page_height=792
border=72

#
#  A paraméterek ellenõrzése.
#
if [ $# -ne 3 ]; then
    echo "Usage: `basename $0` &lt;user&gt; &lt;host&gt; &lt;job&gt;" 1&gt;&amp;2
    exit 1
fi

#
#  Mentsük el ezeket, leginkább az olvashatóság miatt.
#
user=$1
host=$2
job=$3
date=`date`

#
#  Küldjük el a PostScript-kódot a szabványos kimenetre.
#
exec cat &lt;&lt;EOF
%!PS

%
%  Gondoskodjunk róla, hogy ne zavarjuk az utánunk következõ
%  felhasználó nyomtatási feladatának végrehajtását.
%
save

%
%  Csináljunk egy csúf vastag szegélyt, körbe a papíron.
%
$border $border moveto
$page_width $border 2 mul sub 0 rlineto
0 $page_height $border 2 mul sub rlineto
currentscreen 3 -1 roll pop 100 3 1 roll setscreen
$border 2 mul $page_width sub 0 rlineto closepath
0.8 setgray 10 setlinewidth stroke 0 setgray

%
%  Jelenítsük meg a felhasználó azonosítóját szép, feltûnõ
%  betûkkel.
%
/Helvetica-Bold findfont 64 scalefont setfont
$page_width ($user) stringwidth pop sub 2 div $page_height 200 sub moveto
($user) show

%
%  Most pedig mutassuk az unalmas részleteket.
%
/Helvetica findfont 14 scalefont setfont
/y 200 def
[ (Job:) (Host:) (Date:) ] {
200 y moveto show /y y 18 sub def }
forall

/Helvetica-Bold findfont 14 scalefont setfont
/y 200 def
[ ($job) ($host) ($date) ] {
        270 y moveto show /y y 18 sub def
} forall

%
% Ennyi lett volna.
%
restore
showpage
EOF</pre><p>Ezzel a szkripttel pedig mindegyik konverziós
	  és szövegszûrõ elõször
	  létrehoz egy fejléclapot, majd elvégzi a
	  felhasználó nyomtatási feladatát.
	  Íme egy korábban már bemutatott DVI
	  szûrõ, amit most kiegészítünk a
	  fejléclapok használatával:</p><pre class="programlisting">#!/bin/sh
#
#  psdf - DVI szûrõ PostScript nyomtatóhoz
#  Helye: /usr/local/libexec/psdf
#
#  Az lpr -d parancs hatására hívódik meg.
#

orig_args="$@"

fail() {
    echo "$@" 1&gt;&amp;2
    exit 2
}

while getopts "x:y:n:h:" option; do
    case $option in
        x|y)  ;; # Ignore
        n)    login=$OPTARG ;;
        h)    host=$OPTARG ;;
        *)    echo "LPD started `basename $0` wrong." 1&gt;&amp;2
              exit 2
              ;;
    esac
done

[ "$login" ] || fail "No login name"
[ "$host" ] || fail "No host name"

( /usr/local/libexec/make-ps-header $login $host "DVI File"
  /usr/local/bin/dvips -f ) | eval /usr/local/libexec/lprps $orig_args</pre><p>Láthatjuk, hogy a szûrõnek a
	  felhasználói- és a gépnév
	  megállapításához végig kell
	  néznie a paraméterek listáját.  Ez
	  lényegében minden más konverziós
	  szûrõnél ugyanígy néz ki.  Ez a
	  lista azonban a szövegszûrõk esetén
	  némileg eltér (lásd a <a class="link" href="printing-advanced.html#printing-advanced-filters" title="9.4.1.1. Hogyan mûködnek a szûrõk?">Hogyan mûködnek
	    a szûrõk?</a> szakaszt).</p><p>Már az elõbbiekben is tárgyaltuk, hogy
	  ez a megoldás, habár eléggé
	  egyszerû, az <code class="command">lpr</code> számára
	  nem teszi lehetõvé a fejléclapok
	  letiltását (a <code class="option">-h</code> opció).
	  Ha a felhasználóink kímélni
	  akarják a fákat (vagy meg akarják
	  úszni a fejléclapok égbeszökõ
	  költségeit), akkor ezt nem tudják megtenni,
	  hiszen a szûrõk minden nyomtatási feladathoz
	  készíteni fognak fejléceket.</p><p>Ezt a korlátozást csak úgy tudjuk
	  elsöpörni, ha bevetjük a <a class="link" href="printing-advanced.html#printing-advanced-header-pages-accounting" title="9.4.2.3. A nyomtató használatának nyilvántartása">A
	    nyomtató használatának
	    nyilvántartása</a> szakaszban leírt
	  cselt, tehát készítünk egy olyan
	  kimeneti szûrõt, amely megkeresi az LPD-vel
	  generált fejléceket és létrehozza
	  azok <span class="trademark">PostScript</span>(R) változatát.  Ha valaki az
	  <code class="command">lpr -h</code> paranccsal
	  küld nyomtatnivalót, akkor
	  <span class="application">LPD</span> nem készít
	  hozzá fejléclapot, ahogy a kimeneti
	  szûrõnk sem.  A kimeneti szûrõ minden
	  más esetben beolvassa az <span class="application">LPD</span>
	  által küldött szöveget és
	  átküldi a neki megfelelõ <span class="trademark">PostScript</span>(R)
	  kódot a nyomtatóra.</p><p>Ha soros <span class="trademark">PostScript</span>(R) nyomtatónk van, akkor
	  használhatjuk a <code class="command">psof</code> kimeneti
	  szûrõhöz tartozó
	  <code class="command">lprps</code> parancsot is, ami pontosan az
	  elõbbit végzi el.  Hozzátennénk
	  azonban, hogy a <code class="command">psof</code> nem számolja a
	  fejléclapokat.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-network-printers"></a>9.4.3. Hálózati nyomtatás</h3></div></div></div><a id="idp82485200" class="indexterm"></a><a id="idp82523344" class="indexterm"></a><p>A FreeBSD tud hálozaton is nyomtatni, vagyis tud
	távoli számítógépeknek is
	nyomtatási feladatot küldeni.  A
	hálózati nyomtatás kifejezés
	általánosságban véve két
	különbözõ dologra utalhat:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Egy távoli
	    számítógéphez kapcsolt
	    nyomtató hozzáférését.  A
	    géphez a nyomtató a hagyományos soros
	    vagy párhuzamos csatolófelületen
	    keresztül kapcsolódik, amit aztán az
	    <span class="application">LPD</span> alkalmas
	    beállításával a
	    hálózaton mindenki számára
	    elérhetõvé teszünk.  A <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Távoli számítógépekre csatlakoztatott nyomtatók">Távoli
	      számítógépekre csatlakoztatott
	      nyomtatók</a> címû szakasz
	    errõl szól.</p></li><li class="listitem"><p>Egy közvetlenül a hálózatra
	    kapcsolt nyomtató
	    hozzáférését.  A nyomtató
	    tehát rendelkezik még egy
	    hálózati csatlakozással is a
	    hagyományos soros vagy párhuzamos felület
	    mellett (vagy éppen helyett).  Egy ilyen
	    nyomtató a következõképpen
	    mûködhet:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Elfogadja az <span class="application">LPD</span>
		kéréseit, és még
		képes nyomtatási feladatokat is
		tárolni.  Ebben az esetben teljesen
		egyenértékû egy
		<span class="application">LPD</span> alkalmazást
		futtató
		számítógéppel.  Ekkor nincs
		más teendõnk, csak követnünk kell
		a <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Távoli számítógépekre csatlakoztatott nyomtatók">Távoli
		  számítógépeken
		  telepített nyomtatók</a>
		címû szakasz
		utasításait.</p></li><li class="listitem"><p>Hálózati adatfolyamokkal dolgozik.
		Ebben az esetben a nyomtatót <span class="quote">"<span class="quote">hozzá
		kell kapcsolnunk</span>"</span> a hálózaton
		található egyik
		számítógéphez, ami majd a
		nyomtatási feladatok
		tárolásáért és
		folyamatos küldéséért lesz
		felelõs.  A <a class="link" href="printing-advanced.html#printing-advanced-network-net-if" title="9.4.3.2. Nyomtatók hálózati adatcsatlakozással">Nyomtatók
		  hálózati adatcsatlakozással</a>
		szakasz az ilyen fajtájú nyomtatók
		telepítésére tesz
		néhány javaslatot.</p></li></ul></div></li></ul></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-network-rm"></a>9.4.3.1. Távoli számítógépekre
	  csatlakoztatott nyomtatók</h4></div></div></div><p>Az <span class="application">LPD</span> nyomtatási
	  rendszer alapból képes más,
	  szintén <span class="application">LPD</span>-t (vagy vele
	  kompatibilis rendszert) futtató
	  számítógépekre nyomtatási
	  feladatokat küldeni.  Ezzel lényegében az
	  egyik géphez hozzá tudunk kapcsolni egy
	  nyomtatót, amit aztán a többiek
	  számára elérhetõvé
	  teszünk.  Ez olyan nyomtatók esetében is
	  mûködik, amelyek ismerik az
	  <span class="application">LPD</span> által alkalmazott
	  protokollt.</p><p>A távoli nyomtatáshoz elõször
	  telepítsük a nyomtatót valamelyik
	  számítógépre az <a class="link" href="printing-intro-setup.html#printing-simple" title="9.3.1. Alacsonyszintû nyomtatóbeállítás">Alacsonyszintû
	    nyomtatóbeállítás</a>
	  szakaszban leírtak szerint, és ezzel az lesz a
	  <span class="emphasis"><em>nyomtatószerverünk</em></span>.
	  Ezután, amennyiben szükségesnek
	  találjuk, végezzünk <a class="link" href="printing-advanced.html" title="9.4. Magasszintû nyomtatóbeállítás">magasabb szintû
	    nyomtatóbeállítások</a>at is.
	  Ne felejtsük el kipróbálni a
	  nyomtatón, hogy rendesen mûködik az
	  <span class="application">LPD</span> mindegyik olyan
	  beállításával, amit
	  engedélyeztünk.  Emellett gondoskodjunk minden
	  olyan jogosultságról is, amivel a
	  <span class="emphasis"><em>helyi
	  számítógéprõl</em></span> el
	  tudjuk érni a <span class="emphasis"><em>távoli
	  számítógép</em></span> által
	  felkínált <span class="application">LPD</span>
	  szolgáltatást (lásd <a class="link" href="printing-advanced.html#printing-advanced-restricting-remote" title="9.4.4.4. Távoli számítógépekrõl érkezõ kérések szabályozása">Távoli
	    számítógépekrõl
	    érkezõ kérések
	    szabályozása</a>).</p><a id="idp82566608" class="indexterm"></a><a id="idp82571984" class="indexterm"></a><p>Ha olyan nyomtatót használunk, aminek a
	  hálózati felülete kompatibilis az
	  <span class="application">LPD</span> rendszerrel, akkor az
	  elõbb említett
	  <span class="emphasis"><em>nyomtatószerver</em></span>
	  lényegében maga lesz a nyomtató, valamint
	  a <span class="emphasis"><em>nyomtató neve</em></span> a rajta
	  beállított név.  Ezzel kapcsolatban
	  olvassuk el a nyomtatóhoz és/vagy a
	  hálózati csatolójához
	  mellékelt dokumentációt.</p><div xmlns="" class="tip"><h3 class="admontitle">Tipp: </h3><p xmlns="http://www.w3.org/1999/xhtml">Amikor a Hewlett Packard Laserjet típusú
	    nyomtatóit használjuk, a
	    <code class="literal">text</code> nevû nyomtatónév
	    magától elvégzi a LF és CRLF
	    formátumú sortörések közti
	    átalakítást, ezért ilyenkor
	    nincs szükségünk a
	    <code class="filename">hpif</code> szkriptre.</p></div><p>Ezután ha szeretnénk más gépek
	  részére is elérhetõvé tenni a
	  frissen telepített nyomtatónkat, adjuk meg
	  mindegyikük <code class="filename">/etc/printcap</code>
	  állományában a
	  következõket:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Tetszõlegesen választott nevet,
	      álneveket.  Az egyszerûség
	      kedvéért azonban itt érdemes
	      ugyanazokat a neveket választani, mint amit a
	      nyomtatószerveren is használunk.</p></li><li class="listitem"><p>Szándékosan hagyjuk az
	      <code class="literal">lp</code> tulajdonságot üresen
	      (<code class="literal">:lp=:</code>).</p></li><li class="listitem"><p>Hozzunk létre egy nyomtatási
	      könyvtárat, és jelöljük meg a
	      helyét az <code class="literal">sd</code>
	      tulajdonsággal.  Az <span class="application">LPD</span>
	      itt fogja összegyûjteni a nyomtatási
	      feladatokat, mielõtt elküldené azokat a
	      nyomtatószervernek.</p></li><li class="listitem"><p>Adjuk meg a nyomtatószerver nevét az
	      <code class="literal">rm</code> tulajdonság
	      segítségével.</p></li><li class="listitem"><p>Az <code class="literal">rp</code> tulajdonsággal adjuk
	      meg a <span class="emphasis"><em>nyomtatószerverre</em></span>
	      csatlakoztatott nyomtató nevét.</p></li></ol></div><p>Kész!  Az <code class="filename">/etc/printcap</code>
	  állományban már nem kell megadni
	  konverziós szûrõket,
	  oldalbeállításokat és semmi
	  más egyebet.</p><p>Lássunk mindezekre egy példát.  A
	  <code class="systemitem">rose</code> nevû
	  számítógéphez két
	  nyomtató csatlakozik, a <code class="literal">bamboo</code>
	  és a <code class="literal">rattan</code>.  Most pedig
	  beállítjuk, hogy az <code class="systemitem">orchid</code>
	  nevû gép felhasználói képesek
	  legyenek ezekkel a nyomtatókkal dolgozni.  Ekkor a most
	  következõk szerint fog kinézni az
	  <code class="systemitem">orchid</code> (a <a class="link" href="printing-advanced.html#printing-advanced-header-pages-enabling" title="9.4.2.1. A fejléclapok engedélyezése">
	    Fejléclapok engedélyezése</a>
	  szakaszban bemutatott) <code class="filename">/etc/printcap</code>
	  állománya.  Tartalmazza a
	  <code class="literal">teak</code> nevû nyomtató
	  beállításait is, és ehhez fogjuk
	  hozzáadni a <code class="systemitem">rose</code> másik
	  két nyomtatóját:</p><pre class="programlisting">#
#  /etc/printcap (orchid) - a rose két (távoli) nyomtatójának
#  hozzáadása
#

#
#  A "teak" egy helyi nyomtató, közvetlenül az orchidhoz
#  csatlakozik:
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=<code class="filename">/dev/lpt0</code>:sd=<code class="filename">/var/spool/lpd/teak</code>:mx#0:\
        :if=<code class="filename">/usr/local/libexec/ifhp</code>:\
        :vf=<code class="filename">/usr/local/libexec/vfhp</code>:\
        :of=<code class="filename">/usr/local/libexec/ofhp</code>:

#
#  A "rattan" rose-hoz csatlakozik, így küldhetünk neki nyomtatási
#  feladatot:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=<code class="filename">/var/spool/lpd/rattan</code>:

#
#  A "bamboo" is a rose-hoz tartozik:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=<code class="filename">/var/spool/lpd/bamboo</code>:</pre><p>Ezután már csak létre kell hoznunk a
	  megfelelõ nyomtatási könyvtárakat az
	  <code class="systemitem">orchid</code> nevû gépen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir -p /var/spool/lpd/rattan /var/spool/lpd/bamboo</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chmod 770 /var/spool/lpd/rattan /var/spool/lpd/bamboo</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chown daemon:daemon /var/spool/lpd/rattan /var/spool/lpd/bamboo</code></strong></pre><p>Mostantól kezdve az <code class="systemitem">orchid</code>
	  felhasználói képesek lesznek nyomtatni a
	  <code class="literal">rattan</code> és <code class="literal">bamboo</code>
	  nevû nyomtatókon is.  Ezért, ha az
	  <code class="systemitem">orchid</code> egyik felhasználója
	  beírja, hogy:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>lpr -P bamboo -d sushi-leírás.dvi</code></strong></pre><p>Az <code class="systemitem">orchid</code> gépen
	  mûködõ <span class="application">LPD</span> rendszer
	  ezt a nyomtatási feladatot a bemásolja a
	  <code class="filename">/var/spool/lpd/bamboo</code>
	  nevû nyomtatási könyvtárba és
	  feljegyzi róla, hogy a nyomtatásához DVI
	  szûrõre lesz szükség.  Ahogy
	  <code class="systemitem">rose</code> gépen található
	  <code class="literal">bamboo</code> nyomtatási
	  könyvtárában elegendõ hely keletkezik,
	  a két <span class="application">LPD</span>
	  átküldi egymás közt a
	  <code class="systemitem">rose</code> nevû gépre az
	  állományt.  Ezután az
	  állomány egészen addig várakozik a
	  <code class="systemitem">rose</code> nyomtatási sorában,
	  amíg végezetül kinyomtatásra nem
	  kerül.  A <code class="systemitem">rose</code> fogja
	  átalakítani DVI-rõl <span class="trademark">PostScript</span>(R)
	  formátumra átalakítani (mivel a
	  <code class="literal">bamboo</code> egy <span class="trademark">PostScript</span>(R)
	  nyomtató).</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-network-net-if"></a>9.4.3.2. Nyomtatók hálózati
	  adatcsatlakozással</h4></div></div></div><p>Amikor hálózati kártyát
	  vásárolunk a nyomtatónkhoz,
	  általában két változatukkal
	  találkozhatunk: az egyikük nyomtatási
	  rendszerként mûködik (ez a
	  drágább), a másikuk pedig egyszerûen
	  csak soros vagy párhuzamos csatlakozón
	  továbbítandó adatként
	  közvetíti az adatokat a nyomtató
	  felé (az olcsóbb).  A drágábbik
	  változatot az elõzõ, <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Távoli számítógépekre csatlakoztatott nyomtatók">Távoli
	    számítógépekre csatlakoztatott
	    nyomtatók</a> címû szakaszban
	  leírtak szerint tudjuk használni.</p><p>Az <code class="filename">/etc/printcap</code>
	  állományban ugyan meg tudjuk adni, hogy a
	  nyomtató soros vagy párhuzamos portra
	  csatlakozik, és azon keresztül milyen
	  adatátviteli sebességgel (amennyiben soros),
	  forgalomirányítással,
	  tabulálással, sortörési
	  konvenció szerint stb.  kommunikáljunk vele.
	  Azonban TCP/IP vagy más hálózati porton
	  ülõ nyomtatók adatait itt nem tudjuk
	  kifejteni.</p><p>A hálózatra kötött
	  nyomtatók használatához
	  lényegében egy olyan külön
	  kifejlesztett kommunikációs programra van
	  szükségünk, amely a szöveg- vagy
	  konverziós szûrõkhöz hasonló
	  módon hívható meg.  Erre rögtön
	  adunk is egy példát: a
	  <code class="command">netprint</code> szkript a szabványos
	  bemenetrõl beolvassa az összes kinyomtatandó
	  adatot és átküldi azokat a
	  hálózatra csatlakoztatott nyomtatónak.  A
	  szkript elsõ paramétereként a
	  nyomtató hálózati nevét adjuk meg,
	  másodiknak pedig portot.  Azonban megjegyezzünk,
	  hogy ez csak egyirányú
	  kommunikációt tesz lehetõvé (a
	  FreeBSD-tõl a nyomtatóig).  Sok
	  hálózati nyomtató viszont két
	  irányban is képes kommunikálni,
	  ezért érdemes lehet ezt kihasználni (a
	  nyomtató állapotának
	  lekérdezésére,
	  nyilvántartások
	  készítésére stb).</p><pre class="programlisting">#!/usr/bin/perl
#
#  netprint - A hálózatra csatlakoztatott nyomtató szövegszûrõje
#  Helye: /usr/local/libexec/netprint
#
$#ARGV eq 1 || die "Usage: $0 &lt;printer-hostname&gt; &lt;port-number&gt;";

$printer_host = $ARGV[0];
$printer_port = $ARGV[1];

require 'sys/socket.ph';

($ignore, $ignore, $protocol) = getprotobyname('tcp');
($ignore, $ignore, $ignore, $ignore, $address)
    = gethostbyname($printer_host);

$sockaddr = pack('S n a4 x8', &amp;AF_INET, $printer_port, $address);

socket(PRINTER, &amp;PF_INET, &amp;SOCK_STREAM, $protocol)
    || die "Can't create TCP/IP stream socket: $!";
connect(PRINTER, $sockaddr) || die "Can't contact $printer_host: $!";
while (&lt;STDIN&gt;) { print PRINTER; }
exit 0;</pre><p>Rengeteg szûrõben fel tudjuk használni
	  ezt a szkriptet.  Például tegyük fel, hogy
	  egy Diablo 750-N típusú sornyomtatót
	  csatlakoztattunk a hálózatra, amely az 5100-as
	  porton várja a nyomtatandó adatokat.  A
	  hálózati neve most <code class="systemitem">scrivener</code>
	  lesz.  Íme a hozzá tartozó
	  szövegszûrõ:</p><pre class="programlisting">#!/bin/sh
#
#  diablo-if-net - Az 5100-as porton figyelõ `scrivener' nevû Diablo
#  nyomtató szövegszûrõje. Helye: /usr/local/libexec/diablo-if-net
#
exec /usr/libexec/lpr/lpf "$@" | /usr/local/libexec/netprint scrivener 5100</pre></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-restricting"></a>9.4.4. A nyomtató használatának
	szabályozása</h3></div></div></div><a id="idp82629712" class="indexterm"></a><p>Ebben a szakaszban a nyomtató
	használatának
	korlázásáról írunk.  Az
	<span class="application">LPD</span> rendszeren keresztül
	meghatározhatjuk, hogy ki képes helyben vagy
	távolról hozzáférni a
	nyomtatóhoz, mennyi másolatot nyomtathat, mennyi
	és egyenként mekkora nyomtatási feladatokat
	küldhet.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-restricting-copies"></a>9.4.4.1. A másolatok számának
	  szabályozása</h4></div></div></div><p>Az <span class="application">LPD</span>
	  segítségével a felhasználók
	  egy állományt könnyen ki tudnak nyomtatni
	  akár többször is.  Ha (például)
	  a felhasználó egy nyomtatási feladat
	  kiküldéséhez az <code class="command">lpr
	  -#5</code> parancsot használja,
	  akkor a nyomtatási feladatban levõ összes
	  állományból öt
	  példányt kap.  Ennek
	  létjogosultságát azonban nekünk kell
	  megítélni.</p><p>Amennyiben úgy érezzük, hogy a
	  további példányok
	  készítése csupán felesleges
	  papír- és tintapazarlás, akkor az
	  <code class="literal">sc</code> tulajdonság
	  megadásával az
	  <code class="filename">/etc/printcap</code> állományban
	  kikapcsolhatjuk az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> <code class="option">-#</code>
	  lehetõség használatát.  Így
	  amikor a felhasználók a <code class="option">-#</code>
	  kapcsolóval küldenek el feladatokat a
	  nyomtatóra, a következõt fogják
	  tapasztalni:</p><pre class="screen">lpr: multiple copies are not allowed</pre><p>Fordítása:</p><pre class="screen">lpr: másolatok nyomtatása nem engedélyezett</pre><p>Vigyázzunk arra, hogy ha távoli
	  számítógépen zajlik a
	  nyomtatás (lásd <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Távoli számítógépekre csatlakoztatott nyomtatók">Távoli
	    számítógépekre csatlakoztatott
	    nyomtatók</a>), akkor az <code class="literal">sc</code>
	  tulajdonságot a távoli
	  számítógép
	  <code class="filename">/etc/printcap</code>
	  állományában is be kell
	  állítani, máskülönben a
	  felhasználók egy másik
	  számítógéprõl mindig
	  képesek lesznek több példány
	  nyomtatására.</p><p>Nézzünk erre egy példát.  Itt
	  most a <code class="systemitem">rose</code> nevû
	  számítógép
	  <code class="filename">/etc/printcap</code>
	  állományát vesszük szemügyre.
	  Ebben a <code class="literal">rattan</code> egy nagyon
	  szívélyes nyomtató lesz, ezért
	  engedélyezi a másolatok
	  nyomtatását, azonban a <code class="literal">bamboo</code>
	  nevû lézernyomtató nála már
	  sokkal válogatósabb lesz, ezért a
	  beállításai közt az
	  <code class="literal">sc</code> tulajdonsággal kikapcsoljuk a
	  másodpéldányok
	  nyomtatását:</p><pre class="programlisting">#
#  /etc/printcap (rose) - A másolatok korlátozása a "bamboo"
#  nevû nyomtatón
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<code class="filename">/var/spool/lpd/rattan</code>:\
        :lp=<code class="filename">/dev/lpt0</code>:\
        :if=<code class="filename">/usr/local/libexec/if-simple</code>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<code class="filename">/var/spool/lpd/bamboo</code>:sc:\
        :lp=<code class="filename">/dev/ttyd5</code>:ms#-parenb cs8 clocal crtscts:rw:\
        :if=<code class="filename">/usr/local/libexec/psif</code>:\
        :df=<code class="filename">/usr/local/libexec/psdf</code>:</pre><p>Az <code class="literal">sc</code> tulajdonságot az
	  <code class="systemitem">orchid</code> <code class="filename">/etc/printcap</code>
	  állományában is meg kell adni (és
	  ha már itt vagyunk, akkor tegyük meg ugyanezt a
	  <code class="literal">teak</code> esetében is):</p><pre class="programlisting">#
#  /etc/printcap (orchid) - Nincsenek másodpéldányok sem a helyi
#  "teak" nyomtatón, sem pedig a távoli "bamboo" nyomtatón
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=<code class="filename">/dev/lpt0</code>:sd=<code class="filename">/var/spool/lpd/teak</code>:mx#0:sc:\
        :if=<code class="filename">/usr/local/libexec/ifhp</code>:\
        :vf=<code class="filename">/usr/local/libexec/vfhp</code>:\
        :of=<code class="filename">/usr/local/libexec/ofhp</code>:

rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=<code class="filename">/var/spool/lpd/rattan</code>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=<code class="filename">/var/spool/lpd/bamboo</code>:sc:</pre><p>Az <code class="literal">sc</code> tulajdonság
	  használatával ugyan megakadályozzuk az
	  <code class="command">lpr -#</code> parancs
	  teljesítését, azonban ez még
	  mindig nem óv meg minket attól, hogy a
	  felhasználók képesek legyenek
	  többször egymás után lefuttatni az
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> parancsot, vagy éppen egyetlen
	  nyomtatási feladatban több állományt
	  is elküldeni:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>lpr forsale.sign forsale.sign forsale.sign forsale.sign forsale.sign</code></strong></pre><p>Számos módszer kínálkozik az
	  effajta visszaélések
	  kivédésére (beleértve a figyelmen
	  kívül hagyást is), lehet velük
	  kísérletezgetni!</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-restricting-access"></a>9.4.4.2. A nyomtatók
	  hozzáférésének
	  szabályozása</h4></div></div></div><p>A <span class="trademark">UNIX</span>(R) csoportkezelésével és az
	  <code class="filename">/etc/printcap</code> állományban
	  található <code class="literal">rg</code>
	  tulajdonság felhasználásával
	  korlátozni tudjuk, ki milyen nyomtatón
	  dolgozhat.  Ehhez mindössze annyit kell tennünk,
	  hogy besoroljuk egy csoportba azokat a
	  felhasználókat, amelyek
	  hozzáférhetnek a nyomtatóhoz, és
	  az <code class="literal">rg</code> tulajdonsággal
	  megnevezzük azt.</p><p>A csoporton kívüli
	  felhasználókat (köztük magát a
	  <code class="systemitem">root</code> felhasználót is) pedig
	  ezután így üdvözli a rendszer, ha
	  megpróbálnak valamit kinyomtatni egy
	  korlátozott felhasználású
	  nyomtatón:</p><pre class="screen">lpr: Not a member of the restricted group</pre><p>Az üzenet fordítása:</p><pre class="screen">lpr: Nem jogosult felhasználó</pre><p>Ha erre a távoli
	  számítógépek esetén
	  szükségünk lenne (lásd <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Távoli számítógépekre csatlakoztatott nyomtatók">Távoli
	    számítógépekre csatlakoztatott
	    nyomtatók</a>), akkor tegyük ugyanazt, mint
	  amit az <code class="literal">sc</code> (a
	  másodpéldányok letiltása,
	  <span class="quote">"<span class="quote">suppress multiple copies</span>"</span>) tulajdonság
	  esetén is, vagyis az <code class="literal">rg</code>
	  tulajdonságot adjuk meg azokon a távoli
	  számítógépeken is, amelyek
	  hozzá tudnak férni a megosztott
	  nyomtatóhoz.</p><p>Például megengedjük, hogy a
	  <code class="literal">rattan</code> nevû nyomtatót
	  bárki használhassa, azonban a
	  <code class="literal">bamboo</code> nyomtatót csak az
	  <code class="systemitem">artists</code> nevû csoport
	  használhatja.  Következzen hát akkor a
	  <code class="systemitem">rose</code> korábbról már
	  ismert <code class="filename">/etc/printcap</code>
	  állománya:</p><pre class="programlisting">#
#  /etc/printcap (rose) - A bamboo hozzáférésének korlátozása
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<code class="filename">/var/spool/lpd/rattan</code>:\
        :lp=<code class="filename">/dev/lpt0</code>:\
        :if=<code class="filename">/usr/local/libexec/if-simple</code>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<code class="filename">/var/spool/lpd/bamboo</code>:sc:rg=artists:\
        :lp=<code class="filename">/dev/ttyd5</code>:ms#-parenb cs8 clocal crtscts:rw:\
        :if=<code class="filename">/usr/local/libexec/psif</code>:\
        :df=<code class="filename">/usr/local/libexec/psdf</code>:</pre><p>Most ne bántsuk a másik (az
	  <code class="systemitem">orchid</code> nevû gépen levõ)
	  <code class="filename">/etc/printcap</code> állományt.
	  Így persze az <code class="systemitem">orchid</code> bármelyik
	  felhasználója nyomtathat a
	  <code class="literal">bamboo</code> nyomtatón.  De ez most egy
	  olyan eset, ahol egyébként lekorlátozzuk
	  a <code class="systemitem">orchid</code> elérését is,
	  ezért az ott beengedett felhasználók
	  már akár használhatják is a
	  nyomtatót.  Vagy sem.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Minden nyomtatóhoz csak egy ilyen csoportot
	    adhatunk meg.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-restricting-sizes"></a>9.4.4.3. A beküldött nyomtatási feladatok
	  méretének szabályozása</h4></div></div></div><a id="idp82682960" class="indexterm"></a><p>Ha sok felhasználó szeretne a
	  nyomtatóinkhoz hozzáférni, akkor minden
	  bizonnyal meg akarunk adni egy felsõ határt a
	  felhasználók által beküldhetõ
	  nyomtatások méretére vonatkozóan.
	  Mivel a nyomtatási könyvtáraknak otthont
	  adó állományrendszer is egyszer betelhet,
	  ezért mindenképpen érdemes gondoskodni
	  arról, hogy mindenki nyomtatási feladatát
	  el tudjuk rendesen tárolni.</p><a id="idp82683856" class="indexterm"></a><p>Az <span class="application">LPD</span> az <code class="literal">mx</code>
	  tulajdonsággal lehetõséget ad arra, hogy
	  lekorlátozzuk a nyomtatási feladatokban
	  található egyes állományok
	  méretét.  Ennek
	  mértékegysége egy
	  <code class="literal">BUFSIZ</code> blokk, ami pedig 1024 byte.  Ha
	  értékül nullát adunk meg, akkor
	  nincs korlátozás, viszont ha semmit sem
	  rögzítünk, akkor az <code class="literal">mx</code>
	  tulajdonság alapértéke, vagyis 1000 blokk
	  lesz a határ.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ez az érték a nyomtatási
	    feladatokban levõ <span class="emphasis"><em>egyes
	    állományok</em></span> méretére
	    vonatkozik, <span class="emphasis"><em>nem</em></span> pedig a
	    nyomtatási feladatok teljes
	    méretére.</p></div><p>Fontos tudni, hogy az <span class="application">LPD</span> nem
	  dobja vissza a méreten felüli
	  állományokat.  Ehelyett a méret alatti
	  részt szépen berakja a sorba és
	  kinyomtatja, a többi pedig elhagyja.  Lehetne rajta
	  vitázni, hogy ez mennyire helyes cselekedet.</p><p>Példaképpen definiáljunk a
	  korábban használt <code class="literal">rattan</code>
	  és <code class="literal">bamboo</code> nyomtatóinkhoz
	  ilyen korlátokat.  Mivel az
	  <code class="systemitem">artists</code> csoport tagjai hajlamosak nagy
	  <span class="trademark">PostScript</span>(R) állományokat küldeni,
	  ezért most lekorlátozzuk ezt öt
	  megabyte-ra.  A szöveges nyomtatónk esetén
	  azonban nem lesz semmilyen határ:</p><pre class="programlisting">#
#  /etc/printcap (rose)
#

#
#  Itt nincs korlát a nyomtatási feladatokra:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:mx#0:sd=<code class="filename">/var/spool/lpd/rattan</code>:\
        :lp=<code class="filename">/dev/lpt0</code>:\
        :if=<code class="filename">/usr/local/libexec/if-simple</code>:

#
#  Öt megabyte a PostScript:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<code class="filename">/var/spool/lpd/bamboo</code>:sc:rg=artists:mx#5000:\
        :lp=<code class="filename">/dev/ttyd5</code>:ms#-parenb cs8 clocal crtscts:rw:\
        :if=<code class="filename">/usr/local/libexec/psif</code>:\
        :df=<code class="filename">/usr/local/libexec/psdf</code>:</pre><p>Ismét hozzátesszük, hogy ezek a
	  korlátok csak a helyi felhasználókra
	  vonatkoznak.  Amennyiben távolról is el lehet
	  érni ezt a nyomtatót, a távoli
	  felhasználókat nem fog semmilyen
	  korlátozás érinteni.  Azokon a
	  számítógépeken is meg kell adnunk
	  az <code class="filename">/etc/printcap</code>
	  állományban az <code class="literal">mx</code>
	  tulajdonságot.  Ehhez a <a class="link" href="printing-advanced.html#printing-advanced-network-rm" title="9.4.3.1. Távoli számítógépekre csatlakoztatott nyomtatók">Távoli
	    számítógépekre csatlakoztatott
	    nyomtatók</a> címû szakaszban
	  találunk segítséget.</p><p>Van még egy speciális módszer, amivel
	  képesek vagyunk szabályozni a
	  távolról érkezõ
	  kérések méretét.  Errõl a
	  <a class="link" href="printing-advanced.html#printing-advanced-restricting-remote" title="9.4.4.4. Távoli számítógépekrõl érkezõ kérések szabályozása">Távoli
	    számítógépekrõl
	    érkezõ kérések
	    szabályozása</a> szakaszban
	  olvashatunk.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-restricting-remote"></a>9.4.4.4. Távoli
	  számítógépekrõl
	  érkezõ kérések
	  szabályozása</h4></div></div></div><p>Az <span class="application">LPD</span> nyomtatási
	  rendszer több módot is szolgáltat a
	  távolról érkezõ nyomtatási
	  feladatok szabályozására:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Az elérés
	      szabályozása</span></dt><dd><p>Az <code class="filename">/etc/hosts.equiv</code> és
		<code class="filename">/etc/hosts.lpd</code>
		állományok
		segítségével
		beállíthatjuk, hogy mely távoli
		számítógépektõl
		fogadjon el kéréseket az
		<span class="application">LPD</span>.  Az
		<span class="application">LPD</span> minden
		kérés elfogadásakor ellenõrzi,
		hogy a küldõ
		számítógép címe
		szerepel-e az említett állományok
		valamelyikében.  Ha nem, akkor az
		<span class="application">LPD</span> visszautasítja a
		kérést.</p><p>A két állomány
		felépítése egyszerû, mert
		bennük minden sorban egy-egy hálózati
		nevet adunk meg.  Hozzátennénk azonban,
		hogy legyünk óvatosak, mivel az
		<code class="filename">/etc/hosts.equiv</code>
		állományt az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ruserok&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">ruserok</span>(3)</span></a> protokoll is
		használja, ezért ennek
		módosítása hatással van az
		<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rsh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rsh</span>(1)</span></a> és <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rcp</span>(1)</span></a> programok
		mûködésére.</p><p>Például most nézzük meg a
		<code class="systemitem">rose</code>
		<code class="filename">/etc/hosts.lpd</code>
		állományát:</p><pre class="programlisting">orchid
violet
madrigal.fishbaum.de</pre><p>Ennek megfelelõen tehát a
		<code class="systemitem">rose</code> elfogadja az
		<code class="systemitem">orchid</code>, <code class="systemitem">violet</code>
		és <code class="systemitem">madrigal.fishbaum.de</code> nevû
		távoli számítógépek
		kéréseit.  Ha bármilyen más
		gép próbál hozzáférni
		a <code class="systemitem">rose</code> által
		felkínált <span class="application">LPD</span>
		szolgáltatáshoz,
		visszautasítja.</p></dd><dt><span class="term">A méret szabályozása</span></dt><dd><p>Szabályozhatjuk többek közt azt is,
		hogy mennyi szabad területnek kell fennmaradnia a
		nyomtatási könyvtárnak otthont
		adó állományrendszeren.  A helyi
		nyomtató könyvtárában ehhez
		hozzunk létre egy <code class="filename">minfree</code>
		nevû állományt.  Ide írjuk be,
		mennyi szabad lemezblokk (512 byte-os egység a
		lemezen) szükségeltetik egy
		távolról beérkezõ nyomtatási
		feladat fogadásához.</p><p>Így gondoskodhatunk róla, hogy a
		távoli felhasználók nem
		fogják eltömíteni az
		állományrendszerünket, illetve ezzel
		egyúttal adhatunk némi elõnyt a helyi
		felhasználóknak is: õk ugyanis
		még azután is képesek lesznek
		nyomtatási feladatokat küldeni a
		nyomtatónak, miután az
		állományrendszeren található
		szabad terület mennyisége már
		rég a <code class="filename">minfree</code>
		állományban szereplõ
		érték alá csökkent.</p><p>Példaként most a
		<code class="literal">bamboo</code> nevû nyomtatónkhoz
		adjunk meg egy ilyen <code class="filename">minfree</code>
		állományt.  Ehhez az
		<code class="filename">/etc/printcap</code>
		állományból tudjuk
		kideríteni a hozzá tartozó
		nyomtatási könyvtárat.  Lássuk
		tehát belõle a <code class="literal">bamboo</code>
		bejegyzését:</p><pre class="programlisting">bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<code class="filename">/var/spool/lpd/bamboo</code>:sc:rg=artists:mx#5000:\
        :lp=<code class="filename">/dev/ttyd5</code>:ms#-parenb cs8 clocal crtscts:rw:mx#5000:\
        :if=<code class="filename">/usr/local/libexec/psif</code>:\
        :df=<code class="filename">/usr/local/libexec/psdf</code>:</pre><p>A nyomtatási könyvtárat az
		<code class="literal">sd</code> tulajdonság
		határozza meg.  Úgy állítjuk
		most be, hogy az <span class="application">LPD</span>
		számára a távoli nyomtatási
		feladatok fogadásához ebben a
		könyvtárban legalább három
		megabyte (6144 blokk) szabad területnek mindig
		lennie kell:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>echo 6144 &gt; /var/spool/lpd/bamboo/minfree</code></strong></pre></dd><dt><span class="term">A felhasználók
	      szabályozása</span></dt><dd><p>Az <code class="filename">/etc/printcap</code>
		állományban megadható
		<code class="literal">rs</code> tulajdonság
		segítségével korlátozhatjuk
		a helyi nyomtatókhoz hozzáférni
		képes távoli felhasználókat.
		Amikor az <code class="literal">rs</code> tulajdonság
		szerepel egy helyben csatlakozó nyomtató
		leírásánál, akkor az
		<span class="application">LPD</span> csak abban az esetben
		fogad el távoli
		felhasználóktól nyomtatási
		feladatot, <span class="emphasis"><em>ha</em></span> az adott feladatot
		küldõ felhasználónak ugyanazon a
		néven van a helyi gépen is
		hozzáférése.
		Máskülönben az
		<span class="application">LPD</span> vissza fogja
		utasítani a kérést.</p><p>Ez a tulajdonság különösen
		fontos olyan környezetben, ahol
		(például) több szervezeti
		egység használ egyetlen közös
		hálózatot és bizonyos
		felhasználók képesek
		átlépni szervezeti egységük
		határait, mivel ha a
		hozzáférést adunk nekik a
		rendszereinkhez, akkor képesek a saját
		helyükrõl használni ezeket.  Ha
		ehelyett <span class="emphasis"><em>csupán</em></span> a
		nyomtatóinkat és a
		számítógépünk
		összes erõforrását akarjuk
		megosztani, akkor létrehozhatunk a
		számukra olyan <span class="quote">"<span class="quote">token</span>"</span>
		hozzáféréseket is, amikhez nem
		tartozik sem felhasználói
		könyvtár, sem pedig
		parancsértelmezõ (pontosabban a
		<code class="filename">/usr/bin/false</code>).</p></dd></dl></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-advanced-acct"></a>9.4.5. A nyomtató használatának
	nyilvántartása</h3></div></div></div><a id="idp82762704" class="indexterm"></a><p>Tehát szükségünk lenne a
	nyomtatások költségének
	elszámolására.  Miért is ne
	tennénk ilyet?  A papír és a tinta bizony
	pénzbe kerül, amihez még
	hozzájárulnak más egyéb
	karbantartási költségek is - a
	nyomtatók dugig vannak mindenféle mozgó
	alkatrésszel, amelyek elõbb-utóbbi el is
	romlanak.  Tegyük fel, hogy a nyomtatóink
	kapacitása, kihasználtsága és
	karbantartási költsége alapján
	már megállapítottunk egy
	elszámolási egységet (oldalanként,
	méterenként, akárminként).  De
	hogyan lássunk hozzá a nyomtatások
	költségének tényleges
	nyilvántartásához?</p><p>Van egy rossz hírünk: az
	<span class="application">LPD</span> nyomtatási rendszer
	önmaga nem tud segíteni ebben a feladatban.  A
	nyilvántartás nagyban függ a használt
	nyomtatóktól, a nyomtatott
	formátumoktól és nyomtató
	<span class="emphasis"><em>általunk</em></span> kiszabott
	költségeitõl.</p><p>A nyilvántartás
	létrehozásához át kell írnunk
	a nyomtatóhoz tartozó szûrõt (a nyers
	szövegek költségének
	felszámításához) és
	konverziós szûrõket (a
	különféle formátumok
	költségei miatt), amikkel aztán
	számolhatjuk vagy lekérdezhetjük a
	kinyomtatott lapokat.  Egyetlen kimeneti szûrõ
	használatával szinte semmire se megyünk,
	mivel az nem képes nyilvántartás
	vezetésére.  Errõl bõvebb
	útmutatást a <a class="link" href="printing-advanced.html#printing-advanced-filter-intro" title="9.4.1. Szûrõk">Szûrõk</a>
	szakaszban találhatunk.</p><p>Általánosságban véve két
	módon vezethetünk
	nyilvántartást:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Az <span class="emphasis"><em>idõszakos
	    elszámolás</em></span> a gyakoribb, mivel ez az
	    egyszerûbb.  Amikor valaki végrehajt egy
	    nyomtatási feladatot, a szûrõ a
	    nyilvántartást tároló
	    állományba feljegyzi a
	    felhasználó azonosítóját,
	    a gépének nevét és a
	    kinyomtatott oldalakat.  Ezután minden
	    hónapban, félévben, évben vagy
	    akár tetszõleges
	    idõközönként
	    összegyûjtjük a nyomtatók
	    nyilvántartásait és külön
	    feljegyezzük az egyes felhasználók
	    nyomtatásait, majd benyújtjuk róla a
	    számlát.  Töröljük az
	    összes naplóállományt, és
	    tiszta lappal kezdjük a következõ
	    idõszakot.</p></li><li class="listitem"><p>Az <span class="emphasis"><em>azonnali
	    elszámolás</em></span> már nem annyira
	    népszerû, mivel nehezebb
	    megvalósítani.  Ekkor a
	    felhasználók már közvetlenül
	    a nyomtatás után megkapják a
	    számlát, hasonlóan a
	    lemezkvótákhoz.  Meg tudjuk akadályozni
	    ezzel azt is, hogy a felhasználók
	    túlléphessék az elõre kiszabott
	    <span class="quote">"<span class="quote">nyomtatási kvótájukat</span>"</span>,
	    amit persze menet közben lehet ellenõrizni
	    és állítgatni.  A
	    felhasználók és kvótájuk
	    nyomonkövetéséhez viszont
	    szükségünk lesz egy kis
	    adatbáziskezelésre is.</p></li></ul></div><p>Az <span class="application">LPD</span> nyomtatási rendszer
	mind a két módszer kivitelezéséhez
	tud segítséget nyújtani, hiszen amikor
	szûrõket állítunk be (vagyis szinte
	mindig), lehetõségünk van a
	nyilvántartást végzõ
	programrészleteket is beilleszteni.  És ami
	feltétlenül elõnyös: óriási
	mértékû rugalmasságot ajánl fel
	a nyilvántartás
	megvalósításához.
	Például magunk választhatjuk ki, hogy
	idõszakos vagy azonnali elszámolást
	alkalmazunk.  Meg tudjuk adni, milyen
	információkat rögzítsünk:
	felhasználói neveket,
	számítógépek neveit, a
	nyomtatási feladatok típusát, vagy a
	kinyomtatott oldalakat, a felhasznált lapok
	területét, a nyomtatások idõbeli
	igényeit és így tovább.  Ehhez
	mindössze csak a szûrõket kell
	módosítani.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82795216"></a>9.4.5.1. Nyilvántartás gyorsan és
	  egyszerûen</h4></div></div></div><p>A FreeBSD-ben egybõl találunk is két
	  programot, amivel pillanatok alatt ki tudunk alakítani
	  egy egyszerû idõszakos elszámolási
	  rendszert.  Ezek <a class="link" href="printing-advanced.html#printing-advanced-lpf" title="9.4.1.6. Az lpf szövegszûrõ">Az lpf
	    szövegszûrõ</a> címû szakaszban
	  ismertetett <code class="command">lpf</code> és a
	  nyomtatók nyilvántartásait
	  tartalmazó állományok adatainak
	  összegyûjtését és
	  kiértékelését végzõ
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a>.</p><p>Ahogy korábban már leírtuk a
	  szûrõkrõl szóló szakaszban (<a class="link" href="printing-advanced.html#printing-advanced-filters" title="9.4.1.1. Hogyan mûködnek a szûrõk?">Szûrõk</a>),
	  az <span class="application">LPD</span> a szöveg- és
	  konverziós szûrõket parancssorból a
	  nyilvántartást tároló
	  állomány nevével indítja el.  Ezt
	  a paramétert a szûrõk aztán fel
	  tudják használni a nyilvántartások
	  feljegyzéséhez.  Az állomány
	  nevét az <code class="filename">/etc/printcap</code>
	  állományban szereplõ <code class="literal">af</code>
	  tulajdonsággal tudjuk megadni, vagy teljes
	  elérési úttal, vagy pedig a
	  nyomtatási könyvtárhoz
	  viszonyítva.</p><p>Az <span class="application">LPD</span> az
	  <code class="command">lpf</code> szûrõt a lap
	  szélességének és hosszának
	  megadásával indítja el (ezeket az
	  értékeket a <code class="literal">pw</code> és
	  <code class="literal">pl</code> tulajdonságokból
	  származtatja).  Az <code class="command">lpf</code> ezek
	  felhasználásával meg tudja mondani,
	  mennyi papírt használtunk el.  Miután
	  kiküldte az állományt a nyomtatóra,
	  nyilvántartásba is veszi.  Ezek a
	  típusú bejegyzések valahogy így
	  néznek ki:</p><pre class="programlisting">2.00 rose:andy
3.00 rose:kelly
3.00 orchid:mary
5.00 orchid:mary
2.00 orchid:zhang</pre><p>Minden nyomtatóhoz érdemes külön
	  nyilvántartást vezetni, mivel az
	  <code class="command">lpf</code> nem tartalmaz semmilyen
	  beépített zárolási
	  megoldást, ezért két
	  <code class="command">lpf</code> párhuzamos futtatása
	  könnyen összezagyválhatja a közösen
	  használt nyilvántartások
	  tartalmát.  Az <code class="filename">/etc/printcap</code>
	  állományban az <code class="literal">af=acct</code>
	  tulajdonság megadásával könnyen
	  létre tudunk hozni minden nyomtatóhoz
	  külön nyilvántartást.  Ilyenkor minden
	  nyomtató könyvtárában megjelenik egy
	  <code class="filename">acct</code> nevû
	  állomány.</p><p>Amikor elérkezünk a nyomtatások
	  kiszámlázásához, futtassuk le a
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> programot.  Ehhez mindössze annyit kell
	  tennünk, hogy átlépünk az
	  elszámolni kívánt nyomtató
	  könyvtárába és
	  begépeljük a <code class="command">pac</code> parancsot.
	  Ekkor kapunk egy ehhez hasonló, dollár
	  alapú kimutatást:</p><pre class="screen">  Login               pages/feet   runs    price
orchid:kelly                5.00    1   $  0.10
orchid:mary                31.00    3   $  0.62
orchid:zhang                9.00    1   $  0.18
rose:andy                   2.00    1   $  0.04
rose:kelly                177.00  104   $  3.54
rose:mary                  87.00   32   $  1.74
rose:root                  26.00   12   $  0.52

total                     337.00  154   $  6.74</pre><p>A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> a következõ paramétereket
	  várja:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-P<em class="replaceable"><code>nyomtató</code></em></code></span></dt><dd><p>Az kiértékelendõ
		<em class="replaceable"><code>nyomtató</code></em> neve.  Ez a
		paraméter csak akkor használható,
		ha az <code class="filename">/etc/printcap</code>
		állományban az <code class="literal">af</code>
		tulajdonságnak teljes elérési utat
		adtunk meg.</p></dd><dt><span class="term"><code class="option">-c</code></span></dt><dd><p>A felhasználók nevei helyett a
		fizetendõ összeg szerint rendezze a
		listát.</p></dd><dt><span class="term"><code class="option">-m</code></span></dt><dd><p>Hagyja figyelmen kívül a
		nyilvántartásban szereplõ
		gépek hálózati neveit.  Ennek
		hatására az <code class="systemitem">alpha</code>
		géprõl nyomtató
		<code class="systemitem">smith</code> meg fog egyezni a
		<code class="systemitem">gamma</code> géprõl
		nyomtatóval.  A beállítás
		nélkül ez a két
		felhasználó el fog térni.</p></dd><dt><span class="term"><code class="option">-p<em class="replaceable"><code>ár</code></em></code></span></dt><dd><p>A paraméterként megadott
		<em class="replaceable"><code>ár</code></em> dollár
		értékkel számol oldalanként
		vagy lábanként az
		<code class="filename">/etc/printcap</code>
		állományban megadott <code class="literal">pc</code>
		tulajdonság értéke helyett (ami
		alapból két cent).  Az
		<em class="replaceable"><code>ár</code></em> lebegõpontos
		(valós) számként is
		megadható.</p></dd><dt><span class="term"><code class="option">-r</code></span></dt><dd><p>A rendezési sorrend
		megfordítása.</p></dd><dt><span class="term"><code class="option">-s</code></span></dt><dd><p>Hozzon létre egy elszámolást,
		majd törölje a hozzá
		kapcsolódó nyilvántartási
		adatokat.</p></dd><dt><span class="term"><em class="replaceable"><code>név</code></em>
	      <em class="replaceable"><code>...</code></em></span></dt><dd><p>Csak az adott <em class="replaceable"><code>nevû</code></em>
		felhasználók adatait
		értékelje ki.</p></dd></dl></div><p>A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> által alapértelmezés
	  szerint generált kimutatásban láthatjuk
	  az egyes gépekrõl származó egyes
	  felhasználók kinyomtatott oldalait.  Ha
	  nekünk viszont nem számít, hogy honnan
	  küldték a kéréseket (mivel
	  bárhonnan lehet küldeni), akkor a
	  <code class="command">pac -m</code> paranccsal az
	  alábbi táblázatot
	  készíttethetjük el:</p><pre class="screen">  Login               pages/feet   runs    price
andy                        2.00    1   $  0.04
kelly                     182.00  105   $  3.64
mary                      118.00   35   $  2.36
root                       26.00   12   $  0.52
zhang                       9.00    1   $  0.18

total                     337.00  154   $  6.74</pre><p>Itt megtaláljuk a ténylegesen
	  kifizetendõ összegeket is, amik
	  kiszámításához a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> az
	  <code class="filename">/etc/printcap</code> állomány
	  <code class="literal">pc</code> tulajdonságát
	  használja (ez alapból 200, avagy 2 cent
	  oldalanként).  Ezzel a tulajdonsággal
	  tehát egy cent századrészében
	  mérve tudjuk megadni az oldalakénti vagy
	  lábankénti árakat.  Ezt a
	  beállítást természetesen a
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> <code class="option">-p</code> opciójával
	  felül tudjuk bírálni.  Arra azonban
	  vigyázzunk, hogy a <code class="option">-p</code> után
	  dollárban kell megadnunk az árat.  Emiatt
	  tehát a</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pac -p1.50</code></strong></pre><p>parancs szerint minden egyes oldal másfél
	  dollárba fog kerülni.  Ezzel az opcióval
	  aztán alaposan megdönthetjük az
	  árakat.</p><p>Végezetül megemlítjük, hogy a
	  <code class="command">pac -s</code> parancs az
	  általa létrehozott elszámolást egy
	  külön állományba menti, amelynek a
	  neve nagyjából megegyezik a
	  nyilvántartást végzõével, de
	  <code class="literal">_sum</code>-ra (mint <span class="quote">"<span class="quote">summary</span>"</span>, azaz
	  elszámolás) végzõdik.  Ezután
	  nullázza a nyilvántartást.  Amikor a
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pac&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pac</span>(8)</span></a> programot újra lefuttatjuk,
	  újból beolvassa a korábban elmentett
	  elszámolásokat, majd hozzászámolja
	  a többit a hagyományos
	  nyilvántartási adatokból.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82876112"></a>9.4.5.2. Hogyan tudjuk számolni a kinyomtatott
	  lapokat?</h4></div></div></div><p>A nyilvántartás pontos
	  vezetéséhez még távolról is
	  valamilyen módon meg kell tudnunk mondani, hogy mennyi
	  lapot használt egy nyomtatási feladat
	  végrehajtása.  Ez a nyomtatás
	  nyilvántartásának egyik alapvetõ
	  problémája.</p><p>A nyers szövegek esetében ez nem is annyira
	  bonyolult: egyszerûen számoljuk össze, hogy a
	  nyomtatási feladatban mennyi sor
	  kinyomtatására lesz szükség
	  és vessük össze ezt a nyomtató
	  által lapoként kinyomtatott sorok
	  számálva.  Ne felejtsük el
	  számításba venni a szövegben
	  felbukkanó törlések hatását,
	  vagy az olyan hosszú sorokat, amelyek a
	  valóságban több sorban fognak
	  megjelenni.</p><p>Viszont (<a class="link" href="printing-advanced.html#printing-advanced-lpf" title="9.4.1.6. Az lpf szövegszûrõ">Az lpf
	    szövegszûrõ</a> címû
	  szakaszban bemutatott) <code class="command">lpf</code> program ezeket
	  mind lekezeli a nyilvántartások
	  készítése során.  Ezért ha
	  szintén egy nyilvántartást vezetni
	  képes szövegszûrõt akarunk írni,
	  akkor mindenképpen érdemes
	  megnéznünk az <code class="command">lpf</code>
	  forráskódját.</p><p>De hogyan bánjunk el a többi
	  formátummal?</p><p>Nos, a DVI-Laserjet és DVI-<span class="trademark">PostScript</span>(R) közti
	  átalakítások esetén a kinyomtatott
	  lapok számának
	  megállapításához meg kell
	  tanítanunk a szûrõnket értelmezni a
	  <code class="command">dvilj</code> vagy <code class="command">dvips</code>
	  parancsok kimenetét.  Ugyanezt meg tudjuk tenni
	  más formátumok és más
	  konverziós programok használata során
	  is.</p><p>Azonban ezek a módszerek nem veszik
	  számításba, hogy a nyomtató
	  egyáltalán kinyomtatta-e az összes
	  elküldött oldalt.  Sok minden történhet
	  még addig, például beragadhat a
	  papír, kifogyhat a tinta vagy akár felrobbanhat
	  a nyomtató - a felhasználónak
	  ettõl függetlenül még fizetnie
	  kell.</p><p>Mit lehet ilyenkor tenni?</p><p>A <span class="emphasis"><em>precíz</em></span>
	  nyilvántartásnak csak egyetlen
	  <span class="emphasis"><em>biztos</em></span> módja létezik.
	  Olyan nyomtatót szerezzünk be, amely képes
	  megmondani, mennyi lapot használt el a nyomtatás
	  során, majd egy ilyet csatlakoztassunk soros porton
	  vagy hálózaton keresztül.  Szinte majdnem
	  az összes <span class="trademark">PostScript</span>(R) nyomtató támogatja
	  ezt a lehetõséget, ahogy sok más
	  gyártmány és típus is
	  (például a hálózati Imagen
	  lézernyomtatók).  A nyomtatóhoz
	  tartozó szûrõt ehhez úgy kell
	  módosítani, hogy lekérdezzük a
	  kinyomtatott lapok számát a nyomtatás
	  után és
	  <span class="emphasis"><em>kizárólag</em></span> erre az
	  értékre alapozva készítünk
	  nyilvántartást.  Itt nincs szükség
	  sem a sorok számolására, sem pedig az
	  állományok (könnyen
	  elhibázható)
	  átvizsgálására.</p><p>Természetesen lehetünk nagylelkûek
	  és ne számítsunk fel semmit a
	  nyomtatásért.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="printing-intro-setup.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="printing.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="printing-using.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">9.3. Kezdeti beállítások </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 9.5. A nyomtatók használata</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>