<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>28.5. A hibák elhárítása</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="mail.html" title="28. fejezet - Elektronikus levelezés" /><link rel="prev" href="mail-changingmta.html" title="28.4. A levéltovábbító ügynök megváltoztatása" /><link rel="next" href="mail-advanced.html" title="28.6. Komolyabb témák" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">28.5. A hibák elhárítása</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mail-changingmta.html">Vissza</a> </td><th width="60%" align="center">28. fejezet - Elektronikus levelezés</th><td width="20%" align="right"> <a accesskey="n" href="mail-advanced.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mail-trouble"></a>28.5. A hibák elhárítása</h2></div></div></div><a id="idp96360528" class="indexterm"></a><div class="qandaset"><a id="idp96361680"></a><dl><dt>28.5.1. <a href="mail-trouble.html#idp96361936">Miért kell teljes hálózati neveket
	    megadni a gépemen?</a></dt><dt>28.5.2. <a href="mail-trouble.html#idp96372816">A sendmail szerint "a
	    levél a saját farkába
	    harap"</a></dt><dt>28.5.3. <a href="mail-trouble.html#idp96381904">Hogyan tudok levelezõ szervert futtatni egy
	    betárcsázós PPP kapcsolat
	    esetében?</a></dt><dt>28.5.4. <a href="mail-trouble.html#idp96422736">Miért kapok folyton Relaying
	    Denied hibát, amikor más
	    gépekrõl küldök levelet?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp96361936"></a><a id="idp96362192"></a><p><strong>28.5.1.</strong></p></td><td align="left" valign="top"><p>Miért kell teljes hálózati neveket
	    megadni a gépemen?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Elõfordulhat, hogy a hivatkozni
	    kívánt gép valójában egy
	    másik tartományban szerepel.
	    Például, ha az <code class="systemitem">ize.mize.edu</code> gépen vagyunk
	    és a <code class="systemitem">vagyis</code> nevû gépet
	    akarjunk innen elérni a <code class="systemitem">mize.edu</code> tartományban,
	    akkor a teljes hálózati nevével, vagyis
	    a <code class="systemitem">vagyis.mize.edu</code> néven
	    kell rá hivatkoznunk, nem pedig egyszerûen csak
	    <code class="systemitem">vagyis</code> néven.</p><p>Régebben egyébként ezt a
	    BSD-típusú BIND<a id="idp96366288" class="indexterm"></a> névfeloldók
	    megengedték.  A FreeBSD jelenlegi változatai
	    azonban már olyan <span class="application">BIND</span>
	    verziót tartalmaznak, amelyek
	    alapértelmezés szerint már nem engedik
	    a tartományunkon kívüli relatív
	    nevek használatát.  Tehát a
	    <code class="systemitem">vagyis</code> vagy a <code class="systemitem">vagyis.ize.mize.edu</code> gép lesz,
	    vagy a legfelsõ, gyökér tartományban
	    keresi a rendszer.</p><p>Ez eltér a korábbi
	    viselkedéstõl, ahol a keresés
	    folytatódott a <code class="systemitem">vagyis.mize.edu</code> és <code class="systemitem">vagyis.edu</code> tartományokban
	    is.  Az RFC 1535 elolvasásából ki
	    fog derülni, hogy miért nem vált be ez a
	    gyakorlat és hogy miért tekinthetõ
	    még akár biztonsági résnek
	    is.</p><p>Ezt a problémát egyébként
	    megoldhatjuk annyival, hogy az
	    <code class="filename">/etc/resolv.conf</code>
	    állományba a</p><pre class="programlisting">search ize.mize.edu mize.edu</pre><p>sor helyett a</p><pre class="programlisting">domain ize.mize.edu</pre><p>sort írjuk be.  Arra viszont ügyeljünk,
	    hogy a keresési rend ne lépje át a
	    <span class="quote">"<span class="quote">helyi és nyilvános
	    adminisztráció között
	    meghúzódó határt</span>"</span>, ahogy
	    azt az RFC 1535 nevezi.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp96372816"></a><a id="idp96373072"></a><p><strong>28.5.2.</strong></p></td><td align="left" valign="top"><p>A <span class="application">sendmail</span> szerint <span class="quote">"<span class="quote">a
	    levél a saját farkába
	    harap</span>"</span></p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Ezt a <span class="application">sendmail</span> gyakran
	    ismértelt kérdései között a
	    következõképpen válaszolták
	    meg:</p><pre class="programlisting">A következõ hibaüzenetet kapom:

553 MX list for <em class="replaceable"><code>taromány.net</code></em> points back to <em class="replaceable"><code>felé.tartomány.net</code></em>
554 <em class="replaceable"><code>felhasználó@tartomány.net</code></em>... Local configuration error

Hogyan oldható meg ez a probléma?

Azt kértük, hogy a tartományba (például <em class="replaceable"><code>tartomány.net</code></em>) küldött levél
az MX<a id="idp96377424" class="indexterm"></a> rekord felhasználásával egy adott gépre legyen átirányítva
(ebben az esetben ez a <em class="replaceable"><code>felé.tartomány.net</code></em>), de a továbbítást végzõ gép
nem ismeri fel magát a <em class="replaceable"><code>tartomány.net</code></em> címen. Vegyük fel a <em class="replaceable"><code>tartomány.net</code></em>
tartományt az /etc/mail/local-host-names állományba [melyet a 8.10 elõtti
verziókban /etc/sendmail.cw állománynak hívnak] (ha a
FEATURE(use_cw_file) beállítást használjuk) vagy tegyük hozzá a
<span class="quote">"<span class="quote">Cw <em class="replaceable"><code>tartomány.net</code></em></span>"</span> sort az /etc/mail/sendmail.cf
állományhoz.</pre><p>A <span class="application">sendmail</span> GYIK a <code class="uri"><a class="uri" href="http://www.sendmail.org/faq/" target="_top">http://www.sendmail.org/faq/</a></code> címen
	    található meg (angolul) és
	    mindenképpen javasolt elolvasni, ha <span class="quote">"<span class="quote">fel
	    szeretnénk piszkálni</span>"</span> a levelezõ
	    rendszerünk beállításait.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp96381904"></a><a id="idp96382160"></a><p><strong>28.5.3.</strong></p></td><td align="left" valign="top"><p>Hogyan tudok levelezõ szervert futtatni egy
	    betárcsázós PPP<a id="idp96382672" class="indexterm"></a> kapcsolat
	    esetében?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Egy helyi hálózaton levõ FreeBSD-s
	    gépet akarunk tehát az internethez kapcsolni.
	    Ez a FreeBSD-s gép lesz a helyi hálózat
	    leveleket továbbító
	    átjárója.  A PPP kapcsolat nem
	    dedikált.</p><p>Legalább két módon meg tudjuk
	    oldani.  Az egyik módszer szerint az UUCP<a id="idp96392656" class="indexterm"></a>
	    használatára lesz
	    szükségünk.</p><p>A másik módszer szerint szereznünk
	    kell egy éjjel-nappal üzemelõ internetes
	    szervert, amely majd szolgáltatja a másodlagos
	    MX rekordot a tartományunkhoz.
	    Például, ha a cégünk
	    tartománya a <code class="systemitem"><em class="replaceable"><code>cég.hu</code></em></code>
	    és az internet-szolgáltatónk a <code class="systemitem"><em class="replaceable"><code>szolgáltató.net</code></em></code>
	    névre beállította a
	    tartományunkhoz a másodlagos MX<a id="idp96394832" class="indexterm"></a>
	    rekordokat:</p><pre class="programlisting"><em class="replaceable"><code>cég.hu</code></em>.          MX        10      <em class="replaceable"><code>cég.hu</code></em>.
                 MX        20      <em class="replaceable"><code>szolgáltató.net</code></em>.</pre><p>Végsõ címzettként csak egy
	    gépet kell megadni (az
	    <code class="filename">/etc/mail/sendmail.cf</code>
	    állományba a <code class="systemitem"><em class="replaceable"><code>cég.hu</code></em></code>
	    címhez tegyük hozzá a <code class="literal">Cw
	    cég.hu</code>
	    sort).</p><p>Amikor a leveleket küldeni akaró
	    <code class="command">sendmail</code> megpróbál
	    kézbesíteni, elõször hozzánk
	    (<code class="systemitem"><em class="replaceable"><code>cég.hu</code></em></code>)
	    próbál csatlakozni a modemes
	    összeköttetésen keresztül.  Ez
	    valószínûleg
	    idõtúllépéssel befejezõdik,
	    mivel nem vagyunk fenn minden pillanatban a neten.  A
	    <span class="application">sendmail</span> ekkor automatikusan a
	    másodlagos MX rekord által megadott
	    címre küldi a levelet, tehát a
	    szolgáltatónkhoz (<code class="systemitem"><em class="replaceable"><code>szolgáltató.net</code></em></code>).
	    Ez a másodlagos MX cím próbálja
	    majd idõlegesen elérni a gépünket
	    és kézbesíteni a leveleket az
	    elsõdleges MX rekord által megadott gépre
	    (<code class="systemitem"><em class="replaceable"><code>cég.hu</code></em></code>).</p><p>A bejelentkezéskor ezért egy
	    hasonló szkriptet kell lefuttatnunk:</p><pre class="programlisting">#!/bin/sh
# Tegyük a /usr/local/bin/pppmyisp állományba:
( sleep 60 ; /usr/sbin/sendmail -q ) &amp;
/usr/sbin/ppp -direct pppmyisp</pre><p>Ha készítünk egy külön
	    bejelentkezõ szkriptet a felhasználók
	    számára, akkor a <code class="command">sendmail
	    -qRcég.hu</code>
	    parancsot is használhatjuk a fenti szkript helyett.
	    Ezzel a <code class="systemitem"><em class="replaceable"><code>cég.hu</code></em></code>
	    sorában található összes
	    levél azonnal feldolgozásra kerül.</p><p>A helyzetet így lehetne még jobban
	    pontosítani:</p><p>Az alábbi üzenet a <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-isp" target="_top">FreeBSD Internet service provider's levelezési lista</a>
	    archívumából származik.</p><pre class="programlisting">&gt; we provide the secondary MX for a customer. The customer connects to
&gt; our services several times a day automatically to get the mails to
&gt; his primary MX (We do not call his site when a mail for his domains
&gt; arrived). Our sendmail sends the mailqueue every 30 minutes. At the
&gt; moment he has to stay 30 minutes online to be sure that all mail is
&gt; gone to the primary MX.
&gt;
&gt; Is there a command that would initiate sendmail to send all the mails
&gt; now? The user has not root-privileges on our machine of course.

In the <span class="quote">"<span class="quote">privacy flags</span>"</span> section of sendmail.cf, there is a
definition Opgoaway,restrictqrun

Remove restrictqrun to allow non-root users to start the queue processing.
You might also like to rearrange the MXs. We are the 1st MX for our
customers like this, and we have defined:

# If we are the best MX for a host, try directly instead of generating
# local config error.
OwTrue

That way a remote site will deliver straight to you, without trying
the customer connection.  You then send to your customer.  Only works for
<span class="quote">"<span class="quote">hosts</span>"</span>, so you need to get your customer to name their mail
machine <span class="quote">"<span class="quote">customer.com</span>"</span> as well as
<span class="quote">"<span class="quote">hostname.customer.com</span>"</span> in the DNS.  Just put an A record in
the DNS for <span class="quote">"<span class="quote">customer.com</span>"</span>.</pre><p>Az idézet fordítása:</p><pre class="programlisting">&gt; Másodlagos MX rekordot biztosítunk az ügyfeleinknek.  Az ügyfelek ezután automatikusan
&gt; csatlakoznak naponta akár többször is a szolgáltatásunkhoz és leszedik az elsõdleges MX
&gt; rekordhoz tartozó leveleket.  (Nem szólunk neki, amikor a tartományához levél
&gt; érkezik.) A sendmail programunk minden 30 percben elküldi a sorban felhalmozódott
&gt; leveleket.  Tehát jelen pillanatban legalább 30 percig fenn kell lennie az ügyfélnek, hogy
&gt; rendben megkapja az elsõdlegesre MX rekordra.
&gt;
&gt; Létezik valamilyen parancs a sendmail programhoz, amellyel azonnal lekérhetjük az összes
&gt; levelünket?  A felhasználómnak természetesen nincsenek rendszergazdai jogosultságai az adott
&gt; gépen.

A sendmail.cf <span class="quote">"<span class="quote">privacy flags</span>"</span> beállításai között van egy definíció, az
Opgoaway,restrictqrun.

Vegyük ki innen a restrictqrun beállítást, amivel a nem root felhasználók is megindíthatják a
sor feldolgozását.  Valószínûleg az MX-ek átrendezésére is szükség lesz.  Mi vagyunk az elsõ MX
az ilyen típusú ügyfelek számára, és ezt adtuk meg:

# Ha mi vagyunk a legjobb MX a levél számára, akkor ne generáljunk
# helyi beállítási hibát, hanem próbálkozzunk közvetlenül.
OwTrue

Ezzel már a távoli gép közvetlenül nekünk küld anélkül, hogy próbálkozna az ügyfél kapcsolatával.
Ezt majd továbbküldjünk az ügyfélnek.  Ez csak hálózati nevek esetében mûködik, tehát az ügyfelünknek
el kell neveznie a leveleket fogadó gépét <span class="quote">"<span class="quote">customer.com</span>"</span>-nak, valamint a fel kell venni a
<span class="quote">"<span class="quote">hostname.customer.com</span>"</span> címet is a DNS-be.  Ehhez egyszerûen csak elegendõ egy A rekordot
betenni a <span class="quote">"<span class="quote">customer.com</span>"</span>-hoz.</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp96422736"></a><a id="idp96422992"></a><p><strong>28.5.4.</strong></p></td><td align="left" valign="top"><p>Miért kapok folyton <span class="errorname">Relaying
	    Denied</span> hibát, amikor más
	    gépekrõl küldök levelet?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>A FreeBSD alapértelmezett telepítése
	    során a <span class="application">sendmail</span>
	    úgy állítódik be, hogy csak
	    arról a géprõl küldhetünk vele
	    levelet, ahol fut.  Például, ha
	    <acronym class="acronym">POP</acronym> szerver is elérhetõ,
	    akkor a felhasználók meg tudják
	    nézni a leveleiket az iskolából,
	    munkából vagy bármilyen más
	    távoli helyrõl, de leveleket onnan
	    továbbra sem tudnak küldeni.
	    Általában pár pillanattal a
	    próbálkozás után a
	    <span class="application">MAILER-DAEMON</span> küldeni fog
	    egy <span class="errorname">5.7 Relaying Denied</span>
	    (<span class="errorname">5.7 A továbbítás nem
	    engedélyezett</span>) üzenetet.</p><p>Több lehetõségünk is van ennek
	    megkerülésére.  Az a legegyszerûbb
	    módszer, ha az internet-szolgáltatónk
	    címét felvesszük az
	    <code class="filename">/etc/mail/relay-domains</code>
	    állományba.  Például
	    így:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>echo "az.internet.szolgáltató.net" &gt; /etc/mail/relay-domains</code></strong></pre><p>Az állomány létrehozása vagy
	    módosítása után újra kell
	    indítanunk a <span class="application">sendmail</span>
	    programot.  Ez remekül mûködik abban az
	    esetben, ha rendszergazdák vagyunk és nem
	    akarunk a helyi géprõl levelet küldeni,
	    vagy egy másik gépen vagy akár
	    másik internet-szolgáltatóval akarunk
	    valamilyen kattingatós levelezõ programot
	    használni.  Olyankor is nagyon hasznos lehet, amikor
	    csak egy vagy két e-mail
	    hozzáférést állítottunk
	    be.  Ha egyszerre több címet is fel
	    szeretnénk venni, akkor nyissuk meg ezt az
	    állományt a kedvenc
	    szövegszerkesztõnkkel és írjuk be a
	    tartományokat, soronként egyet:</p><pre class="programlisting">saját.internet.szolgáltató.net
másik.internet.szolgáltató.com
felhasználók-internet.szolgáltató.ja
www.minta.org</pre><p>Innentõl kezdve a listában szereplõ
	    bármelyik géprõl tudunk levelet
	    küldeni (feltéve, hogy az adott
	    felhasználó hozzáfér a
	    gépünkhöz).  Ezzel
	    gyönyörûen megoldhatjuk, hogy a
	    felhasználóink képesek legyenek
	    távolról is levelet küldeni a
	    rendszerünkön keresztül anélkül,
	    hogy mások pedig szemetet küldenének
	    át rajtunk.</p></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail-changingmta.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="mail-advanced.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">28.4. A levéltovábbító ügynök
      megváltoztatása </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 28.6. Komolyabb témák</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>