<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>17.4. A vizsgálat beállítása</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="audit.html" title="17. fejezet - Biztonsági események vizsgálata" /><link rel="prev" href="audit-install.html" title="17.3. A vizsgálat támogatásának telepítése" /><link rel="next" href="audit-administration.html" title="17.5. A vizsgálati alrendszer használata" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">17.4. A vizsgálat beállítása</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="audit-install.html">Vissza</a> </td><th width="60%" align="center">17. fejezet - Biztonsági események vizsgálata</th><td width="20%" align="right"> <a accesskey="n" href="audit-administration.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="audit-config"></a>17.4. A vizsgálat beállítása</h2></div></div></div><p>A vizsgálatok beállításához
      szükséges összes konfigurációs
      állomány a <code class="filename">/etc/security</code> könyvtárban
      található.  A következõ
      állományok vannak itt a démon
      indítása elõtt:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">audit_class</code> - a vizsgálati
	  osztályok definícióit tartalmazza.</p></li><li class="listitem"><p><code class="filename">audit_control</code> - a vizsgálati
	  alrendszer különbözõ területeit
	  vezérli, többek közt az
	  alapértelmezett vizsgálati osztályokat,
	  az vizsgálati adatok tárhelyén
	  fenntartandó minimális lemezterületet, a
	  vizsgálati nyom maximális méretét,
	  stb.</p></li><li class="listitem"><p><code class="filename">audit_event</code> - a rendszerben
	  jelenlevõ vizsgálati események
	  szöveges megnevezése és
	  leírása, valamint a lista, hogy melyikük
	  mely osztályban található.</p></li><li class="listitem"><p><code class="filename">audit_user</code> -
	  felhasználónként változó
	  vizsgálati elvárások, kombinálva a
	  bejelentkezéskor érvényes
	  globálisan alapértelmezett
	  beállításokkal.</p></li><li class="listitem"><p><code class="filename">audit_warn</code> - az
	  <span class="application">auditd</span> által használt
	  testreszabható shell szkript, aminek
	  segítségével a
	  szélsõséges helyzetekben figyelmeztetõ
	  üzeneteket tudunk generálni, mint
	  például amikor a rekordok számára
	  fenntartott hely hamarosan elfogy, vagy amikor a nyomokat
	  tartalmazó állományt
	  archiváltuk.</p></li></ul></div><div xmlns="" class="warning"><h3 class="admontitle">Figyelem: </h3><p xmlns="http://www.w3.org/1999/xhtml">Az eseményvizsgálat
	konfigurációs állományait alapos
	körültekintés mellett szabad szerkeszteni
	és karbantartani, mivel a bennük keletkezõ
	hibák az események helytelen
	naplózását eredményezhetik.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89373392"></a>17.4.1. Eseményszûrési feltételek</h3></div></div></div><p>Az eseményvizsgálati
	beállítások során számtalan
	helyen felbukkanak a vizsgálni kívánt
	eseményeket meghatározó szûrési
	feltételek.  Ezen feltételek
	eseményosztályok felsorolását
	tartalmazzák, mindegyiküket egy
	módosító vezeti be, ezzel jelezve, hogy az
	adott eseményosztályba tartozó rekordokat
	tartsuk meg vagy vessük el.  Esetleg utalhatnak arra is,
	hogy vagy csak a sikerességet jelzõ rekordokat, vagy
	csak a sikertelenséget jelzõ rekordokat
	szûrjük ki.  A szûrési feltételek
	balról jobbra értékelõdnek ki,
	és két kifejezés
	összefûzéssel
	kombinálható.</p><p>A most következõ lista tartalmazza a
	<code class="filename">audit_class</code> állományban
	található alapértelmezett
	eseményvizsgálati osztályokat:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">all</code> - <span class="emphasis"><em>all (mind)</em></span>
	    - Minden eseményosztályra vonatkozik.</p></li><li class="listitem"><p><code class="literal">ad</code> - <span class="emphasis"><em>administrive
	    (adminisztrációs)</em></span> - olyan
	    adminisztrációs tevékenységek,
	    amelyek egyben az egész rendszeren
	    végrehajtódnak.</p></li><li class="listitem"><p><code class="literal">ap</code> - <span class="emphasis"><em>application
	    (alkalmazás)</em></span> - az alkalmazások
	    által meghatározott
	    tevékenység.</p></li><li class="listitem"><p><code class="literal">cl</code> - <span class="emphasis"><em>file close
	    (állomány lezárása)</em></span> -
	    a <code class="function">close</code> rendszerhívás
	    meghívásának vizsgálata.</p></li><li class="listitem"><p><code class="literal">ex</code> - <span class="emphasis"><em>exec
	    (programindítás)</em></span> - egy program
	    indításának vizsgálata.  A
	    parancssorban átadott paraméterek és a
	    környezeti változók
	    vizsgálatát az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=audit_control&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">audit_control</span>(5)</span></a>
	    vezérli a <code class="literal">policy</code>
	    beállításhoz tartozó
	    <code class="literal">argv</code> és <code class="literal">envv</code>
	    paraméterek segítségével.</p></li><li class="listitem"><p><code class="literal">fa</code> - <span class="emphasis"><em>file attribute access
	    (állományjellemzõk
	    hozzáférése)</em></span> - a
	    rendszerbeli objektumok jellemzõinek
	    hozzáférésnek vizsgálata, mint
	    például a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stat&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stat</span>(1)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pathconf&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">pathconf</span>(2)</span></a>
	    és ehhez hasonló események.</p></li><li class="listitem"><p><code class="literal">fc</code> - <span class="emphasis"><em>file create
	    (állomány
	    létrehozása)</em></span> -
	    állományt eredményezõ
	    események vizsgálata.</p></li><li class="listitem"><p><code class="literal">fd</code> - <span class="emphasis"><em>file delete
	    (állomány törlése)</em></span> -
	    állományt törlõ események
	    vizsgálata.</p></li><li class="listitem"><p><code class="literal">fm</code> - <span class="emphasis"><em>file attribute modify
	    (állományjellemzõk
	    módosítása)</em></span> -
	    állományok jellemzõit
	    megváltoztató események
	    vizsgálata, mint például a
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chown&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">chown</span>(8)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chflags&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">chflags</span>(1)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=flock&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">flock</span>(2)</span></a>, stb.</p></li><li class="listitem"><p><code class="literal">fr</code> - <span class="emphasis"><em>file read
	    (állományolvasás)</em></span> -
	    állományok megnyitásával
	    olvasásra, olvasásával, stb.
	    kapcsolatos események vizsgálata.</p></li><li class="listitem"><p><code class="literal">fw</code> - <span class="emphasis"><em>file write
	    (állományírás)</em></span> -
	    állományok megnyitásával
	    írásra, írásával,
	    módosításával, stb.  kapcsolatos
	    események vizsgálata.</p></li><li class="listitem"><p><code class="literal">io</code> - <span class="emphasis"><em>ioctl</em></span> - az
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ioctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a> rendszerhívást
	    használó események
	    vizsgálata.</p></li><li class="listitem"><p><code class="literal">ip</code> - <span class="emphasis"><em>ipc</em></span> - a
	    folyamatok közti kommunikáció
	    különféle formáinak,
	    beleértve a POSIX csövek és System V
	    <acronym class="acronym">IPC</acronym> mûveleteinek
	    vizsgálata.</p></li><li class="listitem"><p><code class="literal">lo</code> - <span class="emphasis"><em>login_logout (ki-
	    és bejelentkezés)</em></span> - a rendszerben
	    megjelenõ <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=login&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">login</span>(1)</span></a> és <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=logout&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">logout</span>(1)</span></a>
	    események vizsgálata.</p></li><li class="listitem"><p><code class="literal">na</code> - <span class="emphasis"><em>non attributable (nem
	    jellegzetes)</em></span> - a nem jellegzetes események
	    vizsgálata.</p></li><li class="listitem"><p><code class="literal">no</code> - <span class="emphasis"><em>invalid class
	    (érvénytelen osztály)</em></span> -
	    egyetlen biztonsági eseményt sem
	    tartalmaz.</p></li><li class="listitem"><p><code class="literal">nt</code> - <span class="emphasis"><em>network
	    (hálózat)</em></span> - a
	    hálózathoz tartozó események
	    vizsgálata, mint például a
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=connect&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">connect</span>(2)</span></a> és az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=accept&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>.</p></li><li class="listitem"><p><code class="literal">ot</code> - <span class="emphasis"><em>other
	    (egyéb)</em></span> - más egyéb
	    események vizsgálata.</p></li><li class="listitem"><p><code class="literal">pc</code> - <span class="emphasis"><em>process
	    (folyamat)</em></span> - a folyamatokkal kapcsolatos
	    mûveletek, mint például az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exec&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">exec</span>(3)</span></a>
	    és az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exit&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">exit</span>(3)</span></a> vizsgálata.</p></li></ul></div><p>Az imént felsorolt eseményosztályok az
	<code class="filename">audit_class</code> és az
	<code class="filename">audit_event</code> állományok
	módosításával igény szerint
	testreszabhatóak.</p><p>A listában szereplõ minden egyes
	eseményosztályhoz tartozik még egy
	módosító is, amely jelzi, hogy a sikeres
	vagy a sikertelen mûveleteket kell-e szûrnünk,
	valamint hogy a bejegyzés az adott típust vagy
	osztályt hozzáadja vagy elveszi az adott
	szûrésbõl.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>(üres) az adott típusból mind a
	    sikereseket és mind a sikerteleneket
	    feljegyzi.</p></li><li class="listitem"><p><code class="literal">+</code> az eseményosztályba
	    tartozó sikeres eseményeket vizsgálja
	    csak.</p></li><li class="listitem"><p><code class="literal">-</code> az eseményosztályba
	    tartozó sikertelen eseményeket
	    vizsgálja csak.</p></li><li class="listitem"><p><code class="literal">^</code> az
	    eseményosztályból sem a sikereseket,
	    sem pedig a sikerteleneket nem vizsgálja.</p></li><li class="listitem"><p><code class="literal">^+</code> az
	    eseményosztályból nem vizsgálja
	    a sikeres eseményeket.</p></li><li class="listitem"><p><code class="literal">^-</code> az
	    eseményosztályból nem vizsgálja
	    a sikertelen eseményeket.</p></li></ul></div><p>Az alábbi példa egy olyan szûrési
	feltételt mutat be, amely a ki- és
	bejelentkezések közül megadja a sikereset
	és a sikerteleneket, viszont a
	programindítások közül csak a
	sikereseket:</p><pre class="programlisting">lo,+ex</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89456976"></a>17.4.2. A konfigurációs
	állományok</h3></div></div></div><p>A vizsgálati rendszer
	beállításához az esetek
	túlnyomó részében a
	rendszergazdáknak csupán két
	állományt kell módosítaniuk: ezek az
	<code class="filename">audit_control</code> és az
	<code class="filename">audit_user</code>.  Az elõbbi felelõs a
	rendszerszintû vizsgálati jellemzõkért
	és házirendekért, míg az
	utóbbi az igények
	felhasználókénti
	finomhangolásához
	használható.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="audit-auditcontrol"></a>17.4.2.1. Az <code class="filename">audit_control</code>
	  állomány</h4></div></div></div><p>Az <code class="filename">audit_control</code>
	  állomány határozza meg a
	  vizsgálati alrendszer alapértelmezéseit.
	  Ezt az állományt megnyitva a
	  következõket láthatjuk:</p><pre class="programlisting">dir:/var/audit
flags:lo
minfree:20
naflags:lo
policy:cnt
filesz:0</pre><p>A <code class="option">dir</code> opciót használjuk a
	  vizsgálati naplók
	  tárolására szolgáló egy
	  vagy több könyvtár megadására.
	  Ha egynél több könyvtárra
	  vonatkozó bejegyzés található az
	  állományban, akkor azok a megadás
	  sorrendjében kerülnek feltöltésre.
	  Nagyon gyakori az a beállítás, ahol a
	  vizsgálati naplókat egy erre a célra
	  külön kialakított
	  állományrendszeren tárolják,
	  megelõzve ezzel az állományrendszer
	  betelésekor keletkezõ problémákat a
	  többi alrendszerben.</p><p>A <code class="option">flags</code> mezõ egy rendszerszintû
	  alapértelmezett elõválogatási
	  maszkot határoz meg a jellegzetes események
	  számára.  A fenti példában a
	  sikeres és sikertelen ki- és
	  bejelentkezéseket mindegyik felhasználó
	  esetén vizsgáljuk.</p><p>A <code class="option">minfree</code> opció megszabja a
	  vizsgálati nyom tárolására
	  szánt állományrendszeren a
	  minimális szabad helyet, a teljes kapacitás
	  százalékában.  Amint ezt a
	  küszöböt túllépjük, egy
	  figyelmeztetés fog generálódni.  A fenti
	  példa a minimálisan szükséges
	  rendelkezésre álló helyet húsz
	  százalékra állítja.</p><p>A <code class="option">naflags</code> opció megadja azokat az
	  eseményosztályokat, amelyeket vizsgálni
	  kell a nem jellegzetes események, mind
	  például a bejelentkezési folyamatok vagy
	  rendszerdémonok esetén.</p><p>A <code class="option">policy</code> opció a vizsgálat
	  különbözõ szempontjait
	  irányító házirendbeli
	  beállítások vesszõvel
	  elválasztott listáját tartalmazza.  Az
	  alapértelmezett <code class="literal">cnt</code>
	  beállítás azt adja meg, hogy a rendszer a
	  felmerülõ vizsgálati hibák
	  ellenére is folytassa tovább a
	  mûködését (erõsen javasolt a
	  használata).  A másik gyakorta alkalmazott
	  beállítás az <code class="literal">argv</code>,
	  amellyel a rendszer a parancsvégrehajtás
	  részeként az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=execve&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">execve</span>(2)</span></a>
	  rendszerhívás parancssori paramétereit is
	  megvizsgálja.</p><p>A <code class="option">filesz</code> opció határozza
	  meg a vizsgálati nyom automatikus
	  szétvágása és
	  archiválása elõtti maximális
	  méretét, byte-ban.  Az alapértelmezett
	  értéke a 0, amely kikapcsolja ezt az
	  archiválást.  Ha az itt megadott
	  állományméret nem nulla és a
	  minimálisan elvárt 512 KB alatt van, akkor
	  a rendszer figyelmen kívül hagyja és
	  errõl egy figyelmeztetést ad.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="audit-audituser"></a>17.4.2.2. Az <code class="filename">audit_user</code>
	  állomány</h4></div></div></div><p>Az <code class="filename">audit_user</code> állomány
	  lehetõvé teszi a rendszergazda
	  számára, hogy az egyes
	  felhasználók számára
	  további vizsgálati szigorításokat
	  határozzon meg.  Minden sor egy-egy
	  felhasználó vizsgálatának
	  pontosítását adja meg két
	  mezõ segítségével: az elsõ
	  közülük az <code class="literal">alwaysaudit</code>
	  mezõ, mely felsorolja azokat az eseményeket,
	  amelyeket minden esetben vizsgáni kell az adott
	  felhasználó esetén, valamint a
	  második a <code class="literal">neveraudit</code> mezõ, mely
	  az adott felhasználó esetén a nem
	  vizsgálandó eseményeket adja meg.</p><p>A most következõ <code class="filename">audit_user</code>
	  példában vizsgáljuk a
	  <code class="systemitem">root</code> felhasználó ki-
	  és bejelentkezéseit és sikeres
	  programindításait, valamint a
	  <code class="systemitem">www</code> felhasználó
	  állománylétrehozásait és
	  sikeres programindításait.  Ha a korábban
	  bemutatott <code class="filename">audit_control</code>
	  példával együtt használjuk, akkor
	  észrevehetjük, hogy a <code class="literal">lo</code>
	  bejegyzés a <code class="systemitem">root</code>
	  felhasználó esetén redundáns,
	  illetve ilyenkor a ki/bejelentkezést a
	  <code class="systemitem">www</code> felhasználó
	  esetén is vizsgáljuk.</p><pre class="programlisting">root:lo,+ex:no
www:fc,+ex:no</pre></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="audit-install.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="audit.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="audit-administration.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">17.3. A vizsgálat támogatásának
      telepítése </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 17.5. A vizsgálati alrendszer használata</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>