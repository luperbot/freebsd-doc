<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>26.4. Betárcsázós szolgáltatások</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="serialcomms.html" title="26. fejezet - Soros vonali kommunikáció" /><link rel="prev" href="term.html" title="26.3. Terminálok" /><link rel="next" href="dialout.html" title="26.5. A betárcsázós szolgáltatások használata" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">26.4. Betárcsázós
      szolgáltatások</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="term.html">Vissza</a> </td><th width="60%" align="center">26. fejezet - Soros vonali kommunikáció</th><td width="20%" align="right"> <a accesskey="n" href="dialout.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dialup"></a>26.4. Betárcsázós
      szolgáltatások</h2></div><div><span class="authorgroup">Készítette: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Helmer</span>, <span class="firstname">Guy</span></span>. </span></div><div><span class="authorgroup">Kiegészítette: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Kelly</span>, <span class="firstname">Sean</span></span>. </span></div></div></div><a id="idp94353104" class="indexterm"></a><p>Amikor egy FreeBSD rendszert akarunk
      betárcsázós szolgáltatásokhoz
      beállítani, akkor az nagyon hasonlít a
      terminálok csatlakoztatásához, azzal a
      eltéréssel, hogy ilyenkor a terminálok
      helyett modemekkel kell dolgoznunk.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94354000"></a>26.4.1. Külsõ kontra belsõ modemek</h3></div></div></div><p>A külsõ modemek sokkal kényelmesebbnek
	  tûnnek betárcsázás
	  szempontjából, mivel az ilyenek gyakran a
	  statikus memóriájukban tárolt
	  paraméterek révén tulajdonképpen
	  félig elõre be vannak állítva
	  és sok esetben a fontosabb RS-232 jeleket
	  külön lámpácskákkal
	  mutatják.  A villogó lámpák
	  könnyen elkápráztatják a laikusokat,
	  de emellett igen fontosak a modem
	  mûködõképességének
	  megállapításában is.</p><p>Ezzel szemben a belsõ modemeken nem
	  található statikus memória, ezért
	  a paramétereik csak DIP kapcsolókkal
	  módosíthatóak.  Még ha egy
	  belsõ modemem látunk is lámpákat,
	  akkor sem könnyû figyelni rájuk, mert a
	  gépünk burkolata úgyis eltakarja
	  ezeket.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94355408"></a>26.4.1.1. Modemek és kábelek</h4></div></div></div><a id="idp94356048" class="indexterm"></a><p>Ha külsõ modemet használunk, akkor
	  mindenképpen szükségünk lesz
	  hozzá még egy megfelelõ kábelre is.
	  Egy szabványos RS-232-es soros kábel erre
	  tökéletesen megfelel egészen addig,
	  amíg a normál jeleket így
	  kötötték be rajta:</p><div class="table"><a id="serialcomms-signal-names"></a><div class="table-title">26.4. táblázat - A jelek neve</div><div class="table-contents"><table summary="A jelek neve" width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Rövidítés</th><th align="left">Elnevezés</th></tr></thead><tbody><tr><td><acronym class="acronym">RD</acronym></td><td>Received Data (fogadott adat)</td></tr><tr><td><acronym class="acronym">TD</acronym></td><td>Transmitted Data (küldött
		    adat)</td></tr><tr><td><acronym class="acronym">DTR</acronym></td><td>Data Terminal Ready (adatterminál
		    kész)</td></tr><tr><td><acronym class="acronym">DSR</acronym></td><td>Data Set Ready
		    (adatbeállítás
		    kész)</td></tr><tr><td><acronym class="acronym">DCD</acronym></td><td>Data Carrier Detect (vonal
		    észlése - az RS-232
		    fogadást érzékelõ
		    vonala)</td></tr><tr><td><acronym class="acronym">SG</acronym></td><td>Signal Ground (föld)</td></tr><tr><td><acronym class="acronym">RTS</acronym></td><td>Request to Send (küldés
		    kérése)</td></tr><tr><td><acronym class="acronym">CTS</acronym></td><td>Clear to Send (küldés
		    engedélyezése)</td></tr></tbody></table></div></div><br class="table-break" /><p>A FreeBSD-nek 2400 bps felett a forgalom
	  irányításához az
	  <acronym class="acronym">RTS</acronym> és <acronym class="acronym">CTS</acronym>
	  jelekre van szüksége.  A <acronym class="acronym">CD</acronym>
	  jellel állapítja meg, hogy a hívás
	  létrejött vagy a bontották a vonalat,
	  és a <acronym class="acronym">DTR</acronym> jel hozza
	  alapállapotba a modemet a munkamenet befejezése
	  után.  Egyes kábelekben nem mindegyik jelet
	  vezették át, így ha például
	  gondjaink akadnak a bejelentkezõ képernyõvel
	  amikor a vonalat bontjuk, akkor érdemes
	  átnéznünk a kábelt.</p><p>A többi <span class="trademark">UNIX</span>(R)-szerû operációs
	  rendszerhez hasonlóan a FreeBSD is hardveres jelek
	  segítségével igyekszik kideríteni,
	  hogy a hívás megvalósult vagy
	  bontották a vonalat, valamint a hívás
	  befejezése után így bontja a vonalat
	  és állítja vissza a modemet.  A FreeBSD
	  igyekszik elkerülni a parancsok
	  küldését a modem felé, vagy a modem
	  állapotának folyamatos
	  ellenõrzését.  Ha már van
	  némi tapasztalatunk a PC-alapú BBS-ek modemes
	  elérését illetõen, akkor
	  valószínûleg értjük ezek
	  okait.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94378448"></a>26.4.2. A soros vonali felülettel kapcsolatos
	megfontolások</h3></div></div></div><p>A FreeBSD ismeri az NS8250-, NS16450-, NS16550- és
	NS16550A alapú EIA RS-232C (CCITT V.24)
	szabványú kommunikációs
	felületeket.  A 8250-es és a 16450-es
	eszközök egykarakteres pufferrel rendelkeznek.  A
	16550-es eszközök 16 karakteres puffert tartalmaznak,
	amellyel jobb teljesítmény érhetõ el.
	(A sima 16550-esben levõ hibák miatt azonban ez a 16
	karakteres puffer nem használható ki rendesen,
	ezért lehetõleg a 16550A verziót
	használjuk).  Mivel az operációs rendszer
	részérõl az egykarakteres eszközök
	jóval több törõdést
	igényelnek, mint a 16 karakteres eszközök,
	ezért inkább a 16550A alapú soros
	felületi kártyákat ajánljuk.  Amikor a
	rendszer egyszerre több soros portot is kezel, vagy
	erõs terhelés alatt áll, akkor a 16550A
	alapú kártyákról
	általában az is elmondható, hogy kisebb
	hibával dolgoznak.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94379600"></a>26.4.3. Egy gyors áttekintés</h3></div></div></div><a id="idp94380240" class="indexterm"></a><p>Ahogy arról már a terminálok
	esetében szó esett, az <code class="command">init</code> az
	összes betárcsázós kapcsolathoz
	tartozó soros porthoz elindít egy
	<code class="command">getty</code> programot.  Például, ha a
	modemet a <code class="filename">/dev/ttyd0</code> eszközre
	kapcsoltuk, akkor a <code class="command">ps ax</code> parancs
	kimenetében ezt láthatjuk:</p><pre class="screen"> 4850 ??  I      0:00.09 /usr/libexec/getty V19200 ttyd0</pre><p>Amikor egy felhasználó felhívja a
	modemet és az kapcsolódik, akkor a modem egy
	<acronym class="acronym">CD</acronym> (Carrier Detect) jelet küld.  A
	rendszermag ekkor tudomásul veszi a vonal
	észlelését és a
	<code class="command">getty</code> segítségével
	megindítja a kommunikációt.  A
	<code class="command">getty</code> egy <code class="prompt">login:</code>
	szöveget küld át a vonalhoz megadott
	sebességgel.  A <code class="command">getty</code> elkezdi
	figyelni, hogy a értelmes karakterek érkeznek-e
	vissza, és egy átlagos
	konfigurációban, ha ezt szemétnek
	találja (mert például a modem nem a
	<code class="command">getty</code> számára
	beállított sebességgel csatlakozott), akkor
	megpróbálja egészen addig hangolni a vonal
	sebességét, amíg feldolgozásra
	alkalmas karaktereket nem kap.</p><a id="idp94402512" class="indexterm"></a><p>Miután a felhasználó megadta a
	felhasználói nevét, a
	<code class="command">getty</code> elindítja a
	<code class="filename">/usr/bin/login</code> programot, amely befejezi a
	beléptetést a felhasználó
	jelszavának bekérésével és
	annak elfogadása esetén a
	hozzá tartozó parancsértelmezõ
	elindításával.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94404560"></a>26.4.4. A konfigurációs
	állományok</h3></div></div></div><p>FreeBSD rendszerünkben a betárcsázós
	kapcsolatok engedélyezéséhez az
	<code class="filename">/etc</code> könyvtárban három
	állomány módosítására
	lesz szükségünk.  Közülük az
	elsõ, az <code class="filename">/etc/gettytab</code> a
	<code class="filename">/usr/libexec/getty</code> démon
	beállításait tartalmazza.  A
	második, az <code class="filename">/etc/ttys</code> az
	<code class="filename">/sbin/init</code> számára mondja
	meg, hogy melyik <code class="filename">tty</code>
	eszközökhöz tartozik <code class="command">getty</code>.
	Végezetül a portok
	inicializálásához kötõdõ
	beállításokat az
	<code class="filename">/etc/rc.d/serial</code> szkriptben kell
	megadnunk.</p><p>Két <span class="quote">"<span class="quote">iskola</span>"</span> jött létre
	aszerint, hogy <span class="trademark">UNIX</span>(R) alatt hogyan használják a
	betárcsázós modemeket.  Az egyik csoport
	úgy szereti beállítani a modemeit és
	rendszerit, hogy a távoli felhasználó
	által választott sebességtõl
	függetlenül a számítógép
	és a modem közti RS-232 felület egy fix
	sebességen fut.  Ennek a
	beállításnak megvan az az elõnye, hogy
	a távoli felhasználó ilyenkor szinte
	azonnal megkapja a bejelentkezõ képernyõt.  A
	hátránya viszont, hogy ebben az esetben a rendszer
	nem ismeri a felhasználó valódi
	adatátviteli sebességét, ezért az
	olyan teljes képernyõs alkalmazások, mint
	például az <span class="application">Emacs</span>, nem
	lesznek képesek a lassabb kapcsolatokhoz szabni a
	megjelenítésüket.</p><p>A másik csoport a modemek RS-232-es
	felületét a távoli felhasználó
	kapcsolódási sebessége szerint
	állítja be.  Így például egy
	V.32bis (14,4 Kbps) kapcsolat esetén a modemhez
	tartozó RS-232 felület 19,2 Kbps-on fog menni,
	miközben a 2400 bps sebességû
	kapcsolatokhoz egy vele azonos sebességû RS-232-es
	felület fog tartozni.  Mivel a <code class="command">getty</code> nem
	képes kommunikálni a modemek által
	lejelentett csatlakozási sebességen, ezért
	úgy próbálja azt
	megállapítani, hogy elküldi a
	<code class="prompt">login:</code> szöveget az alap
	sebességgel, majd figyeli a válaszul
	érkezõ karaktereket.  Ha a felhasználó
	ilyenkor szemetet lát, akkor feltételezik, hogy
	addig fogja nyomkodni az <span class="keycap"><strong>Enter</strong></span> billentyût,
	amíg valami értelmes szöveget meg nem
	lát.  Amikor az adatátviteli sebesség
	eltér, akkor a <code class="command">getty</code> ebbõl
	csupán csak annyit vesz észre, hogy a
	felhasználó <span class="quote">"<span class="quote">szemetet</span>"</span> küld,
	ezért egy újabb sebességgel
	megpróbálja megint elküldeni a
	<code class="prompt">login:</code> szöveget.  Hivatalosan ez a
	folyamat ismétlõdik orrvérzésig, de
	általában csak egy-két billentyût kell
	leütni a megfelelõ
	beállításokhoz.  Nyilvánvaló,
	hogy ilyenkor a bejelentkezés messze nem olyan
	zavartalan, mint a <span class="quote">"<span class="quote">rögzített
	sebességû</span>"</span> esetben, de így a lassabb
	kapcsolattal rendelkezõ felhasználók is jobb
	használatóságot kapnak a teljes
	képernyõs programokkal.</p><p>Ebben a szakaszban egy valamennyire kiegyensúlyozott
	beállítást igyekszünk bemutatni, de
	részben elfogunk hajlani abban az irányba, amikor
	a modem a kapcsolat sebességét követi.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94418128"></a>26.4.4.1. <code class="filename">/etc/gettytab</code></h4></div></div></div><a id="idp94418896" class="indexterm"></a><p>A <code class="filename">/etc/gettytab</code> egy
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=termcap&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">termcap</span>(5)</span></a>-szerû állomány, amely a
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=getty&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">getty</span>(8)</span></a> beállításait tartalmazza.
	  A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gettytab&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">gettytab</span>(5)</span></a> man oldalon olvashatunk az
	  állomány pontos
	  felépítésérõl és benne
	  felsorolt beállításokról.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94422608"></a>26.4.4.1.1. A rögzített sebességû
	    beállítás</h5></div></div></div><p>Ha a modem kommunikációs
	    sebességét rögzíteni akarjuk,
	    akkor ehhez többnyire semmit sem kell
	    megváltoztatnunk az
	    <code class="filename">/etc/gettytab</code>
	    állományban.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94424144"></a>26.4.4.1.2. Az alkalmazkodó sebességû
	    beállítás</h5></div></div></div><p>Az <code class="filename">/etc/gettytab</code>
	    állományban létre kell hoznunk egy
	    olyan bejegyzést, amelyen keresztül a
	    <code class="command">getty</code> tudni fogja, hogy milyen
	    sebességeken akarjuk használni a modemet.  Ha
	    egy 2400 bps sebességû modemünk van,
	    akkor hozzá a már meglevõ
	    <code class="literal">D2400</code>-as bejegyzést kell
	    használnunk.</p><pre class="programlisting">#
# A gyors betárcsázós terminálokhoz íme egy 2400/1200/300-as váltás
# (bárhonnan kezdõdhet):
#
D2400|d2400|Fast-Dial-2400:\
        :nx=D1200:tc=2400-baud:
3|D1200|Fast-Dial-1200:\
        :nx=D300:tc=1200-baud:
5|D300|Fast-Dial-300:\
        :nx=D2400:tc=300-baud:</pre><p>Ha ennél gyorsabb modemünk van, akkor
	    már mindenképpen fel kell vennünk
	    hozzá egy új bejegyzést az
	    <code class="filename">/etc/gettytab</code> állományba.
	    Ezzel a beállítással egy 14,4 Kbps
	    sebességû modemet tudunk legfeljebb
	    19,2 Kbps-en használni:</p><pre class="programlisting">#
# Kiegészítések egy V.32bis modemhez:
#
um|V300|High Speed Modem at 300,8-bit:\
        :nx=V19200:tc=std.300:
un|V1200|High Speed Modem at 1200,8-bit:\
        :nx=V300:tc=std.1200:
uo|V2400|High Speed Modem at 2400,8-bit:\
        :nx=V1200:tc=std.2400:
up|V9600|High Speed Modem at 9600,8-bit:\
        :nx=V2400:tc=std.9600:
uq|V19200|High Speed Modem at 19200,8-bit:\
        :nx=V9600:tc=std.19200:</pre><p>Ennek eredménye egy 8 bites,
	    paritásmentes kapcsolat lesz.</p><p>A fenti példában a
	    kommunikációt 19,2 Kbps-en (V.32bis
	    kapcsolaton) kezdjük, majd utána haladunk
	    végig a 9600 bps (V.32), 2400 ,
	    1200 bps és 300 bps sebességû
	    kapcsolatokon, majd vissza ismét a 19,2 Kbps-re.
	    Az adatátviteli sebesség ilyen
	    típusú váltogatását az
	    <code class="literal">nx=</code> (<span class="quote">"<span class="quote">next table</span>"</span>, azaz
	    <span class="quote">"<span class="quote">következõ táblázat</span>"</span>)
	    tulajdonság segítségével
	    valósítják meg.  Minden sorban
	    látható még egy <code class="literal">tc=</code>
	    (<span class="quote">"<span class="quote">table continuation</span>"</span>, vagyis <span class="quote">"<span class="quote">a
	    táblázat folytatása</span>"</span>)
	    bejegyzés is, amivel az adott adatátviteli
	    sebesség <span class="quote">"<span class="quote">szabványos</span>"</span>
	    beállításait adjuk meg.</p><p>Ha egy 28,8 Kbps sebességû
	    modemünk van és/vagy egy 14,4 Kbps
	    sebességû modemen akarunk
	    tömörítést használni, akkor a
	    19,2 Kbps-nél nagyobb
	    kommunikációs sebességet kell
	    használnunk.  Íme egy olyan
	    <code class="filename">gettytab</code>.  ami 57,6 Kbps-rõl
	    indít:</p><pre class="programlisting">#
# A V.32bis vagy V.34 modemekhez kiegészítés,
# 57,6 Kbps-rõl indulunk:
#
vm|VH300|Very High Speed Modem at 300,8-bit:\
        :nx=VH57600:tc=std.300:
vn|VH1200|Very High Speed Modem at 1200,8-bit:\
        :nx=VH300:tc=std.1200:
vo|VH2400|Very High Speed Modem at 2400,8-bit:\
        :nx=VH1200:tc=std.2400:
vp|VH9600|Very High Speed Modem at 9600,8-bit:\
        :nx=VH2400:tc=std.9600:
vq|VH57600|Very High Speed Modem at 57600,8-bit:\
        :nx=VH9600:tc=std.57600:</pre><p>Ha lassú a processzorunk, vagy a rendszerünk
	    túlságosan terhelt és nincs 16550A
	    típusú soros portunk, akkor 57,6 Kbps-en
	    <span class="errorname">sio</span> <span class="quote">"<span class="quote">silo</span>"</span> hibák
	    keletkezhetnek.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="dialup-ttys"></a>26.4.4.2. <code class="filename">/etc/ttys</code></h4></div></div></div><a id="idp94435024" class="indexterm"></a><p>Az <code class="filename">/etc/ttys</code> állomány
	  beállításáról már a
	  <a class="xref" href="term.html#ex-etc-ttys" title="26.1. példa - Terminálok felvétele az /etc/ttys állományba">26.1. példa - Terminálok felvétele az
	    <code class="filename">/etc/ttys</code>
	    állományba</a> adott képet.  Ez a modemek
	  esetében sem tér el különösebben,
	  habár a <code class="command">getty</code> programnak más
	  termináltípust és
	  -beállításokat kell átadnunk.
	  Akár rögzített, akár
	  alkalmazkodó sebességet akarunk
	  beállítani, ennek általános alakja
	  az alábbi:</p><pre class="programlisting">ttyd0   "/usr/libexec/getty <em class="replaceable"><code>xxx</code></em>"   dialup on</pre><p>A sorban látható elsõ elem a
	  megfelelõ speciális eszköz neve - jelen
	  esetben ez a <code class="filename">ttyd0</code>, amely a
	  <code class="filename">/dev/ttyd0</code> eszközre vonatkozik
	  és ezt fogja a <code class="command">getty</code> figyelni.  A
	  második elem, vagyis a <code class="literal">"/usr/libexec/getty
	  xxx"</code> (ahol a
	  <em class="replaceable"><code>xxx</code></em> helyére kell
	  beírni a megfelelõ <code class="filename">gettytab</code>
	  állománybeli bejegyzést nevét)
	  lesz az a parancs, amelyet az <code class="command">init</code>
	  meghív.  A harmadik elem, a <code class="literal">dialup</code> a
	  terminálok alapértelmezett típusa.  A
	  negyedik paraméter, az <code class="literal">on</code> jelzi az
	  <code class="command">init</code> programnak, hogy aktiválja a
	  vonalat.  A sorban megjelenhetne továbbá
	  még egy ötödik paraméter is, a
	  <code class="literal">secure</code>, de ezt csak olyan terminálok
	  esetében érdemes megadni, amelyek fizikailag
	  megbízhatóak (például a
	  rendszerkonzol).</p><p>Az alapértelmezett termináltípus
	  (vagyis a fenti példában a
	  <code class="literal">dialup</code>) a helyi
	  beállításoktól függ.  A
	  betárcsázós vonalak esetében
	  hagyományosan a <code class="literal">dialup</code> a
	  terminál alapértelmezett típusa, amit
	  aztán a felhasználók a
	  bejelentkezéskor lefutó szkriptjeiken
	  keresztül a automatikusan át tudnak
	  állítani a nekik megfelelõ
	  terminálra.  A szerzõ saját
	  rendszerében azonban inkább a
	  <code class="literal">vt102</code> termináltípust volt
	  érdemes megadni alapértelmezettként,
	  mivel ott a felhasználók csak ilyen
	  típusú terminálokat
	  használnak.</p><p>Miután az <code class="filename">/etc/ttys</code>
	  állományban elvégeztük a
	  szükséges módosításokat, egy
	  <acronym class="acronym">HUP</acronym> jelzéssel figyelmeztessük
	  az <code class="command">init</code> programot az újbóli
	  beolvasására.  Ehhez a következõ
	  parancs ajánlott:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kill -HUP 1</code></strong></pre><p>Ha még csak állítjuk be
	  elõször a rendszerünket, akkor az
	  <code class="command">init</code> figyelmeztetése elõtt
	  legyünk türelmesek, és várjuk meg,
	  amíg a modemek befejezik az
	  inicializálást és kapcsolódnak a
	  vonalakra.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94472016"></a>26.4.4.2.1. A rögzített sebességû
	    beállítás</h5></div></div></div><p>A rögzített sebesség
	    beállításánál a
	    <code class="filename">ttys</code> állományban a
	    <code class="command">getty</code> paramétereként egy
	    szintén rögzített sebességû
	    bejegyzést kell megadnunk.  Például az
	    olyan modemeknél, ahol a sebességet
	    19,2 Kbps-re rögzítjük, a
	    <code class="filename">ttys</code> így fog
	    kinézni:</p><pre class="programlisting">ttyd0   "/usr/libexec/getty std.19200"   dialup on</pre><p>Amennyiben a modemünk nem ezen a sebességen
	    üzemelne, akkor az
	    <code class="literal">std.sebesség</code>
	    paramétert használjuk az
	    <code class="literal">std.19200</code> helyett.  Elõtte azonban
	    ne felejtsük el ellenõrizni, hogy a megadott
	    típus szerepel-e az
	    <code class="filename">/etc/gettytab</code>
	    állományban.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94476368"></a>26.4.4.2.2. Az alkalmazkodó sebességû
	    beállítás</h5></div></div></div><p>Az alkalmazkodó sebességû
	    beállításnál a
	    <code class="filename">ttys</code> állományban az
	    <code class="filename">/etc/gettytab</code>
	    állományból a megfelelõ
	    <span class="quote">"<span class="quote">auto-baud</span>"</span> (sic) kell megadnunk.
	    Például, ha modemünk
	    kezdõsebessége 19,2 Kbps (és a
	    <code class="filename">gettytab</code> ehhez tartalmaz egy
	    <code class="literal">V19200</code> nevû bejegyzést),
	    akkor a <code class="filename">ttys</code> így fog
	    kinézni:</p><pre class="programlisting">ttyd0   "/usr/libexec/getty V19200"   dialup on</pre></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94480464"></a>26.4.4.3. <code class="filename">/etc/rc.d/serial</code></h4></div></div></div><a id="idp94481232" class="indexterm"></a><p>A gyorsabb, mint például a V.32, V.32bis
	  és V.34 modemeknél meg kell adnunk a hardveres
	  forgalomirányítás
	  (<code class="literal">RTS/CTS</code>) használatát is.  Az
	  <code class="filename">/etc/rc.d/serial</code>
	  állományban tudjuk megadni a FreeBSD rendszermagban
	  a vonal használatához szükséges
	  vezérlési beállításokra
	  vonatkozó <code class="command">stty</code> parancsokat.</p><p>Például állítsuk be az 1-es
	  sorszámú (vagyis a
	  <code class="filename">COM2</code>) soros porton a
	  <code class="varname">crtscts</code> <code class="literal">termios</code>
	  beállítást a behíváshoz
	  és a híváshoz használt
	  eszközök inicializálásakor.  Ehhez a
	  következõ sorokat kell felvennünk az
	  <code class="filename">/etc/rc.d/serial</code>
	  állományba:</p><pre class="programlisting"># A soros portok kezdeti beállításai:
stty -f /dev/ttyd1.init crtscts
stty -f /dev/cuad1.init crtscts</pre></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94495056"></a>26.4.5. A modemek beállításai</h3></div></div></div><p>Ha olyan modemeink vannak, amelyek paramétereit egy
	statikus memóriában tárolták le,
	akkor ezek beállításához egy
	terminálprogramot kell használnunk (amilyen
	például <span class="trademark">MS-DOS</span>(R) alatt a
	<span class="application">Telix</span> vagy FreeBSD alatt a
	<code class="command">tip</code>).  A modemet a <code class="command">getty</code>
	programnak megadott kezdeti sebességen csatlakoztassuk
	és az alábbi elvárások
	alapján állítsuk be a
	paramétereit:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Kapcsolódáskor <acronym class="acronym">CD</acronym>
	    jelzése.</p></li><li class="listitem"><p>Mûködéskor <acronym class="acronym">DTR</acronym>
	    jelzése.  A DTR küldésekor bontsa a
	    vonalat és hozza alapállapotba a
	    modemet.</p></li><li class="listitem"><p><acronym class="acronym">CTS</acronym> vezérlésû
	    kimenõ adatforgalom.</p></li><li class="listitem"><p>A <acronym class="acronym">XON/XOFF</acronym>
	    forgalomvezérlés tiltása.</p></li><li class="listitem"><p><acronym class="acronym">RTS</acronym> vezérlésû
	    bejövõ adatforgalom.</p></li><li class="listitem"><p>Csendes mód (ne adjon
	    értesítést az
	    eredményekrõl).</p></li><li class="listitem"><p>A parancsokat ne írja vissza.</p></li></ul></div><p>A modemhez tartozó dokumentációban kell
	utánajárnunk, hogy milyen parancsok és/vagy
	DIP kapcsolók
	átállításával lehet
	mindezeket elérni.</p><p>Például, ha a fenti paramétereket egy
	<span class="trademark">U.S. Robotics</span>(R) <span class="trademark">Sportster</span>(R) 14400-as külsõ modem
	esetében a következõ neki kiküldött
	paranccsal lehet beállítani:</p><pre class="programlisting">ATZ
AT&amp;C1&amp;D2&amp;H1&amp;I0&amp;R2&amp;W</pre><p>Ilyenkor még akár más egyéb
	paramétereket is beállíthatunk,
	például a V.42bis és/vagy az MNP5
	tömörítést.</p><p>Az <span class="trademark">U.S. Robotics</span>(R) <span class="trademark">Sportster</span>(R) 14400 külsõ modemen
	ezenkívül még találunk
	néhány DIP kapcsolót is.  Az ilyen modemek
	esetében például ezeket a
	beállításokat tudjuk
	használni:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>1.  kapcsoló: FEL - normális
	    DTR</p></li><li class="listitem"><p>2.  kapcsoló: N/A (verbális/numerikus
	    eredményjelzõ kódok)</p></li><li class="listitem"><p>3.  kapcsoló: FEL - az
	    eredményjelzõ kódok
	    küldésének tiltása</p></li><li class="listitem"><p>4.  kapcsoló: LE - nem küldi vissza a
	    parancsokat</p></li><li class="listitem"><p>5.  kapcsoló: FEL - automatikus
	    válasz</p></li><li class="listitem"><p>6.  kapcsoló: FEL - normális Carrier
	    Detect</p></li><li class="listitem"><p>7.  kapcsoló: FEL - a
	    memóriában tárolt
	    alapértelmezések betöltése</p></li><li class="listitem"><p>8.  kapcsoló: N/A (intelligens/buta
	    mód)</p></li></ul></div><p>A modemeknél az eredményjelzõ
	kódok kikapcsolása/letiltása ezért
	fontos, mert így el tudunk kerülni az olyan
	problémákat, hogy a <code class="command">getty</code>
	tévesen egy <code class="prompt">login:</code> promptot küld a
	parancs módban levõ modemnek, amikor az
	visszaküldi a parancsot és az eredmény
	kódját.  Ennek eredménye egy
	hosszúra nyúló, zavaros
	társalgás lesz a <code class="command">getty</code>
	és a modem között.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94525904"></a>26.4.5.1. A rögzített sebességû
	  beállítás</h4></div></div></div><p>A rögzített sebességû
	  konfiguráció használata esetén
	  úgy kell beállítanunk a modemet, hogy a
	  konkrét adatátviteli sebsségtõl
	  függetlenül is egy állandó
	  sebességû kapcsolat álljon fenn a
	  számítógép és a modem
	  között.  A <span class="trademark">U.S. Robotics</span>(R) <span class="trademark">Sportster</span>(R) 14400-as
	  külsõ modem esetében a most
	  következõ parancsokkal tudjuk rögzíteni
	  a kapcsolat sebességét:</p><pre class="programlisting">ATZ
AT&amp;B1&amp;W</pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94528464"></a>26.4.5.2. Az alkalmazkodó sebességû
	  beállítás</h4></div></div></div><p>Amikor változó sebességû
	  konfigurációval dolgozunk, akkor a modemet
	  úgy kell beállítani, hogy a
	  bejövõ hívásnak megfelelõ
	  adatátviteli sebességre váltson a soros
	  portján.  A <span class="trademark">U.S. Robotics</span>(R) <span class="trademark">Sportster</span>(R) 14400-as
	  külsõ modem esetében az alábbi
	  parancsokkal rögzítjük a modemnek
	  küldött hibamentesített parancsok
	  sebességét, miközben
	  engedélyezzük, hogy a soros port sebessége
	  változhasson a nem hibamentesített
	  kapcsolatoknál:</p><pre class="programlisting">ATZ
AT&amp;B2&amp;W</pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94531024"></a>26.4.5.3. A modem beállításainak
	  ellenõrzése</h4></div></div></div><p>A legtöbb nagysebességû modem
	  biztosít valamilyen lehetõséget arra, hogy
	  emberi formában is le tudjuk kérdezni a
	  belsõ mûködésének
	  paramétereit.  A <span class="trademark">U.S. Robotics</span>(R) <span class="trademark">Sportster</span>(R) 14400-as
	  külsõ modem esetében az
	  <code class="command">ATI5</code> parancs a statikus
	  memóriában tárolt
	  beállításokat mutatja meg.  A modem
	  valós mûködési paramétereit
	  (amit ugyebár befolyásolnak a DIP
	  kapcsolók állásai is) viszont az
	  <code class="command">ATZ</code> majd <code class="command">ATI4</code> parancsok
	  küldésével tudjuk lekérni.</p><p>Ha azonban másmilyen márkájú
	  modemünk lenne, akkor a modem
	  leírásában próbáljunk
	  tájékozódni arról, miként
	  tudjuk a modem beállításait
	  ellenõrizni.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94539088"></a>26.4.6. Hibaelhárítás</h3></div></div></div><p>Ebben a szakaszban bemutatunk néhány
	lépést, amelyeken keresztül
	ellenõrizhetjük a rendszerünkhöz
	csatlakoztatott modemet.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94540112"></a>26.4.6.1. A FreeBSD rendszer ellenõrzése</h4></div></div></div><p>Csatlakoztassuk a modemet a FreeBSD rendszerre,
	  indítsuk be a gépet, majd ezután
	  figyeljük a modemünk állapotát
	  jelzõ lámpákat, hogy közülük
	  a <acronym class="acronym">DTR</acronym> világít-e, amikor a
	  <code class="prompt">login:</code> felirat megjelenik a rendszerkonzolon.
	  Amennyiben erre a válasz igen, akkor az arra utal, hogy
	  a FreeBSD a hozzá tartozó
	  kommunikációs porton elindította a
	  megfelelõ <code class="command">getty</code> programot és a
	  modem várja a hívásokat.</p><p>Amikor viszont a <acronym class="acronym">DTR</acronym> lámpa nem
	  világít, a konzolon keresztül
	  jelentkezzünk be a FreeBSD rendszerbe és adjuk ki egy
	  <code class="command">ps ax</code> parancsot, amivel így
	  ellenõrizni tudjuk, hogy a porthoz tartozó
	  <code class="command">getty</code> elindult.  A futó programok
	  között tehát valami ilyesmit kell majd
	  látnunk:</p><pre class="screen">  114 ??  I      0:00.10 /usr/libexec/getty V19200 ttyd0
  115 ??  I      0:00.10 /usr/libexec/getty V19200 ttyd1</pre><p>Ha viszont például ezt látjuk:</p><pre class="screen">  114 d0  I      0:00.10 /usr/libexec/getty V19200 ttyd0</pre><p>és modem még nem fogadott
	  hívást, akkor ez azt jelenit, hogy a
	  <code class="command">getty</code> megnyitotta a
	  kommunikációs csatornát.  Ez utalhat
	  egyaránt egy hibás kábelre vagy a modem
	  helytelen beállítására, mivel a
	  <code class="command">getty</code> egészen addig nem lesz
	  képes megnyitni az adott portot, amíg a modem
	  vissza nem küld neki egy <acronym class="acronym">CD</acronym> (Carrier
	  Detect) jelet.</p><p>Ha a listában az adott
	  <code class="filename">ttydN</code>
	  eszközhöz semmilyen <code class="command">getty</code>
	  programot nem találunk, akkor újra
	  nézzük át az <code class="filename">/etc/ttys</code>
	  állományban szereplõ bejegyzéseket,
	  mert elõfordulhat, hogy azokban vétettünk
	  valamilyen hibát.  Emellett még a
	  <code class="filename">/var/log/messages</code> naplóban is
	  érdemes utánanézni, hátha az
	  <code class="command">init</code> vagy a <code class="command">getty</code>
	  küldött valamilyen hibáról
	  értesítést.  Ha még ezek
	  után sem találunk semmit, akkor megint
	  kezdjük el keresni hibákat, hiányzó
	  bejegyzéseket vagy eszközöket az
	  <code class="filename">/etc/ttys</code>,
	  <code class="filename">/etc/gettytab</code> és a megfelelõ
	  <code class="filename">/dev/ttydN</code>
	  állományokban.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94583632"></a>26.4.6.2. A betárcsázás
	  kipróbálása</h4></div></div></div><p>Próbáljunk meg bejutni a rendszerünkbe.
	  Ehhez a távoli rendszeren ne felejtsük el
	  beállítani a 8 bites adatátvitelt
	  és az 1 stopbitet, illetve a paritást
	  kikapcsolni.  Ha erre közvetlenül nem kapunk egy
	  bejelentkezési képernyõt vagy csak
	  szemét jelenik meg, akkor kb.
	  másodpercenként egyszer nyomjuk le az
	  <span class="keycap"><strong>Enter</strong></span> billentyût.  Ha még
	  ezután sem látjuk a bejelentkezési
	  képernyõt felbukkani, akkor
	  próbáljunk kiküldeni egy
	  <code class="command">BREAK</code> parancsot.  Ha a
	  híváshoz nagysebességû modemet
	  használunk, akkor próbáljuk meg a modem
	  sebességét rögzíteni és
	  úgy tárcsázni (ezt például
	  a <span class="trademark">U.S. Robotics</span>(R) <span class="trademark">Sportster</span>(R) modemnél az
	  <code class="command">AT&amp;B1</code> paranccsal tudjuk
	  elérni):</p><p>Ha viszont még ezek után sem kapjuk meg a
	  bejelentkezõ képernyõt, akkor a
	  <code class="filename">/etc/gettytab</code> állományban
	  megint nézzük át az összes
	  beállítást:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Az <code class="filename">/etc/ttys</code>
	      állományban megadott alaptulajdonság
	      neve egyezik az <code class="filename">/etc/gettytab</code>
	      állományban
	      találhatóval.</p></li><li class="listitem"><p>Mindegyik <code class="literal">nx=</code> bejegyzés
	      után egy másik <code class="filename">gettytab</code>
	      tulajdonság neve jön.</p></li><li class="listitem"><p>Mindegyik <code class="literal">tc=</code> bejegyzés
	      után egy másik <code class="filename">gettytab</code>
	      tulajdonság neve következik.</p></li></ul></div><p>Ha hívunk, de a FreeBSD rendszerünkre kapcsolt
	  modem továbbra sem veszi fel, akkor a modem
	  beállításai között
	  ellenõrizzük, hogy a <acronym class="acronym">DTR</acronym> jel
	  küldésekor a modem fogadja-e a
	  hívást.  Ha úgy tûnik, hogy a modem
	  minden ezzel kapcsolatos beállítása
	  stimmel, akkor nézzük meg, hogy a modem
	  lámpái közül a DTR
	  világít-e (már ha van ilyen).</p><p>Ha mindent többször is
	  végignéztünk és még mindig
	  nem leljük a megoldást, akkor tartsunk egy kis
	  szünetet és térjünk vissza a
	  problémához késõbb.  Ha még
	  ezután sem tudjuk mûködésre
	  bírni, akkor küldjünk egy levelet a
	  <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-questions" target="_top">FreeBSD general questions levelezési lista</a> címére, amelyben leírjuk a
	  modemünket és a vele kapcsolatos
	  problémát, és a lista tagjai majd
	  megpróbálnak nekünk segíteni.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="term.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="serialcomms.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="dialout.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">26.3. Terminálok </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 26.5. A betárcsázós
      szolgáltatások használata</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>