<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>24.2. A FreeBSD frissítése</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="updating-upgrading.html" title="24. fejezet - A FreeBSD frissítése és frissen tartása" /><link rel="prev" href="updating-upgrading.html" title="24. fejezet - A FreeBSD frissítése és frissen tartása" /><link rel="next" href="updating-upgrading-portsnap.html" title="24.3. A Portgyûjtemény frissítése a Portsnap használatával" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">24.2. A FreeBSD frissítése</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="updating-upgrading.html">Vissza</a> </td><th width="60%" align="center">24. fejezet - A FreeBSD frissítése és frissen
    tartása</th><td width="20%" align="right"> <a accesskey="n" href="updating-upgrading-portsnap.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="updating-upgrading-freebsdupdate"></a>24.2. A FreeBSD frissítése</h2></div><div><span class="authorgroup">Írta: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Rhodes</span>, <span class="firstname">Tom</span></span>. </span></div><div><span class="authorgroup">A megíráshoz felhasznált
	    jegyzeteket készítette: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Percival</span>, <span class="firstname">Colin</span></span>. </span></div></div></div><a id="idp92784976" class="indexterm"></a><a id="idp92785488" class="indexterm"></a><p>A biztonsági javítások
      telepítése minden
      számítógépes szoftver,
      különösen az operációs rendszerek
      számára lényeges mozzanat.  Nagyon
      hosszú ideig ez a FreeBSD esetében nem volt
      könnyen megoldható: a javításokat
      közvetlenül a forráskódon kellett
      elvégezni, ezekbõl újrafordítani a
      rendszert, majd telepíteni.</p><p>Ez a nehézség mostanra viszont már
      elhárult, mivel a FreeBSD legfrissebb verziói már
      tartalmaznak egy <code class="command">freebsd-update</code> nevû
      segédprogramot, amellyel mindez leegyszerûsödik.
      Ez a program két külön funkciót lát
      el.  Elõször is, lehetõvé teszi, hogy a FreeBSD
      alaprendszer újrafordítása és
      -telepítése nélkül javítsunk
      biztonsági és egyéb apró
      hibákat, valamint másodsorban támogatja a
      kisebb és nagyobb verziójú kiadások
      közti váltást.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ezek a bináris frissítések azonban csak
	a FreeBSD biztonsági csapata által is felügyelt
	architektúrák és kiadások
	esetén érhetõek el.  Emellett bizonyos
	lehetõségek használatához,
	például a FreeBSD verziói közti
	átállás támogatásához
	a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=freebsd-update&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">freebsd-update</span>(8)</span></a> legújabb változata
	szükségeltetik.  Ezért ne felejtsük el
	alaposan átolvasni a legújabb
	kiadásokról szóló
	bejelentéseket mielõtt frissítenénk
	rájuk, mivel ezzel kapcsolatban fontos
	információkat tartalmazhatnak.  Az említett
	bejelentések a <code class="uri"><a class="uri" href="http://www.FreeBSD.org/releases/" target="_top">http://www.FreeBSD.org/releases/</a></code> címen
	érhetõek el.</p></div><p>Ha a <code class="command">crontab</code> már hivatkozik a
      <code class="command">freebsd-update</code> programra, akkor a most
      következõ mûvelet elkezdése elõtt
      tiltsuk le.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="freebsdupdate-config-file"></a>24.2.1. A konfigurációs állományok</h3></div></div></div><p>Ha változtatnénk szeretnénk a
	frissítési folyamaton, ekkor a programhoz
	tartozó, <code class="filename">/etc/freebsd-update.conf</code>
	nevû konfigurációs állományt
	kell módosítanunk.  Az opciók
	részletes ismertetéssel rendelkeznek, habár
	némelyiknél még további
	magyarázat kellhet:</p><pre class="programlisting"># Az alaprendszerben frissíteni kívánt komponensek
Components src world kernel</pre><p>Ezzel a paraméterrel határozhatjuk meg, hogy a
	FreeBSD mely részei kerüljenek frissítésre.
	Alapértelmezés szerint a program frissíti a
	forrásokat, a teljes alaprendszert és a
	rendszermagot.  Komponensként a
	telepítésnél választható
	elemeket adhatjuk meg, például "world/games"
	hozzáadásakor a games kategória elemei is
	folyamatosan frissülni fognak.  Az "src/bin"
	megadásakor pedig az <code class="filename">src/bin</code> könyvtár
	tartalma frissül.</p><p>Ezt a beállítást a legjobb meghagyni az
	alapértelmezett értéken, mivel a
	további elemek megadásánál
	egyenként fel kell sorolni a frissítendõ
	komponenseket.  Ha itt viszont kifelejtünk valamit, akkor
	könnyen megeshet, hogy a források és a
	binárisok verziója elcsúszik
	egymástól.</p><pre class="programlisting"># Az IgnorePaths beállítás után megadott szövegre illeszkedõ összes
# bejegyzés frissítése kimarad
IgnorePaths</pre><p>Ennél a beállításnál
	azokat a könyvtárakat kell megadnunk, amelyeket
	(és tartalmukat) ki szeretnénk hagyni a
	frissítés során.  Ezek lehetnek
	például a <code class="filename">/bin</code> vagy az <code class="filename">/sbin</code>.  Így meg tudjuk
	akadályozni, hogy <code class="command">freebsd-update</code>
	esetleg felülírjon valamilyen helyi
	változtatást a rendszerünkben.</p><pre class="programlisting"># Az UpdateIfUnmodified beállítás után megadott elérési útvonalakon csak
# a felhasználó által még nem módosított állományok fognak frissülni
# (hacsak a módosításokat össze nem fésüljük, lásd lentebb)
UpdateIfUnmodified /etc/ /var/ /root/ /.cshrc /.profile</pre><p>A megadott könyvtárakban csak azokat a
	konfigurációs állományokat fogja
	frissíteni, amelyeket nem változtattuk meg.
	Amennyiben bármelyikük eltér az eredetileg
	frissítendõ változattól, azt a program
	nem módosítja.  Létezik egy másik
	hasonló beállítás, a
	<code class="literal">KeepModifiedMetadata</code>, amely
	hatására a <code class="command">freebsd-update</code> az
	összefésülés során elmenti a
	változtatásokat.</p><pre class="programlisting"># A MergeChanges beállításnál szereplõ állományok helyi módosításait
# automatikusan összefésüljük a FreeBSD újabb verziójára frissítése közben
MergeChanges /etc/ /var/named/etc/</pre><p>Itt azokat a könyvtárakat adhatjuk meg,
	amelyekben a <code class="command">freebsd-update</code>
	számára engedélyezzük a
	konfigurációs állományok új
	verziójának
	összefésülését a jelenlegi
	állapottal.  Az összefésülés
	lényegében a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a>
	használatánál már megszokott
	módon, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> formátumban érkezõ
	módosítások sorozata alapján
	történik.  Ekkor egy szövegszerkesztõ
	segítségével felügyelhetjük az
	összefésülés menetét vagy
	megállíthatjuk a <code class="command">freebsd-update</code>
	futását.  Ha kétségeink
	adódnak, akkor egyszerûen mentsük le az
	<code class="filename">/etc</code>
	könyvtárat és fogadjuk el mindegyik
	összefésülés eredményét.
	A <code class="command">mergemaster</code>
	mûködésérõl a <a class="xref" href="makeworld.html#mergemaster" title="24.7.11.1. A mergemaster">24.7.11.1. szakasz - A <code class="command">mergemaster</code></a> ad részletesebb
	tájékoztatást.</p><pre class="programlisting"># A FreeBSD frissítésekor ezt a könyvtárat fogja a program használni a
# letöltött módosítások és az egyéb ideiglenes állományok tárolására
# WorkDir /var/db/freebsd-update</pre><p>Az itt megadott könyvtárba fognak kerülni
	az elvégzendõ módosítások
	és az egyéb ideiglenesen keletkezõ
	állományok.  A verziók közti
	váltás során ebben a
	könyvtárban ajánlott legalább
	1 GB szabad tárterületnek lennie.</p><pre class="programlisting"># A kiadások közti váltás során a Components beállításnál megadott
# elemek kerüljenek csak frissítésre (StrictComponents yes), vagy a
# program próbálja meg magától kitalálni, hogy milyen komponesek
# *lehetnek* fenn a rendszeren és azokat frissítse (StrictComponents
# no)?
# StrictComponents no</pre><p>Ha ennél a beállításnál a
	<code class="literal">yes</code> értéket adjuk meg, akkor a
	<code class="command">freebsd-update</code> feltételezni fogja,
	hogy a <code class="literal">Components</code> opciónál
	felsoroltunk minden frissítendõ komponenst és
	nem próbál meg mást is
	megváltoztatni.  Ilyenkor tehát a
	<code class="command">freebsd-update</code> tulajdonképpen
	egyedül csak a <code class="literal">Components</code> által
	meghatározott elemekhez tartozó
	állományokat fogja frissíteni.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="freebsdupdate-security-patches"></a>24.2.2. Biztonsági javítások</h3></div></div></div><p>A biztonsági javítások mindig egy
	távoli gépen tárolódnak, a
	következõ parancsok használatával
	tölthetõek le és
	telepíthetõek:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update fetch</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>freebsd-update install</code></strong></pre><p>Amennyiben a rendszermagot is érintik
	javítások, úgy a rendszert a mûvelet
	befejezõdésével újra kell
	indítanunk.  Ha minden a megfelelõ módon
	történt, akkor a rendszerünk már
	tartalmazni fogja a korábban letöltött
	és telepített javításokat, és
	a <code class="command">freebsd-update</code> akár
	beállítható egy naponta
	végrehajtandó <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a> feladatnak.  Ehhez
	mindössze a következõ bejegyzést kell
	elhelyeznünk az <code class="filename">/etc/crontab</code>
	állományban:</p><pre class="programlisting">@daily                                  root    freebsd-update cron</pre><p>A bejegyzés szerint naponta egyszer le fog futni a
	<code class="command">freebsd-update</code>.  Ilyenkor, vagyis a
	<code class="option">cron</code> paraméter megadásakor a
	<code class="command">freebsd-update</code> csak ellenõrzi, hogy
	vannak-e telepítendõ frissítések.  Ha
	talál, akkor automatikusan letölti ezeket a lemezre,
	de nem telepíti.  Helyette levélben
	értesíti a <code class="systemitem">root</code>
	felhasználót, aki ezután bármikor
	manuálisan kérheti a
	telepítést.</p><p>Probléma esetén az alábbi paranccsal
	megkérhetjük a <code class="command">freebsd-update</code>
	programot a legutóbb telepített
	módosítások
	visszavonására:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update rollback</code></strong></pre><p>Ha ez a visszavonás a rendszermagra vagy annak
	moduljaira is vonatkozott, akkor a rendszert újra kell
	indítanunk a parancs futásának
	befejezõdésével.  A FreeBSD csak ilyenkor
	képes betölteni az új binárisokat
	betölteni a memóriába.</p><p>A <code class="command">freebsd-update</code>
	önmagától csak a <code class="literal">GENERIC</code>
	típusú rendszermagokat képes
	frissíteni.  Ha saját rendszermagot
	használunk, akkor azt a rendszer többi
	komponensének frissítését
	követõen újra kell fordítanunk és
	telepítenünk.  A <code class="command">freebsd-update</code>
	azonban még akkor is érzekelni és
	frissíteni fogja a <code class="literal">GENERIC</code>
	rendszermagot (amennyiben az létezik), ha az éppen
	nem az aktuális(an futó) rendszermag.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Mindig érdemes tartani egy másolatot a
	  <code class="literal">GENERIC</code> rendszermagról a <code class="filename">/boot/GENERIC</code>
	  könyvtárban.  Rengeteg
	  különbözõ probléma
	  felderítésében tud segíteni,
	  illetve ez a <a class="xref" href="updating-upgrading-freebsdupdate.html#freebsdupdate-upgrade" title="24.2.3. Váltás kisebb és nagyobb verziók között">24.2.3. szakasz - Váltás kisebb és nagyobb
	verziók között</a> szakaszban
	  leírt <code class="command">freebsd-update</code> programmal
	  végzett frissítéseknél is hasznos
	  lehet.</p></div><p>Hacsak nem változtatjuk meg az
	<code class="filename">/etc/freebsd-update.conf</code>
	állományt, a <code class="command">freebsd-update</code> a
	rendszermag forrásait is frissíti a többivel
	együtt.  A saját rendszermag
	újrafordítása és
	telepítése ezután a már a megszokott
	módon elvégezhetõ.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">A <code class="command">freebsd-update</code> által
	  terjesztett frissítések nem mindig érintik
	  a rendszermagot.  Ha a rendszermag forrásai nem
	  változnak egy <code class="command">freebsd-update
	    install</code> parancs kiadása során, akkor
	  nem kötelezõ újrafordítani a
	  saját rendszermagot.  A
	  <code class="command">freebsd-update</code> viszont mindig
	  módosítani fogja a
	  <code class="filename">/usr/src/sys/conf/newvers.sh</code>
	  állományt.  Itt az aktuális
	  hibajavítás sorszáma szerepel (amelyet a
	  <code class="literal">-p</code> (mint <span class="quote">"<span class="quote">patch
	    level</span>"</span> elõtaggal kapcsolnak a rendszer
	  verziójához, és a <code class="command">uname
	    -r</code> paranccsal lehet lekérdezni).  Ennek
	  megfelelõen tehát a saját rendszermag
	  újrafordítása után, még ha
	  semmi más nem is változott, a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=uname&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">uname</span>(1)</span></a>
	  képes pontosan jelezni a rendszerhez
	  készült hibajavítás
	  sorszámát.  Ez különösen fontos
	  több rendszer karbantartása során, mivel
	  így könnyen és gyorsan
	  tájékozódhatunk azok
	  naprakészségérõl.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="freebsdupdate-upgrade"></a>24.2.3. Váltás kisebb és nagyobb
	verziók között</h3></div></div></div><p>Verziók közti váltás során
	a külsõ alkalmazások
	mûkõdését akadályozó
	régi tárgykódok és
	függvénykönyvtárak törlõdni
	fognak.  Ezért javasoljuk, hogy vagy
	töröljük le az összes portot és
	telepítsük újra, vagy az alaprendszer
	frissítése után hozzuk ezeket is
	naprakész állapotba a <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/portupgrade/pkg-descr">ports-mgmt/portupgrade</a>
	segédprogram segítségével.
	Elõször minden bizonnyal szeretnék
	kipróbálni a frissítést, ezt a
	következõ paranccsal tehetjük meg:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portupgrade -af</code></strong></pre><p>Ezzel gondoskodunk róla, hogy a minden a
	megfelelõen telepítõdjön újra.  Ha a
	<code class="envar">BATCH</code> környezeti változót a
	<code class="literal">yes</code> értékre
	állítjuk, akkor a folyamat során
	megjelenõ összes kérdésre automatikusan
	a <code class="literal">yes</code> választ adjuk, ezáltal
	önállósítani tudjuk.</p><p>Ha saját rendszermagot használunk, akkor
	ennél valamivel azért több feladatunk van.
	Szükségünk lesz a <code class="literal">GENERIC</code>
	rendszermagot egy példányára, amelyet
	másoljunk a <code class="filename">/boot/GENERIC</code>
	könyvtárba.  Amennyiben nincs
	<code class="literal">GENERIC</code> típusú rendszermag a
	rendszerünkön, a következõ módok
	valamelyikén keresztül tudunk szerezni:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Ha a saját rendszermagot még csak egyszer
	    fordítottuk, akkor a <code class="filename">/boot/kernel.old</code>
	    könyvtárban még
	    megtalálható a <code class="literal">GENERIC</code>.
	    Ezt nevezzük át egyszerûen <code class="filename">/boot/GENERIC</code>
	    könyvtárra.</p></li><li class="listitem"><p>Ha fizikailag hozzá tudunk férni az
	    érintett géphez, akkor a
	    <code class="literal">GENERIC</code> egy
	    példányát akár CD-rõl is
	    átmásolhatjuk.  Helyezzük be a
	    telepítõlemezt és adjuk ki a
	    következõ parancsokat:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /cdrom</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /cdrom/X.Y-RELEASE/kernels</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>./install.sh GENERIC</code></strong></pre><p>Itt a <code class="filename">X.Y-RELEASE</code>
	    könyvtár nevében
	    értelemszerûen helyettesítsük be az
	    általunk használt változatot.  A
	    <code class="literal">GENERIC</code> rendszermag ekkor
	    alapértelmezés szerint a <code class="filename">/boot/GENERIC</code>
	    könyvtárba kerül.</p></li><li class="listitem"><p>Ha az elõbbiek közül egyik sem
	    lehetséges, akkor a <code class="literal">GENERIC</code>
	    rendszermagot közvetlenül akár
	    forrásból is lefordíthatjuk és
	    telepíthetjük:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>env DESTDIR=/boot/GENERIC make kernel</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv /boot/GENERIC/boot/kernel/* /boot/GENERIC</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm -rf /boot/GENERIC/boot</code></strong></pre><p>A <code class="command">freebsd-update</code> akkor fogja ezt
	    <code class="literal">GENERIC</code> rendszermagként
	    felismerni, ha a hozzá tartozó
	    konfigurációs állományt nem
	    módosítjuk.  Továbbá javasoljuk,
	    hogy semmilyen speciális
	    beállítást ne alkalmazzunk a
	    fordítás során (érdemes
	    üresen hagyni ehhez az
	    <code class="filename">/etc/make.conf</code>
	    állományt).</p></li></ul></div><p>Nem kötelezõ újraindítani a
	rendszert a <code class="literal">GENERIC</code> rendszermaggal.</p><p>A <code class="command">freebsd-update</code> képes
	frissíteni rendszerünket egy adott kiadásra.
	Például a következõ paraméterek
	megadásával válthatunk a FreeBSD 6.4
	használatára:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update -r 6.4-RELEASE upgrade</code></strong></pre><p>A parancs elindulása után nem sokkal, a
	váltáshoz szükséges
	információk
	összegyûjtéséhez a
	<code class="command">freebsd-update</code> elemzi a
	konfigurációs állományában
	megadott beállításokat és a rendszer
	jelenleg használt verzióját.  A
	képernyõn ekkor sorban megjelennek a program
	részérõl érzékelt és nem
	érzékelt komponensek.  Mint például
	ahogy itt látható:</p><pre class="screen">Looking up update.FreeBSD.org mirrors... 1 mirrors found.
Fetching metadata signature for 6.3-RELEASE from update1.FreeBSD.org... done.
Fetching metadata index... done.
Inspecting system... done.

The following components of FreeBSD seem to be installed:
kernel/smp src/base src/bin src/contrib src/crypto src/etc src/games
src/gnu src/include src/krb5 src/lib src/libexec src/release src/rescue
src/sbin src/secure src/share src/sys src/tools src/ubin src/usbin
world/base world/info world/lib32 world/manpages

The following components of FreeBSD do not seem to be installed:
kernel/generic world/catpages world/dict world/doc world/games
world/proflibs

Does this look reasonable (y/n)? y</pre><p>Ekkor a <code class="command">freebsd-update</code>
	megpróbálja letölteni a verziók
	közti váltáshoz szükséges
	összes állományt.  Bizonyos esetekben
	kérdésekkel fordul a felhasználó
	felé arra vonatkozóan, hogy miket
	telepítsen fel vagy mit csináljon.</p><p>A saját rendszermag használatakor az
	iménti lépés valamilyen ehhez hasonló
	figyelmeztetést fog adni:</p><pre class="screen">WARNING: This system is running a "<em class="replaceable"><code>SAJÁT RENDSZERMAG</code></em>" kernel, which is not a
kernel configuration distributed as part of FreeBSD 6.3-RELEASE.
This kernel will not be updated: you MUST update the kernel manually
before running "/usr/sbin/freebsd-update install"</pre><p>Ez a figyelmeztetés most nyugodtan figyelmen
	kívül hagyható.  A folyamat során a
	frissített <code class="literal">GENERIC</code> rendszermagot
	fogjuk használni.</p><p>A javítások letöltését
	követõen megkezdõdik a
	telepítésük.  A váltás ezen
	lépése az adott gép aktuális
	terhelésétõl és
	sebességétõl függõen
	változó hosszúságú lehet.
	Ezután a konfigurációs
	állományok összefésülése
	zajlik le - itt általában a emberi
	felügyeletre is szükség van az
	állományok
	összefésülésének
	irányításához, amelynek folyamatosan
	láthatóak az eredményei.  A
	meghiúsult vagy kihagyott
	összefésülések a teljes
	frissítési folyamat leállását
	vonják maguk után.  Az <code class="filename">/etc</code> könyvtárban
	tárolt fontosabb állományokról, mint
	például a <code class="filename">master.passwd</code> vagy
	<code class="filename">group</code> javasolt elõzetesen
	biztonsági mentést készíteni
	és késõbb kézzel hozzájuk adni
	a változtatásaikat.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">A rendszerben ekkor még nem lesz jelen semmilyen
	  konkrét változás, az összes
	  említett javítás és
	  összefésülés egy külön
	  könyvtárban történik.  A
	  telepített javításokat és az
	  összefésült konfigurációs
	  állományokat a folyamat végén
	  magának a felhasználónak kell
	  véglegesíteni.</p></div><p>A frissítési eljárás
	végén a következõ parancs
	kiadásával tudjuk ténylegesen
	érvényesíteni az eddig elvégzett
	módosításokat:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update install</code></strong></pre><p>Elõször mindig a rendszermag és a
	hozzá tartozó modulok cserélõdnek le.
	Ahogy ez végrehajtódott, újra kell
	indítanunk a rendszert.  Ha saját rendszermagot
	használunk, akkor a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=nextboot&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">nextboot</span>(8)</span></a> parancs
	segítségével állítsuk be a
	következõ rendszerindítás során
	betöltendõ rendszermagot a <code class="filename">/boot/GENERIC</code>
	könyvtárban levõre (ezt
	frissítettük):</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>nextboot -k GENERIC</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Figyelem: </h3><p xmlns="http://www.w3.org/1999/xhtml">Mielõtt újraindítanánk a
	  gépünket a <code class="literal">GENERIC</code>
	  rendszermaggal, gyõzõdjünk meg róla,
	  hogy szerepel benne minden olyan meghajtó, amely
	  elengedhetetlen a rendszer hiánytalan
	  indításához (és képes lesz
	  újra csatlakozni a hálózathoz, ha
	  éppen távolról adminisztráljuk).
	  Ez különösen olyan esetben fontos, amikor a
	  saját rendszermagunkban beépítetten
	  szerepeltek bizonyos modulok.  Ilyenkor a
	  <code class="literal">GENERIC</code> rendszermag használatakor
	  ezeket a <code class="filename">/boot/loader.conf</code>
	  állományon keresztül töltethetjük
	  be ideiglenesen.  A frissítés
	  befejezéséig érdemes viszont minden nem
	  létfontosságú szolgáltatást
	  leállítani, leválasztani lemezeket
	  és hálózati megosztásokat
	  stb.</p></div><p>A rendszerünk most már
	újraindítható a frissített
	rendszermaggal:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>shutdown -r now</code></strong></pre><p>A rendszer sikeres újraindulása után
	ismét el kell indítanunk a
	<code class="command">freebsd-update</code> programot, amely
	korábban már elmentette a frissítés
	állapotát, emiatt a legutóbbi
	pontról fog folytatódni, illetve törli az
	osztott könyvtárak és
	tárgykódok régebbi változatait.
	Innen az alábbi paranccsal léphetünk
	tovább:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update install</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">A függvénykönyvtárak
	  verziói közti eltérések
	  mértékétõl függõen
	  elképzelhetõ, hogy a telepítés az
	  említett három fázis helyett
	  kettõben történik.</p></div><p>Most pedig újra kell fordítanunk vagy
	telepítenünk az összes általunk
	korábban használt külsõ
	alkalmazást.  Erre azért van
	szükségünk, mert bizonyos alkalmazások a
	verziók közti váltás során
	törölt programkönyvtáraktól
	függtek.  Ennek automatizálásában a
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/portupgrade/pkg-descr">ports-mgmt/portupgrade</a> lesz
	segítségünkre.  Az alkalmazások
	frissítésének
	elindításához a következõ
	parancsokat használjuk:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portupgrade -f ruby</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm /var/db/pkg/pkgdb.db</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>portupgrade -f ruby18-bdb</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm /var/db/pkg/pkgdb.db /usr/ports/INDEX-*.db</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>portupgrade -af</code></strong></pre><p>A parancsok lefutását követõen a
	<code class="command">freebsd-update</code> utolsó
	hívásával zárjuk le a
	frissítést.  Ezzel a paranccsal tudunk
	tehát pontot tenni a frissítési
	procedúra végére:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update install</code></strong></pre><p>Ha a <code class="literal">GENERIC</code> rendszermagot csak
	átmenetileg használtuk, akkor most már a
	megszokott módon fordíthatunk és
	telepíthetünk magunk egy saját
	rendszermagot.</p><p>Indítsuk újra a rendszert a FreeBSD
	frissített változatával.  A folyamat ezzel
	véget ért.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="freebsdupdate-system-comparison"></a>24.2.4. Rendszerek állapotainak
	összehasonlítása</h3></div></div></div><p>A <code class="command">freebsd-update</code> ragyogóan
	felhasználható a FreeBSD egy telepített
	változatának és egy általunk
	garantáltan megbízható
	példányának
	összevetésére.  Ilyenkor a rendszerhez
	tartozó segédprogramokat,
	programkönyvtárakat és
	konfigurációs állományokat
	ellenõriztethetjük le.  Az
	összehasonlítást ezzel a paranccsal
	kezdhetjük meg:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update IDS &gt;&gt; eredmeny.idk</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Figyelem: </h3><p xmlns="http://www.w3.org/1999/xhtml">Habár a parancs neve <acronym class="acronym">IDS</acronym>
	  (intrusion detection system), nem helyettesít semmilyen
	  olyan behatolásjelzõ megoldást, mint
	  amilyen például a <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/snort/pkg-descr">security/snort</a>.  Mivel a
	  <code class="command">freebsd-update</code> adatokat tárol a
	  lemezen, teljesen kézenfekvõ a
	  hamisítás lehetõsége.  Míg
	  ennek eshetõsége adott mértékben
	  visszaszorítható a
	  <code class="varname">kern.securelevel</code>
	  csökkentésével és a
	  <code class="command">freebsd-update</code> által használt
	  adatok írásvédett
	  állományrendszerre helyezésével,
	  erre a problémára az ideális
	  megoldást mégis egy teljes biztonságban
	  tudható referencia rendszer jelentheti.  Ennek
	  tárolására alkalmas lehet
	  például egy <acronym class="acronym">DVD</acronym> vagy egy
	  külsõ <acronym class="acronym">USB</acronym>-egység.</p></div><p>A parancs kiadása után megkezdõdik a
	rendszer vizsgálata, és az ellenõrzés
	során folyamatosan jelennek meg az
	átvizsgált állományok a
	hozzájuk tartozó ismert és
	kiszámított <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sha256&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">sha256</span>(1)</span></a>-kódjukkal
	együtt.  Mivel a képernyõn
	túlságosan gyorsan elúsznának az
	eredmények, ezért ezeket egy
	<code class="filename">eredmeny.idk</code> nevû
	állományba mentjük a késõbbi
	elemzésekhez.</p><p>Az így keletkezõ állomány sorai
	ugyan meglehetõsen hosszúak, de szerencsére
	viszonylag könnyen értelmezhetõek.
	Például az adott kiadásban szereplõ
	állományoktól eltérõeket ezzel
	a paranccsal kérdezhetjük le:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cat eredmeny.idk | awk '{ print $1 }' | more</code></strong>
/etc/master.passwd
/etc/motd
/etc/passwd
/etc/pf.conf</pre><p>A példában most csak az elsõ
	néhány állományt hagytuk meg, gyakran
	tapasztalhatunk viszont ennél többet.  Ezek
	közül bizonyos állományok
	értelemszerûen eltérnek, mint itt
	például az <code class="filename">/etc/passwd</code>, mert
	idõközben új felhasználókat
	adtunk a rendszerhez.  Máskor egyéb
	állományok, például modulok nevei is
	felbukkanhatnak, mert tegyük fel, hogy a
	<code class="command">freebsd-update</code> már frissítette
	ezeket.  Ha ki szeretnénk zárni valamilyen
	állományokat vagy könyvtárakat az
	ellenõrzésbõl, egyszerûen csak soroljuk
	fel ezeket az <code class="filename">/etc/freebsd-update.conf</code>
	állományban megjelenõ
	<code class="literal">IDSIgnorePaths</code>
	beállításnál.</p><p>A korábban tárgyaltaktól
	függetlenül ez a rendszer alkalmas bonyolultabb
	frissítési folyamatok
	kisegítésére is.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="updating-upgrading.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="updating-upgrading.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="updating-upgrading-portsnap.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">24. fejezet - A FreeBSD frissítése és frissen
    tartása </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 24.3. A Portgyûjtemény frissítése a
      Portsnap használatával</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>