<?xml version="1.0" encoding="iso-8859-2"?>
<!-- $FreeBSD$ -->
<!--

  Implementing UFS Journaling on a desktop PC

  The FreeBSD Documentation Project

-->
<!-- The FreeBSD Hungarian Documentation Project
     Translated by: PALI, Gabor <pgj@FreeBSD.org>
     %SOURCE%   en_US.ISO8859-1/articles/gjournal-desktop/article.xml
     %SRCID%    1.5
-->
<article xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:lang="hu">
  <info><title xmlns:xlink="http://www.w3.org/1999/xlink">Naplózó UFS használata asztali
      számítógépeken</title>
    

    <author xmlns:xlink="http://www.w3.org/1999/xlink"><personname xmlns:xlink="http://www.w3.org/1999/xlink"><firstname xmlns:xlink="http://www.w3.org/1999/xlink">Manolis</firstname><surname xmlns:xlink="http://www.w3.org/1999/xlink">Kiagias</surname></personname><affiliation xmlns:xlink="http://www.w3.org/1999/xlink">
	<address xmlns:xlink="http://www.w3.org/1999/xlink"><email xmlns:xlink="http://www.w3.org/1999/xlink">manolis@FreeBSD.org</email></address>
      </affiliation></author>

    <copyright xmlns:xlink="http://www.w3.org/1999/xlink">
      <year xmlns:xlink="http://www.w3.org/1999/xlink">2008</year>
      <holder xmlns:xlink="http://www.w3.org/1999/xlink" role="mailto:manolis@FreeBSD.org">Manolis Kiagias</holder>
    </copyright>

    <pubdate xmlns:xlink="http://www.w3.org/1999/xlink">$FreeBSD$</pubdate>

    <releaseinfo xmlns:xlink="http://www.w3.org/1999/xlink">$FreeBSD$</releaseinfo>

    <legalnotice xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="trademarks" role="trademarks">
      <para xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">A FreeBSD a FreeBSD Foundation
  bejegyzett védjegye.</para>
      <para xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">A gyártók és terjesztõk által
  használt megnevezések közül sok védjegy
  jogot követel.  Ahol ilyen megnevezés tûnik fel ebben
  a dokumentumban, és a FreeBSD Projektnek tudomása volt a
  védjegyrõl, a megnevezést a <quote xmlns:xlink="http://www.w3.org/1999/xlink">TM</quote> vagy a
  <quote xmlns:xlink="http://www.w3.org/1999/xlink">(R)</quote> szimbólum követi.</para>
    </legalnotice>

    <abstract xmlns:xlink="http://www.w3.org/1999/xlink">
      <para xmlns:xlink="http://www.w3.org/1999/xlink">A naplózó állományrendszerek egy
	napló segítségével
	rögzítik az összes bennük lezajlott
	tranzakciót, ezzel igyekszenek megõrizni egy
	rendszeromlást vagy áramkimaradást
	követõen a rajtuk tárolt adatok
	épségét.  Noha még így is
	elõfordulhat, hogy elveszítjük az adott
	pillanatban el nem mentett változtatásainkat, a
	naplózás viszont az állományrendszer
	számára tökéletes védelmet
	nyújt a rendszer szabálytalan
	leállása során keletkezõ
	sérülések ellen.  Alkalmazása
	továbbá jelentõs mértékben
	lerövidíti a helyreállításhoz
	szükséges ellenõrzés idejét.  A
	FreeBSD alaprendszerben megtalálható UFS
	állományrendszer önmagában nem
	tartalmaz naplózást, azonban a
	FreeBSD 7.<replaceable xmlns:xlink="http://www.w3.org/1999/xlink">X</replaceable> változataiban
	már megjelent egy olyan GEOM-osztály, amellyel az
	állományrendszertõl független
	módon ezt meg tudjuk valósítani.  Ebben a
	cikkben bemutatjuk miként alakítsunk ki UFS
	alapú naplózást egy hétköznapi
	asztali számítógépen.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink"><emphasis xmlns:xlink="http://www.w3.org/1999/xlink">Fordította: Páli Gábor,
	utolsó ellenõrzés:
	2010.11.28.</emphasis></para>
    </abstract>
  </info>

  <sect1 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="introduction">
    <title xmlns:xlink="http://www.w3.org/1999/xlink">Bevezetés</title>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">Míg az ipari szervereket általában
      alaposan felkészítik az esetlegesen
      bekövetkezõ váratlan leállásokra,
      addig egy átlagos asztali
      számítógép teljesen
      kiszolgáltatott az áramkimaradások, a
      véletlen újraindítások és
      minden más olyan beavatkozás számára,
      amelyek a rendszer nem szabályos
      leállását eredményezik.  A Soft
      Updates ilyen helyzetekben általában
      hatékonyan védelmezi az
      állományrendszert, ez azonban a legtöbb esetben
      egy hosszadalmasabb háttérbeli
      ellenõrzést von maga után.  Nagyon
      ritkán viszont az állományrendszer olyan
      mértékben károsodik, hogy a
      helyreállításához már
      felhasználói beavatkozás
      szükségeltetik és gyakran adatvesztéssel
      is jár.</para>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">A GEOM alrendszerhez nemrég hozzáadott új
      naplózási képesség az ilyen
      szituációkban remekül alkalmazható,
      és ennek köszönhetõen szinte
      egyáltalán nem igényel idõt a
      sérült állományrendszer
      ellenõrzése, illetve gondoskodik a legutolsó
      stabil állapot villámgyors
      visszaállításáról.</para>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">Ebben a cikkben bemutatunk egy eljárást, amely
      segítségével UFS
      állományrendszerekhez tudunk naplózást
      beállítani hagyományos asztali
      számítógépeken
      (feltételezzük, hogy az operációs
      rendszer és az adatok egyetlen merevlemezen helyezkednek
      el).  A folyamatot a FreeBSD telepítésén
      keresztül ismertetjük, és olyan lépesekre
      bontottuk, hogy lehetõleg kerüljük a bonyolultabb
      parancssori mûveleteket.</para>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">A cikk elolvasása során megismerjük:</para>

    <itemizedlist xmlns:xlink="http://www.w3.org/1999/xlink">
      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">a FreeBSD telepítése során hogyan
	  hagyjunk helyet a napló számára;</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">hogyan töltsük be és
	  engedélyezzük a <literal xmlns:xlink="http://www.w3.org/1999/xlink">geom_journal</literal>
	  modult (vagy építsük be egy saját
	  rendszermagba);</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">hogyan alakítsuk át a már
	  meglevõ állományrendszereinket
	  naplózóvá, az
	  <filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc/fstab</filename> állományban
	  milyen beállításokat kell megadnunk a
	  csatlakoztatásukhoz;</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">hogyan állítsuk be a naplózást
	  új (üres) partíciókon;</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">hogyan oldjuk meg a naplózással kapcsolatban
	  leggyakrabban jelentkezõ problémákat.</para>
      </listitem>
    </itemizedlist>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">A cikk elolvasásához ajánlott:</para>

    <itemizedlist xmlns:xlink="http://www.w3.org/1999/xlink">
      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">a <trademark xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" class="registered">UNIX</trademark> és a FreeBSD alapvetõ fogalmainak
      ismerete;</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">a FreeBSD telepítés menetének és
	  a <application xmlns:xlink="http://www.w3.org/1999/xlink">sysinstall</application> alkalmazás
	  ismerete.</para>
      </listitem>
    </itemizedlist>

    <warning xmlns:xlink="http://www.w3.org/1999/xlink">
      <para xmlns:xlink="http://www.w3.org/1999/xlink">Az itt megadott eljárás alapvetõen egy
	új rendszer telepítésének
	esetére vonatkozik, ahol még semmilyen
	felhasználói adatot nem tárolunk a lemezen.
	Természetesen ez a módszer
	átültethetõ mûködõ, éles
	rendszerekre is, azonban ilyenkor mindig
	készítsünk <emphasis xmlns:xlink="http://www.w3.org/1999/xlink">biztonsági
	mentést</emphasis> mielõtt nekikezdenénk.
	Ugyanis amikor ilyen alacsony szinten dolgozunk lemezekkel
	és partíciókkal, bármilyen hiba
	könnyedén végzetesnek bizonyulhat az
	adatainkra nézve.</para>
    </warning>
  </sect1>

  <sect1 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="understanding-journaling">
    <title xmlns:xlink="http://www.w3.org/1999/xlink">Naplózás FreeBSD alatt</title>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">A FreeBSD 7.<replaceable xmlns:xlink="http://www.w3.org/1999/xlink">X</replaceable>
      változataiban a GEOM részérõl
      felkínált naplózási
      lehetõség (eltérõen például
      a <trademark xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" class="registered">Linux</trademark> típusú rendszerekben
      található ext3
      állományrendszertõl) nem kötõdik
      konkrét állományrendszerhez, de blokkok
      szintjén üzemel.  Habár ez arra utal, hogy
      különbözõ állományrendszerek
      esetén is használható, a FreeBSD 7.0-RELEASE
      kiadásában még csak az UFS2 felett
      mûködik.</para>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">Ezt a funkciót a <filename xmlns:xlink="http://www.w3.org/1999/xlink">geom_journal.ko</filename>
      modul betöltésével (vagy rendszermagba
      építésével) tudjuk aktiválni,
      majd a <command xmlns:xlink="http://www.w3.org/1999/xlink">gjournal</command> paranccsal érjük el
      az állományrendszerek
      konfigurációjához szükséges
      felületet.  Általában nagyobb
      állományrendszereken, például a
      <filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> partíción érdemes
      engedélyezni a naplózást.  Nem szabad
      elfelejtenünk, hogy ehhez azonban fenn kell tartanunk
      némi szabad területet a lemezen (errõl a
      következõ szakaszban lesz szó).</para>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">Amikor egy állományrendszeren bekapcsoljuk a
      naplózást, magát a naplót is
      tárolnunk kell valahol a lemezen.  A tényleges
      adatokat tároló lemezterületet
      <emphasis xmlns:xlink="http://www.w3.org/1999/xlink">adatterületnek</emphasis>, míg a
      naplót tároló területet pedig
      <emphasis xmlns:xlink="http://www.w3.org/1999/xlink">naplóterületnek</emphasis> nevezzük.
      Ha egy meglevõ (nem üres) partícióhoz
      akarunk naplózást társítani, akkor az
      adat- és naplóterületeknek külön
      partíciókon kell lenniük.  Amikor viszont egy
      teljesen új partícióhoz kapcsolunk
      naplózást, lehetõségünk van
      egyetlen területen tárolni az adatokat és a
      naplót.  Bármelyik esettel is van dolgunk, a
      <command xmlns:xlink="http://www.w3.org/1999/xlink">gjournal</command> parancs a naplózó
      állományrendszer véglegesített
      változatát ezen két fajta terület
      egyesítésébõl hozza létre.
      Például:</para>

    <itemizedlist xmlns:xlink="http://www.w3.org/1999/xlink">
      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">A <filename xmlns:xlink="http://www.w3.org/1999/xlink">/dev/ad0s1f</filename>
	  eszközön található
	  <filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> állományrendszeren
	  szeretnénk naplózást használni
	  (amely már eleve tartalmaz hasznos adatokat).</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">A partíciók létrehozása
	  során a <filename xmlns:xlink="http://www.w3.org/1999/xlink">/dev/ad0s1g</filename> eszközön
	  lefoglaltunk valamennyi helyet.</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">A <command xmlns:xlink="http://www.w3.org/1999/xlink">gjournal</command> parancs
	  segítségével készítünk
	  egy <filename xmlns:xlink="http://www.w3.org/1999/xlink">/dev/ad0s1f.journal</filename>
	  eszközt, ahol a <filename xmlns:xlink="http://www.w3.org/1999/xlink">/dev/ad0s1f</filename> eszközön
	  tároljuk az adatokat és a <filename xmlns:xlink="http://www.w3.org/1999/xlink">/dev/ad0s1g</filename> eszközön a
	  naplót.  A továbbiakban ezt az új
	  eszközt fogjuk használni.</para>
      </listitem>
    </itemizedlist>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">A napló számára fenntartott hely
      mennyisége nem az adatok méretétõl, hanem
      az állományrendszer
      terheltségétõl függ.
      Például egy átlagos irodai
      számítógép esetén a
      <filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> állományrendszerhez
      nagyjából egy 1 GB méretû
      naplózási terület remekül megfelel,
      viszont egy terheltebb rendszer (amellyel például
      videoanyagok vágását végezzük)
      számára ennél több kellhet.  A
      naplóterület idõ elõtti
      kimerülése a rendszermag
      összeomlásával jár.</para>

    <note xmlns:xlink="http://www.w3.org/1999/xlink">
      <para xmlns:xlink="http://www.w3.org/1999/xlink">A cikkben javasolt méretek
	használatával nagyon
	valószínûtlen, hogy hétköznapi
	feladataink (böngészés az interneten,
	szövegszerkesztés, különbözõ
	multimédia anyagok lejátszása) közben
	bármilyen problémát
	észlelnénk.  Ha viszont a lemezünk
	tartósabb terhelés alatt van, a
	következõ szabály betartásával
	érhetjük el a legjobb eredményt: a
	számítógépünkben levõ
	központi memória teljes tartalmának mindig el
	kell tudnia férni a naplóterület
	egyharmadán.  Tehát például ha a
	rendszerünk 1 GB memóriával rendelkezik,
	akkor egy közel 3,3 GB méretû
	naplóterület ajánlott.
	(Általánosan: Úgy kapjuk meg a
	naplóterület méretét, ha megszorozzuk
	a memória méretet 3,3-mal.)</para>
    </note>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">A naplózásról részleteiben a
      <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">gjournal</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">8</manvolnum></citerefentry> man oldalon olvashatunk.</para>
  </sect1>

  <sect1 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="reserve-space">
    <title xmlns:xlink="http://www.w3.org/1999/xlink">A FreeBSD telepítése során
      elvégzendõ lépések</title>

    <sect2 xmlns:xlink="http://www.w3.org/1999/xlink">
      <title xmlns:xlink="http://www.w3.org/1999/xlink">Lemezterület lefoglalása a
	naplónak</title>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Az asztali számítógépekben
	többnyire csupán egyetlen merevlemez
	található, amelyen maga az operációs
	rendszer és az adatok helyezkednek el.  A
	<application xmlns:xlink="http://www.w3.org/1999/xlink">sysinstall</application> által
	felajánlott alapértelmezett
	partícionálási séma
	alkalmassága vitatható: egy asztali gép
	esetén például nincs
	szükségünk akkora <filename xmlns:xlink="http://www.w3.org/1999/xlink">/var</filename>
	partícióra, viszont a <filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename>
	foglalja el a merevlemez legnagyobb részét, hiszen
	a felhasználók adatai és a rendszerre
	telepített csomagok ide fognak kerülni.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Az alapértelmezés szerinti felosztás
	(amely a <application xmlns:xlink="http://www.w3.org/1999/xlink">Disklabel</application>
	partíciószerkesztõben az <keycap xmlns:xlink="http://www.w3.org/1999/xlink">A</keycap>
	billentyûvel érhetõ el) nem hagy semennyi
	lemezterületet szabadon.  Ahány
	partíciót naplózással akarunk
	ellátni, annyi további partícióra
	lesz szükségünk a naplókhoz.  Mivel a
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> lesz közülük a
	legnagyobb, próbáljuk meg ezen
	partíció méretének
	csökkentésével helyet csinálni a
	naplónak.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">A példában most egy 80 GB
	méretû lemezt láthatunk.  Az
	ábrán most a telepítés közben a
	<application xmlns:xlink="http://www.w3.org/1999/xlink">Disklabel</application> szerint
	alapértelmezetten kiosztott partíciókat
	láthatjuk:</para>

      <mediaobject xmlns:xlink="http://www.w3.org/1999/xlink">
	<imageobject xmlns:xlink="http://www.w3.org/1999/xlink">
	  <imagedata fileref="disklabel1"/>
	</imageobject>
      </mediaobject>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Amennyiben ez körülbelül megfelelõ a
	számunkra, akkor innen már nagyon egyszerû
	elõkészíteni a napló helyét.  A
	nyilak használatával válasszuk ki a
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> partíciót és a
	<keycap xmlns:xlink="http://www.w3.org/1999/xlink">D</keycap> billentyû lenyomásával
	töröljük le.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Ezután válasszuk ki a képernyõ
	felsõ részében a lemez nevét, majd a
	<keycap xmlns:xlink="http://www.w3.org/1999/xlink">C</keycap> billentyû lenyomásával
	hozzunk létre egy új partíciót a
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> számára.  Ez viszont
	legyen most 1 GB-tal (ha napló csak a
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> mellé lesz) vagy 2 GB-tal
	(ha egyaránt naplózni akarjuk a
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> és <filename xmlns:xlink="http://www.w3.org/1999/xlink">/var</filename>
	partíciókat is) kisebb.  A felbukkanó
	ablakban válasszuk az állományrendszer
	létrehozását és a
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> könyvtárat adjuk meg
	csatlakozási pontként.</para>

      <note xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">Szükségünk van-e naplóra a
	  <filename xmlns:xlink="http://www.w3.org/1999/xlink">/var</filename> partícióhoz?  A
	  naplózásnak alapvetõen csak
	  óriási méretû
	  partíciók esetében van értelme.
	  Ennek megfelelõen nem kell feltétlenül
	  engedélyeznünk a naplózást a
	  <filename xmlns:xlink="http://www.w3.org/1999/xlink">/var</filename> partíción is,
	  habár egy asztali gép esetében ez sosem
	  árthat.  Ha ezt az állományrendszert alig
	  használjuk (ami nagyon valószínû egy
	  asztali gépnél), kevesebb területet is
	  rendelhetünk a naplóhoz.</para>

	<para xmlns:xlink="http://www.w3.org/1999/xlink">A példánkban a <filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename>
	  és <filename xmlns:xlink="http://www.w3.org/1999/xlink">/var</filename> partíciókhoz
	  is kapcsoltunk naplókat.  Természetesen a
	  módszer ezen lépése igény szerint
	  megváltoztatható.</para>
      </note>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Mivel továbbra sem szeretnénk
	elbonyolítani a lépéseket, ezért a
	naplózás bevezetéséhez
	szükséges partíciók
	létrehozását szintén a
	<application xmlns:xlink="http://www.w3.org/1999/xlink">sysinstall</application>
	segítésével végezzük.  A
	telepítés közben a
	<application xmlns:xlink="http://www.w3.org/1999/xlink">sysinstall</application> feltétlenül
	ragaszkodik ahhoz, hogy minden létrehozott
	partícióhoz csatlakozási pontot is
	megadjunk.  A naplókat tároló
	partíciókhoz viszont ilyen nem tartozik, sõt,
	<emphasis xmlns:xlink="http://www.w3.org/1999/xlink">egyáltalán nem is kell</emphasis>.  Ezek
	ugyanis nem olyan hétköznapi
	partíciók, amelyeket bármikor is
	csatlakoztatni fogunk.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">A <application xmlns:xlink="http://www.w3.org/1999/xlink">sysinstall</application> használata
	során ezt a problémát úgy tudjuk
	elkerülni, ha a naplózásnak szánt
	partíciókat lapozóterületként
	adjuk meg.  A lapozóterületet sem kell soha
	csatlakoztatni, és a
	<application xmlns:xlink="http://www.w3.org/1999/xlink">sysinstall</application> ezekbõl
	tetszõleges mennyiségût képes
	készíteni.  A telepítést
	követõ újraindítás után
	természetesen majd át kell szerkesztenünk az
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc/fstab</filename> állományban az
	így létrehozott partíciók
	jellemzõit.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Lapozóterület
	kialakításához ismét a
	nyílbillentyûk használatával
	navigáljunk a <application xmlns:xlink="http://www.w3.org/1999/xlink">Disklabel</application>
	alkalmazáshoz tartozó képernyõ
	felsõ részébe és válasszuk ki a
	lemez nevét.  Ezután nyomjuk le az
	<keycap xmlns:xlink="http://www.w3.org/1999/xlink">N</keycap> billentyût, majd adjuk meg a
	kívánt méretet
	(<replaceable xmlns:xlink="http://www.w3.org/1999/xlink">1024M</replaceable>) és a
	következõ menübõl válasszuk a
	<quote xmlns:xlink="http://www.w3.org/1999/xlink">swap space</quote> (lapozóterület)
	típust.  Ismételjük meg az iménti
	mûveletet az összes napló esetén.  A
	példánkban ezen a módon
	készítettünk egy naplót a
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename>, és még egyet a
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/var</filename> állományrendszer
	számára.  A végeredmény a
	következõ képen látható:</para>

      <mediaobject xmlns:xlink="http://www.w3.org/1999/xlink">
	<imageobject xmlns:xlink="http://www.w3.org/1999/xlink">
	  <imagedata fileref="disklabel2"/>
	</imageobject>
      </mediaobject>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Javasoljuk, ahogy befejeztük a partíciók
	létrehozását, jegyezzük fel a neveiket
	és a hozzá tartozó csatlakozási
	pontokat, így a soron következõ
	konfigurációs lépésekben
	könnyebben tudunk majd velük dolgozni.  Ez egyben
	segít mérsékelni a telepítést
	károsító hibák
	elkövetésének esélyét.  A
	következõ táblázatban a
	példában említett
	konfigurációhoz vettük fel ezeket az
	adatokat:</para>

      <table xmlns:xlink="http://www.w3.org/1999/xlink" pgwide="1">
	<title xmlns:xlink="http://www.w3.org/1999/xlink">Partíciók és naplók</title>

	<tgroup xmlns:xlink="http://www.w3.org/1999/xlink" cols="3">
	<thead xmlns:xlink="http://www.w3.org/1999/xlink">
	  <row xmlns:xlink="http://www.w3.org/1999/xlink">
	    <entry xmlns:xlink="http://www.w3.org/1999/xlink">Partíció</entry>
	    <entry xmlns:xlink="http://www.w3.org/1999/xlink">Csatlakozási pont</entry>
	    <entry xmlns:xlink="http://www.w3.org/1999/xlink">Napló</entry>
	  </row>
	</thead>

	<tbody xmlns:xlink="http://www.w3.org/1999/xlink">
	  <row xmlns:xlink="http://www.w3.org/1999/xlink">
	    <entry xmlns:xlink="http://www.w3.org/1999/xlink">ad0s1d</entry>
	    <entry xmlns:xlink="http://www.w3.org/1999/xlink">/var</entry>
	    <entry xmlns:xlink="http://www.w3.org/1999/xlink">ad0s1h</entry>
	  </row>

	  <row xmlns:xlink="http://www.w3.org/1999/xlink">
	    <entry xmlns:xlink="http://www.w3.org/1999/xlink">ad0s1f</entry>
	    <entry xmlns:xlink="http://www.w3.org/1999/xlink">/usr</entry>
	    <entry xmlns:xlink="http://www.w3.org/1999/xlink">ad0s1g</entry>
	  </row>
	</tbody>
	</tgroup>
      </table>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Ezután a megszokott módon folytassuk a
	telepítést.  Javasoljuk azonban, hogy a
	külsõ alkalmazásokat (csomagokat) addig
	még ne tegyünk fel a rendszerünkre, amíg
	teljesen be nem fejeztük a naplózás
	beállítását.</para>
    </sect2>

    <sect2 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="first-boot">
      <title xmlns:xlink="http://www.w3.org/1999/xlink">A rendszer elsõ indítása</title>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">A rendszerünk a szokásos módon fog
	indulni, de a naplók számára
	hozzáadott plusz lapozóterületekhez
	tartozó bejegyzéseket el kell
	távolítanunk az <filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc/fstab</filename>
	állományból.  A lapozóterületek
	közül ténylegesen lapozásra
	általában a <quote xmlns:xlink="http://www.w3.org/1999/xlink">b</quote> (tehát a
	példánkban az <filename xmlns:xlink="http://www.w3.org/1999/xlink">ad0s1b</filename>)
	partíciót érdemes meghagyni.  Az
	összes többit egyszerûen töröljük
	ki, indítsuk újra a rendszerünket és a
	FreeBSD már nem fogja tovább használni
	ezeket.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Ahogy a rendszer újra elindul, készen is
	állunk a naplózás
	beállítására.</para>
    </sect2>
  </sect1>

  <sect1 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="configure-journal">
    <title xmlns:xlink="http://www.w3.org/1999/xlink">A naplózás
      beállítása</title>

    <sect2 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="running-gjournal">
      <title xmlns:xlink="http://www.w3.org/1999/xlink">A <command xmlns:xlink="http://www.w3.org/1999/xlink">gjournal</command> futtatása</title>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">A naplózást nagyon könnyû lesz
	beállítani miután már
	elõkészítettük az ehhez
	szükséges partíciókat.
	Váltsunk át egyfelhasználós
	módba, tehát jelentkezzünk be
	<systemitem xmlns:xlink="http://www.w3.org/1999/xlink" class="username">root</systemitem> felhasználóként
	és gépeljük be:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">shutdown now</userinput></screen>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Ezután az <keycap xmlns:xlink="http://www.w3.org/1999/xlink">Enter</keycap> billentyû
	lenyomásával megkapjuk az alapértelmezett
	parancsértelmezõt.  Válasszuk le azokat a
	partíciókat, amelyeken engedélyezni
	kívánjuk a naplózást.  Ezek a
	példánkban a <filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> és
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/var</filename> partíciók voltak:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">umount /usr /var</userinput></screen>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Töltsük be a naplózáshoz
	szükséges modult:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal load</userinput></screen>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Most pedig a korábbi feljegyzéseink
	alapján állapítsuk meg melyik
	naplóhoz melyik partíciót fogjuk rendelni.
	A példánkban a <filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename>
	csatlakozási ponthoz az <filename xmlns:xlink="http://www.w3.org/1999/xlink">ad0s1f</filename> eszköz tartozik,
	és ennek a naplója az <filename xmlns:xlink="http://www.w3.org/1999/xlink">ad0s1g</filename> eszköz lesz,
	miközben a <filename xmlns:xlink="http://www.w3.org/1999/xlink">/var</filename> ponthoz az <filename xmlns:xlink="http://www.w3.org/1999/xlink">ad0s1d</filename> eszközt
	rendeltük, és ezt az <filename xmlns:xlink="http://www.w3.org/1999/xlink">ad0s1h</filename> eszközön
	naplózzuk.  Ennek megfelelõen a következõ
	parancsokat kell kiadnunk:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal label ad0s1f ad0s1g</userinput>

GEOM_JOURNAL: Journal 2948326772: ad0s1f contains data.
GEOM_JOURNAL: Journal 2948326772: ad0s1g contains journal.

<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal label ad0s1d ad0s1h</userinput>

GEOM_JOURNAL: Journal 3193218002: ad0s1d contains data.
GEOM_JOURNAL: Journal 3193218002: ad0s1h contains journal.</screen>

      <note xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">A <command xmlns:xlink="http://www.w3.org/1999/xlink">gjournal</command> hibát fog jelezni, ha
	  bármelyik partíció utolsó szektora
	  már használatban van.  Ilyen helyzetekben az
	  <option xmlns:xlink="http://www.w3.org/1999/xlink">-f</option> kapcsoló
	  segítségével
	  felülírásra tudjuk
	  kényszeríteni a parancsot, mint
	  például:</para>

	<screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal label -f ad0s1d ad0s1h</userinput></screen>

	<para xmlns:xlink="http://www.w3.org/1999/xlink">Mivel most telepítettük a rendszerünket,
	  elég kicsi a valószínûsége,
	  hogy így bármit is ténylegesen
	  felülírnánk.</para>
      </note>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Létrejött két új eszköz,
	név szerint az <filename xmlns:xlink="http://www.w3.org/1999/xlink">ad0s1d.journal</filename> és az
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">ad0s1f.journal</filename>.  Ezek
	képviselik azokat a <filename xmlns:xlink="http://www.w3.org/1999/xlink">/var</filename> és
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> partíciókat, amelyeket
	valójában csatlakoztatnunk kell.  A
	csatlakoztatásuk elõtt azonban
	állítsuk be hozzájuk a
	naplózást és tiltsuk le a Soft Updates
	használatát:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">tunefs -J enable -n disable ad0s1d.journal</userinput>

tunefs: gjournal set
tunefs: soft updates cleared

<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">tunefs -J enable -n disable ad0s1f.journal</userinput>

tunefs: gjournal set
tunefs: soft updates cleared</screen>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Ezt követõen parancssorból csatlakoztassuk
	az új eszközöket a nekik megfelelõ pontokra
	(itt most már használhatjuk az
	<option xmlns:xlink="http://www.w3.org/1999/xlink">async</option> beállítást):</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">mount -o async /dev/ad0s1d.journal /var</userinput>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">mount -o async /dev/ad0s1f.journal /usr</userinput></screen>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Nyissuk meg az <filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc/fstab</filename>
	állományt, és az elõbbiek szerint
	javítsuk ki a <filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr</filename> és a
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/var</filename> állományrendszerekhez
	tartozó bejegyzéseket:</para>

      <programlisting xmlns:xlink="http://www.w3.org/1999/xlink">/dev/ad0s1f.journal     /usr            ufs     rw,async      2       2
/dev/ad0s1d.journal     /var            ufs     rw,async      2       2</programlisting>

      <warning xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">Figyelmesen ellenõrizzük a bejegyzéseket,
	  mert ha hibásan adjuk meg ezeket, akkor az
	  újraindítás után gondok lehetnek a
	  rendszer indításával!</para>
      </warning>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Végezetül gondoskodjunk róla, hogy a
	<citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">gjournal</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">8</manvolnum></citerefentry> modul minden egyes indítás
	során betöltõdjön.  Ehhez nyissuk meg a
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/boot/loader.conf</filename> állományt
	és adjuk hozzá a következõ sort:</para>

      <programlisting xmlns:xlink="http://www.w3.org/1999/xlink">geom_journal_load="YES"</programlisting>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Gratulálunk, sikeresen beállítottuk a
	rendszerünkön a naplózást!  Innen vagy az
	<userinput xmlns:xlink="http://www.w3.org/1999/xlink">exit</userinput> begépelésével
	lépjünk vissza a többfelhasználós
	módba, vagy egy újraindítással
	próbáljuk ki a konfiguráció
	eredményét (mi ezt javasoljuk).  A
	rendszerindítás során a
	következõhöz hasonló üzeneteket kell
	majd látnunk:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink">ad0: 76293MB XEC XE800JD-00HBC0 08.02D08 at ata0-master SATA150
GEOM_JOURNAL: Journal 2948326772: ad0s1g contains journal.
GEOM_JOURNAL: Journal 3193218002: ad0s1h contains journal.
GEOM_JOURNAL: Journal 3193218002: ad0s1d contains data.
GEOM_JOURNAL: Journal ad0s1d clean.
GEOM_JOURNAL: Journal 2948326772: ad0s1f contains data.
GEOM_JOURNAL: Journal ad0s1f clean.</screen>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Szabálytalan leállások esetén az
	iménti üzenetek némileg változhatnak,
	például:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink">GEOM_JOURNAL: Journal ad0s1d consistent.</screen>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Ez általában arra utal, hogy a
	<citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">gjournal</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">8</manvolnum></citerefentry> a naplóterületen tárolt
	információk segítségével
	helyreállította az
	állományrendszert.</para>
    </sect2>

    <sect2 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="gjournal-new">
      <title xmlns:xlink="http://www.w3.org/1999/xlink">A naplózás engedélyezése
	frissen létrehozott partíciókon</title>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Míg az elõbbiekben tárgyalt
	megoldást leginkább olyan partíciók
	esetén alkalmazhatjuk, amelyek már eleve
	tartalmaznak adatokat, addig egy újonnan
	létrehozott partíciót némileg
	könnyebb naplózással ellátni, mivel
	ilyenkor az adat- és a naplóterület egyazon
	partíción is kialakítható.
	Például most tegyük fel, hogy
	hozzáadtunk egy újabb lemezt a
	rendszerünkhöz, amelyen
	készítettünk egy új <filename xmlns:xlink="http://www.w3.org/1999/xlink">/dev/ad1s1d</filename> nevû
	partíciót.  A napló
	létrehozása ekkor csupán ennyi:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal label ad1s1d</userinput></screen>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">A napló mérete alapértelmezés
	szerint 1 GB lesz, amelyet viszont a <option xmlns:xlink="http://www.w3.org/1999/xlink">-s</option>
	opció használatával tetszés szerint
	átállíthatunk.  Az értéket
	megadhatjuk byte-okban, vagy a <literal xmlns:xlink="http://www.w3.org/1999/xlink">K</literal>,
	<literal xmlns:xlink="http://www.w3.org/1999/xlink">M</literal>, illetve <literal xmlns:xlink="http://www.w3.org/1999/xlink">G</literal>
	hozzáfûzésével kilobyte-okban,
	megabyte-okban, illetve gigabyte-okban is.  Arra azonban
	figyeljünk, hogy a <command xmlns:xlink="http://www.w3.org/1999/xlink">gjournal</command> nem enged
	túlságosan kis méretû naplót
	létrehozni.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Például egy 2 GB méretû
	napló az alábbi paranccsal hozható
	létre:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal label -s 2G ad1s1d</userinput></screen>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Mellé hozzunk létre egy
	állományrendszert az új
	partíción, ahol a <option xmlns:xlink="http://www.w3.org/1999/xlink">-J</option>
	kapcsolóval engedélyezzük a
	naplózást:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">newfs -J /dev/ad1s1d.journal</userinput></screen>
    </sect2>

    <sect2 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="configure-kernel">
      <title xmlns:xlink="http://www.w3.org/1999/xlink">A naplózás támogatásának
	beépítése a rendszermagba</title>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Amennyiben nem kívánjuk betölteni a
	<literal xmlns:xlink="http://www.w3.org/1999/xlink">geom_journal</literal> modult,
	lehetõségünk van közvetlenül a
	rendszermagba beépíteni a
	hozzá tartozó funkcionalitást.  Ehhez
	nyissunk meg (vagy hozzunk létre) egy saját
	rendszermag-konfigurációs állományt,
	és vegyük fel benne a következõ két
	sort:</para>

      <programlisting xmlns:xlink="http://www.w3.org/1999/xlink">options UFS_GJOURNAL # Megjegyzés: Ez része a GENERIC rendszermagnak
options GEOM_JOURNAL # Ezt se felejtsük ki</programlisting>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">A <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="../../../../doc/hu_HU.ISO8859-2/books/handbook/kernelconfig.html">FreeBSD
	kézikönyvben</link> szereplõ
	utasítások mentén fordítsuk le
	és telepítsük az új
	rendszermagot.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Ha korábban használtuk volna a modult, akkor
	ezzel együtt ne felejtsük el kivenni a
	<filename xmlns:xlink="http://www.w3.org/1999/xlink">/boot/loader.conf</filename>
	állományból sem a
	hozzá tartozó sort.</para>
    </sect2>
  </sect1>

  <sect1 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="troubleshooting-gjournal">
    <title xmlns:xlink="http://www.w3.org/1999/xlink">A naplózás használata során
      felmerülõ hibák kezelése</title>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">Ebben a szakaszban a naplózás
      alkalmazásakor jelentkezõ gondokra vonatkozó
      gyakran ismételt kérdéseket foglaljuk
      össze.</para>

    <qandaset xmlns:xlink="http://www.w3.org/1999/xlink">
      <qandaentry xmlns:xlink="http://www.w3.org/1999/xlink">
	<question xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="kernel-panic">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">A rendszer folyamatosan összeomlik komolyabb
	    lemezterhelés mellett.  Van ennek valamilyen köze
	    a naplózáshoz?</para>
	</question>

	<answer xmlns:xlink="http://www.w3.org/1999/xlink">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">A napló ilyenkor valószínûleg
	    gyorsabban betelik, mint ahogy kiíródhatna a
	    lemezre.  Nem szabad elfeledkeznünk róla, hogy
	    a napló méretének sosem az
	    adatterület méretével kell
	    arányosnak lennie, hanem a lemez
	    terheltségével.  Ha tehát a lemezeink
	    nagyobb terhelés alatt vannak, akkor egy nagyobb
	    területet kell hozzárendelnünk a
	    naplóhoz.  Ezzel kapcsolatban lásd a <link xmlns:xlink="http://www.w3.org/1999/xlink" linkend="understanding-journaling">Naplózás
	    FreeBSD alatt</link> címû szakaszt.</para>
	</answer>
      </qandaentry>

      <qandaentry xmlns:xlink="http://www.w3.org/1999/xlink">
	<question xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="unable-boot">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Valamit nem sikerült rendesen
	    beállítani a konfiguráció
	    során, ezért most nem indul a rendszer.  Meg
	    lehet valahogy javítani?</para>
	</question>

	<answer xmlns:xlink="http://www.w3.org/1999/xlink">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Ilyenkor vagy elfelejtettük (vagy netalán
	    elírtuk) a <filename xmlns:xlink="http://www.w3.org/1999/xlink">/boot/loader.conf</filename>
	    állományban szükséges
	    bejegyzést, vagy az <filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc/fstab</filename>
	    állományunk hibákat tartalmaz.  Az
	    ilyen jellegû problémákat viszonylag
	    könnyû helyrehozni.  Az <keycap xmlns:xlink="http://www.w3.org/1999/xlink">Enter</keycap>
	    billentyû lenyomásával hozzuk elõ az
	    egyfelhasználós módhoz tartozó
	    parancsértelmezõt.  Ha ez sikerült, akkor
	    kutassuk fel a probléma okát:</para>

	  <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">cat /boot/loader.conf</userinput></screen>

	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Ha innen hiányzik vagy nem helyesen szerepel a
	    <literal xmlns:xlink="http://www.w3.org/1999/xlink">geom_journal_load</literal> bejegyzés, akkor a
	    naplózás használatához
	    szükséges eszközök nem fognak
	    létrejönni.  Töltsük be a modult
	    manuálisan, csatlakoztassuk az összes
	    partíciót és folytassuk a
	    többfelhasználós mód
	    indítását:</para>

	  <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal load</userinput>

GEOM_JOURNAL: Journal 2948326772: ad0s1g contains journal.
GEOM_JOURNAL: Journal 3193218002: ad0s1h contains journal.
GEOM_JOURNAL: Journal 3193218002: ad0s1d contains data.
GEOM_JOURNAL: Journal ad0s1d clean.
GEOM_JOURNAL: Journal 2948326772: ad0s1f contains data.
GEOM_JOURNAL: Journal ad0s1f clean.

<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">mount -a</userinput>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">exit</userinput>
<emphasis xmlns:xlink="http://www.w3.org/1999/xlink">(a rendszerindítás folytatódik)</emphasis></screen>

	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Ha viszont ezzel a bejegyzéssel kapcsolatban
	    semmilyen hibát nem találtunk, akkor
	    nézzük meg az <filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc/fstab</filename>
	    állományt.  Akkor
	    valószínûleg itt fogunk találni
	    egy hibásan beírt vagy éppen
	    hiányzó bejegyzést.  Amennyiben
	    errõl lenne szó, csatlakoztassuk kézzel a
	    fennmaradó partíciókat és
	    folytassuk a többfelhasználós mód
	    indítását.</para>
	</answer>
      </qandaentry>

      <qandaentry xmlns:xlink="http://www.w3.org/1999/xlink">
	<question xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="remove-journaling">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Visszavonható a naplózás, vissza
	    lehet valahogy térni a Soft Updates
	    használatához?</para>
	</question>

	<answer xmlns:xlink="http://www.w3.org/1999/xlink">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Hogyne.  A most következõ módszer
	    segítségével megfordítható
	    az egész folyamat.  Miután
	    végeztünk, a naplózás
	    részére korábban kialakított
	    partíciók tetszés szerint
	    felhasználhatóak.</para>

	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Jelentkezzük be <systemitem xmlns:xlink="http://www.w3.org/1999/xlink" class="username">root</systemitem>
	    felhasználóként és
	    váltsunk egyfelhasználós
	    módba:</para>

	  <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">shutdown now</userinput></screen>

	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Válasszuk le a naplózást
	    alkalmazó partíciókat:</para>

	  <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">umount /usr /var</userinput></screen>

	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Írassuk ki lemezre a naplók
	    tartalmát:</para>

	  <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal sync</userinput></screen>

	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Állítsuk le a
	    naplózóterületek
	    használatát:</para>

	  <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal stop ad0s1d.journal</userinput>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal stop ad0s1f.journal</userinput></screen>

	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Töröljük le az eszközökön
	    tárolt összes naplózási
	    metainformációt:</para>

	  <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal clear ad0s1d</userinput>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal clear ad0s1f</userinput>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal clear ad0s1g</userinput>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">gjournal clear ad0s1h</userinput></screen>

	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Tiltsuk le az állományrendszer
	    naplózását és
	    állítsuk vissza a Soft Updates
	    használatát:</para>

	  <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">tunefs -J disable -n enable ad0s1d</userinput>

tunefs: gjournal cleared
tunefs: soft updates set

<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">tunefs -J disable -n enable ad0s1f</userinput>

tunefs: gjournal cleared
tunefs: soft updates set</screen>

	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Manuálisan csatlakoztassuk újra a
	    régi eszközöket:</para>

	  <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">mount -o rw /dev/ad0s1d /var</userinput>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">mount -o rw /dev/ad0s1f /usr</userinput></screen>

	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Az <filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc/fstab</filename>
	    állományban állítsunk vissza
	    mindent az eredeti állapotába:</para>

	  <programlisting xmlns:xlink="http://www.w3.org/1999/xlink">/dev/ad0s1f     /usr            ufs     rw      2       2
/dev/ad0s1d     /var            ufs     rw      2       2</programlisting>

	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Végül a
	    <filename xmlns:xlink="http://www.w3.org/1999/xlink">/boot/loader.conf</filename>
	    állományból távolítsuk el
	    a <literal xmlns:xlink="http://www.w3.org/1999/xlink">geom_journal</literal> modul
	    betöltésére vonatkozó
	    bejegyzést és indítsuk újra a
	    rendszert.</para>
	</answer>
      </qandaentry>
    </qandaset>
  </sect1>

  <sect1 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="further-reading">
    <title xmlns:xlink="http://www.w3.org/1999/xlink">Ajánlott olvasmányok</title>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">A naplózás még viszonylag
      újdonságnak számít a FreeBSD
      esetében, ezért nem feltétlenül
      találunk róla túlságosan sok
      dokumentációt.  Ettõl függetlenül
      azonban a következõ források elolvasása
      azért hasznosnak bizonyulhat:</para>

    <itemizedlist xmlns:xlink="http://www.w3.org/1999/xlink">
      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">A FreeBSD kézikönyv naplózással
	  foglalkozó <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="../../../../doc/hu_HU.ISO8859-2/books/handbook/geom-gjournal.html">szakasza</link>.</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">Pawel Jakub Dawidek, a <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">gjournal</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">8</manvolnum></citerefentry> fejlesztõjének a
	  <link xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-current">freebsd-current</link> levelezési listára
	  küldött <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://lists.freebsd.org/pipermail/freebsd-current/2006-June/064043.html">levele</link>.</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">Ivan Voras a <link xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-questions">freebsd-questions</link> levelezési
	  listára küldött <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://lists.freebsd.org/pipermail/freebsd-questions/2008-April/173501.html">levele</link>.</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	<para xmlns:xlink="http://www.w3.org/1999/xlink">A <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">gjournal</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">8</manvolnum></citerefentry> és <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">geom</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">8</manvolnum></citerefentry> man
	  oldalak.</para>
      </listitem>
    </itemizedlist>
  </sect1>
</article>
