<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>14.5. Egyszeri jelszavak</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="security.html" title="14. fejezet - Biztonság" /><link rel="prev" href="crypt.html" title="14.4. DES, Blowfish, MD5 és a Crypt" /><link rel="next" href="tcpwrappers.html" title="14.6. A TCP kapcsolatok burkolása" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">14.5. Egyszeri jelszavak</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="crypt.html">Vissza</a> </td><th width="60%" align="center">14. fejezet - Biztonság</th><td width="20%" align="right"> <a accesskey="n" href="tcpwrappers.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="one-time-passwords"></a>14.5. Egyszeri jelszavak</h2></div></div></div><a id="idp87053136" class="indexterm"></a><a id="idp87053648" class="indexterm"></a><p>A FreeBSD alapértelmezés szerint támogatja
      az OPIE-t (One-time Passwords In Everything, azaz <span class="quote">"<span class="quote">Egyszeri
      jelszavak mindenben</span>"</span>), ami alapból az MD5
      függvényét használja.</p><p>A jelszavak három fajtáját fogjuk a
      továbbiakban tárgyalni.  Az elsõ a megszokott
      <span class="trademark">UNIX</span>(R) stílusú avagy Kerberos jelszó.  Ezt a
      továbbiakban <span class="quote">"<span class="quote"><span class="trademark">UNIX</span>(R) jelszónak</span>"</span>
      nevezzük.  A második fajtában az OPIE
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=opiekey&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">opiekey</span>(1)</span></a> nevû segédprogramja által
      generált és a bejelentkezésnél a
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=opiepasswd&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">opiepasswd</span>(1)</span></a> által elfogadott jelszavak tartoznak.
      Ezeket <span class="quote">"<span class="quote">egyszeri jelszavaknak</span>"</span> fogjuk nevezni.  A
      jelszavak utolsó típusa az a titkos jelszó,
      amit az <code class="command">opiekey</code> programnak (és
      néha a <code class="command">opiepasswd</code> programnak) adunk meg,
      ami ebbõl egyszer használatos jelszavakat
      állít elõ.  Ezt innentõl <span class="quote">"<span class="quote">titkos
      jelszónak</span>"</span> vagy csak egyszerûen
      <span class="quote">"<span class="quote">jelszónak</span>"</span> hívjuk.</p><p>A titkos jelszónak semmi köze sincs a <span class="trademark">UNIX</span>(R)
      jelszavunkhoz.  Természetesen megegyezhetnek, de ezt nem
      ajánljuk.  Az OPIE által használt titkos
      jelszavaknak nem kell a régi <span class="trademark">UNIX</span>(R) jelszavakhoz
      hasonlóan legfeljebb 8 karakteresnek lenniük
      <a href="#ftn.idp87074512" class="footnote" id="idp87074512"><sup class="footnote">[8]</sup></a>, bármekkorát használhatunk.  A
      hat vagy hét szóból álló
      jelszavak ilyenkor igen gyakoriak.  Az OPIE jobbára a
      <span class="trademark">UNIX</span>(R) jelszórendszerétõl teljesen
      függetlenül mûködik.</p><p>A jelszavak mellett két másik fajta adat fontos
      az OPIE számára.  Közülük az egyiket
      <span class="quote">"<span class="quote">magnak</span>"</span> vagy <span class="quote">"<span class="quote">kulcsnak</span>"</span> nevezik, ami
      két betûbõl és öt
      számjegybõl áll.  A másik az
      <span class="quote">"<span class="quote">iterációk száma</span>"</span>, ami egy 1
      és 100 közötti számot takar.  Az OPIE
      úgy hozza létre az egyszeri jelszavakat, hogy
      egymás után fûzi a magot és a titkos
      jelszót, majd az iterációk megadott
      számának megfelelõ mennyiségben
      kiszámolja rá az MD5 függvény
      értékét és az eredményt hat
      rövid angol szóba önti.  Ez a hat angol
      szó lesz a mi egyszeri jelszavunk.  A
      hitelesítéssel foglalkozó rendszer
      (elsõsorban a PAM) figyelemmel kíséri a
      legutoljára használt egyszeri jelszavunkat,
      és csak akkor engedi a felhasználót
      hitelesíteni, ha az általa megadott jelszó
      kódolt változata megegyezik az elõzõleg
      megadott jelszaváéval.  A csapóajtó
      függvények használata miatt lehetetlen
      legenerálni a következõ egyszeri jelszót,
      ha a sikerült megszereznünk az egyiket.  Az
      iterációk száma minden egyes sikeres
      bejelentkezés után csökken eggyel, amivel a
      felhasználót és a bejelentkeztetõ
      programot szinkronban tartja.  Amikor így az
      iterációk száma eléri az egyet, az
      OPIE-t újra kell inicializálni.</p><p>Az említésre kerülõ rendszerek
      mindegyikéhez tartozik néhány program.  Az
      <code class="command">opiekey</code> bekéri az
      iterációk számát, a magot és a
      titkos jelszót, majd elõállít egy
      egyszer használatos jelszót vagy azok folytonos
      listáját.  Az <code class="command">opiepasswd</code> az OPIE
      inicializálásért, a jelszavak, az
      iterációk számának és a mag
      megváltoztatásáért felelõs.
      Egyaránt elfogad titkos jelmondatot,
      iterációs számot vagy magot és egy
      egyszeri jelszót.  Az <code class="command">opieinfo</code>
      megvizsgálja a felhasználókra
      vonatkozó adatbázist
      (<code class="filename">/etc/opiekeys</code>) és kiírja az
      adott felhasználó által használt
      iterációs számot és magot.</p><p>Négyféle különbözõ
      mûveletrõl fogunk most itt beszélni.  Az
      elsõben egy biztonságos kapcsolaton keresztül
      elsõként inicializáljuk az egyszeri
      jelszavakat, vagy megváltoztatjuk a jelszót vagy a
      magot az <code class="command">opiepasswd</code>
      segítségével.  A második
      mûveletben ugyanarra adjuk ki az
      <code class="command">opiepasswd</code> parancsot egy nem biztonságos
      kapcsolaton keresztül az <code class="command">opiekey</code>
      paranccsal együtt egy biztonságos kapcsolaton
      keresztül.  A harmadikban az <code class="command">opiekey</code>
      használatával nem biztonságos kapcsolaton
      keresztül jelentkezünk be.  A negyedikben az
      <code class="command">opiekey</code> paranccsal létrehozunk egy adott
      mennyiségû kulcsot, amelyeket aztán
      leírhatunk vagy kinyomtathatunk, hogy magunkkal tudjuk
      vinni olyan helyre, ahonnan nem tudnk biztonságos
      módon csatlakozni.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87086032"></a>14.5.1. Inicializálás biztonságos
	kapcsolattal</h3></div></div></div><p>Az OPIE elsõ inicializálásához
	adjuk ki az <code class="command">opiepasswd</code> parancsot:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>opiepasswd -c</code></strong>
[grimreaper] ~ $ opiepasswd -f -c
Adding unfurl:
Only use this method from the console; NEVER from remote. If you are using
telnet, xterm, or a dial-in, type ^C now or exit with no password.
Then run opiepasswd without the -c parameter.
Using MD5 to compute responses.
Enter new secret pass phrase:
Again new secret pass phrase:
ID unfurl OTP key is 499 to4268
MOS MALL GOAT ARM AVID COED
</pre><p>A figyelmeztetés fordítása:</p><pre class="screen">Ezt a módszert csak konzolról alkalmazzuk, SOHA ne távoli kapcsolaton
keresztül!  Ha telnetet, xtermet vagy betárcsázós kapcsolatot használunk, akkor
azonnal nyomjunk ^C-t vagy ne adjunk meg jelszót.</pre><p>Az <code class="prompt">Enter new secret pass phrase:</code> vagy
	<code class="prompt">Enter secret password:</code> kérdések
	után adjunk meg egy jelmondatot, illetve jelszót.
	Ne felejtsük el, hogy ez nem bejelentkezéshez
	használt jelszó lesz, hanem ebbõl jönnek
	majd létre az egyszeri kulcsaink.  Az <span class="quote">"<span class="quote">ID</span>"</span>
	sor adja meg az aktuális példányunk
	paramétereit: a bejelentkezéshez használt
	nevünket, az iterációk számát
	és a magot.  Amikor a bejelentkezések során
	a rendszer emlékszik a paraméterekre és
	megjeleníti ezeket, nem kell megjegyeznünk.  Az
	utolsó sor adja meg a paramétereinknek és a
	titkos jelszavunknak megfelelõ egyszeri jelszót.  Ha
	most azonnal akarnánk bejelentkezni, akkor ezt az
	egyszeri jelszót kellene hozzá
	használnunk.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87095120"></a>14.5.2. Inicializálás nem biztonságos
	kapcsolattal</h3></div></div></div><p>Ha egy nem biztonságos kapcsolaton keresztül
	akarjuk inicializálni vagy megváltoztatni a
	jelszavunkat, akkor szükségünk lesz valahol egy
	megbízható kapcsolatra, ahol le tudjuk futtatni az
	<code class="command">opiekey</code> parancsot.  Ez lehet egy
	számunkra biztonsági szempontból
	elfogadható gép parancssora.  Emellett ki kell
	találnunk egy iterációs számot (erre
	a 100 egy jó választás) és adnunk
	egy magot vagy használni egy véletlenszerûen
	generáltat.  Az inicializálás
	színtere felé vezetõ nem biztonságos
	kapcsolaton keresztül adjuk ki az
	<code class="command">opiepasswd</code> parancsot:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>opiepasswd</code></strong>

Updating unfurl:
You need the response from an OTP generator.
Old secret pass phrase:
        otp-md5 498 to4268 ext
        Response: GAME GAG WELT OUT DOWN CHAT
New secret pass phrase:
        otp-md5 499 to4269
        Response: LINE PAP MILK NELL BUOY TROY

ID mark OTP key is 499 gr4269
LINE PAP MILK NELL BUOY TROY
</pre><p>Az alapértelmezett mag elfogadásához
	nyomjuk le a <span class="keycap"><strong>Return</strong></span> billentyût.
	Mielõtt megadnánk a hozzáférés
	jelszavát, menjünk át a biztonságos
	kapcsolatra és adjuk meg neki ugyanezeket a
	paramétereket:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>opiekey 498 to4268</code></strong>
Using the MD5 algorithm to compute response.
Reminder: Don't use opiekey from telnet or dial-in sessions.
Enter secret pass phrase:
GAME GAG WELT OUT DOWN CHAT
</pre><p>Most váltsunk vissza a nem biztonságos
	kapcsolatra és másoljuk be az így
	generált egyszeri jelszót a megfelelõ
	programba.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87100240"></a>14.5.3. Egyetlen egyszeri jelszó
	létrehozása</h3></div></div></div><p>Miután sikeresen inicializáltuk az OPIE-t
	és bejelentkezünk, a következõket
	láthatjuk:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>telnet example.com</code></strong>
Trying 10.0.0.1...
Connected to example.com
Escape character is '^]'.

FreeBSD/i386 (example.com) (ttypa)

login: <strong class="userinput"><code>felhasználói_név</code></strong>
otp-md5 498 gr4269 ext
Password: </pre><p>Mellékesen megjegyezzük, hogy az OPIE
	paranccsorának van egy (itt nem látható)
	hasznos képessége: ha <span class="keycap"><strong>Return</strong></span>
	billentyût nyomunk a jelszó
	bekérésekor, akkor a program megmutatja a
	begépelt betûket, így láthatjuk
	pontosan mit is írunk be.  Ez nagyon kényelmes
	lehet olyankor, amikor valahonnan, például egy
	lapról olvassuk a jelszót.</p><a id="idp87103696" class="indexterm"></a><a id="idp87104208" class="indexterm"></a><a id="idp87104720" class="indexterm"></a><p>A bejelentkezéshez ekkor le kell valahogy
	generálnunk az egyszeri jelszavunkat.  Ezt egy
	megbízható rendszeresen tudjuk megtenni az
	<code class="command">opiekey</code> lefuttatásával.  (Ennek
	vannak DOS-os, <span class="trademark">Windows</span>(R)-os és <span class="trademark">Mac OS</span>(R)-es
	változatai is.) Paraméterként az
	iterációs számot és a magot kell
	megadnunk.  Ezt akár közvetlenül át is
	másolhatjuk annak a gépnek a bejelentkezési
	képernyõjérõl, ahova be akarunk
	jelentkezni.</p><p>A megbízható rendszeren tehát:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>opiekey 498 to4268</code></strong>
Using the MD5 algorithm to compute response.
Reminder: Don't use opiekey from telnet or dial-in sessions.
Enter secret pass phrase:
GAME GAG WELT OUT DOWN CHAT</pre><p>Most már megvan a bejelentkezéshez
	szükséges egyszeri jelszavunk.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87108944"></a>14.5.4. Több egyszeri jelszó
	létrehozása</h3></div></div></div><p>Néha olyan helyekre kell mennünk, ahol se egy
	megbízható gép, sem pedig
	biztonságos kapcsolat nem található.  Ilyen
	esetekben megadhatjuk az <code class="command">opiekey</code> parancsnak,
	hogy elõre gyártson le több egyszer
	használatos jelszót, amit késõbb
	aztán ki tudunk nyomtatni.  Például:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>opiekey -n 5 30 zz99999</code></strong>
Using the MD5 algorithm to compute response.
Reminder: Don't use opiekey from telnet or dial-in sessions.
Enter secret pass phrase: <strong class="userinput"><code>&lt;secret password&gt;</code></strong>
26: JOAN BORE FOSS DES NAY QUIT
27: LATE BIAS SLAY FOLK MUCH TRIG
28: SALT TIN ANTI LOON NEAL USE
29: RIO ODIN GO BYE FURY TIC
30: GREW JIVE SAN GIRD BOIL PHI</pre><p>Az <code class="option">-n 5</code> öt kulcsot kér
	egymás után, a <code class="option">30</code> pedig megadja
	az utolsó iterációs számot.
	Vegyük észre, hogy a kulcsokat a
	felhasználás sorrendjével
	<span class="emphasis"><em>ellentétes</em></span> sorrendben írja ki
	a program.  Ha igazán paranoiások vagyunk, akkor
	írjuk le kézzel a jelszavakat.  Ha viszont annyira
	nem, akkor egyszerûen küldjük át ezeket az
	<code class="command">lpr</code> parancsnak.  Megfigyelhetjük, hogy
	minden sorban látható az iterációs
	szám és a hozzá tartozó egyszeri
	jelszó.  Hasznos lehet a felhasználás
	szerinti felírni a jelszavakat.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87113936"></a>14.5.5. A <span class="trademark">UNIX</span>(R) jelszavak használatának
	leszûkítése</h3></div></div></div><p>Az OPIE képes a bejelentkezéshez
	használt IP-címek alapján
	leszûkíteni a <span class="trademark">UNIX</span>(R) jelszavak
	használatát.  Ehhez az
	<code class="filename">/etc/opieaccess</code> használható,
	amely alapból megtalálható a
	rendszerünkön.  Az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=opieaccess&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">opieaccess</span>(5)</span></a> man
	oldalán találhatjuk meg a rá
	vonatkozó információkat és az
	összes vele kapcsolatos biztonsági
	megfontolást.</p><p>Íme egy példa az
	<code class="filename">opieaccess</code> állományra:</p><pre class="programlisting">permit 192.168.0.0 255.255.0.0</pre><p>Ezzel a sorral megengedjük a <span class="trademark">UNIX</span>(R) jelszavak
	használatát minden olyan felhasználó
	számára, akinek az IP-je illeszkedik a megadott
	címre és maszkra (ez viszont
	álcázással
	kijátszható).</p><p>Ha az <code class="filename">opieaccess</code>
	állományból egyetlen szabály sem
	illeszkedik, akkor alapértelmezés szerint nem
	engedélyezettek a nem OPIE típusú
	jelszavak.</p></div><div class="footnotes"><br /><hr class="footnote-hr" /><div id="ftn.idp87074512" class="footnote"><p><a href="#idp87074512" class="para"><sup class="para">[8] </sup></a>FreeBSD alatt a bejelentkezéshez használt
	  szabványos jelszavak akár 128 karakteresek is
	  lehetnek.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="crypt.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="security.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="tcpwrappers.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">14.4. DES, Blowfish, MD5 és a Crypt </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 14.6. A TCP kapcsolatok burkolása</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>