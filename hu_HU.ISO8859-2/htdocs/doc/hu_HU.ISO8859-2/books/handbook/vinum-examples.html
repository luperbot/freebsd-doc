<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>21.6. Példák</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="vinum-vinum.html" title="21. fejezet - A Vinum kötetkezelõ" /><link rel="prev" href="vinum-objects.html" title="21.5. A Vinum objektumai" /><link rel="next" href="vinum-object-naming.html" title="21.7. Az objektumok elnevezése" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">21.6. Példák</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="vinum-objects.html">Vissza</a> </td><th width="60%" align="center">21. fejezet - A Vinum kötetkezelõ</th><td width="20%" align="right"> <a accesskey="n" href="vinum-object-naming.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="vinum-examples"></a>21.6. Példák</h2></div></div></div><p>A Vinum a rendszerben ismert objektumokkal kapcsolatos
      információkat egy
      <span class="emphasis"><em>konfigurációs
      adatbázis</em></span>ban tartja fenn.  Kezdetben a
      felhasználó egy vagy több
      konfigurációs állomány
      segítségével hozza létre ezt az
      adatbázist a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gvinum&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gvinum</span>(8)</span></a> segédprogrammal.  A
      Vinum ezt a konfigurációs adatbázist
      bemásolja mindegyik irányítása alatt
      álló slice-ba (melyek a Vinum
      <span class="emphasis"><em>eszköz</em></span>nek hív).  Az
      adatbázis minden egyes állapotváltás
      folyamán frissül, így egy
      újraindítás után minden egyes
      Vinum-objektum állapota pontosan
      helyreállítódik.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91942608"></a>21.6.1. A konfigurációs
	állomány</h3></div></div></div><p>A konfigurációs állomány
	írja le az egyes objektumokat.  Egy egyszerûbb
	kötet definíciója így nézhet
	ki:</p><pre class="programlisting">
    drive a device /dev/da3h
    volume myvol
      plex org concat
        sd length 512m drive a</pre><p>Ez az állomány négy Vinum-objektumot
	definiál:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A <span class="emphasis"><em>drive</em></span> kezdetû sor adja meg a
	    lemez partícióját
	    (<span class="emphasis"><em>meghajtó</em></span>ját) és a
	    hardveren levõ elhelyezkedését.  Az
	    <span class="emphasis"><em>a</em></span> szimbolikus nevet kapta.  A
	    szimbolikus és a konkrét eszköznevek
	    szétválasztásával
	    lehetõvé válik, hogy a lemezek
	    félreértések nélkül
	    átkerülhessek egyik helyrõl a
	    másikra.</p></li><li class="listitem"><p>A <span class="emphasis"><em>volume</em></span> kezdetû sor adja meg
	    a kötetet.  Itt az egyetlen szükséges
	    jellemzõ a név, ami ebben az esetben a
	    <span class="emphasis"><em>myvol</em></span>.</p></li><li class="listitem"><p>A <span class="emphasis"><em>plex</em></span> kezdetû sor adja meg az
	    eret.  Itt az egyetlen szükséges
	    paraméter a szervezési mód, ami ebben
	    az esetben a <span class="emphasis"><em>concat</em></span>
	    (összefûzött).  Nevet nem kell megadnunk,
	    mivel a rendszer automatikusan létrehoz egy nevet a
	    kötet nevébõl a
	    <span class="emphasis"><em>.p</em></span><span class="emphasis"><em>x</em></span> utótag
	    hozzáadásával, ahol az
	    <span class="emphasis"><em>x</em></span> az ér száma lesz a
	    köteten belül.  Emiatt a most definiált
	    ér neve <span class="emphasis"><em>myvol.p0</em></span> lesz.</p></li><li class="listitem"><p>Az <span class="emphasis"><em>sd</em></span> kezdetû sor adja meg az
	    allemezt.  Itt legalább meg kell adnunk a
	    meghajtónak a nevét, ahol tárolni
	    akarjuk, ill.  a méretét.  Ahogy már
	    említettük az ereknél is, nevet nem
	    kötelezõ megadnunk, mivel a rendszer
	    magától rendel hozzá nevet, amit a
	    hozzá tartozó ér nevébõl
	    származtat, hozzáadja a
	    <span class="emphasis"><em>.s</em></span><span class="emphasis"><em>x</em></span>
	    utótagot, ahol az <span class="emphasis"><em>x</em></span> az allemez
	    éren belüli sorszáma lesz.  Ennek
	    következtében a Vinum ennek az allemeznek a
	    <span class="emphasis"><em>myvol.p0.s0</em></span> nevet adja.</p></li></ul></div><p>Miután a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gvinum&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gvinum</span>(8)</span></a> feldolgozta ezt az
	állományt, az alábbi kimenetet fogja
	adni:</p><pre class="programlisting" width="97">
      <code class="prompt">#</code> gvinum -&gt; <strong class="userinput"><code>create config1</code></strong>
      Configuration summary
      Drives:         1 (4 configured)
      Volumes:        1 (4 configured)
      Plexes:         1 (8 configured)
      Subdisks:       1 (16 configured)

	D a                     State: up       Device /dev/da3h        Avail: 2061/2573 MB (80%)

	V myvol                 State: up       Plexes:       1 Size:        512 MB

	P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB

	S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB</pre><p>Ez a kimenet a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gvinum&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gvinum</span>(8)</span></a> egyszerû
	listázási formátumát mutatja.
	Grafikusan a <a class="xref" href="vinum-examples.html#vinum-simple-vol" title="21.4. ábra - Egyszerû Vinum-kötet">21.4. ábra - Egyszerû Vinum-kötet</a> mutatja
	be.</p><p>
	</p><div class="figure"><a id="vinum-simple-vol"></a><div class="figure-title">21.4. ábra - Egyszerû Vinum-kötet</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-simple-vol.png" alt="Egyszerû Vinum-kötet" /></div></div></div><p><br class="figure-break" />
      </p><p>Ezen és az ezt követõ ábrán
	egy kötetet láthatunk, amely ereket tartalmaz,
	amelyek pedig allemezeket.  Ebben az alapvetõ
	példában a kötet egyetlen eret tartalmaz,
	amiben pedig egyetlen allemez van.</p><p>Az itt bemutatott kötetnek nincs semmilyen elõnye
	a hagyományos lemezpartícionáláshoz
	képest.  Egyetlen eret tartalmaz, tehát nem is
	redundáns.  Az ér egyetlen allemezt tartalmaz,
	tehát nem tér el a megszokott
	lemezpartíciók
	helyfoglalásától sem.  A
	következõ szakaszokban sokkal érdekesebb
	konfigurációs módszereket is
	illusztrálunk.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91965264"></a>21.6.2. Megnövelt rugalmasság:
	tükrözés</h3></div></div></div><p>A kötetek rugalmassága
	tükrözéssel növelhetõ.  Egy
	tükrözött kötet kiosztása
	során feltétlenül gondoskodnunk kell
	arról, hogy az egyes erekhez tartozó allemezek
	eltérõ meghajtókon találhatóak,
	így az esetleges meghibásodások nem
	károsítják mind a két eret.  Az
	alábbi konfigurációban egy kötetet
	tükrözünk:</p><pre class="programlisting">
	drive b device /dev/da4h
	volume mirror
      plex org concat
        sd length 512m drive a
	  plex org concat
	    sd length 512m drive b</pre><p>Ebben a példában már nem kellett
	újra megadnunk az <span class="emphasis"><em>a</em></span>
	meghajtót, mivel a Vinum figyelemmel kíséri
	az összes objektumot a saját
	konfigurációs adatbázisában.  A
	definíció feldolgozása után a
	konfiguráció így fog kinézni:</p><pre class="programlisting" width="97">
	Drives:         2 (4 configured)
	Volumes:        2 (4 configured)
	Plexes:         3 (8 configured)
	Subdisks:       3 (16 configured)

	D a                     State: up       Device /dev/da3h        Avail: 1549/2573 MB (60%)
	D b                     State: up       Device /dev/da4h        Avail: 2061/2573 MB (80%)

    V myvol                 State: up       Plexes:       1 Size:        512 MB
    V mirror                State: up       Plexes:       2 Size:        512 MB

    P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p0           C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p1           C State: initializing     Subdisks:     1 Size:        512 MB

    S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB
	S mirror.p0.s0          State: up       PO:        0  B Size:        512 MB
	S mirror.p1.s0          State: empty    PO:        0  B Size:        512 MB</pre><p>A <a class="xref" href="vinum-examples.html#vinum-mirrored-vol" title="21.5. ábra - Tükrözött Vinum-kötet">21.5. ábra - Tükrözött Vinum-kötet</a> ugyanezt a szerkezetet
	grafikusan is.</p><p>
	</p><div class="figure"><a id="vinum-mirrored-vol"></a><div class="figure-title">21.5. ábra - Tükrözött Vinum-kötet</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-mirrored-vol.png" alt="Tükrözött Vinum-kötet" /></div></div></div><p><br class="figure-break" />
      </p><p>Ebben a példában minden ér tartalmazza
	a teljes 512 MB-os területet.  Ahogy a korábbi
	példa esetén, itt is mindegyik ér csak
	egyetlen allemezt tartalmaz.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91975504"></a>21.6.3. A teljesítmény javítása</h3></div></div></div><p>Az elõbbi példában szereplõ
	tükrözött kötet egy tükrözetlen
	kötetnél már jobban ellenáll a
	hibáknak, azonban a teljesítménye is
	kisebb.  A köteten minden egyes írás mind a
	két meghajtóra érvényesül,
	ezáltal a lemezek teljes
	sávszélességét nagyobb
	arányban használja.  A
	teljesítményre vonatkozó
	megfontolásaink egy másik
	megközelítést kívánnak meg: a
	tükrözés helyett inkább csíkozzuk
	szét az adatot a lehetõ legtöbb lemezen.  Az
	alábbi konfiguráció egy olyan kötetet
	mutat be, ahol egy eret négy lemezmeghajtóan
	keresztül csíkozunk:</p><pre class="programlisting">
	drive c device /dev/da5h
	drive d device /dev/da6h
	volume stripe
	plex org striped 512k
	  sd length 128m drive a
	  sd length 128m drive b
	  sd length 128m drive c
	  sd length 128m drive d</pre><p>Mint ahogy azt már korábban is
	említettük, nem szükséges még
	egyszer megadni azokat a meghajtókat, amiket a Vinum
	már ismer.  A definíció feldolgozása
	után a konfigurációnk
	nagyjából így néz ki:</p><pre class="programlisting" width="92">
	Drives:         4 (4 configured)
	Volumes:        3 (4 configured)
	Plexes:         4 (8 configured)
	Subdisks:       7 (16 configured)

    D a                     State: up       Device /dev/da3h        Avail: 1421/2573 MB (55%)
    D b                     State: up       Device /dev/da4h        Avail: 1933/2573 MB (75%)
    D c                     State: up       Device /dev/da5h        Avail: 2445/2573 MB (95%)
    D d                     State: up       Device /dev/da6h        Avail: 2445/2573 MB (95%)

    V myvol                 State: up       Plexes:       1 Size:        512 MB
    V mirror                State: up       Plexes:       2 Size:        512 MB
    V striped               State: up       Plexes:       1 Size:        512 MB

    P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p0           C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p1           C State: initializing     Subdisks:     1 Size:        512 MB
    P striped.p1            State: up       Subdisks:     1 Size:        512 MB

    S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB
    S mirror.p0.s0          State: up       PO:        0  B Size:        512 MB
    S mirror.p1.s0          State: empty    PO:        0  B Size:        512 MB
    S striped.p0.s0         State: up       PO:        0  B Size:        128 MB
    S striped.p0.s1         State: up       PO:      512 kB Size:        128 MB
    S striped.p0.s2         State: up       PO:     1024 kB Size:        128 MB
    S striped.p0.s3         State: up       PO:     1536 kB Size:        128 MB</pre><p>
	</p><div class="figure"><a id="vinum-striped-vol"></a><div class="figure-title">21.6. ábra - Csíkozott Vinum-kötet</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-striped-vol.png" alt="Csíkozott Vinum-kötet" /></div></div></div><p><br class="figure-break" />
      </p><p>Ez a kötet a <a class="xref" href="vinum-examples.html#vinum-striped-vol" title="21.6. ábra - Csíkozott Vinum-kötet">21.6. ábra - Csíkozott Vinum-kötet</a>ban
	látható.  A csíkok
	sötétedése jelzi a helyüket az ér
	területében: a világosabbak elöl, a
	sötétebbek hátul szerepelnek.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91984848"></a>21.6.4. Rugalmasság és
	teljesítmény</h3></div></div></div><p><a id="vinum-resilience"></a>Megfelelõ hardver
	birtokában lehet olyan köteteket is
	építeni, amelyek mind megnövelt
	rugalmasságot, mind pedig megnövelt
	teljesítményt mutatnak a szabványos
	<span class="trademark">UNIX</span>(R)-os partíciókhoz képest.  Ennek a
	konfigurációs állománya így
	nézne ki:</p><pre class="programlisting">
	volume raid10
      plex org striped 512k
        sd length 102480k drive a
        sd length 102480k drive b
        sd length 102480k drive c
        sd length 102480k drive d
        sd length 102480k drive e
      plex org striped 512k
        sd length 102480k drive c
        sd length 102480k drive d
        sd length 102480k drive e
        sd length 102480k drive a
        sd length 102480k drive b</pre><p>A második ér allemezei el vannak tolva az
	elsõ ér allemezeitõl két
	meghajtónyival.  Ez segít megelõzni, hogy az
	írási mûveletek ne ugyanarra az allemezre
	vonatkozznak, még akkor is, ha az adatátvitel
	két meghajtón is keresztülível.</p><p>A <a class="xref" href="vinum-examples.html#vinum-raid10-vol" title="21.7. ábra - Tükrözött, csíkozott Vinum-kötet">21.7. ábra - Tükrözött, csíkozott
	    Vinum-kötet</a> illusztrálja
	ennek a kötetnek a szerkezetét.</p><p>
	</p><div class="figure"><a id="vinum-raid10-vol"></a><div class="figure-title">21.7. ábra - Tükrözött, csíkozott
	    Vinum-kötet</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-raid10-vol.png" alt="Tükrözött, csíkozott Vinum-kötet" /></div></div></div><p><br class="figure-break" />
      </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="vinum-objects.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="vinum-vinum.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="vinum-object-naming.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">21.5. A Vinum objektumai </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 21.7. Az objektumok elnevezése</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>