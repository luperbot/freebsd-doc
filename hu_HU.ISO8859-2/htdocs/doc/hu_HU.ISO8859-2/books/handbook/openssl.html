<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>14.9. OpenSSL</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="security.html" title="14. fejezet - Biztonság" /><link rel="prev" href="kerberos5.html" title="14.8. Kerberos5" /><link rel="next" href="ipsec.html" title="14.10. VPN IPsec felett" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">14.9. OpenSSL</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="kerberos5.html">Vissza</a> </td><th width="60%" align="center">14. fejezet - Biztonság</th><td width="20%" align="right"> <a accesskey="n" href="ipsec.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="openssl"></a>14.9. OpenSSL</h2></div><div><span class="authorgroup">Írta: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Rhodes</span>, <span class="firstname">Tom</span></span>. </span></div></div></div><a id="idp87651280" class="indexterm"></a><p>A FreeBSD-hez adott <span class="application">OpenSSL</span> az egyik
      olyan tényezõ, amit a legtöbb
      felhasználó figyelmen kívül hagy.  Az
      <span class="application">OpenSSL</span> egy titkosítási
      réteget nyújt a hagyományos
      kommunikációs csatorna felett, így rengeteg
      hálózati alkalmazásba és
      szolgáltatásba bele lehet szõni.</p><p>Az <span class="application">OpenSSL</span>
      felhasználható többek közt a levelezõ
      kliensek titkosított hitelesítésére,
      hitelkártyás fizetések weben keresztüli
      lebonyolítására alkalmas, és
      még sok minden másra.  Sok port, köztük a
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache13-ssl/pkg-descr">www/apache13-ssl</a> és a
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/mail/sylpheed-claws/pkg-descr">mail/sylpheed-claws</a> is
      felajánlja az <span class="application">OpenSSL</span>
      felhasználását.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">A legtöbb esetben a Portgyûjtemény
	megpróbálja lefordítani a <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/openssl/pkg-descr">security/openssl</a> portot, hacsak a
	<code class="varname">WITH_OPENSSL_BASE</code> változót
	határozottan a <span class="quote">"<span class="quote">yes</span>"</span> értékre
	nem állítjuk.</p></div><p>A FreeBSD-hez mellékelt <span class="application">OpenSSL</span>
      ismeri a Secure Sockets Layer v2/v3 (SSLv2/SSLv3) és
      Transport Layer Security v1 (TLSv1)
      hálózatbiztonsági protokollokat, és
      általános célú
      titkosítási könyvtárként is
      alkalmazható.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Noha az <span class="application">OpenSSL</span> ismeri az
	<acronym class="acronym">IDEA</acronym> algoritmusát is, az Egyesült
	Államokban érvényben levõ szabadalmak
	miatt alapértelmezés szerint nem
	engedélyezett.  A használatához el kell
	olvasni a hozzá tartozó licencet, és ha
	elfogadjuk a benne foglaltakat, akkor állítsuk be
	a <code class="varname">MAKE_IDEA</code> változót a
	<code class="filename">make.conf</code> állományban.</p></div><p>Az <span class="application">OpenSSL</span>-t leginkább a
      szoftverek tanúsítványainak
      elkészítéséhez
      használják.  Ilyen
      tanúsítvánnyokkal lehet szavatolni, hogy az
      érte felelõs cég vagy egyén
      valóban megbízható és nem
      szélhámos.  Amennyiben a kérdéses
      tanúsítványt nem vizsgálta be
      valamelyik <span class="quote">"<span class="quote">tanúsítványok
      hitelesítésével foglalkozó
      hatóság</span>"</span> (Certificate Authority, vagy CA),
      akkor errõl általában kap egy
      figyelmeztetést a felhasználó.  A
      tanúsítványokat hitelesítõ
      cégek, mint például a <a class="link" href="http://www.verisign.com" target="_top">VeriSign</a>,
      írják alá ezeket a
      tanúsítványokat és ezzel
      érvényesítik az egyes cégek vagy
      egyének megbízhatóságát.  Ez
      ugyan pénzbe kerül, de használatuk
      egyáltalán nem is kötelezõ.  Azonban az
      átlagosnál paranoidabb felhasználók
      számára megnyugvást jelenthet.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87662288"></a>14.9.1. Tanúsítványok
	elõállítása</h3></div></div></div><a id="idp87662928" class="indexterm"></a><p>A tanúsítványok
	létrehozására a következõ parancs
	áll rendelkezésre:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl req -new -nodes -out req.pem -keyout cert.pem</code></strong>
Generating a 1024 bit RSA private key
................++++++
.......................................++++++
writing new private key to 'cert.pem'
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:<strong class="userinput"><code>országnév (kétbetûs kóddal)</code></strong>
State or Province Name (full name) [Some-State]:<strong class="userinput"><code>állam vagy tartomány teljes neve</code></strong>
Locality Name (eg, city) []:<strong class="userinput"><code>település neve</code></strong>
Organization Name (eg, company) [Internet Widgits Pty Ltd]:<strong class="userinput"><code>szervezet neve</code></strong>
Organizational Unit Name (eg, section) []:<strong class="userinput"><code>szervezeti egység neve</code></strong>
Common Name (eg, YOUR name) []:<strong class="userinput"><code>általános név (hálózati név!)</code></strong>
Email Address []:<strong class="userinput"><code>e-mail cím</code></strong>

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:<strong class="userinput"><code>VALAMILYEN JELSZÓ</code></strong>
An optional company name []:<strong class="userinput"><code>egy másik szervezet neve</code></strong></pre><p>Az adatok bekérésére elõtt
	megjelenõ figyelmeztetõ üzenet
	fordítása:</p><pre class="screen">
Itt a tanúsítvány igénylésével kapcsolatos információkat kell
megadnunk. Itt egy ún. <span class="quote">"<span class="quote">ismertetõnevet</span>"</span> (Distinguished
Name, DN) kell megadnunk. Ezen kívül van még néhány más mezõ is, de
ezeket akár üresen is hagyhatjuk. Néhány mezõnek van alapértelmezett
értéke, de ha oda egy pontot írunk, akkor kitöröljük.
</pre><p>A <span class="quote">"<span class="quote">Common Name</span>"</span> mezõnél
	ellenõrzési okokból egy
	hálózati nevet, tehát a szerverünk
	nevét kell megadnunk.  Ha nem így járunk
	el, akkor lényegében egy használhatatlan
	tanúsítványt kapunk.  További
	opciók is elérhetõek, mint
	például a lejárati idõ (expire time)
	megadása, a titkosítási algoritmus
	megváltoztatása stb.  Ezek teljes listája
	megtalálható az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=openssl&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">openssl</span>(1)</span></a> man
	oldalon.</p><p>Az elõbbi parancs kiadása után két
	állománynak kell létrejönnie az
	aktuális könyvtárban.  A
	tanúsítványkérést, vagyis az
	<code class="filename">req.pem</code> állományt kell
	eljuttatnunk a tanúsítványok
	hitelesítésével foglakozó szervhez,
	aki majd érvényesíti az imént
	megadott adatainkat.  A második,
	<code class="filename">cert.pem</code> nevû állomány a
	tanúsítványhoz tartozó privát
	kulcs, amit semmilyen körülmények
	között sem szabad kiadnunk.  Ha ez mások
	kezébe kerül, akkor el tudnak játszani
	bennünket (vagy a szerverünket).</p><p>Amikor a hitelesítõ szerv
	aláírása nem feltétlenül
	szükséges, akkor készíthetünk egy
	saját magunk által aláírt
	tanúsítványt is.  Ehhez elõször
	is generálnunk kell egy
	<acronym class="acronym">RSA</acronym>-kulcsot:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl dsaparam -rand -genkey -out saját_RSA.kulcs 1024</code></strong></pre><p>Most pedig készítsünk el a
	hitelesítõ szerv kulcsát is:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl gendsa -des3 -out hitelesítõ.kulcs saját_RSA.kulcs</code></strong></pre><p>Ezzel a kulccsal most gyártsunk le egy
	tanúsítványt:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl req -new -x509 -days 365 -key hitelesítõ.kulcs -out új.tanúsítvány</code></strong></pre><p>Ekkor két új állomány keletkezik
	a könyvtárunkban: a hitelesítõ szerv
	aláírása, a
	<code class="filename">hitelesítõ.kulcs</code>
	és maga a tanúsítvány, az
	<code class="filename">új.tanúsítvány</code>
	állomány.  Ezeket tegyük az <code class="filename">/etc</code> könyvtáron
	belül egy olyan könyvtárba, amelyet csak a
	<code class="systemitem">root</code> tud olvasni.  A
	<code class="command">chmod</code> paranccsal állítsunk be
	rá 0700-as kódú engedélyeket.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87680592"></a>14.9.2. Példa a tanúsítványok
	használatára</h3></div></div></div><p>Mire is jók ezek az állományok?
	Például kitûnõen alkalmazhatóak a
	<span class="application">Sendmail</span> levelezõ szerverhez
	beérkezõ kapcsolatot
	titkosítására.  Így
	lényegében felszámoljuk minden olyan
	felhasználó titkosítatlan módon
	zajló hitelesítését, aki a helyi
	levelezõ szerveren keresztül küldi a
	leveleit.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ez általában nem a legjobb megoldás,
	  mivel egyes levelezõ kliensek hibát jeleneznek a
	  felhasználónak, ha nem rendelkezik a
	  tanúsítvánnyal.  A
	  tanúsítványok
	  telepítésével kapcsolatban olvassuk el a
	  szoftverhez adott leírást.</p></div><p>A helyi <code class="filename">.mc</code> állományba
	ezeket a sorokat kell beletenni:</p><pre class="programlisting">dnl SSL Options
define(`confCACERT_PATH',`/etc/certs')dnl
define(`confCACERT',`/etc/certs/<em class="replaceable"><code>új.tanúsítvány</code></em>')dnl
define(`confSERVER_CERT',`/etc/certs/<em class="replaceable"><code>új.tanúsítvány</code></em>')dnl
define(`confSERVER_KEY',`/etc/certs/<em class="replaceable"><code>hitelesítõ.kulcs</code></em>')dnl
define(`confTLS_SRV_OPTIONS', `V')dnl</pre><p>Itt a <code class="filename">/etc/certs/</code> az
	a könyvtár, amit tanúsítványok
	és kulcsok helyi tárolására
	használunk.  Végezetül még újra
	kell generálnunk a helyi <code class="filename">.cf</code>
	állományokat.  Ezt a <code class="filename">/etc/mail</code> könyvtárban a
	<code class="command">make install</code> parancs
	kiadásával könnyen elvégezhetjük.
	Miután ez megtörtént, akkor
	<span class="application">Sendmail</span>hoz tartozó
	démont a <code class="command">make
	restart</code>
	paraméterével indíthatjuk
	újra.</p><p>Ha minden jól ment, akkor a
	<code class="filename">/var/log/maillog</code> állományban
	nem találunk egyetlen hibaüzenetet sem, és a
	<span class="application">Sendmail</span> is megjelenik a futó
	programok között.</p><p>A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=telnet&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">telnet</span>(1)</span></a> segédprogrammal így
	probálhatjuk ki a levelezõ szervert:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>telnet example.com 25</code></strong>
Trying 192.0.34.166...
Connected to <code class="systemitem">example.com</code>.
Escape character is '^]'.
220 <code class="systemitem">example.com</code> ESMTP Sendmail 8.12.10/8.12.10; Tue, 31 Aug 2004 03:41:22 -0400 (EDT)
<strong class="userinput"><code>ehlo example.com</code></strong>
250-example.com Hello example.com [192.0.34.166], pleased to meet you
250-ENHANCEDSTATUSCODES
250-PIPELINING
250-8BITMIME
250-SIZE
250-DSN
250-ETRN
250-AUTH LOGIN PLAIN
250-STARTTLS
250-DELIVERBY
250 HELP
<strong class="userinput"><code>quit</code></strong>
221 2.0.0 <code class="systemitem">example.com</code> closing connection
Connection closed by foreign host.</pre><p>Ha itt megjelenik a <span class="quote">"<span class="quote">STARTTLS</span>"</span> sor, akkor
	mindent sikerült beállítanunk.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="kerberos5.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="security.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="ipsec.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">14.8. <span class="application">Kerberos5</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 14.10. VPN IPsec felett</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>