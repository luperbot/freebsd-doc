<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>18.14. Az állományrendszerek pillanatképei</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="disks.html" title="18. fejezet - Háttértárak" /><link rel="prev" href="disks-virtual.html" title="18.13. Hálózat, memória és állomány alapú állományrendszerek" /><link rel="next" href="quotas.html" title="18.15. Az állományrendszerek kvótái" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">18.14. Az állományrendszerek
      pillanatképei</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="disks-virtual.html">Vissza</a> </td><th width="60%" align="center">18. fejezet - Háttértárak</th><td width="20%" align="right"> <a accesskey="n" href="quotas.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="snapshots"></a>18.14. Az állományrendszerek
      pillanatképei</h2></div><div><span class="authorgroup">Írta: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Rhodes</span>, <span class="firstname">Tom</span></span>. </span></div></div></div><a id="idp90928848" class="indexterm"></a><p>A FreeBSD a <a class="link" href="configtuning-disk.html#soft-updates" title="11.12.2. Soft Updates">Soft Updates</a>
	mellett felkínál egy másik
	lehetõséget: az
	állományrendszerekrõl
	készíthetõ
	pillanatfelvételeket.</p><p>Ezek a pillanatképek lehetõvé teszik a
	felhasználók számára, hogy adott
	állományrendszerekrõl képeket hozzanak
	létre és azt állományként
	kezeljék.  A pillanatképeket az adott
	állományrendszerben kell létrehozni,
	és a felhasználók
	állományrendszerenként
	húsznál többet nem hozhatnak
	belõlük létre.  Az aktív
	pillanatképek a szuperblokkban kerülnek
	rögzítésre, ezért az
	állományrendszerek leválasztása
	és újracsatlakoztatása esetén is
	megmaradnak, még újraindítás
	után is.  Amikor egy pillanatképre már
	nincs tovább szükségünk, egy szimpla
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rm&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rm</span>(1)</span></a> paranccsal eltávolítható.  A
	pillanatképek tetszõleges sorrendben
	eltávolíthatóak, habár ilyenkor az
	összes általuk lefoglalt hely nem szabadul fel,
	mivel más pillanatképeknek még
	szüksége lehet bizonyos blokkjaira.</p><p>Miután az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mksnap_ffs</span>(8)</span></a> paranccsal
	létrehoztunk egy pillanatképet tartalmazó
	állományt, beállítódik
	rá a módosíthatatlanságot
	jelentõ <code class="option">snapshot</code>
	állományjelzõ.  Egyedül az
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=unlink&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">unlink</span>(1)</span></a> parancs képez ez alól
	kivételt, mivel segítségével a
	pillanatképek
	eltávolíthatóak.</p><p>A pillanatképek a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> paranccsal
	hozhatóak létre.  A következõ
	módon tudjuk a <code class="filename">/var</code> egy
	pillanatképét elkészíteni a
	<code class="filename">/var/snapshot/snap</code>
	állományban:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -u -o snapshot /var/snapshot/snap /var</code></strong></pre><p>Vagy a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mksnap_ffs</span>(8)</span></a> meghívásával
	is készíthetünk
	pillanatképeket:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mksnap_ffs /var /var/snapshot/snap</code></strong></pre><p>Az állományrendszeren (például
	<code class="filename">/var</code>) a pillanatképeket
	tartalmazó állományokat a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=find&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">find</span>(1)</span></a>
	paranccsal kereshetjük meg:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>find /var -flags snapshot</code></strong></pre><p>Ahogy elkészítettünk egy
	pillanatképet, több mindenre is
	felhasználhatjuk:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Egyes rendszergazdák a pillanatképeket
	    biztonsági mentésekhez
	    használják, mivel ezek gond nélkül
	    áttehetõek CD-re vagy szalagra.</p></li><li class="listitem"><p>Az állományrendszerek
	    sértetlenségét ellenõrzõ
	    program, az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a> is lefuttatható egy ilyen
	    pillanatképen.  Feltéve, hogy az
	    állományrendszer csatlakoztatásakor
	    tiszta volt, mindig egy tiszta (és
	    változásokat nem tartalmazó)
	    eredményt kell kapnunk.  Ennek megléte
	    elengedhetetlen a háttérben futtatható
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a> mûködéséhez.</p></li><li class="listitem"><p>Futassuk le a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a> segédprogramot a
	    pillanatképen.  Az így létrehozott
	    mentés megegyezik az állományrendszer
	    adott pillanatban felvett állapotával.  Az
	    <code class="option">-L</code> beállítás
	    megadásával maga a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a> is
	    képes egyetlen parancsban pillanatfelvételt
	    készíteni, ebbõl létrehozni a
	    mentést, majd eltávolítani.</p></li><li class="listitem"><p>A pillanatképet képesek vagyunk a
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> paranccsal az állományrendszer
	    befagyasztott változataként
	    csatlakoztatni:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t vnode -f /var/snapshot/snap -u 4</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount -r /dev/md4 /mnt</code></strong></pre></li></ul></div><p>Így már a <code class="filename">/mnt</code>
	könyvtárba csatlakoztatva be tudjuk járni a
	befagyasztott <code class="filename">/var</code>
	állományrendszert.  Minden a
	pillanatfelvétel készítésének
	idõpontjának megfelelõ állapotban fog
	maradni.  Az egyetlen kivétel talán annyi, hogy
	korábbi pillanatképek nulla méretû
	állományként fognak megjelenni.  Mikor
	befejeztük a pillanatképek
	használatát, a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=umount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">umount</span>(8)</span></a> paranccsal le tudjuk
	választani:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>umount /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mdconfig -d -u 4</code></strong></pre><p>A <code class="option">softupdates</code> és az
	állományrendszerek pillanatképeinek
	használatával, illetve mûszaki
	leírásukkal kapcsolatban látogassuk meg
	Marshall Kirk McKusick honlapját a <code class="uri"><a class="uri" href="http://www.mckusick.com/" target="_top">http://www.mckusick.com/</a></code> címen
	(angolul).</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="disks-virtual.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="disks.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="quotas.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">18.13. Hálózat, memória és
      állomány alapú
      állományrendszerek </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 18.15. Az állományrendszerek
      kvótái</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>