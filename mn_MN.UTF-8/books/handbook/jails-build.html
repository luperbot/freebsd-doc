<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>16.4. Шоронг үүсгэж хянах нь</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD гарын авлага" /><link rel="up" href="jails.html" title="Бүлэг 16. Jails буюу Шоронгууд" /><link rel="prev" href="jails-intro.html" title="16.3. Танилцуулга" /><link rel="next" href="jails-tuning.html" title="16.5. Нарийн тааруулалт болон удирдлага" /><link rel="copyright" href="legalnotice.html" title="Хуулийн заалт" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">16.4. Шоронг үүсгэж хянах нь</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="jails-intro.html">Өмнөх</a> </td><th width="60%" align="center">Бүлэг 16. Jails буюу Шоронгууд</th><td width="20%" align="right"> <a accesskey="n" href="jails-tuning.html">Дараах</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="jails-build"></a>16.4. Шоронг үүсгэж хянах нь</h2></div></div></div><p>Зарим администраторууд шоронг дараах хоёр төрөлд хуваадаг: эдгээр нь
	жинхэнэ FreeBSD системтэй адил төстэй <span class="quote">«<span class="quote">бүрэн</span>»</span> шоронгууд болон
	нэг програм юм уу эсвэл үйлчилгээнд зориулагдсан, магадгүй зөвшөөрлүүдтэй ажиллах
	<span class="quote">«<span class="quote">үйлчилгээ</span>»</span> шоронгууд юм. Энэ нь зөвхөн ухагдахууны хуваагдал
	бөгөөд шоронг бүтээх процесс үүнд хамаагүй юм. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jail</span>(8)</span></a> гарын авлагын
	хуудас шоронг бүтээх аргачлалын талаар маш тодорхой зааварласан буй:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>setenv D /here/is/the/jail</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir -p $D</code></strong> <a id="jailpath"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make buildworld</code></strong> <a id="jailbuildworld"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>
<code class="prompt">#</code> <strong class="userinput"><code>make installworld DESTDIR=$D</code></strong> <a id="jailinstallworld"></a><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span>
<code class="prompt">#</code> <strong class="userinput"><code>make distribution DESTDIR=$D</code></strong> <a id="jaildistrib"></a><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span>
<code class="prompt">#</code> <strong class="userinput"><code>mount -t devfs devfs $D/dev</code></strong> <a id="jaildevfs"></a><span><img src="./imagelib/callouts/5.png" alt="5" border="0" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#jailpath"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Шоронгийн байрлалыг сонгох нь хамгийн шилдэг эхлэх цэг юм.
	Энэ нь шорон физикээр өөрийн хостын файлын систем дотор байрлах байрлал юм. Сайн сонголт нь
	<code class="filename">/usr/jail/jailname</code>
	байж болох бөгөөд энд байгаа <em class="replaceable"><code>jailname</code></em> нь
	шоронг таниулж байгаа хостын нэр юм. <code class="filename">/usr/</code> файлын систем нь
	шоронгийн файлын системийн хувьд ихэвчлэн хангалттай зайтай байдаг.
	Үндсэндээ  <span class="quote">«<span class="quote">бүрэн</span>»</span> шоронгуудын хувьд энэ шоронгийн
	файлын систем нь үндсэн FreeBSD системийн андагч
	суулгацад байдаг бүх файлуудын хуулбар байдаг.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#jailbuildworld"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Хэрэв та өөрийн хэрэглэгчийн талбарыг
          <code class="command">make world</code> эсвэл <code class="command">make buildworld</code> тушаалаар
	  аль хэдийн бүтээсэн бол та энэ алхмыг алгасаж өөрийн хэрэглэгчийн талбарыг шинэ
	  шорон руу суулгаж болно.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#jailinstallworld"><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Энэ тушаал нь шоронгийн физик байрлал болгон сонгосон сангийн дэд модыг
	файлын систем дээр шаардлагатай хоёртын файлууд, сангууд, гарын авлагын
	хуудаснууд гэх зэргүүдийг тараан байрлуулах болно.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#jaildistrib"><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span></a> </p></td><td valign="top" align="left"><p><span class="application">make</span> тушаалд зориулагдсан
	<code class="buildtarget">distribution</code> тохируулга нь бүх шаардлагатай
	тохиргооны файлыг суулгана, өөрөөр хэлбэл энэ нь
	<code class="filename">/usr/src/etc/</code> сангийн
	бүх суулгаж болох файлуудыг шоронгийн орчны
	<code class="filename">/etc</code> сан болох
	<code class="filename">$D/etc/</code> руу хуулдаг.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#jaildevfs"><span><img src="./imagelib/callouts/5.png" alt="5" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Шорон дотор <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">devfs</span>(8)</span></a> файлын системийг холбох шаардлагагүй.
	Нөгөө талаас авч үзвэл дурын, бараг бүх програм өөрийн зорилгоосоо хамааран
	хамгийн багаар бодоход ядаж ганц төхөөрөмжид хандах шаардлагатай байдаг.
	Шорон дотроос төхөөрөмжид хандах хандалтыг хянах нь маш чухал байдаг.
	Учир нь буруу тохируулгууд халдагчид шорон дотор муухай зүйлс хийх боломжийг
	олгож болох юм. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">devfs</span>(8)</span></a> дээрх хяналтыг <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">devfs</span>(8)</span></a> болон
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">devfs.conf</span>(5)</span></a> гарын авлагын хуудаснуудад тайлбарласан дүрмийн
	олонлогуудаар удирддаг.</p></td></tr></table></div><p>Шорон суулгагдсаны дараа <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jail</span>(8)</span></a> хэрэгсэл ашиглан түүнийг
	эхлүүлж болно. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jail</span>(8)</span></a> хэрэгсэл дөрвөн зайлшгүй шаардлагатай
	нэмэлт өгөгдлийг авдаг бөгөөд эдгээр нь <a class="xref" href="jails-intro.html#jails-what" title="16.3.1. Шорон гэж юу вэ">Хэсэг 16.3.1, «Шорон гэж юу вэ»</a> хэсэгт тайлбарлагдсан байгаа болно.
	Өөр бусад нэмэлт өгөгдлүүдийг бас зааж өгч болох бөгөөд өөрөөр хэлбэл
	шорон хийгдсэн процессийг тухайн нэг хэрэглэгчийн итгэмжлэлүүдтэй ажиллуулж болох юм.
	<code class="option"><em class="replaceable"><code>command</code></em></code>-н нэмэлт өгөгдөл нь
	шоронгийн төрлөөс хамаарна; <span class="emphasis"><em>виртуал системийн</em></span>
	хувьд <code class="filename">/etc/rc</code> нь боломжийн сонголт байна.
	Энэ нь жинхэнэ FreeBSD системийн эхлүүлэх дарааллыг хуулбарлах учраас тэр
	юм. <span class="emphasis"><em>Үйлчилгээ</em></span> шоронгийн хувьд шорон дотор
	ажиллах үйлчилгээ эсвэл програмаас энэ нь хамаарна.</p><p>Шоронгууд нь ихэвчлэн ачаалах үед эхлүүлэгддэг бөгөөд FreeBSD
      <code class="filename">rc</code> арга зам нь үүнийг хийх хялбар аргаар
	хангадаг.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Ачаалах үед эхлэхээр идэвхжүүлэгдсэн шоронгуудын жагсаалтыг
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> файлд нэмэх ёстой:</p><pre class="programlisting">jail_enable="YES"   # Set to NO to disable starting of any jails
jail_list="<em class="replaceable"><code>www</code></em>"     # Space separated list of names of jails</pre><div xmlns="" class="note"><h3 class="admontitle">Тэмдэглэл: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">jail_list</code> хувьсагчид өгөгдсөн байгаа шоронгийн нэрс
	    зөвхөн үсэг, тооноос бүрдсэн байх ёстой.</p></div></li><li class="step"><p>Шорон бүрийг тайлбарласан <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> тохируулгуудын бүлэг
	<code class="varname">jail_list</code>-д жагсаагдсан шорон бүрийн
	хувьд доор дурдсаныг нэмэх ёстой:</p><pre class="programlisting">jail_<em class="replaceable"><code>www</code></em>_rootdir="/usr/jail/www"     # jail's root directory
jail_<em class="replaceable"><code>www</code></em>_hostname="<em class="replaceable"><code>www</code></em>.example.org"   # jail's hostname
jail_<em class="replaceable"><code>www</code></em>_ip="192.168.0.10"          # jail's IP address
jail_<em class="replaceable"><code>www</code></em>_devfs_enable="YES"          # mount devfs in the jail
jail_<em class="replaceable"><code>www</code></em>_devfs_ruleset="<em class="replaceable"><code>www_ruleset</code></em>" # devfs ruleset to apply to jail</pre><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>-д тохируулагдсан шоронгуудын анхдагч
	эхлүүлэлт нь шоронг бүрэн виртуал систем гэж тооцдог шоронгийн
	<code class="filename">/etc/rc</code> скриптийг ажиллуулах болно. Үйлчилгээний
	шоронгуудын хувьд
	<code class="varname">jail_<em class="replaceable"><code>jailname</code></em>_exec_start</code>
	тохируулгыг зохистойгоор тохируулан шоронгийн анхдагч эхлүүлэх тушаалыг
	өөрчлөх ёстой.</p><div xmlns="" class="note"><h3 class="admontitle">Тэмдэглэл: </h3><p xmlns="http://www.w3.org/1999/xhtml">Тохируулгуудын бүрэн жагсаалтыг <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> гарын
		авлагын хуудаснаас үзнэ үү.</p></div></li></ol></div><p>Шоронд зориулагдсан оруулга <code class="filename">rc.conf</code> файлд байгаа
	тохиолдолд <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=service&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">service</span>(8)</span></a> шоронг гараар эхлүүлэх
	эсвэл зогсооход ашиглагдаж болох юм:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service jail start www</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>service jail stop www</code></strong></pre><p>Одоогоор <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jail</span>(8)</span></a>-г зогсоох цэвэр зам байхгүй байгаа.
	Цэвэр системийн зогсолтыг хийх тушаалуудыг шорон дотор ашиглах боломжгүй
	байдаг болохоор тэр юм. Шоронг зогсоох хамгийн шилдэг арга бол
	дараах тушаалыг шорон дотроос ажиллуулах эсвэл шоронгийн гадна
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jexec&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jexec</span>(8)</span></a> хэрэгслийг ашиглах явдал юм:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sh /etc/rc.shutdown</code></strong></pre><p>Үүний талаар дэлгэрэнгүй мэдээллийг <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jail</span>(8)</span></a> гарын авлагын хуудаснаас
	олж болно.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="jails-intro.html">Өмнөх</a> </td><td width="20%" align="center"><a accesskey="u" href="jails.html">Дээш</a></td><td width="40%" align="right"> <a accesskey="n" href="jails-tuning.html">Дараах</a></td></tr><tr><td width="40%" align="left" valign="top">16.3. Танилцуулга </td><td width="20%" align="center"><a accesskey="h" href="index.html">Эхлэл</a></td><td width="40%" align="right" valign="top"> 16.5. Нарийн тааруулалт болон удирдлага</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Энэ болон бусад баримтуудыг
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    хаягаас татаж авч болно.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD-ийн талаар
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;
    хаягтай холбоо барихаасаа өмнө
    <a href="http://www.FreeBSD.org/docs.html">баримтыг</a> уншина уу.<br></br>
    Энэ бичиг баримттай холбоотой асуулт байвал
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;
    хаягаар цахим захидал явуулна уу.<br></br>
    Энэ бичиг баримтын орчуулгатай холбоотой асуулт байвал
    &lt;<a href="mailto:admin@mnbsd.org">admin@mnbsd.org</a>&gt;
    хаягаар цахим захидал явуулна уу.</small></p></body></html>