<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>28.3. Цөмийн PPP-г ашиглах</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD гарын авлага" /><link rel="up" href="ppp-and-slip.html" title="Бүлэг 28. PPP болон SLIP" /><link rel="prev" href="userppp.html" title="28.2. Хэрэглэгчийн PPP ашиглах" /><link rel="next" href="ppp-troubleshoot.html" title="28.4. PPP холболтуудын алдааг олж засварлах" /><link rel="copyright" href="legalnotice.html" title="Хуулийн заалт" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">28.3. Цөмийн PPP-г ашиглах</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="userppp.html">Өмнөх</a> </td><th width="60%" align="center">Бүлэг 28. PPP болон SLIP</th><td width="20%" align="right"> <a accesskey="n" href="ppp-troubleshoot.html">Дараах</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="ppp"></a>28.3. Цөмийн PPP-г ашиглах</h2></div><div><span class="authorgroup">Хэсгүүдийг анхлан хувь нэмэр болгон оруулсан <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Геннадий Б.</span> <span class="surname">Сорокопуд</span></span> ба <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Роберт</span> <span class="surname">Хафф</span></span>. </span></div></div></div><div xmlns="" class="warning"><h3 class="admontitle">Сануулга: </h3><p xmlns="http://www.w3.org/1999/xhtml">Энэ хэсэг нь зөвхөн
        FreeBSD 7.X хувилбаруудад зориулагдсан.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88247376"></a>28.3.1. Цөмийн PPP тохируулах</h3></div></div></div><a id="idp88248016" class="indexterm"></a><p>Та өөрийн машин дээр PPP-г тохируулж эхлэхээсээ өмнө
	<code class="command">pppd</code> нь
	<code class="filename">/usr/sbin</code> санд байгаа болон
	<code class="filename">/etc/ppp</code> сан байгаа эсэхийг шалгаарай.</p><p><code class="command">pppd</code> нь хоёр горимд ажиллах чаддаг:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><span class="quote">«<span class="quote">Клиент</span>»</span> маягаар — та өөрийн машиныг
		гаднах ертөнц уруу PPP цуваа холболтоор эсвэл модемийн шугамаар
		холбохыг хүсдэг.</p></li><li class="listitem"><a id="idp88252752" class="indexterm"></a><p><span class="quote">«<span class="quote">Сервер</span>»</span> маягаар — Таны машин сүлжээн
		дээр байгаа бөгөөд бусад компьютеруудыг PPP ашиглан холбоход
		хэрэглэгдэнэ.</p></li></ol></div><p>Аль ч тохиолдол байлаа гэсэн та тохируулгуудын файлыг
	(<code class="filename">/etc/ppp/options</code> эсвэл
	хэрэв та PPP ашиглаж байгаа өөрийн машин дээрээ нэгээс илүү олон хэрэглэгчидтэй бол
	<code class="filename">~/.ppprc</code>) тохируулах хэрэгтэй
	болно.</p><p>Та залгаж алсын хосттой холболт тогтоохын тулд
	танд бас зарим модем/цуваа програм хангамж
	(<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/comms/kermit/pkg-descr">comms/kermit</a>-г аль болох эрхэмлэх)
	хэрэгтэй болно.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88256464"></a>28.3.2. <code class="command">pppd</code>-г клиент маягаар ашиглах</h3></div><div><span class="authorgroup">Based on information provided by <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Трев</span> <span class="surname">Ройдхауз</span></span>. </span></div></div></div><a id="idp88267472" class="indexterm"></a><a id="idp88268240" class="indexterm"></a><p>Дараах <code class="filename">/etc/ppp/options</code> файл нь
	Cisco терминал серверийн PPP шугам уруу холбогдоход хэрэглэгдэж болох юм.</p><pre class="programlisting">crtscts         # enable hardware flow control
modem           # modem control line
noipdefault     # remote PPP server must supply your IP address
                # if the remote host does not send your IP during IPCP
                # negotiation, remove this option
passive         # wait for LCP packets
domain ppp.foo.com      # put your domain name here

:<em class="replaceable"><code>remote_ip</code></em>    # put the IP of remote PPP host here
                # it will be used to route packets via PPP link
                # if you didn't specified the noipdefault option
                # change this line to <em class="replaceable"><code>local_ip</code></em>:<em class="replaceable"><code>remote_ip</code></em>

defaultroute    # put this if you want that PPP server will be your
                # default router</pre><p>Холбогдохын тулд:</p><a id="idp88271440" class="indexterm"></a><a id="idp88271952" class="indexterm"></a><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Алсын хост уруу <span class="application">Kermit</span>
		(эсвэл өөр бусад модемийн програм) ашиглан залгаж өөрийн хэрэглэгчийн нэр болон нууц үгийг
		(эсвэл алсын хост дээр PPP-г идэвхжүүлэхэд шаардлагатай
		тэр зүйлийг) оруулна.</p></li><li class="step"><p><span class="application">Kermit</span>-с гарна (шугамыг таслалгүйгээр).</p></li><li class="step"><p>Доор дурдсаныг оруулна:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/usr/sbin/pppd /dev/tty01 19200</code></strong></pre><p>Тохирох хурд болон төхөөрөмжийн нэрийг ашиглахаа мартуузай.</p></li></ol></div><p>Одоо таны компьютер PPP-тэй холбогдлоо. Хэрэв холболт амжилтгүй
	болбол та <code class="filename">/etc/ppp/options</code> файлд
	<code class="option">debug</code> тохируулгыг нэмж асуудлыг олохын тулд
	консолын мэдэгдлүүдийг шалгана.</p><p>Дараах <code class="filename">/etc/ppp/pppup</code> скрипт нь
	бүх 3 алхмыг автомат болгоно:</p><pre class="programlisting">#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ "X${pid}" != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi

ifconfig ppp0 down
ifconfig ppp0 delete

kermit -y /etc/ppp/kermit.dial
pppd /dev/tty01 19200</pre><a id="idp88279632" class="indexterm"></a><p><code class="filename">/etc/ppp/kermit.dial</code> нь <span class="application">Kermit</span>
	скрипт бөгөөд гадагш залгаж бүх шаардлагатай нэвтрэлт таниулалтыг алсын хост дээр
	хийдэг (энэ баримтын төгсгөлд ийм скриптийн жишээ хавсаргагдсан болно).</p><p>Дараах <code class="filename">/etc/ppp/pppdown</code> скриптийг ашиглаж
	PPP шугамыг салгаж болно:</p><pre class="programlisting">#!/bin/sh
pid=`pgrep pppd`
if [ X${pid} != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill -TERM ${pid}
fi

pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi

/sbin/ifconfig ppp0 down
/sbin/ifconfig ppp0 delete
kermit -y /etc/ppp/kermit.hup
/etc/ppp/ppptest</pre><p><code class="command">pppd</code> ажиллаж байгаа эсэхийг шалгахын тулд
	<code class="filename">/usr/etc/ppp/ppptest</code>-г ажиллуулна. Энэ нь
	иймэрхүү харагдах ёстой:</p><pre class="programlisting">#!/bin/sh
pid=`pgrep pppd`
if [ X${pid} != "X" ] ; then
        echo 'pppd running: PID=' ${pid-NONE}
else
        echo 'No pppd running.'
fi
set -x
netstat -n -I ppp0
ifconfig ppp0</pre><p>Модемийг салгаж буцааж залгахын тулд
	<code class="filename">/etc/ppp/kermit.hup</code>-г ажиллуулна. Энэ нь
	доор дурдсаныг агуулах ёстой:</p><pre class="programlisting">set line /dev/tty01	; put your modem device here
set speed 19200
set file type binary
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none

pau 1
out +++
inp 5 OK
out ATH0\13
echo \13
exit</pre><p>Энд <code class="command">kermit</code> тушаалын оронд
	<code class="command">chat</code> тушаал хэрэглэх өөр арга байна:</p><p>Дараах хоёр мөр нь <code class="command">pppd</code> холболтыг
	хийхэд хангалттай байдаг.</p><p><code class="filename">/etc/ppp/options</code>:</p><pre class="programlisting">/dev/cuad1 115200

crtscts		# enable hardware flow control
modem		# modem control line
connect "/usr/bin/chat -f /etc/ppp/login.chat.script"
noipdefault	# remote PPP serve must supply your IP address
	        # if the remote host doesn't send your IP during
                # IPCP negotiation, remove this option
passive         # wait for LCP packets
domain <em class="replaceable"><code>your.domain</code></em>	# put your domain name here

:		# put the IP of remote PPP host here
	        # it will be used to route packets via PPP link
                # if you didn't specified the noipdefault option
                # change this line to <em class="replaceable"><code>local_ip</code></em>:<em class="replaceable"><code>remote_ip</code></em>

defaultroute	# put this if you want that PPP server will be
	        # your default router</pre><p><code class="filename">/etc/ppp/login.chat.script</code>:</p><div xmlns="" class="note"><h3 class="admontitle">Тэмдэглэл: </h3><p xmlns="http://www.w3.org/1999/xhtml">Дараах нь нэг мөрөнд байх ёстой.</p></div><pre class="programlisting">ABORT BUSY ABORT 'NO CARRIER' "" AT OK ATDT<em class="replaceable"><code>phone.number</code></em>
  CONNECT "" TIMEOUT 10 ogin:-\\r-ogin: <em class="replaceable"><code>login-id</code></em>
  TIMEOUT 5 sword: <em class="replaceable"><code>password</code></em></pre><p>Эдгээр нь суулгагдаж зөв болж өөрчлөгдсөний дараа таны хийх ганц зүйл бол
	<code class="command">pppd</code>-г иймэрхүү маягаар ажиллуулах явдал юм:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pppd</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88310352"></a>28.3.3. <code class="command">pppd</code>-г сервер маягаар ашиглах</h3></div></div></div><p><code class="filename">/etc/ppp/options</code> файл нь доор дурдсантай төстэйг
	агуулах ёстой:</p><pre class="programlisting">crtscts                         # Hardware flow control
netmask 255.255.255.0           # netmask (not required)
192.114.208.20:192.114.208.165  # IP's of local and remote hosts
                                # local ip must be different from one
                                # you assigned to the Ethernet (or other)
                                # interface on your machine.
                                # remote IP is IP address that will be
                                # assigned to the remote machine
domain ppp.foo.com              # your domain
passive                         # wait for LCP
modem                           # modem line</pre><p>Дараах <code class="filename">/etc/ppp/pppserv</code> скрипт нь
	<span class="application">pppd</span>-г сервер маягаар ажиллахыг
	заах болно:</p><pre class="programlisting">#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ "X${pid}" != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi

# reset ppp interface
ifconfig ppp0 down
ifconfig ppp0 delete

# enable autoanswer mode
kermit -y /etc/ppp/kermit.ans

# run ppp
pppd /dev/tty01 19200</pre><p>Серверийг зогсоохын тулд энэ <code class="filename">/etc/ppp/pppservdown</code>
	скриптийг ашиглана:</p><pre class="programlisting">#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ "X${pid}" != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi
ifconfig ppp0 down
ifconfig ppp0 delete

kermit -y /etc/ppp/kermit.noans</pre><p>Дараах <span class="application">Kermit</span> скрипт нь
	(<code class="filename">/etc/ppp/kermit.ans</code>) таны модем дээр автомат
	хариулагчийг нээх/хаах болно. Энэ нь иймэрхүү харагдах ёстой:</p><pre class="programlisting">set line /dev/tty01
set speed 19200
set file type binary
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none

pau 1
out +++
inp 5 OK
out ATH0\13
inp 5 OK
echo \13
out ATS0=1\13   ; change this to out ATS0=0\13 if you want to disable
                ; autoanswer mode
inp 5 OK
echo \13
exit</pre><p><code class="filename">/etc/ppp/kermit.dial</code> гэсэн нэртэй скрипт
	нь гадагш залгаж алсын хост дээр нэвтрэлт таниулахад хэрэглэгддэг. Та үүнийг
	өөрийн хэрэгцээнд зориулан өөрчлөх хэрэгтэй болно. Өөрийн нэвтрэх нэр
	болон нууц үгийг энэ скриптэд оруулах хэрэгтэй; та бас оролтын илэрхийллийг
	таны модем болон алсын хостоос ирэх хариунуудаас хамааран өөрчлөх хэрэгтэй болно.</p><pre class="programlisting">;
; put the com line attached to the modem here:
;
set line /dev/tty01
;
; put the modem speed here:
;
set speed 19200
set file type binary            ; full 8 bit file xfer
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none
set modem hayes
set dial hangup off
set carrier auto                ; Then SET CARRIER if necessary,
set dial display on             ; Then SET DIAL if necessary,
set input echo on
set input timeout proceed
set input case ignore
def \%x 0                       ; login prompt counter
goto slhup

:slcmd                          ; put the modem in command mode
echo Put the modem in command mode.
clear                           ; Clear unread characters from input buffer
pause 1
output +++                      ; hayes escape sequence
input 1 OK\13\10                ; wait for OK
if success goto slhup
output \13
pause 1
output at\13
input 1 OK\13\10
if fail goto slcmd              ; if modem doesn't answer OK, try again

:slhup                          ; hang up the phone
clear                           ; Clear unread characters from input buffer
pause 1
echo Hanging up the phone.
output ath0\13                  ; hayes command for on hook
input 2 OK\13\10
if fail goto slcmd              ; if no OK answer, put modem in command mode

:sldial                         ; dial the number
pause 1
echo Dialing.
output atdt9,550311\13\10               ; put phone number here
assign \%x 0                    ; zero the time counter

:look
clear                           ; Clear unread characters from input buffer
increment \%x                   ; Count the seconds
input 1 {CONNECT }
if success goto sllogin
reinput 1 {NO CARRIER\13\10}
if success goto sldial
reinput 1 {NO DIALTONE\13\10}
if success goto slnodial
reinput 1 {\255}
if success goto slhup
reinput 1 {\127}
if success goto slhup
if &lt; \%x 60 goto look
else goto slhup

:sllogin                        ; login
assign \%x 0                    ; zero the time counter
pause 1
echo Looking for login prompt.

:slloop
increment \%x                   ; Count the seconds
clear                           ; Clear unread characters from input buffer
output \13
;
; put your expected login prompt here:
;
input 1 {Username: }
if success goto sluid
reinput 1 {\255}
if success goto slhup
reinput 1 {\127}
if success goto slhup
if &lt; \%x 10 goto slloop         ; try 10 times to get a login prompt
else goto slhup                 ; hang up and start again if 10 failures

:sluid
;
; put your userid here:
;
output ppp-login\13
input 1 {Password: }
;
; put your password here:
;
output ppp-password\13
input 1 {Entering SLIP mode.}
echo
quit

:slnodial
echo \7No dialtone.  Check the telephone line!\7
exit 1

; local variables:
; mode: csh
; comment-start: "; "
; comment-start-skip: "; "
; end:</pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="userppp.html">Өмнөх</a> </td><td width="20%" align="center"><a accesskey="u" href="ppp-and-slip.html">Дээш</a></td><td width="40%" align="right"> <a accesskey="n" href="ppp-troubleshoot.html">Дараах</a></td></tr><tr><td width="40%" align="left" valign="top">28.2. Хэрэглэгчийн PPP ашиглах </td><td width="20%" align="center"><a accesskey="h" href="index.html">Эхлэл</a></td><td width="40%" align="right" valign="top"> 28.4. <acronym class="acronym">PPP</acronym> холболтуудын алдааг олж засварлах</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Энэ болон бусад баримтуудыг
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    хаягаас татаж авч болно.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD-ийн талаар
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;
    хаягтай холбоо барихаасаа өмнө
    <a href="http://www.FreeBSD.org/docs.html">баримтыг</a> уншина уу.<br></br>
    Энэ бичиг баримттай холбоотой асуулт байвал
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;
    хаягаар цахим захидал явуулна уу.<br></br>
    Энэ бичиг баримтын орчуулгатай холбоотой асуулт байвал
    &lt;<a href="mailto:admin@mnbsd.org">admin@mnbsd.org</a>&gt;
    хаягаар цахим захидал явуулна уу.</small></p></body></html>