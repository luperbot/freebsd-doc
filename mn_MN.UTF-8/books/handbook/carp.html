<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>32.13. Common Address Redundancy Protocol (CARP)</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD гарын авлага" /><link rel="up" href="advanced-networking.html" title="Бүлэг 32. Сүлжээний нэмэлт ойлголтууд" /><link rel="prev" href="network-atm.html" title="32.12. Asynchronous Transfer Mode (ATM) буюу Асинхрон Дамжуулах Горим" /><link rel="next" href="appendices.html" title="хэсэг V. Хавсралтууд" /><link rel="copyright" href="legalnotice.html" title="Хуулийн заалт" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">32.13. Common Address Redundancy Protocol (CARP)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-atm.html">Өмнөх</a> </td><th width="60%" align="center">Бүлэг 32. Сүлжээний нэмэлт ойлголтууд</th><td width="20%" align="right"> <a accesskey="n" href="appendices.html">Дараах</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="carp"></a>32.13. Common Address Redundancy Protocol (CARP)</h2></div><div><span class="authorgroup">Хувь нэмэр болгон оруулсан <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Том</span> <span class="surname">Рөүдс</span></span>. </span></div></div></div><a id="idp94883536" class="indexterm"></a><a id="idp94884048" class="indexterm"></a><p>Common Address Redundancy Protocol буюу <acronym class="acronym">CARP</acronym> нь
	олон хостуудад нэг <acronym class="acronym">IP</acronym> хаяг хуваалцах боломжийг олгодог.
	Зарим тохиргоонуудын хувьд үүнийг байнгын бэлэн байдал юм уу эсвэл ачаалал тэгш хуваарилахад
	ашиглаж болох юм. Энд дурдсан жишээний адилаар хостууд нь бас өөр өөр
	<acronym class="acronym">IP</acronym> хаягууд ашиглаж болох юм.</p><p><acronym class="acronym">CARP</acronym>-ийн дэмжлэгийг идэвхжүүлэхийн тулд
	FreeBSD цөмийг <a class="xref" href="kernelconfig.html" title="Бүлэг 9. FreeBSD цөмийг тохируулах нь">Бүлэг 9, <em>FreeBSD цөмийг тохируулах нь</em></a> бүлэгт заасны дагуу
	дараах тохируулгатайгаар бүтээсэн байх хэрэгтэй:</p><pre class="programlisting">device	carp</pre><p>Мөн өөрөөр <code class="filename">if_carp.ko</code> модулийг ачаалах үед
      дуудаж болно. Ингэхийн тулд дараах мөрийг <code class="filename">/boot/loader.conf</code>
      нэмж өгнө:</p><pre class="programlisting">if_carp_load="YES"</pre><p><acronym class="acronym">CARP</acronym> боломж нь одоо хүртээмжтэй болсон байх
	ёстой бөгөөд түүнийг хэд хэдэн <code class="command">sysctl</code>-ийн <acronym class="acronym">OID</acronym>-уудын
	тусламжтайгаар тааруулж болно:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>OID</th><th>Тайлбар</th></tr></thead><tbody><tr><td><code class="varname">net.inet.carp.allow</code></td><td>Ирж байгаа <acronym class="acronym">CARP</acronym> пакетуудыг хүлээж авах.
		Анхдагчаар идэвхжсэн байдаг.</td></tr><tr><td><code class="varname">net.inet.carp.preempt</code></td><td>Энэ тохируулга нь хост дээрх бүх <acronym class="acronym">CARP</acronym>
		интерфэйсүүдийг аль нэг нь зогссон тохиолдолд зогсоодог.
		Анхдагчаар идэвхжээгүй байдаг.</td></tr><tr><td><code class="varname">net.inet.carp.log</code></td><td><code class="literal">0</code> гэсэн утга нь бүртгэлийг идэвхжүүлдэггүй.
		<code class="literal">1</code> гэсэн утга нь муу <acronym class="acronym">CARP</acronym>
		пакетуудын бүртгэлийг идэвхжүүлдэг. <code class="literal">1</code>-ээс
		их утгууд нь <acronym class="acronym">CARP</acronym> интерфэйсүүдийн хувьд
		төлвийн өөрчлөлтүүдийн бүртгэлийг идэвхжүүлдэг. Анхдагч
		утга нь <code class="literal">1</code> байна.</td></tr><tr><td><code class="varname">net.inet.carp.arpbalance</code></td><td><acronym class="acronym">ARP</acronym> ашиглан дотоод сүлжээний
		урсгалыг тэнцвэржүүлнэ. Анхдагчаар идэвхжээгүй байдаг.</td></tr><tr><td><code class="varname">net.inet.carp.suppress_preempt</code></td><td>Preemption буюу өөр илүү өндөр давуу эрх бүхий бодлого/урсгалаар
		солигдох боломжийг хаасан хориглолтын төлвийг үзүүлэх
		зөвхөн уншигдах <acronym class="acronym">OID</acronym>. Хэрэв интерфэйс дээрх
		холбоос босоогүй бол илүү өндөр давуу эрх бүхий бодлого/урсгалаар
		солигдох боломжийг хааж болно. <code class="literal">0</code> утга нь
		илүү өндөр давуу эрх бүхий бодлого/урсгалаар солигдох боломж
		хаагдаагүй гэсэн утгатай. Асуудал бүр энэ <acronym class="acronym">OID</acronym>-ийг
		нэгээр ахиулж нэмэгдүүлнэ.</td></tr></tbody></table></div><p><acronym class="acronym">CARP</acronym> төхөөрөмжүүдийг <code class="command">ifconfig</code>
	тушаалаар үүсгэж болно:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig carp0 create</code></strong></pre><p>Жинхэнэ амьдрал дээр эдгээр интерфэйсүүдэд <acronym class="acronym">VHID</acronym> гэгддэг
	давхардахгүй дугаарууд хэрэгтэй болно. Энэ <acronym class="acronym">VHID</acronym> буюу
	Виртуал Хостын Үнэмлэх нь сүлжээн дэх хостыг ялгахад хэрэглэгдэх болно.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94916048"></a>32.13.1. Серверт хандах боломжийг байнга хангахын тулд CARP-ийг ашиглах нь (CARP)</h3></div></div></div><p>Дээр дурдсан <acronym class="acronym">CARP</acronym>-ийн нэг хэрэглээ нь серверийн
	бэлэн байдалд зориулагджээ. Энэ жишээ нь өөр өөр <acronym class="acronym">IP</acronym>
	хаягуудтай, ижил вэбийн агуулга бүхий гурван хостын хувьд байнгын
	бэлэн байдалд байх дэмжлэгийг харуулах болно. Эдгээр машинууд нь
	Тойрон Эргэх <acronym class="acronym">DNS</acronym> тохиргоотойгоор ажиллах болно.
	Амжилтгүй болсон үед хандах нөөц машин нь хоёр нэмэлт <acronym class="acronym">CARP</acronym>
	интерфэйстэй байх бөгөөд агуулгын сервер бүрийн <acronym class="acronym">IP</acronym>-ний
	хувьд ашиглагдана. Хандалт амжилтгүй болоход амжилтгүй болсон машины
	<acronym class="acronym">IP</acronym> хаягийг нөөц сервер авах ёстой. Энэ нь
	хэрэглэгчид амжилтгүй болсон нь мэдэгдэхгүй гэсэн үг юм. Нөөц сервер нь ачааллыг
	авах ёстой бол бусад агуулгын серверүүдтэй ижил агуулга болон үйлчилгээнүүдтэй
	байх ёстой.</p><p>Хоёр машин нь өгөгдсөн хостын нэр болон <acronym class="acronym">VHID</acronym>-үүдээс
	бусдаараа адилхан тохируулагдсан байх ёстой. Энэ жишээн дээр
	эдгээр машинуудыг <code class="systemitem">hosta.example.org</code> болон
	<code class="systemitem">hostb.example.org</code> гэж нэрлэсэн байгаа. Эхлээд
	<acronym class="acronym">CARP</acronym>-ийн тохиргоонд шаардлагатай мөрүүдийг
	<code class="filename">rc.conf</code> файлд нэмэх хэрэгтэй.
	<code class="systemitem">hosta.example.org</code> хостын хувьд
	<code class="filename">rc.conf</code> файл доор дурдсан мөрүүдийг агуулсан байх ёстой:</p><pre class="programlisting">hostname="hosta.example.org"
ifconfig_fxp0="inet 192.168.1.3 netmask 255.255.255.0"
cloned_interfaces="carp0"
ifconfig_carp0="vhid 1 pass testpass 192.168.1.50/24"</pre><p><code class="systemitem">hostb.example.org</code> дээр доор дурдсан мөрүүдийг
	<code class="filename">rc.conf</code> файл агуулсан
	байх ёстой:</p><pre class="programlisting">hostname="hostb.example.org"
ifconfig_fxp0="inet 192.168.1.4 netmask 255.255.255.0"
cloned_interfaces="carp0"
ifconfig_carp0="vhid 2 pass testpass 192.168.1.51/24"</pre><div xmlns="" class="note"><h3 class="admontitle">Тэмдэглэл: </h3><p xmlns="http://www.w3.org/1999/xhtml">Хамгийн чухал нь <code class="command">ifconfig</code> тушаалд <code class="option">pass</code> тохируулгаар
	заагдсан нууц үгс нь адил байх ёстой. <code class="filename">carp</code>
	төхөөрөмжүүд нь зөвхөн зөв нууц үг бүхий машинуудаас ирэх зарлалтуудыг сонсох
	болно. <acronym class="acronym">VHID</acronym> нь машин бүрийн хувьд өөр өөр байх ёстой.</p></div><p>Гурав дахь <code class="systemitem">provider.example.org</code> машиныг
	аль нэг хост руу хандахад амжилтгүй болоход хандаж болохоор болгож бэлдэх хэрэгтэй.
	Энэ машинд хоёр <code class="filename">carp</code> төхөөрөмж хэрэгтэй болох
	бөгөөд нэг нэгээрээ хоёр хосттой ажиллах юм. <code class="filename">rc.conf</code>-ийн
	зөв тохиргооны мөрүүд доор дурдсантай төсөөтэй байх болно:</p><pre class="programlisting">hostname="provider.example.org"
ifconfig_fxp0="inet 192.168.1.5 netmask 255.255.255.0"
cloned_interfaces="carp0 carp1"
ifconfig_carp0="vhid 1 advskew 100 pass testpass 192.168.1.50/24"
ifconfig_carp1="vhid 2 advskew 100 pass testpass 192.168.1.51/24"</pre><p>Хоёр <code class="filename">carp</code> төхөөрөмжтэй байх нь
	хариу өгөхөө байсан аль нэг машиныг мэдэж <acronym class="acronym">IP</acronym> хаягийг нь
	авах боломжийг <code class="systemitem">provider.example.org</code> хостод олгох болно.</p><div xmlns="" class="note"><h3 class="admontitle">Тэмдэглэл: </h3><p xmlns="http://www.w3.org/1999/xhtml">Анхдагч FreeBSD цөм дээр preemption буюу өөр илүү өндөр давуу эрх бүхий бодлого/урсгалаар
	солигдох боломж идэвхжсэн байж <span class="emphasis"><em>болох</em></span> юм.
	Хэрэв тийм бол <code class="systemitem">provider.example.org</code> нь
	<acronym class="acronym">IP</acronym> хаягийг анхдагч агуулгын сервер рүү суллахгүй
	байж болох юм. Энэ тохиолдолд администратор мастер уруу буцааж
	IP-г хүчилж болох юм. Дараах тушаалыг <code class="systemitem">provider.example.org</code>
	дээр ажиллуулах шаардлагатай:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig carp0 down &amp;&amp; ifconfig carp0 up</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">Хостод тохирох <code class="filename">carp</code> интерфэйс дээр
	үүнийг хийх ёстой.</p></div><p>Энэ хүрэхэд <acronym class="acronym">CARP</acronym> бүрмөсөн идэвхжиж
	тест хийхэд бэлэн болсон байх ёстой. Сүлжээг дахин эхлүүлэх буюу эсвэл
	машинуудыг дахин ачаалаад тест хийгээрэй.</p><p>Дэлгэрэнгүй мэдээллийг <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=carp&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">carp</span>(4)</span></a> гарын авлагын хуудаснаас олж
	болно.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-atm.html">Өмнөх</a> </td><td width="20%" align="center"><a accesskey="u" href="advanced-networking.html">Дээш</a></td><td width="40%" align="right"> <a accesskey="n" href="appendices.html">Дараах</a></td></tr><tr><td width="40%" align="left" valign="top">32.12. Asynchronous Transfer Mode (ATM) буюу Асинхрон Дамжуулах Горим </td><td width="20%" align="center"><a accesskey="h" href="index.html">Эхлэл</a></td><td width="40%" align="right" valign="top"> хэсэг V. Хавсралтууд</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Энэ болон бусад баримтуудыг
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    хаягаас татаж авч болно.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD-ийн талаар
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;
    хаягтай холбоо барихаасаа өмнө
    <a href="http://www.FreeBSD.org/docs.html">баримтыг</a> уншина уу.<br></br>
    Энэ бичиг баримттай холбоотой асуулт байвал
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;
    хаягаар цахим захидал явуулна уу.<br></br>
    Энэ бичиг баримтын орчуулгатай холбоотой асуулт байвал
    &lt;<a href="mailto:admin@mnbsd.org">admin@mnbsd.org</a>&gt;
    хаягаар цахим захидал явуулна уу.</small></p></body></html>