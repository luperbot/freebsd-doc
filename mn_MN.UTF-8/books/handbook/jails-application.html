<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>16.6. Шоронгийн хэрэглээ</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD гарын авлага" /><link rel="up" href="jails.html" title="Бүлэг 16. Jails буюу Шоронгууд" /><link rel="prev" href="jails-tuning.html" title="16.5. Нарийн тааруулалт болон удирдлага" /><link rel="next" href="mac.html" title="Бүлэг 17. Mandatory Access Control буюу Албадмал Хандалтын хяналт" /><link rel="copyright" href="legalnotice.html" title="Хуулийн заалт" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">16.6. Шоронгийн хэрэглээ</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="jails-tuning.html">Өмнөх</a> </td><th width="60%" align="center">Бүлэг 16. Jails буюу Шоронгууд</th><td width="20%" align="right"> <a accesskey="n" href="mac.html">Дараах</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="jails-application"></a>16.6. Шоронгийн хэрэглээ</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="jails-service-jails"></a>16.6.1. Үйлчилгээ шоронгууд</h3></div><div><span class="authorgroup">Хувь нэмэр болгон оруулсан <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Даниэл</span> <span class="surname">Гэрзо</span></span>. </span></div></div></div><p>Энэхүү хэсэг нь Simon L. B. Nielsen хөгжүүлэгчийн <code class="uri"><a class="uri" href="http://simon.nitro.dk/service-jails.html" target="_top">http://simon.nitro.dk/service-jails.html</a></code> хуудас болон
	Кен Том <code class="email">&lt;<a xmlns="" class="email" href="mailto:locals@gmail.com">locals@gmail.com</a>&gt;</code>-ийн бичсэн шинэчилсэн нийтлэл
	дээр гаргасан санаа дээр тулгуурласан юм. Энэ хэсэг нь
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jail</span>(8)</span></a> боломжийг ашиглан аюулгүй байдлын нэмэлт давхарга
	бүхий FreeBSD систем хэрхэн тохируулах талаар тайлбарлах болно.
	Өгөгдсөн систем нь ядаж RELENG_6_0 бөгөөд энэ бүлгийн өмнө
	дурдсан мэдээллийг уншигч авхай сайн ойлгосон гэж тооцдог.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="jails-service-jails-design"></a>16.6.1.1. Шийдэл</h4></div></div></div><p>Шоронгуудын гол асуудлуудын нэг нь тэдгээрийн шинэчлэлтийн
	процессийн удирдлага юм. Шорон бүр нь шинэчлэгдэх болгондоо
	дахин бүр эхнээсээ бүтээгдэх хэрэгтэй болдог учраас тэр юм.
	Нэг шоронгийн хувьд энэ нь ихэвчлэн асуудал болдоггүй,
	шинэчлэлтийн процесс их хялбар байдаг боловч олон шоронгууд
	үүсгэсэн бол их хугацаа шаардсан, төвөгтэй ажиллагаа байдаг.</p><div xmlns="" class="warning"><h3 class="admontitle">Сануулга: </h3><p xmlns="http://www.w3.org/1999/xhtml">Энэхүү тохиргоо нь FreeBSD-ийн маш сайн туршлага болон түүний
		боломжуудын хэрэглээг шаарддаг. Хэрэв доор үзүүлсэн алхмууд нь
		хэтэрхий төвөгтэй санагдвал FreeBSD шоронгуудыг удирдах илүү хялбар
		боломжийг олгодог бөгөөд энэ тохиргооных шиг төвөгтэй биш
		<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/sysutils/qjail/pkg-descr">sysutils/qjail</a> эсвэл 
		<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/sysutils/ezjail/pkg-descr">sysutils/ezjail</a> зэрэг хялбар системийг
		үзэхийг зөвлөж байна.</p></div><p>Гол санаа нь иймэрхүү асуудлуудыг шоронгууд хооронд аль болох
	ихээр аюулгүй аргаар хуваалцах замаар шийдэх явдал юм — шинэчлэлт хялбар
	байхаар зөвхөн уншигдах <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount_nullfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount_nullfs</span>(8)</span></a> холболтуудыг ашиглах болон
	ганц үйлчилгээнүүдийг тусдаа шоронд хийх нь илүүтэй болох юм.
	Мөн энэ нь шоронгуудыг нэмэх эсвэл устгах болон тэдгээрийг
	шинэчлэх хялбар боломжийг олгодог юм.</p><div xmlns="" class="note"><h3 class="admontitle">Тэмдэглэл: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ийм зорилгоор ашиглаж болох үйлчилгээнүүдийг дурдвал:
		<acronym class="acronym">HTTP</acronym> сервер, <acronym class="acronym">DNS</acronym>
	  сервер, <acronym class="acronym">SMTP</acronym> сервер гэх мэт байж болох юм.</p></div><p>Энэ хэсэгт тайлбарласан тохиргооны зорилгуудыг дурдвал:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Шоронгийн хялбар, ойлгоход амархан бүтцийг үүсгэх.
		Энэ нь шорон бүрийн хувьд болон тэдгээр дээр бүрэн хэмжээний
		installworld үйлдлийг <span class="emphasis"><em>ажиллуулахгүй</em></span>
		байх гэсэн үг юм.</p></li><li class="listitem"><p>Шинэ шоронгууд нэмэх эсвэл байгааг нь устгах процессийг
		хялбар болгох.</p></li><li class="listitem"><p>Байгаа шоронгуудыг шинэчлэх эсвэл сайжруулах процессийг
		хялбар болгох.</p></li><li class="listitem"><p>Өөрчлөн тохируулсан FreeBSD салбарыг ажиллуулах боломжтой
		болгох.</p></li><li class="listitem"><p>Нэвтрэн орох, эвдлэн орох боломжийг аль болох ихээр
		багасгаж аюулгүй байдлын хувьд паранойд байх.</p></li><li class="listitem"><p>Зай болон inode-уудыг аль болох ихээр хэмнэх.</p></li></ul></div><p>Урьд нь дурдагдсаны адил энэ шийдэл нь
	шорон бүрт зөвхөн уншигдахаар (<span class="application">nullfs</span> гэгддэг)
	холбогдох ганц мастер загвар болон шорон бүрийн хувьд нэг уншигдах,
	бичигдэх төхөөрөмжтэй байх бүтэц дээр үндсэндээ тулгуурласан юм.
	Төхөөрөмж нь тусдаа физик диск, хуваалт, эсвэл vnode дээр
	тулгуурласан <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a> төхөөрөмж байж болох юм. Энэ жишээн дээр
	бид уншигдах, бичигдэх <span class="application">nullfs</span> холболтуудыг
	ашиглах болно.</p><p>Файлын системийн дүр зураг доор дурдсан хэсэгт тайлбарласан буй:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Шорон бүр <code class="filename">/home/j</code> сангийн доор холбогдох болно.</p></li><li class="listitem"><p><code class="filename">/home/j/mroot</code> нь
		шорон бүрийн хувьд загвар ба бүх шоронгуудын хувьд
		зөвхөн уншигдах хуваалт юм.</p></li><li class="listitem"><p><code class="filename">/home/j</code> сангийн доор
		шорон бүрийн хувьд хоосон сан үүсгэгдэнэ.</p></li><li class="listitem"><p>Шорон бүр системийн уншигдах, бичигдэх хэсэг уруу холбогдох
		<code class="filename">/s</code> сантай байна.</p></li><li class="listitem"><p>Шорон бүр <code class="filename">/home/j/skel</code> дээр тулгуурласан
		өөрийн уншигдах, бичигдэх системтэй байх болно.</p></li><li class="listitem"><p>Шоронгийн талбар бүр (шорон бүрийн уншигдах, бичигдэх хэсэг)
		<code class="filename">/home/js</code>-д үүсгэгдэх болно.</p></li></ul></div><div xmlns="" class="note"><h3 class="admontitle">Тэмдэглэл: </h3><p xmlns="http://www.w3.org/1999/xhtml">Энэ нь шоронгууд <code class="filename">/home</code>
	хуваалтын доор үндэслэсэн гэж үзнэ. Үүнийг мэдээж өөрчилж болох боловч
	ингэх тохиолдолд доор дурдсан жишээ бүрийн хувьд өөрчлөгдөх ёстой
	болно.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="jails-service-jails-template"></a>16.6.1.2. Загвар үүсгэх нь</h4></div></div></div><p>Энэ хэсэг нь шоронд зориулагдан ашиглагдах, зөвхөн уншигдах хэсэг болох
	мастер загварыг үүсгэхэд хэрэгтэй алхмуудыг тайлбарлах болно.</p><p>FreeBSD системийг сүүлийн -RELEASE салбар уруу шинэчлэх нь үргэлж
	зөв санаа байдаг. Үүнийг хийхийн тулд гарын авлагын
	<a class="link" href="../../../../doc/mn_MN.UTF-8/books/handbook/makeworld.html" target="_top">бүлгээс</a>
	лавлах хэрэгтэй. Шинэчлэл хийх шаардлагагүй бол гүйцэтгэлийг
	гүйцээхийн тулд buildworld хийх шаардлагатай. Мөн
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/sysutils/cpdup/pkg-descr">sysutils/cpdup</a> багц хэрэгтэй.
	FreeBSD-ийн портын цуглуулгыг татаж авахдаа бид <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=portsnap&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">portsnap</span>(8)</span></a>
	хэрэгслийг ашиглах болно. Эхлэн суралцагчид гарын авлагын
	<a class="link" href="../../../../doc/mn_MN.UTF-8/books/handbook/portsnap.html" target="_top">Portsnap бүлгийг</a>
	унших нь зүйтэй юм.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Эхлээд бидний шоронгуудад зориулсан FreeBSD-ийн хоёртын файлуудыг
		агуулах зөвхөн уншигдах файлын системийн сангийн бүтцийг
		үүсгэх хэрэгтэй бөгөөд дараа нь FreeBSD-ийн эх модны сан уруу
		сангаа сольж ороод зөвхөн уншигдах файлын системийг шоронгийн загвар
		уруу суулгах хэрэгтэй:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /home/j /home/j/mroot</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make installworld DESTDIR=/home/j/mroot</code></strong></pre></li><li class="step"><p>Дараа нь шоронгуудад зориулж FreeBSD-ийн портын цуглуулга болон
		<span class="application">mergemaster</span>-т шаардлагатай, FreeBSD-ийн
		эх модыг бэлдэх хэрэгтэй:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /home/j/mroot</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir usr/ports</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>portsnap -p /home/j/mroot/usr/ports fetch extract</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cpdup /usr/src /home/j/mroot/usr/src</code></strong></pre></li><li class="step"><p>Системийн уншигдах, бичигдэх хэсэгт зориулж араг ясыг үүсгэх хэрэгтэй:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /home/j/skel /home/j/skel/home /home/j/skel/usr-X11R6 /home/j/skel/distfiles</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv etc /home/j/skel</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv usr/local /home/j/skel/usr-local</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv tmp /home/j/skel</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv var /home/j/skel</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv root /home/j/skel</code></strong></pre></li><li class="step"><p>Байхгүй байгаа тохиргооны файлуудыг суулгахын тулд
		<span class="application">mergemaster</span>-г ашиглах хэрэгтэй.
		Дараа нь <span class="application">mergemaster</span>-ийн үүсгэсэн
		илүү сангуудыг арилгах хэрэгтэй:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mergemaster -t /home/j/skel/var/tmp/temproot -D /home/j/skel -i</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /home/j/skel</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm -R bin boot lib libexec mnt proc rescue sbin sys usr dev</code></strong></pre></li><li class="step"><p>Одоо уншигдах, бичигдэх файлын системийг зөвхөн уншигдах
		файлын систем уруу заасан симболын холбоос үүсгэх хэрэгтэй.
		Симболын холбоосууд нь зөв <code class="filename">s/</code> байрлалуудад үүсгэгдсэн
		эсэхийг шалгаарай. Жинхэнэ сангууд юм уу эсвэл сангуудын
		үүсгэлт буруу байрлалуудад хийгдсэн бол суулгалт амжилтгүй
		болоход хүргэнэ.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /home/j/mroot</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir s</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s s/etc etc</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s s/home home</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s s/root root</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s ../s/usr-local usr/local</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s ../s/usr-X11R6 usr/X11R6</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s ../../s/distfiles usr/ports/distfiles</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s s/tmp tmp</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s s/var var</code></strong></pre></li><li class="step"><p>Сүүлийн шатанд доор дурдсан агуулга бүхий ерөнхий
		<code class="filename">/home/j/skel/etc/make.conf</code> файлыг үүсгэх
		хэрэгтэй:</p><pre class="programlisting">WRKDIRPREFIX?=  /s/portbuild</pre><p><code class="literal">WRKDIRPREFIX</code>-г ийм байдлаар тохируулах нь
		шорон бүрт FreeBSD-ийн портуудыг эмхэтгэх боломжтой болгох юм.
		Портуудын сан нь зөвхөн уншигдах системийн хэсэг гэдгийг санаарай.
		<code class="literal">WRKDIRPREFIX</code>-д зориулсан өөр зам нь
		шорон бүрийн уншигдах, бичигдэх хэсэгт бүтээлтүүдийг хийх боломжийг
		олгох юм.</p></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="jails-service-jails-creating"></a>16.6.1.3. Шорон үүсгэх нь</h4></div></div></div><p>Одоо бид бүрэн гүйцэд FreeBSD-ийн шоронгийн загвартай болсон болохоор
	<code class="filename">/etc/rc.conf</code> файлд бид шоронгуудыг суулган тохируулах
	боломжтой болно. Энэ жишээ нь <span class="quote">«<span class="quote">NS</span>»</span>,
	  <span class="quote">«<span class="quote">MAIL</span>»</span> болон <span class="quote">«<span class="quote">WWW</span>»</span> гэсэн 3 шоронгийн үүсгэлтийг
	харуулж байна.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Доор дурдсан мөрүүдийг <code class="filename">/etc/fstab</code> файлд
		нэмэх хэрэгтэй. Ингэснээр шоронгуудад зориулсан зөвхөн уншигдах
		загвар болон уншигдах, бичигдэх зай тохирох шоронгуудад ашиглах боломжтой
		болох юм:</p><pre class="programlisting">/home/j/mroot   /home/j/ns     nullfs  ro  0   0
/home/j/mroot   /home/j/mail   nullfs  ro  0   0
/home/j/mroot   /home/j/www    nullfs  ro  0   0
/home/js/ns     /home/j/ns/s   nullfs  rw  0   0
/home/js/mail   /home/j/mail/s nullfs  rw  0   0
/home/js/www    /home/j/www/s  nullfs  rw  0   0</pre><div xmlns="" class="note"><h3 class="admontitle">Тэмдэглэл: </h3><p xmlns="http://www.w3.org/1999/xhtml">0 pass буюу өнгөрөх дугаараар тэмдэглэгдсэн хуваалтууд нь
		ачаалах үед <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a> хэрэгслээр шалгагддаггүй бөгөөд
		0 dump дугаараар тэмдэглэгдсэн хуваалтууд нь <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a>
		хэрэгслээр нөөцлөгддөггүй. Бид <span class="application">fsck</span>
		хэрэгслээр <span class="application">nullfs</span> холболтуудыг шалгах эсвэл
		<span class="application">dump</span> хэрэгслээр шоронгуудын зөвхөн уншигдах
		nullfs холболтуудыг нөөцлөхийг хүсэхгүй байгаа билээ. Дээр дурдсан
		<code class="filename">fstab</code> оруулга бүрийн сүүлийн хоёр багана
		<span class="quote">«<span class="quote">0 0</span>»</span> гэж тэмдэглэгдсэн учир нь энэ юм.</p></div></li><li class="step"><p>Шоронгуудыг <code class="filename">/etc/rc.conf</code>-д тохируулах хэрэгтэй:</p><pre class="programlisting">jail_enable="YES"
jail_set_hostname_allow="NO"
jail_list="ns mail www"
jail_ns_hostname="ns.example.org"
jail_ns_ip="192.168.3.17"
jail_ns_rootdir="/usr/home/j/ns"
jail_ns_devfs_enable="YES"
jail_mail_hostname="mail.example.org"
jail_mail_ip="192.168.3.18"
jail_mail_rootdir="/usr/home/j/mail"
jail_mail_devfs_enable="YES"
jail_www_hostname="www.example.org"
jail_www_ip="62.123.43.14"
jail_www_rootdir="/usr/home/j/www"
jail_www_devfs_enable="YES"</pre><div xmlns="" class="warning"><h3 class="admontitle">Сануулга: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">jail_<em class="replaceable"><code>name</code></em>_rootdir</code>
		хувьсагчийн утга <code class="filename">/home</code>-ийн
		оронд <code class="filename">/usr/home</code> гэсэн шалтгаан нь
		FreeBSD-ийн үндсэн суулгац дээр <code class="filename">/home</code>
		сангийн физик зам нь <code class="filename">/usr/home</code>
		гэж байдагт оршиж байгаа юм.
		<code class="varname">jail_<em class="replaceable"><code>name</code></em>_rootdir</code>
		хувьсагчийн утга симбол холбоос бүхий зам байхаар тохируулагдсан
		байх <span class="emphasis"><em>ёсгүй</em></span> бөгөөд хэрэв ингэвэл шоронгууд ажиллаж
		эхлэхгүй байх болно. Энэ хувьсагчийн утгад тавьж болох утгыг олохдоо
		<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=realpath&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">realpath</span>(1)</span></a>-г ашиглах хэрэгтэй. Дэлгэрэнгүй мэдээллийг
		FreeBSD-SA-07:01.jail Аюулгүй байдлын Зөвлөгөөнөөс үзнэ үү.</p></div></li><li class="step"><p>Шорон бүрийн зөвхөн уншигдах файлын системд зориулсан, шаардлагатай
		холбох цэгүүдийг үүсгэнэ:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /home/j/ns /home/j/mail /home/j/www</code></strong></pre></li><li class="step"><p>Шорон бүрт уншигдах, бичигдэх загварыг суулгах хэрэгтэй.
		<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/sysutils/cpdup/pkg-descr">sysutils/cpdup</a> хэрэгслийн хэрэглээг
		энд тэмдэглэх нь зүйтэй юм. Энэ нь сан бүрийн зөв хуулбарыг хийхэд
		тусалдаг:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /home/js</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cpdup /home/j/skel /home/js/ns</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cpdup /home/j/skel /home/js/mail</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cpdup /home/j/skel /home/js/www</code></strong></pre></li><li class="step"><p>Энэ үед шоронгууд нь бүтээгдэж ажиллахад бэлтгэгдсэн
		байна. Эхлээд шорон бүрийн хувьд шаардлагатай файлын
		системийг холбож дараа нь тэдгээрийг jail rc
		скрипт ашиглан эхлүүлэх хэрэгтэй:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -a</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>service jail start</code></strong></pre></li></ol></div><p>Шоронгууд нь одоо ажиллаж байх ёстой. Тэдгээрийг зөв
	эхэлсэн эсэхийг шалгахын тулд <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jls&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jls</span>(8)</span></a> тушаалыг ашиглана.
	Үүний гаралт доор дурдсантай төстэй байх ёстой:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>jls</code></strong>
   JID  IP Address      Hostname                      Path
     3  192.168.3.17    ns.example.org                /home/j/ns
     2  192.168.3.18    mail.example.org              /home/j/mail
     1  62.123.43.14    www.example.org               /home/j/www</pre><p>Энэ үед шорон бүр рүү нэвтэрч, шинэ хэрэглэгчид нэмэх эсвэл
	дэмонуудыг тохируулах боломжтой болсон байх ёстой.
	<code class="literal">JID</code> багана нь ажиллаж байгаа шорон бүрийн
	шорон таниулах дугаарыг илэрхийлдэг. <code class="literal">JID</code> нь
	3 бүхий шорон дотор удирдлагын ажлуудыг гүйцэтгэхийн тулд
	дараах тушаалыг ашиглах хэрэгтэй:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>jexec 3 tcsh</code></strong></pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="jails-service-jails-upgrading"></a>16.6.1.4. Шинэчлэх нь</h4></div></div></div><p>Аюулгүй байдлын асуудлаас болоод эсвэл одоо байгаа шоронгуудад
	ашигтай шинэ боломжууд хийгдсэнээс болоод системээ FreeBSD-ийн шинэ
	хувилбар уруу шинэчлэх шаардлага заримдаа гардаг. Энэ тохиргооны
	дизайн нь байгаа шоронгуудыг хялбар аргаар шинэчлэх боломжийг
	олгодог. Мөн шоронгуудыг сүүлийн минутанд зогсоодог болохоор
	энэ нь тэдгээрийн зогсох хугацааг багасгадаг. Бас ямар нэг асуудал
	гарахад энэ нь хуучин хувилбар уруугаа шилжих боломжийг олгодог.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Эхний алхам нь хост системийг журмын дагуу шинэчлэх
		явдал юм. Дараа шинэ, түр зуурын, зөвхөн уншигдах
		загварыг <code class="filename">/home/j/mroot2</code>-д үүсгэх хэрэгтэй.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /home/j/mroot2</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make installworld DESTDIR=/home/j/mroot2</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /home/j/mroot2</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cpdup /usr/src usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir s</code></strong></pre><p><code class="buildtarget">installworld</code> ажиллахдаа цөөн хэрэггүй
		сангуудыг үүсгэдэг бөгөөд эдгээрийг устгах хэрэгтэй:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chflags -R 0 var</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm -R etc var root usr/local tmp</code></strong></pre></li><li class="step"><p>Мастер файлын системд зориулж уншигдах, бичигдэх симболын
		холбоосуудыг дахин үүсгэх хэрэгтэй:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ln -s s/etc etc</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s s/root root</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s s/home home</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s ../s/usr-local usr/local</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s ../s/usr-X11R6 usr/X11R6</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s s/tmp tmp</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s s/var var</code></strong></pre></li><li class="step"><p>Шоронгуудыг зогсоох зөв үе нь одоо байна:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service jail stop</code></strong></pre></li><li class="step"><p>Эх файлын системүүдийг салгах хэрэгтэй:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>umount /home/j/ns/s</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>umount /home/j/ns</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>umount /home/j/mail/s</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>umount /home/j/mail</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>umount /home/j/www/s</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>umount /home/j/www</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Тэмдэглэл: </h3><p xmlns="http://www.w3.org/1999/xhtml">Уншигдах, бичигдэх системүүд нь зөвхөн уншигдах системд
		залгагдсан (<code class="filename">/s</code>) бөгөөд
		эхлээд салгагдах ёстой.</p></div></li><li class="step"><p>Хуучин зөвхөн уншигдах файлын системийг шилжүүлж шинээр
		сольно. Ямар нэг юм болохоо байхад энэ нь хуучин, зөвхөн уншигдах
		файлын системийн нөөц болон архив маягаар ашиглагдах юм.
		Энд ашиглагдсан нэрлэх аргачлал нь шинэ, зөвхөн уншигдах файлын
		систем үүсгэгдэх үеийнхтэй тохирдог. Зай болон inode-уудыг хэмнэхийн тулд
		FreeBSD-ийн эх портын цуглуулгыг шинэ файлын систем уруу шилжүүлэх хэрэгтэй:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /home/j</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv mroot mroot.20060601</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv mroot2 mroot</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv mroot.20060601/usr/ports mroot/usr</code></strong></pre></li><li class="step"><p>Энэ үед шинэ, зөвхөн уншигдах загвар бэлэн болох бөгөөд
		үлдсэн цорын ганц ажил нь файлын системүүдийг дахин холбож
		шоронгуудыг эхлүүлэх явдал юм:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -a</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>service jail start</code></strong></pre></li></ol></div><p>Шоронгууд зөв эхэлсэн эсэхийг шалгахын тулд <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jls&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jls</span>(8)</span></a>-г ашиглана.
	Шорон бүрт mergemaster-г ажиллуулахаа мартуузай. Тохиргооны файлууд болон
	rc.d скриптүүдийг шинэчлэх хэрэгтэй болно.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="jails-tuning.html">Өмнөх</a> </td><td width="20%" align="center"><a accesskey="u" href="jails.html">Дээш</a></td><td width="40%" align="right"> <a accesskey="n" href="mac.html">Дараах</a></td></tr><tr><td width="40%" align="left" valign="top">16.5. Нарийн тааруулалт болон удирдлага </td><td width="20%" align="center"><a accesskey="h" href="index.html">Эхлэл</a></td><td width="40%" align="right" valign="top"> Бүлэг 17. Mandatory Access Control буюу Албадмал Хандалтын хяналт</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Энэ болон бусад баримтуудыг
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    хаягаас татаж авч болно.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD-ийн талаар
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;
    хаягтай холбоо барихаасаа өмнө
    <a href="http://www.FreeBSD.org/docs.html">баримтыг</a> уншина уу.<br></br>
    Энэ бичиг баримттай холбоотой асуулт байвал
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;
    хаягаар цахим захидал явуулна уу.<br></br>
    Энэ бичиг баримтын орчуулгатай холбоотой асуулт байвал
    &lt;<a href="mailto:admin@mnbsd.org">admin@mnbsd.org</a>&gt;
    хаягаар цахим захидал явуулна уу.</small></p></body></html>