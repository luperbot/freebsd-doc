<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>18.4. Аудитийн тохиргоо</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD гарын авлага" /><link rel="up" href="audit.html" title="Бүлэг 18. Аюулгүй байдлын үйл явцад аудит хийх нь" /><link rel="prev" href="audit-install.html" title="18.3. Аудит хийх дэмжлэг суулгах нь" /><link rel="next" href="audit-administration.html" title="18.5. Аудит дэд системийг удирдах нь" /><link rel="copyright" href="legalnotice.html" title="Хуулийн заалт" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">18.4. Аудитийн тохиргоо</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="audit-install.html">Өмнөх</a> </td><th width="60%" align="center">Бүлэг 18. Аюулгүй байдлын үйл явцад аудит хийх нь </th><td width="20%" align="right"> <a accesskey="n" href="audit-administration.html">Дараах</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="audit-config"></a>18.4. Аудитийн тохиргоо</h2></div></div></div><p>Аюулгүй байдлын аудитийн тохиргооны бүх файлуудыг
	<code class="filename">/etc/security</code> дотроос олж болно.
	Дараах файлууд аудит дэмон эхлэхээс өмнө байх ёстой:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">audit_class</code> - Аудитийн ангиллуудын
	тодорхойлолтуудыг агуулна.</p></li><li class="listitem"><p><code class="filename">audit_control</code> - Анхдагч аудитийн ангиллууд,
	аудитийн хянан бүртгэлтийн эзлэхүүнд үлдээх хамгийн бага дискний зай, хамгийн их
	аудитийн мөрийн хэмжээ гэх зэрэг аудит дэд системийн шинж чанарыг хянана.</p></li><li class="listitem"><p><code class="filename">audit_event</code> - Системийн аудит үйл явцуудын
	тайлбарууд, нэрс болон үйл явц болгон аль ангилалд хамаарах жагсаалт.</p></li><li class="listitem"><p><code class="filename">audit_user</code> - Нэвтрэн орох үеийн глобал анхдагчуудаас
	бүрдсэн зөвхөн хэрэглэгчид хамааралтай аудитийн шаардлагууд</p></li><li class="listitem"><p><code class="filename">audit_warn</code> - Аудитийн бичлэгүүдийн зай хангалтгүй
	болох эсвэл аудитийн мөрийн файл дахин эргэсэн зэрэг зайлшгүй шаардлагатай тохиолдолд
	анхааруулах мэдээллүүдийг үүсгэдэг өөрчлөх боломж бүхий <span class="application">auditd</span>-ийн ашигладаг
	бүрхүүлийн скрипт.</p></li></ul></div><div xmlns="" class="warning"><h3 class="admontitle">Сануулга: </h3><p xmlns="http://www.w3.org/1999/xhtml">Тохиргоон дахь алдаанууд үйл явцуудын буруу хянан бүртгэлд хүргэж болзошгүй тул
	аудитийн тохиргооны файлуудыг засварлах болон ажиллагааг хангахдаа заавал
	болгоомжтой байх шаардлагатай.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81601232"></a>18.4.1. Үйл явц сонголтын илэрхийллүүд</h3></div></div></div><p>Сонголтын илэрхийллүүд нь аль үйл явцуудыг аудит хийх ёстойг тодорхойлох
	аудитийн тохиргооны хэд хэдэн газар ашиглагддаг. Илэрхийллүүд нь тохирох үйл
	явцын ангиллуудын жагсаалтаас бүрдэх ба эдгээр тус бүр нь тохирох бичлэгүүдийг
	хүлээн авах ёстой юу эсвэл орхих ёстой юу гэдгийг харуулсан угтвартайгаас
	гадна оруулга нь амжилттай эсвэл амжилтгүй үйлдлүүдтэй тохирох ёстойг харуулах
	боломж бас байна. Сонголтын илэрхийллүүд нь зүүнээс баруун тийш биелэгддэг
	бөгөөд хоёр илэрхийллийг нэг дээр нь нөгөөг нь нэмж нийлүүлдэг.</p><p>Дараах жагсаалт нь <code class="filename">audit_class</code>-д байгаа анхдагч
	үйл явцын ангиллуудаас тогтоно:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">all</code> - <span class="emphasis"><em>all</em></span> - Бүх үйл
		явцын ангиллуудыг тааруулах(match).</p></li><li class="listitem"><p><code class="literal">ad</code> - <span class="emphasis"><em>administrative</em></span>
	    - Удирдлагын үйлдлүүд систем дээр бүхэлдээ гүйцэтгэгдэнэ.</p></li><li class="listitem"><p><code class="literal">ap</code> - <span class="emphasis"><em>application</em></span> -
	    Програмын тодорхойлсон үйлдэл.</p></li><li class="listitem"><p><code class="literal">cl</code> - <span class="emphasis"><em>file close</em></span> -
		<code class="function">close</code> системийн дуудлагыг аудит хийх.</p></li><li class="listitem"><p><code class="literal">ex</code> - <span class="emphasis"><em>exec</em></span> - Програмын
		ажиллагааг аудит хийх. Тушаалын мөрийн нэмэлт өгөгдлүүд болон орчны
		хувьсагчуудыг <code class="literal">argv</code> ба <code class="literal">envv</code>
		параметрүүдийг ашиглан <code class="literal">policy</code> тохиргоонд
		тохиргоо хийн <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=audit_control&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">audit_control</span>(5)</span></a> -ийн тусламжтайгаар хянадаг.</p></li><li class="listitem"><p><code class="literal">fa</code> - <span class="emphasis"><em>file attribute access</em></span>
	    - <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stat&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stat</span>(1)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pathconf&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">pathconf</span>(2)</span></a> болон бусад адил үйл явцуудын
		обьектийн шинж чанаруудад хандсан хандалтыг аудит хийх.</p></li><li class="listitem"><p><code class="literal">fc</code> - <span class="emphasis"><em>file create</em></span>
	    - Үр дүнд нь файл үүсдэг үйл явцуудыг аудит хийх.</p></li><li class="listitem"><p><code class="literal">fd</code> - <span class="emphasis"><em>file delete</em></span>
	    - Файлыг устгадаг үйл явцуудыг аудит хийх.</p></li><li class="listitem"><p><code class="literal">fm</code> - <span class="emphasis"><em>file attribute modify</em></span>
	    - <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chown&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">chown</span>(8)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chflags&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">chflags</span>(1)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=flock&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">flock</span>(2)</span></a> зэрэг
		файлын шинж чанарын өөрчлөлт гарч байгаа үйл явцуудыг аудит хийх.</p></li><li class="listitem"><p><code class="literal">fr</code> - <span class="emphasis"><em>file read</em></span>
	    - Өгөгдөл уншигдаж байгаа, мөн файлуудыг уншихаар нээсэн зэрэг үйл явцуудыг
		аудит хийх.</p></li><li class="listitem"><p><code class="literal">fw</code> - <span class="emphasis"><em>file write</em></span> -
		Өгөгдөл бичигдэж байгаа, мөн файлд бичсэн эсвэл файл өөрчлөгдсөн зэрэг үйл
		явцуудыг аудит хийх.</p></li><li class="listitem"><p><code class="literal">io</code> - <span class="emphasis"><em>ioctl</em></span> - <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ioctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a>
		системийн дуудлагын хэрэглээг аудит хийх.</p></li><li class="listitem"><p><code class="literal">ip</code> - <span class="emphasis"><em>ipc</em></span> - POSIX хоолойнууд
		болон System V <acronym class="acronym">IPC</acronym> үйлдлүүд зэрэг Процесс-Хоорондох
		Холбооны төрөл бүрийн хэлбэрүүдийг аудит хийх.</p></li><li class="listitem"><p><code class="literal">lo</code> - <span class="emphasis"><em>login_logout</em></span> -
		Систем дээр болж байгаа <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=login&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">login</span>(1)</span></a> ба <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=logout&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">logout</span>(1)</span></a>
		үйл явцуудыг аудит хийх.</p></li><li class="listitem"><p><code class="literal">na</code> - <span class="emphasis"><em>non attributable</em></span> -
		Шинж чанаргүй үйл явцуудыг аудит хийх.</p></li><li class="listitem"><p><code class="literal">no</code> - <span class="emphasis"><em>invalid class</em></span> -
		Аудит бус үйл явцуудыг тааруулах(match).</p></li><li class="listitem"><p><code class="literal">nt</code> - <span class="emphasis"><em>network</em></span> -
		<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=connect&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">connect</span>(2)</span></a> ба <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=accept&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a> зэрэг сүлжээний үйлдлүүдтэй
		холбоотой үйл явцуудыг аудит хийх.</p></li><li class="listitem"><p><code class="literal">ot</code> - <span class="emphasis"><em>other</em></span> -
	    Бусад үйл явцуудыг аудит хийх.</p></li><li class="listitem"><p><code class="literal">pc</code> - <span class="emphasis"><em>process</em></span> -
		<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exec&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">exec</span>(3)</span></a> ба <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exit&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">exit</span>(3)</span></a> зэрэг процессийн үйлдлүүдийг
		аудит хийх.</p></li></ul></div><p>Эдгээр аудит үйл явцын ангиллуудыг <code class="filename">audit_class</code>
	болон <code class="filename">audit_event</code> тохиргооны файлуудыг өөрчилснөөр
	өөрчилж болно.</p><p>Жагсаалтад байгаа аудитийн ангилал бүр амжилттай/амжилтгүй үйлдлүүдийг
	таарсан эсэхийг болон ангилал ба төрлийн хувьд таарч байгааг нэмж
	байгаа эсвэл устгаж байгааг харуулсан угтвартай байна.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>(none) Үйл явцын амжилттай болон амжилтгүйг аудит хийх.</p></li><li class="listitem"><p><code class="literal">+</code> Энэ ангилал дахь амжилттай үйл явцуудыг
		аудит хийх.</p></li><li class="listitem"><p><code class="literal">-</code> Энэ ангилал дахь амжилтгүй үйл явцуудыг
		аудит хийх.</p></li><li class="listitem"><p><code class="literal">^</code> Энэ ангилал дахь амжилттай, амжилтгүй
		аль нь ч биш үйл явцуудыг аудит хийх.</p></li><li class="listitem"><p><code class="literal">^+</code> Энэ ангилал дахь амжилттай үйл явцуудыг
		аудит хийхгүй.</p></li><li class="listitem"><p><code class="literal">^-</code> Энэ ангилал дахь амжилтгүй үйл явцуудыг
		аудит хийхгүй.</p></li></ul></div><p>Дараах сонголтын мөр амжилттай ба амжилтгүй нэвтрэлт/гаралтын үйл явцуудаас
	гадна зөвхөн амжилттай ажиллуулсныг сонгож байна:</p><pre class="programlisting">lo,+ex</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81700944"></a>18.4.2. Тохиргооны файлууд</h3></div></div></div><p>Аудит системийг тохируулахдаа ихэнх тохиолдолд администраторууд зөвхөн хоёр
	файлыг өөрчлөх хэрэгтэй: <code class="filename">audit_control</code>
	болон <code class="filename">audit_user</code>.  Эхнийх нь системийн дагуух
	аудит өмчүүд болон бодлогуудыг хянадаг; хоёр дахь нь хэрэглэгчийн аудитийг нарийн
	тохируулахад ашиглагддаг.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="audit-auditcontrol"></a>18.4.2.1.  <code class="filename">audit_control</code> файл</h4></div></div></div><p> <code class="filename">audit_control</code> файл нь аудит дэд системийн хувьд
	анхдагч утгуудын тоог тодорхойлно. Энэ файлын дотор бид дараах зүйлсийг харна:</p><pre class="programlisting">dir:/var/audit
flags:lo
minfree:20
naflags:lo
policy:cnt
filesz:0</pre><p> <code class="option">dir</code> тохиргоо нь аудит бүртгэлүүдийг хадгалах нэг болон
	хэд хэдэн санг заахад хэрэглэгдэнэ. Хэрэв нэгээс их сан байгаа бол бичигдсэн
	дарааллаараа ашиглагдана. Файлын систем дүүрсэн тохиолдолд аудит дэд систем болон
	бусад дэд системүүд бие биедээ нөлөөлж болзошгүй учир аудит бүртгэлүүдийг тусгайлан
	зориулсан файлын систем дээр хадгалахаар аудит системийг ихэвчлэн тохируулдаг.</p><p> <code class="option">flags</code> талбар нь системийн дагуух шинж чанар бүхий үйл явцуудад
	зориулсан анхдагч урьдчилан сонголтын багийг тодорхойлдог. Дээрх жишээн дээр бүх хэрэглэгчийн
	хувьд амжилттай болон амжилтгүй нэвтрэлт  болон гаралтын үйл явцууд аудит хийгдэж байна.</p><p> <code class="option">minfree</code> тохиргоо нь аудит мөр хадгалагдах файлын системийн
	хувьд хамгийн бага чөлөөт зайны хувийг тодорхойлдог. Энэ тогтоосон хэмжээнээс илүү гарахад
	анхааруулга үүсгэгддэг. Дээрх жишээ хамгийн бага чөлөөт зайг 20 хувиар тогтоожээ.</p><p> <code class="option">naflags</code> тохиргоо нь нэвтрэн оролтын процесс
	болон системийн дэмонууд зэрэг шинж чанаргүй үйл явцуудыг аудит хийх аудитийн ангиллуудыг
	тодорхойлдог.</p><p> <code class="option">policy</code> тохиргоо нь таслалаар тусгаарлагдсан, аудитийн зан
	авирын төрөл бүрийн шинж чанарыг хянах бодлогын тугуудын жагсаалтыг тодорхойлдог. Анхдагч
	<code class="literal">cnt</code> туг нь аудит амжилтгүй болсон ч гэсэн систем ажиллагаагаа
	үргэлжлүүлэхийг заадаг (энэ туг зайлшгүй шаардлагатай). Өөр нэг байнга ашиглагддаг туг бол
	<code class="literal">argv</code> бөгөөд энэ нь <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=execve&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">execve</span>(2)</span></a> системийн дуудлагад орж байгаа
	тушаалын мөрийн нэмэлт өгөгдлүүдийг тушаалын ажиллагааг аудит хийхийн хэсэг болох боломж
	олгодог.</p><p><code class="option">filesz</code> тохиргоо нь мөрийн файл автоматаар төгсөх болон эргэхээс
	өмнөх аудит мөрийн файлын хамгийн их хэмжээг байтаар  тодорхойлдог. Анхдагч утга нь 0 байх ба
	автоматаар эргүүлэхийг хориглосон байна. Хэрэв хүссэн файлын хэмжээ тэгээс ялгаатай ба 512k -аас
	бага бол түүнийг орхиж бүртгэлийн мэдээлэл үүсгэнэ.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="audit-audituser"></a>18.4.2.2.  <code class="filename">audit_user</code> файл</h4></div></div></div><p> <code class="filename">audit_user</code> файл нь зарим нэг хэрэглэгчдэд
	зориулсан аудитийн шаардлагуудыг администраторууд тодорхойлохыг зөвшөөрдөг.
	Мөр болгон хэрэглэгчид зориулсан аудитийг хийхийг хоёр талбараар тохируулдаг: нэг дэх нь
	хэрэглэгчийн хувьд  үргэлж аудит хийх шаардлагатай нэг хэсэг үйл явцуудыг тодорхойлдог
	<code class="literal">alwaysaudit</code> талбар ба хоёр дахь нь
	<code class="literal">neveraudit</code> талбар бөгөөд хэрэглэгчийн хувьд  хэзээ ч
	аудит хийх шаардлагагүй нэг хэсэг үйл явцуудыг тодорхойлдог.</p><p>Дараах жишээн дээр <code class="filename">audit_user</code> файл нь нэвтрэлт/гаралтын
	үйл явцууд, <code class="systemitem">root</code> хэрэглэгчийн амжилттай тушаалын ажиллагаа, файл үүсгэлт ба <code class="systemitem">www</code>
	хэрэглэгчийн амжилттай тушаалын ажиллагааг аудит хийж байна. Хэрэв дээрх жишээ
	<code class="filename">audit_control</code> файлтай цуг ашиглагдвал
	<code class="systemitem">root</code>-ийн <code class="literal">lo</code> оруулга нь давхардах бөгөөд
	<code class="systemitem">www</code> хэрэглэгчийн нэвтрэлт/гаралтын үйл явцууд бас аудит хийгдэнэ.</p><pre class="programlisting">root:lo,+ex:no
www:fc,+ex:no</pre></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="audit-install.html">Өмнөх</a> </td><td width="20%" align="center"><a accesskey="u" href="audit.html">Дээш</a></td><td width="40%" align="right"> <a accesskey="n" href="audit-administration.html">Дараах</a></td></tr><tr><td width="40%" align="left" valign="top">18.3. Аудит хийх дэмжлэг суулгах нь </td><td width="20%" align="center"><a accesskey="h" href="index.html">Эхлэл</a></td><td width="40%" align="right" valign="top"> 18.5. Аудит дэд системийг удирдах нь</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Энэ болон бусад баримтуудыг
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    хаягаас татаж авч болно.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD-ийн талаар
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;
    хаягтай холбоо барихаасаа өмнө
    <a href="http://www.FreeBSD.org/docs.html">баримтыг</a> уншина уу.<br></br>
    Энэ бичиг баримттай холбоотой асуулт байвал
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;
    хаягаар цахим захидал явуулна уу.<br></br>
    Энэ бичиг баримтын орчуулгатай холбоотой асуулт байвал
    &lt;<a href="mailto:admin@mnbsd.org">admin@mnbsd.org</a>&gt;
    хаягаар цахим захидал явуулна уу.</small></p></body></html>