<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>第3章 トラブルシューティング</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 2.X、3.X、4.X についての FAQ (よくある質問とその答え)" /><link rel="up" href="index.html" title="FreeBSD 2.X、3.X、4.X についての FAQ (よくある質問とその答え)" /><link rel="prev" href="hardware.html" title="第2章 ハードウェアコンパチビリティ" /><link rel="next" href="commercial.html" title="第4章 商用アプリケーション" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第3章 トラブルシューティング</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="hardware.html">戻る</a>〓</td><th width="60%" align="center">〓</th><td width="20%" align="right">〓<a accesskey="n" href="commercial.html">次へ</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="troubleshoot"></a>第3章 トラブルシューティング</h1></div></div></div><p>
      <span class="emphasis"><em>訳:
        内川 喜章 <code class="email">&lt;<a xmlns="" class="email" href="mailto:yoshiaki@kt.rim.or.jp">yoshiaki@kt.rim.or.jp</a>&gt;</code>、
        1997 年 11 月 10 日</em></span>
    </p><div class="qandaset"><a id="idp80322256"></a><dl><dt>3.1. <a href="troubleshoot.html#idp80322512">ハードディスクに不良ブロックがあります!</a></dt><dt>3.2. <a href="troubleshoot.html#idp80334800">Bustek 742a EISA SCSI が認識されません。</a></dt><dt>3.3. <a href="troubleshoot.html#idp80338896">HP Netserver 上のオンボード SCSI コントローラが認識されません。</a></dt><dt>3.4. <a href="troubleshoot.html#idp80354512">この CMD640 IDE コントローラはどこかおかしいようです。</a></dt><dt>3.5. <a href="troubleshoot.html#idp80357968">ed1: timeout
            のようなメッセージがいつも出ます。</a></dt><dt>3.6. <a href="troubleshoot.html#idp80361552">CDROM をマウントしようとすると
            Incorrect super block と言われます。</a></dt><dt>3.7. <a href="troubleshoot.html#idp80371792">CDROM をマウントしようとすると
            Device not configured
            と言われます。</a></dt><dt>3.8. <a href="troubleshoot.html#idp80380752">CDROM をマウントすると、ファイル名中の英数字以外の
            文字が、「?」 と表示されてしまいます。</a></dt><dt>3.9. <a href="troubleshoot.html#idp80386000">私のプリンタはとてつもなく遅いのです。
            どうしたらよいのでしょう?</a></dt><dt>3.10. <a href="troubleshoot.html#idp80389968">わたしのプログラムは時々
            Signal 11
            のエラーで止まってしまいます。</a></dt><dt>3.11. <a href="troubleshoot.html#idp80408912">起動の時に画面が真っ暗になって同期も取れません。</a></dt><dt>3.12. <a href="troubleshoot.html#idp80460624">128MB の RAM があるのですが、64MB しか認識しません。</a></dt><dt>3.13. <a href="troubleshoot.html#idp80464720">FreeBSD 2.0 が
            kmem_map too small!
            と言ってパニックします。</a></dt><dt>3.14. <a href="troubleshoot.html#idp80471760">新しいカーネルで再起動すると
            CMAP busy panic
            となってパニックを起こしてしまいます。
          </a></dt><dt>3.15. <a href="troubleshoot.html#idp80475984">ahc0: brkadrint,  Illegal Host Access at seqaddr 0x0
            というエラーが出ます</a></dt><dt>3.16. <a href="troubleshoot.html#idp80479184">sendmail が mail loops back to myself
            というメッセージを出すのですが。</a></dt><dt>3.17. <a href="troubleshoot.html#idp80502992">リモートマシン上のフルスクリーンアプリケーションがうまく動かない</a></dt><dt>3.18. <a href="troubleshoot.html#idp80514640">私のマシンで calcru: negative time...
            と表示されるのですが</a></dt><dt>3.19. <a href="troubleshoot.html#idp80520400">pcm0 not found という表示を見たり
            カーネルコンフィグレーションファイルには device pcm0 と
            書いてあるのにサウンドカードが pcm1 として
            発見されたりします。</a></dt><dt>3.20. <a href="troubleshoot.html#idp80531024">プラグアンドプレイのカードが認識されなくなりました
            (または、unknown と認識されるようになりました)。</a></dt><dt>3.21. <a href="troubleshoot.html#idp80553424">top や systat の
            実行中に nlist failed という
            エラーがでます。</a></dt><dt>3.22. <a href="troubleshoot.html#idp80573520">ssh(1) や telnet(1) でコンピュータに接続する
            のに、どうしてこんなに時間がかかるのですか?</a></dt><dt>3.23. <a href="troubleshoot.html#idp80585424">file: table is full という
            メッセージが繰り返し dmesg にあらわれます。
          </a></dt><dt>3.24. <a href="troubleshoot.html#idp80594384">laptop の時間が狂って、大きく進んだり遅れたりします。</a></dt><dt>3.25. <a href="troubleshoot.html#idp80619216">BIOS 画面が出た後、FreeBSD のブートローダが
            Read error と表示して止まって
            しまいます。
          </a></dt><dt>3.26. <a href="troubleshoot.html#idp80625360">別のオペレーティングシステムが、ブートマネージャを
            壊してしまいました。どうすれば復旧できるでしょうか。
          </a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp80322512"></a><a id="awre"></a><p><strong>3.1.</strong></p></td><td align="left" valign="top"><p>ハードディスクに不良ブロックがあります!</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            SCSI ディスクの場合は自動的に再マップする機能があるはずです。
            しかし、理解し難い理由から多くのドライブがこの機能が無効化
            されて出荷されています…。
          </p><p>
            これを有効化するには、
            最初のデバイスのモードページを変更する必要があります。
            これは次のコマンドを実行することで、FreeBSD
            上で行なうことができます
            (<code class="systemitem">root</code> 権限で行ないます)。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>scsi -f /dev/rsd0c -m 1 -e -P 3</code></strong></pre><p>
            そして、<acronym class="acronym">AWRE</acronym> と <acronym class="acronym">ARRE</acronym>
            の値を 0 から 1 へ変更します
          </p><pre class="screen">AWRE (Auto Write Reallocation Enbld):  1
ARRE (Auto Read Reallocation Enbld):  1</pre><p>
            以下は、<a class="link" href="mailto:tedm@toybox.placo.com" target="_top">Ted
              Mittelstaedt 氏</a>から寄せられたものです。
          </p><p>
            IDE ドライブの場合は通常、不良ブロックは潜在的な障害の兆候です。
            最近の IDE ドライブは、内部の不良ブロック再マッピング機能を有効にした状態で
            出荷されています。また、今日の IDE ハードディスクメーカは、
            出荷以降に不良ブロックが発生することに関して保証を提供していて、
            不良ブロックのあるディスクドライブを交換するサービスを行なっています。
          </p><p>
            もし、不良ブロックのある IDE ディスクドライブを復旧しようと思うなら、
            IDE ドライブメーカが提供する IDE 診断プログラムをダウンロードして、
            そのドライブに使ってみてください。この種のプログラムは大抵、
            ドライブの制御部分に対して不良ブロックを再走査し、
            不良ブロックを使用不能にするようにセットすることができます。
          </p><p>
            ESDI、RLL および MFM ドライブの場合、
            不良ブロックはドライブの正常な部分であり、
            一般的に言って障害を表すものではありません。
            PC では、ディスクドライブコントローラカードと
            BIOS が不良ブロックの使用不能化の作業を行ないます。
            DOS など、ディスクアクセスに BIOS
            を経由する OS にとっては有効に働きますが、FreeBSD
            のディスクドライバは BIOS を利用しません。そのため、
            代替として bad144 という機構が存在します。
            bad144 は、wd ドライバでだけ (つまり FreeBSD 4.0
            ではサポートされていない)動作し、SCSI ドライバに利用することは
            <span class="emphasis"><em>できません</em></span>。bad144 は、
            検出された不良セクタをスペシャルファイルに記録するという機能を持っています。
          </p><p>
            bad144 を利用する上で、注意しなければならない点が一つあります。
            それは、不良ブロックスペシャルファイルは、
            ディスクの最終トラックに置かれるということです。
            このファイルには、ディスクの先頭の付近、
            <code class="filename">/kernel</code>
            ファイルが位置しているであろう部分で発生した不良セクタが記録されています。
            したがって、このファイルは BIOS
            コールを使ってカーネルファイルを読み込む起動プログラムが、
            アクセス可能でなければなりません。
            これはつまり、bad144 を利用するディスクは
            1024 シリンダ、16 ヘッド、63 セクタを超えてはならないということを意味し、
            bad144 を利用したディスクが実質 500MB を超えられないことになります。
          </p><p>
            bad144 を使うには、FreeBSD のインストール時に表示される fdisk 画面で
            <span class="quote">「<span class="quote">Bad Block</span>」</span> 走査を ON に設定するだけです。
            これは、FreeBSD 2.2.7 以降で機能します。
            ディスクは、1024 シリンダ以内でなければなりません。
            ディスクドライブは事前に少なくとも 4 時間、
            ディスクが温度によって膨張し、
            トラックに曲がりが出るまで回転させることをお薦めします
            (訳注: 温度変化に対する膨張によって、
            ディスクが微小変形することにより発生する不良セクタを確実に検出するためです)。
          </p><p>
            大容量の ESDI ドライブのように 1024 シリンダを超えるディスクの場合、
            DOS 上でそのディスクが利用できるよう、
            ESDI コントローラは特殊な変換モードを利用します。
            fdisk の <span class="quote">「<span class="quote">set geometry</span>」</span> コマンドを使って
            <span class="quote">「<span class="quote">変換された (translated)</span>」</span>
            ジオメトリに切替えると、wd ドライバはこの変換モードを解釈できます。
            その際、FreeBSD パーティションを作成するのに
            <span class="quote">「<span class="quote">dangerously dedicated</span>」</span>
            モードを利用してはいけません。
            このモードは、そのようなジオメトリを無視するからです。
            たとえ fdisk がオーバーライドされたジオメトリ情報を使ったとしても、
            依然としてディスクの真の大きさを保持しているため、大きすぎる FreeBSD
            パーティションを作成しようとしてしまうでしょう。
            ディスクジオメトリ情報が変換されたジオメトリ情報にかわっている場合は、
            手動でブロック数を入力し、
            パーティションを作成する必要があります。
          </p><p>
            大容量の ESDI ディスクを ESDI コントローラでセットアップするには、
            ちょっとしたトリックを使います。まず、DOS のディスクで起動して
            そのディスクを DOS パーティションとしてフォーマットします。
            そして FreeBSD を起動し、インストーラの fdisk 画面で
            DOS パーティションのブロックサイズとブロック数を読みとり、メモしておきます。
            ジオメトリ情報を DOS が利用しているものと同一に再設定し、
            DOS パーティションを削除して <span class="quote">「<span class="quote">cooperative</span>」</span> FreeBSD パーティションを
            先程記録したブロックサイズを使って作成してください。
            そのパーティションを起動可能パーティションに設定し、不良ブロック走査を
            有効にします。 実際のインストールでは、ファイルシステムが作成される前に
            bad144 が最初に実行されます (Alt-F2 を押すことで状況を確認できます)。
            不良セクタファイルを作成中に何らかの障害が発生したなら、
            システムを再起動して、もう一度最初からやり直しになります。
            おそらくディスクジオメトリ情報の設定を大きくしすぎているのでしょう
            (やり直しは、DOS によるフォーマットとパーティション確保を含みます)。
          </p><p>
            もし、不良ブロックの再マッピングを有効にしていて不良ブロックが見付かったら、
            ドライブの交換を考えてください。不良ブロックは、時間とともに悪化するからです。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80334800"></a><a id="bustek742a-eisa-scsi"></a><p><strong>3.2.</strong></p></td><td align="left" valign="top"><p>Bustek 742a EISA SCSI が認識されません。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            この情報は 742a のためのものですが、他の Buslogic カードについても
            同様のことが言えます。(Bustek = Buslogic)
          </p><p>
            742a カードには大きくわけて 2 つの「バージョン」が存在します。
            ハードウェアリビジョンの A-G と H 以降です。リビジョンの
            文字はカードの隅にあるアセンブリ番号の後ろにあります。
            742a は二つの ROM チップを持っており、一つは BIOS チップで
            もう一つはファームウェアチップです。FreeBSD はあなたの
            持っているものがどの BIOS バージョンかは問題ありませんが、
            ファームウェアバージョンについては問題となります。
            Buslogic の技術サポート部門に連絡すれば、アップグレード版の
            ROM を送ってくれることでしょう。BIOS チップと
            ファームウェアチップはペアで出荷されます。
            アダプタカードのハードウェアリビジョンにあわせた
            最も新しいファームウェア ROM を使用しなければなりません。
          </p><p>
            リビジョン A-G のカードには、2.41/2.21 までの
            BIOS/ファームウェアのセットを使用することができます。
            リビジョン H 以降のカードには、最新のものである
            4.70/3.37 の BIOS/ファームウェアのセットを
            使用することができます。これらのファームウェアの違いは、
            ファームウェア 3.37 が 「ラウンドロビン方式」
            をサポートしているところからきています。
          </p><p>
            Buslogic のカードには、製造番号も刻印されています。古い
            ハードウェアリビジョンのカードを持っている場合は、Buslogic の RMA
            部門に問い合わせて製造番号を伝えると、新しいハードウェアリビジョンの
            カードに交換することもできます。もしカードが十分新しければ、彼らは
            交換に応じてくれるでしょう。
          </p><p>
            FreeBSD 2.1 は ファームウェアリビジョン 2.21
            以降のものをサポートしています。
            これよりも古いファームウェアリビジョンのものは、
            Buslogic カードとして正常に認識されません。
            しかし、Adaptec 1540 として認識されるかもしれません。
            初期の Buslogic のファームウェアは AHA1540 「互換」モードを
            持っています。しかし、EISA カードにとってこれは
            よいことではありません。
          </p><p>
            古いハードウェアリビジョンのカードを持っていてファームウェア
            2.21 を入手するのであれば、ジャンパ W1 の位置をデフォルトの
            A-B から B-C に合わせる必要があるでしょう。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80338896"></a><a id="hpnetserver-scsi-failure"></a><p><strong>3.3.</strong></p></td><td align="left" valign="top"><p>HP Netserver 上のオンボード SCSI コントローラが認識されません。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            基本的にこれは既知の問題です。HP Netserver マシンの
            EISA オンボード SCSI コントローラは EISA のスロット番号 11
            を占有しますが、「本当の」EISA
            スロットはすべてそれよりも前のアドレスに配置されているのです。
            残念ながら、
            10 番以上の EISA スロットは PCI
            に割り当てられたアドレス空間と衝突し、FreeBSD
            の自動コンフィグレーションは、
            現状ではうまくこの状況を処理できていないのです。
          </p><p>
            ですから現時点での最良の方法は、カーネルオプションの
            <code class="literal">EISA_SLOTS</code> を 12 に変え、
            アドレス空間の衝突がないかの
            ようなふりをさせることです :)
            <a class="link" href="../handbook/kernelconfig.html" target="_top">カーネルの再構築</a>に記述されているようにしてカーネルを再構築してください。</p><p>
            もちろん、これはこのようなマシンにインストールする際に
            「卵が先か、
            鶏が先か」といった問題を生み出すことになります。
            この問題を回避するために、
            <span class="emphasis"><em>ユーザコンフィグ (UserConfig)</em></span>
            の中には特別な仕組みが組み込まれています。
            このとき <span class="quote">「<span class="quote">visual</span>」</span> インタフェースは使用せず、
            コマンドラインインタフェースを使用してください。単純に
          </p><pre class="programlisting">eisa 12
quit</pre><p>
            とプロンプト上から打ち込み、
            後は普通にインストールを行なってください。
            とにかくカスタムカーネルのコンパイルとインストールを行なうことを
            おすすめします。
          </p><p>
            うまくいけば、将来のバージョンではこの問題が解決していることでしょう。
          </p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">HP Netserver
                では<code class="literal">危険覚悟の専用ディスク</code>は使用できません。
                詳細については <a class="link" href="admin.html#dedicate">この注意事項</a>をご覧ください。
              </p></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80354512"></a><a id="cmd640-ide"></a><p><strong>3.4.</strong></p></td><td align="left" valign="top"><p>この CMD640 IDE コントローラはどこかおかしいようです。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            それは壊れているのです。両方のチャンネルを同時に制御できないのです。
          </p><p>
            現在、このチップを使っているシステムを自動的に検出して、
            うまく動かすためのしくみが使えるようになっています。
            くわしくは wd(4) のマニュアルページを参照してください。
          </p><p>
            CMD640 IDE コントローラを使っているシステムで FreeBSD 2.2.1
            あるいは 2.2.2 を使い、
            かつセカンダリのチャネルを使いたいのであれば、
            <code class="literal">options "CMD640"</code>
            を有効にしてカーネルを作り直してください。
            FreeBSD 2.2.5 以降では、デフォルトでそうなっています。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80357968"></a><a id="ed1-timeout"></a><p><strong>3.5.</strong></p></td><td align="left" valign="top"><p><code class="literal">ed1: timeout</code>
            のようなメッセージがいつも出ます。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            たぶん IRQ の衝突が原因でしょう (二つのボードが同じ IRQ
            を使用しているなど)。FreeBSD 2.0.5R
            以前はこれに関して寛大で、
            IRQ の衝突があってもネットワークドライバは機能していました。
            しかし 2.0.5R 以降はもはや、IRQ の衝突に寛大ではありません。
            <code class="option">-c</code> オプションをつけて起動し、
            ed0/de0/... のエントリをボードの設定に合わせてください。
          </p><p>
            ネットワークカードの BNC
            コネクタ (訳注: 10BASE-2 タイプのインタフェース)
            を使っている場合、
            デバイスのタイムアウトはターミネーションの不良によっても起きます。
            これをチェックするにはケーブルを外してターミネータを直接 NIC
            に接続します。そしてエラーメッセージが消えるかどうか
            確認します。
          </p><p>
            NE2000 コンパチブルカードのなかには、
            UTP ポートのリンクがなかったりケーブルが接続されていない場合に
            このエラーを出すものがあります。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80361552"></a><a id="mount-cd-superblock"></a><p><strong>3.6.</strong></p></td><td align="left" valign="top"><p>CDROM をマウントしようとすると
            <code class="literal">Incorrect super block</code> と言われます。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a>
            にマウントしたいデバイスのタイプを指定する必要があります。
            デフォルトでは <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a>
            はファイルシステムを
            <code class="literal">ufs</code> とみなします。CDROM のファイルシステムを
            マウントしたいのであれば <code class="option">-t cd9660</code>
            と <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> にオプションをつけて明示する必要があります。
            これはもちろん
            CDROM が ISO 9660 ファイルシステムである場合です。ほとんどの
            CDROM はこの形式です。1.1R の FreeBSD では (訳注: 2.1.5R、
            2.2R でも同様です) 自動的に
            Rock Ridge 拡張 (長いファイル名への対応) をうまく解釈します。
          </p><p>
            CDROM のデバイス <code class="filename">/dev/cd0c</code>
            を
            <code class="filename">/mnt</code>
            にマウントしたい場合の例では、次のようにします。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -t cd9660 /dev/cd0c /mnt</code></strong></pre><p>デバイスの名前はインタフェースによっては別の名前になっている
            かもしれないので注意してください
            (<code class="filename">/dev/cd0c</code> はこの場合の例です)。
            オプション <code class="option">-t cd9660</code> によって
            <code class="command">mount_cd9660</code>
            コマンドが実行されることに注意してください。
            このため例は次のようにすることもできます。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount_cd9660 /dev/cd0c /mnt</code></strong></pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80371792"></a><a id="cdrom-not-configured"></a><p><strong>3.7.</strong></p></td><td align="left" valign="top"><p>CDROM をマウントしようとすると
            <code class="literal">Device not configured</code>
            と言われます。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            これは 一般的に CDROM ドライブの中に CDROM が入っていないか、
            ドライブがバス上に見えないことを意味します。ドライブに CDROM
            を入れるか、IDE (ATAPI) であれば master/slave
            の状態をチェックしてください。
            また、CDROM ドライブに CDROM
            を入れてから認識するまでには数秒かかりますので、
            少し待ってみてください。
          </p><p>
            SCSI CDROM ではバスリセットへの応答時間が遅いために、
            失敗することがあるかもしれません。
            SCSI CDROM を持っている場合は、
            カーネルコンフィグレーションファイルに以下の行を加えて
            再コンパイルして試してみてください。
          </p><pre class="programlisting">options "SCSI_DELAY=15"</pre><div xmlns="" class="note"><h3 class="admontitle">訳注: </h3><p xmlns="http://www.w3.org/1999/xhtml">
                現在の GENERIC カーネルでは上の設定はデフォルトになっています。
                問題がある場合は <code class="literal">SCSI_DELAY</code>
                の数値を増やしてみてください。
              </p></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80380752"></a><a id="cdrom-unicode-filenames"></a><p><strong>3.8.</strong></p></td><td align="left" valign="top"><p>CDROM をマウントすると、ファイル名中の英数字以外の
            文字が、<span class="quote">「<span class="quote">?</span>」</span> と表示されてしまいます。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>もっともありそうなのは、その CDROM が
            <span class="quote">「<span class="quote">Joliet</span>」</span> 拡張を利用してファイルおよび
            ディレクトリに関する情報を保存しているということです。この拡張は、
            すべてのファイル名を Unicode の 2 バイト文字で保存するように
            規定しています。現在、FreeBSD カーネルに汎用的な Unicode
            インタフェースを導入する作業が行われていますが、
            まだ完了していません。したがって、CD9660
            ドライバはファイル名の文字を解読できません。</p><p>一時的な解決策として、FreeBSD 4.3R 以降では、CD9660
            ドライバに特別な仕掛けを施して、ユーザーがその場で適切な
            変換表を読み込めるようにしました。一般的なエンコーディングに
            対応したいくつかのモジュールが
            <code class="filename">sysutils/cd9660_unicode</code> port
            で提供されています。</p><div xmlns="" class="note"><h3 class="admontitle">訳注: </h3><p xmlns="http://www.w3.org/1999/xhtml">この記述は古くなっています。<a class="link" href="../../../en_US.ISO8859-1/books/faq/disks.html#CDROM-UNICODE-FILENAMES" target="_top">
              英語版の記述</a>をご覧ください。</p></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80386000"></a><a id="printer-slow"></a><p><strong>3.9.</strong></p></td><td align="left" valign="top"><p>私のプリンタはとてつもなく遅いのです。
            どうしたらよいのでしょう?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            パラレルインタフェースで、問題はとんでもなく遅いだけであるなら、
            プリンタボートを <span class="quote">「<span class="quote">polled</span>」</span>
            モードに設定してみてください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptcontrol -p</code></strong></pre><p>
            HP の新しいプリンタには、
            割り込みモードで使えないものがあるようです
            (完全にわかったわけではありませんが)。
            タイミングの問題のように思われます。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80389968"></a><a id="signal11"></a><p><strong>3.10.</strong></p></td><td align="left" valign="top"><p>わたしのプログラムは時々
            <code class="literal">Signal 11</code>
            のエラーで止まってしまいます。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Signal 11 エラーはオペレーティングシステムが
            許可を与えていないメモリにアクセスしようとしたときに発生します。
            このようなことがランダムな間隔で起っているようなら、
            注意深く調査していった方が良いです。</p><p>この手の問題はたいていの場合、以下のどちらかです。</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>その問題が特定の、
                あなたが自分で開発したアプリケーションでのみ起っているなら、
                あなたのコードにバグがあるのでしょう。</p></li><li class="listitem"><p>それが FreeBSD のベースシステムの一部と関連する問題なら、
                コードにバグがあるということになります。
                しかしほとんどの場合、
                普通の FAQ の読者がそのようなコードを使うようになるずっと前に、
                そういった問題は発見され、修正されているはずです
                (それが -current の役目なのですから)。</p></li></ol></div><p>それが FreeBSD のバグでは「ない」という決定的なケースとして、
            その問題の発生がプログラムをコンパイルしているときであり、
            コンパイル毎に毎回、コンパイラの挙動が変るというものがあります。</p><p>たとえば、あなたが <span class="quote">「<span class="quote">make buildworld</span>」</span> を実行していて、
            コンパイラが ls.c から ls.o をコンパイルしようとしたときに
            コンパイルに失敗したとします。もう一度 <span class="quote">「<span class="quote">make buildworld</span>」</span>
            を実行したときに、まったく同じ場所でコンパイルが失敗したのなら、
            それは build が壊れている (訳注: つまりソースにバグがある)
            と言うことです -- ソースを更新してやりなおしてみてください。
            もしコンパイルが別の場所でしくじっていたら、
            それはハードウェアの問題です。</p><p>あなたのやるべき事は:</p><p>前者の場合は、
            そのプログラムの間違ったアドレスへアクセスしようとしている部分を、
            gdb 等のデバッガで見つけて修正します。</p><p>後者の場合は、
            ハードウェアに問題がないことを確かめる必要があります。</p><p>その一般的な原因として :</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>ハードディスクが熱を持ちすぎているかも知れません:
                ケースのファンがちゃんと動いていてディスクを冷やしているか
                確かめてください (たぶん、他の部品も過熱しています)。</p></li><li class="listitem"><p>CPU がオーバーヒートしています:
                CPU をオーバークロックしていませんか? さもなければ
                CPU ファンが死んでいるのかもしれません。
                いずれにせよ、少なくとも問題解決の間では
                ハードウェアが動くべく指定された条件で動かしてください。
                クロックはデフォルトの設定に戻してください。</p><p>もしあなたがクロックアップをしているのなら、
                遅いシステムでも、システムが焼き付いて
                買い換えなければならなくなるよりずっとマシだということを
                覚えておいた方が良いでしょう。
                大きいコミュニティでは特に、
                あなたがそれが安全だと思っているかどうかは関係なく、
                オーバークロックしたシステムに発生した問題には同情的ではありません。</p></li><li class="listitem"><p>怪しいメモリ:
                もし複数の SIMM や DIMM を使っているならそれを全部抜いてから
                各 SIMM や DIMM を別個に組み込んだシステムを立ち上げてることで
                どの DIMM/SIMM が怪しいのか、それとも組合わせが悪いのか
                と問題の幅が狭まります。</p></li><li class="listitem"><p>楽観的すぎるマザーボードの設定:
                ほとんどの場合に標準設定で十分なタイミングを、
                BIOS の設定やマザーボード上のジャンパピンを変えることで、
                さまざまに変更することができます。しかし時には RAM の
                アクセスウェイトを低くしすぎたり <span class="quote">「<span class="quote">RAM Speed: Turbo</span>」</span> や
                その手の BIOS の設定でおかしな挙動が起こることがあります。
                BIOS を標準の設定に戻すというのはいいアイディアですが、
                その前にあなたの設定を書き留めておいた方がいいでしょう。</p></li><li class="listitem"><p>マザーボードへの電源が安定していない。
                もし使っていない I/O ボードやハードディスク、
                CDROM 等があるなら、一旦それらから電源ケーブルを抜き、
                電源が小さな負荷ならなんとか動作するか確認しましょう。
                あるいは別の電源を試してみましょう。
                その時はなるべく、少し容量の大きいもので試しましょう
                (たとえば、今の電源容量が 250W だったら 300W
                のものを試します)。</p></li></ol></div><p>SIG11 FAQ (下に示します) にはこれらの問題のすべてが
            詳しく説明されています。Linux の視点に基づくものですが、
            これも読んでおいた方がいいでしょう。そこではまた、
            メモリのテストを行うソフトウェアや、
            ハードウェアがなぜ問題のあるメモリを見逃してしまうかについても
            議論されています。</p><p>最後に、これらがどれも助けにならなかったら、
            FreeBSD のバグを発見した可能性があります。
            以下の説明を読んで障害報告を送ってください。</p><p>詳細な FAQ は、<a class="link" href="http://www.bitwizard.nl/sig11/" target="_top">
              the SIG11 problem FAQ</a> にあります。</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80408912"></a><a id="screen-loses-sync"></a><p><strong>3.11.</strong></p></td><td align="left" valign="top"><p>起動の時に画面が真っ暗になって同期も取れません。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            これは ATI Mach 64 ビデオカードの既知の問題です。
            この問題はカードがアドレス <code class="literal">2e8</code> を使い、
            4 番目のシリアルポートもここを使うということにあります。
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sio&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sio</span>(4)</span></a> ドライバのバグ (仕様?) のため、
            4 番目のシリアルポートがなくても、
            通常このアドレスを使う sio3 (4 番目のポートにあたります)
            を無効にしても、ドライバはこのアドレスをさわります。
          </p><p>
            バグが修正されるまでは、次のようにして対処してください。
          </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>起動プロンプトが出たら <code class="option">-c</code> と入力します
                  (これによりカーネルはコンフィグレーションモードに入ります)。
                </p></li><li class="listitem"><p>
                  <code class="filename">sio0</code>,
                  <code class="filename">sio1</code>,
                  <code class="filename">sio2</code>,
                  <code class="filename">sio3</code> (これらすべて) を無効にします。
                  これによって <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sio&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sio</span>(4)</span></a> ドライバは動作しなくなりますが、問題はありません。
                </p></li><li class="listitem"><p>exit と入力して起動を続行します。</p></li></ol></div><p>
            もしシリアルポートを有効にしたいのであれば以下の変更を行なって
            新しいカーネルを作る必要があります。
            <code class="filename">/usr/src/sys/i386/isa/sio.c</code> の中で 1 ヵ所ある
            <code class="literal">0x2e8</code> という文字列を探し、
            この文字列とその手前にあるコンマを削除します
            (後ろのコンマは残します)。
            後は通常の手続きにしたがって新しいカーネルを作ります。
          </p><p>
            この対処を行なった後でもまだ
            X ウィンドウシステムはうまく動かないかもしれません。
            その場合は、
            使用している XFree86 がすくなくとも XFree86 3.3.3
            以降であることを確かめてください。
            それ以降のバージョンでは、
            Mach64 カードやそれらのカードのためにつくられた
            X サーバ の組込みをサポートします。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80460624"></a><a id="reallybigram"></a><p><strong>3.12.</strong></p></td><td align="left" valign="top"><p>128MB の RAM があるのですが、64MB しか認識しません。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            FreeBSD がメモリのサイズを BIOS から取得する方法の制限により、
            KB 単位で 16 ビット分までしか検出できません (すなわち最大
            65535KB=64MB です。これより少ない場合もあります。
            ある BIOS の場合はメモリサイズが 16MB に制限されます)。
            64MB 以上のメモリを積んでいる場合、
            FreeBSD はそれを検出しようとします。
            しかしその試みは失敗するかもしれません。
          </p><p>
            この問題を回避するには、
            以下に示すカーネルオプションを使用する必要があります。
            完全なメモリ情報を BIOS から取得する方法もありますが、
            起動ブロックに空きが無いため実装できません。
            起動ブロックの問題が解決されれば、
            いつか拡張 BIOS 機能を使用して完全なメモリ情報を取得できるようになるでしょう。
            とりあえず現在は、カーネルオプションを使ってください。
          </p><p><code class="literal">options "MAXMEM=n"</code></p><p>
            <em class="replaceable"><code>n</code></em> には、
            キロバイト単位でメモリの量を指定します。128MB
            の場合は、<code class="literal">131072</code> となります。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80464720"></a><a id="panic-kmemmap-too-small"></a><p><strong>3.13.</strong></p></td><td align="left" valign="top"><p>FreeBSD 2.0 が
            <code class="literal">kmem_map too small!</code>
            と言ってパニックします。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">メッセージは、<code class="literal">mb_map too small!</code>
                の場合もあります。
              </p></div><p>
            このパニックは、ネットワークバッファ (特に mbuf
            クラスタ) の仮想メモリが無くなったことを示します。
            以下のオプションをカーネルコンフィグファイルに追加して
            mbuf クラスタに使用できる仮想メモリの量を増やしてください。
          </p><p><code class="literal">options "NMBCLUSTERS=n"</code></p><p>
            <em class="replaceable"><code>n</code></em>
            には、
            同時に使用したい TCP コネクションの数に応じて
            512 から 4096 までの数値を指定できます。
            とりあえず 2048 を試してみるのをおすすめします。
            これでパニックは完全の予防できるはずです。
            mbuf クラスタの割り当て、使用状況については、
            <code class="command">netstat -m</code> で知ることができます
            (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=netstat&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">netstat</span>(1)</span></a> をご覧ください)。
            <code class="literal">NMBCLUSTERS</code> のデフォルト値は
            <code class="literal">512 + MAXUSERS * 16</code> です。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80471760"></a><a id="cmap-busy-panic"></a><p><strong>3.14.</strong></p></td><td align="left" valign="top"><p>新しいカーネルで再起動すると
            <code class="literal">CMAP busy panic</code>
            となってパニックを起こしてしまいます。
          </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            ファイル <code class="filename">/var/db/kvm_*.db</code>
            において範囲外のデータを検出するためのロジックは失敗することがあり、
            こうした矛盾のあるファイルを使用することでパニックを引き起こすことがあります。
          </p><p>
            これが起こったなら、シングルユーザで再起動した後に、
            以下のコマンドを実行してください。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>rm /var/db/kvm_*.db</code></strong></pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80475984"></a><a id="brkadrint-illegal-host-access"></a><p><strong>3.15.</strong></p></td><td align="left" valign="top"><p><code class="literal">ahc0: brkadrint,  Illegal Host Access at seqaddr 0x0</code>
            というエラーが出ます</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            これは Ultrastor SCSI Host Adapter と衝突しています。
          </p><p>
            起動時に kernel configuration メニューに入り、
            問題を起こしている
            <code class="filename">uha0</code>
            を disable にしましょう。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80479184"></a><a id="mail-loopback"></a><p><strong>3.16.</strong></p></td><td align="left" valign="top"><p>sendmail が <code class="literal">mail loops back to myself</code>
            というメッセージを出すのですが。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            この事は、sendmail FAQ に次のように書いてあります。
          </p><div class="literallayout"><p>〓〓〓〓〓〓〓〓*〓"Local〓configuration〓error"〓というメッセージが出ます。たとえば:<br />
<br />
〓〓〓〓〓〓〓〓553〓relay.domain.net〓config〓error:〓mail〓loops〓back〓to〓myself<br />
〓〓〓〓〓〓〓〓554〓&lt;user@domain.net&gt;...〓Local〓configuration〓error<br />
<br />
〓〓〓〓〓〓〓〓のような物ですが、どのようにしたらこの問題を解決できますか?<br />
<br />
〓〓〓〓〓〓〓〓これは、たとえば〓domain.net〓のようなドメイン宛てのメールを〓MX〓record〓で<br />
〓〓〓〓〓〓〓〓特定のホスト〓(ここでは〓relay.domain.net)〓に送ろうとしたのに、<br />
〓〓〓〓〓〓〓〓そのホストでは〓domain.net〓宛てのメールを受け取れるような設定に<br />
〓〓〓〓〓〓〓〓なっていない場合です。設定の際に〓FEATURE(use_cw_file)〓を<br />
〓〓〓〓〓〓〓〓指定してある場合には〓/etc/sendmail.cw〓の中に〓domain.net〓を<br />
〓〓〓〓〓〓〓〓追加してください。もしくは、/etc/sendmail.cf〓の中に<br />
〓〓〓〓〓〓〓〓"Cw〓domain.net"〓を追加してください。<br />
〓〓〓〓〓〓〓〓〓〓〓〓</p></div><p>
            もはや現在の
            <a class="link" href="ftp://rtfm.mit.edu/pub/usenet/news.answers/mail/sendmail-faq" target="_top">sendmail FAQ</a>
            は sendmail release とは一緒には保守されていません。
            しかし次のネットニュースに定期的に投稿されてます。
            <a class="link" href="news:comp.mail.sendmail" target="_top">comp.mail.sendmail</a>、
            <a class="link" href="news:comp.mail.misc" target="_top">comp.mail.misc</a>、
            <a class="link" href="news:comp.mail.smail" target="_top">comp.mail.smail</a>、
            <a class="link" href="news:comp.answers" target="_top">comp.answers</a>、
            <a class="link" href="news:news.answers" target="_top">news.answers</a>。
            また、メール経由でコピーを入手する場合は
            <a class="link" href="mailto:mail-server@rtfm.mit.edu" target="_top">mail-server@rtfm.mit.edu</a>
            宛まで本文に <code class="literal">send usenet/news.answers/mail/sendmail-faq</code>
            と書いて送ります。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80502992"></a><a id="remote-fullscreen"></a><p><strong>3.17.</strong></p></td><td align="left" valign="top"><p>リモートマシン上のフルスクリーンアプリケーションがうまく動かない</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            リモートマシンのターミナルタイプが FreeBSD
            のコンソールで必要とされている <code class="literal">cons25</code>
            以外のものです。
          </p><p>この問題を解決しうる方法はいろいろあります:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>リモートマシンにログインした後、
                  そのリモートマシンが
                  <code class="literal">ansi</code> か
                  <code class="literal">sco</code>
                  のターミナルタイプを知っているなら、
                  shell 変数の TERM にそれらのいずれかを設定します。
                </p></li><li class="listitem"><p>FreeBSD のコンソール側で
                  <span class="application">screen</span>
                  のような VT100 エミュレータを使用します。
                  <span class="application">screen</span>
                  は一つのターミナルの中で複数のセッションを並列動作させることができますし、
                  本来の機能も優れています。
                  各々の <span class="application">screen</span> のウィンドウは
                  VT100 ターミナルのように振る舞うので、
                  リモート側で設定されるべき TERM 変数は
                  <code class="literal">vt100</code> となります。
                </p></li><li class="listitem"><p>リモートマシンのターミナルデータベースに
                  <code class="literal">cons25</code>
                  のエントリをインストールします。
                  このインストール方法はリモートマシンのオペレーティングシステムに依存します。
                  リモートのシステムのシステム管理マニュアルが役に立つことでしょう。
                </p></li><li class="listitem"><p>FreeBSD 側で X サーバを起動して、
                  リモートマシンに <code class="command">xterm</code>
                  や <code class="command">rxvt</code>
                  のような X ベースのターミナルエミュレータを使ってログインします。
                  (訳注: 日本語が必要な場合は <code class="command">kterm</code> 等を
                  利用します)
                  リモートホストの TERM 変数は
                  <code class="literal">xterm</code> もしくは
                  <code class="literal">vt100</code> (訳注: もしくは <code class="literal">kterm</code>)
                  に設定します。
                </p></li></ul></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80514640"></a><a id="calcru-negative"></a><p><strong>3.18.</strong></p></td><td align="left" valign="top"><p>私のマシンで <code class="literal">calcru: negative time...</code>
            と表示されるのですが</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            これは、割り込みに関連するさまざまな不具合によって発生します。
            あるいは、あるデバイスが元々持っているバグが表面化したのかも知れません。
            この症状を再現させる一つの方法として、パラレルポート上で、
            TCP/IP を 大きな MTU
            で走らせるというものがあります。
            グラフィックアクセラレータがこの症状を起こすことがありますが、
            その場合はまず、カードの割り込み設定を確認してください。
          </p><p>
            この問題の副作用として、
            プロセスが <span class="quote">「<span class="quote">SIGXCPU exceeded cpu time limit</span>」</span>
            というメッセージとともに終了してしまう、というものがあります。</p><p>
            1998 年 11 月 29 日に公開された FreeBSD 3.0 以降で
            この問題が解決しないなら、次の sysctl 変数をセットしてください。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl -w kern.timecounter.method=1</code></strong></pre><p>
            これは、パフォーマンスへ強い影響を与えますが、
            問題の発生に比べればおそらく気にならない程度でしょう。
            もし、これでもまだ問題が残るようなら、
            カーネルオプションの <code class="literal">NTIMECOUNTER</code>
            を大きな値に増やしてください。
            <code class="literal">NTIMECOUNTER=20</code>
            にまで増やしても解決しない場合は、
            計時処理の信頼性が保てない程の割り込みが、
            そのマシン上で起こっていることを意味します。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80520400"></a><a id="pcm0-not-found"></a><p><strong>3.19.</strong></p></td><td align="left" valign="top"><p><code class="literal">pcm0 not found</code> という表示を見たり
            カーネルコンフィグレーションファイルには <code class="literal">device pcm0</code> と
            書いてあるのにサウンドカードが <code class="literal">pcm1</code> として
            発見されたりします。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>これは FreeBSD 3.x で PCI のサウンドカードを使っているときに
            発生します。<code class="literal">pcm0</code> デバイスは ISA
            のカード専用に予約されているものです。このため、
            あなたが PCI カードを持っているときはこのエラーが表示され、
            カードは <code class="literal">pcm1</code> として検出されます。
          </p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">この警告を、単にカーネルコンフィグファイルの当該行を
                <code class="literal">device pcm1</code> に変更することで
                抑制することはできません。その時は <code class="literal">pcm1</code>
                が ISA カードのために予約され、PCI のカードは
                <code class="literal">pcm2</code> として
                (<code class="literal">pcm1 not found</code> の警告とともに)
                検出されます。</p></div><p>
            PCI のサウンドカードを持っているのならば、以下のようにして
            <code class="literal">snd0</code> デバイスのかわりに <code class="literal">snd1</code>
            を作る必要があります。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /dev</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>./MAKEDEV snd1</code></strong></pre><p>この状況は FreeBSD 4.x では生じません。多くの努力の結果より
            <span class="emphasis"><em>PnP 中心</em></span>に作り替えられ、
            現在、<code class="literal">pcm0</code> デバイスは ISA
            カード専用に予約されたものではなくなりました。</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80531024"></a><a id="pnp-not-found"></a><p><strong>3.20.</strong></p></td><td align="left" valign="top"><p>プラグアンドプレイのカードが認識されなくなりました
            (または、<code class="literal">unknown</code> と認識されるようになりました)。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>現在の FreeBSD 4.x はより <span class="emphasis"><em>PnP 中心</em></span>に
            なっています。その副作用の影響で、FreeBSD 3.x で動いていた PnP デバイス
            (たとえばサウンドカードや内蔵モデム) の中には、
            動かなくなってしまったものもあります。</p><p>この挙動の原因は Peter Wemm が freebsd-questions
            メーリングリストに書いた、以下の
            「FreeBSD 4.x にアップグレードしたところ内蔵モデムが
            見つからなくなった」というメールで解説されています。
            (わかりやすくするために <code class="literal">[]</code> 内に
            コメントを加えました)。</p><div class="blockquote"><blockquote class="blockquote"><p>PnP BIOS はあらかじめ、[モデムを]
              ポート空間に存在しているかのように設定します。
              そのため [3.x では] 従来の手法に基づく ISA
              デバイスの検索により、モデムの存在を「発見」できます。
            </p><p>4.0 の ISA コードは、より PnP 中心になっています。
              [3.x では] ISA デバイスの検索が「はぐれた」デバイスを発見して、
              次に PNP デバイス ID のマッチが行なわれることでリソースの競合が発生し、
              デバイスの検索に失敗する可能性があります。
              したがって、4.0 の ISA コードでは
              二重に検索しないよう、プログラマブルなカードを
              最初に無効にしています。
              これは、対応している PnP ハードウェアの PnP ID が、
              予めわかっている必要がある、ということを意味します。
              ユーザがこの挙動にもっと手を入れられるようにすることが
              TODO リスト中にあげられています。</p></blockquote></div><p>3.0 で動作していたデバイスを 4.0 でも動作するようにするには、
            それの PnP ID を調べ、ISA デバイスの検索が
            PnP デバイスの識別に使っているリストにそれを追加する必要があります。
            デバイスの検索に使われる <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pnpinfo&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pnpinfo</span>(8)</span></a> を用いて、
            PnP ID を得ることができます。
            たとえば、内蔵モデムに関する <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pnpinfo&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pnpinfo</span>(8)</span></a> の出力は、
            以下のようになります。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pnpinfo</code></strong>
Checking for Plug-n-Play devices...

Card assigned CSN #1
Vendor ID PMC2430 (0x3024a341), Serial Number 0xffffffff
PnP Version 1.0, Vendor Version 0
Device Description: Pace 56 Voice Internal Plug &amp; Play Modem

Logical Device ID: PMC2430 0x3024a341 #0
        Device supports I/O Range Check
TAG Start DF
    I/O Range 0x3f8 .. 0x3f8, alignment 0x8, len 0x8
        [16-bit addr]
    IRQ: 4  - only one type (true/edge)</pre><p>[more TAG lines elided]</p><pre class="screen">
TAG End DF
End Tag

Successfully got 31 resources, 1 logical fdevs
-- card select # 0x0001

CSN PMC2430 (0x3024a341), Serial Number 0xffffffff

Logical device #0
IO:  0x03e8 0x03e8 0x03e8 0x03e8 0x03e8 0x03e8 0x03e8 0x03e8
IRQ 5 0
DMA 4 0
IO range check 0x00 activate 0x01</pre><p>必要な情報は、出力の冒頭にある
            <span class="quote">「<span class="quote">Vendor ID</span>」</span> 行にあります。
            かっこの中の 16 進数 (例の中では 0x3024a341) が PnP ID で、
            直前の文字列 (PMC2430) はユニークな ASCII ID です。
            この情報はファイル <code class="filename">/usr/src/sys/isa/sio.c</code> に
            追加する必要があります。</p><p>まず失敗したときに備えて <code class="filename">sio.c</code> の
            バックアップを取るべきです。障害報告を送るために修正パッチを
            作る時にも必要になるでしょう (send-pr しようとしていますよね?)。
            <code class="filename">sio.c</code> を編集して以下の行を探してください。</p><pre class="programlisting">static struct isa_pnp_id sio_ids[] = {</pre><p>そしてあなたのデバイスのエントリを追加する正しい場所を探します。
            エントリは以下のような形をしていて、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pnpinfo&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pnpinfo</span>(8)</span></a> の
            出力にある <span class="emphasis"><em>デバイスの説明</em></span>の全部
            (もし収まれば) か一部とともに行の右の方のコメント領域に書かれている
            ASCII ベンダ ID でソートされています。</p><pre class="programlisting">{0x0f804f3f, NULL},     /* OZO800f - Zoom 2812 (56k Modem) */
{0x39804f3f, NULL},     /* OZO8039 - Zoom 56k flex */
{0x3024a341, NULL},     /* PMC2430 - Pace 56 Voice Internal Modem */
{0x1000eb49, NULL},     /* ROK0010 - Rockwell ? */
{0x5002734a, NULL},     /* RSS0250 - 5614Jx3(G) Internal Modem */</pre><p>あなたのデバイスの16進数のベンダ ID を正しい場所に
            追加し、ファイルをセーブしてカーネルを作り直して再起動します。
            あなたのデバイスは FreeBSD 3.x の時と同じように
            <code class="literal">sio</code> として見つかるようになっているはずです。</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80553424"></a><a id="nlist-failed"></a><p><strong>3.21.</strong></p></td><td align="left" valign="top"><p><code class="command">top</code> や <code class="command">systat</code> の
            実行中に <span class="errorname">nlist failed</span> という
            エラーがでます。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>このエラーは、
            実行しようとしたアプリケーションが
            あるカーネルシンボルを検索した結果、
            何らかの理由でその検索に失敗した、ということを意味しています。
            これは、以下に示すいずれかの理由によるものです。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>カーネルとユーザランドが同期していない (つまり
                カーネルは新しいものを構築したが、
                <code class="buildtarget">installworld</code> は行なっていない。
                あるいはその逆) ので、
                シンボルテーブルがユーザアプリケーションの考えているものと異なっている。
                もしこのケースなら、一連のアップグレード手順に従ってアップグレードを行なってください
                (正しいやり方は <code class="filename">/usr/src/UPDATING</code>
                に書いてあります)。</p></li><li class="listitem"><p>カーネルをロードするのに
                <code class="command">/boot/loader</code> を使わず、
                直接 boot2 (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=boot&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">boot</span>(8)</span></a> 参照) からロードしている。
                もちろん
                <code class="command">/boot/loader</code>
                を使わなくとも問題はないのですが、
                <code class="command">/boot/loader</code> は一般的に、
                ユーザアプリケーションからカーネルシンボルを
                アクセスできるようにするための機能を持っています。</p></li></ul></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80573520"></a><a id="connection-delay"></a><p><strong>3.22.</strong></p></td><td align="left" valign="top"><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a> や <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=telnet&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">telnet</span>(1)</span></a> でコンピュータに接続する
            のに、どうしてこんなに時間がかかるのですか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>症状: TCP コネクションが確立してから、
            クライアントソフトウェアがパスワードを尋ねてくるまで
            (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=telnet&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">telnet</span>(1)</span></a> の場合は、ログインプロンプトが表示されるまで)
            に長い時間がかかる、というもの。</p><p>問題: おそらく、サーバソフトウェアがクライアントの
            IP アドレスからホスト名を解決しようとして、遅れが生じている
            のでしょう。FreeBSD に付属する SSH や Telnet を含む多くの
            サーバソフトウェアは、この名前解決をおこないます。これは、
            管理者が後日参照するログファイルに、その他の情報と一緒に
            ホスト名を記録できるようにするのが目的です。</p><p>対処法: もし、あなたのコンピュータ (クライアント)
            からどのサーバに接続する場合にも問題が起こるのであれば、
            クライアントに問題があります。そして、誰かがあなたの
            コンピュータ (サーバ) に接続するときだけ問題が起こるのであれば、
            そのサーバの問題です。</p><p>問題がクライアントにある場合、唯一の対処法は
            サーバがそのクライアントの名前を解決できるように DNS を修正することです。
            症状がローカルネットワークで発生しているなら、サーバの設定に
            原因がありますので、このまま続きを読みましょう。
            そうではなく、グローバルなインターネット環境で発生しているなら、
            ISP に連絡して問題の修正をお願いしなければならない可能性が高いでしょう。</p><p>問題がサーバにあって、症状がローカルネットワークで
            発生しているなら、ローカルのアドレス範囲にあるアドレスを、
            それに対応するホスト名に解決する問合せを処理できるように、
            サーバを設定する必要があります。
            詳しくは、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hosts&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">hosts</span>(5)</span></a> および <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=named&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">named</span>(8)</span></a>
            のマニュアルをご覧ください。グローバルなインターネット環境の場合は、
            サーバのリゾルバが正しく動作していないのが原因かもしれません。
            確認するには、他のホスト (たとえば
            <code class="systemitem">www.yahoo.com</code>) を引いてみてください。
            うまくいかなければ、あなたのコンピュータの問題です。</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80585424"></a><a id="file-table-full"></a><p><strong>3.23.</strong></p></td><td align="left" valign="top"><p><span class="errorname">file: table is full</span> という
            メッセージが繰り返し dmesg にあらわれます。
          </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            このエラーは、システムのファイル記述子を使い果たして
            しまった時に発生します。メモリ中のファイルテーブルが一杯に
            なっているのです。
          </p><p>解決法:</p><p>
            手動で sysctl 変数
            <code class="varname">kern.maxfiles</code> の限界値を調整します。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl -w kern.maxfiles=n</code></strong></pre><p><code class="varname">n</code> は、システム要件に合わせてください。
            オープンされたファイル、ソケットまたは fifo のそれぞれが
            ファイル記述子を消費します。規模の大きなサーバは、
            同時に実行されるサービスに応じて、いともたやすく何万もの
            ファイル記述子を要求します。</p><p>カーネルに設定されたデフォルトのファイル記述子の
            数を決定するのは、次の</p><pre class="programlisting">maxusers        32</pre><p>カーネル設定ファイルの <code class="varname">maxusers</code> 行
            です。<code class="varname">kern.maxfiles</code> はこの値に比例して
            増加します。
          </p><p>現在設定されている <code class="varname">kern.maxfiles</code> の
            値は、次のコマンドで調べることができます。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl kern.maxfiles</code></strong>
kern.maxfiles: 1064
          </pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80594384"></a><a id="laptop-clock-skew"></a><p><strong>3.24.</strong></p></td><td align="left" valign="top"><p>laptop の時間が狂って、大きく進んだり遅れたりします。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>laptop には二つ以上の時計が内蔵されていますが、FreeBSD
            が間違った方を選択して使用しています。</p><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dmesg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dmesg</span>(8)</span></a> を実行して
            <code class="literal">Timecounter</code> を含む行を確認してください。
            最後に出力された行が FreeBSD が選択したもので、まず間違い
            なく <code class="literal">TSC</code> でしょう。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dmesg | grep Timecounter</code></strong>
Timecounter "i8254"  frequency 1193182 Hz
Timecounter "TSC"  frequency 595573479 Hz</pre><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(3)</span></a> 変数
            <code class="literal">kern.timecounter.hardware</code> を確認すれば
            裏付けがとれます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl kern.timecounter.hardware</code></strong>
kern.timecounter.hardware: TSC</pre><p>バッテリ駆動している時に、BIOS が CPU の速度を変えるために
            TSC クロックを変更したり、電力節約モードに入ることがあります。
            しかし、FreeBSD はそういった調整を関知しないので、
            時間が早まったり遅れたりするようです。</p><p>上記の例では、<code class="literal">i8254</code> クロックも利用できます。
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(3)</span></a> 変数 <code class="literal">kern.timecounter.hardware</code>
            にその名称を書き込んで選択できます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl -w kern.timecounter.hardware=i8254</code></strong>
kern.timecounter.hardware: TSC -&gt; i8254</pre><p>これで、laptop はより正確な時間を刻むでしょう。</p><p>この変更を起動時に自動で行うには、次の行を
            <code class="filename">/etc/sysctl.conf</code> に追加してください。</p><pre class="programlisting">kern.timecounter.hardware=i8254</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80619216"></a><a id="boot-read-error"></a><p><strong>3.25.</strong></p></td><td align="left" valign="top"><p>BIOS 画面が出た後、FreeBSD のブートローダが
            <span class="errorname">Read error</span> と表示して止まって
            しまいます。
          </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>FreeBSD のブートローダがハードディスクのジオメトリを正しく
            認識していないようです。FreeBSD のスライスを
            fdisk によって手動で作成したり変更したりする際に、
            ジオメトリを誤って指定してしまったのでしょう。
          </p><p>ハードディスクのジオメトリの正しい値は、マシンの BIOS から
            得られます。そのハードディスクのシリンダ、ヘッド、セクタの
            数を探してください。
          </p><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysinstall&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysinstall</span>(8)</span></a> の fdisk において、
            <span class="keycap"><strong>G</strong></span> を入力してハードディスクのジオメトリを
            設定してください。
	  </p><p>シリンダ、ヘッド、セクタの数を入力するダイアログが出てきます。
            BIOS から得た値を斜線 (/) で区切って入力してください。
          </p><p>5000 シリンダ、250 ヘッド、60 セクタなら、
            <strong class="userinput"><code>5000/250/60</code></strong>
	    と入力します。
          </p><p>リターンキーを押して値を設定してください。それから
            <span class="keycap"><strong>W</strong></span> を入力してハードディスクに新しいパーティ
            ションテーブルを書き込んでください。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp80625360"></a><a id="bootmanager-restore"></a><p><strong>3.26.</strong></p></td><td align="left" valign="top"><p>別のオペレーティングシステムが、ブートマネージャを
            壊してしまいました。どうすれば復旧できるでしょうか。
          </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysinstall&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysinstall</span>(8)</span></a> を立ち上げて Configure (設定)、Fdisk
            の順に選択してください。ブートマネージャが置かれていた
            ディスクを選択して、<span class="keycap"><strong>スペース</strong></span>キーを
            押してください。<span class="keycap"><strong>W</strong></span> を押して変更を
            ディスクに書き込んでください。どのブートローダを
            インストールするか尋ねられます。ここで選択すれば戻せます。
          </p></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="hardware.html">戻る</a>〓</td><td width="20%" align="center">〓</td><td width="40%" align="right">〓<a accesskey="n" href="commercial.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第2章 ハードウェアコンパチビリティ〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓第4章 商用アプリケーション</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>