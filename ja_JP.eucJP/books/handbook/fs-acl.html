<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>15.11. ファイルシステムアクセス制御リスト</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD ハンドブック" /><link rel="up" href="security.html" title="第15章 セキュリティ" /><link rel="prev" href="openssh.html" title="15.10. OpenSSH" /><link rel="next" href="disks.html" title="第16章 ストレージ" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.11. ファイルシステムアクセス制御リスト</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="openssh.html">戻る</a>〓</td><th width="60%" align="center">第15章 セキュリティ</th><td width="20%" align="right">〓<a accesskey="n" href="disks.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="fs-acl"></a>15.11. ファイルシステムアクセス制御リスト</h2></div><div><span class="authorgroup">寄稿: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Rhodes</span> <span class="firstname">Tom</span> [FAMILY Given]</span>. </span></div></div></div><a id="idp90602320" class="indexterm"></a><p>スナップショットのようなファイルシステムの拡張と連携して、
      FreeBSD 5.0 以降ではファイルシステムアクセス制御リスト
      (<acronym class="acronym">ACLs</acronym>) によるセキュリティを提供しています。</p><p>アクセス制御リストは、標準的な UNIX のパーミッションモデルを、
      非常に互換性の高い (POSIX.1e) やり方で拡張しています。
      この機能は、管理者がより洗練されたセキュリティモデルを利用し、
      その恩恵を受けられるようにします。</p><p><acronym class="acronym">UFS</acronym> ファイルシステム用の
      <acronym class="acronym">ACL</acronym> サポートを有効にするには、
      次のオプションをカーネルに組み込まなければなりません。</p><pre class="programlisting">options UFS_ACL</pre><p>もしこのオプションが組み込まれていなければ、<acronym class="acronym">ACLs</acronym>
      に対応したファイルシステムをマウントしようとすると、
      警告が表示されます。このオプションは <code class="filename">GENERIC</code>
      カーネルに含まれています。<acronym class="acronym">ACLs</acronym>
      は、ファイルシステムの拡張属性が有効になっていることに依存しています。
      拡張属性は、次世代 UNIX ファイルシステムである <acronym class="acronym">UFS2</acronym>
      でネイティブ対応されています。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><acronym class="acronym">UFS1</acronym> に拡張属性を付すように設定するのは、
      <acronym class="acronym">UFS2</acronym> よりも高いレベルの管理オーバヘッドが必要になります。
      また、<acronym class="acronym">UFS2</acronym>
      における拡張属性のパフォーマンスも大きく上がっています。
      その結果、アクセス制御リストを利用する上では、一般的には
      <acronym class="acronym">UFS1</acronym> よりも <acronym class="acronym">UFS2</acronym>
      の方がおすすめです。</p></div><p><acronym class="acronym">ACLs</acronym> は、マウント時の管理フラグ <code class="option">acls</code>
      で有効にされます。これは <code class="filename">/etc/fstab</code> に記述できます。
      マウント時のフラグは、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tunefs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">tunefs</span>(8)</span></a>
      を使って、ファイルシステムヘッダのスーパブロックにある
      <acronym class="acronym">ACLs</acronym> フラグを変更するという方法で、
      常に自動で設定されるようになります。一般的には、
      下記の理由からスーパブロックフラグを使う方がよいでしょう。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>マウント時に指定した <acronym class="acronym">ACLs</acronym> フラグは再マウント
	  (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> <code class="option">-u</code>) 時に変更できません。完全に
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=umount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">umount</span>(8)</span></a> した上で、新たに <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a>
	  するしかありません。これは、起動後にルートファイルシステムで
	  <acronym class="acronym">ACLs</acronym> を有効にできないことを意味します。
	  また、ファイルシステムを利用し始めた後では、
	  その配列を変えられないことも意味しています。</p></li><li class="listitem"><p>スーパブロックフラグを設定すると、<code class="filename">fstab</code>
	  に記述されていなかったり、デバイスの順番が変わってしまっても、常に
	  <acronym class="acronym">ACLs</acronym> が有効な状態でマウントされます。
	  こうすることで、ファイルシステムを <acronym class="acronym">ACLs</acronym>
	  を有効にしないままマウントしてしまい、<acronym class="acronym">ACLs</acronym>
	  が正しくないかたちで強制され、
	  セキュリティ問題につながることを防ぎます。</p></li></ul></div><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><acronym class="acronym">ACLs</acronym> の動作を変更して、まったく新たに
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> を行わなくてもフラグを有効にできるようにすることも可能でしょう。
      しかし、我々は、うっかり <acronym class="acronym">ACLs</acronym>
      を有効にしないでマウントしてしまうのを防ぐようにした方が望ましいと考えました。
      <acronym class="acronym">ACLs</acronym> を有効にし、その後無効にしてから、
      拡張属性を取り消さないでまた有効にしてしまうと、
      鬱陶しい状態に自分で入り込んでしまえるからです。
      一般的には、一度ファイルシステムで <acronym class="acronym">ACLs</acronym>
      を有効にしたら、無効にすべきではありません。そうしてしまうと、
      ファイル保護がシステムのユーザの意図と齟齬をきたす可能性があるばかりか、
      <acronym class="acronym">ACLs</acronym> を再度有効にすると、
      それまでパーミッションが変更されてきたファイルに古い
      <acronym class="acronym">ACLs</acronym> を割り当ててしまい、
      予想しない動作につながることも考えられます。</p></div><p><acronym class="acronym">ACLs</acronym> を有効にしたファイルシステムは、
      パーミッション設定の表示に <code class="literal">+</code> (プラス)
      記号がつきます。例えば、次のようになります。</p><pre class="programlisting">drwx------  2 robert  robert  512 Dec 27 11:54 private
drwxrwx---+ 2 robert  robert  512 Dec 23 10:57 directory1
drwxrwx---+ 2 robert  robert  512 Dec 22 10:20 directory2
drwxrwx---+ 2 robert  robert  512 Dec 27 11:57 directory3
drwxr-xr-x  2 robert  robert  512 Nov 10 11:54 public_html</pre><p>ここでは、ディレクトリ <code class="filename">directory1</code>,
      <code class="filename">directory2</code> および <code class="filename">directory3</code>
      のすべてで <acronym class="acronym">ACLs</acronym> が働いています。
      ディレクトリ <code class="filename">public_html</code> は対象外です。</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="openssh.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="security.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="disks.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">15.10. OpenSSH〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓第16章 ストレージ</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>