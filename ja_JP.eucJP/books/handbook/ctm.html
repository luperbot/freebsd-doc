<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>A.3. CTM を使う</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD ハンドブック" /><link rel="up" href="mirrors.html" title="付録A FreeBSD の入手方法" /><link rel="prev" href="mirrors-ftp.html" title="A.2. FTP サイト" /><link rel="next" href="svn.html" title="A.4. Subversion を使う" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">A.3. CTM を使う</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mirrors-ftp.html">戻る</a>〓</td><th width="60%" align="center">付録A FreeBSD の入手方法</th><td width="20%" align="right">〓<a accesskey="n" href="svn.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="ctm"></a>A.3. CTM を使う</h2></div></div></div><a id="idp98096464" class="indexterm"></a><p><span class="emphasis"><em>訳: 花井 浩之 <code class="email">&lt;<a xmlns="" class="email" href="mailto:hanai@FreeBSD.org">hanai@FreeBSD.org</a>&gt;</code>、1997 年 9 月 13 日</em></span></p><p><span class="application">CTM</span> は、
      リモートのディレクトリツリーを中央のツリーに同期させるための手段です。
      FreeBSD システムに組み込まれており、FreeBSD
      のソースリポジトリとの同期に使うことができます。
      リポジトリ全体の同期や特定のブランチセットの同期に用いることができます。</p><p><span class="application">CTM</span> は、
      特にお粗末な TCP/IP 接続しか持っていなかったり、
      TCP/IP 接続が行なえない環境での利用を想定して設計されています。
      変更点を自動的にメールで送られてくるように設定することができます。
      アクティブなブランチでは 1
      日に最大三つまでのデルタを受け取る必要があります。
      デルタのサイズは常にできるだけ小さく保たれています。
      大抵の場合 5KB よりも小さく、
      たまに (10 回に 1 回程度) 10-50KB になり、
      ときおり 100KB 以上のサイズになります。</p><p><span class="application">CTM</span> を使って FreeBSD
      の開発を追いかける時には、
      あらかじめパッケージ化されたリリースとは異なり、
      開発ソースの作業ディレクトリに関連した注意点に気をつけてください。
      これに関しては、
      <a class="link" href="current-stable.html" title="18.4. 開発ブランチを追いかける">開発ブランチを追いかける</a>
      の章を参照してください。</p><p>デルタを作り出す過程や <span class="application">CTM</span>
      を他の目的に使うためのドキュメントは現在ほとんどありません。
      <span class="application">CTM</span> に関連した質問については、
      <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-users" target="_top">ctm-users</a> メーリングリストに相談してください。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mirrors-ctm"></a>A.3.1. デルタを入手する</h3></div></div></div><p><span class="application">CTM</span> が用いる <span class="quote">「<span class="quote">デルタ</span>」</span>
	は、anonymous <acronym class="acronym">FTP</acronym>
	もしくはメールで入手できます。</p><p><acronym class="acronym">FTP</acronym>
	のデルタは以下のミラーサイトから入手できます。
	もし anonymous <acronym class="acronym">FTP</acronym> を使って
	<span class="application">CTM</span> のデルタを手にいれる場合は、
	地理的に近くにあるミラーサイトを利用するようにしてください。
	何か問題がある場合は、<a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-users" target="_top">ctm-users</a>
	メーリングリストに相談してください。</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">カリフォルニア、サンフランシスコ近辺、公式なソース</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/" target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/</a></code></p></li></ul></div></dd><dt><span class="term">南アフリカ、古い差分ファイルのバックアップサーバ</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/" target="_top">ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/</a></code></p></li></ul></div></dd><dt><span class="term">台湾/中華民国</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li></ul></div></dd></dl></div><p>メールでデルタを得たいという場合は、<code class="uri"><a class="uri" href="http://lists.freebsd.org/mailman/listinfo" target="_top">http://lists.freebsd.org/mailman/listinfo</a></code>
	から、<code class="literal">ctm-src</code>
	配布メーリングリストのいずれかに参加してください。
	たとえば <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-src-cur" target="_top">ctm-src-cur</a>
	は head 開発ブランチに対応しています。<a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-src-9" target="_top">ctm-src-9</a>
	は 9.X リリースのブランチに対応したものです</p><p>メールで <span class="application">CTM</span>
	の更新ファイルを受け取り始めたら、
	中身を取り出して使用するために
	<code class="command">ctm_rmail</code> を使ってください。
	このプロセスを自動で行ないたいのであれば、
	このコマンドを <code class="filename">/etc/aliases</code>
	から直接実行することもできます。
	さらに詳しいことは <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ctm_rmail&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ctm_rmail</span>(1)</span></a> をご覧ください。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">どの方法を使ってデルタを入手していたとしても、
	  <span class="application">CTM</span> のユーザは
	  <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-announce" target="_top">ctm-announce</a>
	  メーリングリストを購読するようにしてください。
	  このメーリングリストは、
	  <span class="application">CTM</span>
	  に関するアナウンスが投稿される唯一の場所です。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98133072"></a>A.3.2. <span class="application">CTM</span> の使い方</h3></div></div></div><p>初めて <span class="application">CTM</span>
	デルタを使う前に、出発点を作成しておく必要があります。</p><p>その方法の一つは、空のディレクトリに対して、
	<span class="quote">「<span class="quote">スタータ</span>」</span> デルタを使う方法です。
	スタータデルタは
	<code class="filename">src-cur.3210XEmpty.gz</code>
	のように、<code class="literal">XEmpty</code>
	というファイル名になります。
	<code class="literal">X</code>
	の後ろは最初の開始ポイントに対応し、
	<code class="filename">Empty</code> は空のディレクトリを表します。
	ルールとして <code class="literal">Empty</code> からの移行デルタは
	100 デルタごとに作られます。
	スタータデルタである
	<code class="filename">XEmpty</code> のデルタは、70 から 80MB の
	<code class="command">gzip</code>
	で圧縮された大きなデータということに注意してください。</p><p>もう一つの方法は、RELEASE
	のメディアからソースをコピーしたり展開する方法です。
	この方法では、
	インターネット上で大きなデータの転送を行う必要がありません。</p><p>一度ベースとなるデルタを作成したら、
	それに続く大きな数字を持つ多数のすべてのデルタを適用してください。
	デルタを適用するためには、以下のように実行してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /directory/to/store/the/stuff</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ctm -v -v /directory/which/stores/the/deltas/src-xxx.*</code></strong></pre><p>一度に適用されるデルタは一つで、
	一度適用されたデルタは無視されるので、
	複数のデルタを一つのコマンドで適用することができます。
	<span class="application">CTM</span>
	は <code class="command">gzip</code> で圧縮されているデルタを理解するので、
	ディスクの節約にもなります。</p><p>デルタを適用せずに確認だけを行うには、
	コマンドラインに <code class="option">-c</code> フラグを加えてください。
	<span class="application">CTM</span>
	はローカルのツリーに対して実際には何も行ないません。
	デルタの完全性を確認し、
	現在のツリーに問題なく使用できるかを確認します。
	オプションに関するより多くの情報や、
	デルタを適用する時に <span class="application">CTM</span>
	が用いるプロセスの全体については、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ctm&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ctm</span>(1)</span></a> をご覧ください。</p><p>ローカルのソースツリーを最新に保つには、
	新しいデルタが入手可能になるたびに、
	<span class="application">CTM</span> に適用してください。</p><p>デルタを適用後、
	もしデルタを再ダウンロードするのが骨の折れる作業であれば、
	デルタを消さないでおいてください。
	このようにすると、将来のディザスタリカバリで必要になった場合に、
	ローカルにあるコピーを利用できます。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98150096"></a>A.3.3. ローカルの変更を保存する</h3></div></div></div><p>開発者はソースツリー中のファイルを使って、
	実験したり変更したくなるものです。
	<span class="application">CTM</span>
	はローカルの変更を制限つきでサポートします。
	ファイルの存在をチェックする前に、同じ名前で
	<code class="filename">.ctm</code>
	という拡張子のついたファイルを参照しにいきます。
	このファイルが存在する場合、<span class="application">CTM</span>
        はオリジナルファイルの代りにこのファイルを処理します。</p><p>この動作はローカルの変更を保持する簡単な手段を提供します。
	ファイルを変更する前に、<code class="filename">.ctm</code>
	という拡張子のファイル名にコピーしてください。
	あとは自由にオリジナルの名前を持つファイルを変更してください。
	<span class="application">CTM</span> は、<code class="filename">.ctm</code>
	の拡張子を持つファイルにのみに適用されます。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98154192"></a>A.3.4. <span class="application">CTM</span>
	のその他のオプション</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">更新で変更されるファイルを正確に知る</span></dt><dd><p><span class="application">CTM</span>
	      がローカルのソースリポジトリに対して、
	      どのような変更を行うかを知るには、
	      <code class="option">-l</code>
	      オプションを使ってください。
	      このオプションは、変更のログを作成したり、
	      変更されたファイルに対して、
	      なんらかの方法で 前・後処理したい場合には、
	      役に立つでしょう。</p></dd><dt><span class="term">更新前にバックアップを取る</span></dt><dd><p><span class="application">CTM</span>
	      の更新によって変更されるファイルすべてのバックアップをとるには、
	      <code class="option">-B
		<em class="replaceable"><code>backup-file</code></em></code>
	      オプションを指定してください。
	      このオプションを使うと、
	      <span class="application">CTM</span> は、
	      デルタで変更されるファイルすべてを
	      <code class="filename">backup-file</code>
	      としてバックアップするようになります。</p></dd><dt><span class="term">更新で変更されるファイルを制限する</span></dt><dd><p><span class="application">CTM</span>
	      の更新の範囲を制限したり一連のデルタのから
	      ほんの数ファイルを抽出するには、
	      使用するファイルを指定する
	      <code class="option">-e</code> と
	      どのファイルを無視するかを指定する
	      <code class="option">-x</code>
	      オプションを使って、正規表現で指定できます。</p><p>例えば、<code class="filename">lib/libc/Makefile</code>
	      の最新のコピーを保存してある <span class="application">CTM</span>
	      デルタのコレクションから抽出するには、
	      以下のコマンドを実行してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /directory/to/extract/to/</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ctm -e '^lib/libc/Makefile' /directory/which/stores/the/deltas/src-xxx.*</code></strong></pre><p><span class="application">CTM</span>
	      デルタで指定されたファイルごとに、<code class="option">-e</code>
	      そして <code class="option">-x</code>
	      オプションがコマンドラインで指定された順序で適用されます。
	      すべての<code class="option">-e</code> そして <code class="option">-x</code>
	      オプションが適用された後に更新対象と選択された場合に限り、
	      <span class="application">CTM</span>
	      はそのファイルを処理します。</p></dd></dl></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mirrors-ftp.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="mirrors.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="svn.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">A.2. <acronym class="acronym">FTP</acronym> サイト〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓A.4. <span class="application">Subversion</span> を使う</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>