<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>16.3. ディスクの追加</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD ハンドブック" /><link rel="up" href="disks.html" title="第16章 ストレージ" /><link rel="prev" href="disks-naming.html" title="16.2. デバイス名" /><link rel="next" href="raid.html" title="16.4. RAID" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">16.3. ディスクの追加</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="disks-naming.html">戻る</a>〓</td><th width="60%" align="center">第16章 ストレージ</th><td width="20%" align="right">〓<a accesskey="n" href="raid.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="disks-adding"></a>16.3. ディスクの追加</h2></div><div><span class="authorgroup">原作: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">O'Brien</span> <span class="firstname">David</span> [FAMILY Given]</span>. </span></div></div></div><a id="idp90705488" class="indexterm"></a><p>現在一つしかドライブがない計算機に新しく SCSI
      ディスクを追加したいとしましょう。まずコンピュータの電源を切り、
      コンピュータやコントローラ、
      ドライブの製造元の説明書に従ってドライブを取り付けます。
      このあたりの手順は非常に多岐にわたるため、
      詳細はこの文書の範囲外です。</p><p><code class="systemitem">root</code> ユーザでログインします。
      ドライブの取り付け後は <code class="filename">/var/run/dmesg.boot</code>
      を調べて新しいディスクが見つかっていることを確認しておきます。
      この例では、新しく付けたドライブは <code class="filename">da1</code> で、
      我々はそれを <code class="filename">/1</code> にマウントしたいとしましょう
      (もし IDE ドライブを付けようとしているのなら、デバイス名は
      4.0 以前のシステムでは <code class="filename">wd1</code>, ほとんどの 4.x
      システムでは <code class="filename">ad1</code> になるでしょう)。</p><a id="idp90709712" class="indexterm"></a><a id="idp90710224" class="indexterm"></a><a id="idp90714960" class="indexterm"></a><p>FreeBSD は IBM-PC 互換のコンピュータで動くため、
      PC BIOS のパーティションを考慮に入れる必要があります。
      これは従来の BSD パーティションとは異なります。PC ディスクは 4 つまでの
      BIOS パーティションエントリを持つことができます。
      もしそのディスクを本当に FreeBSD 専用にしたい場合には
      <span class="emphasis"><em>専用</em></span> モードで用いることもできます。
      そうでない場合には、FreeBSD は PC BIOS
      パーティションのどれか一つの中に入れることになります。
      FreeBSD では、従来の BSD パーティションと混乱しないように
      PC BIOS パーティションのことを<span class="emphasis"><em>スライス</em></span>と呼びます。
      また、別の OS がインストールされていたコンピュータで使われていたが
      FreeBSD 専用にするディスク上でもスライスを用いることができます。
      これは、他の OS の <code class="command">fdisk</code>
      ユーティリティを混乱させないためです。</p><p>スライスの場合、ドライブは <code class="filename">/dev/da1s1e</code>
      として加えられるでしょう。これは、SCSI ディスクでユニット番号は 1
      (二つめの SCSI ディスク), スライスは 1 (PC BIOS のパーティションが 1) で
      BSD パーティション <code class="filename">e</code>, と読みます。
      専用ディスクの場合だと単純に <code class="filename">/dev/da1e</code>
      として加えられるでしょう。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90718672"></a>16.3.1. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysinstall&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysinstall</span>(8)</span></a> の利用</h3></div></div></div><a id="idp90719952" class="indexterm"></a><a id="idp90721232" class="indexterm"></a><div class="procedure"><ol class="procedure" type="1"><li class="step"><p class="title"><strong><span class="application">sysinstall</span> の操作</strong></p><p><code class="command">sysinstall</code> の使い易いメニューを利用して、
	    新しいディスクのパーティション分けやラベル付けを行なうことができます。
	    <code class="systemitem">root</code> ユーザでログインするか
	    <code class="command">su</code> コマンドを用いるかして root 権限を取得します。
	    <code class="command">/stand/sysinstall</code> を実行して <code class="literal">Configure</code>
	    メニューに入ります。<code class="literal">FreeBSD Configuration Menu</code>
	    の中でスクロールダウンして <code class="literal">Fdisk</code>
	    の項目を選びます。</p></li><li class="step"><p class="title"><strong><span class="application">fdisk</span> パーティションエディタ</strong></p><p><span class="application">fdisk</span> では、ディスク全体を
	    FreeBSD で使うために <strong class="userinput"><code>A</code></strong> を入力します。
	    <span class="quote">「<span class="quote">remain cooperative with any future possible operating systems</span>」</span>
	    と聞かれたら <code class="literal">YES</code> と答えます。
	    <strong class="userinput"><code>W</code></strong> で変更をディスクに書き込みます。ここで
	    <strong class="userinput"><code>q</code></strong> と入力して FDISK エディタを抜けます。
	    次にマスタブートレコードについて聞かれます。
	    ここでは既に動いているシステムにディスクを追加しようとしているので
	    <code class="literal">None</code> を選びます。</p></li><li class="step"><p class="title"><strong>ディスクラベルエディタ</strong></p><a id="idp90767696" class="indexterm"></a><p>次に <span class="application">sysinstall</span> を終了し、
	    もう一度起動する必要があります。同じ手順を踏んで今度は
	    <code class="literal">Label</code> オプションを選択し、
	    <code class="literal">Disk Label Editor</code> に入ります。
	    ここでは従来の BSD パーティションを作成します。
	    一つのディスクは <code class="literal">a</code> から <code class="literal">h</code> までのラベルがついた最大
	    8 つのパーティションを持つことができます。
	    いくつかのパーティションラベルは特別な用途に用いられます。
	    <code class="literal">a</code> パーティションはルートパーティション
	    (<code class="filename">/</code>) です。したがって、システムディスク
	    (つまり起動ディスク) のみに <code class="literal">a</code>
	    パーティションがあるべきです。<code class="literal">b</code>
	    パーティションはスワップパーティションに用いられ、
	    複数のディスクにスワップパーティションを作ることができます。
	    <code class="literal">c</code> は専用モードにおけるディスク全体、
	    もしくはスライスモードにおけるスライス全体を指します。
	    他のパーティションは汎用的に用いられます。</p><p><span class="application">sysinstall</span> のラベルエディタ
	    は、ルートパーティションでもスワップパーティションでもないパーティションには、<code class="literal">e</code>
	    パーティションを採用しようとします。ラベルエディタでファイルシステムを作成するには
	    <strong class="userinput"><code>C</code></strong> を入力してください。
	    FS (ファイルシステム) かスワップかを聞かれたら
	    <code class="literal">FS</code> を選びマウントポイント
	    (たとえば <code class="filename">/mnt</code>) を入力します。
	    インストール後のモードでディスクを追加する場合、
	    <span class="application">sysinstall</span> は
	    <code class="filename">/etc/fstab</code> にエントリを追加しないため、
	    ここで指定するマウントポイントはそれほど重要ではありません。</p><p>さて、ディスクに新しいラベルを書き込み、
	    そこにファイルシステムを作る準備が整いました。早速
	    <code class="command">W</code> を叩いて実行しましょう。
	    <span class="application">sysinstall</span> からの、
	    新しいパーティションをマウントできない、
	    というエラーは無視してください。Label Editor から抜け、
	    <span class="application">sysinstall</span> を終了します。</p></li><li class="step"><p class="title"><strong>終了</strong></p><p>最後に <code class="filename">/etc/fstab</code> を編集し、
	    新しいディスクのエントリを追加します。</p></li></ol></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90779216"></a>16.3.2. コマンドラインユーティリティの利用</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90779856"></a>16.3.2.1. スライスの利用</h4></div></div></div><p>このセットアップ方法では、
	  すでにコンピュータに他のオペレーティングシステムがインストールされていても
	  正しく協調動作することが可能で、他のオペレーティングシステムの
	  <code class="command">fdisk</code> ユーティリティを混乱させることもありません。
	  新しいディスクにインストールする場合は、
	  この方法を用いることが推奨されています。
	  後述する <code class="literal">専用モード</code> は、
	  そうしなければならない理由がある時にのみ、
	  利用するようにしてください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/dev/zero of=/dev/da1 bs=1k count=1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>fdisk -BI da1</code></strong> # 新しいディスクの初期化
<code class="prompt">#</code> <strong class="userinput"><code>disklabel -B -w -r da1s1 auto</code></strong> # ディスクにラベルを付ける
<code class="prompt">#</code> <strong class="userinput"><code>disklabel -e da1s1</code></strong> # 作成したディスクラベルを編集し、パーティションを追加する
<code class="prompt">#</code> <strong class="userinput"><code>mkdir -p /1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>newfs /dev/da1s1e</code></strong> # 作成したすべてのパーティションに対してこれを繰り返す
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/da1s1e /1</code></strong> # パーティションをマウントする
<code class="prompt">#</code> <strong class="userinput"><code>vi /etc/fstab</code></strong> # <code class="filename">/etc/fstab</code> に適切なエントリを追加する</pre><p>IDE ディスクを使う場合は <code class="filename">da</code> の部分を
	  <code class="filename">ad</code> とします。4.X より前のシステムでは、
	  (訳注: <code class="filename">ad</code> ではなく)
	  <code class="filename">wd</code> としてください。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90806992"></a>16.3.2.2. 専用モード</h4></div></div></div><a id="idp90807632" class="indexterm"></a><p>新しいドライブを他の OS と共有しない場合には
	  <code class="literal">専用</code> モードを用いることもできます。
	  このモードはマイクロソフトの OS
	  を混乱させることを憶えておいてください
	  (しかし、それらによって壊されることはありません)。 一方、IBM の <span class="trademark">OS/2</span>®
	  はどんなパーティションでも見つけたら理解できなくても
	  <span class="quote">「<span class="quote">専有</span>」</span> します。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/dev/zero of=/dev/da1 bs=1k count=1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>disklabel -Brw da1 auto</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>disklabel -e da1</code></strong> # `e' パーティションの作成
<code class="prompt">#</code> <strong class="userinput"><code>newfs -d0 /dev/da1e</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir -p /1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>vi /etc/fstab</code></strong> # /dev/da1e エントリの追加
<code class="prompt">#</code> <strong class="userinput"><code>mount /1</code></strong></pre><p>もう一つの方法は次の通り。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/dev/zero of=/dev/da1 count=2</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>disklabel /dev/da1 | disklabel -BrR da1 /dev/stdin</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>newfs /dev/da1e</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir -p /1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>vi /etc/fstab</code></strong> # /dev/da1e エントリの追加
<code class="prompt">#</code> <strong class="userinput"><code>mount /1</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">FreeBSD 5.1-RELEASE から、従来の <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=disklabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">disklabel</span>(8)</span></a>
	    プログラムは <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">bsdlabel</span>(8)</span></a>
	    ユーティリティに置き換えられました。<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">bsdlabel</span>(8)</span></a> では、
	    使用されていない数多くのオプションやパラメタが削除されました。
	    たとえば <code class="option">-r</code> オプションは <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">bsdlabel</span>(8)</span></a>
	    では取り除かれました。詳細については <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">bsdlabel</span>(8)</span></a>
	    のマニュアルページを参照してください。</p></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="disks-naming.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="disks.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="raid.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">16.2. デバイス名〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓16.4. RAID</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>