<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>8.7. 画像スキャナ</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD ハンドブック" /><link rel="up" href="multimedia.html" title="第8章 マルチメディア" /><link rel="prev" href="mythtv.html" title="8.6. MythTV" /><link rel="next" href="kernelconfig.html" title="第9章 FreeBSD カーネルのコンフィグレーション" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">8.7. 画像スキャナ</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mythtv.html">戻る</a>〓</td><th width="60%" align="center">第8章 マルチメディア</th><td width="20%" align="right">〓<a accesskey="n" href="kernelconfig.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="scanners"></a>8.7. 画像スキャナ</h2></div><div><span class="authorgroup">寄稿: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Fonvieille</span> <span class="firstname">Marc</span> [FAMILY Given]</span>. </span></div></div></div><a id="idp85455056" class="indexterm"></a><p>FreeBSD では、画像スキャナに対するアクセスは
      <span class="application">SANE</span> (Scanner Access Now Easy)
      によって実現されており、
      FreeBSD の Ports Collection で提供されています。
      <span class="application">SANE</span>
      はスキャナのハードウェアにアクセスするために
      FreeBSD デバイスドライバを使用します。</p><p>FreeBSD は
      <acronym class="acronym">SCSI</acronym> 接続および <acronym class="acronym">USB</acronym>
      接続のスキャナのどちらにも対応しています。
      スキャナのインタフェースに依存して、異なるドライバが必要となります。
      設定を始める前に、
      <span class="application">SANE</span>
      がスキャナに対応していることを確認してください。
      対応しているスキャナに関してのより詳細な情報については、<a class="link" href="http://www.sane-project.org/sane-supported-devices.html" target="_top">
      http://www.sane-project.org/sane-supported-devices.html</a>
      をご覧ください。</p><p>この節では、FreeBSD
      がどのようにしてスキャナを認識するかについて説明します。
      その後、FreeBSD システム上で <span class="application">SANE</span>
      を設定して使用する方法の概要について説明します。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="scanners-kernel-usb"></a>8.7.1. スキャナの確認</h3></div></div></div><p><code class="filename">GENERIC</code> カーネルには <acronym class="acronym">USB</acronym>
	スキャナに対応するためのデバイスドライバが搭載されています。
	カスタムカーネルを使用する際には、
	以下の行がカーネルコンフィグレーションファイルにあることを確認してください。</p><pre class="programlisting">device usb
device uhci
device ohci
device ehci</pre><p><acronym class="acronym">USB</acronym> スキャナが認識されたかを確認するには、
	スキャナを接続して、<code class="command">dmesg</code> を利用し、
	システムメッセージバッファで、
	スキャナが認識されているかどうかを確認してください。
	認識されていたら、以下のようなメッセージが表示されます。</p><pre class="screen">ugen0.2: &lt;EPSON&gt; at usbus0</pre><p>この例では、<span class="trademark">EPSON
  Perfection</span>® 1650
	<acronym class="acronym">USB</acronym> スキャナが
	<code class="filename">/dev/ugen0.2</code>
	上で認識されています。</p><p>スキャナのインタフェースが <acronym class="acronym">SCSI</acronym> であれば、
	どの <acronym class="acronym">SCSI</acronym>
	コントローラボードを使用するかを知ることが重要です。
	使用する <acronym class="acronym">SCSI</acronym> チップセットによって、
	カスタムカーネルコンフィグレーションファイルを調整する必要があります。
	<code class="filename">GENERIC</code> カーネルは、
	一般に使用される <acronym class="acronym">SCSI</acronym>
	コントローラのほとんどに対応しています。
	<code class="filename">/usr/src/sys/conf/NOTES</code> ファイルを読んで、
	適切な行をカーネルコンフィグレーションファイルに追加してください。
	また、<acronym class="acronym">SCSI</acronym> アダプタドライバに加えて、
	以下の行をカスタムカーネルコンフィグレーションファイルに記述する必要があります。</p><pre class="programlisting">device scbus
device pass</pre><p>デバイスがメッセージバッファに出力されていることを確認してください。</p><pre class="screen">pass2 at aic0 bus 0 target 2 lun 0
pass2: &lt;AGFA SNAPSCAN 600 1.10&gt; Fixed Scanner SCSI-2 device
pass2: 3.300MB/s transfers</pre><p>システムを起動する際にスキャナの電源を入れてなければ、
	<code class="command">camcontrol</code> を使用して
	<acronym class="acronym">SCSI</acronym> バスをスキャンし、
	以下のように手動でデバイスを検出させることもできます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>camcontrol rescan all</code></strong>
Re-scan of bus 0 was successful
Re-scan of bus 1 was successful
Re-scan of bus 2 was successful
Re-scan of bus 3 was successful</pre><p>すると、スキャナは <acronym class="acronym">SCSI</acronym>
	デバイスの一覧に現れるでしょう。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>camcontrol devlist</code></strong>
&lt;IBM DDRS-34560 S97B&gt;              at scbus0 target 5 lun 0 (pass0,da0)
&lt;IBM DDRS-34560 S97B&gt;              at scbus0 target 6 lun 0 (pass1,da1)
&lt;AGFA SNAPSCAN 600 1.10&gt;           at scbus1 target 2 lun 0 (pass3)
&lt;PHILIPS CDD3610 CD-R/RW 1.00&gt;     at scbus2 target 0 lun 0 (pass2,cd0)</pre><p>FreeBSD における <acronym class="acronym">SCSI</acronym> デバイスについての詳細は、
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=scsi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">scsi</span>(4)</span></a> および <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=camcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">camcontrol</span>(8)</span></a> をご覧ください。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp79667920"></a>8.7.2. <span class="application">SANE</span> の設定</h3></div></div></div><p><span class="application">SANE</span> システムは、
	二つの部分、すなわちバックエンド
	(<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sane-backends/pkg-descr">graphics/sane-backends</a>)
	とフロントエンド
	(<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sane-frontends/pkg-descr">graphics/sane-frontends</a>
	もしくは、<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/xsane/pkg-descr">graphics/xsane</a>)
	に分割されています。
	バックエンドはスキャナに対するアクセスを提供します。
	どのバックエンドが画像スキャナに対応しているかについては、<a class="link" href="http://www.sane-project.org/sane-supported-devices.html" target="_top">http://www.sane-project.org/sane-supported-devices.html</a>
	を参照してください。
	フロントエンドはグラフィカルなスキャニングインタフェースを提供します。
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sane-frontends/pkg-descr">graphics/sane-frontends</a> は、
	<span class="application">xscanimage</span> をインストールし、一方、
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/xsane/pkg-descr">graphics/xsane</a> は、
	<span class="application">xsane</span> をインストールします。</p><p><a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sane-backends/pkg-descr">graphics/sane-backends</a>
	port または package をインストールしたら、
	<code class="command">sane-find-scanner</code> コマンドを使用して、
	<span class="application">SANE</span>
	システムで検出されているスキャナを確認してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sane-find-scanner -q</code></strong>
found SCSI scanner "AGFA SNAPSCAN 600 1.10" at /dev/pass3</pre><p>この出力から、
	スキャナインタフェースの種類と
	システムに接続されているスキャナが使用するデバイスノードがわかります。
	ベンダ名や製品のモデル名は表示されないかも知れません。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">いくつかの <acronym class="acronym">USB</acronym>
	  スキャナではファームウェアを読み込む必要がある場合があります。
	  詳細については、sane-find-scanner(1) および
	  sane(7) を参照してください。</p></div><p>次に、スキャナがフロントエンドで認識されるか調べてください。
	<span class="application">SANE</span> のバックエンドには
	<code class="command">scanimage</code> が付属します。
	このコマンドを使用すると、
	デバイスの一覧を表示したり画像を取得することができます。
	スキャナデバイスの一覧を表示するには、
	<code class="option">-L</code> オプションを使ってください。
	以下の最初の例は、<acronym class="acronym">SCSI</acronym> スキャナ用のもので、
	次の例は、<acronym class="acronym">USB</acronym> スキャナ用のものです。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>scanimage -L</code></strong>
device `snapscan:/dev/pass3' is a AGFA SNAPSCAN 600 flatbed scanner
<code class="prompt">#</code> <strong class="userinput"><code>scanimage -L</code></strong>
device 'epson2:libusb:/dev/usb:/dev/ugen0.2' is a Epson GT-8200 flatbed scanner</pre><p>2 番目の出力の中で、
	<code class="literal">'epson2:libusb:/dev/usb:/dev/ugen0.2'</code>
	がスキャナが使用するバックエンド名
	(<code class="literal">epson2</code>) および
	<code class="literal">/dev/ugen0.2</code> は、デバイスノードです。</p><p><code class="command">scanimage</code> がスキャナの認識に失敗した場合には、
	以下のようなメッセージが表示されます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>scanimage -L</code></strong>

No scanners were identified. If you were expecting something different,
check that the scanner is plugged in, turned on and detected by the
sane-find-scanner tool (if appropriate). Please read the documentation
which came with this software (README, FAQ, manpages).</pre><p>このような場合には、<code class="filename">/usr/local/etc/sane.d/</code>
	にあるバックエンドの設定ファイルを編集して、
	使用するスキャナデバイスを設定してください。
	例えば、認識されなかったスキャナのモデルが、
	<span class="trademark">EPSON
  Perfection</span>® 1650 で、<code class="literal">epson2</code>
	バックエンドを使っているのであれば、
	<code class="filename">/usr/local/etc/sane.d/epson2.conf</code>
	を編集してください。
	編集作業を行う際には、
	使用するインタフェースとデバイスノードを指定する行を追加します。
	この例では、以下の行を追加します。</p><pre class="programlisting">usb /dev/ugen0.2</pre><p>編集を保存し、
	適切なバックエンド名とデバイスノードでスキャナが認識されたかどうかを確認してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>scanimage -L</code></strong>
device 'epson2:libusb:/dev/usb:/dev/ugen0.2' is a Epson GT-8200 flatbed scanner</pre><p><code class="command">scanimage -L</code>
	を実行してスキャナが認識されたことがわかれば、設定は終了です。
	スキャナを使用する準備ができました。</p><p><code class="command">scanimage</code>
	を使用してコマンドラインから画像を取得することができますが、
	GUI を使用して画像を取得できるとより望ましいでしょう。
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sane-frontends/pkg-descr">graphics/sane-frontends</a>
	package および port は、シンプルですが、
	効率的なグラフィカルインタフェース
	<span class="application">xscanimage</span>
	をインストールします。</p><p>一方、<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/xsane/pkg-descr">graphics/xsane</a>
	package または port からインストールされる
	<span class="application">xsane</span> は、
	広く使われているもう一つのグラフィカルなスキャニングフロントエンドです。
	<span class="application">Xsane</span> には、さまざまなスキャニングモード、
	色補正、バッチスキャンなど先進的な機能があります。
	これらのアプリケーションの両方とも <span class="application">GIMP</span>
	のプラグインとして使用することができます。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85496784"></a>8.7.3. スキャナの許可属性</h3></div></div></div><p>スキャナにアクセスするには、
	ユーザはスキャナが使用するデバイスノードへの読み込み権限と書き込み権限が必要です。
	今回の例では、<acronym class="acronym">USB</acronym> スキャナは
	<code class="filename">/dev/ugen0.2</code> デバイスノードを使用しています。
	このデバイスノードは、
	<code class="filename">/dev/usb/0.2.0</code> へのシンボリックリンクです
	シンボリックリンクとデバイスノードは、
	それぞれ <code class="systemitem">wheel</code> および
	<code class="systemitem">operator</code>
	グループが所有しています。
	ユーザをこれらのグループに加えると、
	スキャナを使用できるようになりますが、
	ユーザを <code class="systemitem">wheel</code>
	に追加することは、セキュリティの観点からお勧めできません。
	良い方法は、
	スキャナデバイスにアクセスできるグループを作成することです。</p><p>この例では、<code class="systemitem"><em class="replaceable"><code>usb</code></em></code>
	という名前のグループを作成します。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pw groupadd usb</code></strong></pre><p>その後、シンボリックリンク <code class="filename">/dev/ugen0.2</code>
	および、<code class="filename">/dev/usb/0.2.0</code> デバイスノードに対して、
	<code class="systemitem">usb</code>
	グループが利用できるように書き込みの許可属性
	<code class="literal">0660</code> または <code class="literal">0664</code>
	を設定してください。
	<code class="filename">/etc/devfs.rules</code>
	に次の行を追加すれば設定できます。</p><pre class="programlisting">[system=5]
add path ugen0.2 mode 0660 group usb
add path usb/0.2.0 mode 0666 group usb</pre><p>最後に、スキャナを利用するユーザを <code class="systemitem"><em class="replaceable"><code>usb</code></em></code>
	グループに追加してスキャナを利用できるようにしてください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pw groupmod usb -m <em class="replaceable"><code>joe</code></em></code></strong></pre><p>詳細については、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pw&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pw</span>(8)</span></a> をご覧ください。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mythtv.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="multimedia.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="kernelconfig.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">8.6. MythTV〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓第9章 FreeBSD カーネルのコンフィグレーション</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>