<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>21.3. sendmail の設定</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD ハンドブック" /><link rel="up" href="mail.html" title="第21章 電子メール" /><link rel="prev" href="mail-using.html" title="21.2. 電子メールを使う" /><link rel="next" href="mail-changingmta.html" title="21.4. MTA の変更" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">21.3. <span class="application">sendmail</span> の設定</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mail-using.html">戻る</a>〓</td><th width="60%" align="center">第21章 電子メール</th><td width="20%" align="right">〓<a accesskey="n" href="mail-changingmta.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="sendmail"></a>21.3. <span class="application">sendmail</span> の設定</h2></div><div><span class="authorgroup">寄稿: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Shumway</span> <span class="firstname">Christopher</span> [FAMILY Given]</span>. </span></div></div></div><a id="idp94942032" class="indexterm"></a><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sendmail</span>(8)</span></a> は FreeBSD のデフォルトの
      メールトランスファエージェント (MTA) です。
      <span class="application">sendmail</span>
      の仕事はメールユーザエージェント (MUA) からのメールを受け取り、
      それを設定ファイルで定義された適当なメーラに届けることです。
      <span class="application">sendmail</span> はネットワーク接続を受け入れて、
      ローカルのメールボックスにメールを届けたり
      別のプログラムにメールを渡したりもできます。</p><p><span class="application">sendmail</span> は次の設定ファイルを使用します。</p><a id="idp94945360" class="indexterm"></a><a id="idp94950480" class="indexterm"></a><a id="idp94951376" class="indexterm"></a><a id="idp94952272" class="indexterm"></a><a id="idp94953168" class="indexterm"></a><a id="idp94954064" class="indexterm"></a><a id="idp94954960" class="indexterm"></a><div class="informaltable"><table border="1"><colgroup><col /><col /></colgroup><thead><tr><th>ファイル名</th><th>機能</th></tr></thead><tbody><tr><td>
	      <code class="filename">/etc/mail/access</code>
	    </td><td><span class="application">sendmail</span> アクセスデータベースファイル</td></tr><tr><td>
	      <code class="filename">/etc/mail/aliases</code>
	    </td><td>メールボックスエイリアス</td></tr><tr><td>
	      <code class="filename">/etc/mail/local-host-names</code>
	    </td><td><span class="application">sendmail</span> が受け付ける配送先ホストのリスト</td></tr><tr><td>
	      <code class="filename">/etc/mail/mailer.conf</code>
	    </td><td>メーラプログラムの設定</td></tr><tr><td>
	      <code class="filename">/etc/mail/mailertable</code>
	    </td><td>メーラ配送表</td></tr><tr><td>
	      <code class="filename">/etc/mail/sendmail.cf</code>
	    </td><td><span class="application">sendmail</span> の主設定ファイル</td></tr><tr><td>
	      <code class="filename">/etc/mail/virtusertable</code>
	    </td><td>仮想ユーザおよび仮想ドメイン表</td></tr></tbody></table></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94974544"></a>21.3.1. <code class="filename">/etc/mail/access</code></h3></div></div></div><p>アクセスデータベースは、
	どのホストまたは IP アドレスがローカルメールサーバに接続できるか、
	そして接続の種類は何か、ということを定義します。
	ホストは <code class="option">OK</code>, <code class="option">REJECT</code>,
	<code class="option">RELAY</code> として指定できます。
	または、メーラエラーを指定することで、
	単に <span class="application">sendmail</span> の
	エラー処理ルーチンに渡されます。
	<code class="option">OK</code> として指定されたホスト (これはデフォルトです) は、
	メールの最終宛先がローカルマシンである限り、
	このホストへメールを送ることを認められます。
	<code class="option">REJECT</code> として指定されたホストは、
	すべてのメール接続を拒絶されます。
	ホスト名に対して <code class="option">RELAY</code>
	オプションを指定されたホストは、
	このメールサーバを通過して任意の宛先へメールを送ることを認められます。</p><div class="example"><a id="idp94978640"></a><div class="example-title">例21.1 <span class="application">sendmail</span>
	  アクセスデータベースの設定</div><div class="example-contents"><pre class="programlisting">cyberspammer.com                550 We don't accept mail from spammers
FREE.STEALTH.MAILER@            550 We don't accept mail from spammers
another.source.of.spam          REJECT
okay.cyberspammer.com           OK
128.32                          RELAY</pre></div></div><br class="example-break" /><p>この例では五つのエントリがあります。
	表の左側に当てはまるメール送信者は、表の右側の動作に支配されます。
	はじめの二つの例は、エラーコードを <span class="application">sendmail</span>
	のエラー処理ルーチンに渡します。
	メールが表の左側に当てはまると、リモートホストにそのメッセージが表示されます。
	次のエントリは <code class="systemitem">another.source.of.spam</code>
	というインターネット上の特定のホストからのメールを拒絶します。
	次のエントリは <code class="systemitem">okay.cyberspammer.com</code>
	からのメール接続を受け入れます。
	このエントリは上にある <code class="systemitem">cyberspammer.com</code> という行よりもさらに厳密です
	(厳密に一致すればするほど、そうでないものより優先されます)。
	最後のエントリは <code class="systemitem">128.32</code> から始まる
	IP アドレスのホストからの電子メールのリレーを認めます。
	これらのホストは他のメールサーバに到達できるこのメールサーバを使ってメールを送ることができるでしょう。</p><p>このファイルを変更したら、
	データベースを更新するために <code class="filename">/etc/mail/</code> ディレクトリで
	<code class="command">make</code> コマンドを実行する必要があります。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94983888"></a>21.3.2. <code class="filename">/etc/mail/aliases</code></h3></div></div></div><p>エイリアスデータベースには、
	他のユーザ、ファイル、プログラムまたは他のエイリアスに展開される
	仮想的なメールボックスの一覧が記載されています。
	<code class="filename">/etc/mail/aliases</code> において使用できる例をいくつかあげます。</p><div class="example"><a id="idp94985552"></a><div class="example-title">例21.2 メールエイリアス</div><div class="example-contents"><pre class="programlisting">root: localuser
ftp-bugs: joe,eric,paul
bit.bucket:  /dev/null
procmail: "|/usr/local/bin/procmail"</pre></div></div><br class="example-break" /><p>ファイル形式はシンプルです。
	コロンの左側にあるメールボックス名は、右側のターゲットに展開されます。
	はじめの例は単純に <code class="systemitem">root</code> のメールボックスを
	<code class="systemitem">localuser</code> のメールボックスに展開し、
	それからエイリアスデータベースをもう一度調べます。
	一致するエントリがなければメッセージはローカルユーザである
	<code class="systemitem">localuser</code> に配送されます。
	次の例はメールリストです。
	<code class="systemitem">ftp-bugs</code> のメールボックスへのメールは
	<code class="systemitem">joe</code>, <code class="systemitem">eric</code>
	および <code class="systemitem">paul</code> の三つのローカルメールボックスに展開されます。
	リモートメールボックスは <code class="literal">user@example.com</code>
	のように指定できることに注意してください。
	次の例はメールをファイル、この場合 <code class="filename">/dev/null</code>
	に書き込みます。
	最後の例はメールをプログラムに送ります。
	この場合メールのメッセージは <span class="trademark">UNIX</span>® パイプを通じて
	<code class="filename">/usr/local/bin/procmail</code> の標準入力に書き込まれます。</p><p>このファイルを変更したら、
	データベースを更新するために<code class="filename">/etc/mail/</code> ディレクトリで
	<code class="command">make</code> コマンドを実行する必要があります。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp95010128"></a>21.3.3. <code class="filename">/etc/mail/local-host-names</code></h3></div></div></div><p>これは <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sendmail</span>(8)</span></a>
	がローカルホスト名として認めるホスト名のリストです。
	<span class="application">sendmail</span>
	がメールを受け取るすべてのドメインやホストにこのファイルを置いてください。
	たとえば、このメールサーバは
	<code class="systemitem">example.com</code> というドメインおよび
	<code class="systemitem">mail.example.com</code>
	というホストへのメールを受け取るとすると、
	<code class="filename">local-host-names</code> ファイルの内容は次のようになるでしょう。</p><pre class="programlisting">example.com
mail.example.com</pre><p>このファイルを更新したら、変更を読み込むために
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sendmail</span>(8)</span></a> を再起動する必要があります。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp95036240"></a>21.3.4. <code class="filename">/etc/mail/sendmail.cf</code></h3></div></div></div><p><span class="application">sendmail</span> の主設定ファイルである
	<code class="filename">sendmail.cf</code> は、電子メールアドレスの書き換えから、
	リモートメールサーバへ拒絶メッセージを送ることまで
	<span class="application">sendmail</span> の全般的な動作をすべて制御します。
	当然、そのようなさまざまな役割によりこの設定ファイルは大変複雑で、
	その詳細についてはこの節の少し範囲外です。好運なことに、
	標準的な構成のメールサーバではこのファイルをめったに変更する必要はありません。</p><p><span class="application">sendmail</span> の主設定ファイルは
	<span class="application">sendmail</span> の機能と動作を決定する
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=m4&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">m4</span>(1)</span></a> マクロから構築できます。
	詳細については
	<code class="filename">/usr/src/contrib/sendmail/cf/README</code>
	を参照してください。</p><p>このファイルを更新したら、その変更を反映するために
	<span class="application">sendmail</span> を再起動する必要があります。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp95041744"></a>21.3.5. <code class="filename">/etc/mail/virtusertable</code></h3></div></div></div><p><code class="filename">virtusertable</code> は仮想ドメインおよび仮想メールボックスに対するアドレスを実際のメールボックスと対応づけます。
	これらのメールボックスにはローカル、リモート、
	<code class="filename">/etc/mail/aliases</code> に定義されたエイリアス、
	またはファイルを使用できます。</p><div class="example"><a id="idp95043536"></a><div class="example-title">例21.3 仮想ドメインメール対応表の例</div><div class="example-contents"><pre class="programlisting">root@example.com                root
postmaster@example.com          postmaster@noc.example.net
@example.com                    joe</pre></div></div><br class="example-break" /><p>上の例では <code class="systemitem">example.com</code>
	ドメインへの対応づけをしています。
	このファイルはファイルの下までファーストマッチ
	(訳注: 一致するルールが複数ある場合、
	一番最初に一致したルールが適用されること) で処理されます。
	はじめの行では <code class="literal">root@example.com</code> を
	ローカルの <code class="systemitem">root</code> メールボックスに対応づけています。
	次のエントリでは <code class="literal">postmaster@example.com</code> を
	<code class="systemitem">noc.example.net</code> ホスト上の
	<code class="systemitem">postmaster</code> メールボックスに対応づけています。
	最後に、今までのところでは
	<code class="systemitem">example.com</code>
	に関して何も一致しない場合、最後のエントリと一致するでしょう。
	これは <code class="systemitem">example.com</code>
	の誰かに送ったすべてのメールが一致します。これは
	<code class="systemitem">joe</code> のローカルメールボックスに対応づけられています。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail-using.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="mail.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="mail-changingmta.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">21.2. 電子メールを使う〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓21.4. MTA の変更</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>