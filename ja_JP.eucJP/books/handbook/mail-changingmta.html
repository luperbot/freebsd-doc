<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>21.4. MTA の変更</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD ハンドブック" /><link rel="up" href="mail.html" title="第21章 電子メール" /><link rel="prev" href="sendmail.html" title="21.3. sendmail の設定" /><link rel="next" href="mail-trouble.html" title="21.5. トラブルシュート" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">21.4. MTA の変更</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="sendmail.html">戻る</a>〓</td><th width="60%" align="center">第21章 電子メール</th><td width="20%" align="right">〓<a accesskey="n" href="mail-trouble.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mail-changingmta"></a>21.4. MTA の変更</h2></div><div><span class="authorgroup">原作: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Boothman</span> <span class="firstname">Andrew</span> [FAMILY Given]</span>. </span></div><div><span class="authorgroup">Information taken from e-mails written by <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Neil Shapiro</span> <span class="firstname">Gregory</span> [FAMILY Given]</span>. </span></div></div></div><a id="idp94996560" class="indexterm"></a><p>すでに述べたように、FreeBSD には MTA (Mail Transfer Agent) として、
      <span class="application">sendmail</span> がすでにインストールされています。
      したがって、デフォルトではこれがメールの送受信を担当しています。</p><p>しかしながら、さまざまな理由によって、
      システムの MTA を変更しようと考えるシステム管理者もいるかもしれません。
      その理由は、単に他の MTA を試してみたいというものから
      他のメーラに依存する特定の機能やパッケージが必要だといったものまで、
      多岐にわたることでしょう。
      幸い、理由がどんなものであれ、FreeBSD では簡単に変更できます。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp94998864"></a>21.4.1. 新しい MTA のインストール</h3></div></div></div><p>さまざまな MTA が利用できます。
	<a class="link" href="ports.html" title="第5章 アプリケーションのインストール - packages と ports">FreeBSD Ports Collection</a>
	から探しはじめるのがよいでしょう。
	もちろん、どんな場所からでも、あなたが利用したい MTA が
	FreeBSD で動作する限りすべて自由に使えます。</p><p>新しい MTA をインストールすることからはじめましょう。
	新しい MTA をインストールすると、
	あなたの要求が実際に実現したかどうか決める機会が与えられます。さらに、
	サービスを <span class="application">sendmail</span> から引き継ぐ前に
	新しいソフトウェアを設定する機会が与えられます。これを行う場合、
	新しいソフトウェアが <code class="filename">/usr/bin/sendmail</code>
	のようなシステムバイナリを上書きしようとしないことを確認してください。
	そうしないとあなたが設定する前に新しいメールソフトウェアが本格的に動作しはじめてしまいます。</p><p>あなたが選択したソフトウェアを設定する方法についての情報は、
	その MTA の文書を参照してください。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp95010384"></a>21.4.2. <span class="application">sendmail</span> を無効にする</h3></div></div></div><p><span class="application">sendmail</span>
	を起動するために使用されていた手続きは、
	4.5-RELEASE と 4.6-RELEASE の間で著しく変更されました。
	したがって、それを無効にするための手続きは微妙に違います。</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp95011920"></a>21.4.2.1. 2002 年 4 月 4 日より前の FreeBSD 4.5-STABLE
	  (4.5-RELEASE とそれ以前のバージョンが該当)</h4></div></div></div><p><code class="filename">/etc/rc.conf</code> に次の行を加えてください。</p><pre class="programlisting">sendmail_enable="NO"</pre><p>これは <span class="application">sendmail</span>
	  のメール受信機能を無効にします。
	  しかし <code class="filename">/etc/mail/mailer.conf</code> (下記参照)
	  が変更されていなければ、<span class="application">sendmail</span>
	  はメールの送信にまだ使われるでしょう。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp95015504"></a>21.4.2.2. 2002 年 4 月 4 日以降の FreeBSD 4.5-STABLE
	  (4.6-RELEASE とそれ以降のバージョンが該当)</h4></div></div></div><p><span class="application">sendmail</span> を完全に無効にするためには
	  <code class="filename">/etc/rc.conf</code> に次の行を加えなくてはいけません。</p><pre class="programlisting">sendmail_enable="NONE"</pre><div xmlns="" class="warning"><h3 class="admontitle">警告: </h3><p xmlns="http://www.w3.org/1999/xhtml">もしこの方法で <span class="application">sendmail</span>
	    のメール送信機能を無効にしたのなら、
	    完全に動作する代替メール配送システムと置き換えることが重要です。
	    さもなければ、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=periodic&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">periodic</span>(8)</span></a> などのシステム機能は、
	    それらの結果を通常想定しているようにメールで配送することができなくなるでしょう。
	    システムの多くの部分が <span class="application">sendmail</span>
	    互換のシステムがあることを想定しているかもしれません。
	    もしそれらを無効にした後に、
	    アプリケーションがメールを送ろうとするために
	    <span class="application">sendmail</span> のバイナリを使用し続ければ、
	    メールは使われていない <span class="application">sendmail</span>
	    のキューに入り、そして決して配送されないでしょう。</p></div><p>もし <span class="application">sendmail</span>
	  のメール受信機能だけを無効にしたいのなら
	  <code class="filename">/etc/rc.conf</code> に以下の行を追加してください。</p><pre class="programlisting">sendmail_enable="NO"</pre><p><span class="application">sendmail</span>の起動オプションに関する詳細は
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc.sendmail</span>(8)</span></a> マニュアルをご覧ください。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp95032144"></a>21.4.3. 起動時に新しい MTA を起動する</h3></div></div></div><p>起動時に新しい MTA を起動するには二つの選択肢があります。
	ここでも、あなたが稼働させている FreeBSD のバージョンに依存します</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp95033168"></a>21.4.3.1. 2002 年 4 月 11 日より前の FreeBSD 4.5-STABLE
	  (4.5-RELEASE とそれ以前のバージョンが該当)</h4></div></div></div><p><code class="filename">/usr/local/etc/rc.d/</code> ディレクトリに、
	  ファイル名が <code class="filename">.sh</code> でおわり、
	  <code class="systemitem">root</code> によって実行可能なスクリプトを追加します。
	  このスクリプトは <code class="literal">start</code> および
	  <code class="literal">stop</code> パラメータを引数として受け付けるようにします。
	  起動時にシステムスクリプトは次のコマンドを実行するでしょう。</p><pre class="programlisting">/usr/local/etc/rc.d/supermailer.sh start</pre><p>これは手動でサーバを起動するためにも使用できます。
	  システム終了時にはシステムスクリプトは <code class="literal">stop</code>
	  オプションを使用して、次のコマンドを実行するでしょう。</p><pre class="programlisting">/usr/local/etc/rc.d/supermailer.sh stop</pre><p>これはシステムが稼働している間に手動でサーバを停止するためにも使えます。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp95038160"></a>21.4.3.2. 2002 年 4 月 11 日以降の FreeBSD 4.5-STABLE
	  (4.6-RELEASE とそれ以降のバージョンが該当)</h4></div></div></div><p>より新しいバージョンの FreeBSD では、
	  上記の方法または次の行を <code class="filename">/etc/rc.conf</code>
	  に設定できます。</p><pre class="programlisting">mta_start_script="filename"</pre><p><em class="replaceable"><code>filename</code></em> は、あなたが
	  MTA を立ち上げるために起動時に実行するスクリプト名です。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp95045072"></a>21.4.4. システムのデフォルトメーラとして <span class="application">sendmail</span> を置き換える</h3></div></div></div><p><span class="application">sendmail</span> プログラムは <span class="trademark">UNIX</span>®
	システム上の標準ソフトウェアとして本当にどこでも利用できるので、
	これがすでにインストールおよび設定されているとみなしている
	ソフトウェアもあるかもしれません。
	この理由により、代替となる MTA の多くは
	<span class="application">sendmail</span> コマンドラインインタフェースと
	互換性のある実装を提供しています。
	これを <span class="quote">「<span class="quote">差し込む</span>」</span> ことによって、
	<span class="application">sendmail</span> の置き換えとして代替 MTA
	を使用することが容易になります。</p><p>したがって、あなたが互換メーラを使用しているときには、
	<code class="filename">/usr/bin/sendmail</code> のような標準
	<span class="application">sendmail</span>
	バイナリを実行しようとするソフトウェアが、
	実際にはその代わりにあなたの選択したメーラを実行しているということを
	確かめる必要があるでしょう。
	好運なことに、FreeBSD はこの仕事をする
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mailwrapper&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mailwrapper</span>(8)</span></a> と呼ばれるシステムを提供しています。</p><p>インストールされたまま
	<span class="application">sendmail</span> が稼働しているときには
	<code class="filename">/etc/mail/mailer.conf</code>
	には以下のような記述があるでしょう。</p><pre class="programlisting">sendmail    /usr/libexec/sendmail/sendmail
send-mail   /usr/libexec/sendmail/sendmail
mailq       /usr/libexec/sendmail/sendmail
newaliases  /usr/libexec/sendmail/sendmail
hoststat    /usr/libexec/sendmail/sendmail
purgestat   /usr/libexec/sendmail/sendmail</pre><p>このことは、これらのうちどの共通コマンド
	(<code class="filename">sendmail</code> 自身のような) が実行されても、
	システムは <code class="filename">mailer.conf</code> を確認して、
	代わりに <code class="filename">/usr/libexec/sendmail/sendmail</code> を実行する
	<code class="filename">sendmail</code> という名前の mailwapper
	のコピーを呼び出すことを意味します。
	このようなシステムでは、デフォルトの
	<code class="filename">sendmail</code> が呼び出されたときに、
	どのバイナリが実際に実行されるかを変更するのが簡単になります。</p><p>したがって、<span class="application">sendmail</span> の代わりに
	<code class="filename">/usr/local/supermailer/bin/sendmail-compat</code>
	を実行させたいのなら、次のように
	<code class="filename">/etc/mail/mailer.conf</code> を変更してください。</p><pre class="programlisting">sendmail    /usr/local/supermailer/bin/sendmail-compat
send-mail   /usr/local/supermailer/bin/sendmail-compat
mailq       /usr/local/supermailer/bin/mailq-compat
newaliases  /usr/local/supermailer/bin/newaliases-compat
hoststat    /usr/local/supermailer/bin/hoststat-compat
purgestat   /usr/local/supermailer/bin/purgestat-compat</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp95085264"></a>21.4.5. 完了</h3></div></div></div><p>あなたのやりたいようにすべてを設定しおえたら、
	もはや必要のない <span class="application">sendmail</span>
	のプロセスを終了して新しいソフトウェアに関するプロセスを起動するか、
	単に再起動してください。
	再起動することによって、新しい MTA が起動時に正しく立ち上がるように
	システムが設定されているかどうか確認することもできるでしょう。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sendmail.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="mail.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="mail-trouble.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">21.3. <span class="application">sendmail</span> の設定〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓21.5. トラブルシュート</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>