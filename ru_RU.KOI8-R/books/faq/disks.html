<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>Глава 8. Диски, файловые системы и начальные загрузчики</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Часто задаваемые вопросы по FreeBSD 8.X, 9.X и 10.X" /><link rel="up" href="index.html" title="Часто задаваемые вопросы по FreeBSD 8.X, 9.X и 10.X" /><link rel="prev" href="kernelconfig.html" title="Глава 7. Конфигурирование ядра" /><link rel="next" href="all-about-zfs.html" title="Глава 9. ZFS" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Глава 8. Диски, файловые системы и начальные загрузчики</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="kernelconfig.html">Пред.</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="all-about-zfs.html">След.</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="disks"></a>Глава 8. Диски, файловые системы и начальные загрузчики</h1></div></div></div><div class="qandaset"><a id="idp76220624"></a><dl><dt>8.1. <a href="disks.html#idp76220880">Как добавить в систему новый диск?</a></dt><dt>8.2. <a href="disks.html#idp76223440">Как перенести систему на большой новый диск?</a></dt><dt>8.3. <a href="disks.html#idp76282448">На каких разделах можно без опаски использовать механизм
	    Soft Updates?  Я слышал, что использование Soft Updates на
	    / могут приводить к
	    проблемам.  Что насчёт журналируемых Soft Updates?</a></dt><dt>8.4. <a href="disks.html#idp76295120">Можно ли смонтировать другие файловые системы?</a></dt><dt>8.5. <a href="disks.html#idp76310736">Как смонтировать вторичный раздел DOS?</a></dt><dt>8.6. <a href="disks.html#idp76323536">Существует ли криптографическая файловая система для
	    FreeBSD?</a></dt><dt>8.7. <a href="disks.html#idp76327760">Как загрузить FreeBSD и Linux(R) с помощью
	    GRUB?</a></dt><dt>8.8. <a href="disks.html#idp76335440">Как загрузить FreeBSD и Linux(R) с помощью
	    BootEasy?</a></dt><dt>8.9. <a href="disks.html#idp76341968">Как сменить приглашение загрузчика с ??? на
	    что-нибудь более значащее?</a></dt><dt>8.10. <a href="disks.html#idp76344912">Как использовать устройство для чтения сменных дисков?</a></dt><dt>8.11. <a href="disks.html#idp76381136">При монтировании компакт-диска выдаётся сообщение
	    Incorrect super block.</a></dt><dt>8.12. <a href="disks.html#idp76384080">При монтировании компакт-диска выдаётся сообщение
	    Device not configured.</a></dt><dt>8.13. <a href="disks.html#idp76387152">Когда я монтирую CD-ROM, все неанглийские символы в именах
	    файлов выводятся как <<?>>.</a></dt><dt>8.14. <a href="disks.html#idp76390480">Записанный во FreeBSD CD не читается ни в какой
	    другой операционной системой.  Почему?</a></dt><dt>8.15. <a href="disks.html#idp76393040">Как создать образ CD с данными?</a></dt><dt>8.16. <a href="disks.html#idp76412624">Почему я не могу смонтировать (командой
	    mount аудио CD?</a></dt><dt>8.17. <a href="disks.html#idp76416336">Как выполнить mount для многосеансового
	    CD?</a></dt><dt>8.18. <a href="disks.html#idp76424912">Как разрешить обычным пользователям монтировать
	    компакт-диски, DVD, USB-диски и другие сменные носители?</a></dt><dt>8.19. <a href="disks.html#idp76442192">Команды du и df
	    показывают разный объем доступного дискового пространства.
	    Что происходит?</a></dt><dt>8.20. <a href="disks.html#idp76489808">Как добавить дополнительную виртуальную память?</a></dt><dt>8.21. <a href="disks.html#idp76492496">Почему FreeBSD считает, что размер моего диска меньше, чем
	    заявляет его производитель?</a></dt><dt>8.22. <a href="disks.html#idp76495440">Почему возможно заполнение раздела больше чем на 100%?</a></dt><dt>8.23. <a href="disks.html#idp76501968">Почему загрузка FreeBSD задерживается на длительное время
	    на системах с большим объёмом ОЗУ?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp76220880"></a><a id="adding-disks"></a><p><strong>8.1.</strong></p></td><td align="left" valign="top"><p>Как добавить в систему новый диск?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Обратитесь к разделу <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/disks-adding.html" target="_top">Добавление
	    дисков</a> Руководства FreeBSD.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76223440"></a><a id="new-huge-disk"></a><p><strong>8.2.</strong></p></td><td align="left" valign="top"><p>Как перенести систему на большой новый диск?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Самый лучший способ заключается в переустановке
	    операционной системы на новый диск с последующим переносом
	    пользовательских данных.  Это настоятельно рекомендуется
	    при отслеживании ветки <span class="emphasis"><em>-STABLE</em></span> в
	    течение более одного релиза или при обновлении релиза
	    вместо установки нового.  Установите booteasy на оба диска
	    с помощью <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=boot0cfg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">boot0cfg</span>(8)</span></a> и выполняйте загрузку с любого
	    из них, пока не будете довольны новой конфигурацией.
	    Пропустите следующий абзац, чтобы перейти к вопросу
	    переноса данных после этой операции.</p><p>Либо разбейте на разделы и разметьте новый диск с
	    помощью <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sade&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sade</span>(8)</span></a> или <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gpart&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gpart</span>(8)</span></a>.  Если диски
	    отформатированы в MBR, то booteasy можно установить на оба
	    диска с помощью <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=boot0cfg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">boot0cfg</span>(8)</span></a> для того, чтобы иметь
	    возможность выполнять загрузку как старой, так и новой
	    системы после выполнения копирования.</p><p>После подготовки диска данные нельзя просто так взять
	    и перенести.  Используйте для этого инструменты,
	    которые учитывают файлы устройств и системные флаги,
	    например, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a>.  И хотя рекомендуется выполнять
	    перенос данных в однопользовательском режиме, это не
	    является обязательным условием.</p><p>Если на дисках стоит <acronym class="acronym">UFS</acronym>, никогда
	    не используйте ничего, кроме <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a> и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=restore&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">restore</span>(8)</span></a>
	    для переноса корневой файловой системы.  Эти команды
	    также следует использовать при переносе отдельного раздела
	    на другой пустой раздел.  Последовательность шагов при
	    использовании <code class="command">dump</code> для переноса данных
	    с раздела <acronym class="acronym">UFS</acronym> на новый раздел:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>выполните команду <code class="command">newfs</code> над новым
		разделом.</p></li><li class="step"><p>командой <code class="command">mount</code> смонтируйте его во
		временный каталог.</p></li><li class="step"><p>командой <code class="command">cd</code> перейдите в этот
		каталог.</p></li><li class="step"><p>выполните команду <code class="command">dump</code> над старым
		разделом, направив вывод в новый раздел.</p></li></ol></div><p>Например, чтобы перенести корневую файловую
	    систему на устройство <code class="filename">/dev/ada1s1a</code>
	    с использованием каталога <code class="filename">/mnt</code>
	    в качестве временной точки монтирования, наберите:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>newfs /dev/ad1as1a</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/ad1as1a /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>dump 0af - / | restore rf -</code></strong></pre><p>Переразбиение разделов с использованием
	    <code class="command">dump</code> требует несколько
	    больше усилий.  Для объединения раздела типа
	    <code class="filename">/var</code> с его вышестоящим
	    разделом, создайте новый
	    раздел, достаточно большой для размещения их обоих, переместите
	    вышестоящий раздел так, как это описано выше, а затем переместите
	    нижестоящий раздел в пустой каталог, созданный при первом
	    перемещении:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>newfs /dev/ada1s1a</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/ad1as1a /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>dump 0af - / | restore rf -</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd var</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>dump 0af - /var | restore rf -</code></strong></pre><p>Для отделения каталога от вышестоящего, скажем, для
	    размещения <code class="filename">/var</code> в
	    собственном разделе, которого не было,
	    создайте оба раздела, затем смонтируйте нижестоящий раздел в
	    подходящий каталог во временную точку монтирования, а затем
	    переместите старый единый раздел:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>newfs /dev/ada1s1a</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>newfs /dev/ada1s1d</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/ada1s1a /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir /mnt/var</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/ada1s1d /mnt/var</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>dump 0af - / | restore rf -</code></strong></pre><p>Для перемещения пользовательских данных также имеются
	    программы <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cpio&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">cpio</span>(1)</span></a> и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pax&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pax</span>(1)</span></a>.  Известно, что они
	    теряют информацию о флагах файлов, так что используйте их
	    с осторожностью.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76282448"></a><a id="safe-softupdates"></a><p><strong>8.3.</strong></p></td><td align="left" valign="top"><p>На каких разделах можно без опаски использовать механизм
	    Soft Updates?  Я слышал, что использование Soft Updates на
	    <code class="filename">/</code> могут приводить к
	    проблемам.  Что насчёт журналируемых Soft Updates?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Краткий ответ: обычно Soft Updates можно использовать
	    без опаски на всех разделах.</p><p>Подробный ответ: Soft Updates имеют две характеристики,
	    которые могут быть нежелательны на некоторых разделах.  Во-первых,
	    раздел с Soft Updates имеет небольшой шанс потери данных по время
	    аварийного останова системы.  Раздел не будет попорчен,
	    поскольку данные будет просто потеряны.  Во-вторых, Soft Updates могут приводить к
	    временной нехватке дискового пространства.</p><p>При использовании Soft Updates ядро может задерживать
	    до тридцати секунд запись изменений на физический диск.
	    При удалении большого файла он остается на диске, пока
	    ядро не выполнит фактическое удаление.  Это может привести
	    к очень простой гонке.  Предположим, удаляется один
	    большой файл и тут же создаётся другой большой файл.
	    Первый файл на самом деле ещё не удалён с диска, поэтому
	    для второго файла на диске может не хватить места.  Это
	    приведёт к ошибке о том, что на разделе нет достаточного
	    пространства, несмотря на то, что только что освободилось
	    много места.  Через пару секунд создание файла сработает,
	    как и ожидалось.</p><p>Если система может аварийно остановиться после того, как ядро
	    примет набор данных для записи на диск, но перед тем, как данные
	    реально запишутся, то данные могут потеряться.
	    Такой риск чрезвычайно мал, но в целом управляем.</p><p>Эти проблемы влияют на все разделы, использующие Soft Updates.
	    Итак, что это означает для корневого раздела?</p><p>Жизненно важная информация на корневом разделе меняется очень
	    редко.  Если в системе
	    произойдет сбой в период тридцатисекундного окна после выполнения
	    такого изменения, возможно, что данные окажутся потерянными.  Этот
	    риск незначителен для большинства применений, но его нужно
	    учитывать.  Если система не может принять такой риск,
	    не используйте Soft Updates с корневой файловой системой!</p><p><code class="filename">/</code> традиционно
	    является одним из самых маленьких разделов.  Если каталог
	    <code class="filename">/tmp</code> размещён в <code class="filename">/</code> и у
	    вас заполнен <code class="filename">/tmp</code>, то могут
	    периодически возникать проблемы с дисковым пространством.
	    Создание символической ссылки <code class="filename">/tmp</code>,
	    указывающей на <code class="filename">/var/tmp</code> решит эту проблему.</p><p>В заключение, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a> не работает в режиме реального
	    времени (-L) с файловой системой, для которой включены
	    журналируемые Soft Updates (<acronym class="acronym">SU+J</acronym>).</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76295120"></a><a id="mount-foreign-fs"></a><p><strong>8.4.</strong></p></td><td align="left" valign="top"><p>Можно ли смонтировать другие файловые системы?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>FreeBSD поддерживает ряд других файловых систем.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">UFS</span></dt><dd><p>Компакт-диски с файловой системой UFS могут быть
		  смонтированы без всяких проблем.  Монтирование файловых
		  систем Digital UNIX или других систем, поддерживающих UFS,
		  может быть более сложным, в зависимости от особенностей
		  разбиения диска конкретной операционной системой.</p></dd><dt><span class="term">ext2/ext3</span></dt><dd><p>FreeBSD поддерживает разделы <code class="literal">ext2fs</code>
		  и <code class="literal">ext3fs</code>.
		  За дополнительной информацией обратитесь к странице
		  Справочника <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ext2fs&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ext2fs</span>(5)</span></a>.</p></dd><dt><span class="term">NTFS</span></dt><dd><p>Поддержка NTFS через FUSE доступна через порт
		  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/sysutils/fusefs-ntfs/pkg-descr">sysutils/fusefs-ntfs</a>.
		  Для получения более полной информации смотрите
		  документацию к <a class="link" href="http://www.tuxera.com/community/ntfs-3g-manual/" target="_top"><span class="application">ntfs-3g</span></a>.</p></dd><dt><span class="term">FAT</span></dt><dd><p>Во FreeBSD имеется драйвер для работы с FAT в режиме
		  чтения-записи.  Для получения дополнительной информации
		  обратитесь к странице справочника <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount_msdosfs</span>(8)</span></a>.</p></dd><dt><span class="term">ZFS</span></dt><dd><p>FreeBSD включает в себя портированную из <span class="trademark">Sun</span>TM
		  реализацию файловой системы ZFS.  В настоящее время
		  рекомендуется использовать её только на платформе
		  amd64 с достаточным объемом памяти.  Для получения
		  более полной информации обратитесь к странице Справочника
		  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=zfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">zfs</span>(8)</span></a>.</p></dd></dl></div><p>FreeBSD включает сетевую файловую систему
	      <acronym class="acronym">NFS</acronym>.  В Коллекции портов FreeBSD имеется
	    несколько приложений FUSE для поддержки многих других
	    файловых систем.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76310736"></a><a id="mount-dos"></a><p><strong>8.5.</strong></p></td><td align="left" valign="top"><p>Как смонтировать вторичный раздел DOS?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Вторичные разделы DOS находятся после <span class="emphasis"><em>всех</em></span>
	    первичных разделов.
	    Например, если <span class="quote"><<<span class="quote">E</span>>></span> является вторым разделом
	    DOS на втором диске SCSI, то здесь будет файл устройства для
	    пятого <span class="quote"><<<span class="quote">слайса</span>>></span> в каталоге <code class="filename">/dev</code>.
	    Чтобы смонтировать:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -t msdosfs /dev/da1s5 /dos/e</code></strong></pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76323536"></a><a id="crypto-filesystem"></a><p><strong>8.6.</strong></p></td><td align="left" valign="top"><p>Существует ли криптографическая файловая система для
	    FreeBSD?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Да, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gbde&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gbde</span>(8)</span></a> и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=geli&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">geli</span>(8)</span></a>.
	    Смотрите раздел <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/disks-encrypting.html" target="_top">Шифрование
	      дисковых разделов</a> Руководства FreeBSD.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76327760"></a><a id="grub-loader"></a><p><strong>8.7.</strong></p></td><td align="left" valign="top"><p>Как загрузить FreeBSD и <span class="trademark">Linux</span>(R) с помощью
	    <span class="application">GRUB</span>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Для загрузки FreeBSD с использованием
	    <span class="application">GRUB</span> добавьте следующие строки
	    в <code class="filename">/boot/grub/menu.lst</code> или
	    <code class="filename">/boot/grub/grub.conf</code>, в зависимости
	    от используемого дистрибутива <span class="trademark">Linux</span>(R).</p><pre class="programlisting">title FreeBSD 9.1
root <em class="replaceable"><code>(hd0,a)</code></em>
kernel /boot/loader</pre><p>Где <em class="replaceable"><code>hd0,a</code></em> указывает на
	    корневой раздел на первом диске.  Чтобы указать номер
	    слайса, напишите что-то вроде
	    <em class="replaceable"><code>(hd0,2,a)</code></em>.  По умолчанию, если
	    номер слайса не указан, <span class="application">GRUB</span>
	    ищет первый слайс c разделом <code class="literal">a</code>.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76335440"></a><a id="booteasy-loader"></a><p><strong>8.8.</strong></p></td><td align="left" valign="top"><p>Как загрузить FreeBSD и <span class="trademark">Linux</span>(R) с помощью
	    <span class="application">BootEasy</span>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Установите LILO в начало загрузочного раздела <span class="trademark">Linux</span>(R),
	    а не в Master Boot Record.  После этого LILO можно будет
	    запустить LILO из <span class="application">BootEasy</span>.</p><p>Это рекомендуется делать при одновременном
	    использовании <span class="trademark">Windows</span>(R) и <span class="trademark">Linux</span>(R), чтобы упростить
	    восстановление работоспособности <span class="trademark">Linux</span>(R) в случае
	    переустановки <span class="trademark">Windows</span>(R).</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76341968"></a><a id="changing-bootprompt"></a><p><strong>8.9.</strong></p></td><td align="left" valign="top"><p>Как сменить приглашение загрузчика с <code class="literal">???</code> на
	    что-нибудь более значащее?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Этого нельзя сделать со стандартным загрузчиком, не
	    переписав его.  В категории <code class="filename">sysutils</code>
	    Коллекции Портов есть ряд других менеджеров
	    загрузки.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76344912"></a><a id="removable-drives"></a><p><strong>8.10.</strong></p></td><td align="left" valign="top"><p>Как использовать устройство для чтения сменных дисков?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Если у вас уже есть файловая система на устройстве,
	    то используйте такую команду:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -t msdosfs /dev/da0s1 /mnt</code></strong></pre><p>Если это устройство будет использоваться только на
	    системах FreeBSD, то разбейте его на разделы
	    <acronym class="acronym">UFS</acronym> или <acronym class="acronym">ZFS</acronym>.  Это
	    обеспечит поддержку длинных имён файлов, увеличение
	    производительности и надёжность.  Если устройство будет
	    использоваться с другими операционными системами, то лучше
	    сделать более совместимый выбор, например, msdosfs.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/dev/zero of=/dev/da0 count=2</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>gpart create -s GPT /dev/da0</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>gpart add -t freebsd-ufs /dev/da0</code></strong></pre><p>Наконец, остаётся создать новую файловую систему:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>newfs /dev/da0p1</code></strong></pre><p>и смонтировать её:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /dev/da0s1 /mnt</code></strong></pre><p>Хорошо ещё добавить строку в файл
	    <code class="filename">/etc/fstab</code> (прочтите справку по <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fstab&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">fstab</span>(5)</span></a>),
	    чтобы в будущем можно было просто давать команду
	    <code class="command">mount /mnt</code>:</p><pre class="programlisting">/dev/da0p1 /mnt ufs rw,noauto 0 0</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76381136"></a><a id="mount-cd-superblock"></a><p><strong>8.11.</strong></p></td><td align="left" valign="top"><p>При монтировании компакт-диска выдаётся сообщение
	    <span class="errorname">Incorrect super block</span>.</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Необходимо указать тип монтируемого устройства.
	    Это описано в в разделе Руководства <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/creating-cds.html#mounting-cd" target="_top">Использование
	      CD с данными</a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76384080"></a><a id="cdrom-not-configured"></a><p><strong>8.12.</strong></p></td><td align="left" valign="top"><p>При монтировании компакт-диска выдаётся сообщение
	    <code class="literal">Device not configured</code>.</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Обычно это означает, что в приводе нет компакт-диска либо
	    устройство не обнаружено на шине.  Обратитесь к разделу
	    <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/creating-cds.html#mounting-cd" target="_top">
	    Использование CD с данными</a> в Руководстве, где подробно
	    обсуждается этот вопрос.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76387152"></a><a id="cdrom-unicode-filenames"></a><p><strong>8.13.</strong></p></td><td align="left" valign="top"><p>Когда я монтирую CD-ROM, все неанглийские символы в именах
	    файлов выводятся как <span class="quote"><<<span class="quote">?</span>>></span>.</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Скорее всего, на компакт-диске для хранения информации о
	    файлах и каталогах используется расширение <span class="quote"><<<span class="quote">Joliet</span>>></span>.
	    Это описано в разделе Руководства об <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/creating-cds.html#mounting-cd" target="_top">использовании
	      CD с данными</a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76390480"></a><a id="burncd-isofs"></a><p><strong>8.14.</strong></p></td><td align="left" valign="top"><p>Записанный во FreeBSD CD не читается ни в какой
	    другой операционной системой.  Почему?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Это означает, что на CD был записан непосредственно
	    необработанный файл без создания файловой системы
	    ISO 9660.  Прочтите раздел Руководства о <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/creating-cds.html#rawdata-cd" target="_top">записи
	      данных непосредственно на компакт-диски</a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76393040"></a><a id="copy-cd"></a><p><strong>8.15.</strong></p></td><td align="left" valign="top"><p>Как создать образ CD с данными?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Это описано в разделе Руководства о <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/creating-cds.html#imaging-cd" target="_top">копировании
	      CD с данными</a>.  Более полную информацию о работе с
	    компакт-дисками можно найти в разделе о <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/creating-cds.html" target="_top">создании
	      компакт-дисков</a>
	    в главе Руководства об устройствах хранения данных.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76412624"></a><a id="mount-audio-CD"></a><p><strong>8.16.</strong></p></td><td align="left" valign="top"><p>Почему я не могу смонтировать (командой
	    <code class="command">mount</code> аудио CD?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Попытка смонтировать аудио CD приведёт к сообщению об
	    ошибке вида: <span class="errorname">cd9660: /dev/acd0c: Invalid
	    argument</span>.  Причина этого заключается в том,
	    что команда <code class="command">mount</code> работает только с
	    файловыми системами.  На аудио CD файловых систем нет;
	    они содержат только данные.  Используйте вместо этого
	    программу, которая умеет читать аудио CD, например, порт
	    <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/xmcd/pkg-descr">audio/xmcd</a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76416336"></a><a id="multi-session-CD"></a><p><strong>8.17.</strong></p></td><td align="left" valign="top"><p>Как выполнить <code class="command">mount</code> для многосеансового
	    CD?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>По умолчанию <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> будет пытаться смонтировать
	    последнюю дорожку (сеанс) CD с данными.  Для загрузки
	    более раннего сеанса используйте параметр командной строки
	    <code class="option">-s</code>.  За конкретными примерами обращайтесь
	    к странице Справочника <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount_cd9660</span>(8)</span></a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76424912"></a><a id="user-floppymount"></a><p><strong>8.18.</strong></p></td><td align="left" valign="top"><p>Как разрешить обычным пользователям монтировать
	    компакт-диски, DVD, USB-диски и другие сменные носители?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Как пользователь <code class="systemitem">root</code>, установите
	    системную переменную <code class="varname">vfs.usermount</code> в
	    значение <code class="literal">1</code>.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl vfs.usermount=1</code></strong></pre><p>Чтобы это срабатывало во время загрузки системы,
	    добавьте строчку <code class="literal">vfs.usermount=1</code> в файл
	    <code class="filename">/etc/sysctl.conf</code>.</p><p>Пользователи могут монтировать только те устройства,
	    к которым у них имеется доступ на чтение.  Чтобы разрешить
	    пользователям монтировать устройство, должны быть заданы
	    разрешения в <code class="filename">/etc/devfs.conf</code>.</p><p>Например, чтобы разрешить пользователям монтировать
	    первое устройство USB, добавьте такую строчку:</p><pre class="programlisting"># Allow all users to mount a USB drive.
	    own       /dev/da0       root:operator
	    perm      /dev/da0       0666</pre><p>Теперь все пользователи могут монтировать устройства
	    с правами доступа на чтение в собственные каталоги:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>mkdir ~/my-mount-point</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>mount -t msdosfs /dev/da0 ~/my-mount-point</code></strong></pre><p>Размонтирование устройства осуществляется просто:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>umount ~/my-mount-point</code></strong></pre><p>Использование <code class="varname">vfs.usermount</code>, однако, имеет
	    некоторые негативные стороны, связанные с вопросами безопасности.
	    Более правильным способом работы с носителями в формате <span class="trademark">MS-DOS</span>(R)
	    является использование пакета <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/emulators/mtools/pkg-descr">emulators/mtools</a>
	    из Коллекции Портов.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Имя устройства, использованное в предыдущих
	      примерах, должно быть изменено в соответствии с
	      конфигурацией.</p></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76442192"></a><a id="du-vs-df"></a><p><strong>8.19.</strong></p></td><td align="left" valign="top"><p>Команды <code class="command">du</code> и <code class="command">df</code>
	    показывают разный объем доступного дискового пространства.
	    Что происходит?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Это связано с тем, как эти команды на самом деле
	    работают.  <code class="command">du</code> проходит по дереву
	    каталогов, замеряя, насколько большой объем занимает
	    каждый файл, и выдает общий объем.  <code class="command">df</code>
	    просто запрашивает файловую систему об оставшемся объеме.
	    Это выглядит как одно и то же, однако файл без записи в
	    каталоге затронет <code class="command">df</code>, но не повлияет на
	    <code class="command">du</code>.</p><p>Когда программа использует файл и этот файл удаляется,
	    то на самом деле он не удаляется из файловой системы, пока
	    программа не прекратит его использовать.  Однако файл тут
	    же удаляется из списка каталога.  Представим себе файл
	    достаточно большого размера, чтобы его присутствие влияло
	    на вывод <code class="command">du</code> и <code class="command">df</code>.
	    Если файл удаляется в процессе работы с ним команды
	    <code class="command">more</code>, команда <code class="command">more</code>
	    не сообщает сразу же, что не может просматривать файл.
	    Запись о файле просто удалена из каталога, так что другие
	    программы или пользователи не смогут к нему обратиться.
	    Тем не менее, <code class="command">du</code> покажет, что файл
	    исчез, поскольку она просматривает дерево каталогов, а
	    файла там нет. <code class="command">df</code> показывает, что файл
	    всё ещё здесь, так как файловая система знает, что
	    <code class="command">more</code> всё ещё использует это
	    пространство.  Как только закончится работа с
	    <code class="command">more</code>, команды <code class="command">du</code> и
	    <code class="command">df</code> придут в соответствие.</p><p>Такая ситуация часта на Web-серверах.  Многие устанавливают
	    Web-сервер на FreeBSD и забывают обновлять файлы протоколов.
	    Журнал доступа заполняет <code class="filename">/var</code>.  Новый
	    администратор удаляет файл, но система все еще сообщает о том, что
	    раздел заполнен.  Остановка и перезапуск программы Web-сервера
	    освободит файл, позволяя системе освободить дисковое пространство.
	    Для предотвращения этого настройте <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newsyslog&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newsyslog</span>(8)</span></a>.</p><p>Заметьте, что подсистема отложенных обновлений
	    (Soft Updates) может задерживать освобождение дискового
	    пространства, и может потребоваться до 30 секунд, чтобы
	    изменения стали заметны.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76489808"></a><a id="add-swap-space"></a><p><strong>8.20.</strong></p></td><td align="left" valign="top"><p>Как добавить дополнительную виртуальную память?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>В этом разделе <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/adding-swap-space.html" target="_top">Руководства</a>
	    описывается, как это сделать.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76492496"></a><a id="manufacturer-disk-size"></a><p><strong>8.21.</strong></p></td><td align="left" valign="top"><p>Почему FreeBSD считает, что размер моего диска меньше, чем
	    заявляет его производитель?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Производители дисков считают гигабайт равным миллиарду байт,
	    а FreeBSD приравнивает его к 1073741824 байт.  Это объясняет,
	    почему, к примеру, в сообщениях при загрузке FreeBSD указывается, что
	    ёмкость диска, объём которого должен быть равным 80 Гбайт,
	    составляет 76319 Мбайт.</p><p>Заметьте также, что FreeBSD будет (по умолчанию) <a class="link" href="disks.html#disk-more-than-full" title="8.22.">резервировать</a> 8% ёмкости
	    диска.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76495440"></a><a id="disk-more-than-full"></a><p><strong>8.22.</strong></p></td><td align="left" valign="top"><p>Почему возможно заполнение раздела больше чем на 100%?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Часть каждого раздела UFS (по умолчанию 8%) зарезервировано для
	    использования операционной системой и пользователем
	    <code class="systemitem">root</code>.  Утилита <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=df&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">df</span>(1)</span></a> не учитывает это
	    при подсчёте значения в колонке <code class="literal">Capacity</code>, так
	    что оно может превышать 100%.  Обратите внимание, что колонка
	    <code class="literal">Blocks</code> всегда больше, чем сумма значений в
	    колонках <code class="literal">Used</code> и <code class="literal">Avail</code>,
	    обычно на 8%.</p><p>Для получения более подробной информации обратитесь к описанию
	    опции <code class="option">-m</code> в справке по <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tunefs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">tunefs</span>(8)</span></a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76501968"></a><a id="slow-boot-memtest"></a><p><strong>8.23.</strong></p></td><td align="left" valign="top"><p>Почему загрузка FreeBSD задерживается на длительное время
	    на системах с большим объёмом ОЗУ?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>FreeBSD выполняет короткую проверку памяти на раннем
	    этапе загрузки.  Обычно эта проверка занимает всего
	    несколько секунд, но если система имеет много десятков
	    или сотен Гбайт памяти, это можно занять до нескольких
	    минут.  Эту проверку можно отключить, установив
	    <code class="literal">hw.memtest.tests</code> в значение
	    <code class="literal">0</code> в
	    <code class="filename">/boot/loader.conf</code>.</p><p>Для получения дополнительной информации смотрите
	    страницу Справочника <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=loader.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">loader.conf</span>(5)</span></a>.</p></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="kernelconfig.html">Пред.</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="all-about-zfs.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">Глава 7. Конфигурирование ядра </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> Глава 9. ZFS</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>