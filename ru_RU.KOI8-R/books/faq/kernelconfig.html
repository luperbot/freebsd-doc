<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>Глава 7. Конфигурирование ядра</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Часто задаваемые вопросы по FreeBSD 8.X, 9.X и 10.X" /><link rel="up" href="index.html" title="Часто задаваемые вопросы по FreeBSD 8.X, 9.X и 10.X" /><link rel="prev" href="applications.html" title="Глава 6. Прикладные программы" /><link rel="next" href="disks.html" title="Глава 8. Диски, файловые системы и начальные загрузчики" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Глава 7. Конфигурирование ядра</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="applications.html">Пред.</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="disks.html">След.</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="kernelconfig"></a>Глава 7. Конфигурирование ядра</h1></div></div></div><div class="qandaset"><a id="idp76171600"></a><dl><dt>7.1. <a href="kernelconfig.html#idp76171856">Я хочу изменить настройки ядра.  Это сложно?</a></dt><dt>7.2. <a href="kernelconfig.html#idp76180688">Почему моё ядро такое большое?</a></dt><dt>7.3. <a href="kernelconfig.html#idp76196688">Почему мне не удаётся откомпилировать ни один вариант ядра,
	    даже GENERIC?</a></dt><dt>7.4. <a href="kernelconfig.html#idp76213328">Какой планировщик используется
	    в работающей системе?</a></dt><dt>7.5. <a href="kernelconfig.html#idp76216784">Что такое kern.sched.quantum?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp76171856"></a><a id="make-kernel"></a><p><strong>7.1.</strong></p></td><td align="left" valign="top"><p>Я хочу изменить настройки ядра.  Это сложно?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Вовсе нет! Обратитесь к <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/kernelconfig.html" target="_top">соответствующему
	    разделу</a> Руководства, который посвящён этому вопросу.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Новый файл <code class="filename">kernel</code> будет установлен
	      в каталог <code class="filename">/boot/kernel</code>
	      вместе со своими
	      модулями, а старое ядро и его модули будут сдвинуты в каталог
	      <code class="filename">/boot/kernel.old</code>.  Если сделана
	      ошибка в конфигурации, просто загрузите предыдущую
	      версию ядра.</p></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76180688"></a><a id="why-kernel-big"></a><p><strong>7.2.</strong></p></td><td align="left" valign="top"><p>Почему моё ядро такое большое?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Конфигурация ядра <code class="literal">GENERIC</code>, которая
	    содержится в дистрибутиве FreeBSD, компилируется в
	    <span class="emphasis"><em>отладочном режиме</em></span>.  В таком режиме
	    ядра содержат много символьной информации в разных файлах,
	    которая используется для отладки и сильно увеличивает размер
	    <code class="filename">/boot/kernel/</code>.
	    Заметьте, что уменьшения
	    производительности при использовании отладочного ядра нет или
	    оно незначительно, однако отладочное ядро полезно иметь под
	    рукой на случай аварийного завершения работы системы.</p><p>Однако при нехватке дискового пространства существует
	    несколько вариантов уменьшения размера <code class="filename">&gt;/boot/kernel/</code>.</p><p>Чтобы не устанавливать файлы с символьной
	    информацией, убедитесь в наличии следующей строки в
	    <code class="filename">/etc/src.conf</code>:</p><pre class="programlisting">WITHOUT_KERNEL_SYMBOLS=yes</pre><p>Для получения дополнительной информации смотрите страницу
	    Справочника <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=src.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">src.conf</span>(5)</span></a>.</p><p>Если вы не хотите компилировать отладочное ядро,
	    убедитесь в выполнении следующих условий:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>В конфигурационном файле ядра нет такой 
		строчки:</p><pre class="programlisting">makeoptions DEBUG=-g</pre></li><li class="listitem"><p>Вы не запускали утилиту <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=config&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">config</span>(8)</span></a> с опцией
		<code class="option">-g</code>.</p></li></ul></div><p>В любой из вышеописанных ситуаций ядро будет построено с
	    отладочным режимом.</p><p>Чтобы скомпилировать и установить только нужные модули,
	    укажите их в <code class="filename">/etc/make.conf</code>:</p><pre class="programlisting">MODULES_OVERRIDE= <em class="replaceable"><code>accf_http ipfw</code></em></pre><p>Замените <span class="emphasis"><em>accf_httpd ipfw</em></span> на нужный
	    список модулей.  Это уменьшит размер каталога с ядром, а
	    также время сборки.  Для получения дополнительной информации
	    почитайте <code class="filename">/usr/share/examples/etc/make.conf</code>.
	  </p><p>Для дальнейшего уменьшения размера также можно удалить
	    ненужные устройства из ядра.  Для получения дополнительной
	    информации смотрите <a class="xref" href="kernelconfig.html#make-kernel" title="7.1.">Вопрос: 7.1</a>.</p><p>Для вступления любого из этих действий в силу следуйте
	    указаниям по <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/kernelconfig-building.html" target="_top">сборке
	      и установке</a> нового ядра.</p><p>Большинство ядер (<code class="filename">/boot/kernel/kernel</code>),
	    как правило, занимают от 12 до 16 Мбайт.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76196688"></a><a id="generic-kernel-build-failure"></a><p><strong>7.3.</strong></p></td><td align="left" valign="top"><p>Почему мне не удаётся откомпилировать ни один вариант ядра,
	    даже <code class="filename">GENERIC</code>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Есть несколько причин, приводящих к возникновению этой
	    проблемы:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Дерево исходных текстов отличается от того, что
		использовалось для построения работающей в данный
		момент системы.  Перед обновлением прочитайте
		файл <code class="filename">/usr/src/UPDATING</code>,
		обращая особое внимание на раздел
		<span class="quote"><<<span class="quote">COMMON ITEMS</span>>></span> в его конце.</p></li><li class="listitem"><p>Команда <code class="command">make buildkernel</code>
		не завершилась успешно.
		Корректное выполнение цели
		<code class="command">make buildkernel</code>
		зависит от файлов, полученных после выполнения
		<code class="command">make buildworld</code>.</p></li><li class="listitem"><p>Даже при построении <a class="link" href="introduction.html#stable" title="1.9.">FreeBSD-STABLE</a> возможно, что
		дерево исходных текстов было загружено в тот момент,
		когда оно модифицировалось или было неработоспособно.
		Построение гарантируется только для релизов, хотя в
		большинстве случаев <a class="link" href="introduction.html#stable" title="1.9.">FreeBSD-STABLE</a>
		строится без проблем.  Попробуйте сгрузить дерево
		исходных текстов повторно и посмотрите, разрешилась
		ли проблема.  Если с сервером есть проблемы,
		попробуйте другое зеркало.</p></li></ul></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76213328"></a><a id="scheduler-in-use"></a><p><strong>7.4.</strong></p></td><td align="left" valign="top"><p>Какой планировщик используется
	    в работающей системе?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Название используемого планировщика доступно напрямую
	    в виде значения sysctl-параметра
	    <code class="varname">kern.sched.name</code>:</p><pre class="screen"><code class="prompt">%</code> sysctl <em class="replaceable"><code>kern.sched.name</code></em>
kern.sched.name: ULE</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp76216784"></a><a id="scheduler-kern-quantum"></a><p><strong>7.5.</strong></p></td><td align="left" valign="top"><p>Что такое <code class="varname">kern.sched.quantum</code>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p><code class="varname">kern.sched.quantum</code> определяет максимальное
	    количество тактов, которое процесс может выполняться, не будучи
	    прерванным.</p></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="applications.html">Пред.</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="disks.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">Глава 6. Прикладные программы </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> Глава 8. Диски, файловые системы и начальные загрузчики</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>