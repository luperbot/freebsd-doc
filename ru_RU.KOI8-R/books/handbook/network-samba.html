<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>25.8. Файл сервер и печать для Microsoft(R) Windows(R) клиентов (Samba)</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD" /><link rel="up" href="network-servers.html" title="Глава 25. Сетевые серверы" /><link rel="prev" href="network-apache.html" title="25.7. Apache HTTP сервер" /><link rel="next" href="network-ftp.html" title="25.9. Протокол передачи файлов (FTP)" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">25.8. Файл сервер и печать для <span class="trademark">Microsoft</span>(R) <span class="trademark">Windows</span>(R) клиентов
      (Samba)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-apache.html">Пред.</a> </td><th width="60%" align="center">Глава 25. Сетевые серверы</th><td width="20%" align="right"> <a accesskey="n" href="network-ftp.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-samba"></a>25.8. Файл сервер и печать для <span class="trademark">Microsoft</span>(R) <span class="trademark">Windows</span>(R) клиентов
      (Samba)</h2></div><div><span class="authorgroup">Предоставил <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Murray</span> <span class="surname">Stokely</span></span>. </span></div></div></div><a id="idp98606544" class="indexterm"></a><a id="idp98607056" class="indexterm"></a><a id="idp98615888" class="indexterm"></a><a id="idp98617040" class="indexterm"></a><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98618192"></a>25.8.1. Обзор</h3></div></div></div><p><span class="application">Samba</span> это популярный пакет
	программ с открытыми исходными текстами, которая предоставляет
	файловые и принт-сервисы <span class="trademark">Microsoft</span>(R) <span class="trademark">Windows</span>(R) клиентам.
	Эти клиенты могут подключаться и использовать файловое
	пространство FreeBSD, как если бы это был локальный диск,
	или принтеры FreeBSD, как если бы это были локальные
	принтеры.</p><p>Пакет <span class="application">Samba</span> должен быть включен
	в поставку FreeBSD.  Если вы не установили
	<span class="application">Samba</span> при первой установке системы,
	ее можно установить из порта или пакета <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/samba34/pkg-descr">net/samba34</a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98622416"></a>25.8.2. Настройка</h3></div></div></div><p>Файл настройки <span class="application">Samba</span> по умолчанию
	устанавливается в
	<code class="filename">/usr/local/share/examples/samba34/smb.conf.default</code>.
	Этот файл необходимо скопировать в
	<code class="filename">/usr/local/etc/smb.conf</code> и отредактировать
	перед использованием <span class="application">Samba</span>.</p><p>В файле <code class="filename">smb.conf</code> находится информация,
	необходимая для работы <span class="application">Samba</span>,
	например определение принтеров и <span class="quote"><<<span class="quote">общих каталогов</span>>></span>,
	которые будут использоваться совместно с <span class="trademark">Windows</span>(R) клиентами.
	В пакет <span class="application">Samba</span> входит программа с
	веб интерфейсом, называемая <span class="application">swat</span>,
	которая дает простой способ редактирования файла
	<code class="filename">smb.conf</code>.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98628432"></a>25.8.2.1. Использование Samba Web Administration Tool (SWAT)</h4></div></div></div><p>Программа веб администрирования Samba (Samba Web
	  Administration Tool, SWAT) запускается как даемон из
	  <span class="application">inetd</span>.  Следовательно, в
	  <code class="filename">/etc/inetd.conf</code> необходимо снять комментарий
	  перед тем, как использовать <span class="application">swat</span> для
	  настройки <span class="application">Samba</span>:</p><pre class="programlisting">swat   stream  tcp     nowait/400      root    /usr/local/sbin/swat    swat</pre><p>Как описано в <a class="xref" href="network-inetd.html#network-inetd-reread" title="Пример 25.1. Перезагрузка конфигурационного файла inetd">Пример 25.1, <<Перезагрузка конфигурационного файла
	  <span class="application">inetd</span>>></a>,
	  после изменения настроек <span class="application">inetd</span>
	  необходимо перечитать конфигурацию.</p><p>Как только <span class="application">swat</span> был включен
	  <code class="filename">inetd.conf</code>, вы можете использовать
	  браузер для подключения к <code class="uri"><a class="uri" href="http://localhost:901" target="_top">http://localhost:901</a></code>.
	  Сначала необходимо зарегистрироваться с системной
	  учетной записью <code class="systemitem">root</code>.</p><p>После успешного входа на основную страницу настройки
	  <span class="application">Samba</span>, вы можете просмотреть
	  документацию или начать настройку, нажав на кнопку
	  <span class="guimenu">Globals</span>.  Раздел <span class="guimenu">Globals</span>
	  соответствует переменным,
	  установленным в разделе <code class="literal">[global]</code> файла
	  <code class="filename">/usr/local/etc/smb.conf</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98645712"></a>25.8.2.2. Глобальные настройки</h4></div></div></div><p>Независимо от того, используете ли вы
	  <span class="application">swat</span>, или редактируете
	  <code class="filename">/usr/local/etc/smb.conf</code> непосредственно,
	  первые директивы, которые вы скорее всего встретите при
	  настройке <span class="application">Samba</span>, будут
	  следующими:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">workgroup</code></span></dt><dd><p>Имя домена или рабочей группы NT для компьютеров,
		которые будут получать доступ к этому серверу.</p></dd><dt><span class="term"><code class="literal">netbios name</code></span></dt><dd><a id="idp98671440" class="indexterm"></a><p>Устанавливает имя NetBIOS, под которым будет
		работать <span class="application">Samba</span> сервер.  По
		умолчанию оно устанавливается
		равным первому компоненту DNS имени хоста.</p></dd><dt><span class="term"><code class="literal">server string</code></span></dt><dd><p>Устанавливает строку, которая будет показана командой
		<code class="command">net view</code> и некоторыми другими сетевыми
		инструментами, которые отображают строку описания
		сервера.</p></dd></dl></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98675280"></a>25.8.2.3. Настройки безопасности</h4></div></div></div><p>Две из наиболее важных настроек в
	  <code class="filename">/usr/local/etc/smb.conf</code> отвечают за
	  выбор модели безопасности и за формат паролей для
	  клиентов.  Эти параметры контролируются следующими
	  директивами:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">security</code></span></dt><dd><p>Два наиболее часто используемых параметра это
		<code class="literal">security = share</code> и <code class="literal">security
		= user</code>.  Если имена пользователей для клиентов
		совпадают с их именами на компьютере FreeBSD, вы возможно
		захотите включить безопасность уровня пользователя (user).
		Это политика безопасности по умолчанию, она требует,
		чтобы клиент авторизовался перед доступом к совместно
		используемым ресурсам.</p><p>На уровне безопасности share клиенту не требуется
		входить на сервер перед подключением к ресурсу.
		Эта модель безопасности использовалась по умолчанию
		в старых версиях <span class="application">Samba</span>.</p></dd><dt><span class="term"><code class="literal">passdb backend</code></span></dt><dd><a id="idp98685392" class="indexterm"></a><a id="idp98685904" class="indexterm"></a><a id="idp98686416" class="indexterm"></a><p><span class="application">Samba</span> поддерживает
		несколько различных подсистем аутентификации.  Вы можете
		аутентифицировать клиентов с помощью LDAP, NIS+,
		базы данных SQL, или через модифицированный файл
		паролей.  Метод аутентификации по умолчанию
		<code class="literal">smbpasswd</code>, и здесь рассматривается
		только он.</p></dd></dl></div><p>Предполагая, что используется подсистема по умолчанию
	  <code class="literal">smbpasswd</code>, необходимо создать файл
	  <code class="filename">/usr/local/etc/samba/smbpasswd</code>, чтобы
	  <span class="application">Samba</span> могла аутентифицировать
	  клиентов.  Если вы хотите разрешить к учетным записям
	  <span class="trademark">UNIX</span>(R) доступ с <span class="trademark">Windows</span>(R) клиентов, используйте следующую
	  команду:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>smbpasswd -a username</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ныне рекомендуемой подсистемой аутентификации является
	    <code class="literal">tdbsam</code>, поэтому для добавления пользователей
	    используйте следующую команду:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pdbedit -a -u <em class="replaceable"><code>username</code></em></code></strong></pre></div><p>Пожалуйста, обратитесь к <a class="link" href="http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/" target="_top">Official Samba HOWTO</a>
	  за дополнительной информацией о параметрах настройки.
	  Основные настройки, рассмотренные здесь, достаточны для
	  первого запуска <span class="application">Samba</span>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp98699856"></a>25.8.3. Запуск <span class="application">Samba</span></h3></div></div></div><p>Порт <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/samba34/pkg-descr">net/samba34</a> добавляет
	новый стартовый сценарий, который может быть использован для контроля
	<span class="application">Samba</span>.  Для того, чтобы им можно было
	запускать, останавливать или перезапускать сервер
	<span class="application">Samba</span>, добавьте следующую запись
	в файл <code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">samba_enable="YES"</pre><p>Или, для более тонкого контроля:</p><pre class="programlisting">nmbd_enable="YES"</pre><pre class="programlisting">smbd_enable="YES"</pre><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Внесение этих записей в <code class="filename">/etc/rc.conf</code>
	  также обеспечит автоматический запуск сервера
	  <span class="application">Samba</span> во время старта системы.</p></div><p>Теперь становится возможным запустить сервер
	<span class="application">Samba</span>, для чего наберите следующую
	команду:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/usr/local/etc/rc.d/samba start</code></strong>
Starting SAMBA: removing stale tdbs :
Starting nmbd.
Starting smbd.</pre><p>За дальнейшей информацией об использовании rc скриптов
	обратитесь к <a class="xref" href="configtuning-rcd.html" title="12.7. Использование rc во FreeBSD 5.X и последующих версиях">Раздел 12.7, <<Использование rc во FreeBSD 5.X и последующих версиях>></a>.</p><p><span class="application">Samba</span> состоит из трех
	отдельных даемонов.  Вы можете видеть, что
	<span class="application">nmbd</span> и <span class="application">smbd</span>
	запускаются скриптом <code class="filename">samba</code>.
	Если вы включили сервис разрешения имен winbind
	в <code class="filename">smb.conf</code>, то увидите также
	запуск даемона <span class="application">winbindd</span>.</p><p>Вы можете остановить <span class="application">Samba</span> в любой
	момент, набрав:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/usr/local/etc/rc.d/samba stop</code></strong></pre><p><span class="application">Samba</span> это сложный программный
	набор с функциональностью, позволяющей полную интеграцию в сети
	<span class="trademark">Microsoft</span>(R) <span class="trademark">Windows</span>(R).  За дальнейшей информацией о функциях,
	выходящих за рамки описанной здесь базовой установки,
	обращайтесь к <code class="uri"><a class="uri" href="http://www.samba.org" target="_top">http://www.samba.org</a></code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-apache.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="network-servers.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="network-ftp.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">25.7. Apache HTTP сервер </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 25.9. Протокол передачи файлов (FTP)</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>