<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>15.8. Модуль MAC portacl</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD" /><link rel="up" href="mac.html" title="Глава 15. Принудительный контроль доступа (MAC)" /><link rel="prev" href="mac-ifoff.html" title="15.7. Модуль MAC ifoff" /><link rel="next" href="mac-labelingpolicies.html" title="15.9. Политики MAC, использующие метки" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.8. Модуль MAC portacl</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mac-ifoff.html">Пред.</a> </td><th width="60%" align="center">Глава 15. Принудительный контроль доступа (MAC)</th><td width="20%" align="right"> <a accesskey="n" href="mac-labelingpolicies.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mac-portacl"></a>15.8. Модуль MAC portacl</h2></div></div></div><a id="idp90083920" class="indexterm"></a><p>Имя модуля: <code class="filename">mac_portacl.ko</code></p><p>Строка конфигурации ядра:
      <code class="literal">MAC_PORTACL</code></p><p>Параметр загрузки: <code class="literal">mac_portacl_load="YES"</code></p><p>Модуль <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">mac_portacl</span>(4)</span></a> используется для ограничения привязки
      (binding) к локальным портам <acronym class="acronym">TCP</acronym> и
      <acronym class="acronym">UDP</acronym>, используя различные переменные
      <code class="command">sysctl</code>.  По сути <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">mac_portacl</span>(4)</span></a>
      делает возможной привязку к привилегированным портам, т.е. к портам
      с номерами меньше 1024 для не-<code class="systemitem">root</code>
      пользователей.</p><p>После загрузки этот модуль включит политику <acronym class="acronym">MAC</acronym>
      на всех сокетах.  Доступны следующие переменные
      <code class="command">sysctl</code>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">security.mac.portacl.enabled</code>
	  включает/отключает политику целиком.
	  <a href="#ftn.idp90092496" class="footnote" id="idp90092496"><sup class="footnote">[8]</sup></a></p></li><li class="listitem"><p><code class="literal">security.mac.portacl.port_high</code>
	  установит наибольший номер порта, для которого
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">mac_portacl</span>(4)</span></a> включает защиту.</p></li><li class="listitem"><p><code class="literal">security.mac.portacl.suser_exempt</code>,
	  если установлена в ненулевое значение, исключает пользователя
	  <code class="systemitem">root</code> из этой политики.</p></li><li class="listitem"><p><code class="literal">security.mac.portacl.rules</code>
	  задает действующую политику mac_portacl: см. ниже.</p></li></ul></div><p>Действующая политика <code class="literal">mac_portacl</code>,
      указанная в <code class="literal">security.mac.portacl.rules</code>,
      это текстовая строка в форме <code class="literal">rule[,rule,...]</code>
      с таким количеством правил, которое требуется.  Каждое правило
      задается в формате:
      <code class="literal">idtype:id:protocol:port</code>.  Параметр
      <em class="parameter"><code>idtype</code></em> может принимать значения
      <code class="literal">uid</code> или <code class="literal">gid</code> и используется
      для интерпретации параметра <em class="parameter"><code>id</code></em>,
      в качестве id пользователя или группы соответственно.
      Параметр <em class="parameter"><code>protocol</code></em> используется для
      определения применимости этого правила к протоколу
      <acronym class="acronym">TCP</acronym> или <acronym class="acronym">UDP</acronym>, он может
      принимать значения <code class="literal">tcp</code> или
      <code class="literal">udp</code>.  Последний параметр,
      <em class="parameter"><code>port</code></em>, задает номер порта, к которому
      разрешается привязка указанного пользователя или группы.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Поскольку набор правил интерпретируется непосредственно
	ядром, для ID пользователя, группы и номера порта могут быть
	использованы только числовые значения.  Т.е. имена пользователей,
	групп и сервисов портов не могут быть использованы.</p></div><p>По умолчанию в <span class="trademark">UNIX</span>(R)-подобных системах порты с номерами
      менее чем 1024 могут быть использованы только привилегированными
      процессами, т.е. теми, что запущены от <code class="systemitem">root</code>.
      С <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">mac_portacl</span>(4)</span></a> для разрешения привязки непривилегированных
      процессов к портам с номерами ниже 1024 эти стандартные ограничения
      <span class="trademark">UNIX</span>(R) должны быть отменены.  Это может быть выполнено путем
      установки переменных <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span></a>
      <code class="literal">net.inet.ip.portrange.reservedlow</code> и
      <code class="literal">net.inet.ip.portrange.reservedhigh</code>
      в ноль.</p><p>Обратитесь к примерам ниже или к странице справочника
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">mac_portacl</span>(4)</span></a> за дальнейшей информацией.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90114896"></a>15.8.1. Примеры</h3></div></div></div><p>Следующие примеры должны осветить обсуждение выше чуть
	лучше:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl security.mac.portacl.port_high=1023</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sysctl net.inet.ip.portrange.reservedlow=0 net.inet.ip.portrange.reservedhigh=0</code></strong></pre><p>Сначала мы настраиваем <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">mac_portacl</span>(4)</span></a> для работы со
	стандартными привилегированными портами и отмены обычных
	ограничений <span class="trademark">UNIX</span>(R) на привязку.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl security.mac.portacl.suser_exempt=1</code></strong></pre><p>Пользователь <code class="systemitem">root</code> должен быть исключен
	из этой политики, для этого переменная
	<code class="literal">security.mac.portacl.suser_exempt</code>
	установлена в ненулевое значение.  Модуль <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">mac_portacl</span>(4)</span></a>
	теперь настроен на то поведение <span class="trademark">UNIX</span>(R)-подобных систем по
	умолчанию.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl security.mac.portacl.rules=uid:80:tcp:80</code></strong></pre><p>Разрешает пользователю с <acronym class="acronym">UID</acronym> 80 (обычно
	это пользователь <code class="systemitem">www</code>) привязку к порту 80.
	Теперь пользователь <code class="systemitem">www</code> сможет запустить
	веб сервер даже без привилегии <code class="systemitem">root</code>.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl security.mac.portacl.rules=uid:1001:tcp:110,uid:1001:tcp:995</code></strong></pre><p>Разрешит пользователю с <acronym class="acronym">UID</acronym>
	1001 привязку к <acronym class="acronym">TCP</acronym> портам 110
	(<span class="quote"><<<span class="quote">pop3</span>>></span>) и 995 (<span class="quote"><<<span class="quote">pop3s</span>>></span>).
	Это позволит данному пользователю запустить сервер, принимающий
	соединения на портах 110 и 995.</p></div><div class="footnotes"><br /><hr class="footnote-hr" /><div id="ftn.idp90092496" class="footnote"><p><a href="#idp90092496" class="para"><sup class="para">[8] </sup></a>Вследствие ошибки
	  переменная <code class="command">sysctl</code>
	  <code class="literal">security.mac.portacl.enabled</code> не будет работать
	  в  FreeBSD 5.2.1 или более ранних релизах.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mac-ifoff.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="mac.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="mac-labelingpolicies.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">15.7. Модуль MAC ifoff </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 15.9. Политики MAC, использующие метки</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>