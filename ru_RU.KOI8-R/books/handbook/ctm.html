<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>A.3. Использование CTM</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD" /><link rel="up" href="mirrors.html" title="Приложение A. Получение FreeBSD" /><link rel="prev" href="mirrors-ftp.html" title="A.2. FTP сайты" /><link rel="next" href="svn.html" title="A.4. Использование Subversion" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">A.3. Использование CTM</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mirrors-ftp.html">Пред.</a> </td><th width="60%" align="center">Приложение A. Получение FreeBSD</th><td width="20%" align="right"> <a accesskey="n" href="svn.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="ctm"></a>A.3. Использование CTM</h2></div></div></div><a id="idp101602256" class="indexterm"></a><p><span class="application">CTM</span> это метод синхронизации
      удаленного дерева каталогов с центральным.  Он встроен во FreeBSD и
      может использоваться для синхронизации системы с репозиториями
      исходных текстов FreeBSD.  Он поддерживает синхронизацию всего
      репозитория или только заданного набора ветвей.</p><p><span class="application">CTM</span> создан специально для
      использования в условиях некачественного соединения по TCP/IP
      или его отсутствия и предоставляет возможность автоматической
      отправки изменений по электронной почте.  Пользователю требуется
      загружать до трех изменений в день для наиболее активных ветвей.
      Размеры обновлений всегда поддерживаются настолько малыми,
      насколько это возможно, и обычно составляют меньше 5 Кб.
      Примерно на каждое десятое приходится по 10-50 Кб, и иногда
      случаются обновления больше 100 Кб.</p><p>При использовании <span class="application">CTM</span> для
      отслеживания процесса разработки FreeBSD требуется учитывать
      особенности в работе напрямую с исходных текстов, находящихся в
      разработке, по сравнению с использованием готовых релизов.  Эти
      вопросы рассматриваются в разделе <a class="link" href="current-stable.html" title="21.4. Использование ветви разработки">Использование ветви
	разработки</a>.</p><p>Cуществует немного документации по процессу создания
      дельта-файлов (delta, разница между имеющимися и актуальными
      исходными текстами) или использованию
      <span class="application">CTM</span> в других целях.  Обратитесь в
      список рассылки <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-users" target="_top">ctm-users</a> для получения ответов на
      вопросы по использованию <span class="application">CTM</span>.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mirrors-ctm"></a>A.3.1. Получение дельта-файлов</h3></div></div></div><p><span class="quote"><<<span class="quote">Дельта-файлы</span>>></span> для использования в
	<span class="application">CTM</span> можно получить двумя способами:
	через анонимный <acronym class="acronym">FTP</acronym> или по электронной
	почте.</p><p>Дельта-файлы по <acronym class="acronym">FTP</acronym> можно получить со
	следующих сайтов зеркал.  При использовании анонимного
	<acronym class="acronym">FTP</acronym> для получения дельта-файлов
	<span class="application">CTM</span> выберите географически
	ближайшее зеркало.  По случаю возникновения проблем сообщайте
	в список рассылки <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-users" target="_top">ctm-users</a>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">США, Калифорния, Bay Area, официальный источник</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/" target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/</a></code></p></li></ul></div></dd><dt><span class="term">Южная Африка, запасной сервер для старых дельт</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/" target="_top">ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/</a></code></p></li></ul></div></dd><dt><span class="term">Тайвань/R.O.C.</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li></ul></div></dd></dl></div><p>Для получения дельта-файлов по почте подпишитесь на один
	из списков распространения <code class="literal">ctm-src</code>,
	доступных на <code class="uri"><a class="uri" href="http://lists.freebsd.org/mailman/listinfo" target="_top">http://lists.freebsd.org/mailman/listinfo</a></code>.
	Например, <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-src-cur" target="_top">ctm-src-cur</a> поддерживает главную ветвь
	разработки, а <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-src-9" target="_top">ctm-src-9</a> поддерживает ветвь выпуска
	релизов 9.X.</p><p>Как только вы получаете обновления
	<span class="application">CTM</span> по почте, используйте программу
	<code class="command">ctm_rmail</code> для их распаковки и применения.
	Эта программа может выполняться непосредственно из записи в
	<code class="filename">/etc/aliases</code> для автоматизации процесса.
	Обращайтесь к странице справочника <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ctm_rmail&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ctm_rmail</span>(1)</span></a> для
	получения дополнительной информации.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Вне зависимости от способа получения дельта-файлов,
	  пользователям <span class="application">CTM</span> следует
	  подписаться на список рассылки <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-announce" target="_top">ctm-announce</a>,
	  поскольку это единственный механизм публикации объявлений
	  <span class="application">CTM</span>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp101646416"></a>A.3.2. Использование <span class="application">CTM</span></h3></div></div></div><p>Перед началом использования дельта-файлов
	<span class="application">CTM</span> потребуется определить
	исходную точку для последующего их применения.</p><p>Один из способов состоит в применении
	<span class="quote"><<<span class="quote">стартового</span>>></span> дельта-файла к пустому каталогу.
	В имени такого файла присутствует <code class="literal">Xempty</code>,
	например, <code class="filename">src-cur.3210XEmpty.gz</code>.
	Обозначение перед <code class="literal">X</code> соответствует
	происхождению первоначального источника.
	<code class="filename">Empty</code> означает пустой каталог.  Как
	правило, файл с <code class="literal">Empty</code> создается через
	каждые 100 дельта-файлов.  Обратите внимание, что стартовые
	дельта-файлы имеют большой размер, и от 70 до 80 мегабайт
	сжатых в <code class="command">gzip</code> данных для
	<code class="filename">XEmpty</code> является обычным делом.</p><p>Другой способ заключается в получении первоначального
	источника с -RELEASE CD.  Это может существенно снизить объём
	передаваемых данных по сети.</p><p>Когда основной дельта-файл создан, примените все
	дельта-файлы с последующими номерами.  Чтобы применить
	дельта-файлы:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /directory/to/store/the/stuff</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ctm -v -v /directory/which/stores/the/deltas/src-xxx.*</code></strong></pre><p>Можно применять несколько дельт одной командой, по
	мере их последовательной обработки уже применённые дельты
	игнорируются.  <span class="application">CTM</span> работает с
	дельта-файлами, сжатыми с помощью <code class="command">gzip</code>,
	что позволяет сэкономить на используемом дисковом
	пространстве.</p><p>Для проверки дельта-файла без его применения используйте
	параметр командной строки <code class="option">-c</code>.
	<span class="application">CTM</span> не будет модифицировать
	локальное дерево, а только проверит целостность дельта-файла
	на предмет его применимости без ошибок.  Обращайтесь к
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ctm&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ctm</span>(1)</span></a> для получения дополнительной информации по
	имеющимся параметрам и понимания процесса применения дельт,
	который используется в <span class="application">CTM</span>.</p><p>Для поддержания исходных текстов в актуальном состоянии
	каждый раз, когда становится доступна новая дельта, применяйте
	её с использованием <span class="application">CTM</span>.</p><p>Рекомендуется не удалять дельты после применения, если их
	сложно загрузить повторно.  В этом случае будет доступна
	локальная копия, которая может понадобиться при восстановлении
	после сбоя.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp101667152"></a>A.3.3. Сохранение локальных изменений</h3></div></div></div><p>Разработчики часто экспериментируют и изменяют файлы в
	локальном дереве исходных текстов.
	<span class="application">CTM</span> имеет ограниченную поддержку
	локальных изменений: перед проверкой наличия файла сначала
	проверяется файл тем же именем и расширением
	<code class="filename">.ctm</code>.  Если такой файл присутствует,
	<span class="application">CTM</span> будет работать с ним вместо
	исходного файла.</p><p>Такое поведение обеспечивает простой путь поддержки
	локальных изменений.  Перед изменением файла скопируйте его с
	расширением <code class="filename">.ctm</code>.  Вносите любые
	изменения в исходный файл, зная что
	<span class="application">CTM</span> будет применять обновления
	только к файлу с расширением <code class="filename">.ctm</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp101671120"></a>A.3.4. Другие возможности
	<span class="application">CTM</span></h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Определение файлов, которые будут затронуты
	    обновлением</span></dt><dd><p>Для определения списка изменений, которые
	      <span class="application">CTM</span> внесет в локальный
	      репозиторий исходных текстов, используйте параметр
	      <code class="option">-l</code>.  Этот параметр используется для
	      записи лога изменений или выполнения предварительной
	      или последующей обработки какого-либо подмножества
	      изменяемых файлов.</p></dd><dt><span class="term">Создание резервных копий перед обновлением</span></dt><dd><p>Для создания резервной копии всех файлов, которые
	      будут изменены обновлением
	      <span class="application">CTM</span>, укажите параметр
	      <code class="option">-B
		<em class="replaceable"><code>backup-file</code></em></code>.  С
	      этим параметром <span class="application">CTM</span> выполняет
	      сохранение в <code class="filename">backup-file</code> всех
	      файлов, которые затрагиваются применяемыми дельтами
	      <span class="application">CTM</span>.</p></dd><dt><span class="term">Ограничение обновлений для определенных файлов</span></dt><dd><p>Для ограничения набора файлов, обновляемых
	      <span class="application">CTM</span>, или для извлечения лишь
	      нескольких файлов из последовательности дельт можно
	      указать фильтрующие регулярные выражения с
	      использованием <code class="option">-e</code>, который указывает,
	      какие файлы обрабатывать, или <code class="option">-x</code>,
	      который указывает, какие файлы игнорировать.</p><p>Пример извлечения свежей копии
	      <code class="filename">lib/libc/Makefile</code> из коллекции
	      сохраненных дельт <span class="application">CTM</span>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /directory/to/extract/to/</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ctm -e '^lib/libc/Makefile' /directory/which/stores/the/deltas/src-xxx.*</code></strong></pre><p>Для каждого файла, указанного в
	      <span class="application">CTM</span> дельте, параметры
	      <code class="option">-e</code> и <code class="option">-x</code> применяются в
	      порядке их задания в командной строке.  Файл
	      обрабатывается <span class="application">CTM</span>, только
	      если он помечается как подходящий после обработки всех
	      параметров <code class="option">-e</code> и
	      <code class="option">-x</code>.</p></dd></dl></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mirrors-ftp.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="mirrors.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="svn.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">A.2. <acronym class="acronym">FTP</acronym> сайты </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> A.4. Использование <span class="application">Subversion</span></td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>