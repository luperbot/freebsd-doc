<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>4.6. Организация дисков</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD" /><link rel="up" href="basics.html" title="Глава 4. Основы UNIX" /><link rel="prev" href="dirstructure.html" title="4.5. Структура каталогов" /><link rel="next" href="mount-unmount.html" title="4.7. Монтирование и размонтирование файловых систем" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4.6. Организация дисков</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="dirstructure.html">Пред.</a> </td><th width="60%" align="center">Глава 4. Основы UNIX</th><td width="20%" align="right"> <a accesskey="n" href="mount-unmount.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="disk-organization"></a>4.6. Организация дисков</h2></div></div></div><p>Наименьшая единица, которую FreeBSD использует для обращения
	к файлам, это имя файла.  Имена файлов чувствительны к регистру,
	поэтому <code class="filename">readme.txt</code> и <code class="filename">README.TXT
	</code> - два разных файла.  FreeBSD не использует
	расширение файла (<code class="filename">.txt</code>) для определения
	программа это, документ или другой тип данных.</p><p>Файлы хранятся в каталогах.  Каталоги могут не содержать файлов,
	или могут содержать много сотен файлов.  Каталоги также могут
	содержать другие каталоги, что позволяет создавать иерархию каталогов
	один в другом.  Это упрощает организацию данных.</p><p>Обращение к файлам происходит путем задания имени файла или
	каталога, дополняемого прямым слэшем <code class="literal">/</code>, за которым
	может следовать имя другого каталога.  Если есть каталог
	<code class="filename">foo</code>, содержащий каталог
	<code class="filename">bar</code>, который содержит файл
	<code class="filename">readme.txt</code>, полное имя, или
	<em class="firstterm">путь</em> к файлу будет
	<code class="filename">foo/bar/readme.txt</code>.</p><p>Каталоги и файлы хранятся в файловой системе.  Каждая файловая система
	содержит один каталог на верхнем уровне, называемый
	<em class="firstterm">корневым каталогом</em> этой файловой системы.
	Этот корневой каталог может содержать другие каталоги.</p><p>Внешне это может быть похоже на те операционные системы,
	которые вы возможно использовали.  Есть несколько отличий:
	например, <span class="trademark">MS-DOS</span>(R) использует <code class="literal">\</code> для разделения имен
	файлов и каталогов, а <span class="trademark">Mac OS</span>(R) использует <code class="literal">:</code>.</p><p>FreeBSD не использует букв дисков, или других имен дисков в
	пути.  Вам не нужно писать <code class="filename">c:/foo/bar/readme.txt</code>
	в FreeBSD.</p><p>Вместо этого, одна файловая система назначается <em class="firstterm">корневой
	файловой системой</em>.  Обращение к корневому каталогу
	корневой файловой системы происходит через <code class="literal">/</code>.
	Любая другая файловая система <em class="firstterm">монтируется</em>
	к корневой файловой системе.  Неважно как много дисков есть в вашей
	системе FreeBSD, каждый каталог будет выглядеть как расположенный
	на том же диске.</p><p>Предположим, у вас есть три файловых системы: <code class="literal">A</code>,
	<code class="literal">B</code>, и <code class="literal">C</code>.  Каждая файловая
	система имеет один корневой каталог, в котором содержатся другие
	каталоги, называемые
	<code class="literal">A1</code>, <code class="literal">A2</code> (и аналогично
	<code class="literal">B1</code>, <code class="literal">B2</code> и
	<code class="literal">C1</code>, <code class="literal">C2</code>).</p><p>Назовем <code class="literal">A</code> корневой файловой системой.
	Если вы используете команду <code class="command">ls</code> для просмотра
	содержимого каталога, вы увидите два подкаталога, <code class="literal">A1</code>
	и <code class="literal">A2</code>.  Дерево каталогов выглядит так:</p><div class="mediaobject"><img src="install/example-dir1.png" /></div><p>Файловая система должна быть подмонтирована к каталогу другой
	файловой системы.  Предположим, что вы монтируете файловую систему
	<code class="literal">B</code> на каталог <code class="literal">A1</code>.  Корневой
	каталог <code class="literal">B</code> замещается <code class="literal">A1</code>,
	а каталоги в <code class="literal">B</code> отображаются соответственно:</p><div class="mediaobject"><img src="install/example-dir2.png" /></div><p>Если потребуется, любые файлы из каталогов <code class="literal">B1</code> или
	<code class="literal">B2</code> могут быть получены через путь
	<code class="filename">/A1/B1</code> или <code class="filename">/A1/B2</code>.
	Все файлы, бывшие в <code class="filename">/A1</code>, временно скрыты.
	Они появятся, если <code class="literal">B</code> будет
	<em class="firstterm">размонтирована</em> с A.</p><p>Если <code class="literal">B</code> была смонтирована на <code class="literal">A2,
	</code> диаграмма будет выглядеть так:</p><div class="mediaobject"><img src="install/example-dir3.png" /></div><p>а пути будут <code class="filename">/A2/B1</code> и
	<code class="filename">/A2/B2</code> соответственно.</p><p>Файловые системы могут быть смонтированы одна на другую.
	Продолжая предыдущий пример, файловая система <code class="literal">C</code>
	может быть смонтирована на каталог <code class="literal">B1</code> файловой
	системы <code class="literal">B</code> в таком порядке:</p><div class="mediaobject"><img src="install/example-dir4.png" /></div><p>Или <code class="literal">C</code> может быть смонтирована прямо на
	файловую систему <code class="literal">A</code>, на каталог <code class="literal">A1
	</code>:</p><div class="mediaobject"><img src="install/example-dir5.png" /></div><p>Если вы знакомы с <span class="trademark">MS-DOS</span>(R), это похоже, хотя и не идентично,
	команде <code class="command">join</code>.</p><p>Как правило, это не должно вас интересовать.  Обычно вы создаете
	файловые системы во время установки FreeBSD, решаете куда их
	монтировать, и ничего не меняете, пока не понадобится добавить новый
	диск.</p><p>Можно создать одну большую корневую файловую систему и не
	создавать других.  У такого подхода есть несколько
	недостатков и одно преимущество.</p><div class="itemizedlist"><div class="itemizedlist-title">Преимущества нескольких файловых систем</div><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Различные файловые системы могут иметь различные
	    <em class="firstterm">опции монтирования</em>.  Например,
	    в целях безопасности корневая файловая система может
	    быть смонтирована только для чтения, что делает
	    невозможным случайное удаление или редактирование
	    критически важного файла.  Отделение файловых систем,
	    используемых пользователями для записи, таких как
	    <code class="filename">/home</code>, от других файловых
	    систем позволяет также монтировать их с параметром
	    <em class="firstterm">nosuid</em>; этот параметр отменяет
	    действие битов <em class="firstterm">suid</em>/
	    <em class="firstterm">guid</em> на исполняемых файлах,
	    в этой файловой системе, что потенциально повышает
	    безопасность.</p></li><li class="listitem"><p>FreeBSD автоматически оптимизирует расположение файлов на
	    файловой системе в зависимости от того, как файловая система
	    используется.  Файловая система, содержащая множество мелких часто
	    записываемых файлов, будет иметь оптимизацию, отличную от таковой
	    для файловой системы, содержащей несколько больших файлов.
	    На одной большой файловой системе эта оптимизация не
	    работает.</p></li><li class="listitem"><p>Файловые системы FreeBSD очень устойчивы к внезапному
	    отключению.  Тем не менее, потеря питания в критический момент
	    все же может повредить структуру файловой системы.  Разделение
	    данных на несколько файловых систем повышает шансы, что система
	    все-таки будет работать и делает более легким восстановление с
	    резервной копии.</p></li></ul></div><div class="itemizedlist"><div class="itemizedlist-title">Преимущество одной файловой системы</div><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Размер файловых систем фиксирован.  Если вы создаете файловую
	    систему при установке FreeBSD и задаете определенный размер,
	    позднее вы можете обнаружить что нужен раздел большего размера.
	    Это не так легко сделать без резервного копирования, создания
	    файловых систем нового размера и последующего восстановления
	    сохраненных данных.</p><div xmlns="" class="important"><h3 class="admontitle">Важно: </h3><p xmlns="http://www.w3.org/1999/xhtml">В FreeBSD представлена команда
	      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=growfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">growfs</span>(8)</span></a>, которая позволяет увеличивать размер
	      файловой системы на лету, устраняя это ограничение.</p></div></li></ul></div><p>Файловые системы содержатся в разделах.  Этот термин не имеет
	того же смысла, что и при более раннем его использовании в этой главе,
	из-за наследия <span class="trademark">UNIX</span>(R) в FreeBSD.  Каждый раздел обозначается буквой
	от <code class="literal">a</code> до <code class="literal">h</code>.  Каждый раздел может
	содержать только одну файловую систему, это значит что файловая система
	может быть описана ее точкой монтирования в файловой иерархии,
	или буквой раздела, в котором она содержится.</p><p>FreeBSD также использует дисковое пространство под
	<em class="firstterm">раздел подкачки (swap space)</em>.  Подкачка позволяет
	FreeBSD	работать с <em class="firstterm">виртуальной памятью</em>.
	Ваш компьютер может работать так, как если бы у него было больше
	памяти,	чем есть на самом деле.  Когда у FreeBSD кончается память, она
	перемещает часть данных, не используемых в данный момент, в раздел
	подкачки и возвращает их обратно (перемещая в подкачку что-то другое),
	когда они нужны.</p><p>По некоторым разделам есть определенные соглашения.</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Раздел</th><th>Соглашение</th></tr></thead><tbody valign="top"><tr><td valign="top"><code class="literal">a</code></td><td valign="top">Как правило, содержит корневую файловую систему</td></tr><tr><td valign="top"><code class="literal">b</code></td><td valign="top">Как правило, содержит раздел подкачки</td></tr><tr><td valign="top"><code class="literal">c</code></td><td valign="top">Как правило, такого же размера, что и весь слайс (slice).
		Это позволяет утилитам, которым нужно работать над всем
		слайсом (например, сканер плохих блоков), работать с
		разделом <code class="literal">c</code>.  В обычной ситуации не нужно
		создавать файловую систему на этом разделе.</td></tr><tr><td valign="top"><code class="literal">d</code></td><td valign="top">Раздел <code class="literal">d</code> создавался для специальных
		целей, хотя сейчас они не актуальны и <code class="literal">d</code>
		может быть задействован как обычный раздел.</td></tr></tbody></table></div><p>Каждый раздел-содержащий-файловую-систему хранится на том, что
	во FreeBSD называется <em class="firstterm">слайс (slice)</em>.  Слайс
	- это термин FreeBSD, то, что обычно называют разделом,
	и опять же это из-за <span class="trademark">UNIX</span>(R) основы FreeBSD.  Слайсы нумеруются с 1 по
	4.</p><a id="idp79417936" class="indexterm"></a><a id="idp79418448" class="indexterm"></a><a id="idp79418960" class="indexterm"></a><p>Номера слайсов следуют за именем устройства, предваряемые
	строчной <code class="literal">s</code>, начиная с 1.  Так
	<span class="quote"><<<span class="quote">da0<span class="emphasis"><em>s1</em></span></span>>></span> это первый слайс первого
	SCSI устройства.  Может быть только четыре физических слайса на диске,
	но могут быть логические слайсы нужного типа внутри физических
	слайсов.  Эти дополнительные
	слайсы нумеруются начиная с 5, так что
	<span class="quote"><<<span class="quote">ad0<span class="emphasis"><em>s5</em></span></span>>></span> это первый дополнительный
	слайс на первом IDE диске.  Эти устройства используются файловыми
	системами, занимающими весь слайс.</p><p>Слайсы, <span class="quote"><<<span class="quote">эксклюзивно выделенные (dangerously dedicated)</span>>></span> физические устройства
	и другие устройства содержат <em class="firstterm">разделы</em>,
	представляемые буквами от <code class="literal">a</code> до <code class="literal">h</code>.
	Эти буквы добавляются к имени устройства.
	<span class="quote"><<<span class="quote">da0<span class="emphasis"><em>a</em></span></span>>></span> это раздел a на первом
	устройстве da, который <span class="quote"><<<span class="quote">эксклюзивно выделен</span>>></span>.
	<span class="quote"><<<span class="quote">ad1s3<span class="emphasis"><em>e</em></span></span>>></span> это пятый раздел
	в третьем слайсе второго IDE диска.</p><p>Наконец, каждый диск идентифицирован.  Имя диска начинается с
	кода, обозначающего тип диска, затем идет номер диска.
	В отличие от слайсов, нумерация дисков начинается
	с 0.  Основные коды, которые вам могут встретиться, есть в
	<a class="xref" href="disk-organization.html#basics-dev-codes" title="Таблица 4.2. Коды дисковых устройств">Таблица 4.2, <<Коды дисковых устройств>></a>.</p><p>В то время, как ссылка на раздел FreeBSD требует также указания
	слайса и диска, содержащего раздел, ссылка на слайс требует также
	указания имени диска.  Другими словами, ссылаясь на раздел,
	указывайте имя диска, <code class="literal">s</code>, номер слайса, и затем
	букву раздела.  Примеры показаны в
	<a class="xref" href="disk-organization.html#basics-disk-slice-part" title="Пример 4.12. Пример имен диска, слайса, и раздела">Пример 4.12, <<Пример имен диска, слайса, и раздела>></a>.</p><p><a class="xref" href="disk-organization.html#basics-concept-disk-model" title="Пример 4.13. Концептуальная модель диска">Пример 4.13, <<Концептуальная модель диска>></a> показывает
	концептуальную модель диска, которая должна помочь прояснить
	ситуацию.</p><p>Для установки FreeBSD вы должны сначала настроить слайсы
	дисков, затем создать разделы внутри слайсов, которые будут
	использованы для FreeBSD, а затем создать файловую систему
	(или подкачку) в каждом разделе и решить, куда файловая система
	будет смонтирована.</p><div class="table"><a id="basics-dev-codes"></a><div class="table-title">Таблица 4.2. Коды дисковых устройств</div><div class="table-contents"><table summary="Коды дисковых устройств" width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Код</th><th>Значение</th></tr></thead><tbody><tr><td><code class="filename">ad</code></td><td>ATAPI (IDE) диск</td></tr><tr><td><code class="filename">da</code></td><td>SCSI direct access диск</td></tr><tr><td><code class="filename">acd</code></td><td>ATAPI (IDE) CDROM</td></tr><tr><td><code class="filename">cd</code></td><td>SCSI CDROM</td></tr><tr><td><code class="filename">fd</code></td><td>Floppy disk</td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="basics-disk-slice-part"></a><div class="example-title">Пример 4.12. Пример имен диска, слайса, и раздела</div><div class="example-contents"><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Имя</th><th>Значение</th></tr></thead><tbody><tr><td><code class="literal">ad0s1a</code></td><td>Первый раздел (<code class="literal">a</code>) на первом слайсе
		  (<code class="literal">s1</code>) первого IDE диска
		  (<code class="literal">ad0</code>).</td></tr><tr><td><code class="literal">da1s2e</code></td><td>Пятый раздел (<code class="literal">e</code>) на
		  втором слайсе (<code class="literal">s2</code>) второго SCSI диска
		  (<code class="literal">da1</code>).</td></tr></tbody></table></div></div></div><br class="example-break" /><div class="example"><a id="basics-concept-disk-model"></a><div class="example-title">Пример 4.13. Концептуальная модель диска</div><div class="example-contents"><p>Эта диаграмма показывает первый подключенный к системе IDE диск
	  с точки зрения FreeBSD.  Предположим, что размер диска 4 GB, и он
	  содержит два 2 GB слайса (<span class="trademark">MS-DOS</span>(R) разделы).  Первый слайс содержит
	  <span class="trademark">MS-DOS</span>(R) диск, <code class="filename">C:</code>, а второй слайс содержит
	  установленную FreeBSD.  В этом примере у установленной FreeBSD
	  есть три раздела с данными и раздел подкачки.</p><p>В каждом из трех разделов есть файловая система.  Раздел
	  <code class="literal">a</code> используется для корневой файловой системы,
	  <code class="literal">e</code> для иерархии каталогов
	  <code class="filename">/var</code>, а <code class="literal">f</code> для иерархии
	  каталогов <code class="filename">/usr</code>.</p><div class="mediaobject"><img src="install/disk-layout.png" /></div></div></div><br class="example-break" /></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="dirstructure.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="basics.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="mount-unmount.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">4.5. Структура каталогов </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 4.7. Монтирование и размонтирование файловых систем</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>