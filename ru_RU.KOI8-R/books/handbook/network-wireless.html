<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>27.3. Беспроводные сети</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD" /><link rel="up" href="advanced-networking.html" title="Глава 27. Сложные вопросы работы в сети" /><link rel="prev" href="network-routing.html" title="27.2. Сетевые шлюзы и маршруты" /><link rel="next" href="network-bluetooth.html" title="27.4. Bluetooth" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">27.3. Беспроводные сети</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-routing.html">Пред.</a> </td><th width="60%" align="center">Глава 27. Сложные вопросы работы в сети</th><td width="20%" align="right"> <a accesskey="n" href="network-bluetooth.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-wireless"></a>27.3. Беспроводные сети</h2></div><div><span class="authorgroup">Текст предоставил <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Eric</span> <span class="surname">Anderson</span></span>. </span></div><div><span class="authorgroup">Перевёл на русский язык <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Андрей</span> <span class="surname">Захватов</span></span>. </span></div></div></div><a id="idp99784016" class="indexterm"></a><a id="idp99784784" class="indexterm"></a><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99785936"></a>27.3.1. Введение</h3></div></div></div><p>Было бы весьма полезным иметь возможность использовать компьютер
	без хлопот, связанных с постоянно подключенным сетевым кабелем.
	FreeBSD может использоваться как клиент беспроводной сети, и даже
	в качестве <span class="quote"><<<span class="quote">точки доступа</span>>></span> к ней.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99787600"></a>27.3.2. Режимы работы беспроводной связи</h3></div></div></div><p>Существуют два варианта конфигурации устройств беспроводного
	доступа 802.11: BSS и IBSS.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99788624"></a>27.3.2.1. Режим BSS</h4></div></div></div><p>Режим BSS является наиболее часто используемым.  Режим BSS также
	  называют режимом инфраструктуры.  В этом режиме несколько точек
	  доступа беспроводной сети подключаются к проводной сети передачи
	  данных.  Каждое беспроводная сеть имеет собственное имя.  Это имя
	  является идентификатором SSID сети.</p><p>Клиенты беспроводной сети подключаются к этим точкам доступа
	  беспроводной сети.  Стандарт IEEE 802.11 определяет протокол,
	  используемый для связи в беспроводных сетях.  Клиент сети
	  беспроводного доступа может подключаться к некоторой сети, если
	  задан её SSID.  Клиент может также подключаться к любой сети, если
	  SSID не задан.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99790160"></a>27.3.2.2. Режим IBSS</h4></div></div></div><p>Режим IBSS, также называемый ad-hoc, предназначен для соединений
	  точка-точка.  На самом деле существуют два типа режима ad-hoc.  Один
	  из них является режимом IBSS, называемый также режимом ad-hoc или
	  IEEE ad-hoc.  Этот режим определён стандартами IEEE 802.11.  Второй
	  режим называется демонстрационным режимом ad-hoc, или Lucent ad-hoc
	  (или, иногда неправильно, режимом ad-hoc).  Это старый,
	  существовавший до появления 802.11, режим ad-hoc, и он должен
	  использоваться только для старых сетей. В дальнейшем мы не будем
	  рассматривать ни один из режимов ad-hoc.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99791440"></a>27.3.3. Режим инфраструктуры</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99792080"></a>27.3.3.1. Точки доступа</h4></div></div></div><p>Точки доступа представляют собой беспроводные сетевые устройства,
	  позволяющие одному или большему количеству клиентов беспроводной сети
	  использовать эти устройства в качестве центрального сетевого
	  концентратора.  При использовании точки доступа все клиенты работают
	  через неё.  Зачастую используются несколько точек доступа для полного
	  покрытия беспроводной сетью некоторой зоны, такой, как дом, офис или
	  парк.</p><p>Точки доступа обычно имеют несколько подключений к сети: адаптер
	  беспроводной связи и один или большее количество сетевых
	  ethernet-адаптеров для подключения к остальной части сети.</p><p>Точки доступа могут быть либо приобретены уже настроенными, либо
	  вы можете создать собственную при помощи FreeBSD и поддерживаемого
	  адаптера беспроводной связи.  Несколько производителей выпускают
	  точки беспроводного доступа и адаптеры беспроводной связи с
	  различными возможностями.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99794000"></a>27.3.3.2. Построение точки доступа с FreeBSD</h4></div></div></div><a id="idp99794640" class="indexterm"></a><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99804112"></a>27.3.3.2.1. Требования</h5></div></div></div><p>Для того, чтобы создать беспроводную точку доступа на FreeBSD,
	    вам нужно иметь совместимый адаптер беспроводной связи.  На данный
	    момент поддерживаются адаптеры только на основе набора микросхем
	    Prism.  Вам также потребуется поддерживаемый FreeBSD адаптер
	    проводной сети (найти такой будет нетрудно, FreeBSD поддерживает
	    множество различных устройств).  В этом руководстве мы будем
	    полагать, что вы будете строить сетевой мост (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bridge&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bridge</span>(4)</span></a>) для
	    пропуска всего трафика между устройством беспроводной связи и
	    сетью, подключенной к обычному Ethernet-адаптеру.</p><p>Функциональность hostap, которая используется FreeBSD для
	    организации точки доступа, работает лучше всего с некоторыми
	    версиями микрокода.  Адаптеры Prism 2 должны использовать микрокод
	    версии 1.3.4 или более новый.  Адаптеры Prism 2.5 и Prism 3 должны
	    использовать микрокод версии 1.4.9.  Более старые версии микрокода
	    могут работать нормально, а могут и некорректно.  В настоящее время
	    единственным способом обновления адаптеров является использование
	    утилит обновления для <span class="trademark">Windows</span>(R), которые можно получить у
	    производителя ваших адаптеров.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99806928"></a>27.3.3.2.2. Настройка</h5></div></div></div><p>Первым делом убедитесь, что ваша система распознаёт адаптер
	    беспроводной связи:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig -a</code></strong>
wi0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        inet6 fe80::202:2dff:fe2d:c938%wi0 prefixlen 64 scopeid 0x7
        inet 0.0.0.0 netmask 0xff000000 broadcast 255.255.255.255
        ether 00:09:2d:2d:c9:50
        media: IEEE 802.11 Wireless Ethernet autoselect (DS/2Mbps)
        status: no carrier
        ssid ""
        stationname "FreeBSD Wireless node"
        channel 10 authmode OPEN powersavemode OFF powersavesleep 100
        wepmode OFF weptxkey 1</pre><p>На данном этапе не беспокойтесь о деталях, просто убедитесь,
	    что выдаётся нечто, указывающее на установленный адаптер
	    беспроводной связи.  Если при этом у вас есть проблемы с
	    недоступностью интерфейса беспроводной связи, и вы используете
	    PC Card, то обратитесь к страницам справочной системы, описывающим
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pccardc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pccardc</span>(8)</span></a> и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pccardd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pccardd</span>(8)</span></a> для получения более полной
	    информации.</p><p>Теперь вам нужно загрузить модуль для подготовки той части
	    FreeBSD, что отвечает за организацию сетевых мостов, для работы
	    с точкой доступа.  Для загрузки модуля <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bridge&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bridge</span>(4)</span></a> просто
	    выполните следующую команду:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kldload bridge</code></strong></pre><p>При загрузке модуля никаких сообщений об ошибках быть не
	    должно.  Если это всё же произошло, вам может потребоваться
	    вкомпилировать код для модуля <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bridge&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bridge</span>(4)</span></a> в ядро.  В этом вам
	    должен помочь раздел этого Руководства об <a class="link" href="network-bridging.html" title="27.5. Мосты">организации сетевых
	    мостов</a>.</p><p>Теперь, когда вы завершили с той частью, что касается
	    организации сетевого моста, нам нужно указать ядру FreeBSD, какие
	    интерфейсы должны объединяться в сетевом мосте.  Это мы делаем
	    при помощи <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span></a>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl net.link.ether.bridge.enable=1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sysctl net.link.ether.bridge.config="wi0 xl0"</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sysctl net.inet.ip.forwarding=1</code></strong></pre><p>В версиях FreeBSD, предшествующих 5.2, вместо указанных нужно
	    использовать следующие параметры:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl net.link.ether.bridge=1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sysctl net.link.ether.bridge_cfg="wi0,xl0"</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sysctl net.inet.ip.forwarding=1</code></strong></pre><p>Теперь необходимо настроить адаптер беспроводной сети.
	  Следующая команда заставит адаптер работать в режиме точки
	    доступа:</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>ifconfig wi0 ssid <em class="replaceable"><code>my_net</code></em> channel 11 media DS/11Mbps mediaopt hostap up stationname "<em class="replaceable"><code>FreeBSD AP</code></em>"</code></strong>
	  </pre><p>Строчка <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ifconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ifconfig</span>(8)</span></a> активизирует интерфейс
	    <code class="filename">wi0</code>, конфигурирует его SSID как
	    <em class="replaceable"><code>my_net</code></em>, а имя станции как
	    <em class="replaceable"><code>FreeBSD AP</code></em>.
	    <code class="option">media DS/11Mbps</code> переводит адаптер в
	    режим 11Mbps и нужен только для того, чтобы сработал параметр
	    <code class="option">mediaopt</code>.  Параметр <code class="option">mediaopt
	    hostap</code> переводит интерфейс в режим точки доступа.
	    Параметр <code class="option">channel 11</code> задаёт использование канала
	    802.11b.  Страница справки по команде <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=wicontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">wicontrol</span>(8)</span></a> перечисляет
	    корректные значения каналов для ваших нужд.</p><p>Теперь у вас должна получиться полнофункциональная работающая
	    точка доступа.  Настоятельно советуем прочесть страницы справочной
	    по <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=wicontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">wicontrol</span>(8)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ifconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ifconfig</span>(8)</span></a>, и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=wi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">wi</span>(4)</span></a> для
	    получения дополнительной информации.</p><p>Также полагаем, что вы прочтёте следующий раздел о
	    шифровании.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99835728"></a>27.3.3.2.3. Информация о состоянии</h5></div></div></div><p>После того, как точка доступа сконфигурирована и начала свою
	    работу, операторам может понадобиться видеть клиентов, связанных
	    с этой точкой.  В любой момент оператор может набрать:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>wicontrol -l</code></strong>
1 station:
00:09:b7:7b:9d:16  asid=04c0, flags=3&lt;ASSOC,AUTH&gt;, caps=1&lt;ESS&gt;, rates=f&lt;1M,2M,5.5M,11M&gt;, sig=38/15</pre><p>Это показывает, что имеется одна связанная станция с
	    перечисленными характеристиками.  Выдаваемое значение сигнала должно
	    использоваться только как сравнительный индикатор его силы.  Его
	    перевод в dBm или другие единицы измерения различаются в разных
	    версиях микрокода.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99838416"></a>27.3.3.3. Клиенты</h4></div></div></div><p>Клиент в беспроводной сети представляет собой систему, которая
	  обращается к точке доступа или непосредственно к другому
	  клиенту.</p><p>Как правило, клиенты беспроводной сети имеют только один сетевой
	  адаптер, а именно адаптер беспроводной сети.</p><p>Существует несколько различных способов конфигурации клиента
	  беспроводной сети.  Они основаны на различных режимах работы в
	  беспроводной сети, обычно BSS (режим инфраструктуры, который требует
	  точки доступа) или IBSS (ad-hoc или режим одноранговой сети).  В
	  нашем примере мы будем использовать самый популярный их них, режим
	  BSS, для связи с точкой доступа.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99840208"></a>27.3.3.3.1. Требования</h5></div></div></div><p>Существует только одно жёсткое условие для настройки FreeBSD в
	    качестве клиента беспроводной сети.  Вам нужен адаптер беспроводной
	    связи, поддерживаемый FreeBSD.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99845584"></a>27.3.3.3.2. Конфигурация FreeBSD как клиента беспроводной сети</h5></div></div></div><p>Перед тем, как подключиться к беспроводной сети, вам нужно
	    будет узнать о ней несколько вещей.  В этом примере мы подключаемся
	    к сети, которая называется <em class="replaceable"><code>my_net</code></em>,
	    и шифрование в ней отключено.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">В этом примере мы не используем шифрование, но
	    это небезопасно.  В следующем разделе вы узнаете, как её включить,
	    почему это так важно, и почему некоторые технологии шифрования всё
	    же не могут полностью обеспечить вашу информационную
	    безопасность.</p></div><p>Удостоверьтесь, что ваш адаптер распознаётся во FreeBSD:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig -a</code></strong>
wi0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        inet6 fe80::202:2dff:fe2d:c938%wi0 prefixlen 64 scopeid 0x7
        inet 0.0.0.0 netmask 0xff000000 broadcast 255.255.255.255
        ether 00:09:2d:2d:c9:50
        media: IEEE 802.11 Wireless Ethernet autoselect (DS/2Mbps)
        status: no carrier
        ssid ""
        stationname "FreeBSD Wireless node"
        channel 10 authmode OPEN powersavemode OFF powersavesleep 100
        wepmode OFF weptxkey 1</pre><p>Теперь мы можем изменить настройки адаптера на те, что соответствуют
	    нашей сети:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig wi0 inet <em class="replaceable"><code>192.168.0.20</code></em> netmask <em class="replaceable"><code>255.255.255.0</code></em> ssid <em class="replaceable"><code>my_net</code></em></code></strong></pre><p>Замените <code class="systemitem">192.168.0.20</code> и <code class="systemitem">255.255.255.0</code> на правильные IP-адрес и
	    сетевую маску в вашей проводной сети.  Запомните, что наша точка
	    доступа выступает в роли моста для данных между беспроводной и
	    проводной сетями, так что они будут доступны для других устройств,
	    находящихся в сети, как будто они тоже находятся в проводной
	    сети.</p><p>Как только вы это выполнили, то сможете получить ping от хостов
	    в проводной сети, как будто вы подключены посредством обычных
	    проводов.</p><p>Если вы столкнулись с проблемами при работе в беспроводной
	    сети, удостоверьтесь, что вы ассоциированы (подключены) с точкой
	    доступа:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig wi0</code></strong></pre><p>должна выдать некоторую информацию, и вы должны увидеть:</p><pre class="screen">status: associated</pre><p>Если статус не будет соответствовать
	    <code class="literal">associated</code>, это
	    может значить, что вы оказались вне зоны досягаемости точки
	    доступа, включили шифрование или, возможно, имеются проблемы с
	    конфигурацией.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99856336"></a>27.3.3.4. Шифрование</h4></div></div></div><a id="idp99856976" class="indexterm"></a><p>Шифрование в беспроводной сети имеет важное значение, потому что
	  у вас нет больше возможности ограничить сеть хорошо защищённой
	  областью.  Данные вашей беспроводной сети вещаются по всей
	  окрестности, так что любой заинтересовавшийся может их считать.  Вот
	  здесь используется шифрование.  Шифруя данные, посылаемые в
	  эфир, вы делаете их прямой перехват гораздо более сложным для всех
	  любопытных.</p><p>Двумя наиболее широко применяемыми способами шифрования данных
	  между вашим клиентом и точкой доступа являются WEP
	  и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ipsec&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ipsec</span>(4)</span></a>.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99859664"></a>27.3.3.4.1. WEP</h5></div></div></div><a id="idp99860304" class="indexterm"></a><p>WEP является сокращением от Wired Equivalency Protocol
	    (Протокол Соответствия Проводной сети).  WEP является попыткой
	    сделать беспроводные сети такими же надёжными и безопасными, как
	    проводные.  К сожалению, он был взломан и сравнительно легко
	    поддаётся вскрытию.  Это означает также, что он не тот протокол,
	    на который следует опираться, когда речь идёт о шифровании
	    критически важных данных.</p><p>Он лучше, чем ничего, так что используйте следующую команду для
	    включения WEP в вашей новой точке доступа FreeBSD:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig wi0 inet up ssid <em class="replaceable"><code>my_net</code></em> wepmode on wepkey <em class="replaceable"><code>0x1234567890</code></em> media DS/11Mbps mediaopt hostap</code></strong></pre><p>Вы можете включить WEP на клиенте следующей командой:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig wi0 inet <em class="replaceable"><code>192.168.0.20</code></em> netmask <em class="replaceable"><code>255.255.255.0</code></em> ssid <em class="replaceable"><code>my_net</code></em> wepmode on wepkey <em class="replaceable"><code>0x1234567890</code></em></code></strong></pre><p>Отметьте, что вы должны заменить
	    <em class="replaceable"><code>0x1234567890</code></em> на более уникальный ключ.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99871312"></a>27.3.3.4.2. IPsec</h5></div></div></div><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ipsec&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ipsec</span>(4)</span></a> является гораздо более надёжным и мощным
	    средством шифрования данных в сети.  Этот метод определённо
	    является предпочтительным для шифрования данных в беспроводной
	    сети.  Более детально ознакомиться с безопасностью и применением
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ipsec&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ipsec</span>(4)</span></a> вы можете в разделе об <a class="link" href="ipsec.html" title="14.10. VPN через IPsec">IPsec</a> этого Руководства.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99874640"></a>27.3.3.5. Утилиты</h4></div></div></div><p>Имеется несколько утилит, которые можно использовать для
	  настройки и отладки вашей беспроводной сети, и здесь мы попытаемся
	  описать некоторые из них и что они могут делать.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99875664"></a>27.3.3.5.1. Пакет <span class="application">bsd-airtools</span></h5></div></div></div><p>Пакет <span class="application">bsd-airtools</span> представляет
	    собой полный набор инструментов, включая инструменты для проверки
	    беспроводной сети на предмет взлома WEP-ключа,
	    обнаружения точки доступа и тому подобное.</p><p>Утилиты <span class="application">bsd-airtools</span> можно
	    установить из порта <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net-mgmt/bsd-airtools/pkg-descr">net-mgmt/bsd-airtools</a>.  Информацию
	    об установке портов можно найти в Главе <a class="xref" href="ports.html" title="Глава 5. Установка приложений: порты и пакеты">Глава 5, <em>Установка приложений: порты и пакеты</em></a>
	    этого Руководства.</p><p>Программа <code class="command">dstumbler</code> является инструментом,
	    предназначенным для обнаружения точки доступа и выдачи отношения
	    уровня сигнала к шуму.  Если у вас с трудом получается запустить
	    точку доступа, <code class="command">dstumbler</code> может помочь вам
	    начать.</p><p>Для тестирования информационной безопасности вашей беспроводной
	    сети, вы можете воспользоваться набором <span class="quote"><<<span class="quote">dweputils</span>>></span>
	    (<code class="command">dwepcrack</code>, <code class="command">dwepdump</code> и
	    <code class="command">dwepkeygen</code>), который может помочь
	    понять, является ли WEP подходящим решением для обеспечения ваших
	    потребностей в информационной безопасности.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99894480"></a>27.3.3.5.2. Утилиты <code class="command">wicontrol</code>,
	    <code class="command">ancontrol</code> и
	    <code class="command">raycontrol</code></h5></div></div></div><p>Это инструменты, которые могут быть использованы для
	    управления поведением
	    адаптера беспроводной связи в сети.  В примере выше мы выбирали
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=wicontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">wicontrol</span>(8)</span></a>, так как нашим адаптером беспроводной сети был
	    интерфейс <code class="filename">wi0</code>.  Если у вас установлено
	    устройство беспроводного доступа от Cisco, этим интерфейсом будет
	    <code class="filename">an0</code>, и тогда вы будете
	    использовать <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ancontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ancontrol</span>(8)</span></a>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99898960"></a>27.3.3.5.3. Команда <code class="command">ifconfig</code></h5></div></div></div><a id="idp99899856" class="indexterm"></a><p>Команда <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ifconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ifconfig</span>(8)</span></a> может использоваться для установки
	    многих из тех параметров, что задаёт <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=wicontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">wicontrol</span>(8)</span></a>, однако
	    работа с некоторыми параметрами в ней отсутствует.  Обратитесь к
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ifconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ifconfig</span>(8)</span></a> для выяснения параметров и опций командной
	    строки.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99911888"></a>27.3.3.6. Поддерживаемые адаптеры</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99912528"></a>27.3.3.6.1. Точки доступа</h5></div></div></div><p>Единственными адаптерами, которые на данный момент
	    поддерживаются в режиме BSS (как точка доступа), являются те
	    устройства, что сделаны на основе набора микросхем Prism 2, 2.5
	    или 3).  Полный список можно увидеть в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=wi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">wi</span>(4)</span></a>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99914448"></a>27.3.3.6.2. Клиенты 802.11b</h5></div></div></div><p>Практически все адаптеры беспроводной связи 802.11b на данный
	    момент во FreeBSD поддерживаются.  Большинство адаптеров,
	    построенных на основе Prism, Spectrum24, Hermes, Aironet и Raylink,
	    будут работать в качестве адаптера беспроводной сети в режиме
	    IBSS (ad-hoc, одноранговая сеть и BSS).</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99915600"></a>27.3.3.6.3. Клиенты 802.11a и 802.11g</h5></div></div></div><p>Драйвер устройства <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ath&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ath</span>(4)</span></a> поддерживает 802.11a и 802.11g.
      Если ваша карта основана на чипсете Atheros, вы можете использовать
      этот драйвер.</p><p>К сожалению, все еще много производителей, не предоставляющих
      схематику своих драйверов сообществу open source, поскольку
      эта информация считается торговым секретом.  Следовательно,
      у разработчиков FreeBSD и других операционных систем остается
      два варианта: разработать драйверы долгим и сложным методом
      обратного инжиниринга, или использовать существующие драйверы
      для платформ <span class="trademark">Microsoft</span>(R) <span class="trademark">Windows</span>(R).  Большинство разработчиков
      FreeBSD выбрали второй способ.</p><p>Благодаря усилиям Билла Пола (wpaul), начиная
      с FreeBSD 5.3-RELEASE существует <span class="quote"><<<span class="quote">прозрачная</span>>></span>
      поддержка Network Driver Interface Specification (NDIS).
      FreeBSD NDISulator (известный также как Project Evil)
      преобразует бинарный драйвер <span class="trademark">Windows</span>(R) так, что он работает
      так же как и в <span class="trademark">Windows</span>(R).  Эта возможность всё ещё относительно
      нова, но в большинстве тестов она работает адекватно.</p><a id="idp99920720" class="indexterm"></a><a id="idp99921232" class="indexterm"></a><a id="idp99921744" class="indexterm"></a><a id="idp99922640" class="indexterm"></a><a id="idp99923152" class="indexterm"></a><a id="idp99924304" class="indexterm"></a><p>Для использования NDISulator потребуются три вещи:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Исходные тексты ядра</p></li><li class="listitem"><p>Бинарный драйвер <span class="trademark">Windows</span>(R) XP
	(расширение <code class="filename">.SYS</code>)</p></li><li class="listitem"><p>Файл конфигурации бинарного драйвера <span class="trademark">Windows</span>(R) XP
	(расширение <code class="filename">.INF</code>)</p></li></ol></div><p>Вам может потребоваться компиляция драйвера оболочки мини порта
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ndis&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ndis</span>(4)</span></a>.  Под <code class="systemitem">root</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/sys/modules/ndis</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make &amp;&amp; make install</code></strong></pre><p>Определите местоположение файлов для вашей карты.  Обычно
      их можно найти на входящем в комплект CD или на Web-сайте
      поставщика.  В нашем примере используются файлы
      <code class="filename">W32DRIVER.SYS</code> и
      <code class="filename">W32DRIVER.INF</code>.</p><p>Следующий шаг это компиляция бинарного драйвера в
      загружаемый модуль ядра.  Чтобы сделать это, сначала зайдите в
      каталог модуля <code class="filename">if_ndis</code> и с правами
      <code class="systemitem">root</code> скопируйте туда драйверы
      <span class="trademark">Windows</span>(R):</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/sys/modules/if_ndis</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cp <em class="replaceable"><code>/path/to/driver/W32DRIVER.SYS</code></em> ./</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cp <em class="replaceable"><code>/path/to/driver/W32DRIVER.INF</code></em> ./</code></strong></pre><p>Теперь используйте утилиту <code class="command">ndiscvt</code> для
      создания заголовка определения драйвера
      <code class="filename">ndis_driver_data.h</code> перед сборкой
      модуля:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ndiscvt -i <em class="replaceable"><code>W32DRIVER.INF</code></em> -s <em class="replaceable"><code>W32DRIVER.SYS</code></em> -o ndis_driver_data.h</code></strong></pre><p>Параметры <code class="option">-i</code> и <code class="option">-s</code> задают
      соответственно файл настройки и бинарный файл.  Мы используем
      параметр <code class="option">-o ndis_driver_data.h</code>, поскольку
      <code class="filename">Makefile</code> при создании модуля будет
      обращаться именно к этому файлу.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Некоторым драйверам <span class="trademark">Windows</span>(R) для работы требуются
	дополнительные файлы.  Вы можете включить их параметром
	<code class="command">ndiscvt</code> <code class="option">-f</code>.  Обратитесь
	к странице справочной системы <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ndiscvt&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ndiscvt</span>(8)</span></a> за
	дополнительной информацией.</p></div><p>Наконец, соберите и установите модуль драйвера:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make &amp;&amp; make install</code></strong></pre><p>Для использования драйвера необходимо загрузить соответствующие
      модули:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kldload ndis</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>kldload if_ndis</code></strong></pre><p>Первая команда загружает оболочку драйвера мини-порта NDIS,
      вторая загружает собственно сетевой интерфейс.  Проверьте
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dmesg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dmesg</span>(8)</span></a> на предмет ошибок загрузки.  Если все прошло
      хорошо, вывод должен быть примерно таким:</p><pre class="screen">ndis0: &lt;Wireless-G PCI Adapter&gt; mem 0xf4100000-0xf4101fff irq 3 at device 8.0 on pci1
ndis0: NDIS API version: 5.0
ndis0: Ethernet address: 0a:b1:2c:d3:4e:f5
ndis0: 11b rates: 1Mbps 2Mbps 5.5Mbps 11Mbps
ndis0: 11g rates: 6Mbps 9Mbps 12Mbps 18Mbps 36Mbps 48Mbps 54Mbps</pre><p>Начиная с этого момента вы можете использовать устройство
      <code class="filename">ndis0</code> как любое другое беспроводное
      устройство (например, <code class="filename">wi0</code>);
      в этой ситуации применима информация, приведенная в начале этой
      главы.</p></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-routing.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="advanced-networking.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="network-bluetooth.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">27.2. Сетевые шлюзы и маршруты </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 27.4. Bluetooth</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>