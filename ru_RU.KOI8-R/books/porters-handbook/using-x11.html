<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>6.8. Использование X11</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD по созданию портов" /><link rel="up" href="special.html" title="Глава 6. Особые соглашения" /><link rel="prev" href="using-perl.html" title="6.7. Использование Perl" /><link rel="next" href="using-gnome.html" title="6.9. Использование GNOME" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.8. Использование X11</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="using-perl.html">Пред.</a> </td><th width="60%" align="center">Глава 6. Особые соглашения</th><td width="20%" align="right"> <a accesskey="n" href="using-gnome.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-x11"></a>6.8. Использование X11</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="x11-variables"></a>6.8.1. Компоненты X.Org</h3></div></div></div><p>X.Org является реализацией X11, доступной в Коллекции
	Портов.  Если ваше приложение зависит от компонентов X,
	установите в переменную <code class="varname">USE_XORG</code> в
	перечень требуемых компонентов.  К настоящему времени
	доступными компонентами являются:</p><p><code class="literal">bigreqsproto compositeproto damageproto dmx
	  dmxproto dri2proto evieproto fixesproto fontcacheproto
	  fontenc fontsproto fontutil glproto ice inputproto kbproto
	  libfs oldx pciaccess pixman printproto randrproto
	  recordproto renderproto resourceproto scrnsaverproto sm
	  trapproto videoproto x11 xau xaw xaw6 xaw7 xbitmaps
	  xcmiscproto xcomposite xcursor xdamage xdmcp xevie xext
	  xextproto xf86bigfontproto xf86dgaproto xf86driproto
	  xf86miscproto xf86rushproto xf86vidmodeproto xfixes xfont
	  xfontcache xft xi xinerama xineramaproto xkbfile xkbui xmu
	  xmuu xorg-server xp xpm xprintapputil xprintutil xproto
	  xproxymngproto xrandr xrender xres xscrnsaver xt xtrans
	  xtrap xtst xv xvmc xxf86dga xxf86misc
	  xxf86vm</code>.</p><p>Всегда актуальный перечень можно найти в
	<code class="filename">/usr/ports/Mk/bsd.xorg.mk</code>.</p><p>Проект Mesa является попыткой обеспечить свободную
	реализацию OpenGL.  Вы можете указать зависимость от
	различных компонентов этого проекта при помощи переменной
	<code class="varname">USE_GL</code>.  Действительные опции:
	<code class="literal">glut, glu, glw, glew, gl</code> и
	<code class="literal">linux</code>.  Для обратной совместимости
	значение <code class="literal">yes</code> соответствует
	<code class="literal">glu</code>.</p><div class="example"><a id="use-xorg-example"></a><div class="example-title">Пример 6.3. Пример для USE_XORG</div><div class="example-contents"><pre class="programlisting">USE_XORG=	xrender xft xkbfile xt xaw
USE_GL=		glu</pre></div></div><br class="example-break" /><div class="table"><a id="idp77484368"></a><div class="table-title">Таблица 6.7. Переменные для портов, использующих X</div><div class="table-contents"><table summary="Переменные для портов, использующих X" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USES= imake</code></td><td>Используется <code class="command">imake</code>.</td></tr><tr><td><code class="varname">XMKMF</code></td><td>Задаёт маршрут до <code class="command">xmkmf</code>, если
		он отсутствует в <code class="envar">PATH</code>.  По умолчанию
		это <code class="literal">xmkmf -a</code>.</td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="using-x11-vars"></a><div class="example-title">Пример 6.4. Использование переменных X11 в порте</div><div class="example-contents"><pre class="programlisting"># Использовать некоторые библиотеки X11
USE_XORG=	x11 xpm</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-motif"></a>6.8.2. Порты, которым требуется Motif</h3></div></div></div><p>Если вашему порту требуется Motif, задайте переменную
	<code class="varname">USES= motif</code> в файле
	<code class="filename">Makefile</code>.  Реализация Motif,
	используемая по умолчанию, находится в
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/open-motif/pkg-descr">x11-toolkits/open-motif</a>.
	Пользователи вместо этого могут выбрать
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/lesstif/pkg-descr">x11-toolkits/lesstif</a> через
	установку переменной <code class="varname">WANT_LESSTIF</code>.</p><p>Переменная <code class="varname">MOTIFLIB</code> будет установлена
	в <code class="filename">bsd.port.mk</code>, чтобы ссылаться на
	соответствующую библиотеку Motif.  Пожалуйста, измените
	исходные тексты вашего порта на использование
	<code class="literal">${MOTIFLIB}</code> везде, где упоминается
	библиотека Motif, в первоначальном
	<code class="filename">Makefile</code> или
	<code class="filename">Imakefile</code>.</p><p>Существует два общих случая:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Если порт обращается к библиотеке Motif как
	    <code class="literal">-lXm</code> в своих файлах
	    <code class="filename">Makefile</code> или
	    <code class="filename">Imakefile</code>, просто подставьте вместо
	    этих обращений
	    <code class="literal">${MOTIFLIB}</code>.</p></li><li class="listitem"><p>Если порт использует <code class="literal">XmClientLibs</code>
	    в своем файле <code class="filename">Imakefile</code>, измените
	    это обращение на <code class="literal">${MOTIFLIB}
	      ${XTOOLLIB} ${XLIB}</code>.</p></li></ul></div><p>Заметьте, что переменная <code class="varname">MOTIFLIB</code> (как
	правило) раскрывается в
	<code class="literal">-L/usr/local/lib -lXm</code> или
	<code class="literal">/usr/local/lib/libXm.a</code>, так что нет нужды
	впереди добавлять <code class="literal">-L</code> или
	<code class="literal">-l</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77517392"></a>6.8.3. Шрифты для X11</h3></div></div></div><p>Если ваш порт устанавливает шрифты для X Window System,
	поместите их в каталог
	<code class="filename">LOCALBASE/lib/X11/fonts/local</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77518928"></a>6.8.4. Получение поддельного <code class="envar">DISPLAY</code>, используя
	Xvfb</h3></div></div></div><p>Некоторые приложения для успешной компиляции требуют
	наличие работающего дисплея X11.  Это создает проблему для
	машин, которые работают в режиме headless.  При использовании
	следующего канонического хака инфраструктура построения
	запустит сервер X в виртуальном фреймбуфере.  Затем
	переменная работающего <code class="envar">DISPLAY</code> передается при
	построении.</p><pre class="programlisting">USES=	display</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="desktop-entries"></a>6.8.5. Элементы рабочего стола</h3></div></div></div><p>Элементы рабочего стола (<a class="link" href="http://standards.freedesktop.org/desktop-entry-spec/latest/" target="_top">стандарта
	  Freedesktop</a>) предоставляют способ автоматической
	настройки функций рабочего стола при установке новой
	программы, не требуя вмешательства пользователя.  Например,
	новые программы автоматически отображаются в меню приложений
	совместимых окружений рабочего стола.  Элементы рабочего
	стола изначально появились в окружении рабочего стола
	<span class="application">GNOME</span>, но в настоящее время
	являются стандартом и также работают с
	<span class="application">KDE</span> и
	<span class="application">Xfce</span>.  Такая небольшая
	автоматизация предоставляет реальное удобство для
	пользователя, и посему элементы рабочего стола приветствуются
	в приложениях, которые можно использовать в окружении
	рабочего стола.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77524048"></a>6.8.5.1. Использование предопределенных файлов
	  <code class="filename">.desktop</code></h4></div></div></div><p>Порты, включающие предопределенные файлы
	  <code class="filename">*.desktop</code>, должны включать эти файлы в
	  <code class="filename">pkg-plist</code> и устанавливать их в каталог
	  <code class="filename">$LOCALBASE/share/applications</code>.
	  Для установки этих файлов используется <a class="link" href="install.html#install-macros" title="5.15.1. Макросы INSTALL_*">макрос
	    <code class="varname">INSTALL_DATA</code></a>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="updating-desktop-database"></a>6.8.5.2. Обновление базы данных рабочего стола</h4></div></div></div><p>Если в файле порта
	  <code class="filename">portname.desktop</code> имеется запись
	  MimeType, то база данных рабочего стола олжна быть
	  обновлена после установки и удаления.  Для этого укажите
	  <code class="varname">USES</code>= desktop-file-utils.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="desktop-entries-macro"></a>6.8.5.3. Создание элементов рабочего стола с использованием
	  <code class="varname">DESKTOP_ENTRIES</code></h4></div></div></div><p>Элементы рабочего стола можно легко создавать для
	  приложений, используя переменную
	  <code class="varname">DESKTOP_ENTRIES</code>.  Будет автоматически
	  создан, установлен и добавлен в
	  <code class="filename">pkg-plist</code> файл с названием
	  <code class="filename">name.desktop</code>.  Синтаксис:</p><pre class="programlisting">DESKTOP_ENTRIES=	"NAME" "COMMENT" "ICON" "COMMAND" "CATEGORY" StartupNotify</pre><p>Перечень возможных категорий доступен на <a class="link" href="http://standards.freedesktop.org/menu-spec/latest/apa.html" target="_top">вебсайте
	    Freedesktop</a>.  <code class="varname">StartupNotify</code>
	  отобразит, поддерживает ли приложение <span class="emphasis"><em>уведомления
	    о запуске</em></span>.  Как правило, это графический
	  индикатор часы вместо указателя мыши, меню или панель,
	  которые уведомляют пользователя о загрузке программы.
	  Программа, поддерживающая уведомления о запуске, очистит
	  этот индикатор после запуска.  Программы, несовместимые с
	  уведомлениями о запуске, не будут очищать индикатор
	  (возможно, вызывая путаницу и приводя пользователей в
	  бешенство), и поэтому должны иметь
	  <code class="varname">StartupNotify</code> в выключенном состоянии
	  <code class="literal">false</code>; тогда индикатор не будет
	  отображаться совсем.</p><p>Пример:</p><pre class="programlisting">DESKTOP_ENTRIES=	"ToME" "Roguelike game based on JRR Tolkien's work" \
			"${DATADIR}/xtra/graf/tome-128.png" \
			"tome -v -g" "Application;Game;RolePlaying;" \
			false</pre></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="using-perl.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="special.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="using-gnome.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">6.7. Использование <span class="application">Perl</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 6.9. Использование GNOME</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>