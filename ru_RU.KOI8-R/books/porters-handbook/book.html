<?xml version="1.0" encoding="koi8-r"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>Руководство FreeBSD по созданию портов</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div xml:lang="ru" class="book" lang="ru"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp68717776"></a>Руководство FreeBSD по созданию портов</h1></div><div><div xmlns="http://www.w3.org/1999/xhtml" class="authorgroup"><div class="author"><h3 class="author"><span class="orgname">The FreeBSD Documentation Project</span></h3></div></div></div><div>Издание: <a href="https://svnweb.freebsd.org/changeset/doc/"><span class="svnref"></span></a></div><div><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">Авторские права © 2000-2013 The FreeBSD Documentation
	Project</p></div><div><div xmlns="http://www.w3.org/1999/xhtml" class="legalnotice"><a id="legalnotice"></a><p>Распространение и использование исходных (SGML DocBook) и
    <span class="quote"><<<span class="quote">скомпилированных</span>>></span> форм (SGML, HTML, PDF, PostScript,
    RTF и прочих)
    с модификацией или без оной, разрешены при соблюдении следующих
    соглашений:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Распространяемые копии исходного кода (SGML DocBook) должны
        сохранять вышеупомянутые объявления copyright, этот список
	положений и следующий отказ от ответственности в первых строках
	этого файла в неизменном виде.</p></li><li class="listitem"><p>Распространяемые копии скомпилированных форм (преобразованные в
        другие DTD, конвертированные в PDF, PostScript, RTF и другие форматы)
	должны повторять вышеупомянутые объявления copyright, этот список
	положений и следующий отказ от ответственности в документации
	и/или других материалах, поставляемых с дистрибьюцией.</p></li></ol></div><div xmlns="" class="important"><h3 class="admontitle">Важно: </h3><p xmlns="http://www.w3.org/1999/xhtml">ЭТА ДОКУМЕНТАЦИЯ ПОСТАВЛЯЕТСЯ ПРОЕКТОМ ДОКУМЕНТАЦИИ FREEBSD
      "КАК ЕСТЬ" И ЛЮБЫЕ ЯВНЫЕ ИЛИ НЕЯВНЫЕ ГАРАНТИИ, ВКЛЮЧАЯ, НО НЕ
      ОГРАНИЧИВАЯСЬ НЕЯВНЫМИ ГАРАНТИЯМИ, КОММЕРЧЕСКОЙ ЦЕННОСТИ И ПРИГОДНОСТИ
      ДЛЯ КОНКРЕТНОЙ ЦЕЛИ ОТРИЦАЮТСЯ. НИ ПРИ КАКИХ УСЛОВИЯХ ПРОЕКТ
      ДОКУМЕНТИРОВАНИЯ FREEBSD НЕ НЕСЕТ ОТВЕТСТВЕННОСТИ ЗА ЛЮБОЙ ПРЯМОЙ, КОСВЕННЫЙ,
      СЛУЧАЙНЫЙ, СПЕЦИАЛЬНЫЙ, ОБРАЗЦОВЫЙ ИЛИ ПОСЛЕДУЮЩИЙ УЩЕРБЫ (ВКЛЮЧАЯ,
      НО НЕ ОГРАНИЧИВАЯСЬ ПОСТАВКОЙ ТОВАРОВ ЗАМЕНЫ ИЛИ УСЛУГ; ПОТЕРЮ ДАННЫХ
      ИЛИ ИХ НЕПРАВИЛЬНУЮ ПЕРЕДАЧУ ИЛИ ПОТЕРИ; ПРИОСТАНОВЛЕНИЕ БИЗНЕСА),
      И ТЕМ НЕ МЕНЕЕ ВЫЗВАННЫЕ И В ЛЮБОЙ ТЕОРИИ ОТВЕТСТВЕННОСТИ,
      НЕЗАВИСИМО ОТ КОНТРАКТНОЙ, СТРОГОЙ ОТВЕТСТВЕННОСТИ, ИЛИ
      ПРАВОНАРУШЕНИИ (ВКЛЮЧАЯ ХАЛАТНОСТЬ ИЛИ ИНЫМ СПОСОБОМ), ВОЗНИКШЕМ
      ЛЮБЫМ ПУТЕМ ПРИ ИСПОЛЬЗОВАНИИ ЭТОЙ ДОКУМЕНТАЦИИ, ДАЖЕ ЕСЛИ
      БЫ БЫЛО СООБЩЕНО О ВОЗМОЖНОСТИ ТАКОГО УЩЕРБА.</p></div></div></div><div><div xmlns="http://www.w3.org/1999/xhtml" class="legalnotice"><a id="trademarks"></a><p>FreeBSD это зарегистрированная торговая
  марка FreeBSD Foundation.</p><p>Unix это зарегистрированная торговая марка
  Open Group в Соединенных Штатах и других странах.</p><p>Sun, Sun Microsystems, Java, Java Virtual Machine,
  JDK, JRE, JSP, JVM, Netra, Solaris, StarOffice,
  SunOS это торговые марки или
  зарегистрированные торговые марки Sun Microsystems, Inc. в Соединенных
  Штатах и других странах.</p><p>Многие из обозначений, используемые
  производителями и продавцами для обозначения своих продуктов, заявляются
  в качестве торговых марок.  Когда такие обозначения появляются в этом
  документе, и Проекту FreeBSD известно о торговой марке, к обозначению
  добавляется знак <span class="quote"><<<span class="quote">TM</span>>></span> или
  <span class="quote"><<<span class="quote">(R)</span>>></span>.</p></div></div><div>    .</div></div><div class="docformatnavi">
      [
      <a href="index.html">По разделам</a>
      /
      
	  Одним файлом
	
      ]
    </div><hr /></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="chapter"><a href="#why-port">1. Введение</a></span></dt><dt><span class="chapter"><a href="#own-port">2. Как самому сделать новый порт</a></span></dt><dt><span class="chapter"><a href="#quick-porting">3. Быстрое портирование</a></span></dt><dd><dl><dt><span class="sect1"><a href="#porting-makefile">3.1. Создание файла <code class="filename">Makefile</code></a></span></dt><dt><span class="sect1"><a href="#porting-desc">3.2. Создание информационных файлов</a></span></dt><dt><span class="sect1"><a href="#porting-checksum">3.3. Создание файла с контрольной суммой</a></span></dt><dt><span class="sect1"><a href="#porting-testing">3.4. Тестирование порта</a></span></dt><dt><span class="sect1"><a href="#porting-portlint">3.5. Проверка вашего порта утилитой
      <code class="command">portlint</code></a></span></dt><dt><span class="sect1"><a href="#porting-submitting">3.6. Посылка нового порта</a></span></dt></dl></dd><dt><span class="chapter"><a href="#slow-porting">4. Медленное портирование</a></span></dt><dd><dl><dt><span class="sect1"><a href="#slow-work">4.1. Как всё это работает</a></span></dt><dt><span class="sect1"><a href="#slow-sources">4.2. Получение исходного кода</a></span></dt><dt><span class="sect1"><a href="#slow-modifying">4.3. Модификация порта</a></span></dt><dt><span class="sect1"><a href="#slow-patch">4.4. Создание патчей</a></span></dt><dt><span class="sect1"><a href="#slow-configure">4.5. Конфигурирование</a></span></dt><dt><span class="sect1"><a href="#slow-user-input">4.6. Обработка пользовательского ввода</a></span></dt></dl></dd><dt><span class="chapter"><a href="#makefiles">5. Настройка файла Makefile</a></span></dt><dd><dl><dt><span class="sect1"><a href="#makefile-source">5.1. Оригинальные исходный код</a></span></dt><dt><span class="sect1"><a href="#makefile-naming">5.2. Именование</a></span></dt><dt><span class="sect1"><a href="#makefile-categories">5.3. Разделение по категориям</a></span></dt><dt><span class="sect1"><a href="#makefile-distfiles">5.4. Дистрибутивные файлы</a></span></dt><dt><span class="sect1"><a href="#makefile-maintainer">5.5. <code class="varname">MAINTAINER</code></a></span></dt><dt><span class="sect1"><a href="#makefile-comment">5.6. <code class="varname">COMMENT</code></a></span></dt><dt><span class="sect1"><a href="#makefile-portscout">5.7. <code class="varname">PORTSCOUT</code></a></span></dt><dt><span class="sect1"><a href="#makefile-depend">5.8. Зависимости</a></span></dt><dt><span class="sect1"><a href="#makefile-masterdir">5.9. <code class="varname">MASTERDIR</code></a></span></dt><dt><span class="sect1"><a href="#makefile-manpages">5.10. Страницы Справочника</a></span></dt><dt><span class="sect1"><a href="#makefile-info">5.11. Файлы в формате info</a></span></dt><dt><span class="sect1"><a href="#makefile-options">5.12. Опции для Makefile</a></span></dt><dt><span class="sect1"><a href="#makefile-wrkdir">5.13. Задание рабочего каталога</a></span></dt><dt><span class="sect1"><a href="#conflicts">5.14. Разрешение конфликтов</a></span></dt><dt><span class="sect1"><a href="#install">5.15. Установка файлов</a></span></dt></dl></dd><dt><span class="chapter"><a href="#special">6. Особые соглашения</a></span></dt><dd><dl><dt><span class="sect1"><a href="#staging">6.1. Staging</a></span></dt><dt><span class="sect1"><a href="#porting-shlibs">6.2. Динамические библиотеки</a></span></dt><dt><span class="sect1"><a href="#porting-restrictions">6.3. Порты с ограничениями на распространение или с правовым
      обременением</a></span></dt><dt><span class="sect1"><a href="#building">6.4. Механизмы построения</a></span></dt><dt><span class="sect1"><a href="#using-autotools">6.5. Использование GNU Autotools</a></span></dt><dt><span class="sect1"><a href="#using-gettext">6.6. Использование GNU <code class="literal">gettext</code></a></span></dt><dt><span class="sect1"><a href="#using-perl">6.7. Использование <span class="application">Perl</span></a></span></dt><dt><span class="sect1"><a href="#using-x11">6.8. Использование X11</a></span></dt><dt><span class="sect1"><a href="#using-gnome">6.9. Использование GNOME</a></span></dt><dt><span class="sect1"><a href="#using-qt">6.10. Использование Qt</a></span></dt><dt><span class="sect1"><a href="#using-kde">6.11. Использование KDE</a></span></dt><dt><span class="sect1"><a href="#using-java">6.12. Использование Java</a></span></dt><dt><span class="sect1"><a href="#using-php">6.13. Веб-приложения, Apache и PHP</a></span></dt><dt><span class="sect1"><a href="#using-python">6.14. Использование Python</a></span></dt><dt><span class="sect1"><a href="#using-tcl">6.15. Использование <span class="application">Tcl/Tk</span></a></span></dt><dt><span class="sect1"><a href="#using-emacs">6.16. Использование Emacs</a></span></dt><dt><span class="sect1"><a href="#using-ruby">6.17. Использование Ruby</a></span></dt><dt><span class="sect1"><a href="#using-sdl">6.18. Использование SDL</a></span></dt><dt><span class="sect1"><a href="#using-wx">6.19. Использование <span class="application">wxWidgets</span></a></span></dt><dt><span class="sect1"><a href="#using-lua">6.20. Использование <span class="application">Lua</span></a></span></dt><dt><span class="sect1"><a href="#using-iconv">6.21. Использование <code class="command">iconv</code></a></span></dt><dt><span class="sect1"><a href="#using-xfce">6.22. Использование Xfce</a></span></dt><dt><span class="sect1"><a href="#using-mozilla">6.23. Использование Mozilla</a></span></dt><dt><span class="sect1"><a href="#using-databases">6.24. Использование баз данных</a></span></dt><dt><span class="sect1"><a href="#rc-scripts">6.25. Запуск и остановка служб (сценарии
      <code class="literal">rc</code>)</a></span></dt><dt><span class="sect1"><a href="#users-and-groups">6.26. Добавление пользователей и групп</a></span></dt><dt><span class="sect1"><a href="#requiring-kernel-sources">6.27. Порты, требующие наличия исходных текстов ядра</a></span></dt></dl></dd><dt><span class="chapter"><a href="#plist">7. Продвинутые практики <code class="filename">pkg-plist</code></a></span></dt><dd><dl><dt><span class="sect1"><a href="#plist-sub">7.1. Изменение содержимого <code class="filename">pkg-plist</code> в
      зависимости от make-переменных</a></span></dt><dt><span class="sect1"><a href="#plist-cleaning">7.2. Пустые каталоги</a></span></dt><dt><span class="sect1"><a href="#plist-config">7.3. Конфигурационные файлы</a></span></dt><dt><span class="sect1"><a href="#plist-dynamic">7.4. Динамический или статический список упаковки</a></span></dt><dt><span class="sect1"><a href="#plist-autoplist">7.5. Автоматическое создание списка упаковки</a></span></dt></dl></dd><dt><span class="chapter"><a href="#pkg-files">8. Файлы <code class="filename">pkg-*</code></a></span></dt><dd><dl><dt><span class="sect1"><a href="#porting-message">8.1. <code class="filename">pkg-message</code></a></span></dt><dt><span class="sect1"><a href="#pkg-install">8.2. <code class="filename">pkg-install</code></a></span></dt><dt><span class="sect1"><a href="#pkg-deinstall">8.3. <code class="filename">pkg-deinstall</code></a></span></dt><dt><span class="sect1"><a href="#pkg-names">8.4. Изменение имён файлов
      <code class="filename">pkg-*</code></a></span></dt><dt><span class="sect1"><a href="#using-sub-files">8.5. Использование <code class="varname">SUB_FILES</code> и
      <code class="varname">SUB_LIST</code></a></span></dt></dl></dd><dt><span class="chapter"><a href="#testing">9. Тестирование вашего порта</a></span></dt><dd><dl><dt><span class="sect1"><a href="#make-describe">9.1. Запуск <code class="command">make describe</code></a></span></dt><dt><span class="sect1"><a href="#testing-portlint">9.2. Portlint</a></span></dt><dt><span class="sect1"><a href="#testing-porttools">9.3. Port Tools</a></span></dt><dt><span class="sect1"><a href="#porting-prefix">9.4. <code class="varname">PREFIX</code> и
      <code class="varname">DESTDIR</code></a></span></dt><dt><span class="sect1"><a href="#testing-tinderbox">9.5. Tinderbox</a></span></dt><dt><span class="sect1"><a href="#testing-poudriere">9.6. Poudriere</a></span></dt></dl></dd><dt><span class="chapter"><a href="#port-upgrading">10. Обновление отдельного порта</a></span></dt><dd><dl><dt><span class="sect1"><a href="#svn-diff">10.1. Использование <span class="application">Subversion</span> для
      создания патчей</a></span></dt><dt><span class="sect1"><a href="#moved-and-updating-files">10.2. Файлы <code class="filename">UPDATING</code> и
      <code class="filename">MOVED</code></a></span></dt></dl></dd><dt><span class="chapter"><a href="#security">11. Безопасность портов</a></span></dt><dd><dl><dt><span class="sect1"><a href="#security-intro">11.1. Почему безопасность так важна</a></span></dt><dt><span class="sect1"><a href="#security-fix">11.2. Исправление уязвимостей безопасности</a></span></dt><dt><span class="sect1"><a href="#security-notify">11.3. Обеспечение сообщества информацией</a></span></dt></dl></dd><dt><span class="chapter"><a href="#porting-dads">12. Что делать нужно, и что делать нельзя</a></span></dt><dd><dl><dt><span class="sect1"><a href="#dads-intro">12.1. Введение</a></span></dt><dt><span class="sect1"><a href="#porting-wrkdir">12.2. <code class="varname">WRKDIR</code></a></span></dt><dt><span class="sect1"><a href="#porting-wrkdirprefix">12.3. <code class="varname">WRKDIRPREFIX</code></a></span></dt><dt><span class="sect1"><a href="#porting-versions">12.4. Различение операционных систем и версий ОС</a></span></dt><dt><span class="sect1"><a href="#dads-after-port-mk">12.5. Написание чего-либо после
      <code class="filename">bsd.port.mk</code></a></span></dt><dt><span class="sect1"><a href="#dads-sh-exec">12.6. Использование выражения <code class="function">exec</code>
      в сценариях обёртках</a></span></dt><dt><span class="sect1"><a href="#dads-rational">12.7. Поступайте разумно</a></span></dt><dt><span class="sect1"><a href="#dads-cc">12.8. Работа как с <code class="varname">CC</code>, так и
      <code class="varname">CXX</code></a></span></dt><dt><span class="sect1"><a href="#dads-cflags">12.9. Использование <code class="varname">CFLAGS</code></a></span></dt><dt><span class="sect1"><a href="#dads-pthread">12.10. Библиотеки потоков</a></span></dt><dt><span class="sect1"><a href="#dads-feedback">12.11. Пожелания</a></span></dt><dt><span class="sect1"><a href="#dads-readme">12.12. <code class="filename">README.html</code></a></span></dt><dt><span class="sect1"><a href="#dads-noinstall">12.13. Пометка неустанавливаемого порта как
      <code class="varname">BROKEN</code>, <code class="varname">FORBIDDEN</code> или
      <code class="varname">IGNORE</code></a></span></dt><dt><span class="sect1"><a href="#dads-deprecated">12.14. Пометка порта на удаление с <code class="varname">DEPRECATED</code>
      или <code class="varname">EXPIRATION_DATE</code></a></span></dt><dt><span class="sect1"><a href="#dads-dot-error">12.15. Избегайте использования конструкции
      <code class="literal">.error</code></a></span></dt><dt><span class="sect1"><a href="#dads-sysctl">12.16. Использование <code class="filename">sysctl</code></a></span></dt><dt><span class="sect1"><a href="#dads-rerolling-distfiles">12.17. Меняющиеся дистрибутивные файлы</a></span></dt><dt><span class="sect1"><a href="#dads-avoiding-linuxisms">12.18. Избегание линуксизмов</a></span></dt><dt><span class="sect1"><a href="#dads-misc">12.19. Разное</a></span></dt></dl></dd><dt><span class="chapter"><a href="#porting-samplem">13. Примерный <code class="filename">Makefile</code></a></span></dt><dt><span class="chapter"><a href="#keeping-up">14. Актуализация</a></span></dt><dd><dl><dt><span class="sect1"><a href="#freshports">14.1. FreshPorts</a></span></dt><dt><span class="sect1"><a href="#svnweb">14.2. Web-интерфейс к хранилищу исходных текстов</a></span></dt><dt><span class="sect1"><a href="#ports-mailing-list">14.3. Список рассылки FreeBSD, посвящённый портам</a></span></dt><dt><span class="sect1"><a href="#build-cluster">14.4. Кластер построения портов FreeBSD</a></span></dt><dt><span class="sect1"><a href="#distfile-survey">14.5. Portscout: сканер дистрибутивных файлов портов
      FreeBSD</a></span></dt><dt><span class="sect1"><a href="#portsmon">14.6. Система мониторинга портов FreeBSD</a></span></dt></dl></dd><dt><span class="chapter"><a href="#appendices">15. Приложения</a></span></dt><dd><dl><dt><span class="sect1"><a href="#uses-values">15.1. Значения <code class="varname">USES</code></a></span></dt><dt><span class="sect1"><a href="#freebsd-versions">15.2. Значения <code class="literal">__FreeBSD_version</code></a></span></dt></dl></dd></dl></div><div class="list-of-tables"><div class="toc-title">Список таблиц</div><dl><dt>5.1. <a href="#idp74331216">Популярные магические макросы для
	  <code class="varname">MASTER_SITES</code></a></dt><dt>5.2. <a href="#idp74858576">Переменные
	  <code class="varname">USE_<em class="replaceable"><code>*</code></em></code></a></dt><dt>5.3. <a href="#idp74958032">Основные переменные
	    <code class="varname">WITH_<em class="replaceable"><code>*</code></em></code> и
	    <code class="varname">WITHOUT_<em class="replaceable"><code>*</code></em></code></a></dt><dt>6.1. <a href="#idp75397968">Переменные для портов, использующих
	  <span class="application">gmake</span></a></dt><dt>6.2. <a href="#idp75416784">Переменные для портов, использующих
	  <code class="command">configure</code></a></dt><dt>6.3. <a href="#idp75440208">Переменные для портов, использующих
	  <code class="command">cmake</code></a></dt><dt>6.4. <a href="#idp75452496">Переменные построения <code class="command">cmake</code>,
	  устанавливаемые пользователем</a></dt><dt>6.5. <a href="#idp75489616">Переменные для портов, использующих
	  <code class="command">scons</code></a></dt><dt>6.6. <a href="#idp75658192">Переменные для портов, использующих
	<span class="application">Perl</span></a></dt><dt>6.7. <a href="#idp75715280">Переменные для портов, использующих X</a></dt><dt>6.8. <a href="#idp75787088">Переменные для портов, использующих Qt</a></dt><dt>6.9. <a href="#idp75809360">Дополнительные переменные для портов, использующих Qt
	  4.x</a></dt><dt>6.10. <a href="#idp75831888">Доступные библиотечные компоненты Qt 4</a></dt><dt>6.11. <a href="#idp75852240">Доступные компоненты инструментов Qt 4</a></dt><dt>6.12. <a href="#idp75862096">Доступные компоненты плагинов Qt 4</a></dt><dt>6.13. <a href="#idp75877712">Переменные для портов, использующих
	  <code class="command">qmake</code></a></dt><dt>6.14. <a href="#idp75905616">Доступные компоненты KDE 4</a></dt><dt>6.15. <a href="#idp75966288">Переменные, которые которые могут задаваться портами,
	  использующими Java</a></dt><dt>6.16. <a href="#idp75993424">Переменные, доступные в портах, использующих
	  Java</a></dt><dt>6.17. <a href="#idp76049488">Константы, определённые для портов, использующих
	  Java</a></dt><dt>6.18. <a href="#idp76094928">Переменные для портов, использующих Apache</a></dt><dt>6.19. <a href="#idp76116304">Используемые переменные при портировании модулей
	  Apache</a></dt><dt>6.20. <a href="#idp76153680">Переменные для портов, использующих PHP</a></dt><dt>6.21. <a href="#idp76192080">Переменные для портов, которые используют Python</a></dt><dt>6.22. <a href="#idp76229968">Наиболее востребованные переменные для портов, которые
	используют <span class="application">Tcl/Tk</span></a></dt><dt>6.23. <a href="#idp76263120">Полезные переменные для портов, использующих Ruby</a></dt><dt>6.24. <a href="#idp76274000">Отобранные переменные только для чтения для портов,
	использующих Ruby</a></dt><dt>6.25. <a href="#wx-ver-sel-table">Переменные для выбора версии
	  <span class="application">wxWidgets</span></a></dt><dt>6.26. <a href="#idp76368080">Доступные версии
	  <span class="application">wxWidgets</span></a></dt><dt>6.27. <a href="#idp76379088">Определение версии для
	  <span class="application">wxWidgets</span></a></dt><dt>6.28. <a href="#idp76388304">Переменные для выбора предпочитаемых версий
	  <span class="application">wxWidgets</span></a></dt><dt>6.29. <a href="#idp76400848">Доступные компоненты
	  <span class="application">wxWidgets</span></a></dt><dt>6.30. <a href="#idp76419792">Доступные типы зависимости
	  <span class="application">wxWidgets</span></a></dt><dt>6.31. <a href="#wx-def-dep-types">Типы зависимости <span class="application">wxWidgets</span>,
	  используемые по умолчанию</a></dt><dt>6.32. <a href="#wx-unicode-var-table">Переменные для выбора версии
	  <span class="application">wxWidgets</span> с Unicode</a></dt><dt>6.33. <a href="#idp76503248">Переменные, определенные для портов, использующих
	  <span class="application">wxWidgets</span></a></dt><dt>6.34. <a href="#idp76535120">Допустимые значения
	  <code class="varname">WX_CONF_ARGS</code></a></dt><dt>6.35. <a href="#lua-ver-sel-table">Переменные для выбора версии
	  <span class="application">Lua</span></a></dt><dt>6.36. <a href="#idp76559824">Доступные версии
	  <span class="application">Lua</span></a></dt><dt>6.37. <a href="#idp76573008">Определение версии
	  <span class="application">Lua</span></a></dt><dt>6.38. <a href="#idp76586320">Переменные для выбора предпочитаемых версий
	  <span class="application">Lua</span></a></dt><dt>6.39. <a href="#idp76598736">Доступные компоненты
	  <span class="application">Lua</span></a></dt><dt>6.40. <a href="#idp76613456">Доступные типы зависимости
	  <span class="application">Lua</span></a></dt><dt>6.41. <a href="#lua-def-dep-types">Типы зависимости <span class="application">Lua</span>,
	  используемые по умолчанию</a></dt><dt>6.42. <a href="#idp76651600">Переменные, определенные для портов, использующих
	  <span class="application">Lua</span></a></dt><dt>6.43. <a href="#idp76841680">Переменные для портов, использующих Mozilla</a></dt><dt>6.44. <a href="#idp76865104">Переменные для портов, использующих базы данных</a></dt><dt>10.1. <a href="#table-svn-up">Префиксы файлов для
	<span class="application">Subversion</span> Update</a></dt><dt>15.1. <a href="#idp77917392">Значения <code class="varname">USES</code></a></dt><dt>15.2. <a href="#idp78311120">Значения <code class="literal">__FreeBSD_version</code></a></dt></dl></div><div class="list-of-examples"><div class="toc-title">Список примеров</div><dl><dt>5.1. <a href="#ports-master-sites-n-example-simple-use-one-file-per-site">Упрощённое использование
	    <code class="literal">MASTER_SITES:n</code> с 1 файлом на каждом
	    сайте</a></dt><dt>5.2. <a href="#ports-master-sites-n-example-simple-use-more-than-one-file-per-site">Упрощённое использование
	    <code class="literal">MASTER_SITES:n</code> с более чем 1 файлом на
	    каждом сервере</a></dt><dt>5.3. <a href="#ports-master-sites-n-example-detailed-use-master-site-subdir">Подробное использование
		    <code class="literal">MASTER_SITES:n</code> в
		    <code class="varname">MASTER_SITE_SUBDIR</code></a></dt><dt>5.4. <a href="#ports-master-sites-n-example-detailed-use-complete-example-master-sites">Подробное использование
		    <code class="literal">MASTER_SITES:n</code> с запятыми,
		    несколькими файлами, несколькими серверами и
		    несколькими подкаталогами</a></dt><dt>5.5. <a href="#ports-master-sites-n-example-detailed-use-master-site-sourceforge">Подробное использование
		<code class="literal">MASTER_SITES:n</code> с
		<code class="varname">MASTER_SITE_SOURCEFORGE</code></a></dt><dt>5.6. <a href="#ports-master-sites-n-example-detailed-use-patch-sites">Упрощённое использование
		<code class="literal">MASTER_SITES:n</code> с
		<code class="varname">PATCH_SITES</code>.</a></dt><dt>5.7. <a href="#ports-master-sites-n-example-always-keep-distfiles">Использование
	  <code class="varname">ALWAYS_KEEP_DISTFILES</code>.</a></dt><dt>5.8. <a href="#idp74903504">Некорректное объявление необязательной
	  зависимости</a></dt><dt>5.9. <a href="#idp74905168">Корректное объявление необязательной
	  зависимости</a></dt><dt>5.10. <a href="#ports-options-simple-use">Простое использование
	    <code class="varname">OPTIONS</code></a></dt><dt>5.11. <a href="#ports-options-check-unset">Проверка незаданных значений
	    <code class="varname">OPTIONS</code></a></dt><dt>5.12. <a href="#ports-options-practical-use">Пример реального использования
	    <code class="varname">OPTIONS</code></a></dt><dt>5.13. <a href="#idp75028560">Неправильное управление опцией</a></dt><dt>5.14. <a href="#idp75030480">Правильное управление опцией</a></dt><dt>6.1. <a href="#using-cmake-example">Пример для <code class="literal">USES= cmake</code></a></dt><dt>6.2. <a href="#use-perl-dependency-example">Пример зависимости Perl</a></dt><dt>6.3. <a href="#use-xorg-example">Пример для USE_XORG</a></dt><dt>6.4. <a href="#using-x11-vars">Использование переменных X11 в порте</a></dt><dt>6.5. <a href="#qt4-components-example">Выбор компонентов Qt 4</a></dt><dt>6.6. <a href="#kde4-components-example">Пример <code class="varname">USE_KDE4</code></a></dt><dt>6.7. <a href="#pear-makefile">Пример Makefile для классов PEAR</a></dt><dt>6.8. <a href="#wx-components-example">Выбор компонентов
	  <span class="application">wxWidgets</span></a></dt><dt>6.9. <a href="#wx-ver-det-example">Обнаружение установленных версий и компонентов
	  <span class="application">wxWidgets</span></a></dt><dt>6.10. <a href="#wx-premk-example">Использование переменных
	  <span class="application">wxWidgets</span> в командах</a></dt><dt>6.11. <a href="#lua-version-example">Выбор версии <span class="application">Lua</span></a></dt><dt>6.12. <a href="#lua-components-example">Выбор компонентов
	  <span class="application">Lua</span></a></dt><dt>6.13. <a href="#lua-ver-det-example">Обнаружение установленных версий и компонентов
	  <span class="application">Lua</span></a></dt><dt>6.14. <a href="#lua-variables-example">Указание для порта, где искать
	  <span class="application">Lua</span></a></dt><dt>6.15. <a href="#lua-premk-example">Использование переменных
	  <span class="application">Lua</span> в командах</a></dt><dt>6.16. <a href="#iconv-simple-use">Простое использование <code class="command">iconv</code></a></dt><dt>6.17. <a href="#iconv-configure-use">Использование <code class="command">iconv</code> с
	<code class="command">configure</code></a></dt><dt>6.18. <a href="#iconv-reinplace">Исправление жёстко заданного
	<code class="literal">-liconv</code></a></dt><dt>6.19. <a href="#iconv-conditional">Проверка доступности собственного
	<code class="command">iconv</code></a></dt><dt>12.1. <a href="#dot-error-breaks-index">Как избегать использования
	<code class="literal">.error</code></a></dt></dl></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="why-port"></a>Глава 1. Введение</h1></div></div></div><p>Коллекция портов FreeBSD является способом, используемым
    практически каждым для установки приложений ("портов") на FreeBSD.
    Как и почти всё остальное во FreeBSD, эта система в основном
    является добровольно поддерживаемым начинанием.  Важно иметь это
    в виду при чтении данного документа.</p><p>Во FreeBSD каждый может прислать новый порт либо изъявить
    желание поддерживать существующий порт, если его никто ещё никто
    не поддерживает-вам не нужно иметь никаких особых
    привилегий на внесение изменений, чтобы это делать.</p></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="own-port"></a>Глава 2. Как самому сделать новый порт</h1></div></div></div><p>Итак, вы интересуетесь, как создать собственный порт или
    обновить существующий?  Великолепно!</p><p>Ниже находятся некоторые указания по созданию нового порта
    для FreeBSD.  Если вы хотите обновить существующий порт, вы должны
    прочесть их, а затем <a class="xref" href="#port-upgrading" title="Глава 10. Обновление отдельного порта">Глава 10, <em>Обновление отдельного порта</em></a>.</p><p>Если этот документ недостаточно подробен, вы должны
    обратиться к файлу
    <code class="filename">/usr/ports/Mk/bsd.port.mk</code>, который
    включается в make-файл каждого порта.  Он хорошо
    прокомментирован, и даже если вы не занимаетесь хакингом
    make-файлов каждодневно, из него вы сможете узнать много нового.
    Кроме того, конкретные вопросы можно задать, послав письмо на
    адрес <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">Список рассылки, посвящённый Портам FreeBSD</a>.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Только часть переменных
      (<code class="varname"><em class="replaceable"><code>VAR</code></em></code>), которые
      могут быть переопределены, описаны в этом документе.
      Большинство (если не все) описаны в начале файла
      <code class="filename">/usr/ports/Mk/bsd.port.mk</code>; остальные,
      скорее всего, тоже там описаны.  Заметьте, что в этом файле
      используется нестандартная настройка шага табуляции:
      <span class="application">Emacs</span> и
      <span class="application">Vim</span> должны распознать это при
      загрузке файла.  Как <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vi&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">vi</span>(1)</span></a>, так и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ex&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ex</span>(1)</span></a> могут быть
      настроены на использование правильного значения выдачей команды
      <code class="command">:set tabstop=4</code> после загрузки файла.</p></div><p>
    Ищете, с чего бы начать попроще? Посмотрите на <a class="link" href="http://wiki.freebsd.org/WantedPorts" target="_top">перечень
    запрошенных портов</a>, есть ли там такие, над которыми вы
    можете работать.</p></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="quick-porting"></a>Глава 3. Быстрое портирование</h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#porting-makefile">3.1. Создание файла <code class="filename">Makefile</code></a></span></dt><dt><span class="sect1"><a href="#porting-desc">3.2. Создание информационных файлов</a></span></dt><dt><span class="sect1"><a href="#porting-checksum">3.3. Создание файла с контрольной суммой</a></span></dt><dt><span class="sect1"><a href="#porting-testing">3.4. Тестирование порта</a></span></dt><dt><span class="sect1"><a href="#porting-portlint">3.5. Проверка вашего порта утилитой
      <code class="command">portlint</code></a></span></dt><dt><span class="sect1"><a href="#porting-submitting">3.6. Посылка нового порта</a></span></dt></dl></div><p>В этом разделе описано, как создать новый порт на скорую
    руку.  Во многих случаях этого бывает не достаточно, так что вам
    нужно будет прочитать документ дальше.</p><p>Во-первых, скачайте оригинальный tar-файл и поместите его в
    каталог <code class="varname">DISTDIR</code>, который по умолчанию есть не
    что иное, как <code class="filename">/usr/ports/distfiles</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Здесь предполагается, что программное обеспечение
      компилируется без проблем как есть, то есть для работы
      приложения на вашей системе FreeBSD не потребовалось абсолютно
      никаких изменений.  Если требовалось что-то изменить, то вам
      придется обратиться также и к следующему разделу.</p></div><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Перед началом портирования рекомендуется установить
      переменную <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> <code class="varname">DEVELOPER</code> в
      <code class="filename">/etc/make.conf</code>.</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>echo DEVELOPER=yes &gt;&gt; /etc/make.conf</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">Эта настройка включает <span class="quote"><<<span class="quote">режим разработчика</span>>></span>, в
      котором отображаются предупреждения при использовании
      устаревших конструкций и задействуются некоторые дополнительные
      проверки при вызове команды <code class="command">make</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-makefile"></a>3.1. Создание файла <code class="filename">Makefile</code></h2></div></div></div><p>Минимальный <code class="filename">Makefile</code> будет выглядеть
      примерно так:</p><pre class="programlisting"># $FreeBSD$

PORTNAME=	oneko
PORTVERSION=	1.1b
CATEGORIES=	games
MASTER_SITES=	ftp://ftp.cs.columbia.edu/archives/X11R5/contrib/

MAINTAINER=	youremail@example.com
COMMENT=	Cat chasing a mouse all over the screen

.include &lt;bsd.port.mk&gt;</pre><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">В некоторых случаях в заголовке
	<code class="filename">Makefile</code> существующего порта могут
	содержаться дополнительные строки, такие как название порта и
	дата его создания.  Эта дополнительная информация была
	объявлена устаревшей и находится в процессе удаления.</p></div><p>Посмотрим, сможете ли вы его понять.  Не обращайте внимание
      на содержимое строчки
      <code class="literal">$FreeBSD$</code>, она будет заполнена
      автоматически системой <span class="application">Subversion</span>,
      когда порт будет импортирован в наше дерево портов.  Вы можете
      найти более подробный пример в разделе <a class="link" href="#porting-samplem" title="Глава 13. Примерный Makefile">пример Makefile</a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-desc"></a>3.2. Создание информационных файлов</h2></div></div></div><p>Имеется два информационных файла, которые требуются для
      любого порта, вне зависимости от того, является ли он пакетом
      или нет.  Это <code class="filename">pkg-descr</code> и
      <code class="filename">pkg-plist</code>.  Префикс
      <code class="filename">pkg-</code> отличает их от других файлов.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp70214352"></a>3.2.1. <code class="filename">pkg-descr</code></h3></div></div></div><p>Это более подробное краткое описание порта.  От одного до
	нескольких абзацев, кратко описывающих, что представляет
	собой порт, будет достаточно.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Это <span class="emphasis"><em>не</em></span> руководство и не
	  подробнейшее описание того, как использовать или
	  компилировать порт!  <span class="emphasis"><em>Пожалуйста, будьте
	  внимательны при копировании текста из
	  <code class="filename">README</code> или страниц справочника
	  </em></span>; слишком часто они не являются кратким
	  описанием порта или имеют неудобный формат (например,
	  страницы справочника выровнены пробелами, что особенно
	  плохо смотрится с моноширинными шрифтами).</p></div><p>Хорошо составленный <code class="filename">pkg-descr</code>
	описывает порт достаточно полно, чтобы пользователю не
	приходилось сверяться с документацией или посещать вебсайт
	для понимания того, что делает данное программное
	обеспечение, чем оно может быть полезно или какие хорошие
	функции у него имеются.  Упоминание про определённые
	требования, такие как используемый графический
	инструментарий, тяжёлые зависимости, окружение для запуска
	или используемый язык программирования помогут пользователям
	определиться, будет ли этот порт для них работать.</p><p>Включите сюда URL официальной домашней страницы Интернет.
	Перед <span class="emphasis"><em>одним</em></span> из сайтов (выберите
	основной) добавьте <code class="literal">WWW:</code> (с последующим
	единичным пробелом) для того, чтобы вспомогательные утилиты
	работали правильно.  Если URI является корнем сайта или
	каталогом, то значение должно быть дополнено косой
	чертой.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если указанная для порта веб-страница не доступна,
	  попытайтесь сперва поискать, был ли официальный сайт
	  перемещён, переименован или размещён в другом месте.</p></div><p>Следующий пример показывает, как должен выглядеть ваш
	<code class="filename">pkg-descr</code>:</p><pre class="programlisting">This is a port of oneko, in which a cat chases a poor mouse all over
the screen.
 :
(etc.)

WWW: http://www.oneko.org/</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp70235856"></a>3.2.2. <code class="filename">pkg-plist</code></h3></div></div></div><p>Здесь перечисляются все файлы, устанавливаемые портом.
	Его также называют <span class="quote"><<<span class="quote">списком для упаковки</span>>></span>,
	потому что пакет генерируется упаковкой файлов, которые здесь
	указаны.  Имена путей указываются относительно установочного
	префикса (обычно <code class="filename">/usr/local</code>).  Если порт
	во время установки создает каталоги, убедитесь, что добавлены
	строки <code class="literal">@dirrm</code> для удаления каталогов при
	удалении пакета.</p><p>Вот маленький пример:</p><pre class="programlisting">bin/oneko
man/man1/oneko.1.gz
lib/X11/app-defaults/Oneko
lib/X11/oneko/cat1.xpm
lib/X11/oneko/cat2.xpm
lib/X11/oneko/mouse.xpm
@dirrm lib/X11/oneko</pre><p>Обратитесь к странице справочной системы по команде
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg-create&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pkg-create</span>(8)</span></a> с подробным описанием формата списка
	упаковки.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Рекомендуется, чтобы имена файлов в этом списке были
	  отсортированы в алфавитном порядке.  Это позволит
	  значительно облегчить сверку изменений при обновлении
	  порта.</p></div><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Создание списка упаковки вручную может оказаться весьма
	  трудоёмкой задачей.  Если порт устанавливает большое
	  количество файлов, раздел об <a class="link" href="#plist-autoplist" title="7.5. Автоматическое создание списка упаковки">автоматическом построении
	  списка упаковки</a> может помочь сэкономить
	  время.</p></div><p>Существует только одно исключение, когда у порта может
	отсутствовать <code class="filename">pkg-plist</code>.  Если порт
	устанавливает лишь несколько файлов, а возможно, и каталогов,
	то они могут быть перечислены в переменных
	<code class="varname">PLIST_FILES</code> и
	<code class="varname">PLIST_DIRS</code>, соответственно, внутри файла
	<code class="filename">Makefile</code> порта.  К примеру, мы можем
	обойтись без файла <code class="filename">pkg-plist</code> у
	приведённого выше порта <code class="filename">oneko</code>, добавив
	следующие строки в <code class="filename">Makefile</code>:</p><pre class="programlisting">PLIST_FILES=	bin/oneko \
		man/man1/oneko.1.gz \
		lib/X11/app-defaults/Oneko \
		lib/X11/oneko/cat1.xpm \
		lib/X11/oneko/cat2.xpm \
		lib/X11/oneko/mouse.xpm
PLIST_DIRS=	lib/X11/oneko</pre><p>Конечно, переменная <code class="varname">PLIST_DIRS</code> не
	должна задаваться, если порт не устанавливает никаких
	каталогов.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Несколько портов могут совместно использовать общий
	  каталог.  В этом случае <code class="varname">PLIST_DIRS</code>
	  следует заменить на <code class="varname">PLIST_DIRSTRY</code>, так
	  чтобы каталог удалялся только если он пуст, а иначе
	  игнорировался.  Использование <code class="varname">PLIST_DIRS</code>
	  и <code class="varname">PLIST_DIRSTRY</code> аналогично
	  <code class="literal">@dirrm</code> и <code class="literal">@dirrmtry</code> в
	  <code class="filename">pkg-plist</code>, описание которых входит в
	  <a class="xref" href="#plist-dir-cleaning" title="7.2.1. Очистка пустых каталогов">Раздел 7.2.1, <<Очистка пустых каталогов>></a>.</p></div><p>Обратной стороной такого способа перечисления файлов и
	каталогов порта является невозможность использования
	последовательностей команд, описанных в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg-create&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pkg-create</span>(8)</span></a>.
	Поэтому он подходит для простых портов, что делает их ещё
	более простыми.  Одновременно с этим положительным моментом
	является уменьшение количества файлов в коллекции портов.
	Пожалуйста, подумайте над использованием этой техники, прежде
	чем создавать <code class="filename">pkg-plist</code>.</p><p>Далее мы увидим, как можно использовать файлы
	<code class="filename">pkg-plist</code> и
	<code class="varname">PLIST_FILES</code> выполнения <a class="link" href="#plist" title="Глава 7. Продвинутые практики pkg-plist">более сложных задач</a>.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-checksum"></a>3.3. Создание файла с контрольной суммой</h2></div></div></div><p>Просто введите команду <code class="command">make makesum</code>.
      Правила утилиты make автоматически сгенерируют файл
      <code class="filename">distinfo</code>.</p><p>Если у извлекаемого файла регулярно меняется контрольная
      сумма и вы не сомневаетесь в надежности источника (т.е. он
      получен из CD производителя, либо ежедневно обновляется
      документация), то вы должны указать эти файлы в переменной
      <code class="varname">IGNOREFILES</code>.  Тогда контрольная сумма при
      выполнении <code class="command">make makesum</code> для этого файла
      создаваться не будет, а вместо этого для него будет установлено
      значение <code class="literal">IGNORE</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-testing"></a>3.4. Тестирование порта</h2></div></div></div><p>Вы должны удостовериться, что правила построения порта
      выполняют именно то, что вы хотите, включая создание пакета для
      порта.  Вот те важные вещи, которые вы должны проверить.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">pkg-plist</code> не содержит ничего сверх
	  того, что устанавливается портом</p></li><li class="listitem"><p><code class="filename">pkg-plist</code> содержит абсолютно все,
	  что устанавливается портом</p></li><li class="listitem"><p>Порт может быть установлен с помощью указания цели
	  <code class="buildtarget">install</code>.  Это позволяет
	  убедиться в правильной работе сценария установки.</p></li><li class="listitem"><p>Порт может быть правильным образом удалён с помощью
	  указания цели <code class="buildtarget">deinstall</code>.  Это
	  позволяет убедиться в правильной работе сценария
	  удаления.</p></li><li class="listitem"><p>Следует убедиться, что <code class="command">make package</code>
	  можно запустить из-под обычного пользователя (то есть, не
	  из-под <code class="systemitem">root</code>).
	  Если это не так, в <code class="filename">Makefile</code> порта
	  должно быть добавлено
	  <code class="literal">NEED_ROOT=yes</code>.</p></li></ul></div><div class="procedure"><a id="idp70348624"></a><div class="procedure-title">Процедура 3.1. Рекомендуемый порядок проверки</div><ol class="procedure" type="1"><li class="step"><p><code class="command">make stage</code></p></li><li class="step"><p><code class="command">make check-orphans</code></p></li><li class="step"><p><code class="command">make package</code></p></li><li class="step"><p><code class="command">make install</code></p></li><li class="step"><p><code class="command">make deinstall</code></p></li><li class="step"><p><code class="command">pkg add package-filename</code></p></li><li class="step"><p><code class="command">make package</code> (из-под
	  пользователя)</p></li></ol></div><p>Убедитесь, что на любом из этапов не выдается никаких
      предупреждений.</p><p>Основательное автоматизированное тестирование может быть
      выполнено при помощи <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/tinderbox/pkg-descr">ports-mgmt/tinderbox</a> или <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/poudriere/pkg-descr">ports-mgmt/poudriere</a> из Коллекции
      Портов.  Эти приложения используют <code class="literal">jails</code>,
      в которых проверяются все перечисленные выше этапы без
      изменения состояния основной системы.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-portlint"></a>3.5. Проверка вашего порта утилитой
      <code class="command">portlint</code></h2></div></div></div><p>Будьте добры, пользуйтесь утилитой
      <code class="command">portlint</code> для проверки того, что ваш порт
      соответствует нашим рекомендациям.  Программа <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/portlint/pkg-descr">ports-mgmt/portlint</a> является частью
      Коллекции Портов.  В частности, вы можете захотеть проверить,
      правильно ли сформирован файл <a class="link" href="#porting-samplem" title="Глава 13. Примерный Makefile">Makefile</a> и соответствующим
      ли образом именован <a class="link" href="#porting-pkgname" title="5.2.4. Соглашения по именованию пакетов">пакет</a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-submitting"></a>3.6. Посылка нового порта</h2></div></div></div><p>Перед посылкой нового порта прочитайте раздел о том, что
      <a class="link" href="#porting-dads" title="Глава 12. Что делать нужно, и что делать нельзя">можно и нельзя</a>
      делать.</p><p>Когда вы наконец довольны своим первым портом,
      единственное, что осталось сделать, это включить его в основное
      дерево портов FreeBSD и осчастливить этим всех остальных.  Нам не
      нужен ни каталог <code class="filename">work</code>, ни пакет
      <code class="filename">pkgname.tgz</code>, так что удалите их прямо
      сейчас.</p><p>Затем получите файл <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=shar&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">shar</span>(1)</span></a>.  Предполагая, что порт
      называется oneko, перейдите в каталог выше, где находится
      каталог <code class="literal">oneko</code>, и наберите:
      <code class="command">shar `find oneko` &gt; oneko.shar</code></p><p>Включите <code class="filename">oneko.shar</code> в сообщение об
      ошибке и пошлите его с помощью <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=send-pr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">send-pr</span>(1)</span></a>.  Обратитесь к
      разделу <a class="link" href="../../../../doc/ru_RU.KOI8-R/articles/contributing/contrib-how.html#CONTRIB-GENERAL" target="_top">Сообщения
	об ошибках и общие замечания</a> для получения подробной
      информации о <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=send-pr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">send-pr</span>(1)</span></a>).</p><p>Укажите в сообщении категорию <code class="literal">ports</code> и
      класс <code class="literal">change-request</code>.
      <span class="emphasis"><em>Не</em></span> указывайте, что сообщение имеет статус
      <code class="literal">confidential</code>!  Добавьте краткое описание
      программы в поле <span class="quote"><<<span class="quote">Description</span>>></span> отправляемого PR
      (например, содержимое <code class="varname">COMMENT</code> в сокращённом
      варианте) и сам файл в виде архива <code class="filename">.shar</code> в
      поле <span class="quote"><<<span class="quote">Fix</span>>></span>.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Хорошее описание в заголовке сообщения о проблеме
	значительно облегчает работу коммиттеров портов.  Для новых
	портов мы предпочитаем нечто вроде <span class="quote"><<<span class="quote">New port:
	  &lt;категория&gt;/&lt;название порта&gt; &lt;краткое
	  описание порта&gt;</span>>></span>.  Следование этой схеме упрощает
	и ускоряет начало работы по добавлению нового порта.</p></div><p>Повторим ещё раз, что <span class="emphasis"><em>не нужно включать ни
	оригинальный файл с дистрибутивом, ни каталог
	<code class="filename">work</code>, ни пакет, построенный вами
	командой <code class="command">make package</code></em></span>; для
      новых портов используйте <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=shar&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">shar</span>(1)</span></a>, но не
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>.</p><p>После отправки порта, пожалуйста, потерпите.  Время,
      необходимое для включения нового порта во FreeBSD, может занимать
      от нескольких дней до нескольких месяцев.  <a class="link" href="http://www.FreeBSD.org/cgi/query-pr-summary.cgi?category=ports" target="_top">
	Здесь</a> можно увидеть список ожидающих PR для
      портов.</p><p>После рассмотрения нового порта мы при необходимости вам
      ответим, а затем включим порт в наше дерево.  Ваше имя также
      будет добавлено в список <a class="link" href="../../../../doc/en_US.ISO8859-1/articles/contributors/contrib-additional.html" target="_top">
	Дополнительных контрибуторов проекта FreeBSD</a> и другие
      файлы.</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="slow-porting"></a>Глава 4. Медленное портирование</h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#slow-work">4.1. Как всё это работает</a></span></dt><dt><span class="sect1"><a href="#slow-sources">4.2. Получение исходного кода</a></span></dt><dt><span class="sect1"><a href="#slow-modifying">4.3. Модификация порта</a></span></dt><dt><span class="sect1"><a href="#slow-patch">4.4. Создание патчей</a></span></dt><dt><span class="sect1"><a href="#slow-configure">4.5. Конфигурирование</a></span></dt><dt><span class="sect1"><a href="#slow-user-input">4.6. Обработка пользовательского ввода</a></span></dt></dl></div><p>Итак, все оказалось не так уж и просто, и порт потребовал
    некоторых модификаций для того, чтобы заставить его работать.  В
    этом разделе мы расскажем, шаг за шагом, как его модифицировать,
    чтобы он работал с нашей системой портов.</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-work"></a>4.1. Как всё это работает</h2></div></div></div><p>Во-первых, когда пользователь дает в своем каталоге с
      портом команду <code class="command">make</code>, происходит целая череда
      событий.  Во время чтения этого текста может оказаться полезным
      иметь файл <code class="filename">bsd.port.mk</code> открытым в другом
      окне, что сильно поможет в их понимании.</p><p>Но не волнуйтесь сильно, если вы не до конца понимаете, что
      делается в <code class="filename">bsd.port.mk</code>, не так уж много
      людей его понимает... <span class="emphasis"><em>:-&gt;</em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Запускается цель <code class="buildtarget">fetch</code>.
	  Цель <code class="buildtarget">fetch</code> отвечает за то, что
	  архив исходных текстов имеется в наличии локально в
	  каталоге <code class="varname">DISTDIR</code>.  Если цель
	  <code class="buildtarget">fetch</code> не может найти требуемые
	  файлы в каталоге <code class="varname">DISTDIR</code>, то они будут
	  искаться по указателю URL <code class="varname">MASTER_SITES</code>,
	  который устанавливается в Makefile, а также на наших FTP
	  зеркалах, куда мы по возможности помещаем дистрибутивные
	  файлы для архива.  Затем она попытается сгрузить указанный
	  файл с помощью <code class="varname">FETCH</code>, полагая, что
	  запрашивающая машина имеет прямое подключение к Интернет.
	  Если файл скачается удачно, то он будет помещен в каталог
	  <code class="varname">DISTDIR</code> для последующего использования и
	  обработки.</p></li><li class="step"><p>Выполняется цель <code class="buildtarget">extract</code>.
	  Она ищет дистрибутивный файл порта (как правило, tar-архив
	  <code class="command">gzip</code>) в каталоге
	  <code class="varname">DISTDIR</code> и распаковывает его во временный
	  каталог, задаваемый переменной <code class="varname">WRKDIR</code>
	  (по умолчанию <code class="filename">work</code>).</p></li><li class="step"><p>Выполняется цель <code class="buildtarget">patch</code>.
	  Во-первых, применяются все патчи, заданные переменной
	  <code class="varname">PATCHFILES</code>.  Во-вторых, если какие-либо
	  файлы с патчами, носящие имена
	  <code class="filename">patch-*</code>, имеются в подкаталоге
	  <code class="varname">PATCHDIR</code> (по умолчанию это каталог
	  <code class="filename">files</code>), то они применяются в этот
	  момент в алфавитном порядке.</p></li><li class="step"><p>Запускается цель <code class="buildtarget">configure</code>.
	  Здесь может выполняться любая из многих различных
	  вещей.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Если существует скрипт
	      <code class="filename">scripts/configure</code>, то он
	      запускается.</p></li><li class="listitem"><p>Если задана переменная
	      <code class="varname">HAS_CONFIGURE</code> или
	      <code class="varname">GNU_CONFIGURE</code>, то запускается скрипт
	      <code class="filename">WRKSRC/configure</code>.</p></li></ol></div></li><li class="step"><p>Выполняется цель <code class="buildtarget">build</code>.  Она
	  отвечает за переход в собственный рабочий каталог порта
	  (<code class="varname">WRKSRC</code>) и его построение.</p></li><li class="step"><p>Выполняется цель <code class="buildtarget">stage</code>.
	  Конечный набор построенных файлов помещается во временный
	  каталог (<code class="varname">STAGEDIR</code>, смотрите <a class="xref" href="#staging" title="6.1. Staging">Раздел 6.1, <<Staging>></a>).  Иерархия этого каталога отражает
	  иерархию каталогов системы, в которую данный пакет будет
	  устанавливаться.</p></li><li class="step"><p>Выполняется цель <code class="buildtarget">install</code>.
	  В систему копируются файлы, перечисленные в pkg-plist
	  порта.</p></li></ol></div><p>Выше перечислены стандартные действия.  Кроме того, вы сами
      можете определить цели
      <code class="buildtarget">pre-<em class="replaceable"><code>что-то</code></em></code>
      или
      <code class="buildtarget">post-<em class="replaceable"><code>что-то</code></em></code>,
      или создать скрипты с такими именами в подкаталоге
      <code class="filename">scripts</code>, и они будут запущены до или после
      выполнения действий по умолчанию.</p><p>Например, если у вас есть цель
      <code class="buildtarget">post-extract</code>, определённая в вашем
      файле <code class="filename">Makefile</code> и файл
      <code class="filename">pre-build</code> в подкаталоге
      <code class="filename">scripts</code>, то после выполнения обычных
      действий по распаковке, будет вызвана цель
      <code class="buildtarget">post-extract</code> а скрипт
      <code class="filename">pre-build</code> будет выполнен перед запуском
      стандартных правил построения.  Рекомендуется использовать цели
      из <code class="filename">Makefile</code>, если действия достаточно
      просты, потому что в дальнейшем будет проще определить, какие
      нестандартные действия требует порт.</p><p>Действия по умолчанию выполняются целями
      <code class="buildtarget">do-<em class="replaceable"><code>что-то</code></em></code>
      из <code class="filename">bsd.port.mk</code>.  Например, команды для
      распаковки порта находятся в цели
      <code class="buildtarget">do-extract</code>.  Если вам не хватает
      цели по умолчанию, вы можете ее исправить, переопределив цель
      <code class="buildtarget">do-<em class="replaceable"><code>something</code></em></code>
      в вашем файле <code class="filename">Makefile</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml"><span class="quote"><<<span class="quote">Основные</span>>></span> цели (к примеру,
	<code class="buildtarget">extract</code>,
	<code class="buildtarget">configure</code> и так далее) не делают
	ничего больше, чем проверяют успешность завершения всех
	предыдущих шагов и вызывают настоящие цели или скрипты, и их
	не нужно менять.  Если вам нужно изменить распаковку,
	исправляйте <code class="buildtarget">do-extract</code>, но никогда
	не меняйте способ работы <code class="buildtarget">extract</code>!
	Кроме того, цель <code class="buildtarget">post-deinstall</code>
	является недействительной и не выполняется инфраструктурой
	портов.</p></div><p>Теперь, когда вы представляете, что происходит, когда
      пользователь набирает команду <code class="command">make install</code>,
      давайте пройдемся через шаги, рекомендуемые для создания
      настоящего порта.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-sources"></a>4.2. Получение исходного кода</h2></div></div></div><p>Получите оригинальные исходные тексты (обычно) в виде
      упакованного tar-архива (<code class="filename">foo.tar.gz</code> или
      <code class="filename">foo.tar.bz2</code>) и скопируйте его в каталог
      <code class="varname">DISTDIR</code>.  Всегда используйте исходные тексты
      <span class="emphasis"><em>основной ветки разработки</em></span> везде, где это
      возможно.</p><p>Вам потребуется задать значение переменной
      <code class="varname">MASTER_SITES</code> так, чтобы оно указывало на
      местоположение оригинального tar-архива.  В файле
      <code class="filename">bsd.sites.mk</code> вы найдёте краткие
      обозначения для большинства популярных сайтов.  Пожалуйста,
      используйте эти сайты-и соответствующие
      определения-везде, где это возможно, чтобы избежать
      проблем повторения одной и той же информации в базе источников.
      Так как эти сайты со временем меняются, для всех причастных
      поддержка становится настоящим кошмаром.</p><p>Если вы не можете найти FTP/HTTP сайт с хорошим
      подключением к сети, или находите только сайты, которые имеют
      раздражающе нестандартные форматы, то можете захотеть поместить
      копию на надежный сервер FTP или HTTP, который вам доступен
      (например, ваша домашняя страница).</p><p>Если вы не можете найти доступного и надёжного места для
      помещения дистрибутивного файла, то мы сами сможем разместить
      его на сервере <code class="systemitem">ftp.FreeBSD.org</code>; однако
      это наименее рекомендуемое решение.  Дистрибутивный файл должен
      быть помещён в каталог <code class="filename">~/public_distfiles/</code>
      одного из пользователей машины
      <code class="systemitem">freefall</code>.  Попросите того, кто
      коммиттил ваш порт, сделать это.  Этот человек также задаст
      переменной <code class="varname">MASTER_SITES</code> значение
      <code class="varname">MASTER_SITE_LOCAL</code>, а в переменной
      <code class="varname">MASTER_SITE_SUBDIR</code> укажет своё имя
      пользователя с машины <code class="systemitem">freefall</code>.</p><p>Если дистрибутивные файлы вашего порта постоянно меняются
      по неизвестным причинам без изменения версий со стороны автора,
      остаётся только поместить дистрибутив на вашу домашнюю
      Web-страницу и указать её первой в списке
      <code class="varname">MASTER_SITES</code>.  Если можете, попытайтесь
      договориться с автором порта об этом; это действительно
      помогает в достижении некоторого управления исходным кодом.
      Размещение собственной версии поможет избежать появления ошибок
      у пользователей типа <span class="errorname">checksum mismatch</span>,
      а также уменьшит нагрузку на людей, сопровождающих наш
      FTP-сервер.  Также, если у порта имеется только один основной
      сервер, то рекомендуется поместить архивную копию на свой сайт
      и указать его в списке <code class="varname">MASTER_SITES</code>
      вторым.</p><p>Если вашему порту требуются дополнительные `патчи',
      доступные в Интернет, скачайте также и их, поместив в каталог
      <code class="varname">DISTDIR</code>.  Не волнуйтесь, если они находятся
      не на том же сайте, откуда взят дистрибутивный архив, мы умеем
      обрабатывать такие ситуации (смотрите описание <a class="link" href="#porting-patchfiles" title="5.4.6. PATCHFILES">PATCHFILES</a> ниже).</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-modifying"></a>4.3. Модификация порта</h2></div></div></div><p>Распакуйте копию дистрибутивного файла в отдельный каталог
      и внесите изменения, которые необходимы для того, чтобы порт
      компилировался нормально в текущей версии FreeBSD.
      <span class="emphasis"><em>Тщательно отслеживайте</em></span> все, что вы
      делаете, этот процесс вам предстоит автоматизировать.  Все,
      включая удаление, добавление или модификацию в файлах должны
      будут выполняться автоматически с помощью скриптов или файлов
      патчей, когда вы завершите работу над портом.</p><p>Если вашему порту во время компиляции, установки и
      настройки требуется довольно много взаимодействовать с
      пользователем, то посмотрите на один из классических скриптов
      <span class="application">Configure</span> Лэрри Уолла (Larry Wall) и
      сделайте сами что-либо подобное.  Предназначение новой
      коллекции портов - это сделать каждое приложение в стиле
      <span class="quote"><<<span class="quote">plug-and-play</span>>></span> настолько, насколько это вообще
      возможно для конечного пользователя при минимальном
      использовании дискового пространства.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если явно не указано обратное, то патчи, скрипты и другие
	файлы, которые вы создали и предоставили для Коллекции Портов
	FreeBSD, неявно подпадают под стандартные условия лицензии
	BSD.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-patch"></a>4.4. Создание патчей</h2></div></div></div><p>Файлы, которые добавлялись или изменялись в процессе
      создания порта, могут быть выявлены программой <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>, а
      результат работы этой программы может быть в дальнейшем передан
      программе <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=patch&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">patch</span>(1)</span></a>.  Такое действие с обычным файлом
      подразумевает сохранение копии файла с первоначальным
      содержимым перед внесением каких-либо изменений.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>cp <em class="replaceable"><code>file</code></em> <em class="replaceable"><code>file</code></em>.orig</code></strong></pre><p>Патчи сохраняются в виде файлов с именем
      <code class="filename">patch-*</code>, где <em class="replaceable"><code>*</code></em>
      обозначает путь к файлу, к которому применяется патч, такой как
      <code class="filename">patch-Imakefile</code> или
      <code class="filename">patch-src-config.h</code>.</p><p>После того как файл был изменён, используется <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>
      для получения разницы между первоначальной и изменённой
      версиями.  Параметр <code class="option">-u</code> указывает <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>
      выводить разницу в <span class="quote"><<<span class="quote">унифицированном</span>>></span> формате,
      который также является предпочтительным.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>diff -u <em class="replaceable"><code>file</code></em>.orig <em class="replaceable"><code>file</code></em> &gt; patch-<em class="replaceable"><code>pathname-file</code></em></code></strong></pre><p>Для порождении патчей для новых добавляемых файлов
      используется параметр <code class="option">-N</code>, который заставляет
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> трактовать несуществующие прежде файлы как если бы
      они существовали, но имели пустое содержимое:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>diff -u -N <em class="replaceable"><code>newfile</code></em>.orig <em class="replaceable"><code>newfile</code></em> &gt; patch-<em class="replaceable"><code>pathname-newfile</code></em></code></strong></pre><p>Файлы с патчами помещаются в каталоге
      <code class="varname">PATCHDIR</code> (как правило, это <code class="filename">files/</code>), откуда они будут взяты
      автоматически.  Все патчи обязаны быть сделаны относительно
      каталога <code class="varname">WRKSRC</code> (как правило, это каталог, в
      который распаковывается исходный архив и где будет выполняться
      построение).  Для упрощения внесения изменений и обновлений
      избегайте наличия более чем одного патча для одного и того же
      файла (например, патчей <code class="filename">patch-file</code> и
      <code class="filename">patch-file2</code>, оба меняющих файл
      <code class="filename">WRKSRC/foobar.c</code>).  Обратите внимание, что
      если путь к изменяемому файлу содержит символ подчеркивания
      (<code class="literal">_</code>), то патч должен содержать в своем имени
      два подчеркивания вместо одного.  Например, для применения
      патча на файл с именем
      <code class="filename">src/freeglut_joystick.c</code> соответствующий
      патч следует назвать
      <code class="filename">patch-src-freeglut__joystick.c</code>.</p><p>Пожалуйста, используйте для именования патчей только
      символы <code class="literal">[-+._a-zA-Z0-9]</code>.  Не используйте
      любые другие символы, кроме этих.  Не называйте патчи как
      <code class="filename">patch-aa</code> или
      <code class="filename">patch-ab</code>, всегда ссылайтесь на путь и
      название файла в названиях самих патчей.</p><p>Существует альтернативный упрощённый способ создания патчей
      для существующих файлов.  Первые шаги те же самые: создание
      копии неизменённого файла с расширением
      <code class="filename">.orig</code> и внесение изменений.  После этого
      используйте <code class="command">make makepatch</code>, чтобы обновить
      файлы с патчами в каталоге <code class="filename">files</code> данного
      порта.</p><p>Не помещайте строки RCS в патчи.
      <span class="application">Subversion</span> будет изменять их при
      помещении файлов в дерево портов, и когда мы будем их оттуда
      извлекать, они будут уже другие, поэтому применение патчей
      окончится неудачей.  Строчки RCS предваряются знаком доллара
      (<code class="literal">$</code>), и обычно начинаются с
      <code class="literal">$Id</code> или
      <code class="literal">$RCS</code>.</p><p>Использование параметра рекурсии (<code class="option">-r</code>) с
      командой <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> для генерации патчей - это хорошо, но всё
      же, пожалуйста, смотрите на получающиеся патчи, чтобы убедиться
      в отсутствии ненужного мусора.  В частности, diff-разниц между
      двумя резервными копиями файлов, файлы
      <code class="filename">Makefile</code>, когда как порт использует
      <code class="command">Imake</code> или GNU-версию программы
      <code class="command">configure</code>, и так далее, не нужны, и должны
      быть удалены.  Если было необходимо отредактировать файл
      <code class="filename">configure.in</code> и запустить
      <code class="command">autoconf</code> для перегенерации
      <code class="command">configure</code>, не нужно включать файлы diff для
      <code class="command">configure</code> (они частенько вырастают до
      нескольких тысяч строк!).  Вместо этого задайте
      <code class="literal">USE_AUTOTOOLS=autoconf:261</code> и включите
      diff-файл для <code class="filename">configure.in</code>.</p><p>Старайтесь минимизировать в патчах объём нефункциональных
      изменений с пустыми символами.  В мире Открытого Исходного Кода
      является распространенным совместное использование проектами
      больших объемов кодовой базы, но с различными стилями и
      правилами отступов.  При копировании работающей функциональной
      части из одного проекта для исправления похожей области в
      другом, будьте аккуратны, пожалуйста: получаемый однострочный
      патч может указаться полон нефункциональных изменений.  Это не
      только увеличивает размер репозитория
      <span class="application">Subversion</span>, но также усложняет поиск
      того, что конкретно вызвало проблему и что вообще
      поменялось.</p><p>Если нужно удалить файл, сделайте это при выполнении цели
      <code class="buildtarget">post-extract</code>, вместо того чтобы
      оформлять это как часть патча.</p><p>Простые перемещения могут быть выполнены непосредственно из
      <code class="filename">Makefile</code> порта с использованием
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sed&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">sed</span>(1)</span></a> в режиме in-place.  Это удобно, когда при изменении
      используется значение переменной:</p><pre class="programlisting">post-patch:
	@${REINPLACE_CMD} -e 's|for Linux|for FreeBSD|g' ${WRKSRC}/README</pre><p>Довольно часто в исходных файлах портируемого программного
      обеспечения используется конвенция CR/LF.  Это может стать
      причиной проблем с дальнейшей упаковкой, предупреждениями
      компилятора или выполнением скриптов (таких как
      <code class="literal">/bin/sh^M not found</code>).  Для быстрого
      преобразования всех файлов из CR/LF просто в LF добавьте в
      <code class="filename">Makefile</code> порта эту запись:</p><pre class="programlisting">USES=	dos2unix</pre><p>Может быть задан точный список преобразуемых файлов:</p><pre class="programlisting">USES=	dos2unix
DOS2UNIX_FILES=	util.c util.h</pre><p>Используйте <code class="varname">DOS2UNIX_REGEX</code>, чтобы
      преобразовать группу файлов в разных подкаталогах.  Его
      параметром является регулярное выражение, совместимое с
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=find&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">find</span>(1)</span></a>.  Подробнее о формате в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=re_format&amp;sektion=7"><span class="citerefentry"><span class="refentrytitle">re_format</span>(7)</span></a>.  Такой
      вариант удобен для преобразования всех файлов заданного
      расширения.  Для примера, преобразуем все исходные файлы, не
      затрагивая двоичные файлы:</p><pre class="programlisting">USES=	dos2unix
DOS2UNIX_REGEX=	.*\.([ch]|cpp)</pre><p>Другим вариантом является использование
      <code class="varname">DOS2UNIX_GLOB</code>, который вызывает
      <code class="command">find</code> для каждого из перечисленных в нём
      элементов.</p><pre class="programlisting">USES=	dos2unix
DOS2UNIX_GLOB=	*.c *.cpp *.h</pre></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-configure"></a>4.5. Конфигурирование</h2></div></div></div><p>Поместите все дополнительные команды, требуемые для
      настройки, в ваш скрипт <code class="filename">configure</code> и
      сохраните его в подкаталоге <code class="filename">scripts</code>.  Как
      отмечено выше, вы можете сделать это целями в файле
      <code class="filename">Makefile</code> и/или скриптами с именами
      <code class="filename">pre-configure</code> или
      <code class="filename">post-configure</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-user-input"></a>4.6. Обработка пользовательского ввода</h2></div></div></div><p>Если для построения, конфигурации или установки вашего
      порта требуется некоторый ввод со стороны пользователя, то вы
      должны задать переменную <code class="varname">IS_INTERACTIVE</code> в
      вашем файле <code class="filename">Makefile</code>.  В случае
      <span class="quote"><<<span class="quote">ночного построения</span>>></span> это позволит пропустить ваш
      порт, если пользователь в своем окружении задал переменную
      <code class="envar">BATCH</code> (и если пользователь установил переменную
      <code class="envar">INTERACTIVE</code>, то будут строиться
      <span class="emphasis"><em>только</em></span> порты, которые требуют
      взаимодействия с пользователем.  Это сэкономит значительное
      количество времени на части машин, которые постоянно строят
      порты (смотрите ниже).</p><p>При наличии разумных ответов на задаваемые вопросы,
      подходящих по умолчанию, также рекомендуется проверять
      переменную <code class="varname">PACKAGE_BUILDING</code> и выключать
      интерактивный скрипт, если он есть.  Это позволит нам строить
      пакеты для помещения на компакт-диски и FTP-серверы.</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefiles"></a>Глава 5. Настройка файла Makefile</h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#makefile-source">5.1. Оригинальные исходный код</a></span></dt><dt><span class="sect1"><a href="#makefile-naming">5.2. Именование</a></span></dt><dt><span class="sect1"><a href="#makefile-categories">5.3. Разделение по категориям</a></span></dt><dt><span class="sect1"><a href="#makefile-distfiles">5.4. Дистрибутивные файлы</a></span></dt><dt><span class="sect1"><a href="#makefile-maintainer">5.5. <code class="varname">MAINTAINER</code></a></span></dt><dt><span class="sect1"><a href="#makefile-comment">5.6. <code class="varname">COMMENT</code></a></span></dt><dt><span class="sect1"><a href="#makefile-portscout">5.7. <code class="varname">PORTSCOUT</code></a></span></dt><dt><span class="sect1"><a href="#makefile-depend">5.8. Зависимости</a></span></dt><dt><span class="sect1"><a href="#makefile-masterdir">5.9. <code class="varname">MASTERDIR</code></a></span></dt><dt><span class="sect1"><a href="#makefile-manpages">5.10. Страницы Справочника</a></span></dt><dt><span class="sect1"><a href="#makefile-info">5.11. Файлы в формате info</a></span></dt><dt><span class="sect1"><a href="#makefile-options">5.12. Опции для Makefile</a></span></dt><dt><span class="sect1"><a href="#makefile-wrkdir">5.13. Задание рабочего каталога</a></span></dt><dt><span class="sect1"><a href="#conflicts">5.14. Разрешение конфликтов</a></span></dt><dt><span class="sect1"><a href="#install">5.15. Установка файлов</a></span></dt></dl></div><p>Настройка файла <code class="filename">Makefile</code> достаточно
    проста, и мы снова предполагаем, что перед тем, как начать, вы
    посмотрите на существующие примеры.  К тому же в этом руководстве
    имеется <a class="link" href="#porting-samplem" title="Глава 13. Примерный Makefile">примерный
      Makefile</a>, так что взгляните на него и, пожалуйста,
    следуйте порядку переменных и разделов в этом образце, чтобы
    облегчить чтение вашего порта другими людьми.</p><p>Итак, расположим решаемые задачи в порядке их возникновения
    при создании вашего нового файла
    <code class="filename">Makefile</code>:</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-source"></a>5.1. Оригинальные исходный код</h2></div></div></div><p>Находится ли он в каталоге <code class="varname">DISTDIR</code> в
      виде стандартного упакованного архиватором
      <code class="command">gzip</code> tar-архива с именем типа
      <code class="filename">foozolix-1.2.tar.gz</code>?  Если это так, можно
      перейти к следующему шагу.  Если нет, то вы должны попытаться
      переопределить некоторые из переменных
      <code class="varname">DISTVERSION</code>, <code class="varname">DISTNAME</code>,
      <code class="varname">EXTRACT_CMD</code>,
      <code class="varname">EXTRACT_BEFORE_ARGS</code>,
      <code class="varname">EXTRACT_AFTER_ARGS</code>,
      <code class="varname">EXTRACT_SUFX</code> или
      <code class="varname">DISTFILES</code> в зависимости от того, насколько
      необычен формат дистрибутивного файла.</p><p>В худшем случае вы можете просто определить свою
      собственную цель <code class="buildtarget">do-extract</code> для
      переопределения действий по умолчанию, хотя к этому нужно будет
      прибегать в очень редких случаях, если вообще придётся.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-naming"></a>5.2. Именование</h2></div></div></div><p>В первой части <code class="filename">Makefile</code> порта ему
      даётся название, указывается его номер версии и принадлежность
      к правильной категории.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp70830416"></a>5.2.1. <code class="varname">PORTNAME</code> и
	<code class="varname">PORTVERSION</code></h3></div></div></div><p>В переменной <code class="varname">PORTNAME</code> вы должны
	указать основную часть имени вашего порта, а в переменной
	<code class="varname">PORTVERSION</code> - номер версии.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-naming-revepoch"></a>5.2.2. <code class="varname">PORTREVISION</code> и
	<code class="varname">PORTEPOCH</code></h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp70840016"></a>5.2.2.1. <code class="varname">PORTREVISION</code></h4></div></div></div><p>Переменная <code class="varname">PORTREVISION</code> представляет
	  собой монотонно увеличивающееся число, которое обнуляется
	  при каждом увеличении значения переменной
	  <code class="varname">PORTVERSION</code> (то есть каждый раз, когда
	  создателями выпускается новый официальный релиз), и
	  добавляется к имени пакета, если оно не равно нулю.
	  Изменения в <code class="varname">PORTREVISION</code> используются
	  автоматизированными инструментами (например,
	  <code class="command">pkg version</code>, см. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg-version&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pkg-version</span>(8)</span></a>)
	  для определения факта появления нового пакета.</p><p>Значение <code class="varname">PORTREVISION</code> должно
	  увеличиваться каждый раз, когда в порте FreeBSD делаются
	  изменения, которые как-либо меняют получаемый пакет.  Сюда
	  относятся только изменения, затрагивающие построение пакета
	  с <a class="link" href="#makefile-options" title="5.12. Опции для Makefile">параметрами</a> по
	  умолчанию.</p><p>Примеры случаев, когда значение
	  <code class="varname">PORTREVISION</code> должно быть
	  увеличено:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Добавление патчей для исправления уязвимостей,
	      ошибок, или добавления новой функциональности в
	      порт.</p></li><li class="listitem"><p>Изменения в файле <code class="filename">Makefile</code>
	      порта для включения и выключения параметров,
	      определяемых при компиляции пакета.</p></li><li class="listitem"><p>Изменения в списке упаковки или в поведении пакета
	      во время его установки (например, изменение скрипта,
	      генерирующего начальные данные для пакета, такие, как
	      ssh-ключи для хоста).</p></li><li class="listitem"><p>Увеличение версии динамической библиотеки, от
	      которой зависит порт (в этом случае тот, кто попытается
	      установить старый пакет после установки более новой
	      версии библиотеки, не сможет этого сделать, потому что
	      при этом будет делаться поиск старой библиотеки
	      libfoo.x, а не libfoo.(x+1)).</p></li><li class="listitem"><p>Большие функциональные изменения в дистрибутивном
	      файле порта, происходящие без объявлений, и приводящие
	      к большим изменениям, то есть изменения в дистрибутиве
	      требуют корректировки файла
	      <code class="filename">distinfo</code> без соответствующего
	      изменения <code class="varname">PORTVERSION</code>, когда как
	      команда <code class="command">diff -ru</code> между новой и
	      старой версиями показывает нетривиальные изменения в
	      коде.</p></li></ul></div><p>Примеры изменений, которые не требуют увеличения
	  переменной <code class="varname">PORTREVISION</code>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Изменения стиля в скелете порта без функциональных
	      изменений в пакете.</p></li><li class="listitem"><p>Изменения в переменной
	      <code class="varname">MASTER_SITES</code> или другие
	      функциональные изменения порта, которые не затрагивают
	      получающегося пакета.</p></li><li class="listitem"><p>Тривиальные патчи к дистрибутивному файлу, такие,
	      как исправления опечаток, которые не так уж важны, что
	      пользователи пакета должны озаботиться
	      обновлением.</p></li><li class="listitem"><p>Исправления, касающиеся этапа построения, которые
	      делают возможным построение пакета, если ранее это было
	      невозможно сделать (пока изменения не приводят к
	      изменению работы на любых других платформах, на которых
	      порт ранее строился).  Так как
	      <code class="varname">PORTREVISION</code> отражает содержимое
	      пакета, то, если ранее пакет не строился, то нет нужды
	      увеличивать <code class="varname">PORTREVISION</code> для отметки
	      изменения.</p></li></ul></div><p>Правило, которому нужно приблизительно следовать,
	  заключается в том, что нужно спрашивать себя, является ли
	  вносимое в порт изменение таким, что от него выиграют все
	  (в виде усовершенствования, исправления или благодаря тому,
	  что новый пакет будет вообще работоспособным), и примите во
	  внимание тот факт, что при этом все, кто регулярно
	  обновляют своё дерево портов, будут обязаны это сделать.
	  Если это так, то переменная <code class="varname">PORTREVISION</code>
	  должна быть увеличена.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp70906832"></a>5.2.2.2. <code class="varname">PORTEPOCH</code></h4></div></div></div><p>Время от времени разработчик программного обеспечения
	  или создатель порта FreeBSD делают что-то не так и выпускают
	  версию программы, номер которой меньше предыдущей версии.
	  Примером этого является порт, название которого меняется с
	  foo-20000801 на foo-1.0 (изначально это не считалось бы
	  более новой версией, так как 20000801 численно больше, чем
	  1).</p><div xmlns="" class="tip"><h3 class="admontitle">Подсказка: </h3><p xmlns="http://www.w3.org/1999/xhtml">Результат сравнения номера версии не всегда очевиден.
	    Для выполнения сравнения двух строк с номером версии
	    можно использовать <code class="command">pkg version</code> (см.
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg-version&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pkg-version</span>(8)</span></a>).  Например:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">%</code> <strong class="userinput"><code>pkg version -t 0.031 0.29</code></strong>
&gt;</pre><p xmlns="http://www.w3.org/1999/xhtml">Строка <code class="literal">&gt;</code> в выводе команды
	    означает, что версия 0.031 считается выше, чем версия
	    0.29, что может быть не очевидно для того, кто выполняет
	    портирование.</p></div><p>В ситуациях, подобных этой, должно быть увеличено
	  значение <code class="varname">PORTEPOCH</code>.  Если значение
	  <code class="varname">PORTEPOCH</code> не равно нулю, то оно
	  добавляется к имени пакета, как описано в разделе выше.
	  Значение <code class="varname">PORTEPOCH</code> никогда не должно
	  уменьшаться или сбрасываться в ноль, потому что это
	  приведёт к ошибке сравнения с пакетом с меньшим номером
	  эпохи (то есть то, что пакет устарел, обнаружено не будет):
	  номер новой версии (например, <code class="literal">1.0,1</code> в
	  примере выше) останется меньше, чем номер предыдущей версии
	  (20000801), однако суффикс <code class="literal">,1</code>
	  интерпретируется различными автоматизированными утилитами
	  особым образом, и окажется больше, чем предполагаемый
	  суффикс <code class="literal">,0</code> более раннего пакета).</p><p>Некорректное уменьшение или сброс
	  <code class="varname">PORTEPOCH</code> приводит к печальным
	  последствиям; если вы не поняли, о чём шла речь ранее,
	  пожалуйста, всё же разберитесь с этим, либо спросите в
	  списках рассылки.</p><p>Предполагается, что в большинстве портов переменная
	  <code class="varname">PORTEPOCH</code> использоваться не будет, но
	  при корректном использовании <code class="varname">PORTVERSION</code>
	  может появиться необходимость её иметь, если в будущих
	  релизах программное обеспечение должно изменить структуру
	  номера версии.  Однако создателям портов для FreeBSD нужно
	  быть внимательными, когда разработчик выпускает релиз без
	  официального номера версии - эдакие
	  <span class="quote"><<<span class="quote">промежуточные</span>>></span> релизы.  Имеется соблазн
	  пометить релиз датой его выхода, что может вызвать
	  проблемы, как и в примере выше, когда будет выпущен новый
	  <span class="quote"><<<span class="quote">официальный</span>>></span> релиз.</p><p>Например, если промежуточный релиз помечен датой
	  20000917, а предыдущая версия программного обеспечения
	  имела номер 1.2, то промежуточному релизу должно быть
	  поставлено в соответствие значение
	  <code class="varname">PORTVERSION</code>, равное 1.2.20000917 или
	  что-то похожее, но не 20000917, так как последующий релиз,
	  скажем, 1.3, должен иметь численно большее значение.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp70938448"></a>5.2.2.3. Пример использования переменных
	  <code class="varname">PORTREVISION</code> и
	  <code class="varname">PORTEPOCH</code></h4></div></div></div><p>Выполнен коммит порта <code class="literal">gtkmumble</code>,
	  версии <code class="literal">0.10</code>, в коллекцию портов.</p><pre class="programlisting">PORTNAME=	gtkmumble
PORTVERSION=	0.10</pre><p>Значение <code class="varname">PKGNAME</code> станет равным
	  <code class="literal">gtkmumble-0.10</code>.</p><p>Обнаружена брешь в безопасности, исправление которой
	  потребовало создания локального патча для FreeBSD.
	  Соответственно было увеличено значение переменной
	  <code class="varname">PORTREVISION</code>.</p><pre class="programlisting">PORTNAME=	gtkmumble
PORTVERSION=	0.10
PORTREVISION=	1</pre><p><code class="varname">PKGNAME</code> принимает значение
	  <code class="literal">gtkmumble-0.10_1</code></p><p>Разработчиком выпущена новая версия с номером
	  <code class="literal">0.2</code> (оказалось, что под номером
	  <code class="literal">0.10</code> автор имел в виду
	  <code class="literal">0.1.0</code>, а не <span class="quote"><<<span class="quote">то, что будет
	  выпущено после версии 0.9</span>>></span> - извините, теперь уже
	  поздно).  Так как новый младший номер версии
	  <code class="literal">2</code> по значению меньше, чем номер
	  предыдущей версии <code class="literal">10</code>, то должно быть
	  увеличено значение <code class="varname">PORTEPOCH</code> для того,
	  чтобы заставить распознавать вновь создаваемый пакет как
	  <span class="quote"><<<span class="quote">более новый</span>>></span>.  Так как это новый релиз
	  программы, то <code class="varname">PORTREVISION</code> обнуляется
	  (или удаляется из файла
	  <code class="filename">Makefile</code>).</p><pre class="programlisting">PORTNAME=	gtkmumble
PORTVERSION=	0.2
PORTEPOCH=	1</pre><p><code class="varname">PKGNAME</code> принимает значение
	  <code class="literal">gtkmumble-0.2,1</code></p><p>Следующий релиз имеет номер версии 0.3.  Так как
	  значение переменной <code class="varname">PORTEPOCH</code> никогда не
	  уменьшается, что переменные, определяющие версии, теперь
	  выглядят так:</p><pre class="programlisting">PORTNAME=	gtkmumble
PORTVERSION=	0.3
PORTEPOCH=	1</pre><p><code class="varname">PKGNAME</code> принимает значение
	  <code class="literal">gtkmumble-0.3,1</code></p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если значение <code class="varname">PORTEPOCH</code> этим
	    обновлением было бы сброшено в <code class="literal">0</code>, то
	    кто-нибудь, имеющий установленный пакет
	    <code class="literal">gtkmumble-0.10_1</code>, не смог бы опознать
	    пакет <code class="literal">gtkmumble-0.3</code> как более новый,
	    так как <code class="literal">3</code> было бы меньше, чем
	    <code class="literal">10</code>.  Помните, что в первую очередь это
	    касается <code class="varname">PORTEPOCH</code>.</p></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp71006416"></a>5.2.3. Переменные <code class="varname">PKGNAMEPREFIX</code> и
	<code class="varname">PKGNAMESUFFIX</code></h3></div></div></div><p>Две необязательные переменные,
	<code class="varname">PKGNAMEPREFIX</code> и
	<code class="varname">PKGNAMESUFFIX</code>, объединяются со значениями
	<code class="varname">PORTNAME</code> и <code class="varname">PORTVERSION</code>
	для формирования <code class="varname">PKGNAME</code> в форме
	<code class="literal">${PKGNAMEPREFIX}${PORTNAME}${PKGNAMESUFFIX}-${PORTVERSION}</code>.
	Добейтесь того, чтобы это соответствовало нашим
	<a class="link" href="#porting-pkgname" title="5.2.4. Соглашения по именованию пакетов">рекомендациям по правильному
	  выбору названий для пакетов</a>.  В частности, в
	переменной <code class="varname">PORTVERSION</code> <span class="emphasis"><em>не
	разрешается</em></span> использование дефиса
	(<code class="literal">-</code>).  Кроме того, если в имени пакета
	присутствует часть <em class="replaceable"><code>language-</code></em> или
	<em class="replaceable"><code>-compiled.specifics</code></em> (смотрите
	ниже), то используйте переменные
	<code class="varname">PKGNAMEPREFIX</code> и
	<code class="varname">PKGNAMESUFFIX</code>, соответственно.  Не делайте
	их частью значения переменной
	<code class="varname">PORTNAME</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-pkgname"></a>5.2.4. Соглашения по именованию пакетов</h3></div></div></div><p>Далее описаны некоторые соглашения, которым вы должны
	следовать в именовании ваших пакетов.  Они были разработаны
	для облегчения просмотра каталога, так как имеется уже тысячи
	пакетов, а пользователи отвернутся от нас, если список не
	понравится их взору!</p><p>Имя пакета должно иметь вид
	<code class="filename">language_region-name-compiled.specifics-version.numbers</code>.</p><p>Имя пакета определяется как
	<code class="literal">${PKGNAMEPREFIX}${PORTNAME}${PKGNAMESUFFIX}-${PORTVERSION}</code>.
	Вы должны задавать значения переменных в соответствии с этим
	форматом.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>FreeBSD пытается поддерживать языки, на которых
	    разговаривают её пользователи.  Часть
	    <em class="replaceable"><code>language-</code></em> должна быть
	    двухсимвольным сокращением от названия языка по стандарту
	    ISO-639, если порт специфичен для конкретного языка.
	    Примерами являются <code class="literal">ja</code> для японского,
	    <code class="literal">ru</code> для русского, <code class="literal">vi</code>
	    для вьетнамского, <code class="literal">zh</code> для китайского,
	    <code class="literal">ko</code> для корейского и
	    <code class="literal">de</code> для немецкого языков.</p><p>Если ваш порт специфичен для конкретного региона
	    внутри области использования языка, добавьте также
	    двухсимвольный код страны.  Примерами являются
	    <code class="literal">en_US</code> для US English и
	    <code class="literal">fr_CH</code> для Swiss French.</p><p>Часть <em class="replaceable"><code>language-</code></em> должна
	    задаваться в переменной
	    <code class="varname">PKGNAMEPREFIX</code>.</p></li><li class="listitem"><p>Первая буква части <code class="filename">name</code> должна
	    быть в нижнем регистре.  (Оставшаяся часть названия может
	    содержать буквы в верхнем регистре, так что принимайте
	    решение сами, когда преобразуете имя программного пакета,
	    содержащего в имени некоторое количество заглавных букв.)
	    Существует традиция именовать модули для <code class="literal">Perl
	    5</code>, добавляя впереди <code class="literal">p5-</code> и
	    преобразуя пару двоеточий в дефис; например, модуль
	    <code class="literal">Data::Dumper</code> будет именоваться
	    <code class="literal">p5-Data-Dumper</code>.</p></li><li class="listitem"><p>Убедитесь, что имя порта и версия четко отделены и
	    размещаются в переменных <code class="varname">PORTNAME</code> и
	    <code class="varname">PORTVERSION</code>.  Единственная причина, по
	    которой <code class="varname">PORTNAME</code> содержит версионную
	    часть, это если полученный дистрибутив сам назван таким
	    образом, как это сделано для портов
	    <code class="filename">textproc/libxml2</code> или
	    <code class="filename">japanese/kinput2-freewnn</code>.  В
	    противном случае <code class="varname">PORTNAME</code> не должен
	    содержать никакой информации, указывающей на версию.  То,
	    что некоторые порты имеют одинаковый
	    <code class="varname">PORTNAME</code>, является вполне нормальным,
	    как для портов <code class="filename">www/apache*</code>; в этом
	    случае различные версии (и различные записи в индексе)
	    отличаются по значениям <code class="varname">PKGNAMEPREFIX</code>
	    и <code class="varname">PKGNAMESUFFIX</code>.</p></li><li class="listitem"><p>Если порт может быть построен с различными
	    <a class="link" href="#makefile-masterdir" title="5.9. MASTERDIR">статически заданными
		значениями по умолчанию</a> (обычно это часть
	    имени каталога в семействе портов), то часть
	    <em class="replaceable"><code>-compiled.specifics</code></em> должна
	    определять вкомпилированные значения по умолчанию
	    (дефис не обязателен).  Примерами являются размеры
	    бумаги и шрифтов.</p><p>Часть <em class="replaceable"><code>-compiled.specifics</code></em>
	    должна задаваться в переменной
	    <code class="varname">PKGNAMESUFFIX</code>.</p></li><li class="listitem"><p>Строка с номером версии должна следовать за дефисом
	    (<code class="literal">-</code>) и являться списком разделенных
	    двоеточием чисел и букв в нижнем регистре.  В частности,
	    не разрешается иметь еще один дефис внутри строки с
	    обозначением номера версии.  Единственным исключением
	    является строчка <code class="literal">pl</code> (означающая
	    <span class="quote"><<<span class="quote">patchlevel</span>>></span>), которая может использоваться
	    <span class="emphasis"><em>только</em></span> тогда, когда у программного
	    обеспечения нет старшего и младшего номера версии.  Если
	    в номер версии программного обеспечения включена строчка
	    типа <span class="quote"><<<span class="quote">alpha</span>>></span>, <span class="quote"><<<span class="quote">beta</span>>></span>,
	    <span class="quote"><<<span class="quote">rc</span>>></span> или <span class="quote"><<<span class="quote">pre</span>>></span>, возьмите из неё
	    первую букву и поставьте её непосредственно после точки.
	    Если после таких строк номер версии ещё продолжается, то
	    после буквы должно следовать число без дополнительной
	    разделяющей точки.</p><p>Смысл такого формата заключается в удобстве
	    сортировки портов по номеру версии.  В частности, следите
	    за тем, чтобы компоненты номера версии разделялись
	    точкой, и если там присутствует дата, то используйте
	    формат <code class="literal">0.0.yyyy.mm.dd</code>, но не
	    <code class="literal">dd.mm.yyyy</code> или не совместимый с
	    проблемой Y2K <code class="literal">yy.mm.dd</code>.  Добавление к
	    версии префикса <code class="literal">0.0.</code> является важным,
	    в случае если выпущен релиз с присвоением настоящей
	    версии, которая в числовом представлении, конечно же,
	    будет ниже, чем <code class="literal">yyyy</code>.</p></li></ol></div><p>Вот несколько (реальных) примеров того, как преобразовать
	имя из оригинального, придуманного авторами, к подходящему
	для имени пакета:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /><col /><col /><col /></colgroup><thead><tr><th>Имя дистрибутива</th><th><code class="varname">PKGNAMEPREFIX</code></th><th><code class="varname">PORTNAME</code></th><th><code class="varname">PKGNAMESUFFIX</code></th><th><code class="varname">PORTVERSION</code></th><th>Обоснование</th></tr></thead><tbody><tr><td>mule-2.2.2</td><td>(пусто)</td><td>mule</td><td>(пусто)</td><td>2.2.2</td><td>Изменений не потребовалось</td></tr><tr><td>EmiClock-1.0.2</td><td>(пусто)</td><td>emiclock</td><td>(пусто)</td><td>1.0.2</td><td>Для отдельных программ имена с заглавными
		буквами запрещены</td></tr><tr><td>rdist-1.3alpha</td><td>(пусто)</td><td>rdist</td><td>(пусто)</td><td>1.3.a</td><td>Строчки типа <code class="literal">alpha</code>
		запрещены</td></tr><tr><td>es-0.9-beta1</td><td>(пусто)</td><td>es</td><td>(пусто)</td><td>0.9.b1</td><td>Строчки типа <code class="literal">beta</code>
		запрещены</td></tr><tr><td>mailman-2.0rc3</td><td>(пусто)</td><td>mailman</td><td>(пусто)</td><td>2.0.r3</td><td>Строчки типа <code class="literal">rc</code>
		запрещены</td></tr><tr><td>v3.3beta021.src</td><td>(пусто)</td><td>tiff</td><td>(пусто)</td><td>3.3</td><td>Что это такое было вообще?</td></tr><tr><td>tvtwm</td><td>(пусто)</td><td>tvtwm</td><td>(пусто)</td><td>pl11</td><td>Всегда требуется указание номера версии</td></tr><tr><td>piewm</td><td>(пусто)</td><td>piewm</td><td>(пусто)</td><td>1.0</td><td>Всегда требуется указание номера версии</td></tr><tr><td>xvgr-2.10pl1</td><td>(пусто)</td><td>xvgr</td><td>(пусто)</td><td>2.10.1</td><td><code class="literal">pl</code> разрешено только при
		отсутствии старшего/младшего номера версии</td></tr><tr><td>gawk-2.15.6</td><td>ja-</td><td>gawk</td><td>(пусто)</td><td>2.15.6</td><td>Версия на японском языке</td></tr><tr><td>psutils-1.13</td><td>(пусто)</td><td>psutils</td><td>-letter</td><td>1.13</td><td>Размер бумаги задается статически во время
		построения пакета</td></tr><tr><td>pkfonts</td><td>(пусто)</td><td>pkfonts</td><td>300</td><td>1.0</td><td>пакет для шрифтов 300dpi</td></tr></tbody></table></div><p>Если в исходном коде абсолютно нет информации о номере
	версии и не похоже, что автор собирается выпускать другую
	версию, то в качестве номера версии задайте просто
	<code class="literal">1.0</code> (как в примере с
	<code class="literal">piewm</code> выше).  В противном случае спросите
	автора программы или используйте дату
	(<code class="literal">0.0.yyyy.mm.dd</code>) в качестве номера
	версии.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-categories"></a>5.3. Разделение по категориям</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp71271248"></a>5.3.1. <code class="varname">CATEGORIES</code></h3></div></div></div><p>В процессе создания пакета он помещается в каталог
	<code class="filename">/usr/ports/packages/All</code>, а в одном или
	более подкаталогов из
	<code class="filename">/usr/ports/packages</code> создаются на него
	ссылки.  Имена этих подкаталогов определяются переменной
	<code class="varname">CATEGORIES</code>.  Такая схема нужна для
	облегчения жизни пользователя, когда он сталкивается с массой
	пакетов на FTP-сервере или компакт-диске.  Пожалуйста,
	посмотрите на <a class="link" href="#porting-categories" title="5.3.2. Текущий список категорий">текущий
	  список категорий</a> и выберите те из них, которые более
	всего подходят к вашему порту.</p><p>Этот список также определяет, куда в дереве портов будет
	помещен порт.  Если вы укажете здесь более одной категории,
	то предполагается, что файлы порта будут помещены в
	подкаталог с именем первой категории.  Посмотрите
	<a class="link" href="#choosing-categories" title="5.3.3. Выбор правильной категории">ниже</a> для получения
	подробной информации о том, как правильно выбрать
	категории.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-categories"></a>5.3.2. Текущий список категорий</h3></div></div></div><p>Вот текущий список категорий.  Те, которые отмечены
	звёздочкой (<code class="literal">*</code>), являются
	<span class="emphasis"><em>виртуальными</em></span> категориями-они не
	имеют собственного подкаталога в дереве портов.  Они
	используются только в качестве вторичных категорий, и только
	для поиска.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Для невиртуальных категорий имеется однострочное
	  описание в <code class="varname">COMMENT</code> в
	  <code class="filename">Makefile</code> соответствующего
	  подкаталога.</p></div><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Категория</th><th>Описание</th><th>Примечания</th></tr></thead><tbody><tr><td><code class="filename">accessibility</code></td><td>Порты для помощи пользователям с ограниченными
		возможностями.</td><td> </td></tr><tr><td><code class="filename">afterstep*</code></td><td>Порты, поддерживающие менеджер окон <a class="link" href="http://www.afterstep.org" target="_top">AfterStep</a>.</td><td> </td></tr><tr><td><code class="filename">arabic</code></td><td>Поддержка арабского языка.</td><td> </td></tr><tr><td><code class="filename">archivers</code></td><td>Инструменты для работы с архивами.</td><td> </td></tr><tr><td><code class="filename">astro</code></td><td>Приложения, связанные с астрономией.</td><td> </td></tr><tr><td><code class="filename">audio</code></td><td>Поддержка работы со звуком.</td><td> </td></tr><tr><td><code class="filename">benchmarks</code></td><td>Утилиты для измерения производительности
		системы.</td><td> </td></tr><tr><td><code class="filename">biology</code></td><td>Программное обеспечение, связанное с
		биологией.</td><td> </td></tr><tr><td><code class="filename">cad</code></td><td>Инструменты Систем Автоматизированного
		Проектирования.</td><td> </td></tr><tr><td><code class="filename">chinese</code></td><td>Поддержка китайского языка.</td><td> </td></tr><tr><td><code class="filename">comms</code></td><td>Коммуникационное программное
		обеспечение.</td><td>В основном программы для работы с
		последовательным портом.</td></tr><tr><td><code class="filename">converters</code></td><td>Утилиты для преобразования символьных
		форматов.</td><td> </td></tr><tr><td><code class="filename">databases</code></td><td>Базы данных.</td><td> </td></tr><tr><td><code class="filename">deskutils</code></td><td>То, что было на столе до изобретения
		компьютеров.</td><td> </td></tr><tr><td><code class="filename">devel</code></td><td>Утилиты для разработки программного
		обеспечения.</td><td>Не помещайте сюда библиотеки просто потому, что
		это библиотеки-если они подпадают под какую-то
		другую категорию, то их быть здесь не должно.</td></tr><tr><td><code class="filename">dns</code></td><td>Программное обеспечение для работы DNS.</td><td> </td></tr><tr><td><code class="filename">docs*</code></td><td>Мета-порты для документации FreeBSD.</td><td> </td></tr><tr><td><code class="filename">editors</code></td><td>Редакторы общего назначения.</td><td>Специализированные редакторы относят к разделу
		для соответствующих инструментов (например, редактор
		математических формул попадает в категорию
		<code class="filename">math</code>).</td></tr><tr><td><code class="filename">elisp*</code></td><td>Порты для Emacs lisp.</td><td> </td></tr><tr><td><code class="filename">emulators</code></td><td>Эмуляторы других операционных систем.</td><td>Эмуляторы терминалов сюда
		<span class="emphasis"><em>не</em></span> относятся-те, которые
		разработаны для X, должны быть в категории
		<code class="filename">x11</code>, а текстовые в
		<code class="filename">comms</code> или
		<code class="filename">misc</code>, в зависимости от
		конкретного их предназначения.</td></tr><tr><td><code class="filename">finance</code></td><td>Приложения для работы с деньгами, финансами и
		всем, что с этим связано.</td><td> </td></tr><tr><td><code class="filename">french</code></td><td>Поддержка французского языка.</td><td> </td></tr><tr><td><code class="filename">ftp</code></td><td>Клиенты и серверы FTP.</td><td>Если ваш порт понимает как FTP, так и HTTP,
		поместите его в категорию <code class="filename">ftp</code> и
		укажите вторичную категорию
		<code class="filename">www</code>.</td></tr><tr><td><code class="filename">games</code></td><td>Игры.</td><td> </td></tr><tr><td><code class="filename">geography*</code></td><td>Программное обеспечение, связанное с
		географией.</td><td> </td></tr><tr><td><code class="filename">german</code></td><td>Поддержка немецкого языка.</td><td> </td></tr><tr><td><code class="filename">gnome*</code></td><td>Порты Проекта <a class="link" href="http://www.gnome.org" target="_top">GNOME</a>.</td><td> </td></tr><tr><td><code class="filename">gnustep*</code></td><td>Программное обеспечение для окружения рабочего
		стола GNUstep.</td><td> </td></tr><tr><td><code class="filename">graphics</code></td><td>Графические утилиты.</td><td> </td></tr><tr><td><code class="filename">hamradio*</code></td><td>Программное обеспечение для любительского
		радио</td><td> </td></tr><tr><td><code class="filename">haskell*</code></td><td>Программное обеспечение, связанное с языком
		Haskell.</td><td> </td></tr><tr><td><code class="filename">hebrew</code></td><td>Поддержка иврита.</td><td> </td></tr><tr><td><code class="filename">hungarian</code></td><td>Поддержка венгерского языка.</td><td> </td></tr><tr><td><code class="filename">ipv6*</code></td><td>Программное обеспечение, связанное с
		IPv6.</td><td> </td></tr><tr><td><code class="filename">irc</code></td><td>Утилиты для Internet Relay Chat.</td><td> </td></tr><tr><td><code class="filename">japanese</code></td><td>Поддержка японского языка.</td><td> </td></tr><tr><td><code class="filename">java</code></td><td>Программное обеспечение, связанное с языком
		JavaTM.</td><td>Категория <code class="filename">java</code> ни в коем
		случае не должна быть единственной для порта.
		Оставьте для портов, непосредственно имеющих
		отношение к языку Java, портерам также рекомендуется
		не использовать <code class="filename">java</code> как
		основную категорию порта.</td></tr><tr><td><code class="filename">kde*</code></td><td>Порты проекта <a class="link" href="http://www.kde.org" target="_top">KDE</a>.</td><td> </td></tr><tr><td><code class="filename">kld*</code></td><td>Загружаемые модули ядра.</td><td> </td></tr><tr><td><code class="filename">korean</code></td><td>Поддержка корейского языка.</td><td> </td></tr><tr><td><code class="filename">lang</code></td><td>Языки программирования.</td><td> </td></tr><tr><td><code class="filename">linux*</code></td><td>Linux приложения и утилиты.</td><td> </td></tr><tr><td><code class="filename">lisp*</code></td><td>Программное обеспечение, связанное с языком
		Lisp.</td><td> </td></tr><tr><td><code class="filename">mail</code></td><td>Программы для работы с почтой.</td><td> </td></tr><tr><td><code class="filename">math</code></td><td>Программное обеспечение для численных вычислений
		и другие утилиты, связанные с математикой.</td><td> </td></tr><tr><td><code class="filename">mbone*</code></td><td>Приложения для MBone.</td><td> </td></tr><tr><td><code class="filename">misc</code></td><td>Различные утилиты</td><td>В общем, то, что не попадает в другие категории.
		Если это возможно, попробуйте найти более подходящую,
		чем <code class="literal">misc</code>, категорию для вашего
		порта, так как здесь порты теряются.</td></tr><tr><td><code class="filename">multimedia</code></td><td>Программное обеспечение для работы с
		мультимедиа.</td><td> </td></tr><tr><td><code class="filename">net</code></td><td>Различное сетевое программное
		обеспечение.</td><td> </td></tr><tr><td><code class="filename">net-im</code></td><td>Программы мгновенного обмена
		сообщениями.</td><td> </td></tr><tr><td><code class="filename">net-mgmt</code></td><td>Программное обеспечение для сетевого
		управления.</td><td> </td></tr><tr><td><code class="filename">net-p2p</code></td><td>Приложения для пиринговых сетей.</td><td> </td></tr><tr><td><code class="filename">news</code></td><td>Программное обеспечение для работы с
		конференциями USENET.</td><td> </td></tr><tr><td><code class="filename">palm</code></td><td>Программная поддержка <a class="link" href="http://www.palm.com/" target="_top">PalmTM</a>.</td><td> </td></tr><tr><td><code class="filename">parallel*</code></td><td>Приложения, связанные с параллельными
		вычислениями.</td><td> </td></tr><tr><td><code class="filename">pear*</code></td><td>Порты, относящиеся к технологии Pear
		PHP.</td><td> </td></tr><tr><td><code class="filename">perl5*</code></td><td>Порты, которым для работы требуется
		<span class="application">Perl</span> версии 5.</td><td> </td></tr><tr><td><code class="filename">plan9*</code></td><td>Различные программы из <a class="link" href="http://www.cs.bell-labs.com/plan9dist/" target="_top">Plan9</a>.</td><td> </td></tr><tr><td><code class="filename">polish</code></td><td>Поддержка польского языка.</td><td> </td></tr><tr><td><code class="filename">ports-mgmt</code></td><td>Порты для управления, установки и разработки
		портов и пакетов FreeBSD.</td><td> </td></tr><tr><td><code class="filename">portuguese</code></td><td>Поддержка португальского языка.</td><td> </td></tr><tr><td><code class="filename">print</code></td><td>Программное обеспечение для печати.</td><td>Инструменты для вёрстки (просмотрщики и тому
		подобное) тоже относятся сюда.</td></tr><tr><td><code class="filename">python*</code></td><td>Программное обеспечение, связанное с языком
		<a class="link" href="http://www.python.org/" target="_top">Python</a>.</td><td> </td></tr><tr><td><code class="filename">ruby*</code></td><td>Программное обеспечение, связанное с языком
		<a class="link" href="http://www.ruby-lang.org/" target="_top">Ruby</a>.</td><td> </td></tr><tr><td><code class="filename">rubygems*</code></td><td>Порты для пакетов <a class="link" href="http://www.rubygems.org/" target="_top">RubyGems</a>.</td><td> </td></tr><tr><td><code class="filename">russian</code></td><td>Поддержка русского языка.</td><td> </td></tr><tr><td><code class="filename">scheme*</code></td><td>Программное обеспечение, связанное с языком
		Scheme.</td><td> </td></tr><tr><td><code class="filename">science</code></td><td>Научные программы, которые не подпадают под
		другие категории, скажем, <code class="filename">astro</code>,
		<code class="filename">biology</code> или
		<code class="filename">math</code>.</td><td> </td></tr><tr><td><code class="filename">security</code></td><td>Программы, обеспечивающие безопасность
		системы.</td><td> </td></tr><tr><td><code class="filename">shells</code></td><td>Различные командные процессоры.</td><td> </td></tr><tr><td><code class="filename">sysutils</code></td><td>Системные утилиты.</td><td> </td></tr><tr><td><code class="filename">spanish*</code></td><td>Поддержка испанского языка.</td><td> </td></tr><tr><td><code class="filename">tcl*</code></td><td>Порты, для работы которых нужен Tcl.</td><td> </td></tr><tr><td><code class="filename">textproc</code></td><td>Утилиты для обработки текстов.</td><td>Инструменты для вёрстки помещаются в категорию
		<code class="filename">print</code>, а не сюда.</td></tr><tr><td><code class="filename">tk*</code></td><td>Порты, для работы которых нужен Tk.</td><td> </td></tr><tr><td><code class="filename">ukrainian</code></td><td>Поддержка украинского языка.</td><td> </td></tr><tr><td><code class="filename">vietnamese</code></td><td>Поддержка вьетнамского языка.</td><td> </td></tr><tr><td><code class="filename">windowmaker*</code></td><td>Порты для поддержки менеджера окон
		WindowMaker.</td><td> </td></tr><tr><td><code class="filename">www</code></td><td>Программное обеспечение, связанное со всемирной
		паутиной.</td><td>Поддержка языка HTML относится сюда же.</td></tr><tr><td><code class="filename">x11</code></td><td>X Window System и иже с ними.</td><td>Эта категория предназначена только для
		программного обеспечения, которое поддерживает саму
		оконную систему.  Не помещайте сюда обычные
		приложения для X: большинство из них должны быть
		перенесены в другие категории
		<code class="filename">x11-*</code> (смотрите ниже).</td></tr><tr><td><code class="filename">x11-clocks</code></td><td>Часы для X11.</td><td> </td></tr><tr><td><code class="filename">x11-drivers</code></td><td>Драйверы X11.</td><td> </td></tr><tr><td><code class="filename">x11-fm</code></td><td>Менеджеры файлов для X11.</td><td> </td></tr><tr><td><code class="filename">x11-fonts</code></td><td>Шрифты для X11 и утилиты для работы с
		ними.</td><td> </td></tr><tr><td><code class="filename">x11-servers</code></td><td>Серверы для X11.</td><td> </td></tr><tr><td><code class="filename">x11-themes</code></td><td>Темы для X11.</td><td> </td></tr><tr><td><code class="filename">x11-toolkits</code></td><td>Пакеты разработчика для X11.</td><td> </td></tr><tr><td><code class="filename">x11-wm</code></td><td>Оконные менеджеры для X11.</td><td> </td></tr><tr><td><code class="filename">xfce*</code></td><td>Порты, связанные с окружением рабочего стола
		<a class="link" href="http://www.xfce.org/" target="_top">Xfce</a>.</td><td> </td></tr><tr><td><code class="filename">zope*</code></td><td>Поддержка <a class="link" href="http://www.zope.org/" target="_top">Zope</a>.</td><td> </td></tr></tbody></table></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="choosing-categories"></a>5.3.3. Выбор правильной категории</h3></div></div></div><p>Так как многие категории перекрываются, вам часто
	необходимо будет выбирать, какая их них должна быть основной
	для вашего порта.  Есть несколько правил, по которым можно
	решить этот вопрос.  Вот список приоритетов, в уменьшающейся
	степени предпочтения:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Первая категория должна быть физической категорий
	    (смотрите <a class="link" href="#porting-categories" title="5.3.2. Текущий список категорий">выше</a>).  Это
	    необходимо для создания пакетов.  После этого виртуальные
	    и физические категории могут смешиваться.</p></li><li class="listitem"><p>Сначала всегда идут категории, специфичные для
	    языков.  Например, если ваш порт устанавливает японские
	    шрифты для X11, то строчка <code class="varname">CATEGORIES</code>
	    должна иметь вид
	    <code class="filename">japanese x11-fonts</code>.</p></li><li class="listitem"><p>Более конкретные категории идут первыми перед более
	    общими.  В частности, редактор HTML должен быть описан
	    как <code class="filename">www editors</code>, а не наоборот.
	    Кроме того, вы не должны указывать категорию
	    <code class="filename">net</code>, если порт относится к одной из
	    категорий <code class="filename">irc</code>,
	    <code class="filename">mail</code>, <code class="filename">news</code>,
	    <code class="filename">security</code> или
	    <code class="filename">www</code>, так как
	    <code class="filename">net</code> включается автоматически.</p></li><li class="listitem"><p><code class="filename">x11</code> используется как вторичная
	    категория только в случае, если в качестве основной
	    категории указан естественный язык.  В частности, вам не
	    нужно указывать <code class="filename">x11</code> в качестве
	    категории для приложений X.</p></li><li class="listitem"><p>Режимы для редактора <span class="application">Emacs</span>
	    должны помещаться в ту же категорию, что и приложение,
	    которое поддерживается этим режимом, а не в
	    <code class="filename">editors</code>.  Например,
	    режим <span class="application">Emacs</span> для редактирования
	    исходного кода некоторого языка программирования должен
	    быть помещен в категорию
	    <code class="filename">lang</code>.</p></li><li class="listitem"><p>Порты, устанавливающие загружаемые модули ядра,
	    должны содержать виртуальную категорию
	    <code class="filename">kld</code> в строке
	    <code class="varname">CATEGORIES</code>.  Это одно из действий,
	    выполняемых автоматически с добавлением
	    <code class="literal">kmod</code> в строке
	    <code class="varname">USES</code>.</p></li><li class="listitem"><p><code class="filename">misc</code> не должна указываться
	    вместе с любой другой невиртуальной категорией.  Если вы
	    указываете <code class="literal">misc</code> вместе с чем-то ещё в
	    строке <code class="varname">CATEGORIES</code>, это значит, что вы
	    можете спокойно удалить <code class="literal">misc</code> и просто
	    поместить порт в этот другой подкаталог!</p></li><li class="listitem"><p>Если ваш порт решительным образом не подпадает ни под
	    какую категорию, поместите его в
	    <code class="filename">misc</code>.</p></li></ul></div><p>Если вы не уверены в правильности выбора категории,
	пожалуйста, отметьте это в вашем сообщении <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=send-pr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">send-pr</span>(1)</span></a>,
	чтобы мы могли обсудить это до того, как включить порт в
	Коллекцию.  Если вы являетесь коммиттером, пошлите замечание
	на адрес <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">Список рассылки, посвящённый Портам FreeBSD</a>, чтобы мы могли обсудить это.  Зачастую
	новые порты помещаются не в ту категорию только для того,
	чтобы их оттуда сразу же удалили.  Это приводит к излишнему и
	ненужному росту основного хранилища исходных текстов.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="proposing-categories"></a>5.3.4. Предложение новой категории</h3></div></div></div><p>Поскольку со временем Коллекция Портов увеличилась, то в
	связи с этим были добавлены различные новые категории.  Новые
	категории могут быть или <span class="emphasis"><em>виртуальными</em></span>
	категориями-которые не имеют соответствующего
	подкаталога в дереве портов-или
	<span class="emphasis"><em>физическими</em></span> категориями-у которых
	он есть.  Следующий текст содержит обсуждение вопросов,
	возникающих при создании новой физической категории, чтобы вы
	могли понимать их, когда предложите новую категорию.</p><p>В соответствие с существующей практикой мы избегаем
	создания новой физической категории, пока достаточно большое
	число портов логически ей не принадлежит или же порты,
	которые могли бы ей принадлежать, не являются логически
	обособленной группой, представляющей для всех ограниченный
	интерес (в частности, категории, относящиеся к естественным
	языкам); предпочтительно выполнение обоих условий.</p><p>Основной причиной для этого является то, что такое
	изменение создает <a class="link" href="../../../../doc/ru_RU.KOI8-R/articles/committers-guide/#ports" target="_top">изрядное
	  количество работы</a> и для коммиттеров, и для всех тех
	пользователей, которые отслеживают изменения в Коллекции
	Портов.  В дополнение, предложенная категория создает
	естественное разногласие.  (Пожалуй, потому что не существует
	четкого соглашения, является ли категория <span class="quote"><<<span class="quote">слишком
	  большой</span>>></span>, или должны ли категории предоставлять себя
	для просмотра (и, таким образом, какое количество категорий
	было бы идеальным значением), и так далее.)</p><p>Процедура:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Предложите новую категорию на <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">Список рассылки, посвящённый Портам FreeBSD</a>.  Вам следует
	    включить для новой категории детальное обоснование, в том
	    числе почему вы считаете, что существующие категории не
	    являются достаточными, и список существующих портов,
	    предложенных для перемещения.  (Если есть новые порты,
	    ожидающие в <span class="application">GNATS</span> и попадающие
	    в эту категорию, то укажите их тоже.)  Если вы являетесь
	    сопровождающим и/или отправителем, то укажите это
	    соответственно, так как это может помочь вам в вашем
	    деле.</p></li><li class="step"><p>Принимайте участие в обсуждении.</p></li><li class="step"><p>Если кажется, что для вашей идеи появилась поддержка,
	    отправьте PR, который будет включать обоснование и список
	    существующих портов, которые надо переместить.  В идеале
	    этот PR должен также включать патчи для
	    следующего:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">Makefile</code>'ы для новых портов
		в результате репозиторного копирования</p></li><li class="listitem"><p><code class="filename">Makefile</code> для категорий
		старых портов</p></li><li class="listitem"><p><code class="filename">Makefile</code>'ы для портов,
		зависящих от старых портов</p></li><li class="listitem"><p>(в дополнение, вы можете включить другие файлы,
		требующие изменений, согласно процедуре из
		Руководства Коммиттера.)</p></li></ul></div></li><li class="step"><p>Поскольку это затрагивает инфраструктуру портов и
	    охватывает не только выполнение репозиторного
	    копирования, но также, возможно, и выполнение
	    регрессивных тестов на кластере построения, то PR должна
	    назначать себе Группа Менеджеров Дерева Портов FreeBSD <code class="email">&lt;<a xmlns="" class="email" href="mailto:portmgr@FreeBSD.org">portmgr@FreeBSD.org</a>&gt;</code>.</p></li><li class="step"><p>Если этот PR одобрен, то коммиттеру нужно продолжить
	    остальную часть процедуры, которая <a class="link" href="../../../../doc/ru_RU.KOI8-R/articles/committers-guide/article.html#PORTS" target="_top">изложена
	      в Руководстве Коммиттера</a>.</p></li></ol></div><p>Предложение новой виртуальной категории должно быть
	схожим с вышеизложенным, но при этом затрагивать намного
	меньше, поскольку ни один из портов не будет перемещен в
	действительности.  В этом случае единственными патчами,
	включенными в PR, будут те, что добавляют новую категорию в
	<code class="varname">CATEGORIES</code> каждого из затрагиваемых
	портов.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="proposing-reorg"></a>5.3.5. Предложение реорганизации всех категорий</h3></div></div></div><p>Время от времени кто-нибудь предлагает произвести
	реорганизацию категорий либо до двухуровневой, либо другого
	типа на основе ключевых слов.  На данный момент из этих
	предложений ничего не получилось, потому что, хотя они просты
	в реализации, но предполагаемая переделка всей коллекции
	портов по меньшей мере приводит в уныние.  Пожалуйста,
	прочтите историю этих предложений в архивах рассылок перед
	тем, как присылать свои соображения; более того, вы должны
	быть готовы представить работающий прототип.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-distfiles"></a>5.4. Дистрибутивные файлы</h2></div></div></div><p>Во второй части <code class="filename">Makefile</code> задаётся,
      какие файлы и откуда должны быть сгружены для того, чтобы
      построить порт.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74266832"></a>5.4.1. <code class="varname">DISTVERSION/DISTNAME</code></h3></div></div></div><p>В переменной <code class="varname">DISTNAME</code> указывается имя
	порта так, как назвали его создатели программного
	обеспечения.  Значение <code class="varname">DISTNAME</code> по
	умолчанию совпадает с
	<code class="literal">${PORTNAME}-${PORTVERSION}</code>, так что
	переопределяете её значение только в случае необходимости.
	<code class="varname">DISTNAME</code> используется только в двух
	местах.  Во-первых, список дистрибутивных файлов
	(<code class="varname">DISTFILES</code>) по умолчанию состоит из
	<code class="varname">${DISTNAME}</code><code class="varname">${EXTRACT_SUFX}</code>.
	И во-вторых, предполагается, что дистрибутивный файл будет
	распакован в подкаталог с именем <code class="varname">WRKSRC</code>,
	значение которого по умолчанию есть не что иное, как
	<code class="filename">work/${DISTNAME}</code>.</p><p>Названия некоторых дистрибутивов, которые не укладываются
	в <code class="literal">${PORTNAME}-${PORTVERSION}</code>-схему, могут
	быть автоматически обработаны посредством установки
	переменной <code class="varname">DISTVERSION</code>.
	<code class="varname">PORTVERSION</code> и <code class="varname">DISTNAME</code>
	будут унаследованы автоматически, но конечно же могут быть
	переопределены.  Следующая таблица демонстрирует некоторые
	примеры:</p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><thead><tr><th><code class="varname">DISTVERSION</code></th><th><code class="varname">PORTVERSION</code></th></tr></thead><tbody><tr><td>0.7.1d</td><td>0.7.1.d</td></tr><tr><td>10Alpha3</td><td>10.a3</td></tr><tr><td>3Beta7-pre2</td><td>3.b7.p2</td></tr><tr><td>8:f_17</td><td>8f.17</td></tr></tbody></table></div><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Значения переменных <code class="varname">PKGNAMEPREFIX</code>
	  и <code class="varname">PKGNAMESUFFIX</code> не влияют на значение
	  <code class="varname">DISTNAME</code>.  Заметьте также, что если
	  значение <code class="varname">WRKSRC</code> равно
	  <code class="filename">work/${PORTNAME}-${PORTVERSION}</code>, и в
	  случае, когда оригинальный архив называется по имени,
	  отличном от
	  <code class="varname">${PORTNAME}-${PORTVERSION}${EXTRACT_SUFX}</code>,
	  скорее всего, вы должны оставить
	  <code class="varname">DISTNAME</code> как есть- лучше
	  переопределить <code class="varname">DISTFILES</code>, чем задавать
	  значения как <code class="varname">DISTNAME</code>, так и
	  <code class="varname">WRKSRC</code> (и, возможно, ещё и
	  <code class="varname">EXTRACT_SUFX</code>).</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74319568"></a>5.4.2. <code class="varname">MASTER_SITES</code></h3></div></div></div><p>Содержит часть с каталогом FTP/HTTP-URL, которая
	указывает на оригинальный архив на сервере
	<code class="varname">MASTER_SITES</code>.  Не забудьте лидирующий слэш
	(<code class="filename">/</code>)!</p><p>Макрос команды <code class="command">make</code> будет пытаться
	воспользоваться этой переменной для получения
	дистрибутивного файла с помощью программы
	<code class="varname">FETCH</code>, если он не будет найден в
	системе.</p><p>Рекомендуется помещать в список много сайтов,
	предпочтительно с разных континентов.  Это поможет при
	наличии проблем с мировой сетью.  Мы даже планируем добавить
	поддержку автоматического определения ближайшего сайта и
	сгрузки файлов оттуда; наличие нескольких сайтов будет
	способствовать этому начинанию.</p><p>Если оригинальный архив находится на одном из таких
	популярных серверов, как SourceForge, GNU или Perl CPAN, то
	указывайте эти сайты в простой форме при помощи
	<code class="varname">MASTER_SITE_<em class="replaceable"><code>*</code></em></code>
	(к примеру, <code class="varname">MASTER_SITE_SOURCEFORGE</code>,
	<code class="varname">MASTER_SITE_GNU</code> или
	<code class="varname">MASTER_SITE_PERL_CPAN</code>.  Просто укажите в
	переменной <code class="varname">MASTER_SITES</code> одно из этих
	значений, а в переменной
	<code class="varname">MASTER_SITE_SUBDIR</code> задайте путь к архиву.
	Вот пример:</p><pre class="programlisting">MASTER_SITES=		${MASTER_SITE_GNU}
MASTER_SITE_SUBDIR=	make</pre><p>Или можно использовать сокращенный формат:</p><pre class="programlisting">MASTER_SITES=	GNU/make</pre><p>Эти переменные определены в файле
	<code class="filename">/usr/ports/Mk/bsd.sites.mk</code>.  Всё время
	добавляются новые записи, так что обращайтесь к последней
	версии этого файла перед тем, как послать нам свой
	порт.</p><p>Для популярных сайтов существует несколько
	<span class="emphasis"><em>магических</em></span> макросов с заранее известной
	структурой каталогов.  Используйте для них сокращения, и
	система попытается угадать для вас правильный
	подкаталог.</p><pre class="programlisting">MASTER_SITES=	SF</pre><p>Если попытка угадать не удалась, то это может быть
	переписано следующим образом.</p><pre class="programlisting">MASTER_SITES=	SF/stardict/WyabdcRealPeopleTTS/${PORTVERSION}</pre><p>Что также можно записать в таком виде:</p><pre class="programlisting">MASTER_SITES=	SF
MASTER_SITE_SUBDIR=	stardict/WyabdcRealPeopleTTS/${PORTVERSION}</pre><div class="table"><a id="idp74331216"></a><div class="table-title">Таблица 5.1. Популярные магические макросы для
	  <code class="varname">MASTER_SITES</code></div><div class="table-contents"><table summary="Популярные магические макросы для&#10;&#9;  MASTER_SITES" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Макрос</th><th>Предполагаемый подкаталог</th></tr></thead><tbody><tr><td><code class="varname">APACHE_JAKARTA</code></td><td><code class="varname">/dist/jakarta/${PORTNAME:S,-,,/,}/source</code></td></tr><tr><td><code class="varname">BERLIOS</code></td><td><code class="varname">/${PORTNAME:L}</code></td></tr><tr><td><code class="varname">CHEESESHOP</code></td><td><code class="varname">/packages/source/source/${DISTNAME:C/(.).*/\1/}/${DISTNAME:C/(.*)-[0-9].*/\1/}</code></td></tr><tr><td><code class="varname">DEBIAN</code></td><td><code class="varname">/debian/pool/main/${PORTNAME:C/^((lib)?.).*$/\1/}/${PORTNAME}</code></td></tr><tr><td><code class="varname">GCC</code></td><td><code class="varname">/pub/gcc/releases/${DISTNAME}</code></td></tr><tr><td><code class="varname">GNOME</code></td><td><code class="varname">/pub/GNOME/sources/${PORTNAME}/${PORTVERSION:C/^([0-9]+\.[0-9]+).*/\1/}</code></td></tr><tr><td><code class="varname">GNU</code></td><td><code class="varname">/gnu/${PORTNAME}</code></td></tr><tr><td><code class="varname">MOZDEV</code></td><td><code class="varname">/pub/mozdev/${PORTNAME:L}</code></td></tr><tr><td><code class="varname">PERL_CPAN</code></td><td><code class="varname">/pub/CPAN/modules/by-module/${PORTNAME:C/-.*//}</code></td></tr><tr><td><code class="varname">PYTHON</code></td><td><code class="varname">/ftp/python/${PYTHON_PORTVERSION:C/rc[0-9]//}</code></td></tr><tr><td><code class="varname">RUBYFORGE</code></td><td><code class="varname">/${PORTNAME:L}</code></td></tr><tr><td><code class="varname">SAVANNAH</code></td><td><code class="varname">/${PORTNAME:L}</code></td></tr><tr><td><code class="varname">SF</code></td><td><code class="varname">/project/${PORTNAME:L}/${PORTNAME:L}/${PORTVERSION}</code></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74357584"></a>5.4.3. <code class="varname">EXTRACT_SUFX</code></h3></div></div></div><p>Если у вас имеется один дистрибутивный файл, и в его
	имени используется странное окончание для указания типа
	сжатия, задайте переменную
	<code class="varname">EXTRACT_SUFX</code>.</p><p>К примеру, если дистрибутивный файл носит имя
	<code class="filename">foo.tgz</code>, а не более привычное
	<code class="filename">foo.tar.gz</code>, вы должны написать:</p><pre class="programlisting">DISTNAME=	foo
EXTRACT_SUFX=	.tgz</pre><p>Переменные <code class="varname">USE_BZIP2</code>,
	<code class="varname">USE_XZ</code> и <code class="varname">USE_ZIP</code> при
	необходимости автоматически устанавливают значение
	<code class="varname">EXTRACT_SUFX</code> в
	<code class="literal">.tar.bz2</code>, <code class="literal">.tar.xz</code> или
	<code class="literal">.zip</code>.  Если ни одна из этих переменных не
	задана, то значение <code class="varname">EXTRACT_SUFX</code> по
	умолчанию устанавливается в
	<code class="literal">.tar.gz</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Вам не нужно задавать значения
	  <code class="varname">EXTRACT_SUFX</code> и
	  <code class="varname">DISTFILES</code> одновременно.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74370512"></a>5.4.4. <code class="varname">DISTFILES</code></h3></div></div></div><p>Иногда имена сгружаемых файлов не соответствуют имени
	порта.  К примеру, файл может называться
	<code class="filename">source.tar.gz</code> или подобным образом.  В
	других случаях исходный код приложения может располагаться в
	нескольких отличающихся архивах, и все они должны быть
	сгружены.</p><p>Если это ваш случай, то задайте в переменной
	<code class="varname">DISTFILES</code> список разделённых пробелами
	имён файлов, которые нужно сгрузить.</p><pre class="programlisting">DISTFILES=	source1.tar.gz source2.tar.gz</pre><p>Если переменная <code class="varname">DISTFILES</code> не задана
	явно, то её значением по умолчанию будет
	<code class="literal">${DISTNAME}${EXTRACT_SUFX}</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74378704"></a>5.4.5. <code class="varname">EXTRACT_ONLY</code></h3></div></div></div><p>Если только некоторые из <code class="varname">DISTFILES</code>
	должны быть распакованы-к примеру, часть из них
	является исходным кодом, а другие представляют собой
	неупакованную документацию-перечислите имена файлов,
	которые должны быть распакованы, в
	<code class="varname">EXTRACT_ONLY</code>.</p><pre class="programlisting">DISTFILES=	source.tar.gz manual.html
EXTRACT_ONLY=	source.tar.gz</pre><p>Если <span class="emphasis"><em>ни один</em></span> из
	<code class="varname">DISTFILES</code> не должен распаковываться, то
	установите пустое значение переменной
	<code class="varname">EXTRACT_ONLY</code>.</p><pre class="programlisting">EXTRACT_ONLY=</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-patchfiles"></a>5.4.6. <code class="varname">PATCHFILES</code></h3></div></div></div><p>Если вашему порту требуются некоторых дополнительные
	патчи, которые доступны по FTP или HTTP, задайте имена этих
	файлов в переменной <code class="varname">PATCHFILES</code>, а в
	переменной <code class="varname">PATCH_SITES</code> укажите URL того
	каталога, в котором они содержатся (формат такой же, как для
	<code class="varname">MASTER_SITES</code>).</p><p>Если патч не относится к самому верху дерева исходных
	текстов (то есть <code class="varname">WRKSRC</code>), потому что он
	содержит некоторые дополнительные пути, установите
	соответственно значение переменной
	<code class="varname">PATCH_DIST_STRIP</code>.  В частности, если все
	имена путей в патче имеют дополнительный путь
	<code class="literal">foozolix-1.0/</code> перед именем файла, то
	задайте <code class="literal">PATCH_DIST_STRIP=-p1</code>.</p><p>Не волнуйтесь, если патчи упакованы; они будут
	распакованы автоматически, если имена файлов оканчиваются на
	<code class="filename">.gz</code> или <code class="filename">.Z</code>.</p><p>Если патч распространяется вместе с какими-то другими
	файлами, такими, как документация, в виде tar-архива
	<code class="command">gzip</code>, вы не можете просто использовать
	<code class="varname">PATCHFILES</code>.  Если это ваш случай, добавьте
	имя и местоположение архива с патчем к
	<code class="varname">DISTFILES</code> и
	<code class="varname">MASTER_SITES</code>.  Затем воспользуйтесь
	переменной <code class="varname">EXTRA_PATCHES</code> для указания этих
	файлов, и <code class="filename">bsd.port.mk</code> автоматически
	применит эти патчи.  В частности,
	<span class="emphasis"><em>не копируйте</em></span> файлы с патчами в каталог
	<code class="varname">PATCHDIR</code>-этот каталог может быть
	недоступным для записи.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Архив будет распакован вне исходного кода, как обычно,
	  и к тому же его не нужно явно распаковывать, если это
	  обычный архив <code class="command">gzip</code> или
	  <code class="command">compress</code>.  Если вы сделаете последнее,
	  приложите дополнительные усилия для того, чтобы не
	  перезаписать что-либо, уже существующее в этом каталоге.
	  Также не забудьте добавить команду для удаления
	  скопированного патча в цели
	  <code class="buildtarget">pre-clean</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-master-sites-n"></a>5.4.7. Несколько дистрибутивных файлов или патчей с различных
	серверов и подкаталогов
	(<code class="literal">MASTER_SITES:n</code>)</h3></div></div></div><p>(Этот раздел можно считать немного <span class="quote"><<<span class="quote">повышенной
	  трудности</span>>></span>; те, кто впервые знакомятся с этим
	текстом, могут пропустить этот раздел).</p><p>В этом разделе находится информация о механизме сгрузки,
	известном как <code class="literal">MASTER_SITES:n</code> и
	<code class="literal">MASTER_SITES_NN</code>.  Далее мы будем называть
	этот механизм <code class="literal">MASTER_SITES:n</code>.</p><p>Сначала немного общей информации.  В OpenBSD имеется
	полезная возможность, используемая в переменных
	<code class="varname">DISTFILES</code> и <code class="varname">PATCHFILES</code>,
	которая позволяет закреплять после имен файлов и патчей
	идентификаторы типа <code class="literal">:n</code>.  Здесь
	<code class="literal">n</code> может быть из диапазона
	<code class="literal">[0-9]</code> и обозначать закреплённую группу.  К
	примеру:</p><pre class="programlisting">DISTFILES=	alpha:0 beta:1</pre><p>В OpenBSD дистрибутивный файл <code class="filename">alpha</code>
	будет связан с переменной <code class="varname">MASTER_SITES0</code>,
	но не с нашей общей переменной
	<code class="varname">MASTER_SITES</code>, а файл
	<code class="filename">beta</code> с переменной
	<code class="varname">MASTER_SITES1</code>.</p><p>Этот очень интересная возможность, которая может
	уменьшить этот бесконечный поиск работающего сайта для
	сгрузки.</p><p>Просто представьте себе 2 файла в
	<code class="varname">DISTFILES</code> и 20 сайтов в
	<code class="varname">MASTER_SITES</code>; сайты очень медленные,
	причём <code class="filename">beta</code> находится на всех сайтах из
	<code class="varname">MASTER_SITES</code>, а <code class="filename">alpha</code>
	может быть найден только на 20-м сайте.  Будет неправильно
	проверять их все, если создатель знает об этом, не правда ли?
	Неподходящее начало для таких прекрасных выходных!</p><p>Теперь, когда вы получили общее представление, просто
	представьте ещё большее количество
	<code class="varname">DISTFILES</code> и
	<code class="varname">MASTER_SITES</code>.  Конечно, наш <span class="quote"><<<span class="quote">магистр
	  доступности дистрибутивов</span>>></span> представляет масштабы
	нагрузки на сеть, которую это даёт.</p><p>В последующих разделах информация будет даваться вместе с
	реализацией этой идеи во FreeBSD.  Мы несколько улучшили
	концепцию OpenBSD.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74407888"></a>5.4.7.1. Упрощённая информация</h4></div></div></div><p>В этом разделе рассказывается, как быстро подготовить
	  точную сгрузку нескольких дистрибутивных файлов и патчей с
	  разных сайтов и каталогов.  Мы описываем здесь случай
	  упрощённого использования
	  <code class="literal">MASTER_SITES:n</code>.  Для большинства
	  сценариев этого будет достаточно.  Однако, если вам нужна
	  дополнительная информация, обратитесь к следующему
	  разделу.</p><p>Некоторые приложения состоят из многих дистрибутивных
	  файлов, которые должны быть сгружены с нескольких различных
	  сайтов.  К примеру, <span class="application">Ghostscript</span>
	  состоит из основной программы и большого числа файлов
	  драйверов, которые используются в зависимости от принтера
	  пользователя.  Некоторые из этих файлов драйверов
	  поставляются с основной программой, но при этом многие
	  другие должны быть сгружены с множества различных
	  сайтов.</p><p>Чтобы это поддерживать, за каждой записью в
	  <code class="varname">DISTFILES</code> может следовать символ
	  двоеточия и <span class="quote"><<<span class="quote">имя метки</span>>></span>.  За каждым сайтом,
	  перечисленным в <code class="varname">MASTER_SITES</code>, тоже
	  следует двоеточие и метка, которая указывает, какие файлы
	  дистрибутива должны быть сгружены с этого сайта.</p><p>Например, рассмотрим приложение, исходный код которого
	  разделён на две части, <code class="filename">source1.tar.gz</code>
	  и <code class="filename">source2.tar.gz</code>, которые должны быть
	  сгружены с двух различных источников.
	  Файл <code class="filename">Makefile</code> порта будет содержать
	  строчки типа <a class="xref" href="#ports-master-sites-n-example-simple-use-one-file-per-site" title="Пример 5.1. Упрощённое использование MASTER_SITES:n с 1 файлом на каждом сайте">Пример 5.1, <<Упрощённое использование
	    <code class="literal">MASTER_SITES:n</code> с 1 файлом на каждом
	    сайте>></a>.</p><div class="example"><a id="ports-master-sites-n-example-simple-use-one-file-per-site"></a><div class="example-title">Пример 5.1. Упрощённое использование
	    <code class="literal">MASTER_SITES:n</code> с 1 файлом на каждом
	    сайте</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	ftp://ftp.example1.com/:source1 \
		ftp://ftp.example2.com/:source2
DISTFILES=	source1.tar.gz:source1 \
		source2.tar.gz:source2</pre></div></div><br class="example-break" /><p>Несколько дистрибутивных файлов могут иметь одну и ту
	  же метку.  Продолжая предыдущий пример, положим, что
	  имеется и третий дистрибутивный файл,
	  <code class="filename">source3.tar.gz</code>, который должен быть
	  сгружен с <code class="systemitem">ftp.example2.com</code>.  Тогда
	  файл <code class="filename">Makefile</code> будет написан как <a class="xref" href="#ports-master-sites-n-example-simple-use-more-than-one-file-per-site" title="Пример 5.2. Упрощённое использование MASTER_SITES:n с более чем 1 файлом на каждом сервере">Пример 5.2, <<Упрощённое использование
	    <code class="literal">MASTER_SITES:n</code> с более чем 1 файлом на
	    каждом сервере>></a>.</p><div class="example"><a id="ports-master-sites-n-example-simple-use-more-than-one-file-per-site"></a><div class="example-title">Пример 5.2. Упрощённое использование
	    <code class="literal">MASTER_SITES:n</code> с более чем 1 файлом на
	    каждом сервере</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	ftp://ftp.example1.com/:source1 \
		ftp://ftp.example2.com/:source2
DISTFILES=	source1.tar.gz:source1 \
		source2.tar.gz:source2 \
		source3.tar.gz:source2</pre></div></div><br class="example-break" /></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74447952"></a>5.4.7.2. Подробная информация</h4></div></div></div><p>Прекрасно, но пример из предыдущего раздела не показал
	  вам всё, что вам нужно?  В этом разделе мы подробно опишем,
	  как работает механизм <code class="literal">MASTER_SITES:n</code>
	  точной сгрузки и как вы можете изменить ваши порты, чтобы
	  это использовать.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>За элементами могут следовать символы
	      <code class="literal">:n</code>, где <em class="replaceable"><code>n</code></em>
	      это <code class="literal">[^:,]+</code>, то есть
	      <em class="replaceable"><code>n</code></em> может теоретически быть
	      любой алфавитно-цифровой строкой, но пока мы будем
	      ограничивать их
	      <code class="literal">[a-zA-Z_][0-9a-zA-Z_]+</code>.</p><p>Более того, совпадение строк чувствительно к
	      регистру; другими словами, <code class="literal">n</code>
	      отличается от <code class="literal">N</code>.</p><p>Однако следующие слова не могут использоваться для
	      этих нужд, так как они имеют особое значение:
	      <code class="literal">default</code>, <code class="literal">all</code> и
	      <code class="literal">ALL</code> (они используются для своих нужд
	      в <a class="xref" href="#porting-master-sites-n-what-changes-in-port-targets">ii</a>).
	      Кроме того, <code class="literal">DEFAULT</code> является
	      специальным ключевым словом (посмотрите <a class="xref" href="#porting-master-sites-n-DEFAULT-group">3</a>).</p></li><li class="listitem"><p>Элементы, за которыми следуют
	      <code class="literal">:n</code>, принадлежат группе
	      <code class="literal">n</code>, <code class="literal">:m</code> относится к
	      группе <code class="literal">m</code> и так далее.</p></li><li class="listitem"><p><a id="porting-master-sites-n-DEFAULT-group"></a>Элементы без таких суффиксов не относятся ни к
	      какой группе, то есть они принадлежат к особой группе
	      <code class="literal">DEFAULT</code>.  Если вы укажете суффиксом
	      любого элемента <code class="literal">DEFAULT</code>, вы просто
	      выполните излишнюю работу, если только вы не хотите
	      отнесения элемента как к группе
	      <code class="literal">DEFAULT</code>, так и какой-то другой в
	      одно и то же время (посмотрите на пункт <a class="xref" href="#porting-master-sites-n-comma-operator">5</a>).</p><p>Следующие примеры равнозначны, но первый более
	      предпочтителен:</p><pre class="programlisting">MASTER_SITES=	alpha</pre><pre class="programlisting">MASTER_SITES=	alpha:DEFAULT</pre></li><li class="listitem"><p>Группы не являются эксклюзивными, элемент может
	      принадлежать к нескольким отличающимся группам
	      одновременно, а группа может либо иметь несколько
	      различных элементов, либо не иметь их вовсе.
	      Повторяющиеся элементы в одной и той же группе будут
	      являться просто повторяющимися элементами.</p></li><li class="listitem"><p><a id="porting-master-sites-n-comma-operator"></a>Если в хотите, чтобы элемент принадлежал к
	      нескольким группам одновременно, вы можете использовать
	      запятую (<code class="literal">,</code>).</p><p>Вместо того, чтобы повторять их несколько раз,
	      каждый раз с разным постфиксом, мы можем перечислить
	      несколько групп за раз в одном постфиксе.  Например,
	      <code class="literal">:m,n,o</code> определяет элемент,
	      принадлежащий группам <code class="literal">m</code>,
	      <code class="literal">n</code> и <code class="literal">o</code>.</p><p>Все следующие примеры имеют один смысл, но
	      последний является предпочтительным:</p><pre class="programlisting">MASTER_SITES=	alpha alpha:SOME_SITE</pre><pre class="programlisting">MASTER_SITES=	alpha:DEFAULT alpha:SOME_SITE</pre><pre class="programlisting">MASTER_SITES=	alpha:SOME_SITE,DEFAULT</pre><pre class="programlisting">MASTER_SITES=	alpha:DEFAULT,SOME_SITE</pre></li><li class="listitem"><p>Все серверы внутри определённой группы сортируются
	      в соответствии с <code class="varname">MASTER_SORT_AWK</code>.
	      Все группы в <code class="varname">MASTER_SITES</code> и
	      <code class="varname">PATCH_SITES</code> тоже сортируются.</p></li><li class="listitem"><p><a id="porting-master-sites-n-group-semantics"></a>Семантика групп может использоваться в любой из
	      следующих переменных <code class="varname">MASTER_SITES</code>,
	      <code class="varname">PATCH_SITES</code>,
	      <code class="varname">MASTER_SITE_SUBDIR</code>,
	      <code class="varname">PATCH_SITE_SUBDIR</code>,
	      <code class="varname">DISTFILES</code> и
	      <code class="varname">PATCHFILES</code> в соответствии со
	      следующим синтаксисом:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>Все элементы <code class="varname">MASTER_SITES</code>,
		  <code class="varname">PATCH_SITES</code>,
		  <code class="varname">MASTER_SITE_SUBDIR</code> и
		  <code class="varname">PATCH_SITE_SUBDIR</code> должны
		  заканчиваться символом прямого слэша
		  <code class="literal">/</code>.  Если какие-то элементы
		  принадлежат каким-то группам, постфикс группы
		  <code class="literal">:n</code> должен следовать сразу после
		  завершающего символа <code class="literal">/</code>.
		  Механизм <code class="literal">MASTER_SITES:n</code>
		  опирается на наличие завершающего символа
		  <code class="literal">/</code> во избежание совпадающих
		  элементов, где <code class="literal">:n</code> является
		  корректной частью элемента с вхождениями, где
		  <code class="literal">:n</code> обозначает группу
		  <code class="literal">n</code>.  Для целей совместимости, так
		  как завершающий символ <code class="literal">/</code> ранее
		  не требовался в элементах
		  <code class="varname">MASTER_SITE_SUBDIR</code> и
		  <code class="varname">PATCH_SITE_SUBDIR</code>, если символ,
		  сразу предшествующий постфиксу, не является
		  символом <code class="literal">/</code>, то
		  <code class="literal">:n</code> будет считаться корректной
		  частью элемента, а не постфиксом группы, даже если
		  за элементом следует <code class="literal">:n</code>.
		  Посмотрите <a class="xref" href="#ports-master-sites-n-example-detailed-use-master-site-subdir" title="Пример 5.3. Подробное использование MASTER_SITES:n в MASTER_SITE_SUBDIR">Пример 5.3, <<Подробное использование
		    <code class="literal">MASTER_SITES:n</code> в
		    <code class="varname">MASTER_SITE_SUBDIR</code>>></a>
		  и <a class="xref" href="#ports-master-sites-n-example-detailed-use-complete-example-master-sites" title="Пример 5.4. Подробное использование MASTER_SITES:n с запятыми, несколькими файлами, несколькими серверами и несколькими подкаталогами">Пример 5.4, <<Подробное использование
		    <code class="literal">MASTER_SITES:n</code> с запятыми,
		    несколькими файлами, несколькими серверами и
		    несколькими подкаталогами>></a>.</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-master-site-subdir"></a><div class="example-title">Пример 5.3. Подробное использование
		    <code class="literal">MASTER_SITES:n</code> в
		    <code class="varname">MASTER_SITE_SUBDIR</code></div><div class="example-contents"><pre class="programlisting">MASTER_SITE_SUBDIR=	old:n new/:NEW</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Каталоги внутри группы
			<code class="literal">DEFAULT</code> -&gt; old:n</p></li><li class="listitem"><p>Каталоги внутри группы
			<code class="literal">NEW</code> -&gt; new</p></li></ul></div></div></div><br class="example-break" /><div class="example"><a id="ports-master-sites-n-example-detailed-use-complete-example-master-sites"></a><div class="example-title">Пример 5.4. Подробное использование
		    <code class="literal">MASTER_SITES:n</code> с запятыми,
		    несколькими файлами, несколькими серверами и
		    несколькими подкаталогами</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	http://site1/%SUBDIR%/ http://site2/:DEFAULT \
		http://site3/:group3 http://site4/:group4 \
		http://site5/:group5 http://site6/:group6 \
		http://site7/:DEFAULT,group6 \
		http://site8/%SUBDIR%/:group6,group7 \
		http://site9/:group8
DISTFILES=	file1 file2:DEFAULT file3:group3 \
		file4:group4,group5,group6 file5:grouping \
		file6:group7
MASTER_SITE_SUBDIR=	directory-trial:1 directory-n/:groupn \
			directory-one/:group6,DEFAULT \
			directory</pre><p>Предыдущий пример приводит к следующей точной
		    сгрузке.  Серверы перечислены в точном порядке их
		    использования.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">file1</code> будет
			сгружаться с</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site1/directory-trial:1/</p></li><li class="listitem"><p>http://site1/directory-one/</p></li><li class="listitem"><p>http://site1/directory/</p></li><li class="listitem"><p>http://site2/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file2</code> будет
			сгружаться точно также, как
			<code class="filename">file1</code>, так как они
			оба относятся к одной и той же группе</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site1/directory-trial:1/</p></li><li class="listitem"><p>http://site1/directory-one/</p></li><li class="listitem"><p>http://site1/directory/</p></li><li class="listitem"><p>http://site2/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file3</code> будет сгружен
			с</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site3/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file4</code> будет
			сгружаться с</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site4/</p></li><li class="listitem"><p>http://site5/</p></li><li class="listitem"><p>http://site6/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p>http://site8/directory-one/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file5</code> будет сгружен
			с</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file6</code> будет
			сгружаться с</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site8/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li></ul></div></div></div><br class="example-break" /></li></ol></div></li><li class="listitem"><p>Как мне группировать одну из специальных переменных
	      из <code class="filename">bsd.sites.mk</code>, например,
	      <code class="varname">MASTER_SITE_SOURCEFORGE</code>?</p><p>Посмотрите <a class="xref" href="#ports-master-sites-n-example-detailed-use-master-site-sourceforge" title="Пример 5.5. Подробное использование MASTER_SITES:n с MASTER_SITE_SOURCEFORGE">Пример 5.5, <<Подробное использование
		<code class="literal">MASTER_SITES:n</code> с
		<code class="varname">MASTER_SITE_SOURCEFORGE</code>>></a>.</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-master-site-sourceforge"></a><div class="example-title">Пример 5.5. Подробное использование
		<code class="literal">MASTER_SITES:n</code> с
		<code class="varname">MASTER_SITE_SOURCEFORGE</code></div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	http://site1/ ${MASTER_SITE_SOURCEFORGE:S/$/:sourceforge,TEST/}
DISTFILES=	something.tar.gz:sourceforge</pre></div></div><br class="example-break" /><p><code class="filename">something.tar.gz</code> будет
	      сгружаться со всех сайтов из
	      <code class="varname">MASTER_SITE_SOURCEFORGE</code>.</p></li><li class="listitem"><p>Как мне использовать это с переменными
	      <code class="varname">PATCH*</code>?</p><p>Все примеры выполнялись с переменными
	      <code class="varname">MASTER*</code>, и они работают точно так же
	      и для <code class="varname">PATCH*</code>, как это можно видеть в
	      <a class="xref" href="#ports-master-sites-n-example-detailed-use-patch-sites" title="Пример 5.6. Упрощённое использование MASTER_SITES:n с PATCH_SITES.">Пример 5.6, <<Упрощённое использование
		<code class="literal">MASTER_SITES:n</code> с
		<code class="varname">PATCH_SITES</code>.>></a>.</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-patch-sites"></a><div class="example-title">Пример 5.6. Упрощённое использование
		<code class="literal">MASTER_SITES:n</code> с
		<code class="varname">PATCH_SITES</code>.</div><div class="example-contents"><pre class="programlisting">PATCH_SITES=	http://site1/ http://site2/:test
PATCHFILES=	patch1:test</pre></div></div><br class="example-break" /></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74652112"></a>5.4.7.3. Что изменится для портов?  А что не изменится?</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem"><p>Все имеющиеся порты остаются без изменений.  Код
	      для механизма <code class="literal">MASTER_SITES:n</code>
	      активируется, если только есть элементы, которые
	      заканчиваются на <code class="literal">:n</code>, как и элементы
	      в соответствии с вышеописанным синтаксисом, особенно
	      как это показано в пункте <a class="xref" href="#porting-master-sites-n-group-semantics">7</a>.</p></li><li class="listitem"><p><a id="porting-master-sites-n-what-changes-in-port-targets"></a>Цели порт остаются теми же самыми:
	      <code class="buildtarget">checksum</code>,
	      <code class="buildtarget">makesum</code>,
	      <code class="buildtarget">patch</code>,
	      <code class="buildtarget">configure</code>,
	      <code class="buildtarget">build</code> и так далее.  С
	      обычными исключениями для
	      <code class="buildtarget">do-fetch</code>,
	      <code class="buildtarget">fetch-list</code>,
	      <code class="buildtarget">master-sites</code> и
	      <code class="buildtarget">patch-sites</code>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="buildtarget">do-fetch</code>: использует
		  новую группировку с постфиксами в
		  <code class="varname">DISTFILES</code> и
		  <code class="varname">PATCHFILES</code> с соответствующими
		  элементами групп в <code class="varname">MASTER_SITES</code>
		  и <code class="varname">PATCH_SITES</code>, которые
		  используют группы из
		  <code class="varname">MASTER_SITE_SUBDIR</code> и
		  <code class="varname">PATCH_SITE_SUBDIR</code>.  Посмотрите
		  <a class="xref" href="#ports-master-sites-n-example-detailed-use-complete-example-master-sites" title="Пример 5.4. Подробное использование MASTER_SITES:n с запятыми, несколькими файлами, несколькими серверами и несколькими подкаталогами">Пример 5.4, <<Подробное использование
		    <code class="literal">MASTER_SITES:n</code> с запятыми,
		    несколькими файлами, несколькими серверами и
		    несколькими подкаталогами>></a>.</p></li><li class="listitem"><p><code class="buildtarget">fetch-list</code>: работает
		  так же, как старая цель
		  <code class="buildtarget">fetch-list</code> с тем
		  исключением, что она группирует, как и
		  <code class="buildtarget">do-fetch</code>.</p></li><li class="listitem"><p><code class="buildtarget">master-sites</code> и
		  <code class="buildtarget">patch-sites</code>:
		  (несовместимы со старыми версиями) только
		  возвращают элементы группы
		  <code class="literal">DEFAULT</code>; на самом деле они
		  выполняют цели
		  <code class="buildtarget">master-sites-default</code> и
		  <code class="buildtarget">patch-sites-default</code>
		  соответственно.</p><p>Более того, использование целей
		  <code class="buildtarget">master-sites-all</code> или
		  <code class="buildtarget">patch-sites-all</code>
		  предпочтительно для непосредственной проверки
		  <code class="buildtarget">MASTER_SITES</code> или
		  <code class="buildtarget">PATCH_SITES</code>.  Также
		  работа прямой проверки в последующих версиях не
		  гарантируется.  Посмотрите <a class="xref" href="#porting-master-sites-n-new-port-targets-master-sites-all">B</a>
		  для получения более дополнительной информации об
		  этих новых целях.</p></li></ul></div></li><li class="listitem"><p>Новые цели построения портов</p><div class="orderedlist"><ol class="orderedlist" type="A"><li class="listitem"><p>Имеются цели
		  <code class="buildtarget">master-sites-<em class="replaceable"><code>n</code></em></code>
		  и
		  <code class="buildtarget">patch-sites-<em class="replaceable"><code>n</code></em></code>,
		  которые будут перечислять элементы соответствующей
		  группы <em class="replaceable"><code>n</code></em> из
		  <code class="varname">MASTER_SITES</code> и
		  <code class="varname">PATCH_SITES</code> соответственно.  К
		  примеру,
		  <code class="buildtarget">master-sites-DEFAULT</code> и
		  <code class="buildtarget">patch-sites-DEFAULT</code> обе
		  будут возвращать элементы группы
		  <code class="literal">DEFAULT</code>,
		  <code class="buildtarget">master-sites-test</code> и
		  <code class="buildtarget">patch-sites-test</code> группы
		  <code class="literal">test</code> и так далее.</p></li><li class="listitem"><p><a id="porting-master-sites-n-new-port-targets-master-sites-all"></a>Имеются новые цели
		  <code class="buildtarget">master-sites-all</code> и
		  <code class="buildtarget">patch-sites-all</code>, которые
		  выполняют работу старых
		  <code class="buildtarget">master-sites</code> и
		  <code class="buildtarget">patch-sites</code>.  Они
		  возвращают элементы всех групп, как если бы они все
		  принадлежали одной и той же группе с тем, что она
		  перечисляет ровно столько
		  <code class="varname">MASTER_SITE_BACKUP</code> и
		  <code class="varname">MASTER_SITE_OVERRIDE</code>, как и
		  группы, определённые в <code class="varname">DISTFILES</code>
		  или <code class="varname">PATCHFILES</code>; соответственно
		  для <code class="buildtarget">master-sites-all</code> и
		  <code class="buildtarget">patch-sites-all</code>.</p></li></ol></div></li></ol></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74691024"></a>5.4.8. <code class="varname">DIST_SUBDIR</code></h3></div></div></div><p>Не позволяйте вашему порту засорять
	<code class="filename">/usr/ports/distfiles</code>.  Если вашему порту
	требуется сгрузить много файлов, или он содержит имя файла,
	могущее вызвать конфликты с другими портами (например,
	<code class="filename">Makefile</code>), то укажите в переменной
	<code class="varname">DIST_SUBDIR</code> имя порта (должны подойти
	<code class="literal">${PORTNAME}</code> или
	<code class="literal">${PKGNAMEPREFIX}${PORTNAME}</code>).  Это изменит
	значение переменной <code class="varname">DISTDIR</code> со значения по
	умолчанию <code class="filename">/usr/ports/distfiles</code> к
	значению
	<code class="filename">/usr/ports/distfiles/DIST_SUBDIR</code>, и в
	результате всё, что требуется для порта, будет помещено в
	этот подкаталог.</p><p>Он заглянет также в подкаталог с тем же именем на
	основном резервном сервере
	<code class="filename">ftp.FreeBSD.org</code>.  (Явное задание
	переменной <code class="varname">DISTDIR</code> в вашем файле
	<code class="varname">Makefile</code> этого не сделает, так что,
	пожалуйста, воспользуйтесь
	<code class="varname">DIST_SUBDIR</code>.)</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Это не коснётся тех сайтов
	  <code class="varname">MASTER_SITES</code>, которые вы указали в вашем
	  файле <code class="filename">Makefile</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74698960"></a>5.4.9. <code class="varname">ALWAYS_KEEP_DISTFILES</code></h3></div></div></div><p>Если ваш порт использует двоичные дистрибутивные файлы и
	обладает лицензией, требующей, чтобы исходный код
	предоставлялся вместе с пакетами, распространяемыми в
	двоичной форме, например GPL, то
	<code class="varname">ALWAYS_KEEP_DISTFILES</code> даст кластеру
	построения FreeBSD указание сохранять копию файлов, указанных в
	<code class="varname">DISTFILES</code>.  Пользователям таких портов эти
	файлы в основном не нужны, поэтому хорошей идеей является
	добавление в <code class="varname">DISTFILES</code> исходных
	дистрибутивных файлов, только когда определена переменная
	<code class="varname">PACKAGE_BUILDING</code>.</p><div class="example"><a id="ports-master-sites-n-example-always-keep-distfiles"></a><div class="example-title">Пример 5.7. Использование
	  <code class="varname">ALWAYS_KEEP_DISTFILES</code>.</div><div class="example-contents"><pre class="programlisting">.if defined(PACKAGE_BUILDING)
DISTFILES+=		<em class="replaceable"><code>foo.tar.gz</code></em>
ALWAYS_KEEP_DISTFILES=	yes
.endif</pre></div></div><br class="example-break" /><p>При добавлении дополнительных файлов в
	<code class="varname">DISTFILES</code> убедитесь, что вы их также
	добавляете в <code class="filename">distinfo</code>.  Кроме того,
	дополнительные файлы обычно распаковываются также в
	<code class="varname">WRKDIR</code>, что для некоторых портов может
	вызывать нежелательные подобные эффекты и требовать особую
	обработку.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-maintainer"></a>5.5. <code class="varname">MAINTAINER</code></h2></div></div></div><p>Укажите здесь ваш адрес электронной почты.  Пожалуйста.
      <span class="emphasis"><em>:-)</em></span></p><p>Заметьте, что в качестве значения для
      <code class="varname">MAINTAINER</code> допустимо использование только
      одного адреса без поля комментария.  Должен использоваться
      формат <code class="literal">user@hostname.domain</code>.  Пожалуйста, не
      включайте никакого описательного текста, например, вашего
      настоящего имени в эту строку-это несколько сбивает с
      толку <code class="filename">bsd.port.mk</code>.</p><p>Сопровождающий ответственен за поддержание порта в
      актуальном состоянии и обеспечение правильной работы порта.  За
      подробным описанием обязанностей сопровождающего порт
      обращайтесь к главе <a class="link" href="../../../../doc/en_US.ISO8859-1/articles/contributing-ports/maintain-port.html" target="_top">The
	challenge for port maintainers</a>.</p><p>Перед фиксацией в репозитории изменения в порте будут
      отправлены сопровождающему для просмотра и одобрения.  Если
      сопровождающий порта не ответил на запрос пользователя об
      обновлении в течение двух недель (исключая большие праздники),
      то это можно считать тайм-аутом сопровождающего, и обновление
      может быть выполнено без явного подтверждения от
      сопровождающего.  Если сопровождающий не отвечает в течение
      трёх месяцев, то считается, что он отсутствует, и как
      сопровождающий порта, о котором идёт речь, может быть заменён.
      Исключениями из этого правила является всё, что сопровождает
      Группа Менеджеров Дерева Портов FreeBSD <code class="email">&lt;<a xmlns="" class="email" href="mailto:portmgr@FreeBSD.org">portmgr@FreeBSD.org</a>&gt;</code> или Группа Офицеров Безопасности <code class="email">&lt;<a xmlns="" class="email" href="mailto:security-officer@FreeBSD.org">security-officer@FreeBSD.org</a>&gt;</code>.  Запрещено делать любые
      несанкционированные изменения в портах, которые ведут эти
      группы.</p><p>Мы оставляем за собой право изменять сообщение
      сопровождающего для лучшего соответствия существующим политикам
      и стилю Коллекции Портов без явного одобрения со стороны
      отправителя.  Также, крупные изменения в инфраструктуре могут
      повлечь изменения в порте без согласия сопровождающего.  Такой
      вид изменений никогда не будет затрагивать функциональность
      порта.</p><p>За Группа Менеджеров Дерева Портов FreeBSD <code class="email">&lt;<a xmlns="" class="email" href="mailto:portmgr@FreeBSD.org">portmgr@FreeBSD.org</a>&gt;</code> оставляется право снять или назначить
      кого-либо сопровождающим по любой причине, а за
      Группа Офицеров Безопасности <code class="email">&lt;<a xmlns="" class="email" href="mailto:security-officer@FreeBSD.org">security-officer@FreeBSD.org</a>&gt;</code> оставляется право лишать или назначать
      права на сопровождение порта по соображениям информационной
      безопасности.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-comment"></a>5.6. <code class="varname">COMMENT</code></h2></div></div></div><p>Содержит однострочное описание порта.  Пожалуйста,
      соблюдайте следующие правила:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Старайтесь делать строку COMMENT длиной не больше, чем
	  70 символов, так как эта строка будет использована командой
	  <code class="command">pkg info</code> (см. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg-info&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pkg-info</span>(8)</span></a>) для
	  отображения однострочного описания порта;</p></li><li class="listitem"><p><span class="emphasis"><em>Не</em></span> включайте сюда название пакета
	  (или номер версии программного обеспечения);</p></li><li class="listitem"><p>Комментарий должен начинаться с заглавной буквы и не
	  заканчиваться точкой;</p></li><li class="listitem"><p>Не начинайте комментарий с неопределённого артикля (A
	  или An);</p></li><li class="listitem"><p>Имена пишутся с заглавной буквы (например, Apache,
	  JavaScript, Perl);</p></li><li class="listitem"><p>Для перечислений используйте английскую Оксфордскую
	  запятую (англ. Oxford comma) (например, green,
	  red<span class="emphasis"><em>,</em></span> and blue);</p></li><li class="listitem"><p>Используйте программу проверки орфографии.</p></li></ol></div><p>Вот пример:</p><pre class="programlisting">COMMENT=	Cat chasing a mouse all over the screen</pre><p>В файле <code class="filename">Makefile</code> переменная COMMENT
      должна следовать сразу за переменной MAINTAINER.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-portscout"></a>5.7. <code class="varname">PORTSCOUT</code></h2></div></div></div><p><span class="application">Portscout</span> являет собой
      автоматизированное средство проверки доступности дистрибутивных
      файлов для Коллекции Портов FreeBSD, подробное описание которого
      предоставляет <a class="xref" href="#distfile-survey" title="14.5. Portscout: сканер дистрибутивных файлов портов FreeBSD">Раздел 14.5, <<Portscout: сканер дистрибутивных файлов портов
      FreeBSD>></a>.</p><p>Переменная <code class="varname">PORTSCOUT</code> задаёт специальные
      условия, ограничивающие работу
      <span class="application">Portscout</span> -  сканера дистрибутивных
      файлов.</p><p>Ситуации, при которых следует указывать переменную
      <code class="varname">PORTSCOUT</code>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Когда должны игнорироваться дистрибутивные файлы для
	  конкретных версий или младших ревизий.  Например, чтобы
	  исключить из проверок новых версий дистрибутивных файлов
	  версию <em class="replaceable"><code>8.2</code></em> по причине того, что
	  она является поломанной, добавьте следующее:</p><pre class="programlisting">PORTSCOUT=	ignore:8.2</pre></li><li class="listitem"><p>Когда должны проверяться конкретные версии или старшие
	  и младшие ревизии дистрибутивных файлов.  Например, если
	  следует ограничиться проверкой версии
	  <em class="replaceable"><code>0.6.4</code></em>, потому что более новые
	  версии имеют проблемы совместимости с FreeBSD,
	  добавьте:</p><pre class="programlisting">PORTSCOUT=	limit:^0\.6\.4</pre></li><li class="listitem"><p>Когда URL, в которых указаны доступные версии,
	  отличаются от URL их загрузки.  Например, чтобы привязать
	  проверку новых версий дистрибутивных файлов к странице
	  загрузки для порта <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/databases/pgtune/pkg-descr">databases/pgtune</a>, добавьте:</p><pre class="programlisting">PORTSCOUT=	site:http://pgfoundry.org/frs/?group_id=1000416</pre></li></ul></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-depend"></a>5.8. Зависимости</h2></div></div></div><p>Многие порты зависят от других портов.  Это очень удобная
      замечательная особенность большинства Unix-подобных
      операционных систем, включая FreeBSD.  Множество портов могут
      использовать общую зависимость совместно, а не включать её в
      состав каждого порта или пакета, который в ней нуждается.
      Имеется семь переменных, которые вы можете использовать для
      обеспечения того, что всё требуемое находится на машине
      пользователя.  Имеется также несколько предопределённых
      переменных, отражающих зависимости для общих случаев, плюс ещё
      несколько для управления поведением зависимостей.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74742096"></a>5.8.1. <code class="varname">LIB_DEPENDS</code></h3></div></div></div><p>Эта переменная указывает, от каких совместно используемых
	библиотек зависит порт.  Это список пар
	<em class="replaceable"><code>lib</code></em>:<em class="replaceable"><code>dir</code></em>,
	где <em class="replaceable"><code>lib</code></em> - это имя библиотеки,
	<em class="replaceable"><code>dir</code></em> - это каталог, в котором можно
	ее найти в случае, если ее нет на машине.  Например,</p><pre class="programlisting">LIB_DEPENDS=	libjpeg.so:${PORTSDIR}/graphics/jpeg</pre><p>проверит наличие библиотеки jpeg с любым номером версии и
	перейдет в подкаталог <code class="filename">graphics/jpeg</code>
	вашего дерева портов для ее построения и установки, если
	библиотека отсутствует.</p><p>Зависимость проверяется дважды, один раз внутри цели
	<code class="buildtarget">build</code>, а затем из цели
	<code class="buildtarget">install</code>.  Кроме того, имя
	зависимости помещается в пакет, так что
	<code class="command">pkg install</code> (см. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg-install&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pkg-install</span>(8)</span></a>)
	будет автоматически её устанавливать, если её нет на
	пользовательской системе.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74756688"></a>5.8.2. <code class="varname">RUN_DEPENDS</code></h3></div></div></div><p>В этой переменной перечисляются выполнимые файлы или
	файлы, от которых зависит работа порта.  Это список пар вида
	<em class="replaceable"><code>path</code></em>:<em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>],
	где <em class="replaceable"><code>path</code></em> - это имя программы или
	файла, а <em class="replaceable"><code>dir</code></em> - каталог, в котором
	можно найти порт в случае, если его нет в системе, и
	<em class="replaceable"><code>target</code></em> - это цель, которую нужно
	вызвать в этом каталоге.  Если
	<em class="replaceable"><code>path</code></em> начинается со слэша
	(<code class="literal">/</code>), он воспринимается как файл и его
	существование проверяется командой
	<code class="command">test -e</code>; в противном случае
	предполагается, что это выполнимый файл, и для определения
	того, имеется ли программа в пути поиска, используется
	команда <code class="command">which -s</code>.</p><p>Например,</p><pre class="programlisting">RUN_DEPENDS=	${LOCALBASE}/news/bin/innd:${PORTSDIR}/news/inn \
		xmlcatmgr:${PORTSDIR}/textproc/xmlcatmgr</pre><p>проверит существование файла или каталога
	<code class="filename">/usr/local/news/bin/innd</code>, и если ничего
	не будет найдено, то построит и установит порт из подкаталога
	<code class="filename">news/inn</code> дерева портов.  Также будет
	выполнена проверка, присутствует ли в пути поиска исполняемый
	файл с именем <code class="command">xmlcatmgr</code>, и перейдет в
	подкаталог <code class="filename">textproc/xmlcatmgr</code> вашего
	дерева портов для его построения и установки, если он не
	будет найден.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">В приведенном примере <code class="command">innd</code> является
	  выполнимым файлом; если выполнимый файл находится в месте,
	  которое отсутствует в списке путей файлов, то вы должны
	  указать полный путь к файлу.</p></div><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Официальным значением переменной поиска
	  <code class="envar">PATH</code>, используемым в кластере построения
	  портов является</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin</pre></div><p>Зависимость проверяется внутри цели
	<code class="buildtarget">install</code>.  Кроме того, имя
	зависимости помещается в пакет, так что
	<code class="command">pkg install</code> (см. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg-install&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pkg-install</span>(8)</span></a>)
	будет автоматически его устанавливать, если он не будет
	найден в пользовательской системе.  Часть
	<em class="replaceable"><code>target</code></em> может быть опущена, если
	она совпадает с <code class="varname">DEPENDS_TARGET</code>.</p><p>Довольно распространенной является ситуация, когда
	<code class="varname">RUN_DEPENDS</code> буквально такая же как
	<code class="varname">BUILD_DEPENDS</code>, особенно если переносимое
	программное обеспечение написано на языке сценариев, или если
	оно требует такое же окружение для исполнения, как и
	используемое во время построения.  В этом случае, очень
	заманчивым или довольно естественным является присвоение
	одного другому:</p><pre class="programlisting">RUN_DEPENDS=	${BUILD_DEPENDS}</pre><p>Тем не менее, подобные присвоения могут загрязнять
	зависимости времени исполнения содержимым, не заданным в
	<code class="varname">BUILD_DEPENDS</code> исходного порта.  Такое
	случается из-за ленивого вычисления в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a>
	присваиваемых переменных.  Представьте
	<code class="filename">Makefile</code> с переменными
	<code class="varname">USE_<em class="replaceable"><code>*</code></em></code>, которые
	обрабатываются в <code class="filename">ports/Mk/bsd.*.mk</code> для
	пополнения первоначальных зависимостей построения.  Например,
	<code class="literal">USES= gmake</code> добавляет <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/gmake/pkg-descr">devel/gmake</a> в
	<code class="varname">BUILD_DEPENDS</code>.  Для предотвращения
	загрязнения <code class="varname">RUN_DEPENDS</code> подобными
	дополнительными зависимостями проявляйте осторожность с
	присвоением с раскрытием, т.е. с раскрытием значения перед
	его присвоением переменной:</p><pre class="programlisting">RUN_DEPENDS:=	${BUILD_DEPENDS}</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74809552"></a>5.8.3. <code class="varname">BUILD_DEPENDS</code></h3></div></div></div><p>В этой переменной перечисляются выполнимые или обычные
	файлы, которые требуются порту для его построения.  Как и
	<code class="varname">RUN_DEPENDS</code>, это список пар
	<em class="replaceable"><code>path</code></em>:<em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>].
	Например,</p><pre class="programlisting">BUILD_DEPENDS=	unzip:${PORTSDIR}/archivers/unzip</pre><p>будет проверять наличие выполнимого фала с именем
	<code class="command">unzip</code> и перейдет в подкаталог
	<code class="filename">archivers/unzip</code> вашего дерева портов для
	его построения и установки, если последний не будет
	найден.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Под <span class="quote"><<<span class="quote">построением</span>>></span> здесь понимается всё, от
	  распаковки до компиляции.  Зависимость проверяется из цели
	  <code class="buildtarget">extract</code>.  Часть
	  <em class="replaceable"><code>target</code></em> может быть опущена, если
	  она совпадает с <code class="varname">DEPENDS_TARGET</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74824400"></a>5.8.4. <code class="varname">FETCH_DEPENDS</code></h3></div></div></div><p>В этой переменной перечисляются выполняемые файлы или
	просто файлы, которые требуются порту для сгрузки.  Как и
	предыдущие две переменные, это список пар
	<em class="replaceable"><code>path</code></em>:<em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>].
	Например,</p><pre class="programlisting">FETCH_DEPENDS=	ncftp2:${PORTSDIR}/net/ncftp2</pre><p>будет проверять наличие выполняемого файла с именем
	<code class="command">ncftp2</code> и перейдет в каталог
	<code class="filename">net/ncftp2</code> вашего дерева портов для его
	построения и установки, если тот не будет найден.</p><p>Зависимость проверяется при выполнении цели
	<code class="buildtarget">fetch</code>.  Часть
	<em class="replaceable"><code>target</code></em> может быть опущена, если
	она совпадает с <code class="varname">DEPENDS_TARGET</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74829904"></a>5.8.5. <code class="varname">EXTRACT_DEPENDS</code></h3></div></div></div><p>В этой переменной указываются программы или файлы,
	которые требуются для распаковки порта.  Как и в предыдущих
	случаях, это список пар вида
	<em class="replaceable"><code>path</code></em>:<em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>].
	Например,</p><pre class="programlisting">EXTRACT_DEPENDS=	unzip:${PORTSDIR}/archivers/unzip</pre><p>будет проверять наличие программы с именем
	<code class="command">unzip</code>, и перейдёт в подкаталог
	<code class="filename">archivers/unzip</code> вашего дерева портов для
	её построения и установки, если такой программы не будет
	найдено.</p><p>Зависимость проверяется внутри цели
	<code class="buildtarget">extract</code>.  Часть
	<em class="replaceable"><code>target</code></em> может быть опущена, если
	она совпадает с <code class="varname">DEPENDS_TARGET</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Используйте эту переменную, только если распаковка не
	  работает (по умолчанию предполагается использование
	  <code class="command">gzip</code>) и это не исправляется при помощи
	  <code class="varname">USE_ZIP</code> или
	  <code class="varname">USE_BZIP2</code>, которые описаны в <a class="xref" href="#use-vars" title="5.8.8. USE_*">Раздел 5.8.8, <<<code class="varname">USE_<em class="replaceable"><code>*</code></em></code>>></a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74841808"></a>5.8.6. <code class="varname">PATCH_DEPENDS</code></h3></div></div></div><p>Эта переменная указывает на программы или файлы, которые
	нужны порту для применения патчей.  Как и в предыдущих
	случаях, это список пар вида
	<em class="replaceable"><code>path</code></em>:<em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>].
	Например,</p><pre class="programlisting">PATCH_DEPENDS=	${NONEXISTENT}:${PORTSDIR}/java/jfc:extract</pre><p>будет переходить в подкаталог
	<code class="filename">java/jfc</code> вашего дерева портов для
	распаковки.</p><p>Зависимость проверяется внутри цели
	<code class="buildtarget">patch</code>.  Часть
	<em class="replaceable"><code>target</code></em> может быть опущена, если
	она совпадает с <code class="varname">DEPENDS_TARGET</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="uses"></a>5.8.7. <code class="varname">USES</code></h3></div></div></div><p>Могут быть добавлены параметры для определения различных
	характерных особенностей и зависимостей, которыми обладает
	данный порт.  Они указываются путём добавления в
	<code class="filename">Makefile</code> этой строки:</p><pre class="programlisting">USES= feature[:arguments]</pre><p>Для получения полного списка значений смотрите
	<a class="xref" href="#uses-values" title="15.1. Значения USES">Раздел 15.1, <<Значения <code class="varname">USES</code>>></a>.</p><div xmlns="" class="warning"><h3 class="admontitle">Предупреждение: </h3><p xmlns="http://www.w3.org/1999/xhtml">Значение <code class="varname">USES</code> нельзя присваивать
	  после подключения
	  <code class="filename">bsd.port.pre.mk</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="use-vars"></a>5.8.8. <code class="varname">USE_<em class="replaceable"><code>*</code></em></code></h3></div></div></div><p>Для определения общих зависимостей, совместно
	используемых многими портами, предназначено несколько
	переменных.  Их использование является необязательным, но
	помогает упростить избыточность файлов
	<code class="filename">Makefile</code> порта.  Каждый из них
	оформляется как
	<code class="varname">USE_<em class="replaceable"><code>*</code></em></code>.  Эти
	переменные можно использовать только в
	<code class="filename">Makefile</code> порта и
	<code class="filename">ports/Mk/bsd.*.mk</code>.  Они не предназначены
	для установки пользователями параметров - используйте
	для этих целей <code class="varname">PORT_OPTIONS</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Установка любых
	  <code class="varname">USE_<em class="replaceable"><code>*</code></em></code> в
	  <code class="filename">/etc/make.conf</code>
	  <span class="emphasis"><em>всегда</em></span> является ошибочным действием.
	  В частности, установка</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">USE_GCC=X.Y</pre><p xmlns="http://www.w3.org/1999/xhtml">(где X.Y соответствует версии) добавит зависимость от
	  gccXY к каждому порту, включая и сам
	  <code class="literal">lang/gccXY</code>!</p></div><div class="table"><a id="idp74858576"></a><div class="table-title">Таблица 5.2. Переменные
	  <code class="varname">USE_<em class="replaceable"><code>*</code></em></code></div><div class="table-contents"><table summary="Переменные&#10;&#9;  USE_*" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">USE_BZIP2</code></td><td>tar-архивы порта упакованы при помощи
		<code class="command">bzip2</code>.</td></tr><tr><td><code class="varname">USE_ZIP</code></td><td>tar-архивы порта упакованы при помощи
		<code class="command">zip</code>.</td></tr><tr><td><code class="varname">USE_GCC</code></td><td>Для сборки порта требуется GCC
		(<code class="command">gcc</code> или <code class="command">g++</code>).
		Некоторым портам подходит любая версия, для других
		требуются последние современные версии.  Обычно
		используется со значением <code class="literal">any</code> (в
		этом случае используется встроенный GCC в тех версиях
		FreeBSD, в состав которых он всё ещё входит, или
		устанавливается порт <code class="literal">lang/gcc</code>,
		когда Clang является компилятором C/C++ по умолчанию)
		или <code class="literal">yes</code> (всегда используется
		стабильная современная версия GCC из порта
		<code class="literal">lang/gcc</code>).  Также в значении
		переменной можно указать точную версию, например
		<code class="literal">4.7</code>.  Минимально допустимую версию
		можно указать как <code class="literal">4.6+</code>.
		GCC из основной системы используется в случае, если
		его версия удовлетворяет запрошенной, иначе
		собирается подходящая версии компилятора из порта с
		соответствующей коррекцией переменных
		<code class="varname">CC</code> и
		<code class="varname">CXX</code>.</td></tr></tbody></table></div></div><br class="table-break" /><p>Переменные, относящиеся к
	<span class="application">gmake</span> и сценарию
	<code class="filename">configure</code>, описаны в <a class="xref" href="#building" title="6.4. Механизмы построения">Раздел 6.4, <<Механизмы построения>></a>, а
	<span class="application">autoconf</span>,
	<span class="application">automake</span> и
	<span class="application">libtool</span> описаны в <a class="xref" href="#using-autotools" title="6.5. Использование GNU Autotools">Раздел 6.5, <<Использование GNU Autotools>></a>.  Переменные, связанные с
	<span class="application">Perl</span>, описаны в <a class="xref" href="#using-perl" title="6.7. Использование Perl">Раздел 6.7, <<Использование <span class="application">Perl</span>>></a>.  Переменные X11 перечислены в <a class="xref" href="#using-x11" title="6.8. Использование X11">Раздел 6.8, <<Использование X11>></a>.  <a class="xref" href="#using-gnome" title="6.9. Использование GNOME">Раздел 6.9, <<Использование GNOME>></a>
	работает с переменными GNOME и <a class="xref" href="#using-kde" title="6.11. Использование KDE">Раздел 6.11, <<Использование KDE>></a> с
	KDE.  <a class="xref" href="#using-java" title="6.12. Использование Java">Раздел 6.12, <<Использование Java>></a> описывает переменные Java,
	а <a class="xref" href="#using-php" title="6.13. Веб-приложения, Apache и PHP">Раздел 6.13, <<Веб-приложения, Apache и PHP>></a> содержит информацию об
	<span class="application">Apache</span>,
	<span class="application">PHP</span> и модулях PEAR.
	<span class="application">Python</span> обсуждается в <a class="xref" href="#using-python" title="6.14. Использование Python">Раздел 6.14, <<Использование Python>></a>, а <span class="application">Ruby</span>
	в <a class="xref" href="#using-ruby" title="6.17. Использование Ruby">Раздел 6.17, <<Использование Ruby>></a>.  <a class="xref" href="#using-sdl" title="6.18. Использование SDL">Раздел 6.18, <<Использование SDL>></a>
	предоставляет переменные, используемые для приложений
	<span class="application">SDL</span>, и, наконец, <a class="xref" href="#using-xfce" title="6.22. Использование Xfce">Раздел 6.22, <<Использование Xfce>></a> содержит информацию о приложении
	<span class="application">Xfce</span>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74889168"></a>5.8.9. Минимальная версия зависимости</h3></div></div></div><p>Минимальная версия зависимости может быть указана в любой
	переменной <code class="varname">*_DEPENDS</code>, за исключением
	<code class="varname">LIB_DEPENDS</code>, с использованием следующего
	синтаксиса:</p><pre class="programlisting">p5-Spiffy&gt;=0.26:${PORTSDIR}/devel/p5-Spiffy</pre><p>Первое поле содержит название зависимого пакета, которое
	обязано совпадать с записью в базе данные пакетов, знак
	сравнения и версию пакета.  Зависимость удовлетворяется, если
	на машине установлен p5-Spiffy-0.26 или новее.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74891856"></a>5.8.10. Замечания касательно зависимостей</h3></div></div></div><p>Как уже отмечено выше, целью, которая вызывается по
	умолчанию в случае, когда это требует зависимость, является
	<code class="buildtarget">DEPENDS_TARGET</code>.  Она по умолчанию
	есть <code class="literal">install</code>.  Это пользовательская
	переменная; она нигде не определена в файле
	<code class="filename">Makefile</code> порта.  Если вашему порту
	требуется особый метод обработки зависимости, воспользуйтесь
	частью <code class="literal">:target</code> переменной
	<code class="varname">*_DEPENDS</code> вместо того, чтобы
	переопределять <code class="varname">DEPENDS_TARGET</code>.</p><p>Когда вы набираете команду <code class="command">make clean</code>,
	эта операция также выполняется и над зависимостями этого
	порта.  Если вы не хотите, чтобы это случилось, определите
	переменную <code class="varname">NOCLEANDEPENDS</code> в вашем
	окружении.  Это может быть особенно нужным, если порт имеет
	нечто, что занимает много времени на построение, в своём
	списке зависимостей, например, KDE, GNOME или Mozilla.</p><p>Чтобы безусловно зависеть от другого порта, укажите
	переменную <code class="varname">${NONEXISTENT}</code> в качестве
	первого поля переменной <code class="varname">BUILD_DEPENDS</code> или
	<code class="varname">RUN_DEPENDS</code>.  Пользуйтесь этим, только
	когда вам нужно иметь исходный код другого порта.  Вы можете
	сэкономить время на компиляции, указав также и цель.
	Например,</p><pre class="programlisting">BUILD_DEPENDS=	${NONEXISTENT}:${PORTSDIR}/graphics/jpeg:extract</pre><p>всегда будет переходить в каталог с портом
	<code class="literal">jpeg</code> и распаковывать его.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74899408"></a>5.8.11. Зацикленные зависимости фатальны</h3></div></div></div><div xmlns="" class="important"><h3 class="admontitle">Важно: </h3><p xmlns="http://www.w3.org/1999/xhtml">Не помещайте зацикливающиеся зависимости в дерево
	  портов!</p></div><p>Технология построения портов не защищена от зацикленных
	зависимостей.  Если вы создадите такую, то у кого-нибудь и
	где-нибудь установка FreeBSD будет немедленно сломана, а у
	остальных сломается несколько позже.  Это на самом деле очень
	трудно распознать; если вы сомневаетесь, то перед внесением
	изменений проверьте, что выполнили следующее:
	<code class="command">cd /usr/ports; make index</code>.  Этот процесс
	может быть достаточно медленным на старых машинах, хотя вы
	сможете спасти большое количество людей-включая
	себя-от грядущих бед.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74901712"></a>5.8.12. Автоматические зависимости и проблемы, которые они
	вызывают</h3></div></div></div><p>Зависимости должны быть указаны либо явно, либо с
	использованием <a class="link" href="#makefile-options" title="5.12. Опции для Makefile">фреймворка
	  OPTIONS</a>.  Использование прочих методов, таких как
	автоматическое обнаружение зависимостей, усложняет
	индексирование, что вызывает проблемы в управлении портами и
	пакетами.</p><div class="example"><a id="idp74903504"></a><div class="example-title">Пример 5.8. Некорректное объявление необязательной
	  зависимости</div><div class="example-contents"><pre class="programlisting">.include &lt;bsd.port.pre.mk&gt;

.if exists(${LOCALBASE}/bin/foo)
LIB_DEPENDS=	libbar.so:${PORTSDIR}/foo/bar
.endif</pre></div></div><br class="example-break" /><p>Проблема автоматического добавления зависимостей
	заключается в том, что файлы и настройки за пределами порта
	могут произвольно меняться.  Пример: после построения индекса
	устанавливается набор портов.  При этом один из них
	устанавливает проверяемый файл.  На этом этапе индекс будет
	неправильным, потому что установленный порт неожиданно
	получит новую зависимость.  Индекс может быть по прежнему
	неправильным даже после его перестроения, в случае если
	другие порты также определят дополнительные зависимости,
	основываясь на существовании других файлов.</p><div class="example"><a id="idp74905168"></a><div class="example-title">Пример 5.9. Корректное объявление необязательной
	  зависимости</div><div class="example-contents"><pre class="programlisting">OPTIONS_DEFINE=	BAR
BAR_DESC=	Bar support

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MBAR}
LIB_DEPENDS=	libbar.so:${PORTSDIR}/foo/bar
.endif</pre></div></div><br class="example-break" /><p>Правильным способом является проверка переменных
	параметров.  Этот способ не приводит к несоответствиям в
	индексе набора портов, поскольку параметры определены до
	построения индекса.  При этом можно использовать простые
	скрипты для автоматизации построения, установки и обновления
	этих портов и соответствующих им пакетов.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="use-want"></a>5.8.13. <code class="varname">USE_</code> и
	<code class="varname">WANT_</code></h3></div></div></div><p>Переменные <code class="varname">USE_</code> задаются мейнтейнером
	порта для определения программного обеспечения, от которого
	этот порт зависит.  Порт, для которого нужен Firefox,
	укажет</p><pre class="programlisting">USE_FIREFOX=	yes</pre><p>Некоторые переменные <code class="varname">USE_</code> могут
	принимать номера версий или другие параметры.  Например,
	порт, который требует Apache 2.2, укажет</p><pre class="programlisting">USE_APACHE=	22</pre><p>В некоторых случаях для большего контроля над
	зависимостями используются переменные
	<code class="varname">WANT_</code>, которые позволяют указывать
	требования в более точной форме.  Например, взгляните на порт
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/mail/squirrelmail/pkg-descr">mail/squirrelmail</a>.  Этому
	порту нужны несколько модулей PHP, которые перечислены в
	переменной <code class="varname">USE_PHP</code>:</p><pre class="programlisting">USE_PHP=	session mhash gettext mbstring pcre openssl xml</pre><p>Эти модули доступны в версиях CLI и web, поэтому версия
	web выбрана с переменной <code class="varname">WANT_</code>:</p><pre class="programlisting">WANT_PHP_WEB=	yes</pre><p>Имеющиеся переменные <code class="varname">USE_</code> и
	<code class="varname">WANT_</code> определены в файлах в
	<code class="filename">/usr/ports/Mk</code>.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-masterdir"></a>5.9. <code class="varname">MASTERDIR</code></h2></div></div></div><p>Если вашему порту требуется построение довольно
      различающихся версий пакетов через переменную (задающую,
      например, разрешение, или размер бумаги), которая принимает
      различные значения, создайте для каждого пакета отдельный
      подкаталог, чтобы пользователям было легче определить, каким
      пакетом воспользоваться, но попробуйте использовать совместно
      между портами как можно больше файлов.  В типичном случае вам
      потребуются только очень короткие файлы
      <code class="filename">Makefile</code> во всех каталогах, кроме одного,
      если вы будете использовать переменные с умом.  В отдельных
      файлах <code class="filename">Makefile</code> вы можете использовать
      переменную <code class="varname">MASTERDIR</code> для указания каталога,
      в котором находятся все остальные файлы.  Также используйте
      переменную как часть <a class="link" href="#porting-pkgname" title="5.2.4. Соглашения по именованию пакетов"><code class="varname">PKGNAMESUFFIX</code></a>,
      чтобы пакеты имели разные имена.</p><p>Продемонстрируем это на примере.  Вот часть файла
      <code class="filename">japanese/xdvi300/Makefile</code>:</p><pre class="programlisting">PORTNAME=	xdvi
PORTVERSION=	17
PKGNAMEPREFIX=	ja-
PKGNAMESUFFIX=	${RESOLUTION}
 :
# default
RESOLUTION?=	300
.if ${RESOLUTION} != 118 &amp;&amp; ${RESOLUTION} != 240 &amp;&amp; \
	${RESOLUTION} != 300 &amp;&amp; ${RESOLUTION} != 400
	@${ECHO_MSG} "Error: invalid value for RESOLUTION: \"${RESOLUTION}\""
	@${ECHO_MSG} "Possible values are: 118, 240, 300 (default) and 400."
	@${FALSE}
.endif</pre><p>Порт <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/japanese/xdvi300/pkg-descr">japanese/xdvi300</a>
      содержит также все обычные патчи, файлы для пакета и так далее.
      Если вы введете здесь команду <code class="command">make</code>, она
      возьмет в качестве разрешения значение по умолчанию (300) и
      построит порт обычным образом.</p><p>Для другого разрешения приведем <span class="emphasis"><em>полный</em></span>
      <code class="filename">xdvi118/Makefile</code>:</p><pre class="programlisting">RESOLUTION=	118
MASTERDIR=	${.CURDIR}/../xdvi300

.include "${MASTERDIR}/Makefile"</pre><p>(<code class="filename">xdvi240/Makefile</code> и
      <code class="filename">xdvi400/Makefile</code> похожи).  Задание
      <code class="varname">MASTERDIR</code> говорит
      <code class="filename">bsd.port.mk</code>, что обычный набор
      подкаталогов типа <code class="varname">FILESDIR</code> и
      <code class="varname">SCRIPTDIR</code> находится в каталоге
      <code class="filename">xdvi300</code>.  Строчка
      <code class="literal">RESOLUTION=118</code> переопределят строку
      <code class="literal">RESOLUTION=300</code> в файле
      <code class="filename">xdvi300/Makefile</code> и порт будет построен с
      разрешением 118.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-manpages"></a>5.10. Страницы Справочника</h2></div></div></div><p>Если ваш порт определяет корнем для файлов Справочника
      каталог, отличный от <code class="varname">PREFIX</code>, вы можете
      использовать переменную <code class="varname">MANDIRS</code>, чтобы
      указать эти каталоги.  Обратите внимание, что файлы страниц
      справочника следует размещать в <code class="filename">pkg-plist</code>
      наряду с остальными файлами.  <code class="varname">MANDIRS</code>
      предназначена для автоматического сжатия страниц справочника,
      так чтобы имена файлов оканчивались на
      <code class="filename">.gz</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-info"></a>5.11. Файлы в формате info</h2></div></div></div><p>Если в вашем пакете нужна установка файлов GNU info, они
      должны быть перечислены в переменной <code class="varname">INFO</code>
      (без окончания <code class="literal">.info</code>), по записи на
      документ.  Предполагается, что эти файлы устанавливаются в
      <code class="filename">PREFIX/INFO_PATH</code>.  Вы можете изменить
      <code class="varname">INFO_PATH</code>, если ваш пакет использует другое
      место для размещения.  Однако, это не рекомендуется делать.
      Эти записи всего лишь содержат путь относительно
      <code class="filename">PREFIX/INFO_PATH</code>.  Например, <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/gcc34/pkg-descr">lang/gcc34</a> устанавливает файлы info в
      <code class="filename">PREFIX/INFO_PATH/gcc34</code>, и в
      <code class="varname">INFO</code> будет что-то вроде этого:</p><pre class="programlisting">INFO=	gcc34/cpp gcc34/cppinternals gcc34/g77 ...</pre><p>Перед регистрацией пакета соответствующий код
      установки/удаления будет автоматически добавлен во временный
      <code class="filename">pkg-plist</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-options"></a>5.12. Опции для Makefile</h2></div></div></div><p>Многие приложения могут быть построены в различных
      конфигурациях и с дополнительной функциональностью.  Например,
      выбор естественного (человеческого) языка, GUI против командной
      строки или типа используемой базы данных.  Пользователи могут
      нуждаться в различных конфигурациях, отличных от используемой
      по умолчанию, поэтому в системе портов предусмотрен механизм,
      позволяющий автору порта управлять сборкой того или иного
      варианта конфигурации.  Правильная поддержка этих
      необязательных параметров облегчает пользователям жизнь и даёт
      два или более порта по цене одного.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74949840"></a>5.12.1. Knobs</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74950480"></a>5.12.1.1. <code class="varname">WITH_<em class="replaceable"><code>*</code></em></code>
	  и
	  <code class="varname">WITHOUT_<em class="replaceable"><code>*</code></em></code></h4></div></div></div><p>Эти переменные предназначены для установки системным
	  администратором.  Многие из них стандартизованы в файле
	  <a class="link" href="http://svnweb.FreeBSD.org/ports/head/KNOBS?view=markup" target="_top"><code class="filename">ports/KNOBS</code></a>.</p><p>При создании порта не давайте имя для knob, специфичное
	  для данного приложения.  На примере порта Avahi,
	  используйте <code class="varname">WITHOUT_MDNS</code> вместо
	  <code class="varname">WITHOUT_AVAHI_MDNS</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Не стоит рассчитывать, что
	    <code class="varname">WITH_<em class="replaceable"><code>*</code></em></code>
	    обязательно имеет соответствующую переменную
	    <code class="varname">WITHOUT_<em class="replaceable"><code>*</code></em></code>,
	    и наоборот.  В общем случае, предполагается значение по
	    умолчанию.</p></div><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если обратное не указано, то проверяется только факт
	    установки самих переменных, но не их конкретное значение
	    типа <code class="literal">YES</code> или
	    <code class="literal">NO</code>.</p></div><div class="table"><a id="idp74958032"></a><div class="table-title">Таблица 5.3. Основные переменные
	    <code class="varname">WITH_<em class="replaceable"><code>*</code></em></code> и
	    <code class="varname">WITHOUT_<em class="replaceable"><code>*</code></em></code></div><div class="table-contents"><table summary="Основные переменные&#10;&#9;    WITH_* и&#10;&#9;    WITHOUT_*" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">WITH_OPENSSL_BASE</code></td><td>Использовать версию OpenSSL из базовой
		  системы.</td></tr><tr><td><code class="varname">WITH_OPENSSL_PORT</code></td><td>Устанавливает версию OpenSSL из <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/openssl/pkg-descr">security/openssl</a>, даже если в
		  базовой системе последняя версия.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74969936"></a>5.12.1.2. Наименование KNOBS</h4></div></div></div><p>Портеры должны использовать так называемые knobs для
	  помощи конечным пользователям и для поддержания количества
	  наименований knobs в небольшом количестве.  Список
	  популярных названий knobs можно найти в файле <a class="link" href="http://svnweb.FreeBSD.org/ports/head/KNOBS?view=markup" target="_top"><code class="filename">KNOBS</code></a></p><p>Названия knobs должны отражать, что это такое и что
	  выполняет.  Если у порта имеется библиотечный префикс в
	  <code class="varname">PORTNAME</code>, то он должен присутствовать в
	  названии knobs.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74972496"></a>5.12.2. <code class="varname">OPTIONS</code></h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74973264"></a>5.12.2.1. Описание</h4></div></div></div><p>При установке порта переменные
	  <code class="varname">OPTIONS_*</code> предоставляют пользователю
	  окно диалога с отображением доступных параметров, с записью
	  выбранных параметров в файл
	  <code class="filename">/var/db/ports/${UNIQUENAME}/options</code>.
	  Эти опции повторно используются при следующем построении
	  порта.</p><p>Когда пользователь запускает
	  <code class="command">make config</code> (или запускает впервые
	  <code class="command">make build</code>), инфраструктура выполняет
	  проверку существования файла
	  <code class="filename">/var/db/ports/${UNIQUENAME}/options</code>.
	  Если этот файл не существует, то используются значения
	  <code class="varname">OPTIONS_*</code> и отображается диалоговое
	  окно, в котором эти параметры можно включить или выключить.
	  Затем сохраняется файл опций <code class="filename">options</code>,
	  и выбранные переменные используются при построении
	  порта.</p><p>Если новая версия порта добавляет новые значения
	  <code class="varname">OPTIONS</code>, то пользователю будет
	  представлено окно диалога с сохраненными заполненными
	  значениями старых <code class="varname">OPTIONS.</code></p><p><code class="command">make showconfig</code> отображает
	  сохраненную конфигурацию.  Для удаления сохраненной
	  конфигурации используйте
	  <code class="command">make rmconfig</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74979664"></a>5.12.2.2. Синтаксис</h4></div></div></div><p><code class="varname">OPTIONS_DEFINE</code> содержит список
	  используемых <code class="varname">OPTIONS</code>.  Они независимы
	  друг от друга и не сгруппированы:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1 OPT2</pre><p>Далее после определения следует описание
	  <code class="varname">OPTIONS</code> (не является обязательным, но
	  настоятельно рекомендуется):</p><pre class="programlisting">OPT1_DESC=	Describe OPT1
OPT2_DESC=	Describe OPT2
OPT3_DESC=	Describe OPT3
OPT4_DESC=	Describe OPT4
OPT5_DESC=	Describe OPT5
OPT6_DESC=	Describe OPT6</pre><div xmlns="" class="tip"><h3 class="admontitle">Подсказка: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="filename">ports/Mk/bsd.options.desc.mk</code>
	    содержит описание множества наиболее используемых
	    <code class="varname">OPTIONS</code>; переопределять их, как
	    правило, не нужно.</p></div><div xmlns="" class="tip"><h3 class="admontitle">Подсказка: </h3><p xmlns="http://www.w3.org/1999/xhtml">При описании параметров старайтесь представить себя
	    на месте пользователя: <span class="quote"><<<span class="quote">Что это делает?</span>>></span> и
	    <span class="quote"><<<span class="quote">Для чего бы я захотел включить это?</span>>></span>  Не
	    делайте простое повторение названия.  Например, описание
	    параметра <code class="literal">NLS</code> как <span class="quote"><<<span class="quote">include NLS
	      support</span>>></span> (<span class="quote"><<<span class="quote">включить поддержку NLS</span>>></span>)
	    не поможет пользователю, который уже видит название
	    параметра, но может не знать, что это означает.  Описав
	    его как <span class="quote"><<<span class="quote">Native Language Support via gettext
	    utilities</span>>></span> (<span class="quote"><<<span class="quote">Поддержка национального языка
	    через утилиты gettext</span>>></span>), вы поможете пользователю
	    гораздо больше.</p></div><p><code class="varname">OPTIONS</code> можно группировать в виде
	  переключателей, для которых разрешен выбор единственного
	  варианта в каждой группе:</p><pre class="programlisting">OPTIONS_SINGLE=		SG1
OPTIONS_SINGLE_SG1=	OPT3 OPT4</pre><p><code class="varname">OPTIONS</code> можно группировать в виде
	  переключателей, для которых разрешен выбор единственного
	  варианта (или ни одного) в каждой группе:</p><pre class="programlisting">OPTIONS_RADIO=		RG1
OPTIONS_RADIO_RG1=	OPT7 OPT8</pre><p><code class="varname">OPTIONS</code> также можно группировать в
	  виде списков со множественным выбором, для которых обязан
	  быть включен <span class="emphasis"><em>по крайней мере один</em></span> из
	  параметров:</p><pre class="programlisting">OPTIONS_MULTI=		MG1
OPTIONS_MULTI_MG1=	OPT5 OPT6</pre><p><code class="varname">OPTIONS</code> также можно группировать в
	  виде списков со множественным выбором, для которых могут
	  быть включены любые параметры, включая отсутствие
	  выбора:</p><pre class="programlisting">OPTIONS_GROUP=		GG1
OPTIONS_GROUP_GG1=	OPT9 OPT10</pre><p>По умолчанию <code class="varname">OPTIONS</code> находится в
	  выключенном положении, если при этом оно также отсутствует
	  в списке <code class="varname">OPTIONS_DEFAULT</code>:</p><pre class="programlisting">OPTIONS_DEFAULT=	OPT1 OPT3 OPT6</pre><p>Определения <code class="varname">OPTIONS</code> обязаны быть
	  до подключения <code class="filename">bsd.port.options.mk</code>.
	  Переменные <code class="varname">PORT_OPTIONS</code> могут быть
	  проверены только после подключения
	  <code class="filename">bsd.port.options.mk</code>.  Вместо этого
	  также можно использовать подключение
	  <code class="filename">bsd.port.pre.mk</code>, что все еще широко
	  используется в портах, написанных до появления
	  <code class="filename">bsd.port.options.mk</code>.  Но имейте в
	  виду, что некоторые переменные, обычно, это некоторые флаги
	  <code class="varname">USE_*</code>, после подключения
	  <code class="filename">bsd.port.pre.mk</code> будут работать не так,
	  как этого от них ожидают.</p><div class="example"><a id="ports-options-simple-use"></a><div class="example-title">Пример 5.10. Простое использование
	    <code class="varname">OPTIONS</code></div><div class="example-contents"><pre class="programlisting">OPTIONS_DEFINE=	FOO BAR
FOO_DESC=	Enable option foo
BAR_DESC=	Support feature bar

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MFOO}
CONFIGURE_ARGS+=--with-foo
.else
CONFIGURE_ARGS+=--without-foo
.endif

.if ${PORT_OPTIONS:MBAR}
RUN_DEPENDS+=	bar:${PORTSDIR}/bar/bar
.endif

.include &lt;bsd.port.mk&gt;</pre></div></div><br class="example-break" /><div class="example"><a id="ports-options-check-unset"></a><div class="example-title">Пример 5.11. Проверка незаданных значений
	    <code class="varname">OPTIONS</code></div><div class="example-contents"><pre class="programlisting">.if ! ${PORT_OPTIONS:MEXAMPLES}
CONFIGURE_ARGS+=--without-examples
.endif</pre></div></div><br class="example-break" /><div class="example"><a id="ports-options-practical-use"></a><div class="example-title">Пример 5.12. Пример реального использования
	    <code class="varname">OPTIONS</code></div><div class="example-contents"><pre class="programlisting">OPTIONS_DEFINE=		EXAMPLES

OPTIONS_SINGLE=		BACKEND
OPTIONS_SINGLE_BACKEND=	MYSQL PGSQL BDB

OPTIONS_MULTI=		AUTH
OPTIONS_MULTI_AUTH=	LDAP PAM SSL

EXAMPLES_DESC=		Install extra examples
MYSQL_DESC=		Use MySQL as backend
PGSQL_DESC=		Use PostgreSQL as backend
BDB_DESC=		Use Berkeley DB as backend
LDAP_DESC=		Build with LDAP authentication support
PAM_DESC=		Build with PAM support
SSL_DESC=		Build with OpenSSL support

OPTIONS_DEFAULT=	PGSQL LDAP SSL

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MPGSQL}
USE_PGSQL=		yes
CONFIGURE_ARGS+=	--with-postgres
.else
CONFIGURE_ARGS+=	--without-postgres
.endif

.if ${PORT_OPTIONS:MICU}
LIB_DEPENDS+=	libicuuc.so:${PORTSDIR}/devel/icu
.endif

.if ! ${PORT_OPTIONS:MEXAMPLES}
CONFIGURE_ARGS+=	--without-examples
.endif

# Проверка других параметров OPTIONS

.include &lt;bsd.port.mk&gt;</pre></div></div><br class="example-break" /></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75010768"></a>5.12.2.3. Параметры по умолчанию</h4></div></div></div><p>Следующие параметры по умолчанию всегда
	  включены.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">DOCS</code> - построение и
	      установка документации.</p></li><li class="listitem"><p><code class="literal">NLS</code> -
	      интернационализация.</p></li><li class="listitem"><p><code class="literal">EXAMPLES</code> - построение и
	      установка примеров использования.</p></li><li class="listitem"><p><code class="literal">IPV6</code> - поддержка протокола
	      IPv6.</p></li></ul></div><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Нет необходимости добавлять эти параметры в
	    <code class="varname">OPTIONS_DEFAULT</code>.  Тем не менее, чтобы
	    отобразить их в окне диалога выбора параметров, они
	    должны быть добавлены в
	    <code class="varname">OPTIONS_DEFINE</code>.</p></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75018064"></a>5.12.3. Функция автоматической активации</h3></div></div></div><p>При использовании сценария GNU configure, следите за тем,
	какие необязательные функции задействуются посредством
	автоматической активации.  Отключайте явным образом те
	необязательные функции, которые вы не хотели бы использовать,
	через передачу соответствующих
	<code class="literal">--without-xxx</code> или
	<code class="literal">--disable-xxx</code> в переменной
	<code class="varname">CONFIGURE_ARGS</code>.</p><div class="example"><a id="idp75028560"></a><div class="example-title">Пример 5.13. Неправильное управление опцией</div><div class="example-contents"><pre class="programlisting">.if ${PORT_OPTIONS:MFOO}
LIB_DEPENDS+=		libfoo.so:${PORTSDIR}/devel/foo
CONFIGURE_ARGS+=	--enable-foo
.endif</pre></div></div><br class="example-break" /><p>В приведенном выше примере представьте себе библиотеку
	libfoo, установленную в системе.  Пользователь не желает,
	чтобы приложение использовало libfoo, и поэтому он выключает
	соответствующую опцию в диалоге <code class="literal">make
	  config</code>.  Но сценарий configure приложения
	определяет наличие библиотеки в системе и включает ее
	поддержку в итоговый исполняемый файл.  Теперь, когда
	пользователь решит удалить libfoo из системы, система портов
	позволит это сделать (т.к. зависимость от libfoo не была
	записана), но приложение перестанет работать.</p><div class="example"><a id="idp75030480"></a><div class="example-title">Пример 5.14. Правильное управление опцией</div><div class="example-contents"><pre class="programlisting">.if ${PORT_OPTIONS:MFOO}
LIB_DEPENDS+=		libfoo.so:${PORTSDIR}/devel/foo
CONFIGURE_ARGS+=	--enable-foo
.else
CONFIGURE_ARGS+=	--disable-foo
.endif</pre></div></div><br class="example-break" /><p>Во втором примере библиотека libfoo отключена явным
	образом.  Сценарий configure не включает соответствующие
	функции в приложении, несмотря на присутствие библиотеки в
	системе.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">При определенных условиях сокращенный синтаксис записи
	  условий может вызывать проблемы со сложными конструкциями.
	  Если вы получаете ошибки, такие как <code class="literal">Malformed
	    conditional</code>, то может быть использован
	  альтернативный синтаксис.</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">.if !empty(VARIABLE:MVALUE)
# as an alternative to
.if ${VARIABLE:MVALUE}</pre></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75033680"></a>5.12.4. Вспомогательные макросы</h3></div></div></div><p>Существует несколько макросов, упрощающих запись условных
	значений, которые отличаются в зависимости от набора
	параметров.</p><p>Если переменная <code class="varname">OPTIONS_SUB</code> имеет
	значение <code class="literal">yes</code>, то каждый из указанных в
	<code class="varname">OPTIONS_DEFINE</code> параметров будет добавлен в
	<code class="varname">PLIST_SUB</code>.  Следующая запись:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
OPTIONS_SUB=	yes</pre><p>соответствует:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MOPT1}
PLIST_SUB+=	OPT1=""
.else
PLIST_SUB+=	OPT1="@comment "
.endif</pre><p><code class="varname">X_CONFIGURE_ENABLE</code> дописывает в
	<code class="varname">CONFIGURE_ARGS</code> строку
	<code class="literal">--enable-${X_CONFIGURE_ENABLE}</code> или
	<code class="literal">--disable-${X_CONFIGURE_ENABLE}</code> в
	соответствии с состоянием <code class="varname">X</code>.  Следующая
	запись:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
OPT1_CONFIGURE_ENABLE=	test</pre><p>соответствует:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MOPT1}
CONFIGURE_ARGS+=	--enable-test
.else
CONFIGURE_ARGS+=	--disable-test
.endif</pre><p><code class="varname">X_CONFIGURE_WITH</code> дописывает в
	<code class="varname">CONFIGURE_ARGS</code> строку
	<code class="literal">--with-${X_CONFIGURE_WITH}</code> или
	<code class="literal">--without-${X_CONFIGURE_WITH}</code> в
	соответствии с состоянием <code class="varname">X</code>.  Следующая
	запись:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
OPT1_CONFIGURE_WITH=	test</pre><p>соответствует:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MOPT1}
CONFIGURE_ARGS+=	--with-test
.else
CONFIGURE_ARGS+=	--without-test
.endif</pre><p>Значение переменной <code class="varname">X_CONFIGURE_ON</code>
	будет дописано в <code class="varname">CONFIGURE_ARGS</code> в
	соответствии с состоянием <code class="varname">X</code>.  Следующая
	запись:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
OPT1_CONFIGURE_ON=	--add-test</pre><p>соответствует:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MOPT1}
CONFIGURE_ARGS+=	--add-test
.endif</pre><p>Значение переменной <code class="varname">X_CONFIGURE_OFF</code>
	будет дописано в <code class="varname">CONFIGURE_ARGS</code> в
	соответствии с состоянием <code class="varname">X</code>.  Следующая
	запись:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
OPT1_CONFIGURE_OFF=	--no-test</pre><p>соответствует:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
.include &lt;bsd.port.options.mk&gt;
.if ! ${PORT_OPTIONS:MOPT1}
CONFIGURE_ARGS+=	--no-test
.endif</pre><p>Значение переменной <code class="varname">X_CMAKE_ON</code> будет
	дописано в <code class="varname">CMAKE_ARGS</code> в соответствии с
	состоянием <code class="varname">X</code>.  Следующая запись:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
OPT1_CMAKE_ON=	-DTEST:BOOL=true</pre><p>соответствует:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MOPT1}
CMAKE_ARGS+=	-DTEST:BOOL=true
.endif</pre><p>Значение переменной <code class="varname">X_CMAKE_OFF</code> будет
	дописано в <code class="varname">CMAKE_ARGS</code> в соответствии с
	состоянием <code class="varname">X</code>.  Следующая запись:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
OPT1_CMAKE_OFF=	-DTEST:BOOL=false</pre><p>соответствует:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1

.include &lt;bsd.port.options.mk&gt;

.if ! ${PORT_OPTIONS:MOPT1}
CMAKE_ARGS+=	-DTEST:BOOL=false
.endif</pre><p>Для любой из следующих переменных:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">ALL_TARGET</code></p></li><li class="listitem"><p><code class="varname">CATEGORIES</code></p></li><li class="listitem"><p><code class="varname">CFLAGS</code></p></li><li class="listitem"><p><code class="varname">CPPFLAGS</code></p></li><li class="listitem"><p><code class="varname">CXXFLAGS</code></p></li><li class="listitem"><p><code class="varname">CONFIGURE_ENV</code></p></li><li class="listitem"><p><code class="varname">DISTFILES</code></p></li><li class="listitem"><p><code class="varname">EXTRA_PATCHES</code></p></li><li class="listitem"><p><code class="varname">INSTALL_TARGET</code></p></li><li class="listitem"><p><code class="varname">LDFLAGS</code></p></li><li class="listitem"><p><code class="varname">MAKE_ARGS</code></p></li><li class="listitem"><p><code class="varname">MAKE_ENV</code></p></li><li class="listitem"><p><code class="varname">PATCH_SITES</code></p></li><li class="listitem"><p><code class="varname">PATCHFILES</code></p></li><li class="listitem"><p><code class="varname">PLIST_FILES</code></p></li><li class="listitem"><p><code class="varname">PLIST_DIRS</code></p></li><li class="listitem"><p><code class="varname">PLIST_DIRSTRY</code></p></li><li class="listitem"><p><code class="varname">USES</code></p></li></ul></div><p>Значение переменной <code class="varname">X_ABOVEVARIABLE</code>
	будет дописано в <code class="varname">ABOVEVARIABLE</code> в
	соответствии с состоянием <code class="varname">X</code>.  Следующая
	запись:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
OPT1_USES=	gmake
OPT1_CFLAGS=	-DTEST</pre><p>соответствует:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MOPT1}
USES+=		gmake
CFLAGS+=	-DTEST
.endif</pre><p>Если установлена <code class="varname">X_ABOVEVARIABLE_OFF</code>,
	то флаг <code class="literal">ABOVEVARIABLE</code> будет автоматически
	выставлен при выключенном параметре <code class="literal">X</code>.
	Например:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
OPT1_USES_OFF=gmake</pre><p>соответствует:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1

.include &lt;bsd.port.options.mk&gt;

.if ! ${PORT_OPTIONS:MOPT1}
USES+=	gmake
.endif</pre><p>Для любого из следующих типов зависимости:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">PKG_DEPENDS</code></p></li><li class="listitem"><p><code class="varname">EXTRACT_DEPENDS</code></p></li><li class="listitem"><p><code class="varname">PATCH_DEPENDS</code></p></li><li class="listitem"><p><code class="varname">FETCH_DEPENDS</code></p></li><li class="listitem"><p><code class="varname">BUILD_DEPENDS</code></p></li><li class="listitem"><p><code class="varname">LIB_DEPENDS</code></p></li><li class="listitem"><p><code class="varname">RUN_DEPENDS</code></p></li></ul></div><p>Значение переменной <code class="varname">X_ABOVEVARIABLE</code>
	будет дописано в <code class="varname">ABOVEVARIABLE</code> в
	соответствии с состоянием <code class="varname">X</code>.  Следующая
	запись:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
OPT1_LIB_DEPENDS=	liba.so:${PORTSDIR}/devel/a</pre><p>соответствует:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MOPT1}
LIB_DEPENDS+=	liba.so:${PORTSDIR}/devel/a
.endif</pre><p>Если установлена <code class="varname">X_ABOVEVARIABLE_OFF</code>,
	то зависимость типа <code class="literal">ABOVEVARIABLE</code> будет
	добавлена при выключенном параметре <code class="literal">X</code>.
	Например:</p><pre class="programlisting">OPTIONS_DEFINE=	OPT1
OPT1_LIB_DEPENDS_OFF= liba.so:${PORTSDIR}/devel/a</pre><p>соответствует:</p><pre class="programlisting">OPTIONS_DEFINE= OPT1

.include &lt;bsd.port.options.mk&gt;

. if ! ${PORT_OPTIONS:MOPT1}
LIB_DEPENDS+=	liba.so:${PORTSDIR}/devel/a
.endif</pre></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-wrkdir"></a>5.13. Задание рабочего каталога</h2></div></div></div><p>Каждый порт распаковывается в рабочий каталог, который
      должен быть доступным для записи.  В системе портов по
      умолчанию <code class="varname">DISTFILES</code> распаковываются в
      каталог с именем <code class="literal">${DISTNAME}</code>.  Другими
      словами, если вы задали:</p><pre class="programlisting">PORTNAME=	foo
PORTVERSION=	1.0</pre><p>то дистрибутивные файлы порта содержат каталог верхнего
      уровня, <code class="filename">foo-1.0</code>, и все файлы расположены
      в этом каталоге.</p><p>Если это не ваш случай, то имеется несколько переменных,
      которые вы можете переопределить.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75127504"></a>5.13.1. <code class="varname">WRKSRC</code></h3></div></div></div><p>Эта переменная задаёт имя каталога, который создаётся при
	распаковке исходных файлов приложения.  В нашем предыдущем
	примере если бы распаковка происходила в каталог с именем
	<code class="filename">foo</code> (а не <code class="filename">foo-1.0</code>),
	то вы должны написать:</p><pre class="programlisting">WRKSRC=	${WRKDIR}/foo</pre><p>или, как вариант</p><pre class="programlisting">WRKSRC=	${WRKDIR}/${PORTNAME}</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75130704"></a>5.13.2. <code class="varname">NO_WRKSUBDIR</code></h3></div></div></div><p>Если порт вообще не распаковывается ни в какой каталог,
	то вы должны задать для этого переменную
	<code class="varname">NO_WRKSUBDIR</code>.</p><pre class="programlisting">NO_WRKSUBDIR=	yes</pre></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="conflicts"></a>5.14. Разрешение конфликтов</h2></div></div></div><p>Для регистрации конфликта между пакетами и портами
      используются три различные переменные:
      <code class="varname">CONFLICTS</code>,
      <code class="varname">CONFLICTS_INSTALL</code> и
      <code class="varname">CONFLICTS_BUILD</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Переменные регистрации конфликта автоматически определяют
	переменную <code class="varname">IGNORE</code>, которая более подробно
	описана в <a class="xref" href="#dads-noinstall" title="12.13. Пометка неустанавливаемого порта как BROKEN, FORBIDDEN или IGNORE">Раздел 12.13, <<Пометка неустанавливаемого порта как
      <code class="varname">BROKEN</code>, <code class="varname">FORBIDDEN</code> или
      <code class="varname">IGNORE</code>>></a>.</p></div><p>При удалении одного из конфликтующих портов целесообразно
      сохранить записи <code class="varname">CONFLICTS</code> в тех других
      портах в течении нескольких месяцев, чтобы позаботиться о тех
      пользователей, которые обновляются от случая к случаю.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75137616"></a>5.14.1. <code class="varname">CONFLICTS_INSTALL</code></h3></div></div></div><p>Если ваш пакет не может существовать вместе с другими
	(из-за конфликта файлов, несовместимости времени выполнения и
	так далее), перечислите имена остальных пакетов в переменной
	<code class="varname">CONFLICTS_INSTALL</code>.  Здесь вы можете
	использовать шаблоны командного интерпретатора, такие как
	<code class="literal">*</code> и <code class="literal">?</code>.  Имена пакетов
	должны выглядеть так же, как в
	<code class="filename">/var/db/pkg</code>.  Пожалуйста, убедитесь, что
	<code class="varname">CONFLICTS_INSTALL</code> не содержит пакет самого
	этого порта.  В противном случае не будет работать установка
	с использованием переменной
	<code class="varname">FORCE_PKG_REGISTER</code>.  Проверка
	CONFLICTS_INSTALL выполняется после процесса сборки и до
	процесса установки.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75141200"></a>5.14.2. <code class="varname">CONFLICTS_BUILD</code></h3></div></div></div><p>Если ваш порт не может быть собран, когда уже установлен
	другой, перечислите имена остальных портов в переменной
	<code class="varname">CONFLICTS_BUILD</code>.  Здесь вы можете
	использовать шаблоны командного интерпретатора, такие как
	<code class="literal">*</code> и <code class="literal">?</code>.  Имена пакетов
	должны выглядеть так же, как в
	<code class="filename">/var/db/pkg</code>.  Проверка CONFLICTS_BUILD
	выполняется до процесса сборки.  Конфликты сборки в
	получаемом пакете не записываются.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75172816"></a>5.14.3. <code class="varname">CONFLICTS</code></h3></div></div></div><p>Если ваш порт не может быть собран, когда уже установлен
	другой, а получаемый пакет не может существовать вместе с
	другими, перечислите имена остальных пакетов в переменной
	<code class="varname">CONFLICTS</code>.  Здесь вы можете использовать
	шаблоны командного интерпретатора, такие как
	<code class="literal">*</code> и <code class="literal">?</code>.  Имена пакетов
	должны выглядеть так же, как в
	<code class="filename">/var/db/pkg</code>.  Пожалуйста, убедитесь, что
	<code class="varname">CONFLICTS</code> не содержит пакет самого этого
	порта.  В противном случае не будет работать установка с
	использованием переменной
	<code class="varname">FORCE_PKG_REGISTER</code>.  Проверка CONFLICTS
	выполняется до процессов сборки и установки.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="install"></a>5.15. Установка файлов</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="install-macros"></a>5.15.1. Макросы <code class="varname">INSTALL_*</code></h3></div></div></div><p>Используйте макросы, которые есть в файле
	<code class="filename">bsd.port.mk</code> для обеспечения правильных
	прав доступа файлов в целях
	<code class="buildtarget">*-install</code> порта.  Устанавливайте
	права владения напрямую в <code class="filename">pkg-plist</code>
	через соответствующие записи <code class="literal">@owner owner</code>
	и <code class="literal">@group group</code>.  Эти операторы работают до
	момента их переопределения или до конца
	<code class="filename">pkg-plist</code>, поэтому не забывайте их
	сбрасывать, когда они больше не нужны.  По умолчанию владение
	устанавливается для <code class="literal">root:wheel</code>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">INSTALL_PROGRAM</code> - это команда для
	    установки бинарных выполнимых файлов.</p></li><li class="listitem"><p><code class="varname">INSTALL_SCRIPT</code> - это команда для
	    установки выполнимых скриптов.</p></li><li class="listitem"><p><code class="varname">INSTALL_LIB</code> - это команда для
	    установки динамических библиотек.</p></li><li class="listitem"><p><code class="varname">INSTALL_KLD</code> - это команда для
	    установки загружаемых модулей ядра.  Некоторые
	    архитектуры предпочитают, чтобы для модулей сохранялись
	    отладочные сведения, по этой причине используйте эту
	    команду вместо <code class="varname">INSTALL_PROGRAM</code>.</p></li><li class="listitem"><p><code class="varname">INSTALL_DATA</code> - это команда для
	    установки совместно используемых файлов данных.</p></li><li class="listitem"><p><code class="varname">INSTALL_MAN</code> - это команда для
	    установки страниц Справочника и другой документации
	    (никаких файлов она не сжимает).</p></li></ul></div><p>В основе работы этих макросов лежит команда
	<code class="command">install</code> со всеми соответствующими флагами.
	Смотрите пример их использования ниже.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="install-strip"></a>5.15.2. Удаление отладочной информации в бинарных файлах и
	динамических библиотеках</h3></div></div></div><p>Не удаляйте отладочную информацию из бинарных файлов
	вручную, если вы это делали.  Во всех двоичных файлах
	отладочная информация должна быть удалена, и макрос
	<code class="varname">INSTALL_PROGRAM</code> выполнит установку и
	удаление отладочной информации одновременно (обратитесь к
	следующему разделу).  Макрос <code class="varname">INSTALL_LIB</code>
	делает то же самое для динамических библиотек.</p><p>Если вам нужно удалить отладочную информацию из файла без
	использования макросов <code class="varname">INSTALL_PROGRAM</code> и
	<code class="varname">INSTALL_LIB</code>, то это можно сделать при
	помощи <code class="varname">${STRIP_CMD}</code>.  Обычно это делается
	внутри цели <code class="literal">post-install</code>.  К
	примеру:</p><pre class="programlisting">post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/xdl</pre><p>Удаление отладочной информации из нескольких
	файлов:</p><pre class="programlisting">post-install:
	.for l in geometry media body track world
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/lib${PORTNAME}-${l}.so.0
	.endfor</pre><p>Для проверки того, удалена ли отладочная информация из
	файла, используйте <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=file&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">file</span>(1)</span></a>.  Для двоичных файлов
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=file&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">file</span>(1)</span></a> печатает <code class="literal">stripped</code> или
	<code class="literal">not stripped</code>.  Кроме того, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=strip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">strip</span>(1)</span></a>
	определяет, была ли уже удалена из программы отладочная
	информация, и в этом случае просто завершает свою
	работу.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="install-copytree"></a>5.15.3. Установка целого дерева файлов</h3></div></div></div><p>Иногда должно быть установлено большое количество файлов
	с сохранением их иерархической организации.  Например,
	копирование дерева каталогов целиком из
	<code class="varname">WRKSRC</code> в целевой каталог внутри
	<code class="varname">PREFIX</code>.  Обратите внимание, что
	<code class="varname">PREFIX</code>, <code class="varname">EXAMPLESDIR</code>,
	<code class="varname">DATADIR</code> и другие переменные пути всегда
	должны предваряться <code class="varname">STAGEDIR</code>, чтобы не
	ломать staging (смотрите <a class="xref" href="#staging" title="6.1. Staging">Раздел 6.1, <<Staging>></a>).</p><p>Для этой ситуации существует два макроса.  Преимущество
	от использования этих макросов вместо команды
	<code class="command">cp</code> в том, что они гарантируют установку
	правильного владельца и прав на конечные файлы.  Первый
	макрос, <code class="varname">COPYTREE_BIN</code>, делает все
	устанавливаемые файлы исполняемыми, что подходит для
	установки в <code class="filename">PREFIX/bin</code>.  Второй макрос,
	<code class="varname">COPYTREE_SHARE</code>, не устанавливает на файлы
	права исполнения, и, таким образом, подходит для установки
	файлов внутри каталога
	<code class="filename">PREFIX/share</code>.</p><pre class="programlisting">post-install:
	${MKDIR} ${STAGEDIR}${EXAMPLESDIR}
	(cd ${WRKSRC}/examples &amp;&amp; ${COPYTREE_SHARE} . ${STAGEDIR}${EXAMPLESDIR})</pre><p>В этом примере устанавливается содержимое каталога
	<code class="filename">examples</code> из установочных файлов
	производителя в надлежащее место для примеров вашего
	порта.</p><pre class="programlisting">post-install:
	${MKDIR} ${STAGEDIR}${DATADIR}/summer
	(cd ${WRKSRC}/temperatures &amp;&amp; ${COPYTREE_SHARE} "June July August" ${STAGEDIR}${DATADIR}/summer)</pre><p>А в этом примере будут установлены данные летних месяцев
	в подкаталог <code class="filename">summer</code> каталога
	<code class="filename">DATADIR</code>.</p><p>В качестве третьего параметра в макросе
	<code class="varname">COPYTREE_*</code> можно передать дополнительные
	параметры <code class="command">find</code>.  Например, чтобы в первом
	примере установить все файлы кроме файлов Makefile, можно
	использовать следующую команду.</p><pre class="programlisting">post-install:
	${MKDIR} ${STAGEDIR}${EXAMPLESDIR}
	(cd ${WRKSRC}/examples &amp;&amp; \
	${COPYTREE_SHARE} . ${STAGEDIR}${EXAMPLESDIR} "! -name Makefile")</pre><p>Эти макросы не производят добавление устанавливаемых
	файлов в <code class="filename">pkg-plist</code>.  Они должны быть
	добавлены туда вручную.  Необязательные файлы документации
	(<code class="varname">PORTDOCS</code>, смотрите <a class="xref" href="#install-documentation" title="5.15.4. Установка дополнительной документации">Раздел 5.15.4, <<Установка дополнительной документации>></a>) и примеров
	(<code class="varname">PORTEXAMPLES</code>) всегда должны предваряться
	в <code class="filename">pkg-plist</code> префиксами
	<code class="literal">%%PORTDOCS%%</code> или
	<code class="literal">%%PORTEXAMPLES%%</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="install-documentation"></a>5.15.4. Установка дополнительной документации</h3></div></div></div><p>Если с вашим программным обеспечением поставляется
	некоторая документация, отличающаяся от стандартных страниц
	Справочника и файлов info, которая, как вы думаете, будет
	полезна пользователям, установите ее в каталог
	<code class="filename">PREFIX/share/doc</code>.  Это может быть
	сделано, как и в предыдущем разделе, в цели
	<code class="buildtarget">post-install</code>.</p><p>Создайте для вашего порта новый каталог.  Имя каталога
	должно соответствовать тому, что представляет из себя порт.
	Обычно это означает <code class="varname">PORTNAME</code>.  Однако,
	если вы думаете, что пользователь захочет иметь разные версии
	порта, установленные одновременно, то вы можете использовать
	полное имя <code class="varname">PKGNAME</code>.</p><p>Поскольку устанавливаются только файлы, перечисленные в
	<code class="filename">pkg-plist</code>, безопасным способом будет
	устанавливать документацию в <code class="varname">STAGEDIR</code>
	всегда (смотрите <a class="xref" href="#staging" title="6.1. Staging">Раздел 6.1, <<Staging>></a>).  Следовательно,
	блоки <code class="literal">.if</code> нужны только для файлов
	достаточно большого размера, установка которых влечёт
	значительные накладные расходы на операции
	ввода/вывода.</p><pre class="programlisting">post-install:
	${MKDIR} ${STAGEDIR}${DOCSDIR}
	${INSTALL_MAN} ${WRKSRC}/docs/xvdocs.ps ${STAGEDIR}${DOCSDIR}</pre><p>Вот несколько полезных переменных и то, как они
	преобразуются по умолчанию при использовании в
	<code class="filename">Makefile</code>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">DATADIR</code> преобразуется в
	    <code class="filename">PREFIX/share/PORTNAME</code>.</p></li><li class="listitem"><p><code class="varname">DATADIR_REL</code> преобразуется в
	    <code class="filename">share/PORTNAME</code>.</p></li><li class="listitem"><p><code class="varname">DOCSDIR</code> преобразуется в
	    <code class="filename">PREFIX/share/doc/PORTNAME</code>.</p></li><li class="listitem"><p><code class="varname">DOCSDIR_REL</code> преобразуется в
	    <code class="filename">share/doc/PORTNAME</code>.</p></li><li class="listitem"><p><code class="varname">EXAMPLESDIR</code> преобразуется в
	    <code class="filename">PREFIX/share/examples/PORTNAME</code>.</p></li><li class="listitem"><p><code class="varname">EXAMPLESDIR_REL</code> преобразуется в
	    <code class="filename">share/examples/PORTNAME</code>.</p></li></ul></div><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Параметр <code class="literal">DOCS</code> управляет установкой
	  дополнительной документации в <code class="varname">DOCSDIR</code>.
	  Это не относится к стандартным страницам справочника и
	  страницам info.  Все, что устанавливается в
	  <code class="varname">DATADIR</code> и
	  <code class="varname">EXAMPLESDIR</code>, соответственно управляется
	  через параметры <code class="literal">DATA</code> и
	  <code class="literal">EXAMPLES</code>.</p></div><p>Эти переменные экспортируются в
	<code class="varname">PLIST_SUB</code>.  Их значения появятся там в
	виде имён путей относительно <code class="filename">PREFIX</code>,
	если это возможно.  То есть
	<code class="filename">share/doc/PORTNAME</code> в списке сборки по
	умолчанию будет заменен на <code class="literal">%%DOCSDIR%%</code>, и
	так далее.  (Дополнительную информацию о подстановке в
	<code class="filename">pkg-plist</code> можно найти <a class="link" href="#plist-sub" title="7.1. Изменение содержимого pkg-plist в зависимости от make-переменных">здесь</a>.)</p><p>Все условно устанавливаемые файлы и каталоги с
	документацией должны быть перечислены в файле
	<code class="filename">pkg-plist</code> с префиксом
	<code class="literal">%%PORTDOCS%%</code>, например:</p><pre class="programlisting">%%PORTDOCS%%%%DOCSDIR%%/AUTHORS
%%PORTDOCS%%%%DOCSDIR%%/CONTACT
%%PORTDOCS%%@dirrm %%DOCSDIR%%</pre><p>В качестве альтернативы перечислению файлов документации
	в файле <code class="filename">pkg-plist</code>, порт может указать в
	переменной <code class="varname">PORTDOCS</code> список имён файлов и
	глобальных шаблонов командного процессора для добавления в
	окончательный список сборки.  Имена будут задаваться
	относительно <code class="varname">DOCSDIR</code>.  Таким образом,
	порт, использующий <code class="varname">PORTDOCS</code> и
	нестандартное местоположение документации, должен задавать
	соответствующим образом и <code class="varname">DOCSDIR</code>.  Если
	каталог указан в <code class="varname">PORTDOCS</code> или
	соответствует шаблону для этой переменной, то полное
	поддерево с входящими в него файлами и каталогами будет
	регистрироваться в окончательном списке сборки.  Если
	параметр <code class="literal">DOCS</code> не задан, то файлы и
	каталоги, перечисленные в <code class="varname">PORTDOCS</code>, не
	будут установлены и добавлены в список сборки порта.
	Установка документации в <code class="varname">PORTDOCS</code>, как это
	показано выше, остаётся за самим портом.  Типичный пример
	использования <code class="varname">PORTDOCS</code> выглядит следующим
	образом:</p><pre class="programlisting">PORTDOCS=	README.* ChangeLog docs/*</pre><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Эквивалентами <code class="varname">PORTDOCS</code> для файлов,
	  устанавливаемых в <code class="varname">DATADIR</code> и
	  <code class="varname">EXAMPLESDIR</code> являются
	  <code class="varname">PORTDATA</code> и
	  <code class="varname">PORTEXAMPLES</code> соответственно.</p><p xmlns="http://www.w3.org/1999/xhtml">Во время установки выводится содержимое
	  <code class="filename">pkg-message</code>.  За подробной информацией
	  обратитесь к <a class="link" href="#porting-message" title="8.1. pkg-message">разделу об
	  использовании <code class="filename">pkg-message</code></a>.
	  Файл <code class="filename">pkg-message</code> не нужно добавлять в
	  <code class="filename">pkg-plist</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="install-subdirs"></a>5.15.5. Подкаталоги внутри PREFIX</h3></div></div></div><p>Попробуйте поместить все файлы порта в правильных
	подкаталогах каталога <code class="varname">PREFIX</code>.  Некоторые
	порты игнорируют все установки и помещают все в подкаталог с
	именем порта, что неправильно.  Также многие порты помещают
	все, кроме бинарных файлов, файлов заголовков и страниц
	Справочника, в подкаталог каталога <code class="filename">lib</code>,
	что не очень хорошо работает с подходом BSD.  Многие файлы
	должны быть перемещены в одно из следующих местоположений:
	<code class="filename">etc</code>
	(настроечные/конфигурационные файлы),
	<code class="filename">libexec</code> (выполнимые файлы, запускаемые
	из других программ), <code class="filename">sbin</code> (исполнимые
	файлы для администраторов/менеджеров системы),
	<code class="filename">info</code> (документация в формате info для
	просмотрщика info) или <code class="filename">share</code>
	(независимые от архитектуры файлы).  Обратитесь к
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hier&amp;sektion=7"><span class="citerefentry"><span class="refentrytitle">hier</span>(7)</span></a> для прояснения деталей; правила, покрывающие
	<code class="filename">/usr</code>, достаточно хорошо подходят также и
	к <code class="filename">/usr/local</code>.  Исключением являются
	порты, имеющие дело с <span class="quote"><<<span class="quote">новостями</span>>></span> USENET.  Они
	могут использовать каталог <code class="filename">PREFIX/news</code>
	для установки своих файлов.</p></div></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="special"></a>Глава 6. Особые соглашения</h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#staging">6.1. Staging</a></span></dt><dt><span class="sect1"><a href="#porting-shlibs">6.2. Динамические библиотеки</a></span></dt><dt><span class="sect1"><a href="#porting-restrictions">6.3. Порты с ограничениями на распространение или с правовым
      обременением</a></span></dt><dt><span class="sect1"><a href="#building">6.4. Механизмы построения</a></span></dt><dt><span class="sect1"><a href="#using-autotools">6.5. Использование GNU Autotools</a></span></dt><dt><span class="sect1"><a href="#using-gettext">6.6. Использование GNU <code class="literal">gettext</code></a></span></dt><dt><span class="sect1"><a href="#using-perl">6.7. Использование <span class="application">Perl</span></a></span></dt><dt><span class="sect1"><a href="#using-x11">6.8. Использование X11</a></span></dt><dt><span class="sect1"><a href="#using-gnome">6.9. Использование GNOME</a></span></dt><dt><span class="sect1"><a href="#using-qt">6.10. Использование Qt</a></span></dt><dt><span class="sect1"><a href="#using-kde">6.11. Использование KDE</a></span></dt><dt><span class="sect1"><a href="#using-java">6.12. Использование Java</a></span></dt><dt><span class="sect1"><a href="#using-php">6.13. Веб-приложения, Apache и PHP</a></span></dt><dt><span class="sect1"><a href="#using-python">6.14. Использование Python</a></span></dt><dt><span class="sect1"><a href="#using-tcl">6.15. Использование <span class="application">Tcl/Tk</span></a></span></dt><dt><span class="sect1"><a href="#using-emacs">6.16. Использование Emacs</a></span></dt><dt><span class="sect1"><a href="#using-ruby">6.17. Использование Ruby</a></span></dt><dt><span class="sect1"><a href="#using-sdl">6.18. Использование SDL</a></span></dt><dt><span class="sect1"><a href="#using-wx">6.19. Использование <span class="application">wxWidgets</span></a></span></dt><dt><span class="sect1"><a href="#using-lua">6.20. Использование <span class="application">Lua</span></a></span></dt><dt><span class="sect1"><a href="#using-iconv">6.21. Использование <code class="command">iconv</code></a></span></dt><dt><span class="sect1"><a href="#using-xfce">6.22. Использование Xfce</a></span></dt><dt><span class="sect1"><a href="#using-mozilla">6.23. Использование Mozilla</a></span></dt><dt><span class="sect1"><a href="#using-databases">6.24. Использование баз данных</a></span></dt><dt><span class="sect1"><a href="#rc-scripts">6.25. Запуск и остановка служб (сценарии
      <code class="literal">rc</code>)</a></span></dt><dt><span class="sect1"><a href="#users-and-groups">6.26. Добавление пользователей и групп</a></span></dt><dt><span class="sect1"><a href="#requiring-kernel-sources">6.27. Порты, требующие наличия исходных текстов ядра</a></span></dt></dl></div><p>Имеется ещё несколько вещей, которые вы должны иметь в виду
    при создании порта.  Этот раздел описывает наиболее часто
    встречающиеся из них.</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="staging"></a>6.1. Staging</h2></div></div></div><p><code class="filename">bsd.port.mk</code> ожидает от портов работу с
      <span class="quote"><<<span class="quote">каталогом сборки</span>>></span>.  Это означает, что порт должен
      устанавливать файлы не напрямую в назначенные каталоги (то
      есть, например, под <code class="varname">PREFIX</code>), а в отдельный
      каталог, из которого затем собирается пакет.  Во многих случаях
      привилегии root для этого не требуются, что делает возможным
      сборку пакетов из-под непривилегированного пользователя.  В
      режиме staging порт собирается и устанавливается в каталог
      сборки <code class="varname">STAGEDIR</code>.  Пакет создается из
      каталога сборки и затем устанавливается в систему.  В
      инструментарии automake такая концепция именуется
      <code class="varname">DESTDIR</code>; в прочем, в FreeBSD
      <code class="varname">DESTDIR</code> имеет собственное значение (смотрите
      <a class="xref" href="#porting-prefix" title="9.4. PREFIX и DESTDIR">Раздел 9.4, <<<code class="varname">PREFIX</code> и
      <code class="varname">DESTDIR</code>>></a>).</p><p>Если для порта всё ещё требуются системные привилегии при
      выполнении цели <code class="buildtarget">package</code>, то в
      <code class="filename">Makefile</code> должна быть добавлена следующая
      строка:</p><pre class="programlisting">NEED_ROOT=	yes</pre><p>Метапорты, то есть порты, которые не устанавливают файлы
      непосредственно, а только зависят от других портов, должны по
      возможности избегать распаковки <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mtree&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mtree</span>(8)</span></a> в каталог сборки.
      Это основная иерархия каталогов пакета, и эти пустые каталоги
      будут выглядеть лишними.  Для предотвращения распаковки
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mtree&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mtree</span>(8)</span></a> добавьте эту строку:</p><pre class="programlisting">NO_MTREE=	yes</pre><p>Staging задействуется посредством добавления переменной
      <code class="varname">STAGEDIR</code> слева от путей, которые
      используются в целях <code class="buildtarget">pre-install</code>,
      <code class="buildtarget">do-install</code> и
      <code class="buildtarget">post-install</code> (смотрите примеры в
      книге).  Обычно сюда относятся <code class="varname">PREFIX</code>,
      <code class="varname">ETCDIR</code>, <code class="varname">DATADIR</code>,
      <code class="varname">EXAMPLESDIR</code>, <code class="varname">MANPREFIX</code>,
      <code class="varname">DOCSDIR</code> и так далее.  Каталоги должны
      создаваться при выполнении цели
      <code class="buildtarget">post-install</code>.  Избегайте
      использования абсолютных путей, когда это возможно.</p><p>При создании символический ссылки
      <code class="varname">STAGEDIR</code> должен ставиться только для пути
      назначения.  Например:</p><pre class="programlisting">${LN} -sf libfoo.so.42 ${STAGEDIR}${PREFIX}/lib/libfoo.so</pre><p>Первоначальный путь
      <code class="filename">${PREFIX}/lib/libfoo.so.42</code> выглядит
      нормально, но по факту может быть неправильным.  Абсолютные
      пути могут указывать на неподходящее место, например, когда
      удалённая файловая система смонтирована по
      <acronym class="acronym">NFS</acronym> как непривилегированная точка
      монтирования.  Относительные пути реже подвержены проблемам и
      часто намного короче.</p><p>Порты, устанавливающие модули ядра, должны предварять путь
      установки (по умолчанию <code class="filename">/boot/modules</code>)
      переменной <code class="varname">STAGEDIR</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-shlibs"></a>6.2. Динамические библиотеки</h2></div></div></div><p>Если ваш порт устанавливает одну или несколько динамических
      библиотек, определите переменную
      <code class="varname">USE_LDCONFIG</code>, которая приведёт к запуску из
      <code class="filename">bsd.port.mk</code> команды
      <code class="literal">${LDCONFIG} -m</code> относительно каталога,
      в который устанавливается новая библиотека (как правило, это
      <code class="filename">PREFIX/lib</code>), во время выполнения цели
      <code class="buildtarget">post-install</code> для её регистрации в
      кэше динамических библиотек.  Эта переменная, если она
      определена, также приведёт к добавлению соответствующей пары
      команд <code class="literal">@exec /sbin/ldconfig -m</code> и
      <code class="literal">@unexec /sbin/ldconfig -R</code> в ваш файл
      <code class="filename">pkg-plist</code>, так что пользователь,
      устанавливающий пакет, сможет сразу же использовать
      динамическую библиотеку, а удаление пакета не приведёт к тому,
      что система будет предполагать, что библиотека всё ещё имеется
      в наличии.</p><pre class="programlisting">USE_LDCONFIG=	yes</pre><p>Если нужно, вы можете переопределить каталог по умолчанию,
      задав значение <code class="varname">USE_LDCONFIG</code>, в котором
      должны быть перечислены каталоги, в которые устанавливаются
      динамические библиотеки.  Например, если ваш порт устанавливает
      динамические библиотеки в каталоги
      <code class="filename">PREFIX/lib/foo</code> и
      <code class="filename">PREFIX/lib/bar</code>, то вы можете в файле
      <code class="filename">Makefile</code> указать следующее:</p><pre class="programlisting">USE_LDCONFIG=	${PREFIX}/lib/foo ${PREFIX}/lib/bar</pre><p>Будьте добры перепроверить, т.к. часто это вовсе не
      является необходимым и может быть решено иначе с помощью
      <code class="literal">-rpath</code> или установки
      <code class="envar">LD_RUN_PATH</code> во время компоновки (для примера
      смотрите <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/moscow_ml/pkg-descr">lang/moscow_ml</a>), или с
      помощью сценария-обёртки, который выставляет
      <code class="varname">LD_LIBRARY_PATH</code> перед запуском исполняемого
      файла как это делает <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/seamonkey/pkg-descr">www/seamonkey</a>.</p><p>При установке 32-разрядных библиотек на 64-разрядной
      системе используйте вместо этого
      <code class="varname">USE_LDCONFIG32</code>.</p><p>Постарайтесь сохранять номера версий динамических библиотек
      в формате <code class="filename">libfoo.so.0</code>.  Наш компоновщик
      позаботится только о старшем (первом) номере.</p><p>Если при обновлении порта увеличивается старший номер
      версии библиотеки, то для всех портов, компонуемых с затронутой
      библиотекой, следует увеличить значение
      <code class="varname">PORTREVISION</code> для форсирования перекомпиляции
      с новой версией библиотеки.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-restrictions"></a>6.3. Порты с ограничениями на распространение или с правовым
      обременением</h2></div></div></div><p>Лицензии бывают разных видов, и некоторые накладывают
      ограничение на то, как приложение может быть оформлено в виде
      пакета, может ли оно продаваться для извлечения коммерческой
      выгоды, и так далее.</p><div xmlns="" class="important"><h3 class="admontitle">Важно: </h3><p xmlns="http://www.w3.org/1999/xhtml">На вас, как на человека, портирующего приложение, ложится
	обязанность прочесть лицензионные соглашения на программное
	обеспечение и удостовериться, что проект FreeBSD не будет
	являться их нарушителем, если будет заниматься
	распространением исходного кода или в бинарном виде по
	FTP/HTTP или на CD-ROM.  Если у вас возникли сомнения, то,
	пожалуйста, обратитесь в <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">Список рассылки, посвящённый Портам FreeBSD</a>.</p></div><p>В подобных ситуациях можно использовать переменные,
      описываемые в последующих разделах.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75350736"></a>6.3.1. <code class="varname">NO_PACKAGE</code></h3></div></div></div><p>Эта переменная указывает, что мы не можем создавать для
	приложения двоичный пакет.  К примеру, лицензия не позволяет
	бинарное распространение или она может запрещать
	распространение пакетов, созданных из изменённых
	исходников.</p><p>Однако файлы <code class="varname">DISTFILES</code> могут свободно
	зеркалироваться по FTP/HTTP.  Они также могут
	распространяться, используя CD-ROM (или на похожих
	носителях), если не установлена переменная
	<code class="varname">NO_CDROM</code>.</p><p><code class="varname">NO_PACKAGE</code> должна также
	использоваться, если двоичный пакет, как правило, бесполезен,
	а приложение должно всегда компилироваться из исходного кода.
	К примеру, если в приложение во время компиляции жёстко
	включается конфигурационная информация, привязанная к
	конкретной системе, то задайте переменную
	<code class="varname">NO_PACKAGE</code>.</p><p>Значением переменной <code class="varname">NO_PACKAGE</code> должна
	быть строка, описывающая причину, по которой пакет не должен
	создаваться.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75354960"></a>6.3.2. <code class="varname">NO_CDROM</code></h3></div></div></div><p>Эта переменная указывает на то, что, хотя мы имеем право
	создавать бинарные пакеты, мы не можем помещать эти пакеты
	или файлы <code class="varname">DISTFILES</code> порта на CD-ROM (или
	на похожие носители) для перепродажи.  Однако бинарные пакеты
	и файлы <code class="varname">DISTFILES</code> порта будут оставаться
	доступными посредством FTP/HTTP.</p><p>Если эта переменная устанавливается вместе с
	<code class="varname">NO_PACKAGE</code>, то только файлы порта
	<code class="varname">DISTFILES</code> будут доступны, и только
	посредством FTP/HTTP.</p><p>В качестве значения <code class="varname">NO_CDROM</code> должна
	указываться строка, описывающая причины, по которым порт не
	может распространяться на CD-ROM.  К примеру, это
	применяется, если лицензионное соглашение приложения
	предполагает только его <span class="quote"><<<span class="quote">некоммерческое</span>>></span>
	использование.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75367632"></a>6.3.3. <code class="varname">NOFETCHFILES</code></h3></div></div></div><p>Файлы, определенные в переменной
	<code class="varname">NOFETCHFILES</code>, не будут извлекаться ни из
	одного из <code class="varname">MASTER_SITES</code>.  Примером такого
	файла является файл, поставляемый на CD-ROM.</p><p>Инструменты, проверяющие доступность этих файлов на
	<code class="varname">MASTER_SITES</code>, должны игнорировать эти
	файлы и не сообщать о них.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75370448"></a>6.3.4. <code class="varname">RESTRICTED</code></h3></div></div></div><p>Задайте эту переменную, если лицензия на приложение не
	позволяет ни зеркалировать файлы
	<code class="varname">DISTFILES</code>, ни распространять бинарный
	пакет через FTP/HTTP или на CD-ROM.</p><p>Ни <code class="varname">NO_CDROM</code>, ни
	<code class="varname">NO_PACKAGE</code> не стоит устанавливать вместе с
	<code class="varname">RESTRICTED</code>, так как последняя переменная
	подразумевает первые две.</p><p>В качестве значения <code class="varname">RESTRICTED</code> должна
	указываться строка, описывающая причины, по которым порт
	нельзя распространять.  Обычно это означает, что порт
	использует закрытое программное обеспечение, а пользователь
	должен вручную сгрузить файлы <code class="varname">DISTFILES</code>,
	возможно, после заполнения регистрационной формы или
	подтверждения соглашения с условиями
	<acronym class="acronym">EULA</acronym>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75375440"></a>6.3.5. <code class="varname">RESTRICTED_FILES</code></h3></div></div></div><p>Если заданы <code class="varname">RESTRICTED</code> или
	<code class="varname">NO_CDROM</code>, то значение этой переменной по
	умолчанию соответствует <code class="literal">${DISTFILES}
	  ${PATCHFILES}</code>, в противном случае она пуста.
	Если ограничены в распространении лишь некоторые из
	дистрибутивных файлов, то в этой переменной задаётся их
	список.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75377872"></a>6.3.6. <code class="varname">LEGAL_TEXT</code></h3></div></div></div><p>Если порт имеет правовое обременение, которое не
	покрывается перечисленными выше переменными, то переменной
	<code class="varname">LEGAL_TEXT</code> следует присвоить строку с
	описанием данного обременения.  Например, если было получено
	особое разрешение для FreeBSD на распространение двоичного
	файла, то эта переменная должна содержать соответствующее
	указание.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75379536"></a>6.3.7. <code class="filename">/usr/ports/LEGAL</code> и
	<code class="varname">LEGAL</code></h3></div></div></div><p>Порт, содержащий любую из перечисленных выше переменных,
	также должен быть добавлен в
	<code class="filename">/usr/ports/LEGAL</code>.  Первый столбец
	содержит шаблон совпадения с дистрибутивными файлами,
	имеющими ограничения на распространение.  Второй столбец
	содержит корень порта.  Третий столбец содержит вывод
	<code class="command">make -VLEGAL</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75381968"></a>6.3.8. Примеры использования</h3></div></div></div><p>Предпочтительным способом реализации утверждения "архивы
	исходных текстов для этого порта должны загружаться
	самостоятельно" является следующее:</p><pre class="programlisting">.if !exists(${DISTDIR}/${DISTNAME}${EXTRACT_SUFX})
IGNORE=	may not be redistributed because of licensing reasons. Please visit <em class="replaceable"><code>some-website</code></em> to accept their license and download ${DISTFILES} into ${DISTDIR}
.endif</pre><p>Это одновременно и информирует пользователя, и
	устанавливает нужные метаданные на пользовательской машине
	для использования автоматическими программами.</p><p>Обратите внимание, что данная кляуза должна
	предшествовать подключению файла
	<code class="filename">bsd.port.pre.mk</code>.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="building"></a>6.4. Механизмы построения</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="parallel-builds"></a>6.4.1. Параллельное построение портов</h3></div></div></div><p>Инфраструктура портов FreeBSD поддерживает параллельное
	построение с использованием множественных подпроцессов
	<code class="command">make</code>, что позволяет системам
	<acronym class="acronym">SMP</acronym> задействовать всю доступную мощность
	<acronym class="acronym">CPU</acronym>, тем самым делая построение портов
	более быстрым и эффективным.</p><p>Это достигается путём передачи флага
	<code class="varname">-jX</code> команде <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a>.  Такое
	построение портов является поведением по умолчанию.  К
	сожалению, не все порты поддерживают параллельную сборку
	достаточно хорошо, и поэтому может потребоваться выключить
	этот механизм явным образом путём добавления переменной
	<code class="literal">MAKE_JOBS_UNSAFE=yes</code>.  Эта переменная
	используется в случае, когда известно, что порт ломается с
	<code class="varname">-jX</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-make"></a>6.4.2. <code class="command">make</code>, <code class="command">gmake</code> и
	<code class="command">imake</code></h3></div></div></div><p>Если ваш порт использует
	<span class="application">GNU make</span>, то установите
	<code class="literal">USES= gmake</code>.</p><div class="table"><a id="idp75397968"></a><div class="table-title">Таблица 6.1. Переменные для портов, использующих
	  <span class="application">gmake</span></div><div class="table-contents"><table summary="Переменные для портов, использующих&#10;&#9;  gmake" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">USES= gmake</code></td><td>Для сборки порта требуется
		<code class="command">gmake</code>.</td></tr><tr><td><code class="varname">GMAKE</code></td><td>Полный путь к команде <code class="command">gmake</code>,
		если отсутствует в <code class="envar">PATH</code>.</td></tr></tbody></table></div></div><br class="table-break" /><p>Если ваш порт является приложением X, которое создает
	файлы <code class="filename">Makefile</code> из
	<code class="filename">Imakefile</code>, используя
	<span class="application">imake</span>, то установите
	<code class="literal">USES= imake</code>.  Это заставит стадию
	конфигурирования автоматически выполнить
	<code class="command">xmkmf -a</code>.  Если флаг <code class="option">-a</code>
	представляет для вашего порта проблему, то установите
	<code class="literal">XMKMF=xmkmf</code>.  Если порт использует
	<span class="application">imake</span>, но не понимает цель
	<code class="buildtarget">install.man</code>, то следует установить
	<code class="literal">NO_INSTALL_MANPAGES=yes</code>.</p><p>Если исходный <code class="filename">Makefile</code> вашего порта
	имеет что-нибудь помимо <code class="buildtarget">all</code> в
	качестве основной цели построения, то задайте соответствующее
	значение <code class="varname">ALL_TARGET</code>.  То же касается
	<code class="buildtarget">install</code> и
	<code class="varname">INSTALL_TARGET</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-configure"></a>6.4.3. Сценарий <code class="command">configure</code></h3></div></div></div><p>Если ваш порт использует сценарий
	<code class="command">configure</code> для получения файлов
	<code class="filename">Makefile</code> из файлов
	<code class="filename">Makefile.in</code>, то установите
	<code class="literal">GNU_CONFIGURE=yes</code>.  Если вы хотите дать
	дополнительные параметры сценарию
	<code class="command">configure</code> (аргументом по умолчанию
	является <code class="literal">--prefix=${PREFIX}
	  --infodir=${PREFIX}/${INFO_PATH}
	  --mandir=${MANPREFIX}/man
	  --build=${CONFIGURE_TARGET}</code>), установите
	эти параметры в <code class="varname">CONFIGURE_ARGS</code>.
	Дополнительные переменные окружения можно передать, используя
	переменную <code class="varname">CONFIGURE_ENV</code>.</p><div class="table"><a id="idp75416784"></a><div class="table-title">Таблица 6.2. Переменные для портов, использующих
	  <code class="command">configure</code></div><div class="table-contents"><table summary="Переменные для портов, использующих&#10;&#9;  configure" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">GNU_CONFIGURE</code></td><td>Порт использует сценарий
		<code class="command">configure</code> для подготовки
		построения.</td></tr><tr><td><code class="varname">HAS_CONFIGURE</code></td><td>То же, что и <code class="varname">GNU_CONFIGURE</code>,
		кроме того, что цель configure по умолчанию не
		добавляется в
		<code class="varname">CONFIGURE_ARGS</code>.</td></tr><tr><td><code class="varname">CONFIGURE_ARGS</code></td><td>Дополнительные параметры, передаваемые сценарию
		<code class="command">configure</code>.</td></tr><tr><td><code class="varname">CONFIGURE_ENV</code></td><td>Дополнительные переменные окружения, задаваемые
		для запуска сценария
		<code class="command">configure</code>.</td></tr><tr><td><code class="varname">CONFIGURE_TARGET</code></td><td>Переопределить цель configure по умолчанию.
		Значением по умолчанию является
		<code class="literal">${MACHINE_ARCH}-portbld-freebsd${OSREL}</code>.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-cmake"></a>6.4.4. Использование <code class="command">cmake</code></h3></div></div></div><p>Если порт использует <span class="application">CMake</span>,
	определите <code class="literal">USES= cmake</code> или
	<code class="literal">USES= cmake:outsource</code> для построения во
	внешнем каталоге (см. ниже).</p><div class="table"><a id="idp75440208"></a><div class="table-title">Таблица 6.3. Переменные для портов, использующих
	  <code class="command">cmake</code></div><div class="table-contents"><table summary="Переменные для портов, использующих&#10;&#9;  cmake" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">CMAKE_ARGS</code></td><td>Специфичные для порта флаги
		<span class="application">CMake</span>, передаваемые
		<code class="command">cmake</code>.</td></tr><tr><td><code class="varname">CMAKE_BUILD_TYPE</code></td><td>Тип построения (предопределённые профили
		построения <span class="application">CMake</span>).  По
		умолчанию <code class="literal">Release</code>,
		<code class="literal">Debug</code> при использовании
		<code class="varname">WITH_DEBUG</code>.</td></tr><tr><td><code class="varname">CMAKE_ENV</code></td><td>Переменные окружения для передачи
		<code class="command">cmake</code>.  По умолчанию
		<code class="literal">${CONFIGURE_ENV}</code>.</td></tr><tr><td><code class="varname">CMAKE_SOURCE_PATH</code></td><td>Путь к каталогу с исходным кодом.  По умолчанию
		<code class="literal">${WRKSRC}</code>.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idp75452496"></a><div class="table-title">Таблица 6.4. Переменные построения <code class="command">cmake</code>,
	  устанавливаемые пользователем</div><div class="table-contents"><table summary="Переменные построения cmake,&#10;&#9;  устанавливаемые пользователем" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">CMAKE_VERBOSE</code></td><td>Разрешает подробный вывод сообщений при
		построении.  Значение по умолчанию не задано, если не
		заданы <code class="varname">BATCH</code> или
		<code class="varname">PACKAGE_BUILDING</code>.</td></tr><tr><td><code class="varname">CMAKE_NOCOLOR</code></td><td>Запрещает цветной вывод сообщений при
		построении.  Значение по умолчанию не задано, если не
		заданы <code class="varname">BATCH</code> или
		<code class="varname">PACKAGE_BUILDING</code>.</td></tr></tbody></table></div></div><br class="table-break" /><p><span class="application">CMake</span> поддерживает следующие
	профили построения: <code class="literal">Debug</code>,
	<code class="literal">Release</code>, <code class="literal">RelWithDebInfo</code>
	и <code class="literal">MinSizeRel</code>.  Профили
	<code class="literal">Debug</code> и <code class="literal">Release</code>
	учитывают системные флаги <code class="literal">*FLAGS</code>;
	<code class="literal">RelWithDebInfo</code> и
	<code class="literal">MinSizeRel</code> соответственно определяют
	<code class="varname">CFLAGS</code> со значением
	<code class="literal">-O2 -g</code> и <code class="literal">-Os -DNDEBUG</code>.
	Значение <code class="varname">CMAKE_BUILD_TYPE</code> экспортируется в
	нижнем регистре в <code class="varname">PLIST_SUB</code> и должно
	использоваться, если порт устанавливает файлы
	<code class="literal">*.cmake</code> в зависимости от типа построения
	(для примера посмотрите на
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/deskutils/strigi/pkg-descr">deskutils/strigi</a>).  Следует
	учитывать, что некоторые проекты могут определять собственные
	профили построения и/или форсировать конкретный тип
	построения через установку
	<code class="literal">CMAKE_BUILD_TYPE</code> в файлах
	<code class="filename">CMakeLists.txt </code> .  Для того чтобы порт
	для такого проекта учитывал <code class="varname">CFLAGS</code> и
	<code class="varname">WITH_DEBUG</code>, из этих файлов должны быть
	удалены значения <code class="literal">CMAKE_BUILD_TYPE</code>.</p><p>Большинство проектов, основанных на
	<span class="application">CMake</span>, поддерживают метод внешнего
	(out-of-source) построения.  Для порта внешнее построение
	можно запросить с использованием суффикса
	<code class="literal">:outsource</code>.  В этом случае
	<code class="varname">CONFIGURE_WRKSRC</code>,
	<code class="varname">BUILD_WRKSRC</code> и
	<code class="varname">INSTALL_WRKSRC</code> будут иметь значение
	<code class="literal">${WRKDIR}/.build</code> для каталога,
	содержащего файлы, получаемые на этапах конфигурации и
	построения; при этом каталог с исходным кодом будет
	оставаться без изменений.</p><div class="example"><a id="using-cmake-example"></a><div class="example-title">Пример 6.1. Пример для <code class="literal">USES= cmake</code></div><div class="example-contents"><p>Следующий отрывок демонстрирует использование
	  <span class="application">CMake</span> для порта.
	  <code class="varname">CMAKE_SOURCE_PATH</code> обычно не требуется,
	  но может быть установлен, когда исходный код не находится
	  в верхнем каталоге или если порт используется для
	  построения части проекта.</p><pre class="programlisting">USES=			cmake:outsource
CMAKE_SOURCE_PATH=	${WRKSRC}/subproject</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-scons"></a>6.4.5. Использование <code class="command">scons</code></h3></div></div></div><p>Если ваш порт использует
	<span class="application">SCons</span>, определите
	<code class="literal">USE_SCONS=yes</code>.</p><div class="table"><a id="idp75489616"></a><div class="table-title">Таблица 6.5. Переменные для портов, использующих
	  <code class="command">scons</code></div><div class="table-contents"><table summary="Переменные для портов, использующих&#10;&#9;  scons" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">SCONS_ARGS</code></td><td>Специфичные для порта флаги SCons, передаваемые
		окружению SCons.</td></tr><tr><td><code class="varname">SCONS_BUILDENV</code></td><td>Переменные для установки в системном
		окружении.</td></tr><tr><td><code class="varname">SCONS_ENV</code></td><td>Переменные для установки в окружении
		SCons.</td></tr><tr><td><code class="varname">SCONS_TARGET</code></td><td>Последний параметр для передачи SCons, похожий
		на <code class="varname">MAKE_TARGET</code>.</td></tr></tbody></table></div></div><br class="table-break" /><p>Для того, чтобы сторонний <code class="filename">SConstruct</code>
	соответствовал всему, что передается SCons в переменной
	<code class="varname">SCONS_ENV</code> (самое главное, это
	<code class="varname">CC/CXX/CFLAGS/CXXFLAGS</code>), примените патч к
	<code class="filename">SConstruct</code>, так чтобы переменная
	построения <code class="literal">Environment</code> выглядела следующим
	образом:</p><pre class="programlisting">env = Environment(**ARGUMENTS)</pre><p>В дальнейшем ее можно изменить при помощи
	<code class="literal">env.Append</code> и
	<code class="literal">env.Replace</code>.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-autotools"></a>6.5. Использование GNU Autotools</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-autotools-introduction"></a>6.5.1. Введение</h3></div></div></div><p>Различные инструменты GNU autotools предоставляют
	механизм абстракции для построения частей программного
	обеспечения на широком наборе операционных систем и
	аппаратных архитектур.  Внутри Коллекции Портов отдельный
	порт может использовать эти инструменты при помощи простых
	конструкций:</p><pre class="programlisting">USE_AUTOTOOLS=	<em class="replaceable"><code>tool</code></em>:<em class="replaceable"><code>version</code></em>[:<em class="replaceable"><code>operation</code></em>] ...</pre><p>К моменту написания <em class="replaceable"><code>tool</code></em>
	может быть одним из <code class="literal">libtool</code>,
	<code class="literal">libltdl</code>, <code class="literal">autoconf</code>,
	<code class="literal">autoheader</code>, <code class="literal">automake</code>
	или <code class="literal">aclocal</code>.</p><p><em class="replaceable"><code>version</code></em> указывает конкретную
	версию используемого инструмента (смотрите
	<code class="literal">devel/{automake,autoconf,libtool}[0-9]+</code>
	для получения действительных версий).</p><p><em class="replaceable"><code>operation</code></em> является
	необязательным расширением и указывает на способ
	использования инструмента.</p><p>Одновременно может быть указано несколько инструментов,
	добавляя их все на одной строке или используя конструкцию
	Makefile <code class="literal">+=</code>.</p><p>В заключение, существует специальный инструмент по
	называнию <code class="literal">autotools</code>, который является
	удобной функцией при установке всех доступных версий
	autotools для возможности проведения кросс-разработки.  Это
	также может быть достигнуто путем установки порта
	<code class="literal">devel/autotools</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-libtool"></a>6.5.2. <code class="command">libtool</code></h3></div></div></div><p>Динамические библиотеки, использующие инфраструктуру
	построения GNU, обычно используют
	<span class="application">libtool</span> для настройки компиляции и
	установки динамических библиотек в соответствии с
	особенностями данной операционной системы.  В типичной
	практике используется копирование встроенного в приложение
	<code class="command">libtool</code>.  Если вам нужно использовать
	внешнюю команду <code class="command">libtool</code>, то вы можете
	использовать версию, поставляемую Коллекцией Портов:</p><pre class="programlisting">USE_AUTOTOOLS=	libtool:<em class="replaceable"><code>version</code></em>[:env]</pre><p>При отсутствии дополнительных операций,
	<code class="literal">libtool:version</code> сообщает инфраструктуре
	построения о применении патча к сценарию configure с
	установленной в системе копией <code class="command">libtool</code>.
	Означает использование <code class="varname">GNU_CONFIGURE</code>.
	Более того, некоторые переменные make и оболочки shell будут
	назначены для дальнейшего использования этим портом.
	Подробности смотрите в
	<code class="filename">bsd.autotools.mk</code>.</p><p>При использовании операции <code class="literal">:env</code> будет
	настроено только окружение.</p><p>Наконец, <code class="varname">LIBTOOLFLAGS</code> и
	<code class="varname">LIBTOOLFILES</code> можно установить по желанию,
	чтобы переопределить наиболее вероятные аргументы для
	<code class="command">libtool</code> и файлы, предназначенные для
	изменения.  Большинству портов это скорее всего не
	понадобится.  Для дальнейших подробностей смотрите
	<code class="filename">bsd.autotools.mk</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-libltdl"></a>6.5.3. <code class="command">libltdl</code></h3></div></div></div><p>Некоторые порты задействуют пакет с библиотекой
	<code class="command">libltdl</code>, которая является частью комплекта
	<code class="command">libtool</code>.  Использование этой библиотеки не
	вызывает автоматическое использование самой
	<code class="command">libtool</code>, и, таким образом, обеспечивается
	отдельная конструкция.</p><pre class="programlisting">USE_AUTOTOOLS=	libltdl:<em class="replaceable"><code>version</code></em></pre><p>Всё, что в настоящее время она делает, это добавление
	<code class="varname">LIB_DEPENDS</code> для подходящего порта
	<code class="command">libltdl</code>, потому она предоставляется как
	удобная функция для помощи в устранении всяких зависимостей
	от портов autotools вне инфраструктуры
	<code class="varname">USE_AUTOTOOLS</code>.  Для этого инструмента не
	существует необязательных операций.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-autoconf"></a>6.5.4. <code class="command">autoconf</code> и
	<code class="command">autoheader</code></h3></div></div></div><p>Вместо сценария configure некоторые порты содержат шаблон
	autoconf в файле <code class="filename">configure.ac</code>.  Вы
	можете использовать следующие присвоения, чтобы позволить
	<code class="command">autoconf</code> создать сценарий configure, а
	<code class="command">autoheader</code> создать заголовки шаблона для
	использования в сценарии configure.</p><pre class="programlisting">USE_AUTOTOOLS=	autoconf:<em class="replaceable"><code>version</code></em>[:env]</pre><p>и</p><pre class="programlisting">USE_AUTOTOOLS=	autoheader:<em class="replaceable"><code>version</code></em></pre><p>которые также подразумевают использование
	<code class="literal">autoconf:version</code>.</p><p>Аналогично команде <code class="command">libtool</code> включение
	необязательной операции <code class="literal">:env</code> всего лишь
	настраивает окружение для дальнейшего использования.  Без
	этого выполняется наложение патчей и переконфигурирование
	порта.</p><p>Дополнительные необязательные переменные
	<code class="varname">AUTOCONF_ARGS</code> и
	<code class="varname">AUTOHEADER_ARGS</code> можно переопределить в
	<code class="filename">Makefile</code> порта, если указано явным
	образом.  Как и с эквивалентами <code class="command">libtool</code>,
	большинству портов это вряд ли понадобится.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-automake"></a>6.5.5. <code class="command">automake</code> и
	<code class="command">aclocal</code></h3></div></div></div><p>Некоторые пакеты содержат только файлы
	<code class="filename">Makefile.am</code>.  Они должны быть
	преобразованы в файлы <code class="filename">Makefile.in</code> с
	использованием <span class="application">automake</span> и
	дальнейшей обработкой <code class="command">configure</code> для
	получения настоящего <code class="filename">Makefile</code>.</p><p>Аналогично, иногда пакеты не поставляются с вложенными
	файлами <code class="filename">aclocal.m4</code>, снова требуемых для
	построения программного обеспечения.  Их можно получить
	командой <code class="command">aclocal</code>, которая просматривает
	<code class="filename">configure.ac</code> или
	<code class="filename">configure.in</code>.</p><p><code class="command">aclocal</code> имеет похожую связь с
	<code class="command">automake</code>, как у
	<code class="command">autoheader</code> с <code class="command">autoconf</code>,
	что описано в предыдущей главе.  <code class="command">aclocal</code>
	подразумевает использование <code class="command">automake</code>,
	таким образом, мы имеем:</p><pre class="programlisting">USE_AUTOTOOLS=	automake:<em class="replaceable"><code>version</code></em>[:<em class="replaceable"><code>env</code></em>]</pre><p>и</p><pre class="programlisting">USE_AUTOTOOLS=	aclocal:<em class="replaceable"><code>version</code></em></pre><p>которые также подразумевают использование
	<code class="literal">automake:version</code>.</p><p>Также как и для <code class="command">libtool</code> и
	<code class="command">autoconf</code>, подключение необязательной
	операции <code class="literal">:env</code> всего лишь устанавливает
	окружение для дальнейшего пользования.  Без этого выполняется
	реконфигурирование этого порта.</p><p>Как и в случае с <code class="command">autoconf</code> и
	<code class="command">autoheader</code>, обе команды
	<code class="command">automake</code> и <code class="command">aclocal</code>
	соответственно имеют необязательные переменные
	<code class="varname">AUTOMAKE_ARGS</code> и
	<code class="varname">ACLOCAL_ARGS</code>, которые при необходимости
	можно переопределить в <code class="filename">Makefile</code>
	порта.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-gettext"></a>6.6. Использование GNU <code class="literal">gettext</code></h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75577552"></a>6.6.1. Простой вариант использования</h3></div></div></div><p>Если для вашего порта требуется
	<code class="literal">gettext</code>, добавьте
	<code class="literal">USES= gettext</code>, и ваш порт унаследует
	зависимость от <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/gettext/pkg-descr">devel/gettext</a>.
	<a class="xref" href="#uses-values" title="15.1. Значения USES">Раздел 15.1, <<Значения <code class="varname">USES</code>>></a> содержит перечень других
	значений для использования <code class="literal">gettext</code>.</p><p>Довольно распространенным случаем является использование
	в порте <code class="literal">gettext</code> и
	<code class="command">configure</code>.  Как правило, GNU
	<code class="command">configure</code> способен находить
	<code class="literal">gettext</code> автоматически.  Если он все же не
	сможет это сделать, то подсказки для размещения
	<code class="literal">gettext</code> можно передать через переменные
	окружения <code class="envar">CPPFLAGS</code> и
	<code class="envar">LDFLAGS</code>:</p><pre class="programlisting">USES=	gettext
CPPFLAGS+=	-I${LOCALBASE}/include
LDFLAGS+=	-L${LOCALBASE}/lib

GNU_CONFIGURE=	yes</pre><p>Конечно же, этот код можно записать в более компактном
	виде, если передавать флаги в <code class="command">configure</code> не
	требуется:</p><pre class="programlisting">USES=	gettext
GNU_CONFIGURE=	yes</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75589712"></a>6.6.2. Оптимальное использование</h3></div></div></div><p>Некоторые программные продукты позволяют отключать NLS,
	к примеру, передавая параметр <code class="option">--disable-nls</code>
	сценарию <code class="command">configure</code>.  В этом случае ваш
	порт должен использовать <code class="literal">gettext</code>, в
	зависимости от значения <code class="varname">NLS</code>.  Для портов
	небольшой или средней сложности вы можете полагаться на
	следующую идиому:</p><pre class="programlisting">GNU_CONFIGURE=	yes

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MNLS}
USES+=			gettext
PLIST_SUB+=		NLS=""
.else
CONFIGURE_ARGS+=	--disable-nls
PLIST_SUB+=		NLS="@comment "
.endif

.include &lt;bsd.port.mk&gt;</pre><p>Следующий пункт в вашем списке дел разобраться, чтобы
	файлы каталога сообщения включались в список упаковки по
	условию.  Часть, входящая в <code class="filename">Makefile</code>,
	уже обеспечена этой идиомой.  Остальное объясняется в главе
	<a class="link" href="#plist-sub" title="7.1. Изменение содержимого pkg-plist в зависимости от make-переменных">продвинутые практики
	  <code class="filename">pkg-plist</code></a>.  Вкратце, каждое
	вхождение <code class="literal">%%NLS%%</code> в
	<code class="filename">pkg-plist</code> будет заменено на
	<span class="quote"><<<span class="quote"><code class="literal">@comment </code></span>>></span>, если NLS
	выключен, или пустой строкой, если включен.  В результате
	строки, предваряемые <code class="literal">%%NLS%%</code>, станут
	комментариями в итоговом листе упаковки, если NLS выключен;
	иначе, префикс будет просто удален.  Всё, что вам нужно, это
	вставить <code class="literal">%%NLS%%</code> перед каждым путем к
	файлу каталога сообщений в <code class="filename">pkg-plist</code>.
	Например:</p><pre class="programlisting">%%NLS%%share/locale/fr/LC_MESSAGES/foobar.mo
%%NLS%%share/locale/no/LC_MESSAGES/foobar.mo</pre><p>В особо сложных случаях вам понадобиться использовать
	более продвинутые техники, чем данный рецепт, такие как <a class="link" href="#plist-dynamic" title="7.4. Динамический или статический список упаковки">динамические списки
	  упаковки</a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75614544"></a>6.6.3. Управление каталогами сообщений</h3></div></div></div><p>Существует момент, который следует учитывать при
	установке файлов каталогов сообщений.  Целевые каталоги для
	размещения, расположенные под
	<code class="filename">LOCALBASE/share/locale</code>, редко когда
	должны создаваться и удаляться портом.  Для наиболее
	популярных языков имеются собственные каталоги, перечисленные
	в <code class="filename">PORTSDIR/Templates/BSD.local.dist</code>.
	Каталоги для множества других языков управляются с помощью
	порта <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/gettext/pkg-descr">devel/gettext</a>.  Обратите
	внимание на его <code class="filename">pkg-plist</code> и посмотрите,
	куда данный порт собирается установить файлы каталогов
	сообщений для единственного в своем роде языка.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-perl"></a>6.7. Использование <span class="application">Perl</span></h2></div></div></div><p>Если <code class="varname">MASTER_SITES</code> установлена в значение
      <code class="varname">MASTER_SITE_PERL_CPAN</code>, то предпочтительным
      значением <code class="varname">MASTER_SITE_SUBDIR</code> является имя
      иерархии верхнего уровня.  Например, рекомендуемым значением
      для <code class="literal">p5-Module-Name</code> является
      <code class="literal">Module</code>.  Иерархию верхнего уровня можно
      посмотреть на сайте <a class="link" href="http://cpan.org/modules/by-module/" target="_top">cpan.org</a>.
      Это поддерживает порт в рабочем состоянии при изменении модуля
      автором.</p><p>Исключением этого правила является отсутствие
      соответствующего каталога или файла с дистрибутивом в этом
      каталоге.  В качестве <code class="varname">MASTER_SITE_SUBDIR</code> в
      этом случае разрешается использовать id автора.</p><p>В качестве значения все из настраиваемых knobs ниже
      принимают <code class="literal">YES</code> или строку с версией вида
      <code class="literal">5.8.0+</code>.  <code class="literal">YES</code> означает,
      что данный порт можно использовать с любой из поддерживаемых
      версий Perl.  Если порт работает только с некоторыми версиями
      Perl, то это можно обозначить при помощи строки с версией,
      указывающей на минимальную версию (пример:
      <code class="literal">5.7.3+</code>), максимальную версию (пример:
      <code class="literal">5.8.0-</code>) или точную версию (пример:
      <code class="literal">5.8.3</code>).</p><div class="table"><a id="idp75658192"></a><div class="table-title">Таблица 6.6. Переменные для портов, использующих
	<span class="application">Perl</span></div><div class="table-contents"><table summary="Переменные для портов, использующих&#10;&#9;Perl" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">USE_PERL5</code></td><td>Perl 5 используется для построения и
	      работы.</td></tr><tr><td><code class="varname">USE_PERL5_BUILD</code></td><td>Perl 5 используется для построения.</td></tr><tr><td><code class="varname">USE_PERL5_RUN</code></td><td>Perl 5 используется во время работы.</td></tr><tr><td><code class="varname">PERL</code></td><td>Полный путь к интерпретатору Perl 5, либо в
	      системе, либо установленному из портов, но без номера
	      версии.  Используйте это, если вам нужно заменить
	      строки <span class="quote"><<<span class="quote"><code class="literal">#!</code></span>>></span> в
	      скриптах.</td></tr><tr><td><code class="varname">PERL_CONFIGURE</code></td><td>Конфигурация при помощи MakeMaker языка Perl.
	      Влечёт <code class="varname">USE_PERL5</code>.</td></tr><tr><td><code class="varname">PERL_MODBUILD</code></td><td>Конфигурация, построение и установка с
	      использованием Module::Build.  Влечёт
	      <code class="varname">PERL_CONFIGURE</code>.</td></tr></tbody></table><table summary="Переменные для портов, использующих&#10;&#9;Perl" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменные только для чтения</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">PERL_VERSION</code></td><td>Полная версия установленного Perl
	      (например, <code class="literal">5.8.9</code>).</td></tr><tr><td><code class="varname">PERL_LEVEL</code></td><td>Установленная версия Perl в форме целого числа
	      вида <code class="literal">MNNNPP</code> (например,
	      <code class="literal">500809</code>).</td></tr><tr><td><code class="varname">PERL_ARCH</code></td><td>Место, в котором Perl хранит
	      архитектурно-зависимые библиотеки.  По умолчанию это
	      <code class="literal">${ARCH}-freebsd</code>.</td></tr><tr><td><code class="varname">PERL_PORT</code></td><td>Название установленного порта Perl, (к примеру,
	      <code class="literal">perl5</code>).</td></tr><tr><td><code class="varname">SITE_PERL</code></td><td>Имя каталога, куда помещаются специфичные для
	      сайта пакеты Perl.  Это значение добавляется к
	      <code class="varname">PLIST_SUB</code>.</td></tr></tbody></table></div></div><br class="table-break" /><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Порты для модулей Perl, которые не имеют официального
	вебсайта, должны указывать <code class="systemitem">cpan.org</code>
	в строке WWW в файле <code class="filename">pkg-descr</code>.
	Предпочтительная форма URL
	<code class="literal">http://search.cpan.org/dist/Module-Name/</code>
	(включая завершающий слэш).</p></div><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Не используйте <code class="literal">${SITE_PERL}</code> в
	объявлении зависимостей.  Использование этой конструкции
	подразумевает наличие подключенного
	<code class="filename">bsd.perl.mk</code>, что не всегда так.  Порты,
	зависимые от этого порта, получат неправильные зависимости,
	если файлы этого порта будут перемещены при последующем
	обновлении.  Правильный способ объявления зависимостей для
	модулей Perl показан в примере ниже.</p></div><div class="example"><a id="use-perl-dependency-example"></a><div class="example-title">Пример 6.2. Пример зависимости Perl</div><div class="example-contents"><pre class="programlisting">p5-IO-Tee&gt;=0.64:${PORTSDIR}/devel/p5-IO-Tee</pre></div></div><br class="example-break" /><p>Для портов Perl, которые устанавливают страницы
      справочника, в <code class="filename">pkg-plist</code> можно
      использовать макрос
      <code class="varname">PERL5_MAN<em class="replaceable"><code>x</code></em></code> (где
      <em class="replaceable"><code>x</code></em> принимает значение от
      <code class="literal">1</code> до <code class="literal">9</code>).
      Например,</p><pre class="programlisting">lib/perl5/5.14/man/man3/AnyEvent::I3.3.gz</pre><p>можно заменить на</p><pre class="programlisting">%%PERL5_MAN3%%/AnyEvent::I3.3.gz</pre></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-x11"></a>6.8. Использование X11</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="x11-variables"></a>6.8.1. Компоненты X.Org</h3></div></div></div><p>X.Org является реализацией X11, доступной в Коллекции
	Портов.  Если ваше приложение зависит от компонентов X,
	установите в переменную <code class="varname">USE_XORG</code> в
	перечень требуемых компонентов.  К настоящему времени
	доступными компонентами являются:</p><p><code class="literal">bigreqsproto compositeproto damageproto dmx
	  dmxproto dri2proto evieproto fixesproto fontcacheproto
	  fontenc fontsproto fontutil glproto ice inputproto kbproto
	  libfs oldx pciaccess pixman printproto randrproto
	  recordproto renderproto resourceproto scrnsaverproto sm
	  trapproto videoproto x11 xau xaw xaw6 xaw7 xbitmaps
	  xcmiscproto xcomposite xcursor xdamage xdmcp xevie xext
	  xextproto xf86bigfontproto xf86dgaproto xf86driproto
	  xf86miscproto xf86rushproto xf86vidmodeproto xfixes xfont
	  xfontcache xft xi xinerama xineramaproto xkbfile xkbui xmu
	  xmuu xorg-server xp xpm xprintapputil xprintutil xproto
	  xproxymngproto xrandr xrender xres xscrnsaver xt xtrans
	  xtrap xtst xv xvmc xxf86dga xxf86misc
	  xxf86vm</code>.</p><p>Всегда актуальный перечень можно найти в
	<code class="filename">/usr/ports/Mk/bsd.xorg.mk</code>.</p><p>Проект Mesa является попыткой обеспечить свободную
	реализацию OpenGL.  Вы можете указать зависимость от
	различных компонентов этого проекта при помощи переменной
	<code class="varname">USE_GL</code>.  Действительные опции:
	<code class="literal">glut, glu, glw, glew, gl</code> и
	<code class="literal">linux</code>.  Для обратной совместимости
	значение <code class="literal">yes</code> соответствует
	<code class="literal">glu</code>.</p><div class="example"><a id="use-xorg-example"></a><div class="example-title">Пример 6.3. Пример для USE_XORG</div><div class="example-contents"><pre class="programlisting">USE_XORG=	xrender xft xkbfile xt xaw
USE_GL=		glu</pre></div></div><br class="example-break" /><div class="table"><a id="idp75715280"></a><div class="table-title">Таблица 6.7. Переменные для портов, использующих X</div><div class="table-contents"><table summary="Переменные для портов, использующих X" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USES= imake</code></td><td>Используется <code class="command">imake</code>.</td></tr><tr><td><code class="varname">XMKMF</code></td><td>Задаёт маршрут до <code class="command">xmkmf</code>, если
		он отсутствует в <code class="envar">PATH</code>.  По умолчанию
		это <code class="literal">xmkmf -a</code>.</td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="using-x11-vars"></a><div class="example-title">Пример 6.4. Использование переменных X11 в порте</div><div class="example-contents"><pre class="programlisting"># Использовать некоторые библиотеки X11
USE_XORG=	x11 xpm</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-motif"></a>6.8.2. Порты, которым требуется Motif</h3></div></div></div><p>Если вашему порту требуется Motif, задайте переменную
	<code class="varname">USES= motif</code> в файле
	<code class="filename">Makefile</code>.  Реализация Motif,
	используемая по умолчанию, находится в
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/open-motif/pkg-descr">x11-toolkits/open-motif</a>.
	Пользователи вместо этого могут выбрать
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/lesstif/pkg-descr">x11-toolkits/lesstif</a> через
	установку переменной <code class="varname">WANT_LESSTIF</code>.</p><p>Переменная <code class="varname">MOTIFLIB</code> будет установлена
	в <code class="filename">bsd.port.mk</code>, чтобы ссылаться на
	соответствующую библиотеку Motif.  Пожалуйста, измените
	исходные тексты вашего порта на использование
	<code class="literal">${MOTIFLIB}</code> везде, где упоминается
	библиотека Motif, в первоначальном
	<code class="filename">Makefile</code> или
	<code class="filename">Imakefile</code>.</p><p>Существует два общих случая:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Если порт обращается к библиотеке Motif как
	    <code class="literal">-lXm</code> в своих файлах
	    <code class="filename">Makefile</code> или
	    <code class="filename">Imakefile</code>, просто подставьте вместо
	    этих обращений
	    <code class="literal">${MOTIFLIB}</code>.</p></li><li class="listitem"><p>Если порт использует <code class="literal">XmClientLibs</code>
	    в своем файле <code class="filename">Imakefile</code>, измените
	    это обращение на <code class="literal">${MOTIFLIB}
	      ${XTOOLLIB} ${XLIB}</code>.</p></li></ul></div><p>Заметьте, что переменная <code class="varname">MOTIFLIB</code> (как
	правило) раскрывается в
	<code class="literal">-L/usr/local/lib -lXm</code> или
	<code class="literal">/usr/local/lib/libXm.a</code>, так что нет нужды
	впереди добавлять <code class="literal">-L</code> или
	<code class="literal">-l</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75744080"></a>6.8.3. Шрифты для X11</h3></div></div></div><p>Если ваш порт устанавливает шрифты для X Window System,
	поместите их в каталог
	<code class="filename">LOCALBASE/lib/X11/fonts/local</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75745616"></a>6.8.4. Получение поддельного <code class="envar">DISPLAY</code>, используя
	Xvfb</h3></div></div></div><p>Некоторые приложения для успешной компиляции требуют
	наличие работающего дисплея X11.  Это создает проблему для
	машин, которые работают в режиме headless.  При использовании
	следующего канонического хака инфраструктура построения
	запустит сервер X в виртуальном фреймбуфере.  Затем
	переменная работающего <code class="envar">DISPLAY</code> передается при
	построении.</p><pre class="programlisting">USES=	display</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="desktop-entries"></a>6.8.5. Элементы рабочего стола</h3></div></div></div><p>Элементы рабочего стола (<a class="link" href="http://standards.freedesktop.org/desktop-entry-spec/latest/" target="_top">стандарта
	  Freedesktop</a>) предоставляют способ автоматической
	настройки функций рабочего стола при установке новой
	программы, не требуя вмешательства пользователя.  Например,
	новые программы автоматически отображаются в меню приложений
	совместимых окружений рабочего стола.  Элементы рабочего
	стола изначально появились в окружении рабочего стола
	<span class="application">GNOME</span>, но в настоящее время
	являются стандартом и также работают с
	<span class="application">KDE</span> и
	<span class="application">Xfce</span>.  Такая небольшая
	автоматизация предоставляет реальное удобство для
	пользователя, и посему элементы рабочего стола приветствуются
	в приложениях, которые можно использовать в окружении
	рабочего стола.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75754960"></a>6.8.5.1. Использование предопределенных файлов
	  <code class="filename">.desktop</code></h4></div></div></div><p>Порты, включающие предопределенные файлы
	  <code class="filename">*.desktop</code>, должны включать эти файлы в
	  <code class="filename">pkg-plist</code> и устанавливать их в каталог
	  <code class="filename">$LOCALBASE/share/applications</code>.
	  Для установки этих файлов используется <a class="link" href="#install-macros" title="5.15.1. Макросы INSTALL_*">макрос
	    <code class="varname">INSTALL_DATA</code></a>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="updating-desktop-database"></a>6.8.5.2. Обновление базы данных рабочего стола</h4></div></div></div><p>Если в файле порта
	  <code class="filename">portname.desktop</code> имеется запись
	  MimeType, то база данных рабочего стола олжна быть
	  обновлена после установки и удаления.  Для этого укажите
	  <code class="varname">USES</code>= desktop-file-utils.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="desktop-entries-macro"></a>6.8.5.3. Создание элементов рабочего стола с использованием
	  <code class="varname">DESKTOP_ENTRIES</code></h4></div></div></div><p>Элементы рабочего стола можно легко создавать для
	  приложений, используя переменную
	  <code class="varname">DESKTOP_ENTRIES</code>.  Будет автоматически
	  создан, установлен и добавлен в
	  <code class="filename">pkg-plist</code> файл с названием
	  <code class="filename">name.desktop</code>.  Синтаксис:</p><pre class="programlisting">DESKTOP_ENTRIES=	"NAME" "COMMENT" "ICON" "COMMAND" "CATEGORY" StartupNotify</pre><p>Перечень возможных категорий доступен на <a class="link" href="http://standards.freedesktop.org/menu-spec/latest/apa.html" target="_top">вебсайте
	    Freedesktop</a>.  <code class="varname">StartupNotify</code>
	  отобразит, поддерживает ли приложение <span class="emphasis"><em>уведомления
	    о запуске</em></span>.  Как правило, это графический
	  индикатор часы вместо указателя мыши, меню или панель,
	  которые уведомляют пользователя о загрузке программы.
	  Программа, поддерживающая уведомления о запуске, очистит
	  этот индикатор после запуска.  Программы, несовместимые с
	  уведомлениями о запуске, не будут очищать индикатор
	  (возможно, вызывая путаницу и приводя пользователей в
	  бешенство), и поэтому должны иметь
	  <code class="varname">StartupNotify</code> в выключенном состоянии
	  <code class="literal">false</code>; тогда индикатор не будет
	  отображаться совсем.</p><p>Пример:</p><pre class="programlisting">DESKTOP_ENTRIES=	"ToME" "Roguelike game based on JRR Tolkien's work" \
			"${DATADIR}/xtra/graf/tome-128.png" \
			"tome -v -g" "Application;Game;RolePlaying;" \
			false</pre></div></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-gnome"></a>6.9. Использование GNOME</h2></div></div></div><p>Для задания того, какие компоненты GNOME использует
      конкретный порт, проект FreeBSD/GNOME использует собственный набор
      переменных.  На странице проекта FreeBSD/GNOME размещён <a class="link" href="http://www.FreeBSD.org/gnome/docs/porting.html" target="_top">
	исчерпывающий список этих переменных</a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-qt"></a>6.10. Использование Qt</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="qt-common"></a>6.10.1. Порты, для которых требуется Qt</h3></div></div></div><div class="table"><a id="idp75787088"></a><div class="table-title">Таблица 6.8. Переменные для портов, использующих Qt</div><div class="table-contents"><table summary="Переменные для портов, использующих Qt" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USE_QT4</code></td><td>Указывает инструменты и библиотеки в качестве
		зависимостей для портов, которые используют Qt 4.
		Для получения подробностей смотрите <a class="link" href="#qt4-components" title="6.10.2. Выбор компонентов">выбор компонентов Qt
		  4</a>.</td></tr><tr><td><code class="varname">QT_PREFIX</code></td><td>Устанавливается в значение, содержащее путь к
		установленному Qt (переменная только для
		чтения).</td></tr><tr><td><code class="varname">MOC</code></td><td>Устанавливается в значение, содержащее путь к
		<code class="command">moc</code> (переменная только для
		чтения).  По умолчанию устанавливается в соответствии
		со значением <code class="varname">USE_QT_VER</code>.</td></tr><tr><td><code class="varname">QTCPPFLAGS</code></td><td>Дополнительные флаги компилятора для
		инструментального пакета Qt, передаваемые через
		переменную <code class="varname">CONFIGURE_ENV</code>.  По
		умолчанию устанавливается в соответствии со значением
		<code class="varname">USE_QT_VER</code>.</td></tr><tr><td><code class="varname">QTCFGLIBS</code></td><td>Дополнительные флаги компоновки для
		инструментального пакета Qt, передаваемые через
		переменную <code class="varname">CONFIGURE_ENV</code>.  По
		умолчанию устанавливается в соответствии со значением
		<code class="varname">USE_QT_VER</code>.</td></tr><tr><td><code class="varname">QTNONSTANDARD</code></td><td>Подавляет изменение
		<code class="varname">CONFIGURE_ENV</code>,
		<code class="varname">CONFIGURE_ARGS</code>,
		<code class="varname">CPPFLAGS</code> и
		<code class="varname">MAKE_ENV</code>.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idp75809360"></a><div class="table-title">Таблица 6.9. Дополнительные переменные для портов, использующих Qt
	  4.x</div><div class="table-contents"><table summary="Дополнительные переменные для портов, использующих Qt&#10;&#9;  4.x" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">UIC</code></td><td>Устанавливает путь к <code class="command">uic</code>
		(переменная только для чтения).</td></tr><tr><td><code class="varname">QMAKE</code></td><td>Устанавливает путь к <code class="command">qmake</code>
		(переменная только для чтения).</td></tr><tr><td><code class="varname">QMAKESPEC</code></td><td>Устанавливает путь к конфигурационному файлу для
		<code class="command">qmake</code> (переменная только для
		чтения).</td></tr><tr><td><code class="varname">QMAKEFLAGS</code></td><td>Дополнительные флаги для
		<code class="command">qmake</code>.</td></tr><tr><td><code class="varname">QT_INCDIR</code></td><td>Устанавливает каталоги для заголовков Qt 4
		(переменная только для чтения).</td></tr><tr><td><code class="varname">QT_LIBDIR</code></td><td>Устанавливает путь к библиотекам Qt 4
		(переменная только для чтения).</td></tr><tr><td><code class="varname">QT_PLUGINDIRC</code></td><td>Устанавливает путь к плагинам Qt 4 (переменная
		только для чтения).</td></tr></tbody></table></div></div><br class="table-break" /><p>При заданной переменной <code class="varname">USE_QT4</code>
	применяются следующие настройки:</p><pre class="programlisting">CONFIGURE_ARGS+=	--with-qt-includes=${QT_INCDIR} \
			--with-qt-libraries=${QT_LIBDIR} \
			--with-extra-libs=${LOCALBASE}/lib \
			--with-extra-includes=${LOCALBASE}/include
CONFIGURE_ENV+=	MOC="${MOC}" UIC="${UIC}" LIBS="${QTCFGLIBS}" \
		QMAKE="${QMAKE}" QMAKESPEC="${QMAKESPEC}" QTDIR="${QT_PREFIX}"
MAKE_ENV+=	QMAKESPEC="${QMAKESPEC}"

PLIST_SUB+=	QT_INCDIR_REL=${QT_INCDIR_REL} \
		QT_LIBDIR_REL=${QT_LIBDIR_REL} \
		QT_PLUGINDIR_REL=${QT_PLUGINDIR_REL}</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="qt4-components"></a>6.10.2. Выбор компонентов</h3></div></div></div><p>В переменной <code class="varname">USE_QT4</code> должны
	указываться зависимости от отдельных инструментов и библиотек
	Qt 4.  К каждому компоненту можно добавить суффикс,
	<code class="literal">_build</code> или <code class="literal">_run</code>,
	отражающий, когда должна быть применена зависимость, во время
	сборки или выполнения, соответственно.  Если суффикс
	отсутствует, зависимость от компонента будет и для времени
	сборки, и для времени выполнения.  Обычно, компоненты
	библиотек должны указываться без суффиксов, компоненты
	инструментов - с суффиксом <code class="literal">_build</code>, а
	компоненты плагинов - с суффиксом <code class="literal">_run</code>.
	Наиболее общие используемые компоненты перечислены ниже (все
	доступные компоненты перечислены в
	<code class="varname">_USE_QT4_ALL</code> в файле
	<code class="filename">/usr/ports/Mk/bsd.qt.mk</code>):</p><div class="table"><a id="idp75831888"></a><div class="table-title">Таблица 6.10. Доступные библиотечные компоненты Qt 4</div><div class="table-contents"><table summary="Доступные библиотечные компоненты Qt 4" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">corelib</code></td><td>основная библиотека (можно опустить, если порт
		не использует ничего, кроме
		<code class="literal">corelib</code>)</td></tr><tr><td><code class="literal">gui</code></td><td>библиотека графического пользовательского
		интерфейса</td></tr><tr><td><code class="literal">network</code></td><td>сетевая библиотека</td></tr><tr><td><code class="literal">opengl</code></td><td>библиотека OpenGL</td></tr><tr><td><code class="literal">qt3support</code></td><td>библиотека совместимости с Qt 3</td></tr><tr><td><code class="literal">qtestlib</code></td><td>библиотека модульного тестирования</td></tr><tr><td><code class="literal">script</code></td><td>библиотека сценариев</td></tr><tr><td><code class="literal">sql</code></td><td>библиотека SQL</td></tr><tr><td><code class="literal">xml</code></td><td>библиотека XML</td></tr></tbody></table></div></div><br class="table-break" /><p>Вы можете определить, от каких библиотек зависит
	приложение, запустив <code class="command">ldd</code> на основной
	исполняемый файл после успешной компиляции.</p><div class="table"><a id="idp75852240"></a><div class="table-title">Таблица 6.11. Доступные компоненты инструментов Qt 4</div><div class="table-contents"><table summary="Доступные компоненты инструментов Qt 4" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">moc</code></td><td>мета-объектный компилятор (нужен при построении
		почти для каждого приложения Qt)</td></tr><tr><td><code class="literal">qmake</code></td><td>генератор Makefile / утилита построения</td></tr><tr><td><code class="literal">rcc</code></td><td>компилятор ресурсов (нужен, если приложение идет
		вместе с файлами <code class="filename">*.rc</code> или
		<code class="filename">*.qrc</code>)</td></tr><tr><td><code class="literal">uic</code></td><td>компилятор пользовательского интерфейса (нужен,
		если приложение идет вместе с файлами
		<code class="filename">*.ui</code>, созданными при помощи Qt
		Designer, - на практике каждое приложение Qt с
		GUI)</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idp75862096"></a><div class="table-title">Таблица 6.12. Доступные компоненты плагинов Qt 4</div><div class="table-contents"><table summary="Доступные компоненты плагинов Qt 4" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">iconengines</code></td><td>плагин для движка иконок SVG (если приложение
		поставляется с иконками SVG)</td></tr><tr><td><code class="literal">imageformats</code></td><td>плагины для графических форматов GIF, JPEG, MNG
		и SVG (если приложение поставляется с графическими
		файлами)</td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="qt4-components-example"></a><div class="example-title">Пример 6.5. Выбор компонентов Qt 4</div><div class="example-contents"><p>В этом примере портированное приложение использует
	  библиотеку графического пользовательского интерфейса Qt 4,
	  основную библиотеку Qt 4, все инструменты генерации кода
	  Qt 4 и генератор Makefile Qt 4.  Поскольку библиотека
	  <code class="literal">gui</code> подразумевает зависимость от
	  основной библиотеки, указывать <code class="literal">corelib</code>
	  нет необходимости.  Инструменты генерации кода Qt 4
	  <code class="literal">moc</code>, <code class="literal">uic</code> и
	  <code class="literal">rcc</code>, а также генератор Makefile
	  <code class="literal">qmake</code> нужны только для времени
	  построения, поэтому они указаны с суффиксом
	  <code class="literal">_build</code>:</p><pre class="programlisting">USE_QT4=	gui moc_build qmake_build rcc_build uic_build</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-qmake"></a>6.10.3. Использование <code class="command">qmake</code></h3></div></div></div><div class="table"><a id="idp75877712"></a><div class="table-title">Таблица 6.13. Переменные для портов, использующих
	  <code class="command">qmake</code></div><div class="table-contents"><table summary="Переменные для портов, использующих&#10;&#9;  qmake" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="varname">QMAKE_ARGS</code></td><td>Спефицичные для порта флаги
		<span class="application">QMake</span> для передачи
		программе <code class="command">qmake</code>.</td></tr><tr><td><code class="varname">QMAKE_ENV</code></td><td>Переменные окружения, устанавливаемые для
		программы <code class="command">qmake</code>.  По умолчанию
		соответствует значению
		<code class="literal">${CONFIGURE_ENV}</code>.</td></tr><tr><td><code class="varname">QMAKE_PRO</code></td><td>Название файла проекта
		<code class="filename">.pro</code>.  По умолчанию имеет пустое
		значение (с использованием автоопределения).</td></tr></tbody></table></div></div><br class="table-break" /><p>Если вместе с приложением вместо
	<code class="filename">configure</code> поставляется файл
	<code class="filename">.pro</code>, вы можете использовать
	следующее:</p><pre class="programlisting">USES=	qmake
USE_QT4=	qmake_build</pre><p><code class="literal">USES=qmake</code> указывает порту на
	использование <code class="command">qmake</code> в процессе
	конфигурации.  Обратите внимание, что
	<code class="literal">USES=qmake</code> не подразумевает зависимость от
	Qt 4 <code class="command">qmake</code>.  Для этого в значении
	<code class="literal">USE_QT4</code> должен присутствовать компонент
	<code class="literal">qmake_build</code>.</p><p>Приложения Qt часто пишутся в кроссплатформенной манере,
	и X11/Unix часто не является для них платформой разработки,
	что в свою очередь часто приводит к соответствующим упущенным
	моментам:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="emphasis"><em>Отсутствующие дополнительные пути для
	      заголовочных файлов.</em></span>  Многие приложения идут
	    с поддержкой иконки в системном трее, но пренебрегают
	    смотреть на наличие заголовочных файлов и/или
	    библиотеками в каталогах X11.  Вы можете сообщить
	    <code class="command">qmake</code>, чтобы она добавила каталоги в
	    пути поиска заголовочных файлов и библиотек через
	    командную строку.  К примеру:</p><pre class="programlisting">QMAKE_ARGS+= INCLUDEPATH+=${LOCALBASE}/include \
	LIBS+=-L${LOCALBASE}/lib</pre></li><li class="listitem"><p><span class="emphasis"><em>Фиктивные пути установки.</em></span>
	    Иногда данные, такие как иконки и файлы .desktop,
	    устанавливаются по умолчанию в каталоги, которые не
	    просматриваются XDG-совместимыми приложениями.  Примером
	    является <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/editors/texmaker/pkg-descr">editors/texmaker</a>
	    - взгляните на <code class="filename">patch-texmaker.pro</code> из
	    каталога <code class="filename">files</code> этого порта, который
	    можно взять в качестве шаблона исправления этого
	    непосредственно в файле проекта
	    <code class="command">qmake</code>.</p></li></ul></div></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-kde"></a>6.11. Использование KDE</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="kde4-variables"></a>6.11.1. Задание переменных KDE 4</h3></div></div></div><p>Если ваше приложение зависит от KDE 4.x, присвойте
	<code class="varname">USE_KDE4</code> список требуемых компонентов.
	Для переопределения типа зависимости компонента могут быть
	использованы суффиксы <code class="literal">_build</code> и
	<code class="literal">_run</code> (например,
	<code class="literal">baseapps_run</code>).  Если суффикс не задан,
	будет использован тип зависимости по умолчанию.  Если вы
	хотите использовать оба типа, добавьте компонент дважды с
	обоими суффиксами (например,
	<code class="literal">automoc4_build automoc4_run</code>).  Основные
	наиболее используемые компоненты перечислены ниже (актуальные
	компоненты задокументированы в начале файла
	<code class="filename">/usr/ports/Mk/bsd.kde4.mk</code>):</p><div class="table"><a id="idp75905616"></a><div class="table-title">Таблица 6.14. Доступные компоненты KDE 4</div><div class="table-contents"><table summary="Доступные компоненты KDE 4" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">kdehier</code></td><td>Иерархия основных каталогов KDE</td></tr><tr><td><code class="literal">kdelibs</code></td><td>KDE Developer Platform</td></tr><tr><td><code class="literal">kdeprefix</code></td><td>Если установлено, то порт будет установлен в
		<code class="literal">${KDE4_PREFIX}</code> вместо
		<code class="literal">${LOCALBASE}</code></td></tr><tr><td><code class="literal">sharedmime</code></td><td>База данных MIME типов для портов KDE</td></tr><tr><td><code class="literal">automoc4</code></td><td>automoc для пакетов Qt 4</td></tr><tr><td><code class="literal">akonadi</code></td><td>Сервер хранения KDE-Pim</td></tr><tr><td><code class="literal">soprano</code></td><td>Фреймворк Qt 4 RDF</td></tr><tr><td><code class="literal">strigi</code></td><td>Поисковые даемон рабочего стола</td></tr><tr><td><code class="literal">libkcddb</code></td><td>Библиотека KDE CDDB</td></tr><tr><td><code class="literal">libkcompactdisc</code></td><td>Библиотека KDE для взаимодействия с
		аудио-CD</td></tr><tr><td><code class="literal">libkdeedu</code></td><td>Библиотеки, используемые для образовательных
		приложений</td></tr><tr><td><code class="literal">libkdcraw</code></td><td>Библиотека KDE LibRaw</td></tr><tr><td><code class="literal">libkexiv2</code></td><td>Библиотека KDE Exiv2</td></tr><tr><td><code class="literal">libkipi</code></td><td> KDE Image Plugin Interface</td></tr><tr><td><code class="literal">libkonq</code></td><td>Основная библиотека Konqueror</td></tr><tr><td><code class="literal">libksane</code></td><td>Библиотека KDE SANE ("Scanner Access Now
		Easy")</td></tr><tr><td><code class="literal">pimlibs</code></td><td>Библиотеки KDE-Pim</td></tr><tr><td><code class="literal">kate</code></td><td>Тектовый редактор</td></tr><tr><td><code class="literal">marble</code></td><td>Виртуальный глобус</td></tr><tr><td><code class="literal">okular</code></td><td>Универсальный просмотрщик документов</td></tr><tr><td><code class="literal">korundum</code></td><td>Привязка Ruby к KDE</td></tr><tr><td><code class="literal">perlkde</code></td><td>Привязка Perl к KDE</td></tr><tr><td><code class="literal">pykde4</code></td><td>Привязка Python к KDE</td></tr><tr><td><code class="literal">pykdeuic4</code></td><td>Компилятор пользовательского интерфейса
		PyKDE</td></tr><tr><td><code class="literal">smokekde</code></td><td>Библиотеки KDE SMOKE</td></tr></tbody></table></div></div><br class="table-break" /><p>Порты KDE 4.x устанавливаются в
	<code class="varname">KDE4_PREFIX</code>, что в настоящее время
	соответствует <code class="filename">/usr/local/kde4</code>.  Это
	достигается путем указания компонента
	<code class="literal">kdeprefix</code>, который определяет значение по
	умолчанию для <code class="varname">PREFIX</code>.  Тем не менее, порты
	учитывают любые <code class="varname">PREFIX</code>, установленные
	через переменную окружения <code class="envar">MAKEFLAGS</code> и/или
	параметры <code class="command">make</code>.</p><div class="example"><a id="kde4-components-example"></a><div class="example-title">Пример 6.6. Пример <code class="varname">USE_KDE4</code></div><div class="example-contents"><p>Это простой пример для порта KDE 4.
	  <code class="literal">USES= cmake:outsource</code> указывает порту
	  использовать <span class="application">CMake</span>,
	  конфигурационный инструмент, широко применяемый в проектах
	  KDE 4 (подробное описание даёт <a class="xref" href="#using-cmake" title="6.4.4. Использование cmake">Раздел 6.4.4, <<Использование <code class="command">cmake</code>>></a>).  <code class="varname">USE_KDE4</code>
	  добавляет зависимость от библиотек KDE и заставляет порты
	  использовать <code class="command">automoc4</code> во время сборки.
	  Требуемые компоненты KDE и другие зависимости можно
	  определить в журнале configure.
	  <code class="varname">USE_KDE4</code> не подразумевает
	  <code class="varname">USE_QT4</code>.  Если порт требует какой-либо
	  из компонентов Qt 4, их следует указать в
	  <code class="varname">USE_QT4</code>.</p><pre class="programlisting">USES=		cmake:outsource
USE_KDE4=	kdelibs kdeprefix automoc4
USE_QT4=	moc_build qmake_build rcc_build uic_build</pre></div></div><br class="example-break" /></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-java"></a>6.12. Использование Java</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="java-variables"></a>6.12.1. Задание переменных</h3></div></div></div><p>Если вашему порту необходимо наличие JavaTM
	Development Kit (JDKTM) для построения, работы или даже
	распаковки дистрибутивного файла, то в нём должна быть задана
	переменная <code class="varname">USE_JAVA</code>.</p><p>В Коллекции Портов присутствуют несколько JDK различных
	разработчиков и разных версий.  Если ваш порт должен
	использовать одну из этих версий, то вы должны указать, какую
	именно.  Самой последней версией и версией по умолчанию
	является <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/java/openjdk6/pkg-descr">java/openjdk6</a>.</p><div class="table"><a id="idp75966288"></a><div class="table-title">Таблица 6.15. Переменные, которые которые могут задаваться портами,
	  использующими Java</div><div class="table-contents"><table summary="Переменные, которые которые могут задаваться портами,&#10;&#9;  использующими Java" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">USE_JAVA</code></td><td>Должна быть определена для того, что последующие
		переменные вступили в действие.</td></tr><tr><td><code class="varname">JAVA_VERSION</code></td><td>Список версий Java, перечисленных через пробел,
		подходящих для порта.  Опциональный знак
		<code class="literal">"+"</code> позволяет вам указать диапазон
		версий (возможные значения:
		<code class="literal">1.5[+] 1.6[+] 1.7[+]</code>).</td></tr><tr><td><code class="varname">JAVA_OS</code></td><td>Список операционных систем, перечисленных через
		пробел, порты JDK для которых подходят для порта
		(возможные значения:
		<code class="literal">native linux</code>).</td></tr><tr><td><code class="varname">JAVA_VENDOR</code></td><td>Список разработчиков портов JDK, перечисленных
		через пробел, которые подходят для порта (возможные
		значения: <code class="literal">freebsd bsdjava sun
		  openjdk</code>).</td></tr><tr><td><code class="varname">JAVA_BUILD</code></td><td>Если задана, то означает, что выбранный порт JDK
		должен быть добавлен к зависимостям порта для его
		построения.</td></tr><tr><td><code class="varname">JAVA_RUN</code></td><td>Если задана, то означает, что выбранный порт JDK
		должен быть добавлен в зависимостям порта для его
		работы.</td></tr><tr><td><code class="varname">JAVA_EXTRACT</code></td><td>Если задана, то означает, что выбранный порт JDK
		должен быть добавлен в зависимостям порта для
		распаковки его дистрибутивных файлов.</td></tr></tbody></table></div></div><br class="table-break" /><p>Ниже перечисляются все значения, которые принимают
	переменные после задания переменной
	<code class="varname">USE_JAVA</code>:</p><div class="table"><a id="idp75993424"></a><div class="table-title">Таблица 6.16. Переменные, доступные в портах, использующих
	  Java</div><div class="table-contents"><table summary="Переменные, доступные в портах, использующих&#10;&#9;  Java" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">JAVA_PORT</code></td><td>Название порта JDK (к примеру,
		<code class="literal">'java/openjdk6'</code>).</td></tr><tr><td><code class="varname">JAVA_PORT_VERSION</code></td><td>Полное наименовании версии порта JDK (к примеру,
		<code class="literal">'1.6.0'</code>).  Если вам нужны только
		первые две цифры номера версии, используйте
		<code class="varname">${JAVA_PORT_VERSION:C/^([0-9])\.([0-9])(.*)$/\1.\2/}</code>.</td></tr><tr><td><code class="varname">JAVA_PORT_OS</code></td><td>Операционная система, используемая портом JDK
		(к примеру, <code class="literal">'native'</code>).</td></tr><tr><td><code class="varname">JAVA_PORT_VENDOR</code></td><td>Разработчик порта JDK (к примеру,
		<code class="literal">'openjdk'</code>).</td></tr><tr><td><code class="varname">JAVA_PORT_OS_DESCRIPTION</code></td><td>Описание операционной системы, используемой
		портом JDK (к примеру,
		<code class="literal">'Native'</code>).</td></tr><tr><td><code class="varname">JAVA_PORT_VENDOR_DESCRIPTION</code></td><td>Описание разработчика порта JDK (к примеру,
		<code class="literal">'OpenJDK BSD Porting
		  Team'</code>).</td></tr><tr><td><code class="varname">JAVA_HOME</code></td><td>Маршрут к установочному каталогу JDK (к примеру,
		<code class="filename">'/usr/local/openjdk6'</code>).</td></tr><tr><td><code class="varname">JAVAC</code></td><td>Маршрут к используемому компилятору Java
		(к примеру,
		<code class="filename">'/usr/local/openjdk6/bin/javac'</code>.</td></tr><tr><td><code class="varname">JAR</code></td><td>Маршрут к используемой утилите
		<code class="command">jar</code> (к примеру,
		<code class="filename">'/usr/local/openjdk6/bin/jar'</code>
		или
		<code class="filename">'/usr/local/bin/fastjar'</code>).</td></tr><tr><td><code class="varname">APPLETVIEWER</code></td><td>Маршрут к утилите
		<code class="command">appletviewer</code> (к примеру,
		<code class="filename">'/usr/local/openjdk6/bin/appletviewer'</code>).</td></tr><tr><td><code class="varname">JAVA</code></td><td>Маршрут к выполняемому файлу
		<code class="command">java</code>.  Используйте его для запуска
		Java-программ (к примеру,
		<code class="filename">'/usr/local/openjdk6/bin/java'</code>).</td></tr><tr><td><code class="varname">JAVADOC</code></td><td>Маршрут к вспомогательной программе
		<code class="command">javadoc</code>.</td></tr><tr><td><code class="varname">JAVAH</code></td><td>Маршрут к программе
		<code class="command">javah</code>.</td></tr><tr><td><code class="varname">JAVAP</code></td><td>Маршрут к программе
		<code class="command">javap</code>.</td></tr><tr><td><code class="varname">JAVA_KEYTOOL</code></td><td>Маршрут к вспомогательной программе
		<code class="command">keytool</code>.</td></tr><tr><td><code class="varname">JAVA_N2A</code></td><td>Маршрут к утилите
		<code class="command">native2ascii</code>.</td></tr><tr><td><code class="varname">JAVA_POLICYTOOL</code></td><td>Маршрут к программе
		<code class="command">policytool</code>.</td></tr><tr><td><code class="varname">JAVA_SERIALVER</code></td><td>Маршрут к вспомогательной программе
		<code class="command">serialver</code>.</td></tr><tr><td><code class="varname">RMIC</code></td><td>Маршрут к генератору каркаса программ RMI,
		утилите <code class="command">rmic</code>.</td></tr><tr><td><code class="varname">RMIREGISTRY</code></td><td>Маршрут к программе регистрации RMI,
		<code class="command">rmiregistry</code>.</td></tr><tr><td><code class="varname">RMID</code></td><td>Маршрут к программе-даемону RMI
		<code class="command">rmid</code>.</td></tr><tr><td><code class="varname">JAVA_CLASSES</code></td><td>Маршрут к архиву, который содержит файлы классов
		JDK,
		<code class="filename">${JAVA_HOME}/jre/lib/rt.jar</code>.</td></tr></tbody></table></div></div><br class="table-break" /><p>Вы можете воспользоваться make-целью
	<code class="literal">java-debug</code> для получения информации,
	необходимой для отладки вашего порта.  При её выполнении
	будут выданы значения многих упомянутых выше
	переменных.</p><p>Кроме того, для единообразия установки всех портов Java
	определены следующие константы:</p><div class="table"><a id="idp76049488"></a><div class="table-title">Таблица 6.17. Константы, определённые для портов, использующих
	  Java</div><div class="table-contents"><table summary="Константы, определённые для портов, использующих&#10;&#9;  Java" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Константа</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">JAVASHAREDIR</code></td><td>Корневой каталог для всего, что связано с Java.
		По умолчанию:
		<code class="filename">${PREFIX}/share/java</code>.</td></tr><tr><td><code class="varname">JAVAJARDIR</code></td><td>Каталог, в который должны устанавливаться
		JAR-файлы.  По умолчанию:
		<code class="filename">${JAVASHAREDIR}/classes</code>.</td></tr><tr><td><code class="varname">JAVALIBDIR</code></td><td>Каталог, в который устанавливаются JAR-файлы из
		других портов.  По умолчанию:
		<code class="filename">${LOCALBASE}/share/java/classes</code>.</td></tr></tbody></table></div></div><br class="table-break" /><p>Соответствующие записи определяются в обоих переменных
	<code class="varname">PLIST_SUB</code> (описана в
	<a class="xref" href="#plist-sub" title="7.1. Изменение содержимого pkg-plist в зависимости от make-переменных">Раздел 7.1, <<Изменение содержимого <code class="filename">pkg-plist</code> в
      зависимости от make-переменных>></a>) и
	<code class="varname">SUB_LIST</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="java-building-with-ant"></a>6.12.2. Построение с Ant</h3></div></div></div><p>Если построение порта производится с использованием
	Apache Ant, то необходимо определить
	<code class="varname">USE_ANT</code>.  Таким образом Ant становится
	подкомандой make.  Если в порте не определена цель
	<code class="literal">do-build</code>, то будет установлена цель по
	умолчанию, которая просто запускает Ant в соответствии со
	значением <code class="varname">MAKE_ENV</code>,
	<code class="varname">MAKE_ARGS</code> и <code class="varname">ALL_TARGET</code>.
	Это похоже на механизм <code class="varname">USES= gmake</code>,
	который описан в <a class="xref" href="#building" title="6.4. Механизмы построения">Раздел 6.4, <<Механизмы построения>></a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="java-best-practices"></a>6.12.3. Практические рекомендации</h3></div></div></div><p>При портировании Java-библиотеки ваш порт должен
	устанавливать JAR-файл(ы) в каталог
	<code class="filename">${JAVAJARDIR}</code>, а все остальные данные в
	каталог <code class="filename">${JAVASHAREDIR}/${PORTNAME}</code> (за
	исключением документации, о которой пойдёт речь ниже).  Для
	уменьшения размера упакованного файла вы можете сослаться на
	JAR-файл(ы) непосредственно в файле
	<code class="filename">Makefile</code>.  Просто воспользуйтесь
	следующей директивой (в которой
	<code class="filename">myport.jar</code> является именем JAR-файла,
	устанавливаемого как часть порта):</p><pre class="programlisting">PLIST_FILES+=	%%JAVAJARDIR%%/myport.jar</pre><p>При портировании Java-приложения порт обычно
	устанавливает всё в один каталог (в том числе все свои
	JAR-зависимости).  В этом отношении настоятельно
	рекомендуется использование
	<code class="filename">${JAVASHAREDIR}/${PORTNAME}</code>.  На
	усмотрение создателя порта остаётся решение вопроса о том,
	устанавливать ли дополнительные JAR-зависимости в этот
	каталог или напрямую использовать уже установленные (из
	каталога <code class="filename">${JAVAJARDIR}</code>).</p><p>При портировании приложения <span class="trademark">Java</span>TM, для запуска сервиса
	которого требуется сервер приложений, такой как <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/tomcat7/pkg-descr">www/tomcat7</a>, для производителя в
	порядке вещей является распространение файла
	<code class="filename">.war</code>.  Файл <code class="filename">.war</code>
	- это Веб-приложение АРхивированное и оно
	распаковывается при вызове данным приложением.  Избегайте
	добавлять файлы <code class="filename">.war</code> в
	<code class="filename">pkg-plist</code>.  Это не является наилучшим
	решением.  Сервер приложений производит расширение архива
	<code class="filename">war</code> без должной его очистки при удалении
	порта.  Более подходящим способом работы с этим файлом будет
	распаковать архив, установить файлы и добавить их в
	<code class="filename">pkg-plist</code>.</p><pre class="programlisting">TOMCATDIR=	${LOCALBASE}/apache-tomcat-7.0
WEBAPPDIR=	myapplication

post-extract:
	@${MKDIR} ${WRKDIR}/${PORTDIRNAME}
	@${TAR} xf ${WRKDIR}/myapplication.war -C ${WRKDIR}/${PORTDIRNAME}

do-install:
	cd ${WRKDIR} &amp;&amp; \
	${INSTALL} -d -o ${WWWOWN} -g ${WWWGRP} ${TOMCATDIR}/webapps/${PORTDIRNAME}
	@cd ${WRKDIR}/${PORTDIRNAME} &amp;&amp; ${COPYTREE_SHARE} \* ${WEBAPPDIR}/${PORTDIRNAME}</pre><p>Вне зависимости от типа вашего порта (библиотека это или
	приложение), дополнительная документация должна
	устанавливаться <a class="link" href="#install-documentation" title="5.15.4. Установка дополнительной документации">в тоже
	самое место</a>, что и для других портов.  Известно, что в
	зависимости от используемой версии JDK утилита JavaDoc
	генерирует различные наборы файлов.  Для портов, которые не
	привязаны к использованию определённой версии JDK, таким
	образом становится проблематичным определить список файлов
	для упаковки (<code class="filename">pkg-plist</code>).  Это одна из
	причин, по которой создателям портов настоятельно
	рекомендуется использовать макрос
	<code class="varname">PORTDOCS</code>.  Более того, даже если вы
	сможете угадать набор файлов, который будет сгенерирован
	утилитой <code class="command">javadoc</code>, размер получающегося
	файла <code class="filename">pkg-plist</code> голосует за
	использование <code class="varname">PORTDOCS</code>.</p><p>Значением по умолчанию для переменной
	<code class="varname">DATADIR</code> является
	<code class="filename">${PREFIX}/share/${PORTNAME}</code>.  Хорошей
	идеей является переопределение для Java-портов значения
	<code class="varname">DATADIR</code> как
	<code class="filename">${JAVASHAREDIR}/${PORTNAME}</code>.  На самом
	деле <code class="varname">DATADIR</code> автоматически добавляется к
	<code class="varname">PLIST_SUB</code> (это описано в <a class="xref" href="#plist-sub" title="7.1. Изменение содержимого pkg-plist в зависимости от make-переменных">Раздел 7.1, <<Изменение содержимого <code class="filename">pkg-plist</code> в
      зависимости от make-переменных>></a>), так что вы сможете использовать
	<code class="literal">%%DATADIR%%</code> непосредственно в
	<code class="filename">pkg-plist</code>.</p><p>Что касается выбора между построением портов Java из
	исходных текстов или их прямой установкой из бинарных
	дистрибутивов, то на момент создания этого текста
	определённой политики на этот счёт не существует.  Однако
	участники <a class="link" href="http://www.freebsd.org/java/" target="_top">Проекта FreeBSD
	  Java</a> рекомендуют создателям портов строить их из
	исходных текстов, если эта задача является несложной.</p><p>Все возможности, которые были описаны в этом разделе,
	реализованы в файле <code class="filename">bsd.java.mk</code>.  Если
	вы предположите, что вашему порту требуется менее тривиальная
	поддержка Java, пожалуйста, взгляните сначала на <a class="link" href="http://svnweb.FreeBSD.org/ports/head/Mk/bsd.java.mk?view=markup" target="_top">журнал
	  изменений bsd.java.mk в
	  <span class="application">Subversion</span></a>, так как для
	документирования последних изменений требуется какое-то
	время.  Затем, если вы думаете, что не хватающая вам
	поддержка окажется полезной для многих других портов Java,
	обсудите ваш вопрос в <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-java" target="_top">Список рассылки, посвящённый поддержке Java во FreeBSD</a>.</p><p>Хотя в базе сообщений об ошибках для соответствующих PR
	имеется категория <code class="literal">java</code>, она относится к
	работе над портированием JDK, которые проводит Проект FreeBSD
	Java.  Таким образом, вы должны относить свой Java-порт, как
	и любой другой, к категории <code class="literal">ports</code>, если
	решаемый вами вопрос не относится ни к реализации JDK, ни к
	<code class="filename">bsd.java.mk</code>.</p><p>Похожим образом определена политика по отношению к
	<code class="varname">CATEGORIES</code> порта Java, которая подробно
	описана в <a class="xref" href="#makefile-categories" title="5.3. Разделение по категориям">Раздел 5.3, <<Разделение по категориям>></a>.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-php"></a>6.13. Веб-приложения, Apache и PHP</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-apache"></a>6.13.1. Apache</h3></div></div></div><div class="table"><a id="idp76094928"></a><div class="table-title">Таблица 6.18. Переменные для портов, использующих Apache</div><div class="table-contents"><table summary="Переменные для портов, использующих Apache" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USE_APACHE</code></td><td>Порт требует Apache.  Возможные значения:
		<code class="literal">yes</code> (берёт любую версию),
		<code class="literal">22</code>, <code class="literal">24</code>,
		<code class="literal">22-24</code>, <code class="literal">22+</code>
		и так далее.  Версия по умолчанию
		<code class="literal">22</code>.  Более подробная информация
		содержится в файле
		<code class="filename">ports/Mk/bsd.apache.mk</code> и на
		странице <a class="link" href="http://wiki.freebsd.org/Apache/" target="_top">wiki.freebsd.org/Apache/</a>.</td></tr><tr><td><code class="varname">APXS</code></td><td>Полный путь к исполняемому файлу
		<code class="command">apxs</code>.  Может быть переопределен в
		вашем порту.</td></tr><tr><td><code class="varname">HTTPD</code></td><td>Полный путь к исполняемому файлу
		<code class="command">httpd</code>.  Может быть переопределен в
		вашем порту.</td></tr><tr><td><code class="varname">APACHE_VERSION</code></td><td>Версия установленного Apache (переменная только
		для чтения).  Эта переменная доступна только после
		подключения <code class="filename">bsd.port.pre.mk</code>.
		Возможные значения: <code class="literal">22</code>,
		<code class="literal">24</code>.</td></tr><tr><td><code class="varname">APACHEMODDIR</code></td><td>Каталог для модулей Apache.  Значение переменной
		автоматически подставляется в
		<code class="filename">pkg-plist</code>.</td></tr><tr><td><code class="varname">APACHEINCLUDEDIR</code></td><td>Каталог для заголовков Apache.  Значение
		переменной автоматически подставляется в
		<code class="filename">pkg-plist</code>.</td></tr><tr><td><code class="varname">APACHEETCDIR</code></td><td>Каталог для конфигурационных файлов Apache.
		Значение переменной автоматически подставляется в
		<code class="filename">pkg-plist</code>.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idp76116304"></a><div class="table-title">Таблица 6.19. Используемые переменные при портировании модулей
	  Apache</div><div class="table-contents"><table summary="Используемые переменные при портировании модулей&#10;&#9;  Apache" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">MODULENAME</code></td><td>Название модуля.  Значением по умолчанию
		является <code class="varname">PORTNAME</code>.  Пример:
		<code class="literal">mod_hello</code></td></tr><tr><td><code class="varname">SHORTMODNAME</code></td><td>Краткое название модуля.  Наследуется
		автоматически от <code class="varname">MODULENAME</code>, но
		может быть переопределено.  Пример:
		<code class="literal">hello</code></td></tr><tr><td><code class="varname">AP_FAST_BUILD</code></td><td>Использовать <code class="command">apxs</code> для
		компиляции и установки модуля.</td></tr><tr><td><code class="varname">AP_GENPLIST</code></td><td>Также автоматически создает
		<code class="filename">pkg-plist</code>.</td></tr><tr><td><code class="varname">AP_INC</code></td><td>Добавляет каталог к пути поиска заголовков
		во время компиляции.</td></tr><tr><td><code class="varname">AP_LIB</code></td><td>Добавляет каталог к пути поиска библиотек во
		время компиляции.</td></tr><tr><td><code class="varname">AP_EXTRAS</code></td><td>Дополнительные флаги, передаваемые
		<code class="command">apxs</code>.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="web-apps"></a>6.13.2. Веб-приложения</h3></div></div></div><p>Веб-приложения следует устанавливать в
	<code class="filename">PREFIX/www/appname</code>.  Для вашего удобства
	этот путь одинаково доступен в <code class="filename">Makefile</code>
	и <code class="filename">pkg-plist</code> как переменная
	<code class="varname">WWWDIR</code>, а путь относительно
	<code class="varname">PREFIX</code> доступен в
	<code class="filename">Makefile</code> как
	<code class="varname">WWWDIR_REL</code>.</p><p>Пользователь и группа процесса веб-сервера доступны как
	<code class="varname">WWWOWN</code> и <code class="varname">WWWGRP</code>, в
	случае если вам нужно изменить владельца для некоторых
	файлов.  Значением по умолчанию и для владельца, и для группы
	является <code class="literal">www</code>.  Если вы хотите использовать
	в вашем порте другие значения, воспользуйтесь для этого
	нотацией <code class="literal">WWWOWN?= myuser</code>, чтобы позволить
	пользователю легко переопределить их.</p><p>Не добавляйте зависимость от Apache, если веб-приложение
	явным образом не нуждается в Apache.  Учитывайте, что
	пользователи могут пожелать запустить ваше веб-приложение на
	другом веб-сервере помимо Apache.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="php-variables"></a>6.13.3. PHP</h3></div></div></div><div class="table"><a id="idp76153680"></a><div class="table-title">Таблица 6.20. Переменные для портов, использующих PHP</div><div class="table-contents"><table summary="Переменные для портов, использующих PHP" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USE_PHP</code></td><td>Порт требует PHP.  Значение
		<code class="literal">yes</code> добавляет зависимость от PHP.
		Вместо этого может быть указан перечень требуемых
		расширений PHP.  Пример:
		<code class="literal">pcre xml gettext</code></td></tr><tr><td><code class="varname">DEFAULT_PHP_VER</code></td><td>Выбирает старший номер версии, с которым будет
		установлен PHP как зависимость в случае, когда PHP
		еще не установлен.  По умолчанию
		<code class="literal">5</code>.  Возможные значения:
		<code class="literal">4</code>, <code class="literal">5</code></td></tr><tr><td><code class="varname">IGNORE_WITH_PHP</code></td><td>Порт не работает с PHP данной версии.  Возможные
		значения: <code class="literal">4</code>,
		<code class="literal">5</code></td></tr><tr><td><code class="varname">USE_PHPIZE</code></td><td>Порт будет построен как расширение PHP.</td></tr><tr><td><code class="varname">USE_PHPEXT</code></td><td>Порт будет считаться расширением PHP, включая
		установку и регистрацию в реестре расширений.</td></tr><tr><td><code class="varname">USE_PHP_BUILD</code></td><td>Установить PHP как зависимость времени
		построения.</td></tr><tr><td><code class="varname">WANT_PHP_CLI</code></td><td>Хочет CLI (командная строка) версию PHP.</td></tr><tr><td><code class="varname">WANT_PHP_CGI</code></td><td>Хочет CGI версию PHP.</td></tr><tr><td><code class="varname">WANT_PHP_MOD</code></td><td>Хочет PHP как модуль Apache.</td></tr><tr><td><code class="varname">WANT_PHP_SCR</code></td><td>Хочет CLI или CGI версию PHP.</td></tr><tr><td><code class="varname">WANT_PHP_WEB</code></td><td>Хочет модуль Apache или CGI версию PHP.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp76172240"></a>6.13.4. Модули PEAR</h3></div></div></div><p>Портирование модулей PEAR является очень простым
	процессом.</p><p>Используйте переменные <code class="varname">FILES</code>,
	<code class="varname">TESTS</code>, <code class="varname">DATA</code>,
	<code class="varname">SQLS</code>, <code class="varname">SCRIPTFILES</code>,
	<code class="varname">DOCS</code> and <code class="varname">EXAMPLES</code> для
	перечисления файлов, которые вы хотите установить.  Все
	перечисленные файлы будут автоматически установлены в
	подходящие места и добавлены в
	<code class="filename">pkg-plist</code>.</p><p>Подключите
	<code class="filename">${PORTSDIR}/devel/pear/bsd.pear.mk</code>
	на последней строке <code class="filename">Makefile</code>.</p><div class="example"><a id="pear-makefile"></a><div class="example-title">Пример 6.7. Пример Makefile для классов PEAR</div><div class="example-contents"><pre class="programlisting">PORTNAME=	Date
PORTVERSION=	1.4.3
CATEGORIES=	devel www pear

MAINTAINER=	example@domain.com
COMMENT=	PEAR Date and Time Zone Classes

BUILD_DEPENDS=	${PEARDIR}/PEAR.php:${PORTSDIR}/devel/pear-PEAR
RUN_DEPENDS:=	${BUILD_DEPENDS}

FILES=		Date.php Date/Calc.php Date/Human.php Date/Span.php     \
		Date/TimeZone.php
TESTS=		test_calc.php test_date_methods_span.php testunit.php   \
		testunit_date.php testunit_date_span.php wknotest.txt   \
		bug674.php bug727_1.php bug727_2.php bug727_3.php       \
		bug727_4.php bug967.php weeksinmonth_4_monday.txt       \
		weeksinmonth_4_sunday.txt weeksinmonth_rdm_monday.txt   \
		weeksinmonth_rdm_sunday.txt
DOCS=		TODO
_DOCSDIR=	.

.include &lt;bsd.port.pre.mk&gt;
.include "${PORTSDIR}/devel/pear/bsd.pear.mk"
.include &lt;bsd.port.post.mk&gt;</pre></div></div><br class="example-break" /></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-python"></a>6.14. Использование Python</h2></div></div></div><p>Коллекция Портов поддерживает параллельную установку
      множества версий Python.  Следует убедиться, что в портах
      используется правильный интерпретатор <code class="command">python</code>
      в соответствии с переменной <code class="varname">PYTHON_VERSION</code>,
      установленной пользователем.  По большей части это означает
      замену пути к исполняемому файлу <code class="command">python</code> в
      сценариях на значение переменной
      <code class="varname">PYTHON_CMD</code>.</p><p>Порты, устанавливающие файлы под каталог
      <code class="varname">PYTHON_SITELIBDIR</code>, должны использовать
      префикс вида <code class="literal">pyXY-</code>, таким образом названия
      пакетов будут включать в себя версию Python, с которой они
      установлены.</p><pre class="programlisting">PKGNAMEPREFIX=	${PYTHON_PKGNAMEPREFIX}</pre><div class="table"><a id="idp76192080"></a><div class="table-title">Таблица 6.21. Переменные для портов, которые используют Python</div><div class="table-contents"><table summary="Переменные для портов, которые используют Python" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USE_PYTHON</code></td><td>Для этого порта нужен Python.  Минимальная
	      требуемая версия может быть указана с таким значением
	      как <code class="literal">2.6+</code>.  Также можно указан
	      диапазон версий с разделением двух версий через -,
	      например: <code class="literal">2.6-2.7</code></td></tr><tr><td><code class="varname">USE_PYDISTUTILS</code></td><td>Использовать дистрибутивные утилиты (distutils)
	      Python для конфигурации, компиляции и установки.
	      Необходимо, если порт использует
	      <code class="filename">setup.py</code>.  Переопределяет цели
	      <code class="buildtarget">do-build</code> и
	      <code class="buildtarget">do-install</code> и также может
	      переопределять <code class="buildtarget">do-configure</code>,
	      если не определена
	      <code class="varname">GNU_CONFIGURE</code>.</td></tr><tr><td><code class="varname">PYTHON_PKGNAMEPREFIX</code></td><td>Используется как <code class="varname">PKGNAMEPREFIX</code>
	      для отличия пакетов, использующих разные версии Python.
	      Пример: <code class="literal">py24-</code></td></tr><tr><td><code class="varname">PYTHON_SITELIBDIR</code></td><td>Местонахождение дерева site-packages, которое
	      содержит путь установки Python (обычно,
	      <code class="varname">LOCALBASE</code>).  Переменная
	      <code class="varname">PYTHON_SITELIBDIR</code> может быть очень
	      полезной при установке модулей Python.</td></tr><tr><td><code class="varname">PYTHONPREFIX_SITELIBDIR</code></td><td>Вариант PYTHON_SITELIBDIR без PREFIX.  По
	      возможности всегда используйте
	      <code class="literal">%%PYTHON_SITELIBDIR%%</code> в
	      <code class="filename">pkg-plist</code>.  Значением по умолчанию
	      для <code class="literal">%%PYTHON_SITELIBDIR%%</code> является
	      <code class="literal">lib/python%%PYTHON_VERSION%%/site-packages</code>.</td></tr><tr><td><code class="varname">PYTHON_CMD</code></td><td>Командная строка интерпретатора Python, включая
	      номер версии.</td></tr><tr><td><code class="varname">PYNUMERIC</code></td><td>Строка зависимости для расширения numeric.</td></tr><tr><td><code class="varname">PYNUMPY</code></td><td>Строка зависимости для нового расширения numeric,
	      numpy (PYNUMERIC объявлен устаревшим вышестоящим
	      производителем).</td></tr><tr><td><code class="varname">PYXML</code></td><td>Строка зависимости для расширения XML (не нужно
	      для Python 2.0 и выше, т.к. включено в основной
	      дистрибутив).</td></tr></tbody></table></div></div><br class="table-break" /><p>Полный перечень доступных переменных можно найти в
      <code class="filename">/usr/ports/Mk/bsd.python.mk</code>.</p><p>Некоторые приложения на Python заявляют о поддержке
      <code class="varname">DESTDIR</code> (требуется для staging), которая не
      работает (в частности, у Mailman до версии 2.1.16).
      Ограничение можно обойти путём перекомпиляции сценариев.
      Например, это можно выполнить в цели
      <code class="buildtarget">post-build</code>.  С учётом того, что
      после установки предполагаемое место размещения сценариев
      Python будет находиться в
      <code class="varname">PYTHONPREFIX_SITELIBDIR</code>, можно применить
      следующее решение:</p><pre class="programlisting">(cd ${STAGEDIR}${PREFIX} \
  &amp;&amp; ${PYTHON_CMD} ${PYTHON_LIBDIR}/compileall.py \
   -d ${PREFIX} -f ${PYTHONPREFIX_SITELIBDIR:S;${PREFIX}/;;})</pre><p>Эта команда перекомпилирует исходный текст с заменой путей
      на относительные к каталогу сборки, а также дописывает значение
      <code class="varname">PREFIX</code> перед именем файла, записанного в
      выходном файле с промежуточным представлением, с использованием
      <code class="literal">-d</code>.  <code class="literal">-f</code> требуется для
      безусловной перекомпиляции, <code class="literal">:S;${PREFIX}/;;</code>
      удаляет префиксы из значения переменной
      <code class="varname">PYTHONPREFIX_SITELIBDIR</code>, чтобы сделать его
      относительным к <code class="varname">PREFIX</code>.</p><p>Для этого требуется Python 2.7 или выше.  Это не
      работает с Python 2.6.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-tcl"></a>6.15. Использование <span class="application">Tcl/Tk</span></h2></div></div></div><p>В Коллекции Портов поддерживается одновременная установка
      множественных версий <span class="application">Tcl/Tk</span>.  Порты
      должны пытаться поддерживать по крайней мере версию
      <span class="application">Tcl/Tk</span>, используемую по умолчанию, и
      выше с помощью переменных <code class="varname">USE_TCL</code> и
      <code class="varname">USE_TK</code>.  Желаемую версию
      <code class="command">tcl</code> можно указать в переменной
      <code class="varname">WITH_TCL_VER</code>.</p><div class="table"><a id="idp76229968"></a><div class="table-title">Таблица 6.22. Наиболее востребованные переменные для портов, которые
	используют <span class="application">Tcl/Tk</span></div><div class="table-contents"><table summary="Наиболее востребованные переменные для портов, которые&#10;&#9;используют Tcl/Tk" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USE_TCL</code></td><td>Порт зависит от библиотеки
	      <span class="application">Tcl</span> (не оболочки).
	      Минимальную требуемую версию можно указать с
	      использованием таких значений, как 84+.  Отдельные
	      неподдерживаемые версии указываются в переменной
	      <code class="varname">INVALID_TCL_VER</code>.</td></tr><tr><td><code class="varname">USE_TCL_BUILD</code></td><td><span class="application">Tcl</span> нужен для порта
	      только на время сборки.</td></tr><tr><td><code class="varname">USE_TCL_WRAPPER</code></td><td>Эту новую переменную следует использовать для
	      портов, для которых требуется оболочка
	      <span class="application">Tcl</span> и не требуется
	      конкретная версия <code class="literal">tclsh</code>.  Обертка
	      <code class="literal">tclsh</code> устанавливается в систему.
	      Пользователь может указать желаемую оболочку
	      <code class="command">tcl</code> для использования.</td></tr><tr><td><code class="varname">WITH_TCL_VER</code></td><td>Определяемые пользователем переменные, которые
	      устанавливают желаемую версию
	      <span class="application">Tcl</span>.</td></tr><tr><td><code class="varname"><em class="replaceable"><code>UNIQUENAME</code></em>_WITH_TCL_VER</code></td><td>Подобно <code class="varname">WITH_TCL_VER</code>, но для
	      каждого порта.</td></tr><tr><td><code class="varname">USE_TCL_THREADS</code></td><td>Требует многопоточную сборку
	      <span class="application">Tcl/Tk</span>.</td></tr><tr><td><code class="varname">USE_TK</code></td><td>Порт зависит от библиотеки
	      <span class="application">Tk</span> (не от предпочитаемой
	      оболочки).  Подразумевает <code class="varname">USE_TCL</code> с
	      тем же значением.  Для большей информации смотрите
	      описание переменной <code class="varname">USE_TCL</code>.</td></tr><tr><td><code class="varname">USE_TK_BUILD</code></td><td>Аналогично
	      <code class="varname">USE_TCL_BUILD</code>.</td></tr><tr><td><code class="varname">USE_TK_WRAPPER</code></td><td>Аналогично
	      <code class="varname">USE_TCL_WRAPPER</code>.</td></tr><tr><td><code class="varname">WITH_TK_VER</code></td><td>Аналогично <code class="varname">WITH_TCL_VER</code>,
	      подразумевает <code class="varname">WITH_TCL_VER</code> той же
	      версии.</td></tr></tbody></table></div></div><br class="table-break" /><p>Полный перечень доступных переменных находится в
      <code class="filename">/usr/ports/Mk/bsd.tcl.mk</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-emacs"></a>6.16. Использование Emacs</h2></div></div></div><p>Этот раздел ещё предстоит написать.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-ruby"></a>6.17. Использование Ruby</h2></div></div></div><div class="table"><a id="idp76263120"></a><div class="table-title">Таблица 6.23. Полезные переменные для портов, использующих Ruby</div><div class="table-contents"><table summary="Полезные переменные для портов, использующих Ruby" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Описание</th></tr></thead><tbody><tr><td><code class="varname">USE_RUBY</code></td><td>Порт требует Ruby.</td></tr><tr><td><code class="varname">USE_RUBY_EXTCONF</code></td><td>Порт использует для конфигурации
	      <code class="filename">extconf.rb</code>.</td></tr><tr><td><code class="varname">USE_RUBY_SETUP</code></td><td>Порт использует для конфигурации
	      <code class="filename">setup.rb</code>.</td></tr><tr><td><code class="varname">RUBY_SETUP</code></td><td>Устанавливает альтернативное имя для
	      <code class="filename">setup.rb</code>.  Распространенным
	      значением является
	      <code class="filename">install.rb</code>.</td></tr></tbody></table></div></div><br class="table-break" /><p>Следующая таблица отражает некоторые переменные, доступные
      авторам портов через инфраструктуру портов.  Эти переменные
      должны использоваться для установки файлов в правильное
      месторасположение.  Используйте их в
      <code class="filename">pkg-plist</code> как можно больше.  Эти
      переменные не должны переопределяться в самом порте.</p><div class="table"><a id="idp76274000"></a><div class="table-title">Таблица 6.24. Отобранные переменные только для чтения для портов,
	использующих Ruby</div><div class="table-contents"><table summary="Отобранные переменные только для чтения для портов,&#10;&#9;использующих Ruby" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Описание</th><th>Примерное значение</th></tr></thead><tbody><tr><td><code class="varname">RUBY_PKGNAMEPREFIX</code></td><td>Используется как <code class="varname">PKGNAMEPREFIX</code>
	      для различия пакетов от разных версий Ruby.</td><td><code class="literal">ruby18-</code></td></tr><tr><td><code class="varname">RUBY_VERSION</code></td><td>Полная версия Ruby в форме
	      <code class="literal">x.y.z</code>.</td><td><code class="literal">1.8.2</code></td></tr><tr><td><code class="varname">RUBY_SITELIBDIR</code></td><td>Путь для установки архитектуронезависимых
	      библиотек.</td><td><code class="literal">/usr/local/lib/ruby/site_ruby/1.8</code></td></tr><tr><td><code class="varname">RUBY_SITEARCHLIBDIR</code></td><td>Путь для установки архитектурозависимых
	      библиотек.</td><td><code class="literal">/usr/local/lib/ruby/site_ruby/1.8/amd64-freebsd6</code></td></tr><tr><td><code class="varname">RUBY_MODDOCDIR</code></td><td>Путь для установки документации модуля.</td><td><code class="literal">/usr/local/share/doc/ruby18/patsy</code></td></tr><tr><td><code class="varname">RUBY_MODEXAMPLESDIR</code></td><td>Путь для установки примеров модуля.</td><td><code class="literal">/usr/local/share/examples/ruby18/patsy</code></td></tr></tbody></table></div></div><br class="table-break" /><p>Полный перечень доступных переменных находится в
      <code class="filename">/usr/ports/Mk/bsd.ruby.mk</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-sdl"></a>6.18. Использование SDL</h2></div></div></div><p>Переменная <code class="varname">USE_SDL</code> используется для
      автоматической настройки зависимостей для портов, использующих
      библиотеки на основе SDL, такие как
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/sdl12/pkg-descr">devel/sdl12</a> или
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sdl_image/pkg-descr">graphics/sdl_image</a>.</p><p>Для версии 1.2 на данный момент распознаются следующие
      SDL-библиотеки:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>sdl: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/sdl12/pkg-descr">devel/sdl12</a></p></li><li class="listitem"><p>console: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/sdl_console/pkg-descr">devel/sdl_console</a></p></li><li class="listitem"><p>gfx: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sdl_gfx/pkg-descr">graphics/sdl_gfx</a></p></li><li class="listitem"><p>image: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sdl_image/pkg-descr">graphics/sdl_image</a></p></li><li class="listitem"><p>mixer: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/sdl_mixer/pkg-descr">audio/sdl_mixer</a></p></li><li class="listitem"><p>mm: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/sdlmm/pkg-descr">devel/sdlmm</a></p></li><li class="listitem"><p>net: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/sdl_net/pkg-descr">net/sdl_net</a></p></li><li class="listitem"><p>pango: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/sdl_pango/pkg-descr">x11-toolkits/sdl_pango</a></p></li><li class="listitem"><p>sound: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/sdl_sound/pkg-descr">audio/sdl_sound</a></p></li><li class="listitem"><p>ttf: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sdl_ttf/pkg-descr">graphics/sdl_ttf</a></p></li></ul></div><p>Для версии 2.0 на данный момент распознаются следующие
      SDL-библиотеки:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>sdl: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/sdl20/pkg-descr">devel/sdl20</a></p></li><li class="listitem"><p>gfx: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sdl2_gfx/pkg-descr">graphics/sdl2_gfx</a></p></li><li class="listitem"><p>image: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sdl2_image/pkg-descr">graphics/sdl2_image</a></p></li><li class="listitem"><p>mixer: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/sdl2_mixer/pkg-descr">audio/sdl2_mixer</a></p></li><li class="listitem"><p>net: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/sdl2_net/pkg-descr">net/sdl2_net</a></p></li><li class="listitem"><p>ttf: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sdl2_ttf/pkg-descr">graphics/sdl2_ttf</a></p></li></ul></div><p>Таким образом, если порт имеет зависимость от
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/sdl_net/pkg-descr">net/sdl_net</a> и
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/sdl_mixer/pkg-descr">audio/sdl_mixer</a>, то строка будет
      следующей:</p><pre class="programlisting">USE_SDL=	net mixer</pre><p>Зависимость от порта
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/sdl12/pkg-descr">devel/sdl12</a>, который требуется
      для <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/sdl_net/pkg-descr">net/sdl_net</a> и
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/sdl_mixer/pkg-descr">audio/sdl_mixer</a>, будет также
      автоматически добавлен.</p><p>Если вы используете <code class="varname">USE_SDL</code> с элементами
      SDL 1.2, то он автоматически:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Добавляет зависимость от
	  <span class="application">sdl12-config</span> к
	  <code class="varname">BUILD_DEPENDS</code></p></li><li class="listitem"><p>Добавляет переменную <code class="varname">SDL_CONFIG</code> к
	  <code class="varname">CONFIGURE_ENV</code></p></li><li class="listitem"><p>Добавляет зависимости от указанных библиотек к
	  <code class="varname">LIB_DEPENDS</code></p></li></ul></div><p>Если вы используете <code class="varname">USE_SDL</code> с элементами
      SDL 2.0, то он автоматически:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Добавляет зависимость от
	  <span class="application">sdl2-config</span> к
	  <code class="varname">BUILD_DEPENDS</code></p></li><li class="listitem"><p>Добавляет переменную <code class="varname">SDL2_CONFIG</code> к
	  <code class="varname">CONFIGURE_ENV</code></p></li><li class="listitem"><p>Добавляет зависимости от указанных библиотек к
	  <code class="varname">LIB_DEPENDS</code></p></li></ul></div><p>Для проверки наличия библиотеки SDL вы можете делать это
      при помощи переменной <code class="varname">WANT_SDL</code>:</p><pre class="programlisting">WANT_SDL=	yes

.include &lt;bsd.port.pre.mk&gt;

.if ${HAVE_SDL:Mmixer}!=""
USE_SDL+=	mixer
.endif

.include &lt;bsd.port.post.mk&gt;</pre></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-wx"></a>6.19. Использование <span class="application">wxWidgets</span></h2></div></div></div><p>Эта глава описывает статус библиотек
      <span class="application">wxWidgets</span> в дереве портов и их
      интеграцию с системой портов.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="wx-introduction"></a>6.19.1. Введение</h3></div></div></div><p>Существует множество версий библиотек
	<span class="application">wxWidgets</span>, конфликтующих между
	собой (устанавливают файлы под тем же именем).  В дереве
	портов эта проблема решена путем установки каждой версии под
	собственным названием с использованием номера версии в
	качестве суффикса.</p><p>Очевидным недостатком этого является необходимость
	изменения каждого приложения для нахождения искомой версии.
	К счастью, большинство приложений для определения нужного
	компилятора и флагов компоновки вызывают сценарий
	<code class="command">wx-config</code>.  Для каждой доступной версии
	этот сценарий имеет своё имя.  Большинство приложений
	учитывают переменную окружения или принимают аргумент
	configure для указания, какой сценарий
	<code class="command">wx-config</code> следует вызывать.  На все
	остальные приходится накладывать патч.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="wx-version"></a>6.19.2. Выбор версии</h3></div></div></div><p>Для того, чтобы заставить ваш порт использовать
	конкретную версию <span class="application">wxWidgets</span>,
	существует две доступные для определения переменные (если
	определена только одна, то вторая примет значение по
	умолчанию):</p><div class="table"><a id="wx-ver-sel-table"></a><div class="table-title">Таблица 6.25. Переменные для выбора версии
	  <span class="application">wxWidgets</span></div><div class="table-contents"><table summary="Переменные для выбора версии&#10;&#9;  wxWidgets" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Описание</th><th>Значение по умолчанию</th></tr></thead><tbody><tr><td><code class="varname">USE_WX</code></td><td>Перечень версий, которые порт может
		использовать</td><td>Все доступные версии</td></tr><tr><td><code class="varname">USE_WX_NOT</code></td><td>Перечень версий, которые порт не может
		использовать</td><td>Нет</td></tr></tbody></table></div></div><br class="table-break" /><p>Перечень доступных версий
	<span class="application">wxWidgets</span> и соответствующих им
	портов в дереве:</p><div class="table"><a id="idp76368080"></a><div class="table-title">Таблица 6.26. Доступные версии
	  <span class="application">wxWidgets</span></div><div class="table-contents"><table summary="Доступные версии&#10;&#9;  wxWidgets" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Версия</th><th>Порт</th></tr></thead><tbody><tr><td><code class="literal">2.4</code></td><td><a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/wxgtk24/pkg-descr">x11-toolkits/wxgtk24</a></td></tr><tr><td><code class="literal">2.6</code></td><td><a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/wxgtk26/pkg-descr">x11-toolkits/wxgtk26</a></td></tr><tr><td><code class="literal">2.8</code></td><td><a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/wxgtk28/pkg-descr">x11-toolkits/wxgtk28</a></td></tr></tbody></table></div></div><br class="table-break" /><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Версии начиная с <code class="literal">2.5</code> также
	  поставляются с Unicode и устанавливается подчиненным портом
	  с названием как как у обычного, но с суффиксом
	  <code class="literal">-unicode</code>, но этим можно управлять при
	  помощи переменных (смотрите
	  <a class="xref" href="#wx-unicode" title="6.19.4. Unicode">Раздел 6.19.4, <<Unicode>></a>).</p></div><p>Переменные в <a class="xref" href="#wx-ver-sel-table" title="Таблица 6.25. Переменные для выбора версии wxWidgets">Таблица 6.25, <<Переменные для выбора версии
	  <span class="application">wxWidgets</span>>></a> можно
	установить в одну или более следующих комбинаций, разделенных
	пробелами:</p><div class="table"><a id="idp76379088"></a><div class="table-title">Таблица 6.27. Определение версии для
	  <span class="application">wxWidgets</span></div><div class="table-contents"><table summary="Определение версии для&#10;&#9;  wxWidgets" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Описание</th><th>Пример</th></tr></thead><tbody><tr><td>Единичная версия</td><td><code class="literal">2.4</code></td></tr><tr><td>Восходящий диапазон</td><td><code class="literal">2.4+</code></td></tr><tr><td>Нисходящий диапазон</td><td><code class="literal">2.6-</code></td></tr><tr><td>Полный диапазон (обязан быть восходящим)</td><td><code class="literal">2.4-2.6</code></td></tr></tbody></table></div></div><br class="table-break" /><p>Кроме того, существует несколько переменных для выбора
	предпочитаемых версий из перечня доступных.  Они могут быть
	установлены в несколько версий, первая из которых будет иметь
	наибольший приоритет.</p><div class="table"><a id="idp76388304"></a><div class="table-title">Таблица 6.28. Переменные для выбора предпочитаемых версий
	  <span class="application">wxWidgets</span></div><div class="table-contents"><table summary="Переменные для выбора предпочитаемых версий&#10;&#9;  wxWidgets" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Предназначение</th></tr></thead><tbody><tr><td><code class="varname">WANT_WX_VER</code></td><td>порт</td></tr><tr><td><code class="varname">WITH_WX_VER</code></td><td>пользователь</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="wx-components"></a>6.19.3. Выбор компонентов</h3></div></div></div><p>Существуют другие приложения, которые, хотя и не являются
	библиотеками <span class="application">wxWidgets</span>, но в тоже
	время относятся к ним.  Эти приложения можно указать в
	переменной <code class="varname">WX_COMPS</code>.  Доступны следующие
	компоненты:</p><div class="table"><a id="idp76400848"></a><div class="table-title">Таблица 6.29. Доступные компоненты
	  <span class="application">wxWidgets</span></div><div class="table-contents"><table summary="Доступные компоненты&#10;&#9;  wxWidgets" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th><th>Ограничение версии</th></tr></thead><tbody><tr><td><code class="literal">wx</code></td><td>основная библиотека</td><td>нет</td></tr><tr><td><code class="literal">contrib</code></td><td>сторонние библиотеки</td><td><code class="literal">нет</code></td></tr><tr><td><code class="literal">python</code></td><td><span class="application">wxPython</span>
		(привязки к
		<span class="application">Python</span>)</td><td><code class="literal">2.4-2.6</code></td></tr><tr><td><code class="literal">mozilla</code></td><td><span class="application">wxMozilla</span></td><td><code class="literal">2.4</code></td></tr><tr><td><code class="literal">svg</code></td><td><span class="application">wxSVG</span></td><td><code class="literal">2.6</code></td></tr></tbody></table></div></div><br class="table-break" /><p>Тип добавляемой зависимости при выборе каждого компонента
	может быть указан вручную путем добавления суффикса,
	отделенного точкой с запятой.  Если таковой отсутствует, но
	будет использовано значение по умолчанию (смотрите <a class="xref" href="#wx-def-dep-types" title="Таблица 6.31. Типы зависимости wxWidgets, используемые по умолчанию">Таблица 6.31, <<Типы зависимости <span class="application">wxWidgets</span>,
	  используемые по умолчанию>></a>).  Доступные типы
	зависимости:</p><div class="table"><a id="idp76419792"></a><div class="table-title">Таблица 6.30. Доступные типы зависимости
	  <span class="application">wxWidgets</span></div><div class="table-contents"><table summary="Доступные типы зависимости&#10;&#9;  wxWidgets" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">build</code></td><td>Компонент требуется для построения, эквивалентен
		<code class="varname">BUILD_DEPENDS</code></td></tr><tr><td><code class="literal">run</code></td><td>Компонент требуется для запуска, эквивалентен
		<code class="varname">RUN_DEPENDS</code></td></tr><tr><td><code class="literal">lib</code></td><td>Компонент требуется для построения и запуска,
		эквивалентен <code class="varname">LIB_DEPENDS</code></td></tr></tbody></table></div></div><br class="table-break" /><p>Значения по умолчанию для компонентов подробно
	рассматриваются в следующей таблице:</p><div class="table"><a id="wx-def-dep-types"></a><div class="table-title">Таблица 6.31. Типы зависимости <span class="application">wxWidgets</span>,
	  используемые по умолчанию</div><div class="table-contents"><table summary="Типы зависимости wxWidgets,&#10;&#9;  используемые по умолчанию" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Компонент</th><th>Тип зависимости</th></tr></thead><tbody><tr><td><code class="literal">wx</code></td><td><code class="literal">lib</code></td></tr><tr><td><code class="literal">contrib</code></td><td><code class="literal">lib</code></td></tr><tr><td><code class="literal">python</code></td><td><code class="literal">run</code></td></tr><tr><td><code class="literal">mozilla</code></td><td><code class="literal">lib</code></td></tr><tr><td><code class="literal">svg</code></td><td><code class="literal">lib</code></td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="wx-components-example"></a><div class="example-title">Пример 6.8. Выбор компонентов
	  <span class="application">wxWidgets</span></div><div class="example-contents"><p>Следующий фрагмент относится к порту, в котором
	  используется <span class="application">wxWidgets</span> версии
	  <code class="literal">2.4</code> с его сторонними
	  библиотеками.</p><pre class="programlisting">USE_WX=		2.4
WX_COMPS=	wx contrib</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="wx-unicode"></a>6.19.4. Unicode</h3></div></div></div><p>Библиотека <span class="application">wxWidgets</span>
	поддерживает Unicode начиная с версии <code class="literal">2.5</code>.
	В дереве портов доступны обе версии и могут быть выбраны с
	использованием следующих переменных:</p><div class="table"><a id="wx-unicode-var-table"></a><div class="table-title">Таблица 6.32. Переменные для выбора версии
	  <span class="application">wxWidgets</span> с Unicode</div><div class="table-contents"><table summary="Переменные для выбора версии&#10;&#9;  wxWidgets с Unicode" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Описание</th><th>Предназначение</th></tr></thead><tbody><tr><td><code class="varname">WX_UNICODE</code></td><td>Порт работает <span class="emphasis"><em>только</em></span> с
		версией Unicode</td><td>порт</td></tr><tr><td><code class="varname">WANT_UNICODE</code></td><td>Порт работает с обеими версиями, но предпочитает
		версию с Unicode</td><td>порт</td></tr><tr><td><code class="varname">WITH_UNICODE</code></td><td>Порт будет использовать версию Unicode</td><td>пользователь</td></tr><tr><td><code class="varname">WITHOUT_UNICODE</code></td><td>Порт будет использовать обычную версию, если это
		поддерживается (когда <code class="varname">WX_UNICODE</code>
		не определена)</td><td>пользователь</td></tr></tbody></table></div></div><br class="table-break" /><div xmlns="" class="warning"><h3 class="admontitle">Предупреждение: </h3><p xmlns="http://www.w3.org/1999/xhtml">Не используйте <code class="varname">WX_UNICODE</code> для
	  портов, которые могут использовать обе версии.  Если вы
	  хотите, чтобы порт по умолчанию использовал Unicode,
	  определите вместо этого
	  <code class="varname">WANT_UNICODE</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="wx-version-detection"></a>6.19.5. Обнаружение установленных версий</h3></div></div></div><p>Для обнаружения установленной версии вам необходимо
	задать переменную <code class="varname">WANT_WX</code>.  Если вы не
	присвоите ей определенную версию, то компоненты получат
	суффикс версии.  Переменная <code class="varname">HAVE_WX</code> будет
	заполнена после обнаружения.</p><div class="example"><a id="wx-ver-det-example"></a><div class="example-title">Пример 6.9. Обнаружение установленных версий и компонентов
	  <span class="application">wxWidgets</span></div><div class="example-contents"><p>Следующий фрагмент может быть использован в порту,
	  который использует <span class="application">wxWidgets</span>, в
	  случае если он установлен или выбран соответствующий
	  параметр.</p><pre class="programlisting">WANT_WX=	yes

.include &lt;bsd.port.pre.mk&gt;

.if defined(WITH_WX) || !empty(PORT_OPTIONS:MWX) || !empty(HAVE_WX:Mwx-2.4)
USE_WX=			2.4
CONFIGURE_ARGS+=	--enable-wx
.endif</pre><p>Следующий фрагмент может быть использован в порту,
	  который задействует поддержку
	  <span class="application">wxPython</span>, в случае если он
	  установлен или выбран соответствующий параметр, в
	  дополнение к <span class="application">wxWidgets</span>, обе
	  версии <code class="literal">2.6</code>.</p><pre class="programlisting">USE_WX=		2.6
WX_COMPS=	wx
WANT_WX=	2.6

.include &lt;bsd.port.pre.mk&gt;

.if defined(WITH_WXPYTHON) || !empty(PORT_OPTIONS:MWXPYTHON) || !empty(HAVE_WX:Mpython)
WX_COMPS+=		python
CONFIGURE_ARGS+=	--enable-wxpython
.endif</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="wx-defined-variables"></a>6.19.6. Переменные для определения</h3></div></div></div><p>Следующие переменные доступны в порту (после определения
	одной из переменных из
	<a class="xref" href="#wx-ver-sel-table" title="Таблица 6.25. Переменные для выбора версии wxWidgets">Таблица 6.25, <<Переменные для выбора версии
	  <span class="application">wxWidgets</span>>></a>).</p><div class="table"><a id="idp76503248"></a><div class="table-title">Таблица 6.33. Переменные, определенные для портов, использующих
	  <span class="application">wxWidgets</span></div><div class="table-contents"><table summary="Переменные, определенные для портов, использующих&#10;&#9;  wxWidgets" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="varname">WX_CONFIG</code></td><td>Путь к сценарию
		<span class="application">wxWidgets</span>
		<code class="command">wx-config</code> (с другим
		именем)</td></tr><tr><td><code class="varname">WXRC_CMD</code></td><td>Путь к программе
		<span class="application">wxWidgets</span>
		<code class="command">wxrc</code> (с другим именем)</td></tr><tr><td><code class="varname">WX_VERSION</code></td><td>Версия <span class="application">wxWidgets</span>,
		которая будет использоваться (например,
		<code class="literal">2.6</code>)</td></tr><tr><td><code class="varname">WX_UNICODE</code></td><td>Если не определена, но Unicode будет
		использоваться, то она будет определена</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="wx-premk"></a>6.19.7. Обработка в <code class="filename">bsd.port.pre.mk</code></h3></div></div></div><p>Если вам нужно использовать переменные для запуска команд
	сразу после подключения <code class="filename">bsd.port.pre.mk</code>,
	то вам нужно определить <code class="varname">WX_PREMK</code>.</p><div xmlns="" class="important"><h3 class="admontitle">Важно: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если вы определите <code class="varname">WX_PREMK</code>, то
	  версия, зависимости, компоненты и заданные переменные не
	  изменяться, в случае вы изменили переменные порта
	  <span class="application">wxWidgets</span>
	  <span class="emphasis"><em>после</em></span> подключения
	  <code class="filename">bsd.port.pre.mk</code>.</p></div><div class="example"><a id="wx-premk-example"></a><div class="example-title">Пример 6.10. Использование переменных
	  <span class="application">wxWidgets</span> в командах</div><div class="example-contents"><p>Следующий фрагмент иллюстрирует использование
	  переменной <code class="varname">WX_PREMK</code> посредством запуска
	  сценария <code class="command">wx-config</code> для получения строки
	  с полной версией с присвоением ее переменной и передачей в
	  программу.</p><pre class="programlisting">USE_WX=		2.4
WX_PREMK=	yes

.include &lt;bsd.port.pre.mk&gt;

.if exists(${WX_CONFIG})
VER_STR!=	${WX_CONFIG} --release

PLIST_SUB+=	VERSION="${VER_STR}"
.endif</pre></div></div><br class="example-break" /><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Переменные <span class="application">wxWidgets</span> можно
	  безопасно использовать в командах внутри целей без
	  необходимости в использовании
	  <code class="varname">WX_PREMK</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="wx-additional-config-args"></a>6.19.8. Дополнительные параметры
	<code class="command">configure</code></h3></div></div></div><p>Некоторые сценарии GNU <code class="command">configure</code> не
	могут найти <span class="application">wxWidgets</span> только с
	установленной переменной окружения
	<code class="literal">WX_CONFIG</code>, требуя дополнительные
	параметры.  Для их передачи можно использовать переменную
	<code class="varname">WX_CONF_ARGS</code>.</p><div class="table"><a id="idp76535120"></a><div class="table-title">Таблица 6.34. Допустимые значения
	  <code class="varname">WX_CONF_ARGS</code></div><div class="table-contents"><table summary="Допустимые значения&#10;&#9;  WX_CONF_ARGS" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Возможное значение</th><th>Получаемый параметр</th></tr></thead><tbody><tr><td><code class="literal">absolute</code></td><td><code class="literal">--with-wx-config=${WX_CONFIG}</code></td></tr><tr><td><code class="literal">relative</code></td><td><code class="literal">--with-wx=${LOCALBASE}
		  --with-wx-config=${WX_CONFIG:T}</code></td></tr></tbody></table></div></div><br class="table-break" /></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-lua"></a>6.20. Использование <span class="application">Lua</span></h2></div></div></div><p>Эта глава описывает статус библиотек
      <span class="application">Lua</span> в дереве портов и их интеграцию
      в систему портов.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="lua-introduction"></a>6.20.1. Введение</h3></div></div></div><p>Существует множество версий библиотек
	<span class="application">Lua</span> и соответствующих
	интерпретаторов, конфликтующих между собой (устанавливают
	файлы под тем же именем).  В дереве портов эта проблема
	решена путем установки каждой версии в собственное место с
	использованием номера версии в качестве суффикса.</p><p>Очевидным недостатком этого является необходимость
	изменения каждого приложения для нахождения искомой версии.
	Но это решается добавлением некоторых дополнительных флагов
	для компилятора и компоновщика.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="lua-version"></a>6.20.2. Выбор версии</h3></div></div></div><p>Для того, чтобы заставить ваш порт использовать
	конкретную версию <span class="application">Lua</span>, существует
	две доступные для определения переменные (если определена
	только одна, то вторая примет значение по умолчанию):</p><div class="table"><a id="lua-ver-sel-table"></a><div class="table-title">Таблица 6.35. Переменные для выбора версии
	  <span class="application">Lua</span></div><div class="table-contents"><table summary="Переменные для выбора версии&#10;&#9;  Lua" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Описание</th><th>Значение по умолчанию</th></tr></thead><tbody><tr><td><code class="varname">USE_LUA</code></td><td>Перечень версий, которые порт может
		использовать</td><td>Все доступные версии</td></tr><tr><td><code class="varname">USE_LUA_NOT</code></td><td>Перечень версий, которые порт не может
		использовать</td><td>Пусто</td></tr></tbody></table></div></div><br class="table-break" /><p>Перечень доступных версий <span class="application">Lua</span>
	и соответствующих портов в дереве:</p><div class="table"><a id="idp76559824"></a><div class="table-title">Таблица 6.36. Доступные версии
	  <span class="application">Lua</span></div><div class="table-contents"><table summary="Доступные версии&#10;&#9;  Lua" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Версия</th><th>Порт</th></tr></thead><tbody><tr><td><code class="literal">4.0</code></td><td><a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/lua4/pkg-descr">lang/lua4</a></td></tr><tr><td><code class="literal">5.0</code></td><td><a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/lua50/pkg-descr">lang/lua50</a></td></tr><tr><td><code class="literal">5.1</code></td><td><a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/lua/pkg-descr">lang/lua</a></td></tr></tbody></table></div></div><br class="table-break" /><p>Переменные из <a class="xref" href="#lua-ver-sel-table" title="Таблица 6.35. Переменные для выбора версии Lua">Таблица 6.35, <<Переменные для выбора версии
	  <span class="application">Lua</span>>></a> могут
	иметь комбинации из одного или нескольких значений,
	разделенных пробелом:</p><div class="table"><a id="idp76573008"></a><div class="table-title">Таблица 6.37. Определение версии
	  <span class="application">Lua</span></div><div class="table-contents"><table summary="Определение версии&#10;&#9;  Lua" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Описание</th><th>Пример</th></tr></thead><tbody><tr><td>Единичная версия</td><td><code class="literal">4.0</code></td></tr><tr><td>Восходящий диапазон</td><td><code class="literal">5.0+</code></td></tr><tr><td>Нисходящий диапазон</td><td><code class="literal">5.0-</code></td></tr><tr><td>Полный диапазон (обязан быть восходящим)</td><td><code class="literal">5.0-5.1</code></td></tr></tbody></table></div></div><br class="table-break" /><p>Кроме того, существует несколько переменных для выбора
	предпочитаемых версий из перечня доступных.  Они могут быть
	установлены в несколько версий, первая из которых будет иметь
	наибольший приоритет.</p><div class="table"><a id="idp76586320"></a><div class="table-title">Таблица 6.38. Переменные для выбора предпочитаемых версий
	  <span class="application">Lua</span></div><div class="table-contents"><table summary="Переменные для выбора предпочитаемых версий&#10;&#9;  Lua" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Предназначение</th></tr></thead><tbody><tr><td><code class="varname">WANT_LUA_VER</code></td><td>порт</td></tr><tr><td><code class="varname">WITH_LUA_VER</code></td><td>пользователь</td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="lua-version-example"></a><div class="example-title">Пример 6.11. Выбор версии <span class="application">Lua</span></div><div class="example-contents"><p>Следующий фрагмент взят из порта, который использует
	  <span class="application">Lua</span> версий
	  <code class="literal">5.0</code> или <code class="literal">5.1</code>, по
	  умолчанию <code class="literal">5.0</code>.  Значение может быть
	  переопределено пользователем с использованием переменной
	  <code class="varname">WITH_LUA_VER</code>.</p><pre class="programlisting">USE_LUA=	5.0-5.1
WANT_LUA_VER=	5.0</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="lua-components"></a>6.20.3. Выбор компонентов</h3></div></div></div><p>Существуют другие приложения, которые хотя и не являются
	библиотеками <span class="application">Lua</span>, но относятся к
	ним.  Эти приложения можно указать в переменной
	<code class="varname">LUA_COMPS</code>.  Доступны следующие
	компоненты:</p><div class="table"><a id="idp76598736"></a><div class="table-title">Таблица 6.39. Доступные компоненты
	  <span class="application">Lua</span></div><div class="table-contents"><table summary="Доступные компоненты&#10;&#9;  Lua" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th><th>Ограничение версии</th></tr></thead><tbody><tr><td><code class="literal">lua</code></td><td>Основная библиотека</td><td>нет</td></tr><tr><td><code class="literal">tolua</code></td><td>Библиотека доступа к коду C/C++</td><td>4.0-5.0</td></tr><tr><td><code class="literal">ruby</code></td><td>Привязка к Ruby</td><td>4.0-5.0</td></tr></tbody></table></div></div><br class="table-break" /><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Есть и другие компоненты, но они относятся к модулям
	  для интерпретатора и не используются приложениями (только
	  другими модулями).</p></div><p>Тип зависимости можно выбрать для каждого компонента
	через добавление суффикса, отделенного точкой с запятой.  В
	случае отсутствия будет использован тип по умолчанию
	(смотрите <a class="xref" href="#lua-def-dep-types" title="Таблица 6.41. Типы зависимости Lua, используемые по умолчанию">Таблица 6.41, <<Типы зависимости <span class="application">Lua</span>,
	  используемые по умолчанию>></a>).  Доступные
	следующие типы:</p><div class="table"><a id="idp76613456"></a><div class="table-title">Таблица 6.40. Доступные типы зависимости
	  <span class="application">Lua</span></div><div class="table-contents"><table summary="Доступные типы зависимости&#10;&#9;  Lua" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">build</code></td><td>Компонент требуется для построения, эквивалентен
		<code class="varname">BUILD_DEPENDS</code></td></tr><tr><td><code class="literal">run</code></td><td>Компонент требуется для запуска, эквивалентен
		<code class="varname">RUN_DEPENDS</code></td></tr><tr><td><code class="literal">lib</code></td><td>Компонент требуется для построения и запуска,
		эквивалентен <code class="varname">LIB_DEPENDS</code></td></tr></tbody></table></div></div><br class="table-break" /><p>Значения по умолчанию для компонентов подробно
	рассматриваются в следующей таблице:</p><div class="table"><a id="lua-def-dep-types"></a><div class="table-title">Таблица 6.41. Типы зависимости <span class="application">Lua</span>,
	  используемые по умолчанию</div><div class="table-contents"><table summary="Типы зависимости Lua,&#10;&#9;  используемые по умолчанию" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Компонент</th><th>Тип зависимости</th></tr></thead><tbody><tr><td><code class="literal">lua</code></td><td><code class="literal">lib</code> для
		<code class="literal">4.0-5.0</code> (динамическая) и
		<code class="literal">build</code> для <code class="literal">5.1</code>
		(статическая)</td></tr><tr><td><code class="literal">tolua</code></td><td><code class="literal">build</code> (статическая)</td></tr><tr><td><code class="literal">ruby</code></td><td><code class="literal">lib</code> (динамическая)</td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="lua-components-example"></a><div class="example-title">Пример 6.12. Выбор компонентов
	  <span class="application">Lua</span></div><div class="example-contents"><p>Следующий фрагмент соответствует порту, использующему
	  <span class="application">Lua</span> версии
	  <code class="literal">4.0</code> и привязку к
	  <span class="application">Ruby</span>.</p><pre class="programlisting">USE_LUA=	4.0
LUA_COMPS=	lua ruby</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="lua-version-detection"></a>6.20.4. Обнаружение установленных версий</h3></div></div></div><p>Для обнаружения установленной версии вам необходимо
	задать переменную <code class="varname">WANT_LUA</code>.  Если вы не
	присвоите ей определенную версию, то компоненты получат
	суффикс версии.  Переменная <code class="varname">HAVE_LUA</code> будет
	заполнена после обнаружения.</p><div class="example"><a id="lua-ver-det-example"></a><div class="example-title">Пример 6.13. Обнаружение установленных версий и компонентов
	  <span class="application">Lua</span></div><div class="example-contents"><p>Следующий фрагмент можно использовать для порта,
	  использующего <span class="application">Lua</span>, если она
	  установлена, или был выбран соответствующий
	  параметр.</p><pre class="programlisting">WANT_LUA=	yes

.include &lt;bsd.port.pre.mk&gt;

.if defined(WITH_LUA5) || !empty(PORT_OPTIONS:MLUA5) || !empty(HAVE_LUA:Mlua-5.[01])
USE_LUA=		5.0-5.1
CONFIGURE_ARGS+=	--enable-lua5
.endif</pre><p>Следующий фрагмент можно использовать для порта,
	  который включает поддержку
	  <span class="application">tolua</span>, если такой компонент
	  установлен, или был выбран соответствующий параметр в
	  дополнение к <span class="application">Lua</span>, оба имеют
	  версию <code class="literal">4.0</code>.</p><pre class="programlisting">USE_LUA=	4.0
LUA_COMPS=	lua
WANT_LUA=	4.0

.include &lt;bsd.port.pre.mk&gt;

.if defined(WITH_TOLUA) || !empty(PORT_OPTIONS:MTOLUA) || !empty(HAVE_LUA:Mtolua)
LUA_COMPS+=		tolua
CONFIGURE_ARGS+=	--enable-tolua
.endif</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="lua-defined-variables"></a>6.20.5. Переменные для определения</h3></div></div></div><p>Следующие переменные доступны в порту (после определения
	одной из переменных из
	<a class="xref" href="#lua-ver-sel-table" title="Таблица 6.35. Переменные для выбора версии Lua">Таблица 6.35, <<Переменные для выбора версии
	  <span class="application">Lua</span>>></a>).</p><div class="table"><a id="idp76651600"></a><div class="table-title">Таблица 6.42. Переменные, определенные для портов, использующих
	  <span class="application">Lua</span></div><div class="table-contents"><table summary="Переменные, определенные для портов, использующих&#10;&#9;  Lua" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="varname">LUA_VER</code></td><td>Версия <span class="application">Lua</span>, которая
		будет использоваться (например,
		<code class="literal">5.1</code>)</td></tr><tr><td><code class="varname">LUA_VER_SH</code></td><td>Старший номер версии динамической библиотеки
		<span class="application">Lua</span> (например,
		<code class="literal">1</code>)</td></tr><tr><td><code class="varname">LUA_VER_STR</code></td><td>Версия <span class="application">Lua</span> без точки
		(например, <code class="literal">51</code>)</td></tr><tr><td><code class="varname">LUA_PREFIX</code></td><td>Префикс, в который установлена
		<span class="application">Lua</span> (и компоненты)</td></tr><tr><td><code class="varname">LUA_SUBDIR</code></td><td>Каталог под <code class="filename">${PREFIX}/bin</code>,
		<code class="filename">${PREFIX}/share</code> и
		<code class="filename">${PREFIX}/lib</code>, в который
		установлена <span class="application">Lua</span></td></tr><tr><td><code class="varname">LUA_INCDIR</code></td><td>Каталог, в который установлены заголовочные
		файлы <span class="application">Lua</span> и
		<span class="application">tolua</span></td></tr><tr><td><code class="varname">LUA_LIBDIR</code></td><td>Каталог, в который установлены библиотеки
		<span class="application">Lua</span> и
		<span class="application">tolua</span></td></tr><tr><td><code class="varname">LUA_MODLIBDIR</code></td><td>Каталог, в который установлены модули библиотеки
		<span class="application">Lua</span>
		(<code class="filename">.so</code>)</td></tr><tr><td><code class="varname">LUA_MODSHAREDIR</code></td><td>Каталог, в который установлены модули
		<span class="application">Lua</span>
		(<code class="filename">.lua</code>)</td></tr><tr><td><code class="varname">LUA_PKGNAMEPREFIX</code></td><td>Префикс с именем пакета, используемый модулями
		<span class="application">Lua</span></td></tr><tr><td><code class="varname">LUA_CMD</code></td><td>Путь к интерпретатору
		<span class="application">Lua</span></td></tr><tr><td><code class="varname">LUAC_CMD</code></td><td>Путь к компилятору
		<span class="application">Lua</span></td></tr><tr><td><code class="varname">TOLUA_CMD</code></td><td>Путь к программе
		<span class="application">tolua</span></td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="lua-variables-example"></a><div class="example-title">Пример 6.14. Указание для порта, где искать
	  <span class="application">Lua</span></div><div class="example-contents"><p>Следующий фрагмент показывает, как сообщить порту,
	  который использует сценарий configure, где расположены
	  заголовочные файлы и библиотеки
	  <span class="application">Lua</span>.</p><pre class="programlisting">USE_LUA=	4.0
GNU_CONFIGURE=	yes
CONFIGURE_ENV=	CPPFLAGS="-I${LUA_INCDIR}" LDFLAGS="-L${LUA_LIBDIR}"</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="lua-premk"></a>6.20.6. Обработка в <code class="filename">bsd.port.pre.mk</code></h3></div></div></div><p>Если вам нужно использовать переменные для запуска команд
	сразу после подключения <code class="filename">bsd.port.pre.mk</code>,
	для этого вам нужно определить переменную
	<code class="varname">LUA_PREMK</code>.</p><div xmlns="" class="important"><h3 class="admontitle">Важно: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если вы задаете <code class="varname">LUA_PREMK</code>, то
	  версия, зависимости, компоненты и уже заданные переменные
	  не будут изменены, в случае если вы изменили переменные
	  порта <span class="application">Lua</span>
	  <span class="emphasis"><em>после</em></span> подключения
	  <code class="filename">bsd.port.pre.mk</code>.</p></div><div class="example"><a id="lua-premk-example"></a><div class="example-title">Пример 6.15. Использование переменных
	  <span class="application">Lua</span> в командах</div><div class="example-contents"><p>Следующий фрагмент иллюстрирует использование
	  <code class="varname">LUA_PREMK</code> посредством запуска
	  интерпретатора <span class="application">Lua</span> для того,
	  чтобы получить строку с полной версией, сохранить ее в
	  переменную и передать программе.</p><pre class="programlisting">USE_LUA=	5.0
LUA_PREMK=	yes

.include &lt;bsd.port.pre.mk&gt;

.if exists(${LUA_CMD})
VER_STR!=	${LUA_CMD} -v

CFLAGS+=	-DLUA_VERSION_STRING="${VER_STR}"
.endif</pre></div></div><br class="example-break" /><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Переменные <span class="application">Lua</span> можно
	  безопасно использовать в командах внутри целей без
	  необходимости в использовании
	  <code class="varname">LUA_PREMK</code>.</p></div></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-iconv"></a>6.21. Использование <code class="command">iconv</code></h2></div></div></div><p>После 10-08-2013 (<a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254273"><span class="svnref">254273</span></a>) в составе
      FreeBSD  10-CURRENT и более новых версий имеется собственный
      <code class="command">iconv</code>.  В более ранних версиях
      дополнительной зависимостью выступал
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/converters/libiconv/pkg-descr">converters/libiconv</a>.</p><p>Для программного обеспечения, которому нужен
      <code class="command">iconv</code>, определите
      <code class="literal">USES=iconv</code>.  Версии FreeBSD до 10-CURRENT от
      13-08-2013 (<a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254273"><span class="svnref">254273</span></a>) не имеют
      собственного <code class="command">iconv</code>.  На этих более ранных
      версиях будет автоматически добавлена зависимость от
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/converters/libiconv/pkg-descr">converters/libiconv</a>.</p><p>Когда порт задаёт <code class="literal">USES=iconv</code>, становятся
      доступными следующие переменные:</p><div class="informaltable"><table border="0"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>Имя переменной</th><th>Назначение</th><th>Значение до FreeBSD 10-CURRENT
	      <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254273"><span class="svnref">254273</span></a> (13-08-2013)</th><th>Значение после FreeBSD 10-CURRENT
	      <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254273"><span class="svnref">254273</span></a> (13-08-2013)</th></tr></thead><tbody><tr><td><code class="varname">ICONV_CMD</code></td><td>Каталог размещения двоичного файла
	      <code class="command">iconv</code></td><td><code class="literal">${LOCALBASE}/bin/iconv</code></td><td><code class="filename">/usr/bin/iconv</code></td></tr><tr><td><code class="varname">ICONV_LIB</code></td><td>Аргумент <code class="command">ld</code> для компоновки с
	      <code class="filename">libiconv</code> (если нужно)</td><td><code class="literal">-liconv</code></td><td>(пусто)</td></tr><tr><td><code class="varname">ICONV_PREFIX</code></td><td>Каталог размещения реализации
	      <code class="command">iconv</code> (используется для сценариев
	      конфигурации)</td><td><code class="literal">${LOCALBASE}</code></td><td><code class="filename">/usr</code></td></tr><tr><td><code class="varname">ICONV_CONFIGURE_ARG</code></td><td>Параметр предварительно собранной конфигурации для
	      сценариев конфигурации</td><td><code class="literal">--with-libiconv-prefix=${LOCALBASE}</code></td><td>(пусто)</td></tr><tr><td><code class="varname">ICONV_CONFIGURE_BASE</code></td><td>Параметр предварительно собранной конфигурации для
	      сценариев конфигурации</td><td><code class="literal">--with-libiconv=${LOCALBASE}</code></td><td>(пусто)</td></tr></tbody></table></div><p>В следующих двух примерах демонстрируется автоматическое
      присвоение переменным правильных значений для систем,
      использующих <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/converters/libiconv/pkg-descr">converters/libiconv</a>
      или собственный <code class="command">iconv</code>.</p><div class="example"><a id="iconv-simple-use"></a><div class="example-title">Пример 6.16. Простое использование <code class="command">iconv</code></div><div class="example-contents"><pre class="programlisting">USES=		iconv
LDFLAGS+=	-L${LOCALBASE}/lib ${ICONV_LIB}</pre></div></div><br class="example-break" /><div class="example"><a id="iconv-configure-use"></a><div class="example-title">Пример 6.17. Использование <code class="command">iconv</code> с
	<code class="command">configure</code></div><div class="example-contents"><pre class="programlisting">USES=		iconv
CONFIGURE_ARGS+=${ICONV_CONFIGURE_ARG}</pre></div></div><br class="example-break" /><p>Как показано выше, <code class="varname">ICONV_LIB</code> имеет
      пустое значение с собственным <code class="command">iconv</code>.  Эту
      особенность можно использовать для обнаружения собственного
      <code class="command">iconv</code> с соответствующими действиями.</p><p>Иногда в программе параметр <code class="command">ld</code> или путь
      поиска жёстко заданы в <code class="filename">Makefile</code> или
      сценарии конфигурации.  Для решения этой проблемы можно
      использовать следующий подход:</p><div class="example"><a id="iconv-reinplace"></a><div class="example-title">Пример 6.18. Исправление жёстко заданного
	<code class="literal">-liconv</code></div><div class="example-contents"><pre class="programlisting">USES=		iconv

post-patch:
	@${REINPLACE_CMD} -e 's/-liconv/${ICONV_LIB}/' ${WRKSRC}/Makefile</pre></div></div><br class="example-break" /><p>В некоторых случаях необходимо установить альтернативные
      значения или выполнить операции в случае использования
      собственного <code class="command">iconv</code>.  Перед проверкой
      значения <code class="varname">ICONV_LIB</code> обязан быть подключён
      <code class="filename">bsd.port.pre.mk</code>:</p><div class="example"><a id="iconv-conditional"></a><div class="example-title">Пример 6.19. Проверка доступности собственного
	<code class="command">iconv</code></div><div class="example-contents"><pre class="programlisting">USES=		iconv

.include &lt;bsd.port.pre.mk&gt;

post-patch:
.if empty(ICONV_LIB)
	# обнаружен собственный iconv
	@${REINPLACE_CMD} -e 's|iconv||' ${WRKSRC}/Config.sh
.endif

.include &lt;bsd.port.post.mk&gt;</pre></div></div><br class="example-break" /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-xfce"></a>6.22. Использование Xfce</h2></div></div></div><p>Переменная <code class="varname">USE_XFCE</code> используется для
      автоматической конфигурации зависимостей для портов,
      использующих библиотеки или приложения на основе Xfce, такие
      как <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/libxfce4gui/pkg-descr">x11-toolkits/libxfce4gui</a> и
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-wm/xfce4-panel/pkg-descr">x11-wm/xfce4-panel</a>.</p><p>В настоящее время распознаются следующие библиотеки и
      приложения Xfce:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>libexo: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11/libexo/pkg-descr">x11/libexo</a></p></li><li class="listitem"><p>libgui: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/libxfce4gui/pkg-descr">x11-toolkits/libxfce4gui</a></p></li><li class="listitem"><p>libutil: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11/libxfce4util/pkg-descr">x11/libxfce4util</a></p></li><li class="listitem"><p>libmcs: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11/libxfce4mcs/pkg-descr">x11/libxfce4mcs</a></p></li><li class="listitem"><p>mcsmanager: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/sysutils/xfce4-mcs-manager/pkg-descr">sysutils/xfce4-mcs-manager</a></p></li><li class="listitem"><p>panel: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-wm/xfce4-panel/pkg-descr">x11-wm/xfce4-panel</a></p></li><li class="listitem"><p>thunar: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-fm/thunar/pkg-descr">x11-fm/thunar</a></p></li><li class="listitem"><p>wm: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-wm/xfce4-wm/pkg-descr">x11-wm/xfce4-wm</a></p></li><li class="listitem"><p>xfdev: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/dev/xfce4-dev-tools/pkg-descr">dev/xfce4-dev-tools</a></p></li></ul></div><p>Распознаются следующие дополнительные параметры:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>configenv: Используйте, если ваш порт требует
	  специально измененного значения
	  <code class="varname">CONFIGURE_ENV</code> для поиска требуемых для
	  порта библиотек.</p><pre class="programlisting">-I${LOCALBASE}/include -L${LOCALBASE}/lib</pre><p>добавляется в CPPFLAGS к
	  <code class="varname">CONFIGURE_ENV</code>.</p></li></ul></div><p>Следовательно, если у порта имеется зависимость от <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/sysutils/xfce4-mcs-manager/pkg-descr">sysutils/xfce4-mcs-manager</a>, и порт
      требует специальных CPPFLAGS в своем окружении configure, то
      синтаксис будет следующим:</p><pre class="programlisting">USE_XFCE=	mcsmanager configenv</pre></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-mozilla"></a>6.23. Использование Mozilla</h2></div></div></div><div class="table"><a id="idp76841680"></a><div class="table-title">Таблица 6.43. Переменные для портов, использующих Mozilla</div><div class="table-contents"><table summary="Переменные для портов, использующих Mozilla" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USE_GECKO</code></td><td>Один из бэкэндов Gecko, с которым может работать
	      порт.  Возможные значения: <code class="literal">libxul</code>
	      (<code class="filename">libxul.so</code>),
	      <code class="literal">seamonkey</code>
	      (<code class="filename">libgtkembedmoz.so</code>, устаревший,
	      больше не должен использоваться).</td></tr><tr><td><code class="varname">USE_FIREFOX</code></td><td>Для запуска порта требуется Firefox.  Возможные
	      значения: <code class="literal">yes</code> (версия по умолчанию),
	      <code class="literal">40</code>, <code class="literal">36</code>,
	      <code class="literal">35</code>.  По умолчанию устанавливает
	      зависимость от версии <code class="literal">40</code>.</td></tr><tr><td><code class="varname">USE_FIREFOX_BUILD</code></td><td>Для построения порта требуется Firefox.  Возможные
	      значения: смотрите USE_FIREFOX.  Автоматически
	      устанавливает USE_FIREFOX с присвоением того же
	      значения.</td></tr><tr><td><code class="varname">USE_SEAMONKEY</code></td><td>Для запуска порта требуется SeaMonkey.  Возможные
	      значения: <code class="literal">yes</code> (версия по умолчанию),
	      <code class="literal">20</code>, <code class="literal">11</code> (устарело,
	      больше не должно использоваться).  По умолчанию
	      устанавливает зависимость от версии
	      <code class="literal">20</code>.</td></tr><tr><td><code class="varname">USE_SEAMONKEY_BUILD</code></td><td>Для построения порта требуется SeaMonkey.
	      Возможные значения: смотрите USE_SEAMONKEY.
	      Автоматически устанавливает USE_SEAMONKEY с присвоением
	      того же значения.</td></tr><tr><td><code class="varname">USE_THUNDERBIRD</code></td><td>Для запуска порта требуется Thunderbird.
	      Возможные значения: <code class="literal">yes</code> (версия по
	      умолчанию), <code class="literal">31</code>,
	      <code class="literal">30</code> (устарело, больше не должно
	      использоваться).  По умолчанию устанавливает
	      зависимость от версии <code class="literal">31</code>.</td></tr><tr><td><code class="varname">USE_THUNDERBIRD_BUILD</code></td><td>Для построения порта требуется Thunderbird.
	      Возможные значения: смотрите USE_THUNDERBIRD.
	      Автоматически устанавливает USE_THUNDERBIRD с
	      присвоением того же значения.</td></tr></tbody></table></div></div><br class="table-break" /><p>Полный перечень доступных переменных можно получить в файле
      <code class="filename">/usr/ports/Mk/bsd.gecko.mk</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-databases"></a>6.24. Использование баз данных</h2></div></div></div><div class="table"><a id="idp76865104"></a><div class="table-title">Таблица 6.44. Переменные для портов, использующих базы данных</div><div class="table-contents"><table summary="Переменные для портов, использующих базы данных" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение</th></tr></thead><tbody><tr><td><code class="varname">USE_BDB</code></td><td>Если переменная установлена в
	      <code class="literal">yes</code>, добавляет зависимость от порта
	      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/databases/db41/pkg-descr">databases/db41</a>.  Также
	      переменной можно присвоить значения: 2, 3, 40, 41, 42,
	      43, 44, 46, 47, 48 или 51.  Вы можете объявить диапазон
	      принимаемых значений, <code class="varname">USE_BDB</code>=42+
	      будет искать установленную версию с наибольшим номером,
	      и, если ничего не установлено, вернется к 42.</td></tr><tr><td><code class="varname">USE_MYSQL</code></td><td>Если переменная установлена в
	      <code class="literal">yes</code>, добавляет зависимость от порта
	      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/databases/mysql55-client/pkg-descr">databases/mysql55-client</a>.  Как
	      связанная переменная, <code class="varname">WANT_MYSQL_VER</code>
	      может быть установлена в значение 323, 40, 41, 50, 51,
	      52, 55 или 60.</td></tr><tr><td><code class="varname">USE_PGSQL</code></td><td>Если установлена в <code class="literal">yes</code>,
	      добавляет зависимость от порта <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/databases/postgresql90-client/pkg-descr">databases/postgresql90-client</a>.
	      Как связанная переменная,
	      <code class="varname">WANT_PGSQL_VER</code> может быть
	      установлена в значение 83, 84, 90, 91 или 92.  Вы
	      можете указать максимальное и минимальное значения;
	      <code class="varname">WANT_PGSQL_VER</code>=
	      <code class="literal"> 90+</code> сделает порт зависимым от
	      минимальной версии 9.0.</td></tr><tr><td><code class="varname">USE_SQLITE</code></td><td>Если переменная имеет значение
	      <code class="literal">yes</code>, добавляет зависимость от порта
	      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/databases/sqlite3/pkg-descr">databases/sqlite3</a>.
	      Переменная может принимать значения: 3, 2.</td></tr></tbody></table></div></div><br class="table-break" /><p>Подробнее смотрите в <a class="link" href="http://svnweb.FreeBSD.org/ports/head/Mk/bsd.database.mk?view=markup" target="_top">bsd.database.mk</a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="rc-scripts"></a>6.25. Запуск и остановка служб (сценарии
      <code class="literal">rc</code>)</h2></div></div></div><p>Сценарии <code class="filename">rc.d</code> используются для запуска
      служб при запуске системы и дают администратору стандартный
      способ остановки, запуска и перезапуска службы.  Порты
      интегрируются в системную инфраструктуру
      <code class="filename">rc.d</code>.  Подробности по её использованию
      можно найти в <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/configtuning-rcd.html" target="_top">главе
	rc.d Руководства</a>.  Подробное объяснение доступных
      команд находится в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a> и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.subr&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc.subr</span>(8)</span></a>.  Наконец, есть
      <a class="link" href="../../../../doc/ru_RU.KOI8-R/articles/rc-scripting" target="_top">статья</a>о
      практических аспектах написания сценариев
      <code class="filename">rc.d</code>.</p><p>Установить можно один или более сценариев
      <code class="filename">rc.d</code>:</p><pre class="programlisting">USE_RC_SUBR=	doormand</pre><p>Сценарии обязаны размещаться в подкаталоге
      <code class="filename">files</code> с обязательным добавлением суффикса
      <code class="literal">.in</code> к имени файла.  Для этого файла будут
      использоваться стандартные расширения
      <code class="varname">SUB_LIST</code>.  Также особенно приветствуется
      использование расширений <code class="literal">%%PREFIX%%</code> и
      <code class="literal">%%LOCALBASE%%</code>.  Подробнее о
      <code class="varname">SUB_LIST</code> в <a class="link" href="#using-sub-files" title="8.5. Использование SUB_FILES и SUB_LIST">соответствующей
	главе</a>.</p><p>Начиная с FreeBSD 6.1-RELEASE локальные сценарии
      <code class="filename">rc.d</code> (включая установленные из портов)
      включены в общий <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcorder&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rcorder</span>(8)</span></a> основной системы.</p><p>Пример простого сценария <code class="filename">rc.d</code>:</p><pre class="programlisting">#!/bin/sh

# $FreeBSD$
#
# PROVIDE: doormand
# REQUIRE: LOGIN
# KEYWORD: shutdown
#
# Add the following lines to /etc/rc.conf.local or /etc/rc.conf
# to enable this service:
#
# doormand_enable (bool):	Set to NO by default.
#				Set it to YES to enable doorman.
# doormand_config (path):	Set to %%PREFIX%%/etc/doormand/doormand.cf
#				by default.

. /etc/rc.subr

name=doormand
rcvar=doormand_enable

load_rc_config $name

: ${doormand_enable:="NO"}
: ${doormand_config="%%PREFIX%%/etc/doormand/doormand.cf"}

command=%%PREFIX%%/sbin/${name}
pidfile=/var/run/${name}.pid

command_args="-p $pidfile -f $doormand_config"

run_rc_command "$1"</pre><p>Если нет стоящей причины запускать службы раньше всех
      портов, сценарии должны использовать</p><pre class="programlisting">REQUIRE: LOGIN</pre><p>Если служба работает под определенным пользователем
      (отличным от root), то это делается принудительно.  В сценарий
      выше включена конструкция</p><pre class="programlisting">KEYWORD: shutdown</pre><p>потому что вымышленный порт, который мы используем в
      качестве примера, запускает службу, и она должна корректно
      завершиться при выключении системы.  Если сценарий не запускает
      постоянную службу, то это не является необходимым.</p><p>Для необязательных элементов конфигурации присвоение
      переменной по умолчанию в стиле "=" является более
      предпочтительным по сравнению со стилем ":=",
      используемым здесь, поскольку первый устанавливает значение по
      умолчанию только если переменная не установлена, а последний
      устанавливает её, если переменная не установлена
      <span class="emphasis"><em>или</em></span> обнулена.  Пользователь вполне может
      написать в своем файле <code class="filename">rc.conf.local</code>
      что-нибудь типа</p><pre class="programlisting">doormand_flags=""</pre><p>и тогда произойдет неуместная подстановка переменной с
      использованием ":=", что переопределит намерения
      пользователя.  Переменная <code class="literal">_enable</code> является
      обязательной; значением по умолчанию должно быть
      ":".</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp76905424"></a>6.25.1. Контрольный список перед внесением изменений</h3></div></div></div><p>Перед тем, как отсылать порт со сценарием
	<code class="filename">rc.d</code>, и тем более перед его коммитом,
	сверьтесь со следующим контрольным списком, чтобы убедиться,
	что порт для этого готов.</p><p>Большинство из этих проверок умеет выполнять порт
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/rclint/pkg-descr">devel/rclint</a>, но это не
	является заменой надлежащему просмотру.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Если это новый файл, заканчивается ли он на
	    <code class="filename">.sh</code>?  Если это так, то имя файла
	    должно быть изменено на <code class="filename">file.in</code>,
	    поскольку файлы <code class="filename">rc.d</code> не могут
	    оканчиваться на такое расширение.</p></li><li class="step"><p>Присутствует ли в файле тег
	    <code class="literal">$FreeBSD$</code>?</p></li><li class="step"><p>Соответствуют ли друг другу имя файла
	    (без <code class="filename">.in</code>), строка
	    <code class="literal">PROVIDE</code> и
	    <code class="literal">$</code><em class="replaceable"><code>name</code></em>?
	    Имя файла, совпадающее с <code class="literal">PROVIDE</code>,
	    упрощает отладку, особенно для проблем, связанных с
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcorder&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rcorder</span>(8)</span></a>.  Соответствие имени файла и
	    <code class="literal">$</code><em class="replaceable"><code>name</code></em>
	    также упрощает понимание, какие переменные имеют
	    отношение к сценарию в
	    <code class="filename">rc.conf[.local]</code>.  Последнее также
	    является тем, что вы могли бы назвать
	    "политикой" для всех новых сценариев, включая
	    те, что входят в базовую систему.</p></li><li class="step"><p>Содержит ли строка <code class="literal">REQUIRE</code>
	    значение LOGIN?  Это условие обязательно для сценариев,
	    работающих не из-под суперпользователя.  Если сценарий
	    запускается из-под суперпользователя, то стоит ли его
	    запускать до <code class="literal">LOGIN</code>?  Если нет, то его
	    следует запускать после, так чтобы мы могли свободно
	    сгруппировать локальные сценарии в той точке
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcorder&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rcorder</span>(8)</span></a>, когда почти все сценарии в базовой
	    системе уже стартовали.</p></li><li class="step"><p>Запускает ли сценарий постоянную службу?  Если да, то
	    он должен иметь <code class="literal">KEYWORD:
	      shutdown</code>.</p></li><li class="step"><p>Убедитесь в том, что в сценарии отсутствует
	    <code class="literal">KEYWORD: FreeBSD</code>.  Это перестало быть
	    нужным и нежелательно уже много лет.  Это также служит
	    индикатором того, что новый сценарий был скопирован со
	    старого, поэтому особое внимание должно быть уделено при
	    проверке.</p></li><li class="step"><p>Если сценарий использует интерпретируемый язык, такой
	    как <code class="command">perl</code>, <code class="command">python</code>
	    или <code class="command">ruby</code>, то убедитесь, что значение
	    <code class="varname">command_interpreter</code> установлено
	    должным образом.  В противном случае</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service name stop</code></strong></pre><p>возможно будет работать неправильно.  Смотрите
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=service&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">service</span>(8)</span></a> для дополнительной информации.</p></li><li class="step"><p>Все ли вхождения <code class="filename">/usr/local</code> были
	    заменены на <code class="literal">%%PREFIX%%</code>?</p></li><li class="step"><p>Идет ли присвоение переменным значений по умолчанию
	    после <code class="function">load_rc_config</code>?</p></li><li class="step"><p>Используются ли пустые строки при присвоении значений
	    по умолчанию?  Такие присвоения должны быть удалены, но
	    перепроверьте, что эти параметры задокументированы в
	    комментариях в начале файла.</p></li><li class="step"><p>Действительно ли в сценариях используются значения,
	    присвоенные переменным?</p></li><li class="step"><p>Являются ли параметры по умолчанию, перечисленные в
	    <em class="replaceable"><code>name</code></em><code class="varname">_flags</code>,
	    обязательными?  Если это так, то их следует поместить в
	    <code class="varname">command_args</code>.  Параметр
	    <code class="option">-d</code> здесь - это как красный флаг (прошу
	    прощения за каламбур), поскольку обычно он применяется
	    для "демонизации" процесса и поэтому на самом
	    деле обязательный.</p></li><li class="step"><p>Никогда не включайте переменную
	    <em class="replaceable"><code>name</code></em><code class="varname">_flags</code>
	    в <code class="varname">command_args</code> (и наоборот; в прочем,
	    такая ошибка встречается реже).</p></li><li class="step"><p>Запускает ли сценарий какой-либо код безусловно?  Это
	    нехорошо.  Обычно такие вещи могут/должны помещаться в
	    <code class="function">start_precmd</code>.</p></li><li class="step"><p>Все логические условия должны использовать функцию
	    <code class="function">checkyesno</code>.  Не пишите самописных
	    проверок для <code class="literal">[Yy][Ee][Ss]</code>, и так
	    далее.</p></li><li class="step"><p>Если в сценарии выполняется цикл (например, ожидание
	    чего-либо перед стартом), используется ли счетчик для
	    завершения цикла?  Мы не хотим бесконечного ожидания
	    загрузки в случае возникновения ошибки.</p></li><li class="step"><p>Создает ли сценарий файлы или каталоги, которым нужны
	    особые права доступа?  Например, файл
	    <code class="filename">pid</code>, который должен принадлежать
	    пользователю, из-под которого запускается процесс.
	    Вместо традиционных команд
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=touch&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">touch</span>(1)</span></a>/<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chown&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">chown</span>(8)</span></a>/<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chmod&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">chmod</span>(1)</span></a> подумайте об
	    использовании <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=install&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">install</span>(1)</span></a> с подходящими аргументами
	    командной строки, для того чтобы выполнить всю процедуру
	    за один шаг.</p></li></ol></div></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="users-and-groups"></a>6.26. Добавление пользователей и групп</h2></div></div></div><p>Некоторые порты требуют в установленной системе наличие
      определенного пользователя.  Выберите свободный UID в диапазоне
      от 50 до 999 и зарегистрируйте его в
      <code class="filename">ports/UIDs</code> (для пользователей) и/или в
      <code class="filename">ports/GIDs</code> (для групп).  Удостоверьтесь,
      что не используете UID, уже используемый системой или другими
      портами.</p><p>Пожалуйста, включите в патч изменение для этих двух файлов,
      если вам требуется создать нового пользователя или группу для
      вашего порта.</p><p>Затем вы сможете использовать в вашем
      <code class="filename">Makefile</code> переменные
      <code class="varname">USERS</code> и <code class="varname">GROUPS</code>, и
      пользователь автоматически создастся при установке
      порта.</p><pre class="programlisting">USERS=	pulse
GROUPS=	pulse pulse-access pulse-rt</pre><p>Текущий перечень зарезервированных UID и GID находится в
      <code class="filename">ports/UIDs</code> и
      <code class="filename">ports/GIDs</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="requiring-kernel-sources"></a>6.27. Порты, требующие наличия исходных текстов ядра</h2></div></div></div><p>Некоторым портам (таким как загружаемые модули ядра) для
      компиляции нужны файлы с исходными текстами ядра.  Ниже указан
      корректный способ определения, установлены ли они
      пользователем:</p><pre class="programlisting">USES=	kmod</pre><p>Кроме этой проверки, <code class="literal">kmod</code> заботится о
      большинстве пунктов, которые должны учитываться в этих
      портах.</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="plist"></a>Глава 7. Продвинутые практики <code class="filename">pkg-plist</code></h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#plist-sub">7.1. Изменение содержимого <code class="filename">pkg-plist</code> в
      зависимости от make-переменных</a></span></dt><dt><span class="sect1"><a href="#plist-cleaning">7.2. Пустые каталоги</a></span></dt><dt><span class="sect1"><a href="#plist-config">7.3. Конфигурационные файлы</a></span></dt><dt><span class="sect1"><a href="#plist-dynamic">7.4. Динамический или статический список упаковки</a></span></dt><dt><span class="sect1"><a href="#plist-autoplist">7.5. Автоматическое создание списка упаковки</a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="plist-sub"></a>7.1. Изменение содержимого <code class="filename">pkg-plist</code> в
      зависимости от make-переменных</h2></div></div></div><p>Некоторые порты, в частности, порты <code class="literal">p5-</code>,
      должны менять содержимое своих файлов
      <code class="filename">pkg-plist</code> в зависимости от того, с какими
      параметрами они были отконфигурированы (или в зависимости от
      версии языка <code class="literal">perl</code> в случае портов
      <code class="literal">p5-</code>).  Чтобы облегчить этот процесс, любые
      вхождения ключевых слов <code class="literal">%%OSREL%%</code>,
      <code class="literal">%%PERL_VER%%</code> и
      <code class="literal">%%PERL_VERSION%%</code> в файле
      <code class="filename">pkg-plist</code> будут заменяться
      соответствующими значениями.  Значением
      <code class="literal">%%OSREL%%</code> является номер версии операционной
      системы (например, <code class="literal">4.9</code>).
      <code class="literal">%%PERL_VERSION%%</code> и
      <code class="literal">%%PERL_VER%%</code> обозначают полный номер версии
      <code class="command">perl</code> (например, <code class="literal">5.8.9</code>).
      Некоторые другие <code class="literal">%%VARS%%</code>, имеющие отношение
      к файлам документации порта, описаны в <a class="link" href="#install-documentation" title="5.15.4. Установка дополнительной документации">соответствующем
	разделе</a>.</p><p>Если вам нужно сделать другие подстановки, вы можете
      указать в переменной <code class="varname">PLIST_SUB</code> список пар
      <code class="literal">VAR=VALUE</code>, и все вхождения
      <code class="literal">%%VAR%%</code> в файле
      <code class="filename">pkg-plist</code> будут заменяться на значение
      <em class="replaceable"><code>VALUE</code></em>.</p><p>Например, если у вас имеется порт, который устанавливает
      много файлов в каталог, зависящий от версии, вы можете задать
      нечто типа</p><pre class="programlisting">OCTAVE_VERSION=	2.0.13
PLIST_SUB=	OCTAVE_VERSION=${OCTAVE_VERSION}</pre><p>в файле <code class="filename">Makefile</code> и использовать
      <code class="literal">%%OCTAVE_VERSION%%</code> везде, где нужно указать
      номер версии в файле <code class="filename">pkg-plist</code>.  Таким
      образом, при обновлении порта вам не нужно будет менять десятки
      (а в некоторых случаях и сотни) строк в файле
      <code class="filename">pkg-plist</code>.</p><p>Если ваш порт устанавливает файлы в соответствии с
      установленными в порту опциями, то обычным способом управления
      является добавление префиксов <code class="literal">%%TAG%%</code> для
      строк <code class="filename">pkg-plist</code> с добавлением этого
      <code class="literal">TAG</code> в переменную
      <code class="varname">PLIST_SUB</code> внутри
      <code class="filename">Makefile</code> со специальным значением
      <code class="literal">@comment</code>, которое указывает пакетным
      инструментам игнорировать эти строки:</p><pre class="programlisting">.if defined(WITH_X11)
PLIST_SUB+=	X11=""
.else
PLIST_SUB+=	X11="@comment "
.endif</pre><p>и в самом <code class="filename">pkg-plist</code>:</p><pre class="programlisting">%%X11%%bin/foo-gui</pre><p>Эта подстановка будет сделана между выполнением целей
      <code class="buildtarget">pre-install</code> и
      <code class="buildtarget">do-install</code>, посредством чтения файла
      <code class="filename">PLIST</code> и записью в файл
      <code class="filename">TMPPLIST</code> (по умолчанию это файл
      <code class="filename">WRKDIR/.PLIST.mktmp</code>).  Так что если ваш
      порт строит <code class="filename">PLIST</code> на лету, делайте это во
      время или до выполнения цели
      <code class="buildtarget">pre-install</code>.  Кроме того, если
      вашему порту требуется отредактировать получающийся файл,
      делайте это в цели <code class="buildtarget">post-install</code>
      изменением файла <code class="filename">TMPPLIST</code>.</p><p>Другой способ изменения списка сборки порта основан на
      определении значений переменных <code class="varname">PLIST_FILES</code>,
      <code class="varname">PLIST_DIRS</code> и
      <code class="varname">PLIST_DIRSTRY</code>.  Каждое из них
      рассматривается как перечень путей для записи в
      <code class="filename">TMPPLIST</code> содержимого
      <code class="filename">PLIST</code>.  Имена, перечисленные в
      <code class="varname">PLIST_FILES</code>, <code class="varname">PLIST_DIRS</code> и
      <code class="varname">PLIST_DIRSTRY</code> подвергаются подстановке
      <code class="literal">%%VAR%%</code>, как описано выше.  За исключением
      этого, имена из <code class="varname">PLIST_FILES</code> будут появляться
      в окончательном варианте перечня сборки без изменений, тогда
      как <code class="literal">@dirrm</code> и <code class="literal">@dirrmtry</code>
      будут соответственно предшествовать именам из
      <code class="varname">PLIST_DIRS</code> и
      <code class="varname">PLIST_DIRSTRY</code>.  Для того чтобы изменения
      вступили в силу, <code class="varname">PLIST_FILES</code>,
      <code class="varname">PLIST_DIRS</code> и
      <code class="varname">PLIST_DIRSTRY</code> должны задаваться до того, как
      будет записываться <code class="filename">TMPPLIST</code>, то есть в
      цели <code class="buildtarget">pre-install</code> или ещё
      раньше.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="plist-cleaning"></a>7.2. Пустые каталоги</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="plist-dir-cleaning"></a>7.2.1. Очистка пустых каталогов</h3></div></div></div><p>Заставьте ваш порты удалять пустые каталоги при удалении.
	Обычно это достигается добавлением строк
	<code class="literal">@dirrm</code> для всех каталогов, которые
	создаются этим портом.  Вам нужно удалить подкаталоги до
	того, как вы сможете удалить родительские каталоги.</p><pre class="programlisting"> :
lib/X11/oneko/pixmaps/cat.xpm
lib/X11/oneko/sounds/cat.au
 :
@dirrm lib/X11/oneko/pixmaps
@dirrm lib/X11/oneko/sounds
@dirrm lib/X11/oneko</pre><p>Однако, иногда <code class="literal">@dirrm</code> будет выдавать
	ошибки, потому что другие порты используют тот же самый
	подкаталог.  Вы можете использовать
	<code class="literal">@dirrmtry</code> для удаления только пустых
	каталогов без выдачи предупреждений.</p><pre class="programlisting">@dirrmtry share/doc/gimp</pre><p>Эта команда не выведет никаких сообщений об ошибках и не
	вызовет аварийного завершения работы
	<code class="command">pkg delete</code> (см. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg-delete&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pkg-delete</span>(8)</span></a>), даже
	если каталог <code class="filename">${PREFIX}/share/doc/gimp</code>
	не пуст из-за того, что другие порты установили сюда какие-то
	файлы.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="plist-dir-empty"></a>7.2.2. Создание пустых каталогов</h3></div></div></div><p>Пустым каталогам, создаваемым во время установки порта,
	нужно особое внимание.  Они не будут созданы при установке
	пакета, потому что пакеты содержат только файлы, а
	<code class="command">pkg add</code> и <code class="command">pkg install</code>
	создают для них каталоги по мере надобности.  Чтобы
	убедиться, что пустой каталог создается при установке пакета,
	добавьте эту строку в <code class="filename">pkg-plist</code> перед
	соответствующей строкой <code class="literal">@dirrm</code>:</p><pre class="programlisting">@exec mkdir -p %D/share/foo/templates</pre></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="plist-config"></a>7.3. Конфигурационные файлы</h2></div></div></div><p>Если ваш порт устанавливает конфигурационные файлы в
      каталог <code class="filename">PREFIX/etc</code> (или куда-то еще),
      <span class="emphasis"><em>не</em></span> делайте их простого перечисления в
      файле <code class="filename">pkg-plist</code>.  Это приведёт к тому, что
      по команде <code class="command">pkg delete</code> или при новой
      установке файлы, тщательно отредактированные и настроенные
      пользователем, будут уничтожены.</p><p>Вместо этого установите файл(ы) с примерами с расширением
      <code class="filename">filename.sample</code>.  Затем скопируйте файл с
      примером на место настоящего файла конфигурации, если таковой
      ещё не существует.  При деинсталляции удаляйте файл
      конфигурации только в том случае, если он идентичен файлу с
      расширением <code class="filename">.sample</code>.  Вам нужно управлять
      этим в <code class="filename">Makefile</code> и в
      <code class="filename">pkg-plist</code> (для установки из
      пакета).</p><p>Пример части <code class="filename">Makefile</code>:</p><pre class="programlisting">post-install:
	@if [ ! -f ${PREFIX}/etc/orbit.conf ]; then \
	${CP} -p ${PREFIX}/etc/orbit.conf.sample ${STAGEDIR}${PREFIX}/etc/orbit.conf ; \
	fi</pre><p>Добавьте по три строки в <code class="filename">pkg-plist</code> для
      каждого конфигурационного файла, как показано ниже:</p><pre class="programlisting">@unexec if cmp -s %D/etc/orbit.conf.sample %D/etc/orbit.conf; then rm -f %D/etc/orbit.conf; fi
etc/orbit.conf.sample
@exec if [ ! -f %D/etc/orbit.conf ] ; then cp -p %D/%F %B/orbit.conf; fi</pre><p>Данные строки являются упорядоченными.  На этапе удаления
      файл с примером сравнивается с рабочим конфигурационным файлом.
      Полное совпадение означает отсутствие каких-либо изменений в
      рабочем файле со стороны пользователя, и следовательно этот
      файл может быть безопасно удалён.  Так как файл с примером всё
      ещё должен существовать для сравнения, строка
      <code class="literal">@unexec</code> следует перед именем файла с
      примером конфигурации.  На этапе установки, если рабочий файл
      конфигурации отсутствует, он копируется из файла с примером.
      Файл с примером обязательно должен быть установлен до операции
      копирования, поэтому строка <code class="literal">@exec</code> следует
      после имени файла с примером конфигурации.</p><p>Для получения дополнительного отладочного вывода на экран
      можно временно удалить параметр <code class="literal">-s</code> из
      команды <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cmp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">cmp</span>(1)</span></a>.</p><p>Для получения дополнительной инфорации по использованию
      <code class="literal">%D</code> и прочих маркеров подстановки обратитесь
      к странице Справочника <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg-create&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pkg-create</span>(8)</span></a>.</p><p>Если существует действительно стоящая причина не
      устанавливать рабочий файл конфигурации по умолчанию, уберите
      строку <code class="literal">@exec</code> из
      <code class="filename">pkg-plist</code> и добавьте <a class="link" href="#porting-message" title="8.1. pkg-message">сообщение</a>, указывающее на
      то, что пользователь обязан скопировать и отредактировать этот
      файл перед тем, как программное обеспечение начнёт
      работать.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="plist-dynamic"></a>7.4. Динамический или статический список упаковки</h2></div></div></div><p><span class="emphasis"><em>Статический список упаковки</em></span> -
      это список упаковки, который доступен в Коллекции Портов или
      как файл <code class="filename">pkg-plist</code> (с подстановкой
      переменных или без неё), или как встроенный в
      <code class="filename">Makefile</code> посредством
      <code class="varname">PLIST_FILES</code>, <code class="varname">PLIST_DIRS</code> и
      <code class="varname">PLIST_DIRSTRY</code>.  Даже если содержимое
      является автоматически порождаемым при помощи инструмента или в
      результате выполнения цели в Makefile <span class="emphasis"><em>до</em></span>
      включения в Коллекцию Портов коммиттером, то список всё ещё
      будет считаться статическим, поскольку его можно узнать без
      необходимости скачивания или компиляции дистрибутива.</p><p><span class="emphasis"><em>Динамический список упаковки</em></span> это
      список упаковки, который получается во время компиляции порта и
      строится на основе устанавливаемых файлов и каталогов.  Узнать
      такой список невозможно до того, как исходный код портируемого
      приложения будет скачен и скомпилирован, или после запуска
      <code class="literal">make clean</code>.</p><p>Хотя использование динамических список упаковки не
      запрещено, сопровождающие должны использовать статические
      списки упаковки везде, где это возможно, поскольку это
      позволяет пользователям выполнять <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=grep&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">grep</span>(1)</span></a> по доступным
      портам для обнаружения, например, который порт устанавливает
      определенный файл.  Динамические списки должны быть
      использованы в основном для сложных портов, для которых
      изменения в списке упаковки кардинальным образом основаны на
      необязательных возможностях порта (и, таким образом, делая
      сопровождение статических списков упаковки невозможным), или
      портов, которые изменяют список упаковки на основе версии
      используемого им программного обеспечения (например, порты,
      которые порождают документы при помощи
      <span class="application">Javadoc</span>).</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="plist-autoplist"></a>7.5. Автоматическое создание списка упаковки</h2></div></div></div><p>Первым делом убедитесь, что ваш порт практически полностью
      завершён и осталось создать только
      <code class="filename">pkg-plist</code>.  После этого вы можете
      запустить <code class="command">make makeplist</code> для автоматического
      создания <code class="filename">pkg-plist</code>.  Содержимое этого
      файла должно быть дважды перепроверено.</p><p>Пользовательские конфигурационные файлы должны быть удалены
      или быть установлены как <code class="filename">filename.sample</code>.
      Файл <code class="filename">info/dir</code> включать в список не нужно,
      но должны быть добавлены соответствующие строчки
      <code class="filename">install-info</code>, так, как это описано в
      разделе о <a class="link" href="#makefile-info" title="5.11. Файлы в формате info">файлах в формате info</a>.  Все
      библиотеки, устанавливаемые портом, должны быть перечислены
      так, как это описано в разделе о <a class="link" href="#porting-shlibs" title="6.2. Динамические библиотеки">динамических
	библиотеках</a>.</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="pkg-files"></a>Глава 8. Файлы <code class="filename">pkg-*</code></h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#porting-message">8.1. <code class="filename">pkg-message</code></a></span></dt><dt><span class="sect1"><a href="#pkg-install">8.2. <code class="filename">pkg-install</code></a></span></dt><dt><span class="sect1"><a href="#pkg-deinstall">8.3. <code class="filename">pkg-deinstall</code></a></span></dt><dt><span class="sect1"><a href="#pkg-names">8.4. Изменение имён файлов
      <code class="filename">pkg-*</code></a></span></dt><dt><span class="sect1"><a href="#using-sub-files">8.5. Использование <code class="varname">SUB_FILES</code> и
      <code class="varname">SUB_LIST</code></a></span></dt></dl></div><p>Есть несколько приёмов работы с файлами
    <code class="filename">pkg-*</code>, которые мы ещё не описали, но они
    иногда могут быть очень кстати.</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-message"></a>8.1. <code class="filename">pkg-message</code></h2></div></div></div><p>Если вам нужно вывести сообщение для человека,
      устанавливающего приложение, то вы можете поместить сообщение в
      файл <code class="filename">pkg-message</code>.  Эта возможность часто
      оказывается полезной для вывода дополнительных шагов установки,
      которые нужно предпринять после выполнения команды
      <code class="command">pkg install</code>, или для вывода информации о
      лицензировании.</p><p>Если должны выводиться некоторые строки о knobs времени
      построения или предупреждения, используйте
      <code class="varname">ECHO_MSG</code>.  Файл
      <code class="filename">pkg-message</code> только для послеустановочных
      шагов.  Также следует иметь в виду различие между
      <code class="varname">ECHO_MSG</code> и <code class="varname">ECHO_CMD</code>.
      Первое предназначено для вывода на экран информационного
      текста, а второе для конвейера команд:</p><pre class="programlisting">update-etc-shells:
	@${ECHO_MSG} "updating /etc/shells"
	@${CP} /etc/shells /etc/shells.bak
	@( ${GREP} -v ${PREFIX}/bin/bash /etc/shells.bak; \
		${ECHO_CMD} ${PREFIX}/bin/bash) &gt;/etc/shells
	@${RM} /etc/shells.bak</pre><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Файл <code class="filename">pkg-message</code> не нужно добавлять в
	<code class="filename">pkg-plist</code>.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="pkg-install"></a>8.2. <code class="filename">pkg-install</code></h2></div></div></div><p>Если при установке бинарного пакета по команде
      <code class="command">pkg add</code> или <code class="command">pkg install</code>
      вашему порту нужно выполнить какие-то команды, то вы можете это
      сделать с помощью скрипта <code class="filename">pkg-install</code>.
      Этот скрипт будет автоматически добавлен к пакету и будет
      дважды запускаться командой <code class="command">pkg</code>: первый раз
      в виде <code class="literal">${SH} pkg-install ${PKGNAME}
	PRE-INSTALL</code>, а второй раз как
      <code class="literal">${SH} {PKGNAME} POST-INSTALL</code>.  Для
      распознавания того, в каком режиме запущен скрипт, можно
      использовать параметр <code class="literal">$2</code>.  Переменная
      окружения <code class="envar">PKG_PREFIX</code> будет принимать значение,
      соответствующее каталогу, в который устанавливается
      пакет.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Этот скрипт не запускается автоматически, если вы
	устанавливаете порт командой <code class="command">make install</code>.
	Если же вам действительно необходимо его запустить, то
	запустите его явно из файла <code class="filename">Makefile</code>
	порта строкой вида <code class="literal">PKG_PREFIX=${PREFIX}
	  ${SH} $ {PKGINSTALL}${PKGNAME}
	  PRE-INSTALL</code>.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="pkg-deinstall"></a>8.3. <code class="filename">pkg-deinstall</code></h2></div></div></div><p>Этот скрипт вызывается при удалении пакета.</p><p>Этот скрипт будет дважды запускаться командой
      <code class="command">pkg delete</code>.  Первый раз как
      <code class="literal">${SH} pkg-deinstall ${PKGNAME}
	DEINSTALL</code>, а второй раз как <code class="literal">${SH}
	pkg-deinstall ${PKGNAME}
	POST-DEINSTALL</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="pkg-names"></a>8.4. Изменение имён файлов
      <code class="filename">pkg-*</code></h2></div></div></div><p>Все имена файлов <code class="filename">pkg-*</code> определяются с
      помощью переменных, так что вы можете изменить их, если это
      нужно, в вашем файле <code class="filename">Makefile</code>.  Это
      особенно полезно, если вы используете одни и те же файлы
      <code class="filename">pkg-*</code> совместно между несколькими портами
      или пишете в один из вышеперечисленных файлов (в главе о <a class="link" href="#porting-wrkdir" title="12.2. WRKDIR">записи в каталоги, отличные от
      <code class="varname">WRKDIR</code></a> объяснено, почему не
      рекомендуется осуществлять запись непосредственно в файлы
      <code class="filename">pkg-*</code>.</p><p>Вот список имён переменных и их значений по умолчанию.
      (Значение <code class="varname">PKGDIR</code> по умолчанию равно
      <code class="varname">${MASTERDIR}</code>.)</p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Значение по умолчанию</th></tr></thead><tbody><tr><td><code class="varname">DESCR</code></td><td><code class="literal">${PKGDIR}/pkg-descr</code></td></tr><tr><td><code class="varname">PLIST</code></td><td><code class="literal">${PKGDIR}/pkg-plist</code></td></tr><tr><td><code class="varname">PKGINSTALL</code></td><td><code class="literal">${PKGDIR}/pkg-install</code></td></tr><tr><td><code class="varname">PKGDEINSTALL</code></td><td><code class="literal">${PKGDIR}/pkg-deinstall</code></td></tr><tr><td><code class="varname">PKGMESSAGE</code></td><td><code class="literal">${PKGDIR}/pkg-message</code></td></tr></tbody></table></div><p>Пожалуйста, изменяйте значения этих переменных, а не
      переопределяйте <code class="varname">PKG_ARGS</code>.  Если вы измените
      значение переменных <code class="varname">PKG_ARGS</code>, то эти файлы
      при установке из порта будут установлены в каталог
      <code class="filename">/var/db/pkg</code> некорректно.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-sub-files"></a>8.5. Использование <code class="varname">SUB_FILES</code> и
      <code class="varname">SUB_LIST</code></h2></div></div></div><p>Переменные <code class="varname">SUB_FILES</code> и
      <code class="varname">SUB_LIST</code> подходят для задания в файлах порта
      динамических значений, таких как <code class="varname">PREFIX</code>
      установки в <code class="filename">pkg-message</code>.</p><p>В переменной <code class="varname">SUB_FILES</code> указывается
      перечень файлов для автоматического изменения.  Каждый
      <em class="replaceable"><code>file</code></em> из перечня
      <code class="varname">SUB_FILES</code> обязан иметь соответствующий
      <code class="filename">file.in</code>, присутствующий в
      <code class="varname">FILESDIR</code>.  Измененная версия будет создана в
      <code class="varname">WRKDIR</code>.  Файлы, определенные в качестве
      значения <code class="varname">USE_RC_SUBR</code> (или устаревшего
      <code class="varname">USE_RCORDER</code>), автоматически добавляются в
      <code class="varname">SUB_FILES</code>.  Для файлов
      <code class="filename">pkg-message</code>,
      <code class="filename">pkg-install</code> и
      <code class="filename">pkg-deinstall</code> устанавливается
      соответствующая переменная Makefile, указывающая на
      обработанную версию.</p><p>Переменная <code class="varname">SUB_LIST</code> содержит перечень
      пар <code class="literal">VAR=VALUE</code>.  В каждом файле из
      <code class="varname">SUB_FILES</code> для каждой пары будет произведена
      замена <code class="literal">%%VAR%%</code> на <code class="literal">VALUE</code>.
      Некоторые общие пары определяются автоматически:
      <code class="varname">PREFIX</code>, <code class="varname">LOCALBASE</code>,
      <code class="varname">DATADIR</code>, <code class="varname">DOCSDIR</code>,
      <code class="varname">EXAMPLESDIR</code>, <code class="varname">WWWDIR</code> и
      <code class="varname">ETCDIR</code>.  Любая строка, начинающаяся с
      <code class="literal">@comment</code>, будет удалена из конечного файла
      после подстановки переменной.</p><p>В следующем примере в <code class="filename">pkg-message</code>
      будет сделана замена <code class="literal">%%ARCH%%</code> на системную
      архитектуру:</p><pre class="programlisting">SUB_FILES=	pkg-message
SUB_LIST=	ARCH=${ARCH}</pre><p>Обратите внимание, что в этом примере в
      <code class="varname">FILESDIR</code> обязательно существование файла
      <code class="filename">pkg-message.in</code>.</p><p>Пример хорошего <code class="filename">pkg-message.in</code>:</p><pre class="programlisting">Now it is time to configure this package.
Copy %%PREFIX%%/share/examples/putsy/%%ARCH%%.conf into your home directory
as .putsy.conf and edit it.</pre></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="testing"></a>Глава 9. Тестирование вашего порта</h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#make-describe">9.1. Запуск <code class="command">make describe</code></a></span></dt><dt><span class="sect1"><a href="#testing-portlint">9.2. Portlint</a></span></dt><dt><span class="sect1"><a href="#testing-porttools">9.3. Port Tools</a></span></dt><dt><span class="sect1"><a href="#porting-prefix">9.4. <code class="varname">PREFIX</code> и
      <code class="varname">DESTDIR</code></a></span></dt><dt><span class="sect1"><a href="#testing-tinderbox">9.5. Tinderbox</a></span></dt><dt><span class="sect1"><a href="#testing-poudriere">9.6. Poudriere</a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="make-describe"></a>9.1. Запуск <code class="command">make describe</code></h2></div></div></div><p>Некоторые утилиты FreeBSD для сопровождения портов, например,
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=portupgrade&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">portupgrade</span>(1)</span></a>, опираются на базу данных с именем
      <code class="filename">/usr/ports/INDEX</code>, в которой отслеживаются
      такие характеристики портов, как их зависимости.  Файл
      <code class="filename">INDEX</code> создаётся при помощи
      <code class="filename">ports/Makefile</code> верхнего уровня по команде
      <code class="command">make index</code>, спускающейся в подкаталог
      каждого порта и выполняющей в нём <code class="command">make
	describe</code>.  Таким образом, если выполнение
      <code class="command">make describe</code> с каким-либо портом завершится
      неудачно, то никому не удастся создать
      <code class="filename">INDEX</code>, при этом много людей вскоре станут
      несчастны.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Возможность генерировать этот файл очень важна вне
	зависимости от того, какие параметры присутствуют в
	<code class="filename">make.conf</code>, поэтому, пожалуйста,
	избегайте, таких вещей, как использование декларации
	<code class="literal">.error</code>, когда (к примеру) требования к
	зависимости не было удовлетворено.  (Смотрите
	<a class="xref" href="#dads-dot-error" title="12.15. Избегайте использования конструкции .error">Раздел 12.15, <<Избегайте использования конструкции
      <code class="literal">.error</code>>></a>.)</p></div><p>Если <code class="command">make describe</code> выдаёт строчку, а не
      ошибку, то для вас это пройдёт безболезненно.  Обратитесь к
      файлу <code class="filename">bsd.port.mk</code>, чтобы выяснить значение
      выдаваемых строк.</p><p>Заметьте также, что запуск последней версии
      <code class="command">portlint</code> (как указано в следующем разделе)
      приведёт к автоматическому запуску команды
      <code class="command">make describe</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="testing-portlint"></a>9.2. Portlint</h2></div></div></div><p>Проверьте свою работу командой <a class="link" href="#porting-portlint" title="3.5. Проверка вашего порта утилитой portlint"><code class="command">portlint</code></a>
      перед тем, как её отослать или перенести в дерево портов.
      <code class="command">portlint</code> предупреждает вас о многих
      распространённых ошибках, как функциональных, так и
      стилистических.  Для нового (или скопированного внутри
      хранилища) порта самым подходящим является запуск
      <code class="command">portlint -A</code>; для уже существующего порта
      достаточно будет запустить
      <code class="command">portlint -C</code>.</p><p>Так как для обнаружения ошибок <code class="command">portlint</code>
      использует эвристические методы, то им могут выдаваться и
      ошибочные предупреждения.  Кроме того, время от времени нечто,
      отмечаемое как некорректность, из-за ограничений механизма
      создания портов не может быть сделано никак иначе.  Если вы
      сомневаетесь, то лучше всего спросить в <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">Список рассылки, посвящённый Портам FreeBSD</a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="testing-porttools"></a>9.3. Port Tools</h2></div></div></div><p>Программа <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/porttools/pkg-descr">ports-mgmt/porttools</a> входит в состав
      Коллекции Портов.</p><p><code class="command">port</code> является сценарием переднего плана,
      который может упростить вам задачу тестирования.  Если вы
      хотите проверить новый порт или обновить существующий, то вы
      можете использовать <code class="command">port test</code> для проверки
      вашего порта, включая проверку <a class="link" href="#testing-portlint" title="9.2. Portlint"><code class="command">portlint</code></a>.
      Эта команда также находит и отображает любые файлы, которые
      невключенные в <code class="filename">pkg-plist</code>.  Смотрите
      следующий пример:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>port test /usr/ports/net/csup</code></strong></pre></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-prefix"></a>9.4. <code class="varname">PREFIX</code> и
      <code class="varname">DESTDIR</code></h2></div></div></div><p>Переменная <code class="varname">PREFIX</code> определяет, куда будет
      установлен порт.  По умолчанию это
      <code class="filename">/usr/local</code>, но может меняться
      пользователем на собственный путь, такой как
      <code class="filename">/opt</code>.  В вашем порту значение этой
      переменной должно учитываться.</p><p>Если пользователь установил переменную
      <code class="varname">DESTDIR</code>, то она определяет полное
      альтернативное окружение, обычно, это jail или установленная
      система, смонтированная в месте, отличном от
      <code class="filename">/</code>.  На самом деле порт устанавливается в
      <code class="filename">DESTDIR/PREFIX</code> и регистрируется в базе
      данных пакетов в <code class="filename">DESTDIR/var/db/pkg</code>.
      Поскольку управление <code class="varname">DESTDIR</code> производится
      автоматически инфраструктурой портов с помощью <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chroot&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">chroot</span>(8)</span></a>,
      вам не нужны никакие изменения или проявление особой
      осторожности при написании портов, совместымых с
      <code class="varname">DESTDIR</code>.</p><p>Значение переменной <code class="varname">PREFIX</code> будет
      установлено в <code class="varname">LOCALBASE</code> (по умолчанию
      <code class="filename">/usr/local</code>).  Если задана переменная
      <code class="varname">USE_LINUX_PREFIX</code>, то
      <code class="varname">PREFIX</code> примет значение
      <code class="varname">LINUXBASE</code> (по умолчанию
      <code class="filename">/compat/linux</code>).</p><p>Избегание явно прописываемых путей
      <code class="filename">/usr/local</code> в исходном коде сделает порт
      гораздо более гибким и способным удовлетворить потребности
      других серверов.  Часто этого можно добиться простой заменой
      строк <code class="filename">/usr/local</code> в различных файлах
      <code class="filename">Makefile</code> внутри порта на
      <code class="literal">${PREFIX}</code>.  Эта переменная
      автоматически передаётся далее на каждом этапе построения и
      установки.</p><p>Проверьте, что ваше приложение не устанавливает чего-либо в
      каталог <code class="filename">/usr/local</code> вместо
      <code class="varname">PREFIX</code>.  Наличие явно указанных путей можно
      быстро проверить следующим образом:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make clean; make package PREFIX=/var/tmp/`make -V PORTNAME`</code></strong></pre><p>Если что-то было установлено за пределами
      <code class="varname">PREFIX</code>, то процесс создания пакета сообщит
      об отсутствии файлов.</p><p>Это также стоит проверить с использованием поддержки
      каталога сборки (смотрите <a class="xref" href="#staging" title="6.1. Staging">Раздел 6.1, <<Staging>></a>):</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make stage &amp;&amp; make check-orphans &amp;&amp; make package</code></strong></pre><p>Эти проверки не найдут явно указанных путей внутри файлов
      порта и не проверят корректность использования
      <code class="varname">LOCALBASE</code> в качестве ссылки на файлы из
      других портов.  Порт, временно установленный в
      <code class="filename">/var/tmp/`make -V PORTNAME`</code>, следует
      проверять на работоспособность, чтобы убедиться в отсутствии
      проблем с путями.</p><p>Переменная <code class="varname">PREFIX</code> не должна задаваться
      явно в файле <code class="filename">Makefile</code> порта.  Пользователи
      при установке порта могут задать в <code class="varname">PREFIX</code>
      свое собственное место, и порт должен учитывать это
      значение.</p><p>Обратитесь к программам/файлам из других портов с
      переменными, перечисленными выше, без указания явных маршрутов.
      Например, если ваш порт требует, чтобы макрос
      <code class="literal">PAGER</code> являлся полным путем утилиты
      <code class="command">less</code>, не используйте строковый путь
      <code class="filename">/usr/local/bin/less</code>.  Вместо этого
      используйте <code class="literal">${LOCALBASE}</code>:</p><pre class="programlisting">-DPAGER=\"${LOCALBASE}/bin/less\"</pre><p>Путь с использованием <code class="varname">LOCALBASE</code> имеет
      больше шансов оставаться работоспособным, если системный
      администратор переместил всё дерево
      <code class="filename">/usr/local</code> куда-то в другое место.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="testing-tinderbox"></a>9.5. Tinderbox</h2></div></div></div><p>Если вы алчный контрибутор портов, то вы можете захотеть
      взглянуть на <span class="application">Tinderbox</span>.  Это мощная
      система построения и тестирования портов.
      <span class="application">Tinderbox</span> можно установить,
      используя порт <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/tinderbox/pkg-descr">ports-mgmt/tinderbox</a>.  Обязательно
      прочитайте поставляемую документацию, поскольку конфигурация не
      является тривиальной.</p><p>Для получения подробностей посетите <a class="link" href="http://tinderbox.marcuscom.com/" target="_top">вебсайт
	Tinderbox</a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="testing-poudriere"></a>9.6. Poudriere</h2></div></div></div><p>Если вы контрибутор портов, подумайте об установке
      <span class="application">poudriere</span>.  Это мощная система для
      построения и тестирования портов.
      <span class="application">Poudriere</span> можно установить из
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/poudriere/pkg-descr">ports-mgmt/poudriere</a>.</p><p>Для получения подробной информации посетите <a class="link" href="http://fossil.etoilebsd.net/poudriere" target="_top">вебсайт
	Poudriere</a>.</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="port-upgrading"></a>Глава 10. Обновление отдельного порта</h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#svn-diff">10.1. Использование <span class="application">Subversion</span> для
      создания патчей</a></span></dt><dt><span class="sect1"><a href="#moved-and-updating-files">10.2. Файлы <code class="filename">UPDATING</code> и
      <code class="filename">MOVED</code></a></span></dt></dl></div><p>Если вы заметите, что ваш порт устарел по сравнению с
    последней авторской версией, первым делом вы должны получить
    самую последнюю версия порта.  Вы можете найти их в каталоге
    <code class="filename">ports/ports-current</code> на зеркальных
    FTP-серверах FreeBSD.  Однако если вы работаете с достаточно большим
    количеством портов, наверное, будет проще использовать
    <span class="application">Subversion</span> или <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=portsnap&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">portsnap</span>(8)</span></a> для
    поддержания всей коллекции портов в актуальном состоянии, как это
    описано в <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/ports-using.html" target="_top">Руководстве</a>.
    К тому же это даст возможность отслеживать все зависимости
    портов.</p><p>На следующем шаге необходимо выяснить, нет ожидает ли уже это
    обновление своей очереди.  Для этого у вас есть две возможности.
    Существует интерфейс к <a class="link" href="http://www.FreeBSD.org/cgi/query-pr-summary.cgi?query" target="_top">базе
      данных сообщений о проблемах FreeBSD (PR)</a> (известной
    также как <code class="literal">GNATS</code>) с поисковыми возможностями.
    Выберите из выпадающего списка <code class="literal">ports</code> и введите
    название порта.</p><p>Однако иногда люди забывают поместить название порта в поле
    Synopsis в точном виде.  В таком случае вы можете воспользоваться
    <a class="link" href="#portsmon" title="14.6. Система мониторинга портов FreeBSD">Системой мониторинга портов FreeBSD</a>
    (которая известна также как <code class="literal">portsmon</code>).  В
    рамках этой системы делается попытка классифицировать PR,
    касающиеся портов, по имени порта.  Для поиска PR, относящихся к
    определённому порту, используйте механизм <a class="link" href="http://portsmon.FreeBSD.org/portoverview.py" target="_top">Просмотра
      по одному порту</a>.</p><p>Если таких отложенных PR не существует, то на следующем этапе
    следует послать сообщение электронной почты человеку,
    поддерживающему порт, который выдаётся по команде <code class="command">make
      maintainer</code>.  Этот человек может уже работать над
    обновлением, или иметь причину не обновлять порт прямо сейчас
    (например, из-за проблем со стабильностью функционирования новой
    версии); вам нет нужды дублировать их работу.  Заметьте, что
    неподдерживаемые порты перечисляются с адресом сопровождающего
    <code class="literal">ports@FreeBSD.org</code>, который является всего лишь
    адресом общего списка рассылки, так что отправка туда сообщений,
    скорее всего, в данном случае не поможет.</p><p>Если сопровождающий просит вас выполнить обновление, либо
    сопровождающий отсутствует, то у вас появляется шанс помочь FreeBSD,
    приготовив обновление самим!  Пожалуйста, делайте это с
    использованием команды <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> в основной системе.</p><p>Чтобы создать подходящий <code class="command">diff</code> для одного
    патча, скопируйте файл, который нужно пропатчить, в
    <em class="replaceable"><code>something.orig</code></em>, сохраните ваши
    изменения в <em class="replaceable"><code>something</code></em>, а затем
    создайте ваше патч:</p><div class="informalexample"><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>diff -u something.orig something &gt; something.diff</code></strong></pre></div><p>В противном случае, вам следует воспользоваться методом
    <code class="command">svn diff</code> (<a class="xref" href="#svn-diff" title="10.1. Использование Subversion для создания патчей">Раздел 10.1, <<Использование <span class="application">Subversion</span> для
      создания патчей>></a>), либо
    скопировать содержимое порта в отдельный каталог и применить
    результат рекурсивной команды <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> между новым и старым
    каталогами порта (например, если каталог с модифицированным
    портом называется <code class="filename">superedit</code>, а оригинальный,
    совпадающий с находящимся в нашем дереве портов,
    <code class="filename">superedit.bak</code>, то сохраните результат
    выполнения команды <code class="command">diff -ruN superedit.bak
      superedit</code>).  Подойдёт как унифицированный, так и
    контекстный дифф, однако коммиттеры портов обычно предпочитают
    унифицированный формат.  Отметьте использование опции
    <code class="literal">-N</code>-это одобряемый способ заставить diff
    корректно работать в случае добавления новых файлов или удаления
    старых.  Перед тем, как посылать нам diff-файл, пожалуйста,
    проверьте его, чтобы убедиться в значимости всех внесённых
    изменений.  (В частности, убедитесь, что вы очистили рабочие
    каталоги командой <code class="command">make clean</code>).</p><p>Для упрощения повторяющихся операций с файлами заплаток вы
    можете воспользоваться скриптом
    <code class="filename">/usr/ports/Tools/scripts/patchtool.py</code>.
    Перед тем, как его запускать, пожалуйста, прочтите
    <code class="filename">/usr/ports/Tools/scripts/README.patchtool</code>.</p><p>Если порт никем не поддерживается, а вы активно его
    используете, пожалуйста, подумайте над тем, чтобы добровольно
    стать его сопровождающим.  Во FreeBSD имеется более 4000 портов без
    поддержки, и это как раз та область, где всегда нужны
    добровольцы.  (Детальное описание обязанностей сопровождающего
    можно найти в разделе <a class="link" href="../../../../doc/en_US.ISO8859-1/books/developers-handbook/policies.html#POLICIES-MAINTAINER" target="_top">Руководства
      Разработчика</a>.)</p><p>Лучше всего послать нам diff-файл, включив его в посылку по
    команде <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=send-pr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">send-pr</span>(1)</span></a> (категория <code class="literal">ports</code>).
    Если вы сопровождаете порт, обязательно поместите текст
    <code class="literal">[maintainer update]</code> в начале строки описания и
    задайте в поле <span class="quote"><<<span class="quote">Class</span>>></span> вашего PR строчку
    <code class="literal">maintainer-update</code>.  В противном случае в поле
    <span class="quote"><<<span class="quote">Class</span>>></span> вашего PR должно быть указано
    <code class="literal">change-request</code>.  Будьте добры, в сообщении
    отметьте все добавленные или удалённые файлы, так как они будут
    непосредственно указаны <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=svn&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">svn</span>(1)</span></a> при выполнении операции
    коммита.  Если diff-файл имеет размер, превышающий 20КБ, сожмите
    его и обработайте утилитой uuencode; в противном случае просто
    включите его как есть в PR.</p><p>Прежде чем пользоваться <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=send-pr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">send-pr</span>(1)</span></a> просмотрите раздел о
    <a class="link" href="../../../../doc/ru_RU.KOI8-R/articles/problem-reports/pr-writing.html" target="_top">Написании
      сообщений о проблемах</a> в статье о Сообщениях об ошибках.
    Он содержит гораздо больше информации о том, как писать полезные
    сообщения о проблемах.</p><div xmlns="" class="important"><h3 class="admontitle">Важно: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если обновление вызвано соображениями информационной
      безопасности или наличием серьёзных ошибок в имеющемся порте,
      пожалуйста, оповестите Группа Менеджеров Дерева Портов FreeBSD <code class="email">&lt;<a xmlns="" class="email" href="mailto:portmgr@FreeBSD.org">portmgr@FreeBSD.org</a>&gt;</code> о необходимости немедленного
      перепостроения и повторного распространения пакета данного
      порта.  В противном случае ничего не подозревающие пользователи
      <code class="command">pkg</code> будут продолжать устанавливать старую
      версию по команде <code class="command">pkg install</code> в течение ещё
      нескольких недель.</p></div><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Повторяем еще раз - для посылки обновлений существующих
      портов используйте утилиту <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>, а не <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=shar&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">shar</span>(1)</span></a>!
      Это поможет понять коммиттерам портов, что именно было
      изменено.</p></div><p>Теперь, когда вы проделали всё это, прочитайте о том, как
    поддерживать актуальное состояние, в <a class="xref" href="#keeping-up" title="Глава 14. Актуализация">Глава 14, <em>Актуализация</em></a>.</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="svn-diff"></a>10.1. Использование <span class="application">Subversion</span> для
      создания патчей</h2></div></div></div><p>По возможности присылайте исправления в формате <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=svn&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">svn</span>(1)</span></a>
      diff.  В таком виде их проще использовать по сравнению с
      разницей между <span class="quote"><<<span class="quote">старым и новым</span>>></span> каталогами.  Так
      проще увидеть изменения и обновить их в случае, если что-нибудь
      изменилось в Коллекции Портов с тех пор, как вы начали работу,
      либо если коммиттер просит что-то исправить.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>cd ~/my_wrkdir</code></strong> <a id="my-wrkdir"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
<code class="prompt">%</code> <strong class="userinput"><code>svn co https://svn0.us-west.FreeBSD.org/ports/head/dns/pdnsd</code></strong> <a id="svn-FreeBSD-org"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>
<code class="prompt">%</code> <strong class="userinput"><code>cd ~/my_wrkdir/pdnsd</code></strong></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#my-wrkdir"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Это может быть где угодно; место, в котором
	  производится построение портов, не привязано к
	  <code class="filename">/usr/ports/</code>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#svn-FreeBSD-org"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p><a class="link" href="https://svn0.us-west.FreeBSD.org/" target="_top">svn0.us-west.FreeBSD.org</a>
	  - это общедоступный сервер
	  <span class="application">Subversion</span>.  Выберите ближайшее
	  зеркало и проверьте сертификат зеркалирующего сервера на
	  наличие в перечне <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/svn-mirrors.html" target="_top">зеркалирующих
	    сайтов Subversion</a>.</p></td></tr></table></div><p>Находясь в рабочем каталоге, вносите любые изменения,
      которые обычно делают для порта.  При добавлении или удалении
      файла используйте <code class="command">svn</code> для отслеживания этих
      изменений:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>svn add new_file</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>svn remove deleted_file</code></strong></pre><p>Убедитесь, что вы проверяете порт в соответствии с
      рекомендуемым порядком проверки, описанным в
      <a class="xref" href="#porting-testing" title="3.4. Тестирование порта">Раздел 3.4, <<Тестирование порта>></a> и
      <a class="xref" href="#porting-portlint" title="3.5. Проверка вашего порта утилитой portlint">Раздел 3.5, <<Проверка вашего порта утилитой
      <code class="command">portlint</code>>></a>.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>svn status</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>svn update</code></strong> <a id="svn-update"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#svn-update"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Эта команда попытается выполнить слияние различий между
	  вашим патчем и текущей версией репозитория; внимательно
	  проверьте полученный вывод.  Буква перед названием каждого
	  файла означает тип изменения, сделанного с этим файлом.
	  Для получения полного списка смотрите <a class="xref" href="#table-svn-up" title="Таблица 10.1. Префиксы файлов для Subversion Update">Таблица 10.1, <<Префиксы файлов для
	<span class="application">Subversion</span> Update>></a>.</p></td></tr></table></div><div class="table"><a id="table-svn-up"></a><div class="table-title">Таблица 10.1. Префиксы файлов для
	<span class="application">Subversion</span> Update</div><div class="table-contents"><table summary="Префиксы файлов для&#10;&#9;Subversion Update" width="100%" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td>U</td><td>Файл обновлен без проблем.</td></tr><tr><td>G</td><td>Файл обновлен без проблем (вы увидите это только
	      при работе с удаленным репозиторием).</td></tr><tr><td>M</td><td>Файл с локальными изменениями, слияние выполнено
	      без конфликтов.</td></tr><tr><td>C</td><td>Файл с локальными изменениями, слияние выполнено
	      с конфликтами.</td></tr></tbody></table></div></div><br class="table-break" /><p>Если в результате выполнения <code class="literal">svn update</code>
      отображается <code class="literal">C</code>, то это означает, что что-то
      изменилось в репозитории <span class="application">Subversion</span>
      и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=svn&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">svn</span>(1)</span></a> не смогла выполнить слияние локальных изменений с
      полученными из репозитория.  В любом случае никогда не помешает
      просмотреть изменения, поскольку <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=svn&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">svn</span>(1)</span></a> ничего не знает о
      том, каким должен быть порт, поэтому эта команда может (и,
      вероятно, будет) делать слияние тех изменений, которые не имеют
      смысла.</p><p>Последним шагом является создание унифицированного
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> для полученных изменений:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>svn diff &gt; ../`basename ${PWD}`.diff</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Информация о любых удаляемых файлов должна быть явным
	образом указана в PR, поскольку необходимость в удалении
	файла для коммиттера может быть неочевидна.</p></div><p>Присылайте свои патчи в соответствии с руководством,
      описанном в <a class="xref" href="#port-upgrading" title="Глава 10. Обновление отдельного порта">Глава 10, <em>Обновление отдельного порта</em></a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="moved-and-updating-files"></a>10.2. Файлы <code class="filename">UPDATING</code> и
      <code class="filename">MOVED</code></h2></div></div></div><p>Если при обновлении порта требуются специальные шаги, такие
      как изменение файлов конфигурации или запуск специальной
      программы, то вам следует это задокументировать в файле
      <code class="filename">/usr/ports/UPDATING</code>.  Формат записи в этом
      файле приводится ниже:</p><pre class="programlisting">YYYYMMDD:
  AFFECTS: users of portcategory/portname
  AUTHOR: Your name &lt;Your email address&gt;

  Special instructions</pre><p>Если вы включаете точные инструкции portmaster или
      portupgrade, пожалуйста, убедитесь в правильном экранировании
      символов внутри командной оболочки.</p><p>Файл <code class="filename">/usr/ports/MOVED</code> содержит записи
      об удалённых или перемещённых портах.  Каждая строка в этом
      файле состоит из полей: название порта, место, куда он был
      перемещён, дата и причина перемещения.  Если порт был удалён,
      то поле, указывающее новое место, может оставаться
      незаполненным.  Поля должны разделяться символом
      <code class="literal">|</code> (pipe), как это показано ниже:</p><pre class="programlisting">old name|new name (blank for deleted)|date of move|reason</pre><p>Дату следует вводить в формате
      <code class="literal">YYYY-MM-DD</code>.  Новые записи следует добавлять
      в конец файла в хронологическом порядке.</p><p>Если порт был перемещён, но в дальнейшем восстановлен на
      прежнем месте, удалите в этом файле строку, содержащую
      информацию о перемещении.</p><p>Полученные изменения можно проверить командой
      <code class="command">Tools/scripts/MOVEDlint.awk</code>.</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="security"></a>Глава 11. Безопасность портов</h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#security-intro">11.1. Почему безопасность так важна</a></span></dt><dt><span class="sect1"><a href="#security-fix">11.2. Исправление уязвимостей безопасности</a></span></dt><dt><span class="sect1"><a href="#security-notify">11.3. Обеспечение сообщества информацией</a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="security-intro"></a>11.1. Почему безопасность так важна</h2></div></div></div><p>Ошибки в программном обеспечении появляются случайно.
      Возможно, самые опасные из них те, что создают уязвимости
      безопасности.  С технической точки зрения подобные уязвимости
      должны быть закрыты путем исправления вызывающих их ошибок.
      Тем не менее, политики обработки несущественных ошибок и
      уязвимостей очень различаются.</p><p>Обычная небольшая ошибка затрагивает только тех
      пользователей, которые задействуют некоторые комбинации
      настроек, активирующие эту ошибку.  Разработчик в конечном
      счете выпустит патч, а зачтем новую версию программного
      обеспечения, свободного от ошибки, но большинство пользователей
      не посчитают нужным сразу же произвести обновление, поскольку
      эта ошибка никогда у них не проявлялась.  Критическая ошибка,
      которая может приводить к потере данных, представляет серьезную
      проблему.  Тем не менее, предусмотрительные пользователи знают,
      что большинство возможных происшествий, и среди них программные
      ошибки, скорее всего приводят к потере данных, поэтому они
      выполняют резервное копирование важных данных; дополнительно,
      критическая ошибка будет обнаружена очень скоро.</p><p>С уязвимостью безопасности всё иначе.  Во-первых, она может
      сохраняться необнаруженной целые годы, потому что чаще всего не
      вызывает ошибок в работе.  Во-вторых, компания злоумышленников
      может использовать ее для получения неавторизованного доступа к
      уязвимой системе, уничтожить или подменить важные данные; в
      худшем случае пользователь даже не заметит нанесенный урон.
      В-третьих, взлом уязвимой системы часто упрощает задачу
      проникновения атакующих в другие системы, которые не могут быть
      скомпрометированы иначе.  Таким образом, устранение уязвимости
      как таковой недостаточно: следует разослать всем
      заинтересованным уведомления в наиболее понятной и
      исчерпывающей форме, что позволит оценить риск и предпринять
      подходящие меры.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="security-fix"></a>11.2. Исправление уязвимостей безопасности</h2></div></div></div><p>Что касается портов и пакетов, уязвимость безопасности
      изначально может появиться в исходном дистрибутиве или файлах
      порта.  В первом случае, разработчик исходного программного
      обеспечения скорее всего сразу же выпустит патч или новую
      версию, и вам лишь понадобится сразу обновить порт в
      соответствии с исправлением автора.  Если исправление по
      какой-то причине задерживается, вам следует либо <a class="link" href="#dads-noinstall" title="12.13. Пометка неустанавливаемого порта как BROKEN, FORBIDDEN или IGNORE">пометить порт как
	<code class="varname">FORBIDDEN</code></a>, либо добавить в порт ваш
      собственный патч.  В случае уязвимости порта просто исправьте
      этот порт как можно скорее.  В любом случае нужно следовать
      <a class="link" href="#port-upgrading" title="Глава 10. Обновление отдельного порта">стандартной процедуре отправки
	вашего изменения</a>, если вы не обладаете правами на
      коммит изменения непосредственно в дерево портов.</p><div xmlns="" class="important"><h3 class="admontitle">Важно: </h3><p xmlns="http://www.w3.org/1999/xhtml">Быть коммиттером портов недостаточно для коммита
	произвольного порта.  Помните, что обычно у портов есть
	сопровождающие, мнение которых вы должны учитывать.</p></div><p>Пожалуйста, убедитесь, что ревизия порта после закрытия
      уязвимости увеличена.  Вот как пользователи, обновляющие
      установленные пакеты на постоянной основе, увидят, что им нужно
      запустить обновление.  Кроме того, новый пакет будет собран и
      распространен через FTP и WWW зеркала, замещая уязвимый.  Если
      в процессе исправления уязвимости не было изменено значение
      <code class="varname">PORTVERSION</code>, то должно быть увеличено
      значение <code class="varname">PORTREVISION</code>.  Вам следует
      увеличить значение <code class="varname">PORTREVISION</code> после
      добавления в порт файла с патчем, но не когда вы обновили порт
      до последней версии программного обеспечения, попутно затронув
      при этом <code class="varname">PORTVERSION</code>.  За дальнейшей
      информацией обращайтесь к <a class="link" href="#makefile-naming-revepoch" title="5.2.2. PORTREVISION и PORTEPOCH">соответствующему
	разделу</a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="security-notify"></a>11.3. Обеспечение сообщества информацией</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="security-notify-vuxml-db"></a>11.3.1. База данных VuXML</h3></div></div></div><p>Очень важным и первостепенным шагом при действии как
	можно раньше после раскрытия уязвимости является уведомление
	сообщества пользователей порта об опасности.  Такие
	уведомления служат двум целям.  Во-первых, в случае
	действительно серьезной угрозы, будет посоветовано применить
	мгновенное воздействие.  Например, остановить затрагиваемый
	сетевой сервис или даже удалить порт целиком, пока уязвимость
	не будет устранена.  Во-вторых, масса пользователей имеет
	тенденцию обновлять установленные пакеты только от случая к
	случаю.  Из уведомления они узнают, что
	<span class="emphasis"><em>должны</em></span> обновить пакет без промедления
	сразу же после появления исправленной версии.</p><p>Учитывая огромное число портов в дереве, невозможно по
	каждому случаю выпускать бюллетень безопасности без создания
	флуда и потери внимания сообщества к моменту появления
	действительно серьезных причин.  Поэтому уязвимости
	безопасности, обнаруженные в портах, записываются в <a class="link" href="http://vuxml.freebsd.org/" target="_top">базу данных FreeBSD
	  VuXML</a>.  Члены Команды Офицеров Безопасности также
	отслеживают её на предмет появления вопросов, требующих их
	вмешательства.</p><p>Если вы обладаете правами коммиттера, вы можете сам
	обновить базу данных VuXML.  Так вы поможете Команде Офицеров
	Безопасности и своевременно пошлете ценную информацию
	сообществу.  Тем не менее, если вы не являетесь коммиттером
	или верите, что нашли исключительно серьезную уязвимость, то
	не задумываясь свяжитесь с Командой Офицеров Безопасности
	напрямую как это описано на странице <a class="link" href="http://www.freebsd.org/security/#how" target="_top">информационной
	  безопасности FreeBSD</a>.</p><p>База данных VuXML является документом
	<acronym class="acronym">XML</acronym>.  Его исходный файл
	<code class="filename">vuln.xml</code> содержится прямо внутри порта
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/vuxml/pkg-descr">security/vuxml</a>.
	Следовательно, полное имя пути к файлу будет
	<code class="filename">PORTSDIR/security/vuxml/vuln.xml</code>.
	Каждый раз, при обнаружении вами в порте уязвимости
	безопасности добавьте об этом запись в этот файл.  Пока вы не
	знакомы с VuXML, лучшее, что вы можете сделать, это найти
	существующую запись, подпадающую под ваш случай, затем
	скопировать ее и использовать в качестве шаблона.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="security-notify-vuxml-intro"></a>11.3.2. Короткое вступление в VuXML</h3></div></div></div><p>В совокупности <acronym class="acronym">XML</acronym> является очень
	сложным форматом, и его описание выходит далеко за рамки этой
	книги.  Тем не менее, для достижения основного понимания
	структуры записи VuXML вам понадобится всего лишь понять
	теги.  Имена тегов XML обрамляются в угловые скобки.  Каждый
	открывающий &lt;tag&gt; должен иметь совпадающий закрывающий
	&lt;/tag&gt;.  Теги могут быть вложенными.  При вложенности
	внутренние теги должны быть закрыты до закрытия внешних.
	Существует иерархия тегов, т.е. более сложные правила
	вкладывания тегов.  Это похоже на HTML.  Основное отличие в
	расширяемости XML, т.е. в определении собственных тегов.
	Из-за своей характерной структуры XML придает форму
	разрозненным данным.  В частности, XML подходит для разметки
	описаний уязвимостей безопасности.</p><p>Теперь рассмотрим настоящую запись VuXML:</p><pre class="programlisting">&lt;vuln vid="f4bc80f4-da62-11d8-90ea-0004ac98a7b9"&gt; <a id="co-vx-vid"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
  &lt;topic&gt;Several vulnerabilities found in Foo&lt;/topic&gt; <a id="co-vx-top"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>
  &lt;affects&gt;
    &lt;package&gt;
      &lt;name&gt;foo&lt;/name&gt; <a id="co-vx-nam"></a><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span>
      &lt;name&gt;foo-devel&lt;/name&gt;
      &lt;name&gt;ja-foo&lt;/name&gt;
      &lt;range&gt;&lt;ge&gt;1.6&lt;/ge&gt;&lt;lt&gt;1.9&lt;/lt&gt;&lt;/range&gt; <a id="co-vx-rng"></a><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span>
      &lt;range&gt;&lt;ge&gt;2.*&lt;/ge&gt;&lt;lt&gt;2.4_1&lt;/lt&gt;&lt;/range&gt;
      &lt;range&gt;&lt;eq&gt;3.0b1&lt;/eq&gt;&lt;/range&gt;
    &lt;/package&gt;
    &lt;package&gt;
      &lt;name&gt;openfoo&lt;/name&gt; <a id="co-vx-nm2"></a><span><img src="./imagelib/callouts/5.png" alt="5" border="0" /></span>
      &lt;range&gt;&lt;lt&gt;1.10_7&lt;/lt&gt;&lt;/range&gt; <a id="co-vx-epo"></a><span><img src="./imagelib/callouts/6.png" alt="6" border="0" /></span>
      &lt;range&gt;&lt;ge&gt;1.2,1&lt;/ge&gt;&lt;lt&gt;1.3_1,1&lt;/lt&gt;&lt;/range&gt;
    &lt;/package&gt;
  &lt;/affects&gt;
  &lt;description&gt;
    &lt;body xmlns="http://www.w3.org/1999/xhtml"&gt;
      &lt;p&gt;J. Random Hacker reports:&lt;/p&gt; <a id="co-vx-bdy"></a><span><img src="./imagelib/callouts/7.png" alt="7" border="0" /></span>
      &lt;blockquote
        cite="http://j.r.hacker.com/advisories/1"&gt;
        &lt;p&gt;Several issues in the Foo software may be exploited
          via carefully crafted QUUX requests.  These requests will
          permit the injection of Bar code, mumble theft, and the
          readability of the Foo administrator account.&lt;/p&gt;
      &lt;/blockquote&gt;
    &lt;/body&gt;
  &lt;/description&gt;
  &lt;references&gt; <a id="co-vx-ref"></a><span><img src="./imagelib/callouts/8.png" alt="8" border="0" /></span>
    &lt;freebsdsa&gt;SA-10:75.foo&lt;/freebsdsa&gt; <a id="co-vx-fsa"></a><span><img src="./imagelib/callouts/9.png" alt="9" border="0" /></span>
    &lt;freebsdpr&gt;ports/987654&lt;/freebsdpr&gt; <a id="co-vx-fpr"></a><span><img src="./imagelib/callouts/10.png" alt="10" border="0" /></span>
    &lt;cvename&gt;CAN-2010-0201&lt;/cvename&gt; <a id="co-vx-cve"></a><span><img src="./imagelib/callouts/11.png" alt="11" border="0" /></span>
    &lt;cvename&gt;CAN-2010-0466&lt;/cvename&gt;
    &lt;bid&gt;96298&lt;/bid&gt; <a id="co-vx-bid"></a><span><img src="./imagelib/callouts/12.png" alt="12" border="0" /></span>
    &lt;certsa&gt;CA-2010-99&lt;/certsa&gt; <a id="co-vx-cts"></a><span><img src="./imagelib/callouts/13.png" alt="13" border="0" /></span>
    &lt;certvu&gt;740169&lt;/certvu&gt; <a id="co-vx-ctv"></a><span><img src="./imagelib/callouts/14.png" alt="14" border="0" /></span>
    &lt;uscertsa&gt;SA10-99A&lt;/uscertsa&gt; <a id="co-vx-ucs"></a><span><img src="./imagelib/callouts/15.png" alt="15" border="0" /></span>
    &lt;uscertta&gt;SA10-99A&lt;/uscertta&gt; <a id="co-vx-uct"></a><span><img src="./imagelib/callouts/16.png" alt="16" border="0" /></span>
    &lt;mlist msgid="201075606@hacker.com"&gt;http://marc.theaimsgroup.com/?l=bugtraq&amp;amp;m=203886607825605&lt;/mlist&gt; <a id="co-vx-mls"></a><span><img src="./imagelib/callouts/17.png" alt="17" border="0" /></span>
    &lt;url&gt;http://j.r.hacker.com/advisories/1&lt;/url&gt; <a id="co-vx-url"></a><span><img src="./imagelib/callouts/18.png" alt="18" border="0" /></span>
  &lt;/references&gt;
  &lt;dates&gt;
    &lt;discovery&gt;2010-05-25&lt;/discovery&gt; <a id="co-vx-dsc"></a><span><img src="./imagelib/callouts/19.png" alt="19" border="0" /></span>
    &lt;entry&gt;2010-07-13&lt;/entry&gt; <a id="co-vx-ent"></a><span><img src="./imagelib/callouts/20.png" alt="20" border="0" /></span>
    &lt;modified&gt;2010-09-17&lt;/modified&gt; <a id="co-vx-mod"></a><span><img src="./imagelib/callouts/21.png" alt="21" border="0" /></span>
  &lt;/dates&gt;
&lt;/vuln&gt;</pre><p>Имена тегов должны быть самодокументируемыми, чтобы мы
	сфокусировались только на полях, нужных нам для
	заполнения:</p><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-vid"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Это тег верхнего уровня записи VuXML.  У него есть
	    обязательный атрибут <code class="literal">vid</code>, указывающий
	    на универсальный уникальный идентификатор (UUID) для этой
	    записи (в кавычках).  Вы должны формировать UUID для
	    каждой новой записи VuXML (и не забудьте заменить ее для
	    шаблона UUID, если вы не пишете запись с нуля).  Для
	    получения VuXML UUID вы можете использовать
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=uuidgen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">uuidgen</span>(1)</span></a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-top"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Однострочное описание найденной проблемы.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-nam"><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Здесь перечислены имена затронутых пакетов.  Может
	    быть дано несколько имен, поскольку некоторые пакеты
	    могут быть основаны на одном главном порте или
	    программном продукте.  Сюда можно включить стабильную
	    ветвь и ветвь разработки, локализованные версии и
	    подчиненные порты, зависящие от различного выбора важных
	    вариантов конфигурации, указанных на этапе
	    построения.</p><div xmlns="" class="important"><h3 class="admontitle">Важно: </h3><p xmlns="http://www.w3.org/1999/xhtml">Поиск всех подобных пакетов при написании записи
	      VuXML входит в зону вашей ответственности.  Имейте в
	      виду, что <code class="literal">make search name=foo</code> это
	      ваш друг.  Первичные точки для поиска следующие:</p><div xmlns="http://www.w3.org/1999/xhtml" class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>вариант <code class="filename">foo-devel</code> для
		  порта <code class="filename">foo</code>;</p></li><li class="listitem"><p>другие варианты с суффиксами вида
		  <code class="literal">-a4</code> (для пакетов, связанных с
		  печатью), <code class="literal">-without-gui</code> (для
		  пакетов с отключенной поддержкой X), или
		  подобных;</p></li><li class="listitem"><p><code class="literal">jp-</code>, <code class="literal">ru-</code>,
		  <code class="literal">zh-</code> и другие возможные
		  локализованные варианты в соответствующих
		  национальных категориях коллекции портов.</p></li></ul></div></div></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-rng"><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Здесь указаны затронутые версии пакета(-ов) как один
	    или более диапазонов с использованием комбинации
	    элементов <code class="literal">&lt;lt&gt;</code>,
	    <code class="literal">&lt;le&gt;</code>,
	    <code class="literal">&lt;eq&gt;</code>,
	    <code class="literal">&lt;ge&gt;</code>, и
	    <code class="literal">&lt;gt&gt;</code>.  Диапазоны внесённых
	    версий не должны пересекаться.</p><p>В спецификации диапазонов <code class="literal">*</code>
	    (звёздочка) означает наименьший номер версии.  В
	    частности, <code class="literal">2.*</code> меньше, чем
	    <code class="literal">2.a</code>.  Поэтому звездочка может быть
	    использована в диапазоне для совпадения со всеми
	    возможными <code class="literal">alpha</code>,
	    <code class="literal">beta</code> и <code class="literal">RC</code> версиями.
	    Как вариант,
	    <code class="literal">&lt;ge&gt;2.*&lt;/ge&gt;&lt;lt&gt;3.*&lt;/lt&gt;</code>
	    выборочно совпадет с версией <code class="literal">2.x</code>, а
	    <code class="literal">&lt;ge&gt;2.0&lt;/ge&gt;&lt;lt&gt;3.0&lt;/lt&gt;</code>
	    - нет, поскольку последнее не включает
	    <code class="literal">2.r3</code> и совпадает с
	    <code class="literal">3.b</code>.</p><p>Пример выше указывает, что к затронутым относятся
	    версии с <code class="literal">1.6</code> до <code class="literal">1.9</code>
	    включительно, версии <code class="literal">2.x</code> до
	    <code class="literal">2.4_1</code> и версия
	    <code class="literal">3.0b1</code>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-nm2"><span><img src="./imagelib/callouts/5.png" alt="5" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Некоторые связанные группы пакетов (в конечном счете,
	    порты) могут быть указаны в разделе
	    <code class="literal">&lt;affected&gt;</code>.  Это можно
	    использовать, если некоторые программные продукты
	    (скажем, FooBar, FreeBar and OpenBar) являются
	    производными от общей кодовой базы и всё еще совместно
	    используют её ошибки и уязвимости.  Имейте в виду отличие
	    от перечисления множественных имён в одном разделе
	    &lt;package&gt;.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-epo"><span><img src="./imagelib/callouts/6.png" alt="6" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Диапазоны версий должны учитывать
	    <code class="varname">PORTEPOCH</code> и
	    <code class="varname">PORTREVISION</code>, если это применимо.
	    Пожалуйста, помните, что в соответствии с правилами
	    сравнения строк версия с ненулевым значением
	    <code class="varname">PORTEPOCH</code> выше, чем любая версия без
	    <code class="varname">PORTEPOCH</code>, например,
	    <code class="literal">3.0,1</code> выше, чем <code class="literal">3.1</code>
	    или даже <code class="literal">8.9</code>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-bdy"><span><img src="./imagelib/callouts/7.png" alt="7" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Сводная информация о проблеме.  В этом поле
	    используется XHTML.  По крайней мере, должны быть
	    обрамляющие <code class="literal">&lt;p&gt;</code> и
	    <code class="literal">&lt;/p&gt;</code>.  Может быть использована
	    более сложная разметка, но только в целях аккуратности и
	    ясности: без эстетства, пожалуйста.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-ref"><span><img src="./imagelib/callouts/8.png" alt="8" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Этот раздел содержит ссылки на имеющие отношение
	    документы.  Приветствуется как можно большее количество
	    ссылок.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-fsa"><span><img src="./imagelib/callouts/9.png" alt="9" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Это <a class="link" href="http://www.freebsd.org/security/#adv" target="_top">бюллетень
	      безопасности FreeBSD</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-fpr"><span><img src="./imagelib/callouts/10.png" alt="10" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Это <a class="link" href="http://www.freebsd.org/support.html#gnats" target="_top">сообщение
	      об ошибке FreeBSD</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-cve"><span><img src="./imagelib/callouts/11.png" alt="11" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Идентификатор <a class="link" href="http://www.cve.mitre.org/" target="_top">MITRE
	      CVE</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-bid"><span><img src="./imagelib/callouts/12.png" alt="12" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Это <a class="link" href="http://www.securityfocus.com/bid" target="_top">SecurityFocus
	      Bug ID</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-cts"><span><img src="./imagelib/callouts/13.png" alt="13" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Бюллетень безопасности <a class="link" href="http://www.cert.org/" target="_top">US-CERT</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-ctv"><span><img src="./imagelib/callouts/14.png" alt="14" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Примечание к уязвимости <a class="link" href="http://www.cert.org/" target="_top">US-CERT</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-ucs"><span><img src="./imagelib/callouts/15.png" alt="15" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Уведомление системы Cyber Security Alert <a class="link" href="http://www.cert.org/" target="_top">US-CERT</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-uct"><span><img src="./imagelib/callouts/16.png" alt="16" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Уведомление системы Technical Cyber Security Alert
	    <a class="link" href="http://www.cert.org/" target="_top">US-CERT</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-mls"><span><img src="./imagelib/callouts/17.png" alt="17" border="0" /></span></a> </p></td><td valign="top" align="left"><p>URL к архивному сообщению в списке рассылки.  Атрибут
	    <code class="literal">msgid</code> является необязательным и может
	    указывать на message ID сообщения.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-url"><span><img src="./imagelib/callouts/18.png" alt="18" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Основной URL.  Должен быть использован в случае, если
	    не подходит ни одна из категорий источника.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-vx-dsc"><span><img src="./imagelib/callouts/19.png" alt="19" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Дата последнего изменения любой информации данной
	    записи (<em class="replaceable"><code>YYYY-MM-DD</code></em>).  Новые
	    записи не должны включать это поле.  Поле должно быть
	    добавлено после редактирования существующей
	    записи.</p></td></tr></table></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="security-notify-vuxml-testing"></a>11.3.3. Тестирование ваших изменений в базе данных VuXML</h3></div></div></div><p>Предположим, что вы только что написали или заполнили
	запись об уязвимости в пакете <code class="literal">clamav</code>,
	которая была исправлена в версии
	<code class="literal">0.65_7</code>.</p><p>Прежде всего, вам нужно <span class="emphasis"><em>установить</em></span>
	последние версии портов
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/portaudit/pkg-descr">ports-mgmt/portaudit</a>,
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/portaudit-db/pkg-descr">ports-mgmt/portaudit-db</a> и
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/vuxml/pkg-descr">security/vuxml</a>.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Для запуска <code class="command">packaudit</code> вы должны
	  обладать правами на запись в
	  <code class="filename">DATABASEDIR</code>; как правило, это
	  <code class="filename">/var/db/portaudit</code>.</p><p xmlns="http://www.w3.org/1999/xhtml">Для использования другого каталога присвойте переменной
	  окружения <code class="filename">DATABASEDIR</code> другой
	  путь.</p><p xmlns="http://www.w3.org/1999/xhtml">Если вы работаете в каталоге, отличном от
	  <code class="filename">${PORTSDIR}/security/vuxml</code>, присвойте
	  переменной окружения <code class="filename">VUXMLDIR</code> путь к
	  каталогу, в котором находится
	  <code class="filename">vuln.xml</code>.</p></div><p>Во-первых, проверьте, нет ли уже записи об этой
	уязвимости.  Если такая запись есть, она совпадёт с
	предыдущей версией пакета <code class="literal">0.65_6</code>:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>packaudit</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>portaudit clamav-0.65_6</code></strong></pre><p>Если ничего не найдено, значит вы получили зеленый свет
	для добавления новой записи для этой уязвимости.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>cd ${PORTSDIR}/security/vuxml</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>make newentry</code></strong></pre><p>Когда вы закончите, проверьте синтаксис и
	форматирование.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>make validate</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Вам понадобится установить по крайней мере один из
	  следующих пакетов:
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/textproc/libxml2/pkg-descr">textproc/libxml2</a>,
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/textproc/jade/pkg-descr">textproc/jade</a>.</p></div><p>Теперь выполните перепостроение базы данных
	<code class="command">portaudit</code> из файла VuXML:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>packaudit</code></strong></pre><p>Чтобы убедиться, что раздел
	<code class="literal">&lt;affected&gt;</code> в вашей записи совпадает
	с правильными пакетами, выполните следующую команду:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>portaudit -f /usr/ports/INDEX -r uuid</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Для лучшего понимания синтаксиса этой команды
	  обращайтесь к <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=portaudit&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">portaudit</span>(1)</span></a>.</p></div><p>Убедитесь, что ваша запись не производит ложных
	совпадений в выводе.</p><p>Теперь проверьте, совпадает ли ваша запись с нужными
	версиями пакета:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>portaudit clamav-0.65_6 clamav-0.65_7</code></strong>
Affected package: clamav-0.65_6 (matched by clamav&lt;0.65_7)
Type of problem: clamav remote denial-of-service.
Reference: &lt;http://www.freebsd.org/ports/portaudit/74a9541d-5d6c-11d8-80e3-0020ed76ef5a.html&gt;

1 problem(s) found.</pre><p>Первая версия должна совпасть, а последняя нет.</p><p>В заключение проверьте, что веб-страница, сформированная
	из базы данных VuXML, выглядит как положено:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>mkdir -p ~/public_html/portaudit</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>packaudit</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>lynx ~/public_html/portaudit/74a9541d-5d6c-11d8-80e3-0020ed76ef5a.html</code></strong></pre></div></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-dads"></a>Глава 12. Что делать нужно, и что делать нельзя</h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#dads-intro">12.1. Введение</a></span></dt><dt><span class="sect1"><a href="#porting-wrkdir">12.2. <code class="varname">WRKDIR</code></a></span></dt><dt><span class="sect1"><a href="#porting-wrkdirprefix">12.3. <code class="varname">WRKDIRPREFIX</code></a></span></dt><dt><span class="sect1"><a href="#porting-versions">12.4. Различение операционных систем и версий ОС</a></span></dt><dt><span class="sect1"><a href="#dads-after-port-mk">12.5. Написание чего-либо после
      <code class="filename">bsd.port.mk</code></a></span></dt><dt><span class="sect1"><a href="#dads-sh-exec">12.6. Использование выражения <code class="function">exec</code>
      в сценариях обёртках</a></span></dt><dt><span class="sect1"><a href="#dads-rational">12.7. Поступайте разумно</a></span></dt><dt><span class="sect1"><a href="#dads-cc">12.8. Работа как с <code class="varname">CC</code>, так и
      <code class="varname">CXX</code></a></span></dt><dt><span class="sect1"><a href="#dads-cflags">12.9. Использование <code class="varname">CFLAGS</code></a></span></dt><dt><span class="sect1"><a href="#dads-pthread">12.10. Библиотеки потоков</a></span></dt><dt><span class="sect1"><a href="#dads-feedback">12.11. Пожелания</a></span></dt><dt><span class="sect1"><a href="#dads-readme">12.12. <code class="filename">README.html</code></a></span></dt><dt><span class="sect1"><a href="#dads-noinstall">12.13. Пометка неустанавливаемого порта как
      <code class="varname">BROKEN</code>, <code class="varname">FORBIDDEN</code> или
      <code class="varname">IGNORE</code></a></span></dt><dt><span class="sect1"><a href="#dads-deprecated">12.14. Пометка порта на удаление с <code class="varname">DEPRECATED</code>
      или <code class="varname">EXPIRATION_DATE</code></a></span></dt><dt><span class="sect1"><a href="#dads-dot-error">12.15. Избегайте использования конструкции
      <code class="literal">.error</code></a></span></dt><dt><span class="sect1"><a href="#dads-sysctl">12.16. Использование <code class="filename">sysctl</code></a></span></dt><dt><span class="sect1"><a href="#dads-rerolling-distfiles">12.17. Меняющиеся дистрибутивные файлы</a></span></dt><dt><span class="sect1"><a href="#dads-avoiding-linuxisms">12.18. Избегание линуксизмов</a></span></dt><dt><span class="sect1"><a href="#dads-misc">12.19. Разное</a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-intro"></a>12.1. Введение</h2></div></div></div><p>Вот список часто встречающихся действий, которые нужно и
      которые нельзя делать во время процесса портирования.
      Проверьте порт по этому списку, и также проверьте порты в <a class="link" href="http://www.FreeBSD.org/cgi/query-pr-summary.cgi?query" target="_top">базе
	сообщений PR</a>, которые присланы другими людьми.
      Присылайте любые комментарии о портах, которые вы проверили,
      так, как это описано в статье о <a class="link" href="../../../../doc/ru_RU.KOI8-R/articles/contributing/contrib-how.html#CONTRIB-GENERAL" target="_top">
	Сообщениях об ошибках и общих замечаниях</a>.  Проверка
      портов в базе сообщений PR позволит нам быстрее коммиттить их и
      удостовериться, что вы знаете, что делаете.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-wrkdir"></a>12.2. <code class="varname">WRKDIR</code></h2></div></div></div><p>Не пишите ничего в файлы вне каталога
      <code class="varname">WRKDIR</code>.  Каталог <code class="varname">WRKDIR</code>
      является единственным местом, которое гарантированно будет
      доступно для записи во время построения порта (обратитесь к
      главе об <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/ports-using.html#PORTS-CD" target="_top">установке
	портов с CDROM</a> за примером построения портов из
      дерева, доступного только для чтения).  Если вам нужно изменить
      какой-либо из файлов <code class="filename">pkg-*</code>, сделайте это,
      <a class="link" href="#porting-pkgfiles">переопределив
	переменную</a>, но не перезаписывая их.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-wrkdirprefix"></a>12.3. <code class="varname">WRKDIRPREFIX</code></h2></div></div></div><p>Добейтесь того, чтобы ваш порт принимал во внимание
      значение переменной <code class="varname">WRKDIRPREFIX</code>.
      Большинство портов об этом не заботятся.  В частности, если вы
      обращаетесь к каталогу <code class="varname">WRKDIR</code> другого порта,
      заметьте, что его правильным местоположением является
      <code class="filename">WRKDIRPREFIXPORTSDIR/subdir/name/work</code>, а
      не <code class="filename">PORTSDIR/subdir/work</code> или
      <code class="filename">.CURDIR/../../subdir/name/work</code> мли что-то
      подобное.</p><p>Кроме того, если вы сами задаете <code class="varname">WRKDIR</code>,
      то должны поставить перед ним знак
      <code class="literal">${WRKDIRPREFIX}${.CURDIR}</code>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-versions"></a>12.4. Различение операционных систем и версий ОС</h2></div></div></div><p>Вы можете встретиться с кодом, который требует модификаций
      или условной компиляции в зависимости от того, с какой версией
      FreeBSD Unix он работает.  Предпочтительным способом отделения
      кода для версий FreeBSD является использование макросов
      <code class="literal">__FreeBSD_version</code> и
      <code class="literal">__FreeBSD__</code>, определённых в <a class="link" href="http://svnweb.freebsd.org/base/head/sys/sys/param.h?view=markup" target="_top">sys/param.h</a>.
      Если этот файл не подключен, добавьте код</p><pre class="programlisting">#include &lt;sys/param.h&gt;</pre><p>в нужном месте файла <code class="filename">.c</code>.</p><p><code class="literal">__FreeBSD__</code> определён во всех версиях
      FreeBSD в качестве старшего номера версии системы.  Например, в
      FreeBSD 9.x <code class="literal">__FreeBSD__</code> определён со значением
      <code class="literal">9</code>.</p><pre class="programlisting">#if __FreeBSD__ &gt;= 9
#  if __FreeBSD_version &gt;= 901000
	 /* здесь особый код для версий 9.1+ */
#  endif
#endif</pre></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-after-port-mk"></a>12.5. Написание чего-либо после
      <code class="filename">bsd.port.mk</code></h2></div></div></div><p>Не пишите ничего после строки
      <code class="literal">.include &lt;bsd.port.mk&gt;</code>.  Этой строки
      можно избежать, включив в где-то в середину вашего файла
      <code class="filename">Makefile</code> файл
      <code class="filename">bsd.port.pre.mk</code>, и файл
      <code class="filename">bsd.port.post.mk</code> в конец.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Вам нужно включить либо пару файлов
	<code class="filename">bsd.port.pre.mk</code>/<code class="filename">bsd.port.post.mk</code>,
	либо только <code class="filename">bsd.port.mk</code>; не используйте
	оба этих метода одновременно.</p></div><p>В файле <code class="filename">bsd.port.pre.mk</code> определяются
      лишь несколько переменных, которые могут быть использованы в
      тестах из файла <code class="filename">Makefile</code>, в файле
      <code class="filename">bsd.port.post.mk</code> заданы остальные.</p><p>Вот некоторые важные переменные, определенные в файле
      <code class="filename">bsd.port.pre.mk</code> (это не полный список, для
      выяснения полного списка прочтите, пожалуйста, сам файл
      <code class="filename">bsd.port.mk</code>).</p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Переменная</th><th>Описание</th></tr></thead><tbody><tr><td><code class="varname">ARCH</code></td><td>Архитектура машины в виде, получаемом по команде
	      <code class="command">uname -m</code> (например,
	      <code class="literal">i386</code>)</td></tr><tr><td><code class="varname">OPSYS</code></td><td>Тип операционной системы, получаемый по команде
	      <code class="command">uname -s</code> (например,
	      <code class="literal">FreeBSD</code>)</td></tr><tr><td><code class="varname">OSREL</code></td><td>Версия релиза операционной системы (например,
	      <code class="literal">2.1.5</code> или
	      <code class="literal">2.2.7</code>)</td></tr><tr><td><code class="varname">OSVERSION</code></td><td>Версия операционной системы в виде числа, та же,
	      что и <a class="link" href="#freebsd-versions" title="15.2. Значения __FreeBSD_version">
		<code class="literal">__FreeBSD_version</code></a>.</td></tr><tr><td><code class="varname">LOCALBASE</code></td><td>Корень дерева <span class="quote"><<<span class="quote">local</span>>></span> (например,
	      <code class="literal">/usr/local</code>)</td></tr><tr><td><code class="varname">PREFIX</code></td><td>Куда, собственно, устанавливается порт (обратитесь
	      к <a class="link" href="#porting-prefix" title="9.4. PREFIX и DESTDIR">подробной информации о
		<code class="varname">PREFIX</code></a>).</td></tr></tbody></table></div><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если вы задаете переменную <code class="varname">MASTERDIR</code>,
	делайте это до подключения
	<code class="filename">bsd.port.pre.mk</code>.</p></div><p>Вот несколько примеров того, что вы можете написать после
      <code class="filename">bsd.port.pre.mk</code>:</p><pre class="programlisting"># no need to compile lang/perl5 if perl5 is already in system
.if ${OSVERSION} &gt; 300003
BROKEN=	perl is in system
.endif</pre><p>Вы не забываете об использовании табуляции вместо пробелов
      после <code class="literal">BROKEN=</code>:-).</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-sh-exec"></a>12.6. Использование выражения <code class="function">exec</code>
      в сценариях обёртках</h2></div></div></div><p>Если порт устанавливает сценарий на языке shell, который
      служит для запуска другой программы, и если запуск этой
      программы является последним действием сценария, убедитесь, что
      запуск программы производится с использованием выражения
      <code class="function">exec</code>, например:</p><pre class="programlisting">#!/bin/sh
exec %%LOCALBASE%%/bin/java -jar %%DATADIR%%/foo.jar "$@"</pre><p>Выражение <code class="function">exec</code> заменяет процесс
      сценария на указанную программу.  Если
      <code class="function">exec</code> опущен, то процесс сценария во время
      работы программы остается в памяти, бесполезно потребляя
      системные ресурсы.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-rational"></a>12.7. Поступайте разумно</h2></div></div></div><p>Файл <code class="filename">Makefile</code> должен выполнять
      действия просто и небеспричинно.  Если вы можете сделать что-то
      на несколько строк короче или более читабельно, сделайте это.
      В качестве примеров можно привести использование конструкций
      <code class="literal">.if</code> утилиты make вместо соответствующей
      конструкции <code class="literal">if</code> командного процессора,
      ненужность переопределения цели
      <code class="buildtarget">do-extract</code> при возможности
      переопределения <code class="varname">EXTRACT*</code> и использование
      <code class="varname">GNU_CONFIGURE</code> вместо
      <code class="literal">CONFIGURE_ARGS
	+= --prefix=${PREFIX}</code>.</p><p>Если вы обнаружите, что для выполнения чего-то приходится
      писать много нового кода, то, пожалуйста, просмотрите файл
      <code class="filename">bsd.port.mk</code> на предмет того, не содержит
      ли он решение именно вашей проблемы.  Хотя его трудно читать,
      имеется много проблем, выглядящих сложными, для которых файл
      <code class="filename">bsd.port.mk</code> уже содержит быстрое
      решение.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-cc"></a>12.8. Работа как с <code class="varname">CC</code>, так и
      <code class="varname">CXX</code></h2></div></div></div><p>Порт должен принимать во внимание как переменную
      <code class="varname">CC</code>, так и <code class="varname">CXX</code>.  Под этим
      мы подразумеваем, что порт ни в коем случае не должен
      устанавливать значения этих переменных, переопределяя имеющиеся
      значения; вместо этого можно добавлять нужные значения к уже
      имеющимся.  Это связано с тем, что параметры построения,
      относящиеся ко всем портам, могут быть заданы глобально.</p><p>Если порты не учитывают значения этих переменных, добавьте
      строку <code class="literal">NO_PACKAGE=ignores either cc or cxx</code>
      в файл <code class="filename">Makefile</code>.</p><p>Далее следует пример файла <code class="filename">Makefile</code>,
      использующего как переменную <code class="varname">CC</code>, так и
      <code class="varname">CXX</code>.  Обратите внимание на использование
      символов <code class="varname">?=</code>:</p><pre class="programlisting">CC?= gcc</pre><pre class="programlisting">CXX?= g++</pre><p>Вот пример, в котором не принимаются во внимание ни
      <code class="varname">CC</code>, ни <code class="varname">CXX</code>:</p><pre class="programlisting">CC= gcc</pre><pre class="programlisting">CXX= g++</pre><p>В системах FreeBSD обе переменные <code class="varname">CC</code> и
      <code class="varname">CXX</code> могут быть определены в файле
      <code class="filename">/etc/make.conf</code>.  В первом примере задаётся
      значение, если оно ранее не было определено в
      <code class="filename">/etc/make.conf</code>, что сохраняет любые
      определения, данные на уровне системы в целом.  Второй пример
      переопределяет всё, что было задано ранее.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-cflags"></a>12.9. Использование <code class="varname">CFLAGS</code></h2></div></div></div><p>Порт должен учитывать переменную <code class="varname">CFLAGS</code>.
      Под этим мы подразумеваем, что порт ни в коем случае не должен
      устанавливать значения этой переменной, переопределяя имеющиеся
      значения; вместо этого можно добавлять нужные значения к уже
      имеющимся.  Это связано с тем, что параметры построения,
      относящиеся ко всем портам, могут быть заданы глобально.</p><p>Если порты не учитывают значения этой переменной, добавьте
      строку <code class="literal">NO_PACKAGE=ignores cflags</code> в файл
      <code class="filename">Makefile</code>.</p><p>Далее следует пример файла <code class="filename">Makefile</code>,
      использующего переменную <code class="varname">CFLAGS</code>.  Обратите
      внимание на использование символов <code class="varname">+=</code>:</p><pre class="programlisting">CFLAGS+= -Wall -Werror</pre><p>А вот пример, в котором не учитывается значение переменной
      <code class="varname">CFLAGS</code>:</p><pre class="programlisting">CFLAGS= -Wall -Werror</pre><p>В системе FreeBSD переменная <code class="varname">CFLAGS</code>
      определена в файле <code class="filename">/etc/make.conf</code>.  В
      первом примере к переменной <code class="varname">CFLAGS</code>
      добавляются дополнительные флаги, при этом сохраняются все
      определения, данные ранее на уровне системы.  Во втором примере
      всё, что было задано ранее, игнорируется.</p><p>Из сторонних файлов <code class="filename">Makefile</code> следует
      удалить флаги оптимизации.  Общесистемные флаги оптимизации
      находятся в системной переменной <code class="varname">CFLAGS</code>.
      Пример из немодифицированного
      <code class="filename">Makefile</code>:</p><pre class="programlisting">CFLAGS= -O3 -funroll-loops -DHAVE_SOUND</pre><p>При использовании системных флагов оптимизации
      <code class="filename">Makefile</code> станет похожим на следующий
      пример:</p><pre class="programlisting">CFLAGS+= -DHAVE_SOUND</pre></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-pthread"></a>12.10. Библиотеки потоков</h2></div></div></div><p>Во FreeBSD библиотека потоков обязана быть скомпонована с
      исполняемыми файлами с использованием специального флага
      <code class="literal">-pthread</code>.  Если порт настаивает на прямой
      компоновке с <code class="literal">-lpthread</code>, создайте патч для
      использования <code class="literal">-pthread</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если построение порта заканчивается ошибкой
	<code class="literal">unrecognized option '-pthread'</code>, то может
	быть желательно использование <code class="command">cc</code> в
	качестве компоновщика через установку
	<code class="varname">CONFIGURE_ENV</code> в
	<code class="literal">LD=${CC}</code>.  Параметр
	<code class="literal">-pthread</code> напрямую командой
	<code class="command">ld</code> не поддерживается.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-feedback"></a>12.11. Пожелания</h2></div></div></div><p>Посылайте подходящие изменения/патчи автору/сопровождающему
      для включения в следующий релиз.  Это только сделает вашу
      работу гораздо легче при выходе следующего релиза.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-readme"></a>12.12. <code class="filename">README.html</code></h2></div></div></div><p><code class="filename">README.html</code> не является частью порта
      и генерируется при помощи <code class="command">make readme</code>.
      Не включайте этот файл в патчи или коммиты.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если не удается выполнить <code class="command">make readme</code>,
	убедитесь, что значение по умолчанию
	<code class="varname">ECHO_MSG</code> не изменено внутри порта.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-noinstall"></a>12.13. Пометка неустанавливаемого порта как
      <code class="varname">BROKEN</code>, <code class="varname">FORBIDDEN</code> или
      <code class="varname">IGNORE</code></h2></div></div></div><p>В некоторых случаях пользователи не должны допускаться к
      установке порта.  Для того, чтобы сообщить пользователю, что
      порт не следует устанавливать, имеется несколько
      <code class="command">make</code>-переменных, которые могут быть
      использованы в файле <code class="filename">Makefile</code> порта.
      Значения следующих <code class="command">make</code>-переменных будут
      причиной, возвращаемой пользователям, по которой порт
      отказывает в установке.  Пожалуйста, используйте корректные
      <code class="command">make</code>-переменные, так как каждая переменная
      make передает абсолютно различный смысл как для пользователей,
      так и для автоматизированных систем, которые полагаются на
      файлы <code class="filename">Makefile</code>, таких как <a class="link" href="#build-cluster" title="14.4. Кластер построения портов FreeBSD">кластер построения портов</a>,
      <a class="link" href="#freshports" title="14.1. FreshPorts">FreshPorts</a> и <a class="link" href="#portsmon" title="14.6. Система мониторинга портов FreeBSD">portsmon</a>.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="dads-noinstall-variables"></a>12.13.1. Переменные</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">BROKEN</code> предназначена для портов,
	    которые в настоящее время не компилируются, не
	    устанавливаются или не удаляются правильно.  Следует
	    использовать, когда проблема считается временной.</p><p>В особых случаях кластер построения будет продолжать
	    попытки собрать их, чтобы показать, решена ли основная
	    проблема.  (Однако, как правило, кластер запускается без
	    этой возможности.)</p><p>В частности, используйте <code class="varname">BROKEN</code>,
	    когда порт:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>не компилируется</p></li><li class="listitem"><p>не выполняет процесс своей конфигурации или
		установки</p></li><li class="listitem"><p>устанавливает файлы вовне
		<code class="filename">${LOCALBASE}</code></p></li><li class="listitem"><p>не удаляет полностью все свои файлы при
		деинсталляции (тем не менее, это может быть
		допустимо, и подходит для портов, оставляющих после
		себя файлы, измененные пользователем)</p></li></ul></div></li><li class="listitem"><p><code class="varname">FORBIDDEN</code> используется для портов,
	    которые содержат уязвимости в информационной безопасности
	    или являются потенциально вредными в плане обеспечения
	    информационной безопасности системы FreeBSD при установке
	    данного порта (например: заведомо небезопасная программа
	    или программа, которая предоставляет легко взламываемые
	    сервисы).  Порты должны помечаться как
	    <code class="varname">FORBIDDEN</code>, как только в конкретном
	    программном обеспечении обнаружилась уязвимость, но
	    обновление выпущено не было.  В идеальном случае порты
	    должны обновляться максимально быстро после обнаружения
	    уязвимости, чтобы уменьшить число уязвимых хостов FreeBSD
	    (нам нравится иметь репутацию безопасной системы), однако
	    иногда случается значительный временной разрыв между
	    обнаружением уязвимости и выходом обновлённого релиза
	    уязвимого программного обеспечения.  Не помечайте порт
	    как <code class="varname">FORBIDDEN</code>, если причина не вызвана
	    соображениями информационной безопасности.</p></li><li class="listitem"><p><code class="varname">IGNORE</code> предназначена для портов,
	    которые не должны строиться по какой-либо другой причине.
	    Следует использовать для портов, в случае когда проблема
	    считается структурной.  Кластер построения ни при каких
	    условиях не будет строить порты, помеченные как
	    <code class="varname">IGNORE</code>.  В частности, используйте
	    <code class="varname">IGNORE</code>, когда порт:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>компилируется, но работает неправильно</p></li><li class="listitem"><p>не работает на установленной версии FreeBSD</p></li><li class="listitem"><p>имеет дистрибутивный файл, который не может быть
		автоматически извлечен из-за лицензионных
		ограничений</p></li><li class="listitem"><p>не работает с каким-либо другим портом,
		установленным в настоящее время (например, порт
		зависит от <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache20/pkg-descr">www/apache20</a>, но установлен
		<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache22/pkg-descr">www/apache22</a>)</p></li></ul></div><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если порт будет конфликтовать с уже установленным
	      портом (например, если они устанавливают файл в то же
	      место, но с иным функциональным назначением), то <a class="link" href="#conflicts" title="5.14. Разрешение конфликтов">используйте вместо этого
		<code class="varname">CONFLICTS</code></a>.
	      <code class="varname">CONFLICTS</code> сам установит значение
	      <code class="varname">IGNORE</code>.</p></div></li><li class="listitem"><p>Если порт нужно пометить как
	    <code class="varname">IGNORE</code> только на некоторых
	    архитектурах, для этого есть две другие удобные
	    переменные, которые автоматически установят для вас
	    значения: <code class="varname">ONLY_FOR_ARCHS</code> и
	    <code class="varname">NOT_FOR_ARCHS</code>.  Примеры:</p><pre class="programlisting">ONLY_FOR_ARCHS=	i386 amd64</pre><pre class="programlisting">NOT_FOR_ARCHS=	ia64 sparc64</pre><p>Собственное сообщение <code class="varname">IGNORE</code> можно
	    задать с использованием
	    <code class="varname">ONLY_FOR_ARCHS_REASON</code> и
	    <code class="varname">NOT_FOR_ARCHS_REASON</code>.  Отдельно для
	    каждой архитектуры это возможно с использованием
	    <code class="varname">ONLY_FOR_ARCHS_REASON_<em class="replaceable"><code>ARCH</code></em></code>
	    и
	    <code class="varname">NOT_FOR_ARCHS_REASON_<em class="replaceable"><code>ARCH</code></em></code>.</p></li><li class="listitem"><p>Если порт загружает и устанавливает исполняемые файлы
	    i386, то следует установить
	    <code class="varname">IA32_BINARY_PORT</code>.  Если эта переменная
	    установлена, будет выполнена проверка доступности
	    каталога <code class="filename">/usr/lib32</code> для библиотек
	    версии IA32 и поддержки IA32 в ядре.  При невыполнении
	    любого из этих условий будет автоматически установлена
	    переменная <code class="varname">IGNORE</code>.</p></li></ul></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="dads-noinstall-notes"></a>12.13.2. Замечания по реализации</h3></div></div></div><p>Строки не следует брать в кавычки.  Также построение
	строки должно несколько различаться из-за способа отображения
	информации пользователю.  Примеры:</p><pre class="programlisting">BROKEN=	fails to link with base -lcrypto</pre><pre class="programlisting">IGNORE=	unsupported on recent versions</pre><p>получаемые в результате следующего вывода
	<code class="command">make describe</code>:</p><pre class="programlisting">===&gt;  foobar-0.1 is marked as broken: fails to link with base -lcrypto.</pre><pre class="programlisting">===&gt;  foobar-0.1 is unsupported on recent versions.</pre></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-deprecated"></a>12.14. Пометка порта на удаление с <code class="varname">DEPRECATED</code>
      или <code class="varname">EXPIRATION_DATE</code></h2></div></div></div><p>Помните, что <code class="varname">BROKEN</code> и
      <code class="varname">FORBIDDEN</code> будут использованы как временное
      средство, если порт не является работающим.  Постоянно
      неработоспособные порты должны полностью удаляться из
      дерева.</p><p>В подходящих ситуациях пользователи могут быть оповещены о
      предстоящем удалении через переменные
      <code class="varname">DEPRECATED</code> и
      <code class="varname">EXPIRATION_DATE</code>.  Первое - это просто
      строка, сообщающая причину запланированного удаления порта;
      вторая является строкой в формате ISO 8601 (YYYY-MM-DD).  Обе
      будут показаны пользователю.</p><p>Переменную <code class="varname">DEPRECATED</code> можно установить
      без использования <code class="varname">EXPIRATION_DATE</code> (в
      частности, при рекомендации новой версии порта), но обратный
      порядок не имеет никакого смысла.</p><p>Не существует устоявшейся политики, как долго следует
      продолжать уведомления.  Текущая практика дает около месяца для
      решения проблем безопасности и два месяца для проблем
      построения.  Это также дает немного времени на исправление
      проблем любым заинтересованным коммиттерам.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-dot-error"></a>12.15. Избегайте использования конструкции
      <code class="literal">.error</code></h2></div></div></div><p>Правильным способом подать сигнал для
      <code class="filename">Makefile</code> о том, что порт не может быть
      установлен из-за какого-то внешнего фактора (например,
      пользователь указал недопустимую комбинацию опций построения),
      является установка непустого значения для
      <code class="varname">IGNORE</code>.  Это значение будет сформатировано и
      показано пользователю во время
      <code class="command">make install</code>.</p><p>Использование для этих целей <code class="literal">.error</code>
      является распространенной ошибкой.  Проблема в том, что в этой
      ситуации будут повреждены многие инструменты автоматизации,
      работающие с деревом портов.  Наибольшим образом это
      распространено при попытке построить
      <code class="filename">/usr/ports/INDEX</code> (смотрите <a class="xref" href="#make-describe" title="9.1. Запуск make describe">Раздел 9.1, <<Запуск <code class="command">make describe</code>>></a>).  Тем не менее, даже более простые
      команды, такие как <code class="command">make maintainer</code>, в этом
      случае также вернут ошибку.  Это не является приемлемым.</p><div class="example"><a id="dot-error-breaks-index"></a><div class="example-title">Пример 12.1. Как избегать использования
	<code class="literal">.error</code></div><div class="example-contents"><p>Из следующих двух вариантов строки файла
	<code class="filename">Makefile</code> первый приведёт к неудачному
	завершению работы <code class="command">make index</code>, а второй -
	нет:</p><pre class="programlisting">.error "option is not supported"</pre><pre class="programlisting">IGNORE=option is not supported</pre></div></div><br class="example-break" /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-sysctl"></a>12.16. Использование <code class="filename">sysctl</code></h2></div></div></div><p>Использование <code class="filename">sysctl</code> не рекомендуется,
      кроме как при выполнении целей.  Это вызвано тем, что
      вычисление любых <code class="literal">makevar</code>, таких как во время
      команды <code class="command">make index</code>, с необходимостью запуска
      этой команды, еще больше замедляет весь процесс.</p><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span></a> следует всегда использовать через переменную
      <code class="varname">SYSCTL</code>, поскольку она содержит полностью
      заданный путь, и при необходимости может быть
      переопределена.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-rerolling-distfiles"></a>12.17. Меняющиеся дистрибутивные файлы</h2></div></div></div><p>Иногда авторы программного обеспечения меняют содержимое
      выпущенных дистрибутивных файлов без смены названия.  Вы должны
      проверять, что изменения являются официальными и произведены
      автором.  В прошлом бывало, что дистрибутивный файл молча
      изменялся на сайтах загрузки с намерением нанести вред или
      скомпрометировать безопасность конечного пользователя.</p><p>Отложите старый файл с дистрибутивом в сторону, загрузите
      новый, распакуйте его и сравните содержимое при помощи
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>.  Если вы не видите ничего подозрительного, то
      можете обновить файл <code class="filename">distinfo</code>.  Убедитесь,
      что вы подытожили различия в вашем PR или описании коммита,
      чтобы другие люди были в курсе, что вы позаботились о том, что
      ничего плохого не случилось.</p><p>Возможно вы также захотите связаться с автором этого
      программного обеспечения для подтверждения изменений.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-avoiding-linuxisms"></a>12.18. Избегание линуксизмов</h2></div></div></div><p>Не используйте <code class="filename">/proc</code>, если доступны
      любые другие источники получения информации, например,
      <code class="function">setprogname(argv[0])</code> в
      <code class="function">main()</code> и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=getprogname&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">getprogname</span>(3)</span></a>, в случае
      если вы хотите <span class="quote"><<<span class="quote">знать своё имя</span>>></span>.</p><p>Не полагайтесь на поведение, не регламентированное
      <acronym class="acronym">POSIX</acronym>.</p><p>Не выполняйте запись временных меток в критических путях
      выполнения приложения, если можно обойтись без этого.
      Получение временных меток может быть медленным, в зависимости
      от степени точности используемых часов в операционной системе.
      Если временные метки действительно нужны, определите степень
      требуемой точности и используйте тот <acronym class="acronym">API</acronym>,
      в котором документируется получение достаточной
      точности.</p><p>Ряд простых системных вызовов (например,
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gettimeofday&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">gettimeofday</span>(2)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=getpid&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">getpid</span>(2)</span></a>) работают намного быстрее
      в <span class="trademark">Linux</span>(R) по сравнению с любой другой операционной системой
      из-за кеширования и используемой оптимизации vsyscall.  Не
      полагайтесь на их дешевизну в критичных к производительности
      приложениях.  В целом, старайтесь избегать системных вызовов
      там, где это возможно.</p><p>Не полагайтесь на специфичное для <span class="trademark">Linux</span>(R) поведение сокета.
      В частности, отличаются размеры буфера сокета по умолчанию
      (выполните вызов <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=setsockopt&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">setsockopt</span>(2)</span></a> с
      <code class="literal">SO_SNDBUF</code> и <code class="literal">SO_RCVBUF</code>, и
      в то время как в <span class="trademark">Linux</span>(R) при заполнении буфера сокета
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=send&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">send</span>(2)</span></a> блокируется, FreeBSD возвращает ошибку и
      устанавливает <code class="literal">ENOBUFS</code> в качестве значения
      errno.</p><p>Если требуется рассчитывать на нестандартное поведение,
      инкапсулируйте это должным образом в общий для всех
      <acronym class="acronym">API</acronym> с проверкой поведения на этапе
      конфигурации, и если требуемое поведение не найдено,
      прекращайте выполнение.</p><p>Используйте <a class="link" href="http://www.freebsd.org/cgi/man.cgi" target="_top">страницы
      справочника</a> для проверки, относится ли функция к
      интерфейсу <acronym class="acronym">POSIX</acronym> (ищите раздел
      <span class="quote"><<<span class="quote">STANDARDS</span>>></span> на странице справочника).</p><p>Не рассчитывайте на то, что в качестве
      <code class="filename">/bin/sh</code> используется
      <span class="application">bash</span>.  Убедитесь, что командная
      строка, переданная в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=system&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">system</span>(3)</span></a>, будет работать в
      <acronym class="acronym">POSIX</acronym>-совместимой оболочке.</p><p>Список основных <span class="application">bash</span>-измов
      расположен <a class="link" href="https://wiki.ubuntu.com/DashAsBinSh" target="_top">здесь</a>.</p><p>Проверьте, что используемые заголовочные файлы включены в
      <acronym class="acronym">POSIX</acronym> или список, рекомендуемый страницей
      справочника, т.к. например, забыть подключить
      <code class="filename">sys/types.h</code> - не такая уж проблема в
      <span class="trademark">Linux</span>(R), однако это не так во FreeBSD.</p><p>Компилируйте многопоточные приложения с ключом
      <span class="quote"><<<span class="quote">-pthread</span>>></span>, а не <span class="quote"><<<span class="quote">-lpthread</span>>></span> или
      как-либо ещё.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-misc"></a>12.19. Разное</h2></div></div></div><p>Файлы <code class="filename">pkg-descr</code> и
      <code class="filename">pkg-plist</code> должны проверяться дважды.  Если
      вы пересматриваете порт и думаете, что его можно описать иначе,
      сделайте это.</p><p>Пожалуйста, не создавайте дополнительных копий лицензии GNU
      General Public License в нашей системе.</p><p>Будьте внимательны с юридическими вопросами!  Не делайте из
      нас нелегальных распространителей ПО!</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-samplem"></a>Глава 13. Примерный <code class="filename">Makefile</code></h1></div></div></div><p>Вот примерный <code class="filename">Makefile</code>, который можно
    использовать при создании нового порта.  Обязательно удалите все
    дополнительные комментарии (те, которые в скобках)!</p><p>Вам рекомендуется следовать этому формату (соблюдая порядок
    следования переменных, пустые строки между разделами, и так
    далее).  Этот формат разработан для того, чтобы важная информация
    была легко найдена.  Мы рекомендуем вам воспользоваться утилитой
    <a class="link" href="#porting-portlint" title="3.5. Проверка вашего порта утилитой portlint">portlint</a> для проверки
    файла <code class="filename">Makefile</code>.</p><pre class="programlisting">[заголовок...просто чтобы нам было легче идентифицировать порт.]
# Created by: Satoshi Asami &lt;asami@FreeBSD.org&gt;
[Необязательная строка <span class="emphasis"><em>Created by:</em></span> содержит имя
человека, создавшего первоначальную версию порта.  Следует отметить,
что за <span class="quote"><<<span class="quote">:</span>>></span> следует пробел, но не символ табуляции.  Если
эта строка присутствует, будущие сопровождающие не должны её менять
или удалять, кроме как по запросу первоначального автора.]

# $FreeBSD$
[ ^^^^^^^^^ Эта строка будет автоматически заменена на строчку RCS ID
системой SVN при выполнении операции коммита в наше хранилище.  При
обновлении порта не приводите эту строку обратно к виду
"$FreeBSD$".  SVN сделает это автоматически.]

[секция описания собственно порта и основного сервера - сначала всегда
 PORTNAME и PORTVERSION, за ним следует CATEGORIES, а затем
 MASTER_SITES, за которым может идти MASTER_SITE_SUBDIR.
 PKGNAMEPREFIX и PKGNAMESUFFIX, если они нужны, следуют за ними.
 Затем следует DISTNAME, EXTRACT_SUFX и/или DISTFILES, а потом, если это нужно,
 EXTRACT_ONLY.]
PORTNAME=	xdvi
PORTVERSION=	18.2
CATEGORIES=	print
[не забывайте про завершающую косую черту ("/")!
 если вы не используете макросы MASTER_SITE_*]
MASTER_SITES=	${MASTER_SITE_XCONTRIB}
MASTER_SITE_SUBDIR= applications
PKGNAMEPREFIX=	ja-
DISTNAME=	xdvi-pl18
[задайте это, если исходный код поставляется не в виде
 стандартного файла ".tar.gz"]
EXTRACT_SUFX=	.tar.Z

[секция патчей -- может быть пустой]
PATCH_SITES=	ftp://ftp.sra.co.jp/pub/X11/japanese/
PATCHFILES=	xdvi-18.patch1.gz xdvi-18.patch2.gz

[сопровождающий; *обязательное поле*!  Это человек, который добровольно
 занимается обновлениями порта и неисправностями при построении, и которому
 пользователь может направлять вопросы и сообщения об ошибках.  Для
 сохранения как можно более высокого качества Коллекции Портов мы больше
 не принимаем новые порты, назначенные на "ports@FreeBSD.org".]
MAINTAINER=	asami@FreeBSD.org
COMMENT=	DVI Previewer for the X Window System

[зависимости -- могут быть пустыми]
RUN_DEPENDS=	gs:${PORTSDIR}/print/ghostscript

[этот раздел для остальных стандартных переменных из bsd.port.mk, кроме
 тех, что перечислены выше]
[Если порт задает вопросы во время этапов настройки, построения,
 установки...]
IS_INTERACTIVE=	yes
[Если распаковка происходит в каталог, отличных от ${DISTNAME}...]
WRKSRC=		${WRKDIR}/xdvi-new
[Если патчи делались не относительно ${WRKSRC}, вам, может быть, не
 придется изменять эту переменную]
PATCH_DIST_STRIP=	-p1
[Если порт требует скрипта "configure", генерируемого GNU-версией программы
 autoconf]
GNU_CONFIGURE=	yes
[Если для построения порту требуется GNU-версия утилиты make, а не
 /usr/bin/make...]
USES=		gmake
[Если это приложение X и требует запуска "xmkmf -a"...]
USES=		imake
[и так далее]

[В правилах ниже используются нестандартные переменные]
MY_FAVORITE_RESPONSE=	"yeah, right"

[теперь специальные правила, в порядке их вызова]
pre-fetch:
	я что-то выкачиваю, точно

post-patch:
	мне кое-что сделать после применения патча, великолепно

pre-install:
	и потом еще кое-что перед установкой, ого

[и, наконец, эпилог]

.include &lt;bsd.port.mk&gt;</pre></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="keeping-up"></a>Глава 14. Актуализация</h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#freshports">14.1. FreshPorts</a></span></dt><dt><span class="sect1"><a href="#svnweb">14.2. Web-интерфейс к хранилищу исходных текстов</a></span></dt><dt><span class="sect1"><a href="#ports-mailing-list">14.3. Список рассылки FreeBSD, посвящённый портам</a></span></dt><dt><span class="sect1"><a href="#build-cluster">14.4. Кластер построения портов FreeBSD</a></span></dt><dt><span class="sect1"><a href="#distfile-survey">14.5. Portscout: сканер дистрибутивных файлов портов
      FreeBSD</a></span></dt><dt><span class="sect1"><a href="#portsmon">14.6. Система мониторинга портов FreeBSD</a></span></dt></dl></div><p>Коллекция Портов FreeBSD постоянно изменяется.  Здесь находится
    некоторая информация о том, как поддерживать её в актуальном
    состоянии.</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="freshports"></a>14.1. FreshPorts</h2></div></div></div><p>Самым простым способом отслеживать уже произошедшие
      обновления является подписка на <a class="link" href="http://www.FreshPorts.org/" target="_top">FreshPorts</a>.  Для
      мониторинга вы можете выбрать несколько портов.  Мейнтейнерам
      настоятельно рекомендуется подписаться здесь, потому что они
      будут получать уведомления не только о собственных изменениях,
      но и об изменениях, сделанных любым другим коммиттером FreeBSD.
      (Это часто необходимо для синхронизации с изменениями на более
      низком технологическом уровне-хотя более корректным было
      бы получение предупреждений от тех, кто вносит подобные
      изменения, иногда этот этап пропускается или он просто
      непрактичен.  Кроме того, в некоторых случаях изменения по
      своей природе весьма незначительны.  Мы полагаем, что любой
      разработчик в таких ситуациях будет руководствоваться здравым
      смыслом).</p><p>Если вы хотите использовать FreshPorts, то вам нужна только
      учётная запись.  Если регистрационный адрес вашей электронной
      почты будет иметь вид <code class="literal">@FreeBSD.org</code>, то
      справа на Web-страницах вы увидите дополнительную ссылку.  Для
      тех из вас, кто уже получил учётную запись FreshPorts, но не
      использовал собственный адрес электронной почты
      <code class="literal">@FreeBSD.org</code>, достаточно сменить адрес на
      <code class="literal">@FreeBSD.org</code>, подписаться, а затем сменить
      его обратно.</p><p>Во FreshPorts имеется также функция проверки правильности,
      которая автоматически проверяет каждое изменение, внесённое в
      дерево портов FreeBSD.  Если вы подпишетесь на эту услугу, то
      будете оповещаться обо всех ошибках, обнаруженных FreshPorts
      при проверке внесённых вами изменений.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="svnweb"></a>14.2. Web-интерфейс к хранилищу исходных текстов</h2></div></div></div><p>Файлы в хранилище исходных текстов можно просматривать при
      помощи Web-интерфейса.  Изменения, которые касаются в целом
      всей системы портов, теперь документируются в файле <a class="link" href="http://svnweb.FreeBSD.org/ports/head/CHANGES" target="_top">CHANGES</a>.
      Изменения, касающиеся отдельных портов, отражаются теперь в
      файле <a class="link" href="http://svnweb.FreeBSD.org/ports/head/UPDATING" target="_top">UPDATING</a>.
      Однако однозначный ответ на любой вопрос можно найти, только
      прочитав исходных код <a class="link" href="http://svnweb.FreeBSD.org/ports/head/Mk/bsd.port.mk" target="_top">bsd.port.mk</a>
      и связанных с ним файлов.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="ports-mailing-list"></a>14.3. Список рассылки FreeBSD, посвящённый портам</h2></div></div></div><p>Если вы поддерживаете порты, то должны следить за
      <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">Список рассылки, посвящённый Портам FreeBSD</a>.  О важных изменениях, отражающихся на работе портов,
      будет сообщаться здесь, а затем они переносятся в
      <code class="filename">CHANGES</code>.</p><p>Если данный список рассылки слишком загружен сообщениями,
      вы можете отслеживать <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports-announce" target="_top">freebsd-ports-announce</a>, который
      модерируется и не является местом для дискуссий.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="build-cluster"></a>14.4. Кластер построения портов FreeBSD</h2></div></div></div><p>Одной из наименее известных сильных сторон FreeBSD является
      тот факт, что для непрерывного построения Коллекции Портов для
      каждого из основных релизов ОС для каждой архитектуры уровня
      поддержки Tier-1 выделен целый кластер машин.</p><p>Отдельные порты собираются, если они специально не помечены
      как <code class="varname">IGNORE</code>.  Для портов, помеченных как
      <code class="varname">BROKEN</code>, попытки будут продолжены для того,
      чтобы увидеть, если основная проблема была решена.  (Это
      сделано через использование переменной
      <code class="varname">TRYBROKEN</code> для <code class="filename">Makefile</code>
      порта.)</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="distfile-survey"></a>14.5. Portscout: сканер дистрибутивных файлов портов
      FreeBSD</h2></div></div></div><p>Кластер построения выделен для выполнения самого последнего
      релиза каждого из портов, дистрибутивные файлы которых уже были
      сгружены.  Однако из-за постоянных изменений в Internet
      дистрибутивные файлы могут быстро исчезать.  <a class="link" href="http://portscout.FreeBSD.org" target="_top">Portscout</a>,
      средство сканирования дистрибутивных файлов FreeBSD пытается
      опросить каждый из сайтов, доступных для сгрузки каждого из
      портов, для определения того, доступны ли ещё дистрибутивные
      файлы.  <span class="application">Portscout</span> может готовить
      отчёты в <acronym class="acronym">HTML</acronym> и рассылать электронные письма
      об имеющихся обновлениях для портов тем, кто это запрашивает.
      Мейнтейнеры периодически запрашивают наличие изменений, либо
      вручную, либо используя ленту <acronym class="acronym">RSS</acronym>.</p><p>Главная страница <span class="application">Portscout</span>
      отображает email мейнтейнера порта, количество портов, за
      которые ответственен мейнтейнер, количество портов с новыми
      дистрибутивными файлами и процент устаревших портов.  Функция
      поиска выполняет поиск мейнтейнера по адресу электронной почты
      и позволяет выбирать между всеми портами или только
      устаревшими.</p><p>При щелчке по адресу электронной почты мейнтейнера
      отображается список всех его портов, разделённых по категориям,
      вместе с текущим номером версии, информацией о наличии новой
      версии, временем последнего обновления порта и временем его
      последней проверки.  Функция поиска на этой странице позволяет
      пользователю выполнять поиск конкретного порта.</p><p>По щелчку на название порта в списке отображается информация
      о порте <a class="link" href="http://freshports.org" target="_top">FreshPorts</a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="portsmon"></a>14.6. Система мониторинга портов FreeBSD</h2></div></div></div><p>Другим полезным ресурсом является <a class="link" href="http://portsmon.FreeBSD.org" target="_top">Система мониторинга
	портов FreeBSD</a> (известная также как
      <code class="literal">portsmon</code>).  Система представляет собой базу
      данных, обрабатывающую информацию из нескольких источников и
      позволяющую просматривать их при помощи Web-интерфейса.  На
      данный момент задействованы база сообщений об ошибках (PR),
      протоколы ошибок кластера построения и отдельные файлы из
      коллекции портов.  В будущем в этот список будет добавлена
      система проверки дистрибутивных файлов и другие ресурсы.</p><p>Для начала вы можете просмотреть всю информацию о некотором
      порте при помощи средства <a class="link" href="http://portsmon.FreeBSD.org/portoverview.py" target="_top">Обзор
	отдельного порта</a>.</p><p>На момент написания это единственный доступный ресурс,
      который для имени порта ставит в соответствие записи PR GNATS.
      (Отправители PR не всегда добавляют в название имя порта, хотя
      мы предпочитаем, чтобы они это делали.)  Таким образом,
      <code class="literal">portsmon</code> это хорошее место для начала, если
      вы хотите найти присланные PR и/или ошибки построения для
      существующего порта; либо поискать, был ли уже прислан новый
      порт, который вы подумывали создать сами.</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="appendices"></a>Глава 15. Приложения</h1></div></div></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#uses-values">15.1. Значения <code class="varname">USES</code></a></span></dt><dt><span class="sect1"><a href="#freebsd-versions">15.2. Значения <code class="literal">__FreeBSD_version</code></a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="uses-values"></a>15.1. Значения <code class="varname">USES</code></h2></div></div></div><div class="table"><a id="idp77917392"></a><div class="table-title">Таблица 15.1. Значения <code class="varname">USES</code></div><div class="table-contents"><table summary="Значения USES" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Наименование</th><th>Аргументы</th><th>Описание</th></tr></thead><tbody valign="top"><tr><td valign="top"><a id="uses-ada"></a><code class="literal">ada</code></td><td valign="top">(нет)</td><td valign="top">Зависимость от компилятора с поддержкой
    <span class="application">Ada</span>.  Соответствующим образом
    определяется значение <code class="varname">CC</code>.</td></tr><tr><td valign="top"><a id="uses-bison"></a><code class="literal">bison</code></td><td valign="top">(нет), <code class="literal">build</code>, <code class="literal">run</code>,
    <code class="literal">both</code></td><td valign="top">Использует <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/bison/pkg-descr">devel/bison</a>.
    По умолчанию, без аргументов или с аргументом
    <code class="literal">build</code>, <code class="command">bison</code> означает
    зависимость для сборки, <code class="literal">run</code> для выполения,
    и <code class="literal">both</code> для сборки и выполнения.</td></tr><tr><td valign="top"><a id="uses-charsetfix"></a><code class="literal">charsetfix</code></td><td valign="top">(нет)</td><td valign="top">Предотвращает установку <code class="filename">charset.alias</code>.
    Этот файл должен устанавливаться только совместно с
    <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/converters/libiconv/pkg-descr">converters/libiconv</a>.  Используя
    <code class="varname">CHARSETFIX_MAKEFILEIN</code>, можно указать другой
    путь относительно <code class="varname">WRKSRC</code>, если
    <code class="filename">charset.alias</code> устанавливается иначе чем через
    <code class="varname">WRKSRC</code>/<code class="filename">Makefile.in</code>.</td></tr><tr><td valign="top"><a id="uses-cmake"></a><code class="literal">cmake</code></td><td valign="top">(нет), <code class="literal">outsource</code>,
    <code class="literal">run</code></td><td valign="top">Использует <span class="application">CMake</span> для
    конфигурации и построения.  При использовании аргумента
    <code class="literal">outsource</code> будет произведена сборка вне дерева
    исходных текстов (out-of-source).  При использовании аргумента
    <code class="literal">run</code> регистрируется как зависимость для
    выполнения.  Для получения дополнительной информации смотрите
    <a class="xref" href="#using-cmake" title="6.4.4. Использование cmake">Раздел 6.4.4, <<Использование <code class="command">cmake</code>>></a>.</td></tr><tr><td valign="top"><a id="uses-compiler"></a><code class="literal">compiler</code></td><td valign="top">(нет), <code class="literal">c++0x</code>,
    <code class="literal">c++11-lang</code>,
    <code class="literal">c++11-lib</code>, <code class="literal">c11</code>,
    <code class="literal">openmp</code>, <code class="literal">nestedfct</code>,
    <code class="literal">features</code></td><td valign="top">Определяет используемый компилятор с учётом любых пожеланий.
    Используйте <code class="literal">c++11-lang</code>, если для порта нужен
    компилятор с поддержкой C++11, и <code class="literal">c++11-lib</code>,
    если для порта также нужна стандартная библиотека C++11.  Если
    для порта нужен компилятор, понимающий C++0X, C11, OpenMP или
    вложенные функции, для этого можно использовать соответствующие
    параметры.  Используйте <code class="literal">features</code>, чтобы
    запросить список функциональных особенностей, поддерживаемых
    компилятором по умолчанию.  После подключения
    <code class="filename">bsd.port.pre.mk</code> порт может проверить
    результат, используя эти переменные:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">COMPILER_TYPE</code>: системный компилятор
	  по умолчанию, gcc или clang</p></li><li class="listitem"><p><code class="varname">ALT_COMPILER_TYPE</code>: альтернативный
	  системный компилятор, gcc или clang.  Значение
	  устанавливается, только если оба компилятора присутствуют
	  в основной системе.</p></li><li class="listitem"><p><code class="varname">COMPILER_VERSION</code>: первые две цифры
	  версии компилятора по умолчанию.</p></li><li class="listitem"><p><code class="varname">ALT_COMPILER_VERSION</code>: первые две
	  цифры версии альтернативного компилятора, если такой
	  присутствует.</p></li><li class="listitem"><p><code class="varname">CHOSEN_COMPILER_TYPE</code>: используемый
	  компилятор, gcc или clang</p></li><li class="listitem"><p><code class="varname">COMPILER_FEATURES</code>: поддерживаемые
	  возможности компилятора по умолчанию.  В настоящее время
	  здесь указана библиотека C++.</p></li></ul></div></td></tr><tr><td valign="top"><a id="uses-cran"></a><code class="literal">cran</code></td><td valign="top">(нет), <code class="literal">auto-plist</code></td><td valign="top">Использует Comprehensive R Archive Network.  Используйте
    <code class="varname">auto-plist</code> для автоматического получения
    <code class="filename">pkg-plist</code>.</td></tr><tr><td valign="top"><a id="uses-desktop-file-utils"></a><code class="literal">desktop-file-utils</code></td><td valign="top">(нет)</td><td valign="top">Использует <span class="application">update-desktop-database</span>
    из <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/desktop-file-utils/pkg-descr">devel/desktop-file-utils</a>.  Будет
    включён дополнительный этап post-install без взаимодействия с уже
    имеющимися этапами post-install.  В plist будут добавлены строки
    для запуска <span class="application">update-desktop-database</span>
    при установке и удалении пакета.</td></tr><tr><td valign="top"><a id="uses-desthack"></a><code class="literal">desthack</code></td><td valign="top">(нет)</td><td valign="top">Изменяет поведение GNU configure для правильной поддержки
    <code class="varname">DESTDIR</code>, в случае если программное обеспечение
    этого не делает.</td></tr><tr><td valign="top"><a id="uses-display"></a><code class="literal">display</code></td><td valign="top">(нет), ARGS</td><td valign="top">Устанавливает окружение виртуального дисплея.  Если
    переменная окружения <code class="varname">DISPLAY</code> не установлена,
    то <span class="application">Xvfb</span> добавляется как зависимость
    для построения и <code class="varname">CONFIGURE_ENV</code> дополняется
    номером порта текущего запущенного экземпляра
    <span class="application">Xvfb</span>.  Параметр
    <code class="literal">ARGS</code> по умолчанию имеет значение
    <code class="literal">install</code> и управляет фазой, в которой
    запускается и останавливается виртуальный дисплей.</td></tr><tr><td valign="top"><a id="uses-dos2unix"></a><code class="literal">dos2unix</code></td><td valign="top">(нет)</td><td valign="top">В составе порта имеются файлы с окончанием строк в формате
    <acronym class="acronym">DOS</acronym>, для которых требуется преобразование.
    Для управления тем, какие из файлов должны быть преобразованы,
    используются три переменные.  По умолчанию преобразуются
    <span class="emphasis"><em>все</em></span> файлы, включая двоичные.

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">DOS2UNIX_REGEX</code>: сопоставление с
	  именем файла с использованием регулярных выражений.</p></li><li class="listitem"><p><code class="varname">DOS2UNIX_FILES</code>: строковое
	  сопоставление с именем файла.</p></li><li class="listitem"><p><code class="varname">DOS2UNIX_GLOB</code>: сопоставление с
	  именем файла с использованием шаблонов поиска.</p></li></ul></div></td></tr><tr><td valign="top"><a id="uses-fam"></a><code class="literal">fam</code></td><td valign="top">(нет), fam, gamin</td><td valign="top">Использует File Alteration Monitor как зависимость от
    библиотеки порта <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/fam/pkg-descr">devel/fam</a> или
    <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/gamin/pkg-descr">devel/gamin</a>.  Пользователи могут
    задать WITH_FAM_SYSTEM для указания своего предпочтения.</td></tr><tr><td valign="top"><a id="uses-fmake"></a><code class="literal">fmake</code></td><td valign="top">(нет)</td><td valign="top">Использует <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/fmake/pkg-descr">devel/fmake</a> как
    зависимость для сборки.</td></tr><tr><td valign="top"><a id="uses-fortran"></a><code class="literal">fortran</code></td><td valign="top"><code class="literal">gcc</code> (default),
    <code class="literal">ifort</code></td><td valign="top">Использует компилятор Fortran от GNU или Intel.</td></tr><tr><td valign="top"><a id="uses-fuse"></a><code class="literal">fuse</code></td><td valign="top">(нет)</td><td valign="top">Порт будет зависеть от библиотеки FUSE и возможно от модуля
    ядра, в соответствии с версией FreeBSD.</td></tr><tr><td valign="top"><a id="uses-gettext"></a><code class="literal">gettext</code></td><td valign="top">(нет), <code class="literal">lib</code> (по умолчанию),
    <code class="literal">build</code>, <code class="literal">run</code></td><td valign="top">Использует <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/gettext/pkg-descr">devel/gettext</a>.
    По умолчанию, без аргументов или с аргументом
    <code class="literal">lib</code>, означает зависимость от библиотеки
    <code class="filename">libintl.so</code>.  <code class="literal">build</code>
    и <code class="literal">run</code> соответственно означают зависимости от
    от <code class="filename">xgettext</code> для сборки и выполнения.</td></tr><tr><td valign="top"><a id="uses-gmake"></a><code class="literal">gmake</code></td><td valign="top">(нет)</td><td valign="top">Использует <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/gmake/pkg-descr">devel/gmake</a> как
    зависимость для сборки и подготавливает окружение для
    использования <code class="command">gmake</code> в качестве
    <code class="command">make</code> для сборки по умолчанию.</td></tr><tr><td valign="top"><a id="uses-iconv"></a><code class="literal">iconv</code></td><td valign="top">(нет), <code class="literal">lib</code>, <code class="literal">build</code>,
    <code class="literal">patch</code></td><td valign="top">Использует функции <code class="command">iconv</code>, из порта
    <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/converters/libiconv/pkg-descr">converters/libiconv</a> как зависимость
    для сборки и выполнения или же из основной системы на 10-CURRENT
    после появления собственного <code class="command">iconv</code> в
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254273"><span class="svnref">254273</span></a>.  По умолчанию, без параметров или
    с параметром <code class="literal">lib</code>, <code class="command">iconv</code>
    означает зависимость для сборки и выполнения,
    <code class="literal">build</code> для сборки и <code class="literal">patch</code>
    для использования патчей.  Более подробно смотрите
    <a class="xref" href="#using-iconv" title="6.21. Использование iconv">Раздел 6.21, <<Использование <code class="command">iconv</code>>></a>.</td></tr><tr><td valign="top"><a id="uses-imake"></a><code class="literal">imake</code></td><td valign="top">(нет), <code class="literal">env</code>,
    <code class="literal">notall</code></td><td valign="top">Использует <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/imake/pkg-descr">devel/imake</a> как
    зависимость для сборки.  С аргументом <code class="literal">env</code>
    всего лишь подготавливает окружение и не задаёт каких-либо целей.
    С аргументом <code class="literal">notall</code> запрещает передачу
    <code class="literal">-a</code> команде <code class="command">xmkmf</code>.</td></tr><tr><td valign="top"><a id="uses-kmod"></a><code class="literal">kmod</code></td><td valign="top">(нет)</td><td valign="top">Заполняет шаблоны для портов модулей ядра:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Добавляет <code class="literal">kld</code> в список
	  <code class="varname">CATEGORIES</code>.</p></li><li class="listitem"><p>Задаёт <code class="varname">SSP_UNSAFE</code>.</p></li><li class="listitem"><p>Задаёт <code class="varname">IGNORE</code>, если исходные тексты
	  ядра не найдены в <code class="varname">SRC_BASE</code>.</p></li><li class="listitem"><p>В качестве значения по умолчанию для
	  <code class="varname">KMODDIR</code> устанавливает
	  <code class="filename">/boot/modules</code>,
	  добавляет его в <code class="varname">PLIST_SUB</code> и
	  <code class="varname">MAKE_ENV</code> и создает на этапе установки.
	  Если для <code class="varname">KMODDIR</code> установлено значение
	  <code class="filename">/boot/kernel</code>, оно
	  будет заменено на
	  <code class="filename">/boot/modules</code>.  Это
	  предотвращает повреждение пакетов вследствие переименования
	  <code class="filename">/boot/kernel</code> в
	  <code class="filename">/boot/kernel.old</code>
	  в процессе обновления ядра.</p></li><li class="listitem"><p>Управляет перекрёстными ссылками модулей ядра во время
	  установки и удаления.</p></li></ul></div></td></tr><tr><td valign="top"><a id="uses-libtool"></a><code class="literal">libtool</code></td><td valign="top">(нет)</td><td valign="top">Применяет исправления для сценариев
    <code class="command">libtool</code>.  Должно быть добавлено для всех
    портов, использующих <code class="command">libtool</code>.</td></tr><tr><td valign="top"><a id="uses-lua"></a><code class="literal">lua</code></td><td valign="top">(нет), <code class="literal">XY+</code>, <code class="literal">XY</code>,
    <code class="literal">build</code>, <code class="literal">run</code></td><td valign="top">Добавляет зависимость от <span class="application">Lua</span>.  По
    умолчанию является зависимостью от библиотеки, если это не
    переопределено параметрами <code class="literal">build</code> или
    <code class="literal">run</code>.  Версия по умолчанию 5.2, если не задана
    с помощью параметра <code class="literal">XY</code> (например,
    <code class="literal">51</code> или <code class="literal">52+</code>).</td></tr><tr><td valign="top"><a id="uses-motif"></a><code class="literal">motif</code></td><td valign="top">(нет)</td><td valign="top">Использует <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/open-motif/pkg-descr">x11-toolkits/open-motif</a> как зависимость
    от библиотеки.  Пользователи могут задавать
    <code class="varname">WANT_LESSTIF</code> для использования зависимости
    от <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/lesstif/pkg-descr">x11-toolkits/lesstif</a> вместо
    <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/open-motif/pkg-descr">x11-toolkits/open-motif</a>.</td></tr><tr><td valign="top"><a id="uses-ncurses"></a><code class="literal">ncurses</code></td><td valign="top">(нет), <code class="literal">base</code>,
    <code class="literal">port</code></td><td valign="top">Использует <span class="application">ncurses</span>,
    тем самым задаёт некоторые нужные переменные.</td></tr><tr><td valign="top"><a id="uses-ninja"></a><code class="literal">ninja</code></td><td valign="top">(нет)</td><td valign="top">Использует <span class="application">ninja</span> для построения
    порта.  Пользователи могут задать <code class="varname">NINJA_VERBOSE</code>
    для подробного вывода сообщения.</td></tr><tr><td valign="top"><a id="uses-openal"></a><code class="literal">openal</code></td><td valign="top"><code class="literal">al</code>, <code class="literal">soft</code> (по
    умолчанию), <code class="literal">si</code>, <code class="literal">alut</code></td><td valign="top">Использует <span class="application">OpenAL</span>.  Может быть
    указан бэкэнд, по умолчанию используется программная реализация.
    Пользователь может указать предпочитаемый бэкэнд с использованием
    переключателя <code class="varname">WANT_OPENAL</code>.  Правильными
    значениями для этого переключателя являются
    <code class="literal">soft</code> (по умолчанию) и
    <code class="literal">si</code>.</td></tr><tr><td valign="top"><a id="uses-pathfix"></a><code class="literal">pathfix</code></td><td valign="top">(нет)</td><td valign="top">Исправляет общие пути для их соответствия иерархии FreeBSD в
    файлах <code class="filename">Makefile.in</code> и
    <code class="filename">configure</code>, принадлежащих исходному коду
    порта.</td></tr><tr><td valign="top"><a id="uses-perl5"></a><code class="literal">perl5</code></td><td valign="top">(нет)</td><td valign="top">Зависит от <span class="application">Perl</span>.
    Могут быть заданы следующие переменные:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">PERL_VERSION</code>: Полная версия
	  <span class="application">Perl</span> для использования; если не
	  задано, используется значение по умолчанию</p></li><li class="listitem"><p><code class="varname">PERL_ARCH</code>: Имя каталога для
	  архитектурозависимых библиотек, по умолчанию
	  <code class="filename">mach</code></p></li><li class="listitem"><p><code class="varname">PERL_PORT</code>: Имя порта
	  <span class="application">Perl</span> для установки; значение по
	  умолчанию наследуется из
	  <code class="varname">PERL_VERSION</code></p></li><li class="listitem"><p><code class="varname">SITE_PERL</code>: Имя каталога для пакетов
	  <span class="application">Perl</span> со специальным
	  размещением</p></li><li class="listitem"><p><code class="varname">USE_PERL5</code>: Фазы для использования
	  <span class="application">Perl</span>, может быть
	  <code class="literal">extract</code>, <code class="literal">patch</code>,
	  <code class="literal">build</code>, <code class="literal">install</code> или
	  <code class="literal">run</code>.  Также может быть
	  <code class="literal">configure</code>, <code class="literal">modbuild</code>
	  или <code class="literal">modbuildtiny</code>, когда требуются
	  <code class="filename">Makefile.PL</code>,
	  <code class="filename">Build.PL</code> или его вариация
	  Module::Build::Tiny.  По умолчанию
	  <code class="literal">build run</code>.</p></li></ul></div></td></tr><tr><td valign="top"><a id="uses-pgsql"></a><code class="literal">pgsql</code></td><td valign="top">(нет), <code class="literal">X.Y</code>, <code class="literal">X.Y+</code>,
    <code class="literal">X.Y-</code></td><td valign="top">
    <p>Обеспечивает поддержку PostgreSQL.  Мейнтейнеры могут
      задавать требуемую версию.  Могут быть указаны минимальная и
      максимальная версии; например, 9.0-, 8.4+.</p>

    <p>Добавляет зависимость от компонентов PostgreSQL с
      использованием
      <code class="literal">WANT_PGSQL=component[:target]</code>.  Например,
      <code class="literal">WANT_PGSQL=server:configure pltcl plperl</code>.
      Для получения полного перечня используйте
      <code class="command">make -V _USE_PGSQL_DEP</code>.</p></td></tr><tr><td valign="top"><a id="uses-pkgconfig"></a><code class="literal">pkgconfig</code></td><td valign="top">(нет), <code class="literal">build</code> (по умолчанию),
    <code class="literal">run</code>, <code class="literal">both</code></td><td valign="top">Использует <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/pkgconf/pkg-descr">devel/pkgconf</a>.
    Без аргументов или с аргументом <code class="literal">build</code>
    <code class="command">pkg-config</code> означает зависимость для сборки,
    <code class="literal">run</code> для выполнения и <code class="literal">both</code>
    для сборки и выполнения.</td></tr><tr><td valign="top"><a id="uses-pure"></a><code class="literal">pure</code></td><td valign="top">(нет), <code class="literal">ffi</code></td><td valign="top">Использует <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/pure/pkg-descr">lang/pure</a>.
    В основном используется для построения портов, относящихся к
    <span class="application">pure</span>.  С аргументом
    <code class="literal">ffi</code> означает зависимость от
    <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/pure-ffi/pkg-descr">devel/pure-ffi</a> для
    выполнения.</td></tr><tr><td valign="top"><a id="uses-qmail"></a><code class="literal">qmail</code></td><td valign="top">(нет), <code class="literal">build</code>, <code class="literal">run</code>,
    <code class="literal">both</code>, <code class="literal">vars</code></td><td valign="top">Использует <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/mail/qmail/pkg-descr">mail/qmail</a>.
    С аргументом <code class="literal">build</code> <code class="command">qmail</code>
    означает зависимость для сборки и <code class="literal">run</code> для
    выполнения.  Без аргументов или с аргументом
    <code class="literal">both</code> <code class="command">qmail</code> означает
    зависимость для сборки и выполнения.  <code class="literal">vars</code>
    задает переменные QMAIL для нужд порта.</td></tr><tr><td valign="top"><a id="uses-qmake"></a><code class="literal">qmake</code></td><td valign="top">(нет), <code class="literal">norecursive</code>,
    <code class="literal">outsource</code></td><td valign="top">Использует <span class="application">QMake</span> для конфигурации.
    Для получения дополнительной информации смотрите
    <a class="xref" href="#using-qmake" title="6.10.3. Использование qmake">Раздел 6.10.3, <<Использование <code class="command">qmake</code>>></a>.</td></tr><tr><td valign="top"><a id="uses-readline"></a><code class="literal">readline</code></td><td valign="top">(нет), <code class="literal">port</code></td><td valign="top">Использует <span class="application">readline</span> как
    зависимость от библиотеки и по необходимости устанавливает
    переменные <code class="varname">CPPFLAGS</code> и
    <code class="varname">LDFLAGS</code>.  При использовании параметра
    <code class="literal">port</code> заставляет использовать
    <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/readline/pkg-descr">devel/readline</a>.</td></tr><tr><td valign="top"><a id="uses-scons"></a><code class="literal">scons</code></td><td valign="top">(нет)</td><td valign="top">Обеспечивает поддержку для использования
    <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/scons/pkg-descr">devel/scons</a></td></tr><tr><td valign="top"><a id="uses-shared-mime-info"></a><code class="literal">shared-mime-info</code></td><td valign="top">(нет)</td><td valign="top">Использует <span class="application">update-mime-database</span>
    из <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/misc/shared-mime-info/pkg-descr">misc/shared-mime-info</a>.  Это
    также добавляет собственный этап post-install и строки в plist
    для запуска <span class="application">update-mime-data</span> с
    подходящими аргументами во время установки и удаления
    пакета.</td></tr><tr><td valign="top"><a id="uses-shebangfix"></a><code class="literal">shebangfix</code></td><td valign="top">(нет)</td><td valign="top">Во многом программном обеспечении указывается неправильный
    путь к интерпретатору (shebang), в первую очередь это касается
    <code class="filename">/usr/bin/perl</code> и
    <code class="filename">/bin/bash</code>.  Это значение исправляет строку
    shebang в сценариях, перечисленных в
    <code class="varname">SHEBANG_FILES</code>.  По умолчанию сейчас
    поддерживаются <span class="application">Perl</span>,
    <span class="application">Python</span>,
    <span class="application">Bash</span>, <span class="application">Ruby</span>
    и <span class="application">PHP</span>.  Для поддержки других
    интерпретаторов необходимо соответствующее значение
    <code class="varname">SHEBANG_LANG</code> (например,
    <code class="literal">SHEBANG_LANG=lua</code>),
    <code class="varname">lua_OLD_CMD</code> и
    <code class="varname">lua_CMD</code>.</td></tr><tr><td valign="top"><a id="uses-tcl"></a><code class="literal">tcl</code></td><td valign="top"><code class="literal">PORT</code></td><td valign="top">Добавляет зависимость от <span class="application">Tcl</span>.
    Параметр <code class="literal">PORT</code> в качестве значения может
    принимать <code class="literal">tcl</code> или <code class="literal">tk</code>.   К
    значению может быть добавлена версия или зависимость wrapper с
    использованием <code class="literal">PORT:version</code> или
    <code class="literal">PORT:wrapper</code>.  Поле версии может иметь пустое
    значение, один или более номеров версии (на данный момент
    <code class="literal">84</code>, <code class="literal">85</code> или
    <code class="literal">86</code>) или же минимальный номер версии (на данный
    момент <code class="literal">84+</code>, <code class="literal">85+</code> или
    <code class="literal">86+</code>).  Может быть указана зависимость для
    сборки или выполнения с использованием
    <code class="literal">PORT,build</code> или <code class="literal">PORT,run</code>.
    После подключения <code class="filename">bsd.port.pre.mk</code> порт может
    проверить результат, используя эти переменные:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">TCL_VER</code>: используемая старшая.младшая
	  версия <span class="application">Tcl</span></p></li><li class="listitem"><p><code class="varname">TCLSH</code>: полный путь к интерпретатору
	  <span class="application">Tcl</span></p></li><li class="listitem"><p><code class="varname">TCL_LIBDIR</code>: путь к библиотекам
	  <span class="application">Tcl</span></p></li><li class="listitem"><p><code class="varname">TCL_INCLUDEDIR</code>: путь к заголовочным
	  файлам <span class="application">Tcl</span> на языке Си</p></li><li class="listitem"><p><code class="varname">TK_VER</code>: используемая старшая.младшая
	  версия <span class="application">Tk</span></p></li><li class="listitem"><p><code class="varname">WISH</code>: полный путь к интерпретатору
	  <span class="application">Tk</span></p></li><li class="listitem"><p><code class="varname">TK_LIBDIR</code>: путь к библиотекам
	  <span class="application">Tk</span></p></li><li class="listitem"><p><code class="varname">TK_INCLUDEDIR</code>: путь к заголовочным
	  файлам <span class="application">Tk</span> на языке Си</p></li></ul></div></td></tr><tr><td valign="top"><a id="uses-tk"></a><code class="literal">tk</code></td><td valign="top">То же, что и для <code class="literal">tcl</code></td><td valign="top">Небольшая обёртка при одновременном использовании
    <span class="application">Tcl</span> и <span class="application">Tk</span>.
    Возвращает те же переменные, что и при использовании
    <span class="application">Tcl</span>.</td></tr><tr><td valign="top"><a id="uses-twisted"></a><code class="literal">twisted</code></td><td valign="top">(нет), <code class="literal">ARGS</code></td><td valign="top">Добавляет зависимость от
    <span class="application">twistedCore</span>.  Перечень требуемых
    компонентов можно указать в качестве значения этой переменной.
    <code class="literal">ARGS</code> может принимать одно из значений:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">build</code>: добавляет
	  <span class="application">twistedCore</span> или любой из
	  указанных компонентов как зависимость построения.</p></li><li class="listitem"><p><code class="literal">run</code>: добавляет
	  <span class="application">twistedCore</span> или любой из
	  указанных компонентов как зависимость запуска.</p></li></ul></div>

    Помимо <code class="literal">build</code> и <code class="literal">run</code> можно
    указать один или несколько поддерживаемых компонентов
    <span class="application">twisted</span>.  Поддерживаемые значения
    перечислены в <code class="filename">Uses/twisted.mk</code>.</td></tr><tr><td valign="top"><a id="uses-uidfix"></a><code class="literal">uidfix</code></td><td valign="top">(нет)</td><td valign="top">Изменяет некоторое поведение по умолчанию (в основном,
    переменные) системы построения для возможности установки этого
    порта из-под обычного пользователя.  Попробуйте это в вашем порте
    перед добавлением <code class="literal">NEED_ROOT=yes</code>.</td></tr><tr><td valign="top"><a id="uses-uniquefiles"></a><code class="literal">uniquefiles</code></td><td valign="top">(нет), <code class="literal">dirs</code></td><td valign="top">
    Делает файлы и каталоги 'уникальными' посредством добавления
    приставки или окончания.  При использовании параметра
    <code class="literal">dirs</code> порт нуждается в приставке (и только в
    ней) на основе <code class="varname">UNIQUE_PREFIX</code> для стандартных
    каталогов <code class="varname">DOCSDIR</code>,
    <code class="varname">EXAMPLESDIR</code>, <code class="varname">DATADIR</code>,
    <code class="varname">WWWDIR</code>, <code class="varname">ETCDIR</code>.  Для портов
    доступны следующие переменные:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">UNIQUE_PREFIX</code>: приставка
	для использования с каталогами и файлами.  По умолчанию
	<code class="varname">${PKGNAMEPREFIX}</code>.</p></li><li class="listitem"><p><code class="varname">UNIQUE_PREFIX_FILES</code>:
	перечень файлов, для которых нужна приставка.  По умолчанию
	пустое значение.</p></li><li class="listitem"><p><code class="varname">UNIQUE_SUFFIX</code>: окончание
	для использования с файлами.  По умолчанию
	<code class="varname">${PKGNAMESUFFIX}</code>.</p></li><li class="listitem"><p><code class="varname">UNIQUE_SUFFIX_FILES</code>:
	перечень файлов, для которых нужно окончание.  По умолчанию
	пустое значение.</p></li></ul></div></td></tr><tr><td valign="top"><a id="uses-webplugin"></a><code class="literal">webplugin</code></td><td valign="top">(нет), <code class="literal">ARGS</code></td><td valign="top">Автоматически создаёт и удаляет символические ссылки для
    каждого из приложений с поддержкой фреймворка webplugin.
    <code class="literal">ARGS</code> может принимать одно из значений:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">gecko</code>: поддержка плагинов
	  Gecko</p></li><li class="listitem"><p><code class="literal">native</code>: поддержка плагинов Gecko,
	  Opera и WebKit-GTK</p></li><li class="listitem"><p><code class="literal">linux</code>: поддержка плагинов
	  Linux</p></li><li class="listitem"><p><code class="literal">all</code> (по умолчанию, неявно):
	  поддержка всех типов плагинов</p></li><li class="listitem"><p>(отдельные записи): поддержка только указанных
	  браузеров</p></li></ul></div>

    Следующие переменные могут быть отредактированы:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">WEBPLUGIN_FILES</code>: Без значения по
	  умолчанию, должна устанавливаться вручную.
	  Устанавливаемые файлы плагина.</p></li><li class="listitem"><p><code class="varname">WEBPLUGIN_DIR</code>: Директория для
	  установки файлов плагина, по умолчанию <code class="filename"><em class="replaceable"><code>PREFIX</code></em>/lib/browser_plugins/<em class="replaceable"><code>WEBPLUGIN_NAME</code></em></code>.
	  Задавайте её, если порт устанавливает файлы плагина за
	  пределами каталога по умолчанию, для защиты от повреждения
	  символических ссылок.</p></li><li class="listitem"><p><code class="varname">WEBPLUGIN_NAME</code>: Итоговое имя
	  каталога для установки файлов плагина, по умолчанию
	  <code class="varname">PKGBASE</code>.</p></li></ul></div></td></tr><tr><td valign="top"><a id="uses-zenoss"></a><code class="literal">zenoss</code></td><td valign="top">(нет)</td><td valign="top">Использует <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net-mgmt/zenoss/pkg-descr">net-mgmt/zenoss</a>.
    В основном используется для построения портов
    <span class="application">zenoss</span>, относящихся
    к <span class="application">zenpack</span>.</td></tr><tr><td valign="top"><a id="uses-zope"></a><code class="literal">zope</code></td><td valign="top">(нет)</td><td valign="top">Использует <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/zope/pkg-descr">www/zope</a>.
    В основном используется для построения портов, относящихся к
    <span class="application">zope</span>.  <code class="varname">ZOPE_VERSION</code>
    может использоваться портом для указания того, что должна
    использоваться определённая версия
    <span class="application">zope</span>.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="freebsd-versions"></a>15.2. Значения <code class="literal">__FreeBSD_version</code></h2></div></div></div><p>Ниже для справки приводится перечень значений
      <code class="literal">__FreeBSD_version</code> в виде, который определён
      в <a class="link" href="http://svnweb.FreeBSD.org/base/head/sys/sys/param.h?view=markup" target="_top">sys/param.h</a>:</p><div class="table"><a id="idp78311120"></a><div class="table-title">Таблица 15.2. Значения <code class="literal">__FreeBSD_version</code></div><div class="table-contents"><table summary="Значения __FreeBSD_version" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Значение</th><th>Дата</th><th>Релиз</th></tr></thead><tbody><tr><td>119411</td><td> </td><td>2.0-RELEASE</td></tr><tr><td>199501, 199503</td><td>19 марта 1995</td><td>2.1-CURRENT</td></tr><tr><td>199504</td><td>9 апреля 1995</td><td>2.0.5-RELEASE</td></tr><tr><td>199508</td><td>26 августа 1995</td><td>2.2-CURRENT до выхода 2.1</td></tr><tr><td>199511</td><td>10 ноября 1995</td><td>2.1.0-RELEASE</td></tr><tr><td>199512</td><td>10 ноября 1995</td><td>2.2-CURRENT до выхода 2.1.5</td></tr><tr><td>199607</td><td>10 июля 1996</td><td>2.1.5-RELEASE</td></tr><tr><td>199608</td><td>12 июля 1996</td><td>2.2-CURRENT до выхода 2.1.6</td></tr><tr><td>199612</td><td>15 ноября 1996</td><td>2.1.6-RELEASE</td></tr><tr><td>199612</td><td> </td><td>2.1.7-RELEASE</td></tr><tr><td>220000</td><td>19 февраля 1997</td><td>2.2-RELEASE</td></tr><tr><td>(без изменений)</td><td> </td><td>2.2.1-RELEASE</td></tr><tr><td>(без изменений)</td><td> </td><td>2.2-STABLE после выхода 2.2.1-RELEASE</td></tr><tr><td>221001</td><td>15 апреля 1997</td><td>2.2-STABLE после включения texinfo-3.9</td></tr><tr><td>221002</td><td>30 апреля 1997</td><td>2.2-STABLE после включения top</td></tr><tr><td>222000</td><td>16 мая 1997</td><td>2.2.2-RELEASE</td></tr><tr><td>222001</td><td>19 мая 1997</td><td>2.2-STABLE после выхода 2.2.2-RELEASE</td></tr><tr><td>225000</td><td>2 октября 1997</td><td>2.2.5-RELEASE</td></tr><tr><td>225001</td><td>20 ноября 1997</td><td>2.2-STABLE после выхода 2.2.5-RELEASE</td></tr><tr><td>225002</td><td>27 декабря 1997</td><td>2.2-STABLE после появления ldconfig -R</td></tr><tr><td>226000</td><td>24 марта 1998</td><td>2.2.6-RELEASE</td></tr><tr><td>227000</td><td>21 июля 1998</td><td>2.2.7-RELEASE</td></tr><tr><td>227001</td><td>21 июля 1998</td><td>2.2-STABLE после выхода 2.2.7-RELEASE</td></tr><tr><td>227002</td><td>19 сентября 1998</td><td>2.2-STABLE после изменения в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=semctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">semctl</span>(2)</span></a></td></tr><tr><td>228000</td><td>29 ноября 1998</td><td>2.2.8-RELEASE</td></tr><tr><td>228001</td><td>29 ноября 1998</td><td>2.2-STABLE после выхода 2.2.8-RELEASE</td></tr><tr><td>300000</td><td>19 февраля 1996</td><td>3.0-CURRENT до изменения в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">mount</span>(2)</span></a></td></tr><tr><td>300001</td><td>24 сентября 1997</td><td>3.0-CURRENT после изменения в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">mount</span>(2)</span></a></td></tr><tr><td>300002</td><td>2 июня 1998</td><td>3.0-CURRENT после изменения в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=semctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">semctl</span>(2)</span></a></td></tr><tr><td>300003</td><td>7 июня 1998</td><td>3.0-CURRENT после изменений в аргументах ioctl</td></tr><tr><td>300004</td><td>3 сентября 1998</td><td>3.0-CURRENT после перехода на формат ELF</td></tr><tr><td>300005</td><td>16 октября 1998</td><td>3.0-RELEASE</td></tr><tr><td>300006</td><td>16 октября 1998</td><td>3.0-CURRENT после выхода 3.0-RELEASE</td></tr><tr><td>300007</td><td>22 января 1999</td><td>3.0-STABLE после разбиения на ветки 3/4</td></tr><tr><td>310000</td><td>9 февраля 1999</td><td>3.1-RELEASE</td></tr><tr><td>310001</td><td>27 марта 1999</td><td>3.1-STABLE после выхода 3.1-RELEASE</td></tr><tr><td>310002</td><td>14 апреля 1999</td><td>3.1-STABLE после изменения в порядке следования
    конструкторов/деструкторов в C++</td></tr><tr><td>320000</td><td> </td><td>3.2-RELEASE</td></tr><tr><td>320001</td><td>8 мая 1999</td><td>3.2-STABLE</td></tr><tr><td>320002</td><td>29 августа 1999</td><td>3.2-STABLE после несовместимых изменений в IPFW и
    сокетах</td></tr><tr><td>330000</td><td>2 сентября 1999</td><td>3.3-RELEASE</td></tr><tr><td>330001</td><td>16 сентября 1999</td><td>3.3-STABLE</td></tr><tr><td>330002</td><td>24 ноября 1999</td><td>3.3-STABLE после добавления <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mkstemp&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">mkstemp</span>(3)</span></a> в libc</td></tr><tr><td>340000</td><td>5 декабря 1999</td><td>3.4-RELEASE</td></tr><tr><td>340001</td><td>17 декабря 1999</td><td>3.4-STABLE</td></tr><tr><td>350000</td><td>20 июня 2000</td><td>3.5-RELEASE</td></tr><tr><td>350001</td><td>12 июля 2000</td><td>3.5-STABLE</td></tr><tr><td>400000</td><td>22 января 1999</td><td>4.0-CURRENT после появления ветки 3.4</td></tr><tr><td>400001</td><td>20 февраля 1999</td><td>4.0-CURRENT после изменения в работе динамического
    компоновщика</td></tr><tr><td>400002</td><td>13 марта 1999</td><td>4.0-CURRENT после изменения в порядке следования
    конструкторов/деструкторов в C++</td></tr><tr><td>400003</td><td>27 марта 1999</td><td>4.0-CURRENT после появления функции <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dladdr&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">dladdr</span>(3)</span></a></td></tr><tr><td>400004</td><td>5 апреля 1999</td><td>4.0-CURRENT после исправления ошибки в работе функции
    __deregister_frame_info динамического компоновщика (а также
    4.0-CURRENT после интеграции EGCS 1.1.2)</td></tr><tr><td>400005</td><td>27 апреля 1999</td><td>4.0-CURRENT после изменения интерфейса функции <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=suser&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">suser</span>(9)</span></a>
    (а также 4.0-CURRENT после появления newbus)</td></tr><tr><td>400006</td><td>31 мая 1999</td><td>4.0-CURRENT после изменения в регистрации cdevsw</td></tr><tr><td>400007</td><td>17 июня 1999</td><td>4.0-CURRENT после добавления so_cred в проверки на уровне
    сокетов</td></tr><tr><td>400008</td><td>20 июня 1999</td><td>4.0-CURRENT после добавления обработчика системного вызова
    poll в libc_r</td></tr><tr><td>400009</td><td>20 июля 1999</td><td>4.0-CURRENT после перехода в ядре с типа
    <code class="literal">dev_t</code> на указатель
    <code class="literal">struct specinfo</code></td></tr><tr><td>400010</td><td>25 сентября 1999</td><td>4.0-CURRENT после исправления уязвимости в
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">jail</span>(2)</span></a></td></tr><tr><td>400011</td><td>29 сентября 1999</td><td>4.0-CURRENT после изменения в типе данных
    <code class="literal">sigset_t</code></td></tr><tr><td>400012</td><td>15 ноября 1999</td><td>4.0-CURRENT после перехода на компилятор GCC 2.95.2</td></tr><tr><td>400013</td><td>4 декабря 1999</td><td>4.0-CURRENT после появления добавляемых обработчиков ioctl
    режима linux</td></tr><tr><td>400014</td><td>18 января 2000</td><td>4.0-CURRENT после заимствования OpenSSL</td></tr><tr><td>400015</td><td>27 января 2000</td><td>4.0-CURRENT после изменения в C++ ABI компилятора GCC 2.95.2
    по умолчанию с -fvtable-thunks на -fno-vtable-thunks</td></tr><tr><td>400016</td><td>27 февраля 2000</td><td>4.0-CURRENT после заимствования OpenSSH</td></tr><tr><td>400017</td><td>13 марта 2000</td><td>4.0-RELEASE</td></tr><tr><td>400018</td><td>17 марта 2000</td><td>4.0-STABLE после появления 4.0-RELEASE</td></tr><tr><td>400019</td><td>5 мая 2000</td><td>4.0-STABLE после появления отложенных контрольных
    сумм.</td></tr><tr><td>400020</td><td>4 июня 2000</td><td>4.0-STABLE после интеграции кода библиотеки libxpg4 в
    libc.</td></tr><tr><td>400021</td><td>8 июля 2000</td><td>4.0-STABLE после обновления пакета Binutils до версии
    2.10.0, изменения в схеме пометки выполнимых файлов ELF и
    включения tcsh в качестве базового компонента.</td></tr><tr><td>410000</td><td>14 июля 2000</td><td>4.1-RELEASE</td></tr><tr><td>410001</td><td>29 июля 2000</td><td>4.1-STABLE после выхода 4.1-RELEASE</td></tr><tr><td>410002</td><td>16 сентября 2000</td><td>4.1-STABLE после переноса функции <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=setproctitle&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">setproctitle</span>(3)</span></a> из
    библиотеки libutil в libc.</td></tr><tr><td>411000</td><td>25 сентября 2000</td><td>4.1.1-RELEASE</td></tr><tr><td>411001</td><td> </td><td>4.1.1-STABLE после выхода 4.1.1-RELEASE</td></tr><tr><td>420000</td><td>31 октября 2000</td><td>4.2-RELEASE</td></tr><tr><td>420001</td><td>10 января 2001</td><td>4.2-STABLE после объединения libgcc.a и libgcc_r.a, а также
    соответствующих изменений в компоновке GCC.</td></tr><tr><td>430000</td><td>6 марта 2001</td><td>4.3-RELEASE</td></tr><tr><td>430001</td><td>18 мая 2001</td><td>4.3-STABLE после появления wint_t.</td></tr><tr><td>430002</td><td>22 июля 2001</td><td>4.3-STABLE после добавления API состояния электропитания
    PCI.</td></tr><tr><td>440000</td><td>1 августа 2001</td><td>4.4-RELEASE</td></tr><tr><td>440001</td><td>23 октября 2001</td><td>4.4-STABLE после добавления d_thread_t.</td></tr><tr><td>440002</td><td>4 ноября 2001</td><td>4.4-STABLE после изменений в структуру для монтирования
    (это затрагивает KLD файловых систем).</td></tr><tr><td>440003</td><td>18 декабря 2001</td><td>4.4-STABLE после импорта пользовательских компонентов
    smbfs.</td></tr><tr><td>450000</td><td>20 декабря 2001</td><td>4.5-RELEASE</td></tr><tr><td>450001</td><td>24 февраля 2002</td><td>4.5-STABLE после переименования элементов структур
    usb</td></tr><tr><td>450004</td><td>16 апреля 2002</td><td>4.5-STABLE после того, как переменная <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>
    <code class="literal">sendmail_enable</code> стала обрабатывать значение
    <code class="literal">NONE</code>.</td></tr><tr><td>450005</td><td>27 апреля 2002</td><td>4.5-STABLE после переключения на использование по
    умолчанию при построении пакетов  XFree86 4.</td></tr><tr><td>450006</td><td>1 мая 2002</td><td>4.5-STABLE после того, как сетевой фильтр для этапа
    подтверждения соединения был исправлен таким образом, что
    он больше не подвержен простым DoS-атакам.</td></tr><tr><td>460000</td><td>21 июня 2002</td><td>4.6-RELEASE</td></tr><tr><td>460001</td><td>21 июня 2002</td><td>Справочная страница по <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendfile&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">sendfile</span>(2)</span></a> в 4.6-STABLE
    приведена в соответствие с документацией, никакие заголовки не
    сравниваются с количеством данных, посланных из файла.</td></tr><tr><td>460002</td><td>19 июля 2002</td><td>4.6.2-RELEASE</td></tr><tr><td>460100</td><td>26 июня 2002</td><td>4.6-STABLE</td></tr><tr><td>460101</td><td>26 июня 2002</td><td>4.6-STABLE после переноса из -CURRENT функциональности
    `sed -i'.</td></tr><tr><td>460102</td><td>1 сентября 2002</td><td>4.6-STABLE после MFC многих новых возможностей pkg_install
    из ветки HEAD.</td></tr><tr><td>470000</td><td>8 октября 2002</td><td>4.7-RELEASE</td></tr><tr><td>470100</td><td>9 октября 2002</td><td>4.7-STABLE</td></tr><tr><td>470101</td><td>10 ноября 2002</td><td>Начало генерации ссылок __std{in,out,err}p вместо __sF.
    Это переносит вычисление выражений в std{in,out,err} с момента
    компиляции на время выполнения.</td></tr><tr><td>470102</td><td>23 января 2003</td><td>4.7-STABLE после MFC изменений в mbuf для замены m_aux mbufs
    на m_tag's</td></tr><tr><td>470103</td><td>14 февраля 2003</td><td>В 4.7-STABLE появляется OpenSSL 0.9.7</td></tr><tr><td>480000</td><td>30 марта 2003</td><td>4.8-RELEASE</td></tr><tr><td>480100</td><td>5 апреля 2003</td><td>4.8-STABLE</td></tr><tr><td>480101</td><td>22 мая 2003</td><td>4.8-STABLE после того, как функция <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=realpath&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">realpath</span>(3)</span></a> была
    сделана совместимой с потоками выполнения</td></tr><tr><td>480102</td><td>10 августа 2003</td><td>4.8-STABLE после изменений 3ware API в twe.</td></tr><tr><td>490000</td><td>27 октября 2003</td><td>4.9-RELEASE</td></tr><tr><td>490100</td><td>27 октября 2003</td><td>4.9-STABLE</td></tr><tr><td>490101</td><td>8 января 2004</td><td>4.9-STABLE после добавления e_sid в структуру
    kinfo_eproc.</td></tr><tr><td>490102</td><td>4 февраля 2004</td><td>4.9-STABLE после выполнения MFC функциональности libmap
    для rtld.</td></tr><tr><td>491000</td><td>25 мая 2004</td><td>4.10-RELEASE</td></tr><tr><td>491100</td><td>1 июня 2004</td><td>4.10-STABLE</td></tr><tr><td>491101</td><td>11 августа 2004</td><td>4.10-STABLE после выполнения MFC ревизии 20040629
    пакетного инструментария</td></tr><tr><td>491102</td><td>16 ноября 2004</td><td>4.10-STABLE после исправления ошибки в VM при отвязывании
    (unwire) фиктивных страниц</td></tr><tr><td>492000</td><td>17 декабря 2004</td><td>4.11-RELEASE</td></tr><tr><td>492100</td><td>17 декабря 2004</td><td>4.11-STABLE</td></tr><tr><td>492101</td><td>18 апреля 2006</td><td>4.11-STABLE после добавления каталогов libdata/ldconfig в
    файлы mtree.</td></tr><tr><td>500000</td><td>13 марта 2000</td><td>5.0-CURRENT</td></tr><tr><td>500001</td><td>18 апреля 2000</td><td>5.0-CURRENT после добавления дополнительных полей в
    заголовке ELF и изменения метода пометки принадлежности к
    определённой системе для выполнимых файлов в формате ELF.</td></tr><tr><td>500002</td><td>2 мая 2000</td><td>5.0-CURRENT после изменений в метаданных kld.</td></tr><tr><td>500003</td><td>18 мая 2000</td><td>5.0-CURRENT после изменений buf/bio.</td></tr><tr><td>500004</td><td>26 мая 2000</td><td>5.0-CURRENT после обновления binutils.</td></tr><tr><td>500005</td><td>3 июня 2000</td><td>5.0-CURRENT после интеграции кода библиотеки libxpg4 в
    libc и появления интерфейса TASKQ.</td></tr><tr><td>500006</td><td>10 июня 2000</td><td>5.0-CURRENT после добавления интерфейсов AGP.</td></tr><tr><td>500007</td><td>29 июня 2000</td><td>5.0-CURRENT после обновления Perl до версии 5.6.0</td></tr><tr><td>500008</td><td>7 июля 2000</td><td>5.0-CURRENT после обновления кода KAME до версии
    2000/07.</td></tr><tr><td>500009</td><td>14 июля 2000</td><td>5.0-CURRENT после изменений в ether_ifattach() и
    ether_ifdetach().</td></tr><tr><td>500010</td><td>16 июля 2000</td><td>5.0-CURRENT после возврата в настройках утилиты mtree,
    применяемых по умолчанию, обратно к оригинальным и добавления
    флага -L для перехода по символическим ссылкам.</td></tr><tr><td>500011</td><td>18 июля 2000</td><td>5.0-CURRENT после изменения в API для kqueue.</td></tr><tr><td>500012</td><td>2 сентября 2000</td><td>5.0-CURRENT после перемещения <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=setproctitle&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">setproctitle</span>(3)</span></a> из
    библиотеки libutil в libc.</td></tr><tr><td>500013</td><td>10 сентября 2000</td><td>5.0-CURRENT после первого коммита SMPng.</td></tr><tr><td>500014</td><td>4 января 2001</td><td>5.0-CURRENT после переноса &lt;sys/select.h&gt; в
    &lt;sys/selinfo.h&gt;.</td></tr><tr><td>500015</td><td>10 января 2001</td><td>5.0-CURRENT после объединения libgcc.a и libgcc_r.a, а также
    соответствующих изменений в компоновке GCC.</td></tr><tr><td>500016</td><td>24 января 2001</td><td>5.0-CURRENT после изменения, позволяющего libc и
    libc_r быть скомпонованными вместе, что делает параметр
    -pthread ненужным.</td></tr><tr><td>500017</td><td>18 февраля 2001</td><td>5.0-CURRENT после перехода на использование struct xucred
    вместо struct ucred для стабилизации экспортируемого API ядра для
    mountd и т.д.</td></tr><tr><td>500018</td><td>24 февраля 2001</td><td>5.0-CURRENT после добавления переменной make CPUTYPE,
    позволяющей контролировать специфичные для CPU
    оптимизации.</td></tr><tr><td>500019</td><td>9 июня 2001</td><td>5.0-CURRENT после переноса machine/ioctl_fd.h в
    sys/fdcio.h</td></tr><tr><td>500020</td><td>15 июня 2001</td><td>5.0-CURRENT после изменения имен для локализации.</td></tr><tr><td>500021</td><td>22 июня 2001</td><td>5.0-CURRENT после импорта Bzip2.  Также означает
    удаление S/Key.</td></tr><tr><td>500022</td><td>12 июля 2001</td><td>5.0-CURRENT с поддержкой SSE.</td></tr><tr><td>500023</td><td>14 сентября 2001</td><td>5.0-CURRENT после KSE Этап 2.</td></tr><tr><td>500024</td><td>1 октября 2001</td><td>5.0-CURRENT после d_thread_t и переноса UUCP в
    порты.</td></tr><tr><td>500025</td><td>4 октября 2001</td><td>5.0-CURRENT после изменения ABI из-за переноса передачи
    дескриптора и прав на 64-разрядные платформы.</td></tr><tr><td>500026</td><td>9 октября 2001</td><td>5.0-CURRENT после перехода на использование по умолчанию
    XFree86 4 для построения пакетов и после добавления в библиотеку
    libc новой функции strnstr().</td></tr><tr><td>500027</td><td>10 октября 2001</td><td>5.0-CURRENT после добавления в библиотеку libc новой
    функции strcasestr().</td></tr><tr><td>500028</td><td>14 декабря 2001</td><td>5.0-CURRENT после импорта пользовательских компонентов
    smbfs.</td></tr><tr><td>(Значение не изменено)</td><td> </td><td>5.0-CURRENT после добавления новых специфических для
    C99 целочисленных типов.</td></tr><tr><td>500029</td><td>29 января 2002</td><td>5.0-CURRENT после изменения возвращаемого функцией
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendfile&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">sendfile</span>(2)</span></a> значения.</td></tr><tr><td>500030</td><td>15 февраля 2002</td><td>5.0-CURRENT после добавления нового типа
    <code class="literal">fflags_t</code>, соответствующего файловым
    флагам.</td></tr><tr><td>500031</td><td>24 февраля 2002</td><td>5.0-CURRENT после переименования элементов структур
    usb.</td></tr><tr><td>500032</td><td>16 марта 2002</td><td>5.0-CURRENT после обновления Perl до версии 5.6.1</td></tr><tr><td>500033</td><td>3 апреля 2002</td><td>5.0-CURRENT после того как переменная <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>
    <code class="literal">sendmail_enable</code> стала обрабатывать значение
    <code class="literal">NONE</code>.</td></tr><tr><td>500034</td><td>30 апреля 2002</td><td>5.0-CURRENT после добавления в функцию mtx_init()
    третьего параметра.</td></tr><tr><td>500035</td><td>13 мая 2002</td><td>5.0-CURRENT после импорта Gcc 3.1</td></tr><tr><td>500036</td><td>17 мая 2002</td><td>5.0-CURRENT после удаления Perl из /usr/src</td></tr><tr><td>500037</td><td>29 мая 2002</td><td>5.0-CURRENT после добавления функции <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dlfunc&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">dlfunc</span>(3)</span></a></td></tr><tr><td>500038</td><td>24 июля 2002</td><td>5.0-CURRENT после того, как были изменены типы некоторых
    записей в структуре sockbuf, а сама структура была
    реорганизована.</td></tr><tr><td>500039</td><td>1 сентября 2002</td><td>5.0-CURRENT после импорта GCC 3.2.1.  Также после того, как
    в файлах заголовков было прекращено использование _BSD_FOO_T_ и
    начато использование _FOO_T_DECLARED.  Это значение может быть
    также использовано как примерная точка начала поддержки пакетов
    в формате <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bzip2&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">bzip2</span>(1)</span></a>.</td></tr><tr><td>500040</td><td>20 сентября 2002</td><td>5.0-CURRENT после различных изменений в дисковых функциях,
    сделанных для избавления от зависимости от внутреннего устройства
    структуры метки диска.</td></tr><tr><td>500041</td><td>1 октября 2002</td><td>5.0-CURRENT после добавления функции <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=getopt_long&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">getopt_long</span>(3)</span></a>
    в библиотеку libc.</td></tr><tr><td>500042</td><td>15 октября 2002</td><td>5.0-CURRENT после обновления Binutils 2.13, куда включена
    новая эмуляция FreeBSD, vec и формат выдачи.</td></tr><tr><td>500043</td><td>1 ноября 2002</td><td>5.0-CURRENT после добавления простых заглушек pthread_XXX
    к библиотеке libc, что сделало libXThrStub.so ненужной.
    5.0-RELEASE.</td></tr><tr><td>500100</td><td>17 января 2003</td><td>5.0-CURRENT после создания ветки для RELENG_5_0</td></tr><tr><td>500101</td><td>19 февраля 2003</td><td>&lt;sys/dkstat.h&gt; пуст и не должен использоваться.</td></tr><tr><td>500102</td><td>25 февраля 2003</td><td>5.0-CURRENT после изменения интерфейса d_mmap_t.</td></tr><tr><td>500103</td><td>26 февраля 2003</td><td>5.0-CURRENT после того, как было внесено изменение,
    при котором taskqueue_swi работает без Giant, и было
    добавлено taskqueue_swi_giant, работающее с Giant.</td></tr><tr><td>500104</td><td>27 февраля 2003</td><td>cdevsw_add() и cdevsw_remove() больше не существуют.
    Появилась технология выделения MAJOR_AUTO.</td></tr><tr><td>500105</td><td>4 марта 2003</td><td>5.0-CURRENT после появления нового метода инициализации
    cdevsw.</td></tr><tr><td>500106</td><td>8 марта 2003</td><td>devstat_add_entry() заменено на devstat_new_entry()</td></tr><tr><td>500107</td><td>15 марта 2003</td><td>Изменение интерфейса devstat; смотрите sys/sys/param.h
    1.149</td></tr><tr><td>500108</td><td>15 марта 2003</td><td>Изменение в интерфейсе Token-Ring.</td></tr><tr><td>500109</td><td>25 марта 2003</td><td>Добавление vm_paddr_t.</td></tr><tr><td>500110</td><td>28 марта 2003</td><td>5.0-CURRENT после того, как функция <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=realpath&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">realpath</span>(3)</span></a> была
    сделана совместимой с потоками выполнения</td></tr><tr><td>500111</td><td>9 апреля 2003</td><td>5.0-CURRENT после того, как функция <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=usbhid&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">usbhid</span>(3)</span></a> была
    приведена в соответствие с NetBSD</td></tr><tr><td>500112</td><td>17 апреля 2003</td><td>5.0-CURRENT после новой реализации NSS и добавления
    функций POSIX.1 getpw*_r и getgr*_r</td></tr><tr><td>500113</td><td>2 мая 2003</td><td>5.0-CURRENT после удаления старой системы rc.</td></tr><tr><td>501000</td><td>4 июня 2004</td><td>5.1-RELEASE.</td></tr><tr><td>501100</td><td>2 июня 2003</td><td>5.1-CURRENT после появления ветки RELENG_5_1.</td></tr><tr><td>501101</td><td>29 июня 2003</td><td>5.1-CURRENT после корректировки смысла функций
    sigtimedwait(2) и sigwaitinfo(2).</td></tr><tr><td>501102</td><td>3 июля 2003</td><td>5.1-CURRENT после добавления полей lockfunc и lockfuncarg
    в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bus_dma_tag_create&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">bus_dma_tag_create</span>(9)</span></a>.</td></tr><tr><td>501103</td><td>31 июля 2003</td><td>5.1-CURRENT после интеграции снэпшота GCC 3.3.1-pre
    20030711.</td></tr><tr><td>501104</td><td>5 августа 2003</td><td>5.1-CURRENT осле изменений 3ware API в twe.</td></tr><tr><td>501105</td><td>17 августа 2003</td><td>Поддержка в 5.1-CURRENT динамически скомпонованных /bin и
    /sbin, перемещение библиотек в /lib.</td></tr><tr><td>501106</td><td>8 сентября 2003</td><td>5.1-CURRENT после добавления в ядро поддержки
    Coda 6.x.</td></tr><tr><td>501107</td><td>17 сентября 2003</td><td>5.1-CURRENT после перемещения констант для 16550 UART из
    файла <code class="filename">&lt;dev/sio/sioreg.h&gt;</code> в
    <code class="filename">&lt;dev/ic/ns16550.h&gt;</code>.  А также момент,
    когда rtld стал поддерживать функциональность libmap в
    безусловном режиме.</td></tr><tr><td>501108</td><td>23 сентября 2003</td><td>5.1-CURRENT после обновления в API PFIL_HOOKS</td></tr><tr><td>501109</td><td>27 сентября 2003</td><td>5.1-CURRENT после добавления функции kiconv(3)</td></tr><tr><td>501110</td><td>28 сентября 2003</td><td>5.1-CURRENT после изменений операций по умолчанию для
    open и close в cdevsw</td></tr><tr><td>501111</td><td>16 октября 2003</td><td>5.1-CURRENT после изменений в структуре cdevsw</td></tr><tr><td>501112</td><td>16 октября 2003</td><td>5.1-CURRENT после добавления множественного наследования
    для kobj</td></tr><tr><td>501113</td><td>31 октября 2003</td><td>5.1-CURRENT после изменения if_xname в структуре
    ifnet</td></tr><tr><td>501114</td><td>16 ноября 2003</td><td>5.1-CURRENT после изменений, связанных с динамической
    компоновкой /bin и /sbin</td></tr><tr><td>502000</td><td>7 декабря 2003</td><td>5.2-RELEASE</td></tr><tr><td>502010</td><td>23 февраля 2003</td><td>5.2.1-RELEASE</td></tr><tr><td>502100</td><td>7 декабря 2003</td><td>5.2-CURRENT после отделения ветки RELENG_5_2</td></tr><tr><td>502101</td><td>19 декабря 2003</td><td>5.2-CURRENT после добавления в libc функций
    __cxa_atexit/__cxa_finalize.</td></tr><tr><td>502102</td><td>30 января 2004</td><td>5.2-CURRENT после смены используемой по умолчанию библиотеки
    для работы с потоками libc_r на libpthread.</td></tr><tr><td>502103</td><td>21 февраля 2004</td><td>5.2-CURRENT после большого изменения в API драйверов
    устройств.</td></tr><tr><td>502104</td><td>25 февраля 2004</td><td>5.2-CURRENT после добавления getopt_long_only().</td></tr><tr><td>502105</td><td>5 марта 2004</td><td>5.2-CURRENT после того, как макро-переменная NULL была
    переопределена для языка C как ((void *)0), что привело к
    увеличению количества предупреждений компилятора.</td></tr><tr><td>502106</td><td>8 марта 2004</td><td>5.2-CURRENT после установки и включения pf в процесс
    построения системы.</td></tr><tr><td>502107</td><td>10 марта 2004</td><td>5.2-CURRENT после того, как значение time_t на платформе
    sparc64 стало 64-разрядным.</td></tr><tr><td>502108</td><td>12 марта 2004</td><td>5.2-CURRENT после того, как поддержка компилятора
    Intel C/C++ в некоторых заголовочных файлах и execve(2)
    была изменена на более строго соответствующую POSIX.</td></tr><tr><td>502109</td><td>22 марта 2004</td><td>5.2-CURRENT после введения программного интерфейса
    bus_alloc_resource_any</td></tr><tr><td>502110</td><td>27 марта 2004</td><td>5.2-CURRENT после добавления поддержки локализации
    UTF-8</td></tr><tr><td>502111</td><td>11 апреля 2004</td><td>5.2-CURRENT после удаления программного интерфейса
    getvfsent(3)</td></tr><tr><td>502112</td><td>13 апреля 2004</td><td>5.2-CURRENT после добавления директивы .warning для
    make.</td></tr><tr><td>502113</td><td>4 июня 2004</td><td>5.2-CURRENT после того, как функция ttyioctl() стала
    обязательной для драйверов последовательных устройств.</td></tr><tr><td>502114</td><td>13 июня 2004</td><td>5.2-CURRENT после импорта ALTQ инфраструктуры.</td></tr><tr><td>502115</td><td>14 июня 2004</td><td>5.2-CURRENT после того, как sema_timedwait(9) стал
    возвращать 0 в случае успеха и не нулевой код ошибки в
    случае неудачи.</td></tr><tr><td>502116</td><td>16 июня 2004</td><td>5.2-CURRENT после того, как kernel тип dev_t стал
    указателем на struct cdev *.</td></tr><tr><td>502117</td><td>17 июня 2004</td><td>5.2-CURRENT после того, как kernel тип udev_t изменился на
    dev_t.</td></tr><tr><td>502118</td><td>17 июня 2004</td><td>5.2-CURRENT после добавления поддержки CLOCK_VIRTUAL
    и CLOCK_PROF в clock_gettime(2) и clock_getres(2).</td></tr><tr><td>502119</td><td>22 июня 2004</td><td>5.2-CURRENT после того, как был проведён пересмотр
    клонирования сетевого интерфейса.</td></tr><tr><td>502120</td><td>2 июля 2004</td><td>5.2-CURRENT после обновления пакетного инструментария до
    ревизии 20040629.</td></tr><tr><td>502121</td><td>9 июля 2004</td><td>5.2-CURRENT после отметки, что код Bluetooth не ограничен
    архитектурой i386.</td></tr><tr><td>502122</td><td>11 июля 2004</td><td>5.2-CURRENT после появления отладочной инфраструктуры
    KDB, переноса DDB в бэкэнд и появления бэкэнда GDB.</td></tr><tr><td>502123</td><td>12 июля 2004</td><td>5.2-CURRENT после добавления в VFS_ROOT нового аргумента
    struct thread, так же как это делает vflush.  Структура
    kinfo_proc теперь имеет указатель на пользовательские данные.
    Смена реализации X по умолчанию на <code class="literal">xorg</code>
    было сделано в это же время.</td></tr><tr><td>502124</td><td>24 июля 2004</td><td>5.2-CURRENT после разделения способов запуска скриптов
    rc.d из портов и имеющих статус legacy.</td></tr><tr><td>502125</td><td>28 июля 2004</td><td>5.2-CURRENT после отмены предыдущего изменения.</td></tr><tr><td>502126</td><td>31 июля 2004</td><td>5.2-CURRENT после удаления kmem_alloc_pageable() и импорта
    gcc 3.4.2.</td></tr><tr><td>502127</td><td>2 августа 2004</td><td>5.2-CURRENT после изменения в API ядра UMA, разрешающего
    конструкторам/инициализаторам (ctors/inits) возвращать
    неудачу.</td></tr><tr><td>502128</td><td>8 августа 2004</td><td>5.2-CURRENT после изменения в сигнатуре vfs_mount, а также
    после общей замены PRISON_ROOT на SUSER_ALLOWJAIL в API
    suser(9).</td></tr><tr><td>503000</td><td>23 августа 2004</td><td>5.3-BETA/RC перед изменением в pfil API</td></tr><tr><td>503001</td><td>22 сентября 2004</td><td>5.3-RELEASE</td></tr><tr><td>503100</td><td>16 октября 2004</td><td>5.3-STABLE после отделения ветки RELENG_5_3</td></tr><tr><td>503101</td><td>3 декабря 2004</td><td>5.3-STABLE после добавления в функцию <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=strftime&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">strftime</span>(3)</span></a>
    параметров отступа в стиле glibc.</td></tr><tr><td>503102</td><td>13 февраля 2005</td><td>5.3-STABLE после выполнения MFC импорта nc(1) из
    OpenBSD.</td></tr><tr><td>503103</td><td>27 февраля 2005</td><td>5.4-PRERELEASE после выполнения MFC исправлений в
    <code class="filename">&lt;src/include/stdbool.h&gt;</code> и
    <code class="filename">&lt;src/sys/i386/include/_types.h&gt;</code>
    для использования совместимости GCC в компиляторе
    Intel C/C++.</td></tr><tr><td>503104</td><td>28 февраля 2005</td><td>5.4-PRERELEASE после выполнения MFC изменения поля ifi_epoch
    в структуре if_data со времени часов на время с момента
    старта.</td></tr><tr><td>503105</td><td>2 марта 2005</td><td>5.4-PRERELEASE после выполнения MFC исправления в
    vswprintf(3) проверки на EOVERFLOW.</td></tr><tr><td>504000</td><td>3 апреля 2005</td><td>5.4-RELEASE.</td></tr><tr><td>504100</td><td>3 апреля 2005</td><td>5.4-STABLE после отделения ветки RELENG_5_4</td></tr><tr><td>504101</td><td>11 мая 2005</td><td>5.4-STABLE после увеличения значения по умолчанию размера
    стека потока.</td></tr><tr><td>504102</td><td>24 июня 2005</td><td>5.4-STABLE после добавления sha256</td></tr><tr><td>504103</td><td>3 октября 2005</td><td>5.4-STABLE после выполнения MFC if_bridge</td></tr><tr><td>504104</td><td>13 октября 2005</td><td>5.4-STABLE после выполнения MFC bsdiff и portsnap</td></tr><tr><td>504105</td><td>17 января 2006</td><td>5.4-STABLE после выполнения MFC изменения
    ldconfig_local_dirs.</td></tr><tr><td>505000</td><td>12 мая 2006</td><td>5.5-RELEASE.</td></tr><tr><td>505100</td><td>12 мая 2006</td><td>5.5-STABLE после отделения ветки RELENG_5_5</td></tr><tr><td>600000</td><td>18 августа 2004</td><td>6.0-CURRENT</td></tr><tr><td>600001</td><td>27 августа 2004</td><td>6.0-CURRENT после постоянного включения в ядро
    PFIL_HOOKS.</td></tr><tr><td>600002</td><td>30 августа 2004</td><td>6.0-CURRENT после первоначального добавления ifi_epoch в
    структуру if_data.  Выполнен возврат после нескольких дней.  Не
    используйте это значение.</td></tr><tr><td>600003</td><td>8 сентября 2004</td><td>6.0-CURRENT после повторного добавления поля ifi_epoch в
    структуру if_data.</td></tr><tr><td>600004</td><td>29 сентября 2004</td><td>6.0-CURRENT после добавления в pfil API структуры inpcb как
    параметра.</td></tr><tr><td>600005</td><td>5 октября 2004</td><td>6.0-CURRENT после добавления в newsyslog параметра
    "-d DESTDIR".</td></tr><tr><td>600006</td><td>4 ноября 2004</td><td>6.0-CURRENT после добавления в функцию <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=strftime&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">strftime</span>(3)</span></a>
    параметров отступа в стиле glibc.</td></tr><tr><td>600007</td><td>12 декабря 2004</td><td>6.0-CURRENT после обновлений в инфраструктуре 802.11.</td></tr><tr><td>600008</td><td>25 января 2005</td><td>6.0-CURRENT после изменений в функциях VOP_*VOBJECT() и
    появления флага MNTK_MPSAFE для файловых систем, свободных от
    Giant.</td></tr><tr><td>600009</td><td>4 февраля 2005</td><td>6.0-CURRENT после добавления инфраструктуры и драйверов
    cpufreq.</td></tr><tr><td>600010</td><td>6 февраля 2005</td><td>6.0-CURRENT после импорта nc(1) из OpenBSD.</td></tr><tr><td>600011</td><td>12 февраля 2005</td><td>6.0-CURRENT после удаления подобия поддержки SVID2
    <code class="literal">matherr()</code>.</td></tr><tr><td>600012</td><td>15 февраля 2005</td><td>6.0-CURRENT после увеличения значения по умолчанию размера
    стеков потока.</td></tr><tr><td>600013</td><td>19 февраля 2005</td><td>6.0-CURRENT после исправлений в
    <code class="filename">&lt;src/include/stdbool.h&gt;</code> и
    <code class="filename">&lt;src/sys/i386/include/_types.h&gt;</code>
    для использования совместимости GCC в компиляторе Intel
    C/C++.</td></tr><tr><td>600014</td><td>21 февраля 2005</td><td>6.0-CURRENT после исправления в vswprintf(3) проверки на
    EOVERFLOW.</td></tr><tr><td>600015</td><td>25 февраля 2005</td><td>6.0-CURRENT после изменения поля ifi_epoch в структуре
    if_data со времени часов на время с момента старта.</td></tr><tr><td>600016</td><td>26 февраля 2005</td><td>6.0-CURRENT после изменения формата LC_CTYPE, используемого
    при записи на диск.</td></tr><tr><td>600017</td><td>27 февраля 2005</td><td>6.0-CURRENT после изменения формата каталогов NLS,
    используемого при записи на диск.</td></tr><tr><td>600018</td><td>27 февраля 2005</td><td>6.0-CURRENT после изменения формата LC_COLLATE,
    используемого при записи на диск.</td></tr><tr><td>600019</td><td>28 февраля 2005</td><td>Установка подключаемых файлов acpica в /usr/include.</td></tr><tr><td>600020</td><td>9 марта 2005</td><td>Добавление флага MSG_NOSIGNAL в API send(2).</td></tr><tr><td>600021</td><td>17 марта 2005</td><td>Добавление полей в cdevsw.</td></tr><tr><td>600022</td><td>21 марта 2005</td><td>gtar удален из основной системы.</td></tr><tr><td>600023</td><td>13 апреля 2005</td><td>В unix(4) добавлены параметры сокета LOCAL_CREDS,
    LOCAL_CONNWAIT.</td></tr><tr><td>600024</td><td>19 апреля 2005</td><td>В 6.0-CURRENT добавлены <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hwpmc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">hwpmc</span>(4)</span></a> и связанные
    инструменты.</td></tr><tr><td>600025</td><td>26 апреля 2005</td><td>В 6.0-CURRENT добавлена структура icmphdr.</td></tr><tr><td>600026</td><td>3 мая 2005</td><td>pf обновлен до 3.7.</td></tr><tr><td>600027</td><td>6 мая 2005</td><td>Представлены libalias и ng_nat уровня ядра.</td></tr><tr><td>600028</td><td>13 мая 2005</td><td>POSIX ttyname_r(3) сделан доступным через unistd.h и
    libc.</td></tr><tr><td>600029</td><td>29 мая 2005</td><td>6.0-CURRENT после обновления libpcap до v0.9.1 alpha
    096.</td></tr><tr><td>600030</td><td>5 июня 2005</td><td>6.0-CURRENT после импорта if_bridge(4) из NetBSD.</td></tr><tr><td>600031</td><td>10 июня 2005</td><td>6.0-CURRENT после перемещения структуры ifnet из структуры
    драйверов softc.</td></tr><tr><td>600032</td><td>11 июля 2005</td><td>6.0-CURRENT после импорта libpcap v0.9.1.</td></tr><tr><td>600033</td><td>25 июля 2005</td><td>6.0-STABLE после увеличения номера версии всех динамических
    библиотек, для которых он не был изменен с RELENG_5.</td></tr><tr><td>600034</td><td>13 августа 2005</td><td>6.0-STABLE после добавления аргумента учетных данных в
    обработчик событий dev_clone.  6.0-RELEASE.</td></tr><tr><td>600100</td><td>1 ноября 2005</td><td>6.0-STABLE после 6.0-RELEASE</td></tr><tr><td>600101</td><td>21 декабря 2005</td><td>6.0-STABLE после внедрения сценариев из каталогов
    local_startup в базовый <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcorder&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rcorder</span>(8)</span></a>.</td></tr><tr><td>600102</td><td>30 декабря 2005</td><td>6.0-STABLE после обновления типов и констант ELF.</td></tr><tr><td>600103</td><td>15 января 2006</td><td>6.0-STABLE после выполнения MFC API pidfile(3).</td></tr><tr><td>600104</td><td>17 января 2006</td><td>6.0-STABLE после выполнения MFC изменения
    ldconfig_local_dirs.</td></tr><tr><td>600105</td><td>26 февраля 2006</td><td>6.0-STABLE после добавления поддержки каталога NLS
    для csh(1).</td></tr><tr><td>601000</td><td>6 мая 2006</td><td>6.1-RELEASE</td></tr><tr><td>601100</td><td>6 мая 2006</td><td>6.1-STABLE после 6.1-RELEASE.</td></tr><tr><td>601101</td><td>22 июня 2006</td><td>6.1-STABLE после импорта csup.</td></tr><tr><td>601102</td><td>11 июля 2006</td><td>6.1-STABLE после обновления iwi(4).</td></tr><tr><td>601103</td><td>17 июля 2006</td><td>6.1-STABLE после обновления резолвера до BIND9
    и добавления реентерабельной версии функций netdb.</td></tr><tr><td>601104</td><td>8 августа 2006</td><td>6.1-STABLE после включения поддержки DSO (динамических
    совместно используемых объектов) в OpenSSL.</td></tr><tr><td>601105</td><td>2 сентября 2006</td><td>6.1-STABLE после исправлений в 802.11, изменяющих API
    для ioctl IEEE80211_IOC_STA_INFO.</td></tr><tr><td>602000</td><td>15 ноября 2006</td><td>6.2-RELEASE</td></tr><tr><td>602100</td><td>15 сентября 2006</td><td>6.2-STABLE после 6.2-RELEASE</td></tr><tr><td>602101</td><td>12 декабря 2006</td><td>6.2-STABLE после добавления квирка Wi-Spy.</td></tr><tr><td>602102</td><td>28 декабря 2006</td><td>6.2-STABLE после добавления pci_find_extcap().</td></tr><tr><td>602103</td><td>16 января 2007</td><td>6.2-STABLE после выполнения MFC изменения dlsym для поиска
    запрошенного символа в указанном dso и его неявных
    зависимостей.</td></tr><tr><td>602104</td><td>28 января 2007</td><td>6.2-STABLE после выполнения MFC узлов netgraph ng_deflate(4)
    и ng_pred1(4) и нового узла ng_ppp(4) со сжатием и
    шифрованием.</td></tr><tr><td>602105</td><td>20 февраля 2007</td><td>6.2-STABLE после выполнения MFC портированной из NetBSD
    версии <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gzip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">gzip</span>(1)</span></a> с лицензией BSD.</td></tr><tr><td>602106</td><td>31 марта 2007</td><td>6.2-STABLE после выполнения MFC поддержки PCI MSI и
    MSI-X.</td></tr><tr><td>602107</td><td>6 апреля 2007</td><td>6.2-STABLE после выполнения MFC ncurses 5.6 и поддержки
    двухбайтовых символов.</td></tr><tr><td>602108</td><td>11 апреля 2007</td><td>6.2-STABLE после выполнения MFC добавления периферийного
    устройства CAM 'SG', которое реализует подмножество API
    сквозных (passthrough) устройств Linux SCSI SG.</td></tr><tr><td>602109</td><td>17 апреля 2007</td><td>6.2-STABLE после выполнения MFC readline 5.2 patchset
    002.</td></tr><tr><td>602110</td><td>2 мая 2007</td><td>6.2-STABLE после выполнения MFC pmap_invalidate_cache(),
    pmap_change_attr(), pmap_mapbios(), pmap_mapdev_attr()
    и pmap_unmapbios() для mad64 и i386.</td></tr><tr><td>602111</td><td>11 июня 2007</td><td>6.2-STABLE после выполнения MFC BOP_BDFLUSH и вызванной
    этим поломки в KBI для модулей файловых систем.</td></tr><tr><td>602112</td><td>21 сентября 2007</td><td>6.2-STABLE после выполнения серии MFC libutil(3).</td></tr><tr><td>602113</td><td>25 октября 2007</td><td>6.2-STABLE после выполнения MFC разделения двухбайтовых
    и однобайтовых ctype.  Заново скомпилированные двоичные
    файлы, ссылающиеся на ctype.h, могут потребовать новый символ
    __mb_sb_limit, недоступный на более старых системах.</td></tr><tr><td>602114</td><td>30 октября 2007</td><td>6.2-STABLE после восстановления обратной совместимости
    ctype ABI.</td></tr><tr><td>602115</td><td>21 ноября 2007</td><td>6.2-STABLE после отката разделения двухбайтовых и
    однобайтовых ctype.</td></tr><tr><td>603000</td><td>25 ноября 2007</td><td>6.3-RELEASE</td></tr><tr><td>603100</td><td>25 ноября 2007</td><td>6.3-STABLE после 6.3-RELEASE.</td></tr><tr><td>603101</td><td>7 декабря 2007</td><td>6.3-STABLE после исправления поддержки многобайтовых
    типов в битовом макросе.</td></tr><tr><td>603102</td><td>24 апреля 2008</td><td>6.3-STABLE после добавления l_sysid к структуре
    flock.</td></tr><tr><td>603103</td><td>27 мая 2008</td><td>6.3-STABLE после выполнения MFC функции
    <code class="function">memrchr</code>.</td></tr><tr><td>603104</td><td>15 июня 2008</td><td>6.3-STABLE после выполнения MFC поддержки модификатора
    переменной <code class="literal">:u</code> в make(1).</td></tr><tr><td>604000</td><td>4 октября 2008</td><td>6.4-RELEASE</td></tr><tr><td>604100</td><td>4 октября 2008</td><td>6.4-STABLE после 6.4-RELEASE.</td></tr><tr><td>700000</td><td>11 июля 2005</td><td>7.0-CURRENT.</td></tr><tr><td>700001</td><td>23 июля 2005</td><td>7.0-CURRENT после увеличения номера версии всех динамических
    библиотек, для которых он не был изменен с RELENG_5.</td></tr><tr><td>700002</td><td>13 августа 2005</td><td>7.0-CURRENT после добавления аргумента учетных данных в
    обработчик событий dev_clone.</td></tr><tr><td>700003</td><td>25 августа 2005</td><td>7.0-CURRENT после добавления memmem(3) в libc.</td></tr><tr><td>700004</td><td>30 октября 2005</td><td>7.0-CURRENT после изменения параметров функции ядра
    solisten(9) для получения параметра backlog.</td></tr><tr><td>700005</td><td>11 ноября 2005</td><td>7.0-CURRENT после изменения IFP2ENADDR(), который теперь
    возвращает указатель на IF_LLADDR().</td></tr><tr><td>700006</td><td>11 ноября 2005</td><td>7.0-CURRENT после добавления поля
    <code class="literal">if_addr</code> в <code class="literal">struct ifnet</code>
    и удаления IFP2ENADDR().</td></tr><tr><td>700007</td><td>2 декабря 2005</td><td>7.0-CURRENT после внедрения сценариев из каталогов
    local_startup в базовый <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcorder&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rcorder</span>(8)</span></a>.</td></tr><tr><td>700008</td><td>5 декабря 2005</td><td>7.0-CURRENT после удаления параметра монтирования
    MNT_NODEV.</td></tr><tr><td>700009</td><td>19 декабря 2005</td><td>7.0-CURRENT после изменений типа ELF-64 и символьного
    версионирования.</td></tr><tr><td>700010</td><td>20 декабря 2005</td><td>7.0-CURRENT после добавления драйверов hostb и vgapci,
    добавления pci_find_extcap() и изменения в драйверах AGP,
    чтобы больше не отображать в память aperture.</td></tr><tr><td>700011</td><td>31 декабря 2005</td><td>7.0-CURRENT после замены tv_sec на time_t на всех
    платформах, кроме Alpha.</td></tr><tr><td>700012</td><td>8 января 2006</td><td>7.0-CURRENT после изменения ldconfig_local_dirs.</td></tr><tr><td>700013</td><td>12 января 2006</td><td>7.0-CURRENT после изменений в
    <code class="filename">/etc/rc.d/abi</code> для поддержки
    <code class="filename">/compat/linux/etc/ld.so.cache</code> в качестве
    символической ссылки на файловую систему в режиме только для
    чтения.</td></tr><tr><td>700014</td><td>26 января 2006</td><td>7.0-CURRENT после импорта pts.</td></tr><tr><td>700015</td><td>26 марта 2006</td><td>7.0-CURRENT после появления второй версии ABI
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hwpmc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">hwpmc</span>(4)</span></a></td></tr><tr><td>700016</td><td>22 апреля 2006</td><td>7.0-CURRENT после добавления <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fcloseall&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">fcloseall</span>(3)</span></a> в
    libc.</td></tr><tr><td>700017</td><td>13 мая 2006</td><td>7.0-CURRENT после удаления ip6fw.</td></tr><tr><td>700018</td><td>15 июля 2006</td><td>7.0-CURRENT после импорта snd_emu10kx.</td></tr><tr><td>700019</td><td>29 июля 2006</td><td>7.0-CURRENT после импорта OpenSSL 0.9.8b.</td></tr><tr><td>700020</td><td>3 сентября 2006</td><td>7.0-CURRENT после добавления функции bus_dma_get_tag</td></tr><tr><td>700021</td><td>4 сентября 2006</td><td>7.0-CURRENT после импорта libpcap 0.9.4 и tcpdump
    3.9.4.</td></tr><tr><td>700022</td><td>9 сентября 2006</td><td>7.0-CURRENT после изменения dlsym для поиска запрошенного
    символа в указанном dso и его неявных зависимостях.</td></tr><tr><td>700023</td><td>23 сентября 2006</td><td>7.0-CURRENT после добавления новых звуковых IOCTL для API
    микшера OSSv4.</td></tr><tr><td>700024</td><td>28 сентября 2006</td><td>7.0-CURRENT после импорта OpenSSL 0.9.8d.</td></tr><tr><td>700025</td><td>11 ноября 2006</td><td>7.0-CURRENT после добавления libelf.</td></tr><tr><td>700026</td><td>26 ноября 2006</td><td>7.0-CURRENT после значительных изменений в sysctl звуковой
    подсистемы.</td></tr><tr><td>700027</td><td>30 ноября 2006</td><td>7.0-CURRENT после добавления квирка Wi-Spy.</td></tr><tr><td>700028</td><td>15 декабря 2006</td><td>7.0-CURRENT после добавления вызовов sctp в libc.</td></tr><tr><td>700029</td><td>26 января 2007</td><td>7.0-CURRENT после удаления инкапсуляции туннеля IPIP
    (VIFF_TUNNEL) из кода IPv4 multicast forwarding.</td></tr><tr><td>700030</td><td>7 февраля 2007</td><td>7.0-CURRENT после замены реализации GNU <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gzip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">gzip</span>(1)</span></a>
    на портированную из NetBSD версию с лицензией BSD.</td></tr><tr><td>700031</td><td>23 февраля 2007</td><td>7.0-CURRENT после изменения в bus_setup_intr()
    (newbus).</td></tr><tr><td>700032</td><td>2 марта 2007</td><td>7.0-CURRENT после внесения микрокода ipw(4) и iwi(4).</td></tr><tr><td>700033</td><td>9 марта 2007</td><td>7.0-CURRENT после внесения поддержки двухбайтовых символов
    ncurses.</td></tr><tr><td>700034</td><td>19 марта 2007</td><td>7.0-CURRENT после изменений в работе insmntque(),
    getnewvnode() и vfs_hash_insert().</td></tr><tr><td>700035</td><td>26 марта 2007</td><td>7.0-CURRENT после добавления механизма уведомлений
    при изменении частоты CPU.</td></tr><tr><td>700036</td><td>6 апреля 2007</td><td>7.0-CURRENT после импорта файловой системы ZFS.</td></tr><tr><td>700037</td><td>8 апреля 2007</td><td>7.0-CURRENT после добавления периферийного устройства
    CAM 'SG', которое реализует подмножество API сквозных
    (passthrough) устройств Linux SCSI SG.</td></tr><tr><td>700038</td><td>30 апреля 2007</td><td>7.0-CURRENT после изменения <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=getenv&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">getenv</span>(3)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=putenv&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">putenv</span>(3)</span></a>,
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=setenv&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">setenv</span>(3)</span></a> и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=unsetenv&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">unsetenv</span>(3)</span></a> для совместимости с
    POSIX.</td></tr><tr><td>700039</td><td>1 мая 2007</td><td>7.0-CURRENT после отката изменений в 700038.</td></tr><tr><td>700040</td><td>10 мая 2007</td><td>7.0-CURRENT после добавления <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=flopen&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">flopen</span>(3)</span></a> в
    libutil.</td></tr><tr><td>700041</td><td>13 мая 2007</td><td>7.0-CURRENT после включения версионирования символов
    и изменения потоковой библиотеки, используемой по умолчанию,
    на libthr.</td></tr><tr><td>700042</td><td>19 мая 2007</td><td>7.0-CURRENT после импорта gcc 4.2.0.</td></tr><tr><td>700043</td><td>21 мая 2007</td><td>7.0-CURRENT после увеличения старшего номера версии
    для всех динамических библиотек, для которых это не было
    сделано с момента RELENG_6.</td></tr><tr><td>700044</td><td>7 июня 2007</td><td>7.0-CURRENT после изменения параметра для
    vn_open()/VOP_OPEN() вместо файлового дескриптора на
    struct file *.</td></tr><tr><td>700045</td><td>10 июня 2007</td><td>7.0-CURRENT после изменения <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pam_nologin&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pam_nologin</span>(8)</span></a>
    для обеспечения функции управления учетными записями
    вместо функции аутентификации для инфраструктуры PAM.</td></tr><tr><td>700046</td><td>11 июня 2007</td><td>7.0-CURRENT после обновления поддержки беспроводной
    связи 802.11.</td></tr><tr><td>700047</td><td>11 июня 2007</td><td>7.0-CURRENT после добавления возможностей TCP LRO
    интерфейса.</td></tr><tr><td>700048</td><td>12 июня 2007</td><td>7.0-CURRENT после добавления в стек IPv4 поддержки API RFC
    3678.  Унаследованное от RFC 1724 поведение ioctl IP_MULTICAST_IF
    теперь удалено; 0.0.0.0/8 больше не может быть использован для
    указания индекса интерфейса.  Вместо этого следует использовать
    структуру ipmreqn.</td></tr><tr><td>700049</td><td>3 июля 2007</td><td>7.0-CURRENT после импорта pf из OpenBSD 4.1</td></tr><tr><td>(не изменено)</td><td> </td><td>7.0-CURRENT после добавления поддержки IPv6 для FAST_IPSEC,
    удаления KAME IPSEC и переименования FAST_IPSEC в IPSEC.</td></tr><tr><td>700050</td><td>4 июля 2007</td><td>7.0-CURRENT после конвертации вызовов setenv/putenv/etc
    из традиционных BSD в POSIX.</td></tr><tr><td>700051</td><td>4 июля 2007</td><td>7.0-CURRENT после добавления новых системных вызовов
    mmap/lseek/etc.</td></tr><tr><td>700052</td><td>6 июля 2007</td><td>7.0-CURRENT после перемещения заголовков I4B
    в include/i4b.</td></tr><tr><td>700053</td><td>30 сентября 2007</td><td>7.0-CURRENT после добавления поддержки для доменов
    PCI.</td></tr><tr><td>700054</td><td>25 октября 2007</td><td>7.0-CURRENT после выполнения MFC разделения двухбайтовых
    и однобайтовых ctype.</td></tr><tr><td>700055</td><td>28 октября 2007</td><td>7.0-RELEASE, и 7.0-CURRENT после выполнения MFC обратной
    совместимости ABI для IOCTL'ей PCIOCGETCONF, PCIOCREAD и
    PCIOCWRITE с версиями FreeBSD 4/5/6, что вызвало повторную
    поломку ABI для PCIOCGETCONF IOCTL</td></tr><tr><td>700100</td><td>22 декабря 2007</td><td>7.0-STABLE после 7.0-RELEASE</td></tr><tr><td>700101</td><td>8 февраля 2008</td><td>7.0-STABLE после выполнения MFC m_collapse().</td></tr><tr><td>700102</td><td>30 марта 2008</td><td>7.0-STABLE после выполнения MFC kdb_enter_why().</td></tr><tr><td>700103</td><td>10 апреля 2008</td><td>7.0-STABLE после добавления l_sysid в структуру
    flock.</td></tr><tr><td>700104</td><td>11 апреля 2008</td><td>7.0-STABLE после выполнения MFC procstat(1).</td></tr><tr><td>700105</td><td>11 апреля 2008</td><td>7.0-STABLE после выполнения MFC возможностей umtx.</td></tr><tr><td>700106</td><td>15 апреля 2008</td><td>7.0-STABLE после выполнения MFC поддержки <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=write&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">write</span>(2)</span></a>
    для <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=psm&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">psm</span>(4)</span></a>.</td></tr><tr><td>700107</td><td>20 апреля 2008</td><td>7.0-STABLE после выполнения MFC команды F_DUP2FD для
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fcntl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">fcntl</span>(2)</span></a></td></tr><tr><td>700108</td><td>5 мая 2008</td><td>7.0-STABLE после некоторых изменений в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lockmgr&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">lockmgr</span>(9)</span></a>,
    которые для использования <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lockmgr&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">lockmgr</span>(9)</span></a> требуют подключения
    <code class="filename">sys/lock.h</code>.</td></tr><tr><td>700109</td><td>27 мая 2008</td><td>7.0-STABLE после выполнения MFC функции
    <code class="function">memrchr</code>.</td></tr><tr><td>700110</td><td>5 августа 2008</td><td>7.0-STABLE после выполнения MFC NFS-клиента lockd.</td></tr><tr><td>700111</td><td>20 августа 2008</td><td>7.0-STABLE после добавления поддержки физически протяженных
    jumbo-фреймов.</td></tr><tr><td>700112</td><td>27 августа 2008</td><td>7.0-STABLE после выполнения MFC поддержки DTrace в
    ядре.</td></tr><tr><td>701000</td><td>25 ноября 2008</td><td>7.1-RELEASE</td></tr><tr><td>701100</td><td>25 ноября 2008</td><td>7.1-STABLE после 7.1-RELEASE.</td></tr><tr><td>701101</td><td>10 января 2009</td><td>7.1-STABLE после бекпорта
    <code class="function">strndup</code>.</td></tr><tr><td>701102</td><td>17 января 2009</td><td>7.1-STABLE после добавления поддержки cpuctl(4).</td></tr><tr><td>701103</td><td>7 февраля 2009</td><td>7.1-STABLE после бекпорта jail с несколькими IP / без
    указания IP / с IPv6.</td></tr><tr><td>701104</td><td>14 февраля 2009</td><td>7.1-STABLE после сохранения владельца приостановки в
    структуре mount и появления метода vfs_susp_clean в структуре
    vfsops.</td></tr><tr><td>701105</td><td>12 марта 2009</td><td>7.1-STABLE после несовместимых изменений в sysctl
    kern.ipc.shmsegs для возможности выделения сегментов
    разделяемой памяти SysV большего размера на 64-битных
    архитектурах.</td></tr><tr><td>701106</td><td>14 марта 2009</td><td>7.1-STABLE после бекпорта исправления операций
    ожидания для семафоров POSIX.</td></tr><tr><td>702000</td><td>15 апреля 2009</td><td>7.2-RELEASE</td></tr><tr><td>702100</td><td>15 апреля 2009</td><td>7.2-STABLE после 7.2-RELEASE.</td></tr><tr><td>702101</td><td>15 мая 2009</td><td>7.2-STABLE после изменения ichsmb(4) для использования
    вспомогательной адресации с выравниванием по левой стороне,
    как и в других драйверах контроллера SMBus.</td></tr><tr><td>702102</td><td>28 мая 2009</td><td>7.2-STABLE после выполнения MFC функции
    <code class="function">fdopendir</code>.</td></tr><tr><td>702103</td><td>6 июня 2009</td><td>7.2-STABLE после выполнения MFC PmcTools.</td></tr><tr><td>702104</td><td>14 июля 2009</td><td>7.2-STABLE после выполнения MFC системного вызова
    <code class="function">closefrom</code>.</td></tr><tr><td>702105</td><td>31 июля 2009</td><td>7.2-STABLE после выполнения MFC изменения ABI для
    SYSVIPC.</td></tr><tr><td>702106</td><td>14 сентября 2009</td><td>7.2-STABLE после выполнения MFC улучшений в x86 PAT и
    добавления d_mmap_single() и объекта VM типа "список
    scatter/gather".</td></tr><tr><td>703000</td><td>9 февраля 2010</td><td>7.3-RELEASE</td></tr><tr><td>703100</td><td>9 февраля 2010</td><td>7.3-STABLE после 7.3-RELEASE.</td></tr><tr><td>704000</td><td>22 декабря 2010</td><td>7.4-RELEASE</td></tr><tr><td>704100</td><td>22 декабря 2010</td><td>7.4-STABLE после 7.4-RELEASE.</td></tr><tr><td>800000</td><td>11 октября 2007</td><td>8.0-CURRENT.  Разделение двухбайтовых и однобайтовых
    ctype.</td></tr><tr><td>800001</td><td>16 октября 2007</td><td>8.0-CURRENT после импорта libpcap 0.9.8 и tcpdump
    3.9.8.</td></tr><tr><td>800002</td><td>21 октября 2007</td><td>8.0-CURRENT после переименования kthread_create() и
    сопутствующих функций в kproc_create() и т.д.</td></tr><tr><td>800003</td><td>24 октября 2007</td><td>8.0-CURRENT после добавления обратной совместимости ABI для
    IOCTL'ей PCIOCGETCONF, PCIOCREAD и PCIOCWRITE с версиями FreeBSD
    4/5/6, что вызвало повторную поломку ABI для PCIOCGETCONF
    IOCTL</td></tr><tr><td>800004</td><td>12 ноября 2007</td><td>8.0-CURRENT после перемещения драйвера agp(4) из src/sys/pci
    в src/sys/dev/agp</td></tr><tr><td>800005</td><td>4 декабря 2007</td><td>8.0-CURRENT после изменений в распределителе jumbo-фреймов
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/174247"><span class="svnref">174247</span></a>).</td></tr><tr><td>800006</td><td>7 декабря 2007</td><td>8.0-CURRENT после добавления функциональности захвата графа
    вызовов в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hwpmc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">hwpmc</span>(4)</span></a>.</td></tr><tr><td>800007</td><td>25 декабря 2007</td><td>8.0-CURRENT после того, как kdb_enter() получила параметр
    "why".</td></tr><tr><td>800008</td><td>28 декабря 2007</td><td>8.0-CURRENT после удаления опции LK_EXCLUPGRADE.</td></tr><tr><td>800009</td><td>9 января 2008</td><td>8.0-CURRENT после появления <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lockmgr_disown&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">lockmgr_disown</span>(9)</span></a></td></tr><tr><td>800010</td><td>10 января 2008</td><td>8.0-CURRENT после изменения прототипа
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vn_lock&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">vn_lock</span>(9)</span></a>.</td></tr><tr><td>800011</td><td>13 января 2008</td><td>8.0-CURRENT после изменения прототипов <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=VOP_LOCK&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">VOP_LOCK</span>(9)</span></a> и
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=VOP_UNLOCK&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">VOP_UNLOCK</span>(9)</span></a>.</td></tr><tr><td>800012</td><td>19 января 2008</td><td>8.0-CURRENT после появления <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lockmgr_recursed&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">lockmgr_recursed</span>(9)</span></a>,
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=BUF_RECURSED&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">BUF_RECURSED</span>(9)</span></a> и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=BUF_ISLOCKED&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">BUF_ISLOCKED</span>(9)</span></a> и удаления
    <code class="function">BUF_REFCNT()</code>.</td></tr><tr><td>800013</td><td>23 января 2008</td><td>8.0-CURRENT после появления кодировки
    <span class="quote"><<<span class="quote">ASCII</span>>></span>.</td></tr><tr><td>800014</td><td>24 января 2008</td><td>8.0-CURRENT после изменения прототипа <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lockmgr&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">lockmgr</span>(9)</span></a> и
    удаления <code class="function">lockcount()</code> и
    <code class="function">LOCKMGR_ASSERT()</code>.</td></tr><tr><td>800015</td><td>26 января 2008</td><td>8.0-CURRENT после расширения типов для структур
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fts&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">fts</span>(3)</span></a>.</td></tr><tr><td>800016</td><td>1 февраля 2008</td><td>8.0-CURRENT после добавления параметра MEXTADD(9)</td></tr><tr><td>800017</td><td>6 февраля 2008</td><td>8.0-CURRENT после появления опций LK_NODUP и LK_NOWITNESS в
    пространстве <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lockmgr&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">lockmgr</span>(9)</span></a>.</td></tr><tr><td>800018</td><td>8 февраля 2008</td><td>8.0-CURRENT после добавления m_collapse.</td></tr><tr><td>800019</td><td>9 февраля 2008</td><td>8.0-CURRENT после добавления поддержки текущего рабочего
    каталога, корневого каталога и каталогов jail в sysctl
    kern.proc.filedesc.</td></tr><tr><td>800020</td><td>13 февраля 2008</td><td>8.0-CURRENT после появления функций <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lockmgr_assert&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">lockmgr_assert</span>(9)</span></a> и
    <code class="function">BUF_ASSERT</code>.</td></tr><tr><td>800021</td><td>15 февраля 2008</td><td>8.0-CURRENT после появления <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lockmgr_args&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">lockmgr_args</span>(9)</span></a> и удаления
    флага LK_INTERNAL.</td></tr><tr><td>800022</td><td>(отменено)</td><td>8.0-CURRENT после замены используемого по умолчанию ar на
    BSD <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ar&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ar</span>(1)</span></a>.</td></tr><tr><td>800023</td><td>25 февраля 2008</td><td>8.0-CURRENT после изменения прототипов <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lockstatus&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">lockstatus</span>(9)</span></a> и
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=VOP_ISLOCKED&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">VOP_ISLOCKED</span>(9)</span></a>, а именно удаления аргумента <code class="literal">struct
      thread</code>.</td></tr><tr><td>800024</td><td>1 марта 2008</td><td>8.0-CURRENT после сокращения функций
    <code class="function">lockwaiters</code> и
    <code class="function">BUF_LOCKWAITERS</code>, изменения возвращаемого
    значения для <code class="function">brelvp</code> с void и int и появления
    новых флагов для <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lockinit&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">lockinit</span>(9)</span></a>.</td></tr><tr><td>800025</td><td>8 марта 2008</td><td>8.0-CURRENT после добавления в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fcntl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">fcntl</span>(2)</span></a> команды
    F_DUP2FD.</td></tr><tr><td>800026</td><td>12 марта 2008</td><td>8.0-CURRENT после изменения параметра приоритета для
    cv_broadcastpri так, что 0 означает отсутствие
    приоритета.</td></tr><tr><td>800027</td><td>24 марта 2008</td><td>8.0-CURRENT после изменения API мониторинга bpf, когда были
    добавлены буферы zerocopy bpf.</td></tr><tr><td>800028</td><td>26 марта 2008</td><td>8.0-CURRENT после добавления l_sysid в структуру
    flock.</td></tr><tr><td>800029</td><td>28 марта 2008</td><td>8.0-CURRENT после реинтеграции функции
    <code class="function">BUF_LOCKWAITERS</code> и добавления
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lockmgr_waiters&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">lockmgr_waiters</span>(9)</span></a>.</td></tr><tr><td>800030</td><td>1 апреля 2008</td><td>8.0-CURRENT после появления функций <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rw_try_rlock&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">rw_try_rlock</span>(9)</span></a> и
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rw_try_wlock&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">rw_try_wlock</span>(9)</span></a>.</td></tr><tr><td>800031</td><td>6 апреля 2008</td><td>8.0-CURRENT после появления функций
    <code class="function">lockmgr_rw</code> и
    <code class="function">lockmgr_args_rw</code>.</td></tr><tr><td>800032</td><td>8 апреля 2008</td><td>8.0-CURRENT после реализации openat и связанных с ним
    системных вызовов, появления флага O_EXEC для <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=open&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a> и
    обеспечения соответствующих системных вызовов для
    linux-совместимости.</td></tr><tr><td>800033</td><td>8 апреля 2008</td><td>8.0-CURRENT после добавления поддержки <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=write&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">write</span>(2)</span></a> для
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=psm&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">psm</span>(4)</span></a> в нативном операционном режиме.  Теперь в
    <code class="filename">/dev/psm%d</code> можно записывать произвольные
    команды и считывать из него обратно состояние.</td></tr><tr><td>800034</td><td>10 апреля 2008</td><td>8.0-CURRENT после появления функции
    <code class="function">memrchr</code>.</td></tr><tr><td>800035</td><td>16 апреля 2008</td><td>8.0-CURRENT после появления функции
    <code class="function">fdopendir</code>.</td></tr><tr><td>800036</td><td>20 апреля 2008</td><td>8.0-CURRENT после переключения беспроводной связи 802.11 на
    поддержку multi-bss (также известного как vaps).</td></tr><tr><td>800037</td><td>9 мая 2008</td><td>8.0-CURRENT после добавления поддержки мульти-роутинговых
    таблиц (также известных как setfib(1), setfib(2)).</td></tr><tr><td>800038</td><td>26 мая 2008</td><td>8.0-CURRENT после удаления netatm и ISDN4BSD.  Также,
    добавление инструментария Compact C Type (CTF).</td></tr><tr><td>800039</td><td>14 июня 2008</td><td>8.0-CURRENT после удаления sgtty.</td></tr><tr><td>800040</td><td>26 июня 2008</td><td>8.0-CURRENT клиентом NFS lockd в ядре.</td></tr><tr><td>800041</td><td>22 июля 2008</td><td>8.0-CURRENT после добавления arc4random_buf(3) и
    arc4random_uniform(3).</td></tr><tr><td>800042</td><td>8 августа 2008</td><td>8.0-CURRENT после добавления cpuctl(4).</td></tr><tr><td>800043</td><td>13 августа 2008</td><td>8.0-CURRENT после изменения в bpf(4) для использования
    единственного узла устройства вместо клонирования
    устройств.</td></tr><tr><td>800044</td><td>17 августа 2008</td><td>8.0-CURRENT после коммита первых шагов проекта vimage с
    переименованием глобальных переменных для их виртуализации в
    макросы с префиксом V_ для их отображения обратно на глобальные
    имена.</td></tr><tr><td>800045</td><td>20 августа 2008</td><td>8.0-CURRENT после интеграции прослойки MPSAFE TTY,
    включающей изменения в различных, взаимодействующих с ней
    драйверах и утилитах.</td></tr><tr><td>800046</td><td>8 сентября 2008</td><td>8.0-CURRENT после разделения GDT для каждого CPU в
    архитектуре amd64.</td></tr><tr><td>800047</td><td>10 сентября 2008</td><td>8.0-CURRENT после удаления VSVTX, VSGID и VSUID.</td></tr><tr><td>800048</td><td>16 сентября 2008</td><td>8.0-CURRENT после преобразования кода монтирования NFS в
    ядре для принятия индивидуальных опций монтирования в iovec
    nmount(), а не только в одной большой структуре nfs_args.</td></tr><tr><td>800049</td><td>17 сентября 2008</td><td>8.0-CURRENT после удаления <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=suser&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">suser</span>(9)</span></a> и
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=suser_cred&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">suser_cred</span>(9)</span></a>.</td></tr><tr><td>800050</td><td>20 октября 2008</td><td>8.0-CURRENT после изменения в API кеша буферов.</td></tr><tr><td>800051</td><td>23 октября 2008</td><td>8.0-CURRENT после удаления макросов <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=MALLOC&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">MALLOC</span>(9)</span></a> и
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=FREE&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">FREE</span>(9)</span></a>.</td></tr><tr><td>800052</td><td>28 октября 2008</td><td>8.0-CURRENT после появления accmode_t и переименования
    параметра VOP_ACCESS 'a_mode' в 'a_accmode'.</td></tr><tr><td>800053</td><td>2 ноября 2008</td><td>8.0-CURRENT после изменения прототипа <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vfs_busy&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">vfs_busy</span>(9)</span></a> и
    появления его флагов MBF_NOWAIT и MBF_MNTLSTLOCK.</td></tr><tr><td>800054</td><td>22 ноября 2008</td><td>8.0-CURRENT после добавления buf_ring, барьеров памяти и
    функций ifnet для множественных аппаратных очередей передачи для
    поддерживающих это карт, а также реализации ring-buffer без
    использования синхронизации для более эффективного управления
    очередями пакетов в драйверах.</td></tr><tr><td>800055</td><td>27 ноября 2008</td><td>8.0-CURRENT после добавления поддержки <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hwpmc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">hwpmc</span>(4)</span></a> для
    IntelTM Core, Core2 и Atom.</td></tr><tr><td>800056</td><td>29 ноября 2008</td><td>8.0-CURRENT после появления jail с несколькими IP / без
    указания IP / с IPv6.</td></tr><tr><td>800057</td><td>1 декабря 2008</td><td>8.0-CURRENT после переключения на использование исходного
    кода ath hal.</td></tr><tr><td>800058</td><td>12 декабря 2008</td><td>8.0-CURRENT после появления операции VOP_VPTOCNP.</td></tr><tr><td>800059</td><td>15 декабря 2008</td><td>8.0-CURRENT включает в себя новый переписанный
    arp-v2.</td></tr><tr><td>800060</td><td>19 декабря 2008</td><td>8.0-CURRENT после добавления makefs.</td></tr><tr><td>800061</td><td>15 января 2009</td><td>8.0-CURRENT после TCP Appropriate Byte Counting.</td></tr><tr><td>800062</td><td>28 января 2009</td><td>8.0-CURRENT после удаления minor(), minor2unit(),
    unit2minor(), и т.д.</td></tr><tr><td>800063</td><td>18 февраля 2009</td><td>8.0-CURRENT после изменения конфига GENERIC для
    использования стека USB2, а также после добавления
    fdevname(3).</td></tr><tr><td>800064</td><td>23 февраля 2009</td><td>8.0-CURRENT после того, как перемещен стек USB2, и он
    заменяет dev/usb.</td></tr><tr><td>800065</td><td>26 февраля 2009</td><td>8.0-CURRENT после переименования всех функций в
    libmp(3).</td></tr><tr><td>800066</td><td>27 февраля 2009</td><td>8.0-CURRENT после изменения управления и раскладки USB в
    devfs.</td></tr><tr><td>800067</td><td>28 февраля 2009</td><td>8.0-CURRENT после добавления getdelim(), getline(),
    stpncpy(), strnlen(), wcsnlen(), wcscasecmp() и
    wcsncasecmp().</td></tr><tr><td>800068</td><td>2 марта 2009</td><td>8.0-CURRENT после переименования devclass ushub в
    uhub.</td></tr><tr><td>800069</td><td>9 марта 2009</td><td>8.0-CURRENT после переименования libusb20.so.1 в
    libusb.so.1.</td></tr><tr><td>800070</td><td>9 марта 2009</td><td>8.0-CURRENT после объединения IGMPv3 и Source-Specific
    Multicast (SSM) в стек IPv4.</td></tr><tr><td>800071</td><td>14 марта 2009</td><td>8.0-CURRENT после применения патча к gcc для использования
    inline-семантики C99 в режиме c99 и gnu99.</td></tr><tr><td>800072</td><td>15 марта 2009</td><td>8.0-CURRENT после удаления флага IFF_NEEDSGIANT; сетевые
    не-MPSAFE драйвера устройств более не поддерживаются.</td></tr><tr><td>800073</td><td>18 марта 2009</td><td>8.0-CURRENT после реализации динамического замещения
    строковых токенов для rpath и необходимых путей.</td></tr><tr><td>800074</td><td>24 марта 2009</td><td>8.0-CURRENT после импорта tcpdump 4.0.0 и libpcap
    1.0.0.</td></tr><tr><td>800075</td><td>6 апреля 2009</td><td>8.0-CURRENT после изменения раскладки в структурах vnet_net,
    vnet_inet и vnet_ipfw.</td></tr><tr><td>800076</td><td>9 апреля 2009</td><td>8.0-CURRENT после добавления профилей задержки в
    dummynet.</td></tr><tr><td>800077</td><td>14 апреля 2009</td><td>8.0-CURRENT после удаления VOP_LEASE() и
    vop_vector.vop_lease.</td></tr><tr><td>800078</td><td>15 апреля 2009</td><td>8.0-CURRENT после добавления полей структуры rt_weight в
    структуры rt_metrics и rt_metrics_lite, изменения раскладки
    структуры rt_metrics_lite.  Сделано, но затем отменено увеличение
    номера версии RTM_VERSION.</td></tr><tr><td>800079</td><td>15 апреля 2009</td><td>8.0-CURRENT после добавления указателей на структуру llentry
    в структуры route и route_in6.</td></tr><tr><td>800080</td><td>15 апреля 2009</td><td>8.0-CURRENT после изменения раскладки структуры
    inpcb.</td></tr><tr><td>800081</td><td>19 апреля 2009</td><td>8.0-CURRENT после изменения раскладки структуры
    malloc_type.</td></tr><tr><td>800082</td><td>21 апреля 2009</td><td>8.0-CURRENT после изменения раскладки структуры ifnet и
    подсчета ссылок на ifnet в if_ref() и  if_rele().</td></tr><tr><td>800083</td><td>22 апреля 2009</td><td>8.0-CURRENT после реализации низкоуровнего API Bluetooth
    HCI.</td></tr><tr><td>800084</td><td>29 апреля 2009</td><td>8.0-CURRENT изменений в IPv6 SSM и MLDv2.</td></tr><tr><td>800085</td><td>30 апреля 2009</td><td>8.0-CURRENT после включения поддержки сборки ядра VIMAGE с
    одним активным образом.</td></tr><tr><td>800086</td><td>8 мая 2009</td><td>8.0-CURRENT после добавления в patch(1) поддержки строк
    ввода произвольной длины.</td></tr><tr><td>800087</td><td>11 мая 2009</td><td>8.0-CURRENT после некоторых изменений в KPI VFS.  Параметр
    потока удален из частей FSD в VFS.  Функциям
    <code class="function">VFS_*</code> этот контекст больше не нужен,
    потому что он всегда ссылается на <code class="varname">curthread</code>.
    В некоторых особых случаях оставлено прежнее поведение.</td></tr><tr><td>800088</td><td>20 мая 2009</td><td>8.0-CURRENT после изменений в режиме net80211
    monitor.</td></tr><tr><td>800089</td><td>23 мая 2009</td><td>8.0-CURRENT после добавления поддержки управляющего блока
    UDP.</td></tr><tr><td>800090</td><td>23 мая 2009</td><td>8.0-CURRENT после клонирования виртуализованных
    интерфейсов.</td></tr><tr><td>800091</td><td>27 мая 2009</td><td>8.0-CURRENT после добавления иерархических jail и удаления
    глобального securelevel.</td></tr><tr><td>800092</td><td>29 мая 2009</td><td>8.0-CURRENT после изменения KPI для
    <code class="function">sx_init_flags()</code>.  Для обратного логического
    управления вместо убранной <code class="constant">SX_ADAPTIVESPIN</code>
    представлена новая <code class="constant">SX_NOADAPTIVE</code>.</td></tr><tr><td>800093</td><td>29 мая 2009</td><td>8.0-CURRENT после добавления mnt_xflag в структуру
    mount.</td></tr><tr><td>800094</td><td>30 мая 2009</td><td>8.0-CURRENT после добавления <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=VOP_ACCESSX&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">VOP_ACCESSX</span>(9)</span></a>.</td></tr><tr><td>800095</td><td>30 мая 2009</td><td>8.0-CURRENT после изменения KPI polling.  Обработчики
    polling теперь возвращают количество обработанных пакетов.  Также
    представлена новая <code class="constant">IFCAP_POLLING_NOCOUNT</code> для
    указания на неважность возвращаемого значения и пропуска
    счетчиков.</td></tr><tr><td>800096</td><td>1 июня 2009</td><td>8.0-CURRENT после обновления до новой реализации netisr и
    после изменения способа хранения и доступа к FIB.</td></tr><tr><td>800097</td><td>8 июня 2009</td><td>8.0-CURRENT после появления хуков для деструкторов и
    инфраструктуры vnet.</td></tr><tr><td>800097</td><td>11 июня 2009</td><td>8.0-CURRENT после появления обнаружения пути вызовов от
    исходящего на входящий для netgraph и постановления в очередь,
    что также изменяет раскладку структуры thread.</td></tr><tr><td>800098</td><td>14 июня 2009</td><td>8.0-CURRENT после импорта OpenSSL 0.9.8k.</td></tr><tr><td>800099</td><td>22 июня 2009</td><td>8.0-CURRENT после обновления NGROUPS и перемещения
    виртуализации маршрутов в свой собственный модуль VImage.</td></tr><tr><td>800100</td><td>24 июня 2009</td><td>8.0-CURRENT после изменения ABI для SYSVIPC.</td></tr><tr><td>800101</td><td>29 июня 2009</td><td>8.0-CURRENT после удаления символьных устройств /dev/net/*,
    используемых отдельно для каждого интерфейса.</td></tr><tr><td>800102</td><td>12 июля 2009</td><td>8.0-CURRENT после добавления резервных полей в структурах
    sackhint, tcpcb и tcpstat.</td></tr><tr><td>800103</td><td>13 июля 2009</td><td>8.0-CURRENT после замены структуры tcpopt на структуру
    toeopt в интерфейсе драйвера TOE в TCP syncache.</td></tr><tr><td>800104</td><td>14 июля 2009</td><td>8.0-CURRENT после добавления распределителя, индивидуального
    для каждого vnet, на основе связанного множества.</td></tr><tr><td>800105</td><td>19 июля 2009</td><td>8.0-CURRENT после увеличения номера версии для всех
    динамических библиотек, для которых не включено символьное
    версионирование.</td></tr><tr><td>800106</td><td>24 июля 2009</td><td>8.0-CURRENT после появления типа объекта VM OBJT_SG.</td></tr><tr><td>800107</td><td>2 августа 2009</td><td>8.0-CURRENT после освобождения подсистемы newbus от Giant
    через добавление newbus sxlock.</td></tr><tr><td>800108</td><td>21 ноября 2009</td><td>8.0-STABLE после реализации kevent-фильтра
    EVFILT_USER.</td></tr><tr><td>800500</td><td>7 января 2010</td><td>8.0-STABLE после увеличения номера
    <code class="literal">__FreeBSD_version</code> для использования в
    <code class="command">pkg_add -r</code> packages-8-stable.</td></tr><tr><td>800501</td><td>24 января 2010</td><td>8.0-STABLE после изменения прототипов
    <code class="function">scandir(3)</code> и
    <code class="function">alphasort(3)</code> для соответствия SUSv4.</td></tr><tr><td>800502</td><td>31 января 2010</td><td>8.0-STABLE после добавления
    <code class="function">sigpause(3)</code>.</td></tr><tr><td>800503</td><td>25 февраля 2010</td><td>8.0-STABLE после добавления ioctl SIOCGIFDESCR и
    SIOCSIFDESCR к сетевым интерфейсам.  Эти ioctl можно использовать
    для описания интерфейсов в духе OpenBSD.</td></tr><tr><td>800504</td><td>1 марта 2010</td><td>8.0-STABLE после выполнения MFC импорта x86emu из OpenBSD,
    программного эмулятора реального режима для CPU x86.</td></tr><tr><td>800505</td><td>18 мая 2010</td><td>8.0-STABLE после выполнения MFC добавления liblzma, xz,
    xzdec, и lzmainfo.</td></tr><tr><td>801000</td><td>14 июня 2010</td><td>8.1-RELEASE</td></tr><tr><td>801500</td><td>14 июня 2010</td><td>8.1-STABLE после 8.1-RELEASE.</td></tr><tr><td>801501</td><td>3 ноября 2010</td><td>8.1-STABLE после изменения KBI в структуре sysentvec и
    реализации PL_FLAG_SCE/SCX/EXEC/SI и pl_siginfo для
    ptrace(PT_LWPINFO).</td></tr><tr><td>802000</td><td>22 декабря 2010</td><td>8.2-RELEASE</td></tr><tr><td>802500</td><td>22 декабря 2010</td><td>8.2-STABLE после 8.2-RELEASE.</td></tr><tr><td>802501</td><td>28 февраля 2011</td><td>8.2-STABLE после обратного портирования изменений DTrace,
    включающих поддержку трассировки пользовательских
    программ.</td></tr><tr><td>802502</td><td>6 марта 2011</td><td>8.2-STABLE после обратного портирования log2 и log2f в
    libm.</td></tr><tr><td>802503</td><td>1 мая 2011</td><td>8.2-STABLE после обновления gcc до последней версии с
    лицензией GPLv2 из FSF gcc-4_2-branch.</td></tr><tr><td>802504</td><td>28 мая 2011</td><td>8.2-STABLE после появления KPI и вспомогательной
    инфраструктуры модульного контроля перегрузки.</td></tr><tr><td>802505</td><td>28 мая 2011</td><td>8.2-STABLE после появления KPI Hhook и Khelp.</td></tr><tr><td>802506</td><td>28 мая 2011</td><td>8.2-STABLE после добавления OSD в структуру tcpcb.</td></tr><tr><td>802507</td><td>6 июня 2011</td><td>8.2-STABLE после импорта ZFS v28.</td></tr><tr><td>802508</td><td>8 июня 2011</td><td>8.2-STABLE после удаления обработчика событий schedtail
    и добавления метода sv_schedtail в структуру sysvec.</td></tr><tr><td>802509</td><td>14 июля 2011</td><td>8.2-STABLE после обратного портирования поддержки SSSE3 в
    binutils.</td></tr><tr><td>802510</td><td>19 июля 2011</td><td>8.2-STABLE после добавления флага RFTSIGZMB в
    <code class="function">rfork(2)</code>.</td></tr><tr><td>802511</td><td>9 сентября 2011</td><td>8.2-STABLE после добавления автоматического распознавания
    устройств USB mass storage, которые не поддерживают команду SCSI
    no synchronize cache.</td></tr><tr><td>802512</td><td>10 сентября 2011</td><td>8.2-STABLE после обратного портирования переработанного
    auto-quirk.</td></tr><tr><td>802513</td><td>25 октября 2011</td><td>8.2-STABLE после обратного портирования флага
    MAP_PREFAULT_READ в <code class="function">mmap(2)</code>.</td></tr><tr><td>802514</td><td>16 ноября 2011</td><td>8.2-STABLE после обратного портирования системного вызова
    posix_fallocate(2).</td></tr><tr><td>802515</td><td>6 января 2012</td><td>8.2-STABLE после обратного портирования системного вызова
    posix_fadvise(2).</td></tr><tr><td>802516</td><td>16 января 2012</td><td>8.2-STABLE после обратного портирования gperf 3.0.3.</td></tr><tr><td>802517</td><td>15 февраля 2012</td><td>8.2-STABLE после появления нового расширяемого интерфейса
    sysctl(3) NET_RT_IFLISTL для получения списка адресов (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/231769"><span class="svnref">231769</span></a>).</td></tr><tr><td>803000</td><td>3 марта 2012</td><td>8.3-RELEASE.</td></tr><tr><td>803500</td><td>3 марта 2012</td><td>8.3-STABLE после отделения ветки releng/8.3
    (RELENG_8_3).</td></tr><tr><td>804000</td><td>28 марта 2013</td><td>8.4-RELEASE.</td></tr><tr><td>804500</td><td>28 марта 2013</td><td>8.4-STABLE после 8.4-RELEASE.</td></tr><tr><td>900000</td><td>22 августа 2009</td><td>9.0-CURRENT.</td></tr><tr><td>900001</td><td>8 сентября 2009</td><td>9.0-CURRENT после импорта x86emu из OpenBSD, программного
    эмулятора реального режима для CPU x86.</td></tr><tr><td>900002</td><td>23 сентября 2009</td><td>9.0-CURRENT после реализации функциональности kevent-фильтра
    EVFILT_USER.</td></tr><tr><td>900003</td><td>2 декабря 2009</td><td>9.0-CURRENT после добавления
    <code class="function">sigpause(3)</code> и поддержки PIE в csu.</td></tr><tr><td>900004</td><td>6 декабря 2009</td><td>9.0-CURRENT после добавления libulog и его интерфейса
    совместимости libutempter.</td></tr><tr><td>900005</td><td>12 декабря 2009</td><td>9.0-CURRENT после добавления
    <code class="function">sleepq_sleepcnt()</code>, которую можно
    использовать для запроса количества ожидающих в указанной
    очереди ожидания.</td></tr><tr><td>900006</td><td>4 января 2010</td><td>9.0-CURRENT после изменения прототипов
    <code class="function">scandir(3)</code> и
    <code class="function">alphasort(3)</code> для соответствия SUSv4.</td></tr><tr><td>900007</td><td>13 января 2010</td><td>9.0-CURRENT после удаления utmp(5) и добавления utmpx
    (смотрите <code class="function">getutxent(3)</code>) для улучшенного
    протоколирования пользовательских входов и системных
    событий.</td></tr><tr><td>900008</td><td>20 января 2010</td><td>9.0-CURRENT после импорта BSDL bc/dc и объявления GNU bc/dc
    устаревшими.</td></tr><tr><td>900009</td><td>26 января 2010</td><td>9.0-CURRENT после добавления ioctl SIOCGIFDESCR и
    SIOCSIFDESCR к сетевым интерфейсам.  Эти ioctl можно использовать
    для описания интерфейсов в духе OpenBSD.</td></tr><tr><td>900010</td><td>22 марта 2010</td><td>9.0-CURRENT после импорта zlib 1.2.4.</td></tr><tr><td>900011</td><td>24 апреля 2010</td><td>9.0-CURRENT после добавления журналирования мягких
    обновлений.</td></tr><tr><td>900012</td><td>10 мая 2010</td><td>9.0-CURRENT после добавления liblzma, xz, xzdec и
    lzmainfo.</td></tr><tr><td>900013</td><td>14 мая 2010</td><td>9.0-CURRENT после привлечения исправлений USB в
    linux(4).</td></tr><tr><td>900014</td><td>10 июня 2010</td><td>9.0-CURRENT после добавления Clang.</td></tr><tr><td>900015</td><td>22 июля 2010</td><td>9.0-CURRENT после импорта BSD grep.</td></tr><tr><td>900016</td><td>28 июля 2010</td><td>9.0-CURRENT после добавления mti_zone в структуру
    malloc_type_internal.</td></tr><tr><td>900017</td><td>23 августа 2010</td><td>9.0-CURRENT после изменения grep по умолчанию обратно на
    GNU grep и добавления knob WITH_BSD_GREP.</td></tr><tr><td>900018</td><td>24 августа 2010</td><td>9.0-CURRENT после того, как сигнал, сгенерированный в
    <code class="function">pthread_kill(3)</code>, распознается в si_code
    как SI_LWP.  Ранее si_code содержал SI_USER.</td></tr><tr><td>900019</td><td>28 августа 2010</td><td>9.0-CURRENT после добавления в <code class="function">mmap(2)</code>
    флага MAP_PREFAULT_READ.</td></tr><tr><td>900020</td><td>9 сентября 2010</td><td>9.0-CURRENT после добавления в sbufs функциональности
    осушения, что также изменило раскладку в структуре sbuf.</td></tr><tr><td>900021</td><td>13 сентября 2010</td><td>9.0-CURRENT после добавления в DTrace поддержки трассировки
    пользовательских процессов.</td></tr><tr><td>900022</td><td>2 октября 2010</td><td>9.0-CURRENT после добавления BSDL утилит man и списания
    GNU/GPL утилит man.</td></tr><tr><td>900023</td><td>11 октября 2010</td><td>9.0-CURRENT после обновления xz до снапшота git
    20101010.</td></tr><tr><td>900024</td><td>11 ноября 2010</td><td>9.0-CURRENT после замены libgcc.a на
    libcompiler_rt.a.</td></tr><tr><td>900025</td><td>12 ноября 2010</td><td>9.0-CURRENT после появления модульного контроля
    перегрузки.</td></tr><tr><td>900026</td><td>30 ноября 2010</td><td>9.0-CURRENT после появления протокола для поддержки
    расширителей SAS (SMP, Serial Management Protocol) и блоков
    управления (CCB) CAM XPT_SMP_IO и XPT_GDEV_ADVINFO.</td></tr><tr><td>900027</td><td>5 декабря 2010</td><td>9.0-CURRENT после добавления log2 в libm.</td></tr><tr><td>900028</td><td>21 декабря 2010</td><td>9.0-CURRENT после добавления KPI Hhook (Helper Hook), Khelp
    (Kernel Helpers) и Object Specific Data (OSD).</td></tr><tr><td>900029</td><td>28 декабря 2010</td><td>9.0-CURRENT после изменения стека TCP для взаимодействия с
    модулями Khelp через вспомогательные точки связи и хранения
    данных уровня сетевого соединения в управляющем блоке TCP.</td></tr><tr><td>900030</td><td>12 января 2011</td><td>9.0-CURRENT после обновления libdialog до версии
    20100428.</td></tr><tr><td>900031</td><td>7 февраля 2011</td><td>9.0-CURRENT после добавления
    <code class="function">pthread_getthreadid_np(3)</code>.</td></tr><tr><td>900032</td><td>8 февраля 2011</td><td>9.0-CURRENT после удаления символа и прототипа
    uio_yield.</td></tr><tr><td>900033</td><td>18 февраля 2011</td><td>9.0-CURRENT после обновления binutils до версии
    2.17.50.</td></tr><tr><td>900034</td><td>8 марта 2011</td><td>9.0-CURRENT после изменений в struct sysvec
    (sv_schedtail).</td></tr><tr><td>900035</td><td>29 марта 2011</td><td>9.0-CURRENT после обновления базовых gcc и libstdc++ до
    последних ревизий, выполненных под лицензией GPLv2.</td></tr><tr><td>900036</td><td>18 апреля 2011</td><td>9.0-CURRENT после удаления libobjc и поддержки Objective-C
    из базовой системы.</td></tr><tr><td>900037</td><td>13 мая 2011</td><td>9.0-CURRENT после импорта библиотеки libprocstat(3) и
    утилиты fuser(1) в базовую систему.</td></tr><tr><td>900038</td><td>22 мая 2011</td><td>9.0-CURRENT после добавления флага с параметрами блокировки
    в VFS_FHTOVP(9).</td></tr><tr><td>900039</td><td>28 июня 2011</td><td>9.0-CURRENT после импорта pf из OpenBSD 4.5.</td></tr><tr><td>900040</td><td>19 июля 2011</td><td>Значение MAXCPU, используемое по умолчанию, увеличено до 64
    на amd64 и ia64, и до 128 для XLP (mips).</td></tr><tr><td>900041</td><td>13 августа 2011</td><td>9.0-CURRENT после реализации Capsicum capabilities; в
    fget(9) добавлен аргумент rights.</td></tr><tr><td>900042</td><td>28 августа 2011</td><td>Увеличен номер версии для динамических библиотек, ABI
    которых был изменен, в рамках подготовки к 9.0.</td></tr><tr><td>900043</td><td>2 сентября 2011</td><td>Добавлено автоматическое распознавание устройств USB mass
    storage, которые не поддерживают команду SCSI no synchronize
    cache.</td></tr><tr><td>900044</td><td>10 сентября 2011</td><td>Переработан механизм auto-quirk.  9.0-RELEASE</td></tr><tr><td>900045</td><td>2 января 2012</td><td>9.0-CURRENT после выполнения MFC true/false из
    1000002.</td></tr><tr><td>900500</td><td>2 января 2012</td><td>9.0-STABLE.</td></tr><tr><td>900501</td><td>6 января 2012</td><td>9.0-STABLE после обратного портирования системного вызова
    posix_fadvise(2).</td></tr><tr><td>900502</td><td>16 января 2012</td><td>9.0-STABLE после обратного портирования gperf 3.0.3.</td></tr><tr><td>900503</td><td>15 февраля 2012</td><td>9.0-STABLE после появления нового расширяемого интерфейса
    sysctl(3) NET_RT_IFLISTL для получения списка адресов (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/231768"><span class="svnref">231768</span></a>).</td></tr><tr><td>900504</td><td>3 марта 2012</td><td>9.0-STABLE после изменения механизма монтирования файловых
    систем в jail (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/232728"><span class="svnref">232728</span></a>).</td></tr><tr><td>900505</td><td>13 марта 2012</td><td>9.0-STABLE после появления новых параметров сокета tcp(4):
    TCP_KEEPINIT, TCP_KEEPIDLE, TCP_KEEPINTVL и TCP_KEEPCNT (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/232945"><span class="svnref">232945</span></a>).</td></tr><tr><td>900506</td><td>22 мая 2012</td><td>9.0-STABLE после появления функции
    <code class="function">quick_exit</code> и соответствующих изменений,
    требуемых в C++11 (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/235786"><span class="svnref">235786</span></a>).</td></tr><tr><td>901000</td><td>5 августа 2012</td><td>9.1-RELEASE.</td></tr><tr><td>901500</td><td>6 августа 2012</td><td>9.1-STABLE после отделения ветки releng/9.1
    (RELENG_9_1).</td></tr><tr><td>901501</td><td>11 ноября 2012</td><td>9.1-STABLE после добавления LIST_PREV() в queue.h (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/242893"><span class="svnref">242893</span></a>) и изменений в KPI последовательных
    устройств USB (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/240659"><span class="svnref">240659</span></a>).</td></tr><tr><td>901502</td><td>28 ноября 2012</td><td>9.1-STABLE после добавления джиттер-буфера в общий код
    последовательных устройств USB, что требует пересборки
    соответствующих модулей.</td></tr><tr><td>901503</td><td>21 февраля 2013</td><td>9.1-STABLE после изменений в структуре USB драйвера,
    требующих пересборки всех USB модулей.  Также служит индикатором
    наличия nmtree.</td></tr><tr><td>901504</td><td>15 марта 2013</td><td>9.1-STABLE после добавления в install параметров -l, -M, -N
    и других, после добавления в cat параметра -l.</td></tr><tr><td>901505</td><td>13 июня 2013</td><td>9.1-STABLE после исправлений в автонастройке ctfmerge (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/249243"><span class="svnref">249243</span></a>).</td></tr><tr><td>902001</td><td>3 августа 2013</td><td>Отделение ветки <code class="literal">releng/9.2</code> от
    <code class="literal">stable/9</code> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/253912"><span class="svnref">253912</span></a>).</td></tr><tr><td>902501</td><td>August 2, 2013</td><td>9.2-STABLE после создания ветки
    <code class="literal">releng/9.2</code> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/253913"><span class="svnref">253913</span></a>).</td></tr><tr><td>902502</td><td>26 августа 2013</td><td>9.2-STABLE после включения флага поиска пути CAM
    <code class="literal">PIM_RESCAN</code>
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254938"><span class="svnref">254938</span></a>).</td></tr><tr><td>902503</td><td>27 августа 2013</td><td>9.2-STABLE после включения флага cdev
    <code class="literal">SI_UNMAPPED</code>
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254979"><span class="svnref">254979</span></a>).</td></tr><tr><td>902504</td><td>22 октября 2013</td><td>9.2-STABLE после включения поддержки первой загрузки
    <span class="quote"><<<span class="quote">first boot</span>>></span> для сценариев <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a>
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/256917"><span class="svnref">256917</span></a>).</td></tr><tr><td>902505</td><td>December 12, 2013</td><td>9.2-STABLE after Heimdal encoding fix
    (rev <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/259448"><span class="svnref">259448</span></a>).</td></tr><tr><td>902506</td><td>31 декабря 2013</td><td>9-STABLE после исправлений для MAP_STACK
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/260082"><span class="svnref">260082</span></a>).</td></tr><tr><td>1000000</td><td>26 сентября 2011</td><td>10.0-CURRENT.</td></tr><tr><td>1000001</td><td>4 ноября 2011</td><td>10-CURRENT после добавления системного вызова
    posix_fadvise(2).</td></tr><tr><td>1000002</td><td>12 декабря 2011</td><td>10-CURRENT после определения булевых true/false в
    sys/types.h, значение sizeof(bool) могло измениться (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/228444"><span class="svnref">228444</span></a>).  10-CURRENT после появления
    xlocale.h (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/r227753"><span class="svnref">r227753</span></a>).</td></tr><tr><td>1000003</td><td>15 декабря 2011</td><td>10-CURRENT после крупных изменений в carp(4), изменения
    размера структур in_aliasreq, in6_aliasreq (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/228571"><span class="svnref">228571</span></a>) и более строгих проверок параметров
    SIOCAIFADDR (рев <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/228574"><span class="svnref">228574</span></a>).</td></tr><tr><td>1000004</td><td>1 января 2012</td><td>10-CURRENT после удаления skpc(9) и добавления memcchr(9)
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/229200"><span class="svnref">229200</span></a>).</td></tr><tr><td>1000005</td><td>16 января 2012</td><td>10-CURRENT после удаления поддержки ioctl SIOCSIFADDR,
    SIOCSIFNETMASK, SIOCSIFBRDADDR, SIOCSIFDSTADDR (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/230207"><span class="svnref">230207</span></a>).</td></tr><tr><td>1000006</td><td>26 января 2012</td><td>10-CURRENT после появления асинхронных уведомлений о наличии
    входных данных в уровне cam(4) (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/230590"><span class="svnref">230590</span></a>).</td></tr><tr><td>1000007</td><td>5 февраля 2012</td><td>10-CURRENT после появления новых параметров сокета tcp(4):
    TCP_KEEPINIT, TCP_KEEPIDLE, TCP_KEEPINTVL и TCP_KEEPCNT (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/231025"><span class="svnref">231025</span></a>).</td></tr><tr><td>1000008</td><td>11 февраля 2012</td><td>10-CURRENT после появления нового расширяемого интерфейса
    sysctl(3) NET_RT_IFLISTL для получения списка адресов (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/231505"><span class="svnref">231505</span></a>).</td></tr><tr><td>1000009</td><td>25 февраля 2012</td><td>10-CURRENT после импорта libarchive 3.0.3 (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/232153"><span class="svnref">232153</span></a>).</td></tr><tr><td>1000010</td><td>31 марта 2012</td><td>10-CURRENT после исправлений в xlocale (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/233757"><span class="svnref">233757</span></a>).</td></tr><tr><td>1000011</td><td>16 апреля 2012</td><td>10-CURRENT после импорта LLVM/Clang 3.1 trunk r154661 (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/234353"><span class="svnref">234353</span></a>).</td></tr><tr><td>1000012</td><td>2 мая 2012</td><td>10-CURRENT после импорта jemalloc (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/234924"><span class="svnref">234924</span></a>).</td></tr><tr><td>1000013</td><td>22 мая 2012</td><td>10-CURRENT после импорта byacc (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/235788"><span class="svnref">235788</span></a>).</td></tr><tr><td>1000014</td><td>27 июня 2012</td><td>10-CURRENT после изменения sort по умолчанию на BSD sort
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/237629"><span class="svnref">237629</span></a>).</td></tr><tr><td>1000015</td><td>12 июля 2012</td><td>10-CURRENT после импорта OpenSSL 1.0.1c (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/238405"><span class="svnref">238405</span></a>).</td></tr><tr><td>(не изменено)</td><td>13 июля 2012</td><td>10-CURRENT после исправления регрессии в LLVM/Clang 3.1
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/238429"><span class="svnref">238429</span></a>).</td></tr><tr><td>1000016</td><td>8 августа 2012</td><td>10-CURRENT после изменения KBI в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ucom&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ucom</span>(4)</span></a> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/239179"><span class="svnref">239179</span></a>).</td></tr><tr><td>1000017</td><td>8 августа 2012</td><td>10-CURRENT после добавления функциональности streams в
    USB-стек (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/239214"><span class="svnref">239214</span></a>).</td></tr><tr><td>1000018</td><td>8 сентября 2012</td><td>10-CURRENT после значитального переписывания <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pf&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pf</span>(4)</span></a>
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/240233"><span class="svnref">240233</span></a>).</td></tr><tr><td>1000019</td><td>6 октября 2012</td><td>10-CURRENT после изменений KPI/KBI в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfil&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">pfil</span>(9)</span></a> для
    передачи пакетов в сетевом порядке байтов в фильтр-ловушки
    AF_INET (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/241245"><span class="svnref">241245</span></a>).</td></tr><tr><td>1000020</td><td>16 октября 2012</td><td>10-CURRENT после изменения KPI клонирования сетевых
    интерфейсов; структура if_clone становится непрозрачной (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/241610"><span class="svnref">241610</span></a>).</td></tr><tr><td>1000021</td><td>22 октября 2012</td><td>10-CURRENT после удаления поддержки файловых систем, не
    являющихся MPSAFE, и добавления поддержки FUSEFS (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/241519"><span class="svnref">241519</span></a>,
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/241897"><span class="svnref">241897</span></a>).</td></tr><tr><td>1000022</td><td>22 октября 2012</td><td>10-CURRENT после переключения всего стека IPv4 на хранение
    заголовков IP-пакетов в сетевом порядке байтов (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/241913"><span class="svnref">241913</span></a>).</td></tr><tr><td>1000023</td><td>5 ноября 2012</td><td>10-CURRENT после добавления джиттер-буфера в общий код
    драйверов последовательных устройств USB для временного хранения
    символов при заполнении буфера TTY.  Добавлены сигналы
    старт-стопной синхронизации при возникновении этой ситуации (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/242619"><span class="svnref">242619</span></a>).</td></tr><tr><td>1000024</td><td>5 ноября 2012</td><td>10-CURRENT после переключения компилятора по умолчанию на
    clang на платформах i386 и amd64 (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/242624"><span class="svnref">242624</span></a>).</td></tr><tr><td>1000025</td><td>17 ноября 2012</td><td>10-CURRENT после того как значение переменной sin6_scope_id
    в структуре sockaddr_in6 стало заполняться средствами ядра перед
    отправкой структуры в пользовательский режим посредством sysctl
    или сокета маршрутизации.  Это означает, что специфичный для KAME
    embedded scope id в sin6_addr.s6_addr[2] в пользовательском
    приложении всегда очищается (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/243443"><span class="svnref">243443</span></a>).</td></tr><tr><td>1000026</td><td>11 января 2013</td><td>10-CURRENT после добавления в install параметра -N (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/245313"><span class="svnref">245313</span></a>).  Также служит индикатором наличия
    nmtree.</td></tr><tr><td>1000027</td><td>29 января 2013</td><td>10-CURRENT после добавления в cat параметра -l (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/246083"><span class="svnref">246083</span></a>).</td></tr><tr><td>1000028</td><td>13 февраля 2013</td><td>10-CURRENT после изменений в структуре USB драйвера,
    требующих пересборки всех USB модулей (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/246759"><span class="svnref">246759</span></a>).</td></tr><tr><td>1000029</td><td>4 марта 2013</td><td>10-CURRENT после появления механизма tickless callout, что
    также внесло изменения в struct callout (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/247777"><span class="svnref">247777</span></a>).</td></tr><tr><td>1000030</td><td>12 марта 2013</td><td>10-CURRENT после изменения KPI в подсистеме виртуальной
    памяти для поддержки блокировок чтения/записи (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/248084"><span class="svnref">248084</span></a>).</td></tr><tr><td>1000031</td><td>26 апреля 2013</td><td>10-CURRENT после получения параметром dst квалификатора
    const в методе ifnet <code class="function">if_output</code> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/249925"><span class="svnref">249925</span></a>).</td></tr><tr><td>1000032</td><td>1 мая 2013</td><td>10-CURRENT после появления системных вызовов
    <code class="function">accept4</code> (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/250154"><span class="svnref">250154</span></a>)
    и <code class="function">pipe2</code> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/250159"><span class="svnref">250159</span></a>).</td></tr><tr><td>1000033</td><td>21 мая 2013</td><td>10-CURRENT после импорта flex 2.5.37 (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/250881"><span class="svnref">250881</span></a>).</td></tr><tr><td>1000034</td><td>3 июня 2013</td><td>10-CURRENT после добавления в libm следующих функций:
    <code class="function">cacos</code>, <code class="function">cacosf</code>,
    <code class="function">cacosh</code>, <code class="function">cacoshf</code>,
    <code class="function">casin</code>, <code class="function">casinf</code>,
    <code class="function">casinh</code>, <code class="function">casinhf</code>,
    <code class="function">catan</code>, <code class="function">catanf</code>,
    <code class="function">catanh</code>, <code class="function">catanhf</code>,
    <code class="function">logl</code>, <code class="function">log2l</code>,
    <code class="function">log10l</code>, <code class="function">log1pl</code>,
    <code class="function">expm1l</code> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/251294"><span class="svnref">251294</span></a>).</td></tr><tr><td>1000035</td><td>8 июня 2013</td><td>10-CURRENT после появления системного вызова
    <code class="function">aio_mlock</code> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/251526"><span class="svnref">251526</span></a>).</td></tr><tr><td>1000036</td><td>9 июля 2013</td><td>10-CURRENT после добавления новой функции в программный
    интерфейс модуля ядра GSSAPI (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/253049"><span class="svnref">253049</span></a>).</td></tr><tr><td>1000037</td><td>9 июля 2013</td><td>10-CURRENT после перевода структур для хранения статистики
    на PCPU счётчики.  Изменения в структурах
    <code class="literal">ahstat</code>, <code class="literal">arpstat</code>,
    <code class="literal">espstat</code>, <code class="literal">icmp6_ifstat</code>,
    <code class="literal">icmp6stat</code>, <code class="literal">in6_ifstat</code>,
    <code class="literal">ip6stat</code>, <code class="literal">ipcompstat</code>,
    <code class="literal">ipipstat</code>, <code class="literal">ipsecstat</code>,
    <code class="literal">mrt6stat</code>, <code class="literal">mrtstat</code>,
    <code class="literal">pfkeystat</code>, <code class="literal">pim6stat</code>,
    <code class="literal">pimstat</code>, <code class="literal">rip6stat</code>,
    <code class="literal">udpstat</code> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/253081"><span class="svnref">253081</span></a>).</td></tr><tr><td>1000038</td><td>16 июля 2013</td><td>10-CURRENT после переключения ABI, используемого по
    умолчанию, на <code class="literal">ARM EABI</code> для архитектур arm,
    armeb, armv6, and armv6eb (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/253396"><span class="svnref">253396</span></a>).</td></tr><tr><td>1000039</td><td>22 июля 2013</td><td>10-CURRENT после изменений в драйверах
    <code class="literal">CAM</code> и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mps&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">mps</span>(4)</span></a> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/253549"><span class="svnref">253549</span></a>).</td></tr><tr><td>1000040</td><td>24 июля 2013</td><td>10-CURRENT после добавления файлов pkgconf в libusb (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/253638"><span class="svnref">253638</span></a>).</td></tr><tr><td>1000041</td><td>5 августа 2013</td><td>10-CURRENT после замены <code class="function">time_second</code> на
    <code class="function">time_uptime</code> для <code class="literal">PF_INET6</code>
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/253970"><span class="svnref">253970</span></a>).</td></tr><tr><td>1000042</td><td>9 августа 2013</td><td>10-CURRENT после изменения в подсистеме виртуальной памяти
    для унификации механизмов мягкого и жёсткого захвата (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254138"><span class="svnref">254138</span></a>).</td></tr><tr><td>1000043</td><td>13 августа 2013</td><td>10-CURRENT после включения <code class="varname">WITH_ICONV</code> по
    умолчанию.  Новый параметр в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=src.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">src.conf</span>(5)</span></a>
    <code class="varname">WITH_LIBICONV_COMPAT</code> (по умолчанию выключен)
    добавляет <code class="function">libiconv_open</code> для обеспечения
    совместимости с портом <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/libiconv/pkg-descr">libiconv</a> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254273"><span class="svnref">254273</span></a>).</td></tr><tr><td>1000044</td><td>15 августа 2013</td><td>10-CURRENT после перевода <code class="literal">libc.so</code> на
    использование сценария <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ld&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ld</span>(1)</span></a> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/251668"><span class="svnref">251668</span></a>,
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254358"><span class="svnref">254358</span></a>).</td></tr><tr><td>1000045</td><td>15 августа 2013</td><td>10-CURRENT после изменения в программном интерфейсе devfs
    для замены флага cdevsw <code class="literal">D_UNMAPPED_IO</code> на флаг
    структуры cdev <code class="literal">SI_UNMAPPED</code> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254389"><span class="svnref">254389</span></a>).</td></tr><tr><td>1000046</td><td>19 августа 2013</td><td>10-CURRENT после добавления флагов mbuf
    <code class="literal">M_PROTO[9-12]</code> и удаления флагов
    <code class="literal">M_FRAG|M_FIRSTFRAG|M_LASTFRAG</code> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254524"><span class="svnref">254524</span></a>,
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254526"><span class="svnref">254526</span></a>).</td></tr><tr><td>1000047</td><td>21 августа 2013</td><td>10-CURRENT после обновления <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stat&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">stat</span>(2)</span></a>, позволяюшего
    сохранять некоторые файловые атрибуты Windows/DOS и CIFS в
    качестве флагов <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stat&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">stat</span>(2)</span></a> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254627"><span class="svnref">254627</span></a>).</td></tr><tr><td>1000048</td><td>22 августа 2013</td><td>10-CURRENT после изменения структуры
    <code class="literal">xsctp_inpcb</code> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254672"><span class="svnref">254672</span></a>).</td></tr><tr><td>1000049</td><td>24 августа 2013</td><td>10-CURRENT после появления поддержки <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=physio&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">physio</span>(9)</span></a> для
    устройств, таких как <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sa&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sa</span>(4)</span></a>, которые не функционируют
    корректно с разделением ввода/вывода (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254760"><span class="svnref">254760</span></a>).</td></tr><tr><td>1000050</td><td>24 августа 2013</td><td>10-CURRENT после изменения структуры <code class="literal">mbuf</code>
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254780"><span class="svnref">254780</span></a>,
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254799"><span class="svnref">254799</span></a>, <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254804"><span class="svnref">254804</span></a>,
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254807"><span class="svnref">254807</span></a>,
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254842"><span class="svnref">254842</span></a>).</td></tr><tr><td>1000051</td><td>25 августа 2013</td><td>10-CURRENT после импорта драйвера Radeon KMS (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254885"><span class="svnref">254885</span></a>,
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/254887"><span class="svnref">254887</span></a>).</td></tr><tr><td>1000052</td><td>3 сентября 2013</td><td>10-CURRENT после подключения к сборке библиотеки
    <code class="literal">libexecinfo</code>, импортированной из NetBSD (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/255180"><span class="svnref">255180</span></a>).</td></tr><tr><td>1000053</td><td>6 сентября 2013</td><td>10-CURRENT после изменений в API и ABI инструментария
    Capsicum (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/255305"><span class="svnref">255305</span></a>).</td></tr><tr><td>1000054</td><td>6 сентября 2013</td><td>10-CURRENT после исключения <code class="literal">gcc</code> и
    <code class="literal">libstdc++</code> из сборки по умолчанию (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/255321"><span class="svnref">255321</span></a>).</td></tr><tr><td>1000055</td><td>6 сентября 2013</td><td>10-CURRENT после добавления флага
    <code class="literal">MMAP_32BIT</code> в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mmap&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">mmap</span>(2)</span></a> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/255426"><span class="svnref">255426</span></a>).</td></tr><tr><td>1000100</td><td>7 декабря 2013</td><td><code class="literal">releng/10.0</code> после отделения ветки от
    <code class="literal">stable/10</code>
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/259065"><span class="svnref">259065</span></a>).</td></tr><tr><td>1000500</td><td>10 октября 2013</td><td>10-STABLE после отделения ветки от <code class="literal">head/</code>
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/256283"><span class="svnref">256283</span></a>).</td></tr><tr><td>1000501</td><td>22 октября 2013</td><td>10-STABLE после добавления поддержки первой загрузки в
    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a> (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/256916"><span class="svnref">256916</span></a>).</td></tr><tr><td>1000502</td><td>20 ноября 2013</td><td>10-STABLE после удаления символов iconv из
    <code class="literal">libc.so.7</code>
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/258398"><span class="svnref">258398</span></a>).</td></tr><tr><td>1000510</td><td>7 декабря 2013</td><td>Обновлено значение __FreeBSD_version для
    <code class="literal">releng/10.0</code>, для того чтобы оно не
    уменьшалось (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/259067"><span class="svnref">259067</span></a>).</td></tr><tr><td>1000700</td><td>7 декабря 2013</td><td>10-STABLE после отделения ветки
    <code class="literal">releng/10.0</code> (рев.
    <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/259069"><span class="svnref">259069</span></a>).</td></tr><tr><td>1000701</td><td>15 декабря 2013</td><td>10.0-STABLE после исправления кодировки Heimdal
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/259447"><span class="svnref">259447</span></a>).</td></tr><tr><td>1000702</td><td>31 декабря 2013</td><td>10-STABLE после исправлений для MAP_STACK
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/260135"><span class="svnref">260135</span></a>).</td></tr><tr><td>1100000</td><td>10 октября 2013</td><td>11.0-CURRENT (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/256284"><span class="svnref">256284</span></a>).</td></tr><tr><td>1100001</td><td>19 октября 2013</td><td>11.0-CURRENT после добавления поддержки "первой загрузки"
    в сценарии <code class="filename">rc.d</code> для использования в
    портах (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/256776"><span class="svnref">256776</span></a>).</td></tr><tr><td>1100002</td><td>5 ноября 2013</td><td>11.0-CURRENT после удаления поддержки исторических ioctl
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/257696"><span class="svnref">257696</span></a>).</td></tr><tr><td>1100003</td><td>17 ноября 2013</td><td>11.0-CURRENT после изменений в iconv
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/258284"><span class="svnref">258284</span></a>).</td></tr><tr><td>1100004</td><td>15 декабря 2013</td><td>11.0-CURRENT после изменения в поведении
    <code class="function">gss_pseudo_random</code>, добавленного в r259286
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/259424"><span class="svnref">259424</span></a>).</td></tr><tr><td>1100005</td><td>28 декабря 2013</td><td>11.0-CURRENT после r259951 - Не объединять записи в
    <code class="function">vm_map_stack()</code>
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/260010"><span class="svnref">260010</span></a>).</td></tr><tr><td>1100006</td><td>28 января 2014</td><td>11.0-CURRENT после обновления libelf и libdwarf
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/261246"><span class="svnref">261246</span></a>).</td></tr><tr><td>1100007</td><td>30 января 2014</td><td>11.0-CURRENT после обновления libc++ до версии to 3.4
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/261283"><span class="svnref">261283</span></a>).</td></tr><tr><td>1100008</td><td>14 февраля 2014</td><td>11.0-CURRENT после исправления совместимости ABI в libc++ 3.4
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/261801"><span class="svnref">261801</span></a>).</td></tr><tr><td>1100009</td><td>16 февраля 2014</td><td>11.0-CURRENT после обновления llvm/clang до версии 3.4
    (рев. <a xmlns="" href="https://svnweb.freebsd.org/changeset/base/261991"><span class="svnref">261991</span></a>).</td></tr></tbody></table></div></div><br class="table-break" /><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Заметьте, что 2.2-STABLE иногда идентифицирует себя как
	<span class="quote"><<<span class="quote">2.2.5-STABLE</span>>></span> после 2.2.5-RELEASE.  Такой
	принцип использовался год и месяц, но мы решили изменить его
	на более однозначную систему нумерации старший/младший,
	начиная с версии 2.2.  Это объясняется тем, что параллельная
	разработка в нескольких ветках делает непрактичным
	идентификацию релизов просто по их реальным датам выпуска.
	Если вы сейчас делаете порт, вам не стоит заботиться о старых
	версиях -CURRENT; они перечислены здесь просто в
	информационных целях.</p></div></div></div></div></body></html>