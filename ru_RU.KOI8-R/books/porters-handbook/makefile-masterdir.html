<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>5.9. MASTERDIR</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD по созданию портов" /><link rel="up" href="makefiles.html" title="Глава 5. Настройка файла Makefile" /><link rel="prev" href="makefile-depend.html" title="5.8. Зависимости" /><link rel="next" href="makefile-manpages.html" title="5.10. Страницы Справочника" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.9. <code class="varname">MASTERDIR</code></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="makefile-depend.html">Пред.</a> </td><th width="60%" align="center">Глава 5. Настройка файла Makefile</th><td width="20%" align="right"> <a accesskey="n" href="makefile-manpages.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-masterdir"></a>5.9. <code class="varname">MASTERDIR</code></h2></div></div></div><p>Если вашему порту требуется построение довольно
      различающихся версий пакетов через переменную (задающую,
      например, разрешение, или размер бумаги), которая принимает
      различные значения, создайте для каждого пакета отдельный
      подкаталог, чтобы пользователям было легче определить, каким
      пакетом воспользоваться, но попробуйте использовать совместно
      между портами как можно больше файлов.  В типичном случае вам
      потребуются только очень короткие файлы
      <code class="filename">Makefile</code> во всех каталогах, кроме одного,
      если вы будете использовать переменные с умом.  В отдельных
      файлах <code class="filename">Makefile</code> вы можете использовать
      переменную <code class="varname">MASTERDIR</code> для указания каталога,
      в котором находятся все остальные файлы.  Также используйте
      переменную как часть <a class="link" href="makefile-naming.html#porting-pkgname" title="5.2.4. Соглашения по именованию пакетов"><code class="varname">PKGNAMESUFFIX</code></a>,
      чтобы пакеты имели разные имена.</p><p>Продемонстрируем это на примере.  Вот часть файла
      <code class="filename">japanese/xdvi300/Makefile</code>:</p><pre class="programlisting">PORTNAME=	xdvi
PORTVERSION=	17
PKGNAMEPREFIX=	ja-
PKGNAMESUFFIX=	${RESOLUTION}
 :
# default
RESOLUTION?=	300
.if ${RESOLUTION} != 118 &amp;&amp; ${RESOLUTION} != 240 &amp;&amp; \
	${RESOLUTION} != 300 &amp;&amp; ${RESOLUTION} != 400
	@${ECHO_MSG} "Error: invalid value for RESOLUTION: \"${RESOLUTION}\""
	@${ECHO_MSG} "Possible values are: 118, 240, 300 (default) and 400."
	@${FALSE}
.endif</pre><p>Порт <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/japanese/xdvi300/pkg-descr">japanese/xdvi300</a>
      содержит также все обычные патчи, файлы для пакета и так далее.
      Если вы введете здесь команду <code class="command">make</code>, она
      возьмет в качестве разрешения значение по умолчанию (300) и
      построит порт обычным образом.</p><p>Для другого разрешения приведем <span class="emphasis"><em>полный</em></span>
      <code class="filename">xdvi118/Makefile</code>:</p><pre class="programlisting">RESOLUTION=	118
MASTERDIR=	${.CURDIR}/../xdvi300

.include "${MASTERDIR}/Makefile"</pre><p>(<code class="filename">xdvi240/Makefile</code> и
      <code class="filename">xdvi400/Makefile</code> похожи).  Задание
      <code class="varname">MASTERDIR</code> говорит
      <code class="filename">bsd.port.mk</code>, что обычный набор
      подкаталогов типа <code class="varname">FILESDIR</code> и
      <code class="varname">SCRIPTDIR</code> находится в каталоге
      <code class="filename">xdvi300</code>.  Строчка
      <code class="literal">RESOLUTION=118</code> переопределят строку
      <code class="literal">RESOLUTION=300</code> в файле
      <code class="filename">xdvi300/Makefile</code> и порт будет построен с
      разрешением 118.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="makefile-depend.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="makefiles.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="makefile-manpages.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">5.8. Зависимости </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 5.10. Страницы Справочника</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>