<?xml version="1.0" encoding="koi8-r"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>Шрифты и FreeBSD</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><meta name="description" content="Этот документ содержит описание различных файлов шрифтов, которые могут использоваться с FreeBSD и драйвером системной консоли, системой X11, программами Ghostscript и Groff. Даются реально работающие примеры по переключению экрана системной консоли в режим 80x60 и использованию файлов шрифтов формата Type 1 с перечисленными выше прикладными программами." /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div xml:lang="ru" class="article" lang="ru"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp69999312"></a>Шрифты и FreeBSD</h1></div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="subtitle"><em>Пособие</em></h3></div><div><div xmlns="http://www.w3.org/1999/xhtml" class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Dave</span> <span class="surname">Bodenstab</span></h3><div class="affiliation"><div class="address"><p><br />
	    <code class="email">&lt;<a xmlns="" class="email" href="mailto:imdave@synet.net">imdave@synet.net</a>&gt;</code><br />
	  </p></div></div></div></div></div><div>Издание: <a href="https://svnweb.freebsd.org/changeset/doc/"><span class="svnref"></span></a></div><div><div xmlns="http://www.w3.org/1999/xhtml" class="legalnotice"><a id="trademarks"></a><p>FreeBSD это зарегистрированная торговая
  марка FreeBSD Foundation.</p><p>Adobe, Acrobat, Acrobat Reader и
  PostScript это или зарегистрированные торговые марки или торговые марки Adobe
  Systems Incorporated в Соединенных Штатах и/или других
  странах.</p><p>Apple, AirPort, FireWire, Mac, Macintosh, Mac OS,
  Quicktime и TrueType это торговые марки Apple Computer, Inc.,
  зарегистрированные в Соединенных Штатах и других странах.</p><p>Linux это зарегистрированная торговая марка
  Linus Torvalds.</p><p>Microsoft, FrontPage, IntelliMouse, MS-DOS,
  Outlook, Windows, Windows Media и Windows NT это или зарегистрированные
  торговые марки или торговые марки Microsoft Corporation в Соединенных
  Штатах и/или других странах.</p><p>Motif, OSF/1 и UNIX это
  зарегистрированные торговые марки, а IT DialTone и The Open Group это
  торговые марки Open Group в Соединенных Штатах и других
  странах.</p><p>Многие из обозначений, используемые
  производителями и продавцами для обозначения своих продуктов, заявляются
  в качестве торговых марок.  Когда такие обозначения появляются в этом
  документе, и Проекту FreeBSD известно о торговой марке, к обозначению
  добавляется знак <span class="quote"><<<span class="quote">TM</span>>></span> или
  <span class="quote"><<<span class="quote">(R)</span>>></span>.</p></div></div><div>  7 августа 1996  .</div><div><div xmlns="http://www.w3.org/1999/xhtml" class="abstract"><div class="abstract-title">Аннотация</div><p>Этот документ содержит описание различных файлов шрифтов, которые
        могут использоваться с FreeBSD и драйвером системной консоли, системой
        <span class="application">X11</span>, программами <span class="application">Ghostscript</span>
	и <span class="application">Groff</span>.  Даются реально работающие
        примеры по переключению экрана системной консоли в режим 80x60 и
        использованию файлов шрифтов формата Type 1 с перечисленными выше
        прикладными программами.</p></div></div></div><hr /></div><div class="toc"><div class="toc-title">Содержание</div><dl class="toc"><dt><span class="sect1"><a href="#intro">1. Введение</a></span></dt><dt><span class="sect1"><a href="#terminology">2. Основные термины</a></span></dt><dt><span class="sect1"><a href="#font-formats">3. Какие форматы файлов шрифтов я могу использовать?</a></span></dt><dt><span class="sect1"><a href="#virtual-console">4. Настройка виртуальной консоли на режим работы 80x60</a></span></dt><dt><span class="sect1"><a href="#type1-fonts-x11">5. Использование шрифтов type 1 с системой <span class="application">X11</span></a></span></dt><dt><span class="sect1"><a href="#type1-fonts-ghostscript">6. Использование шрифтов type 1 с пакетом Ghostscript</a></span></dt><dt><span class="sect1"><a href="#type1-fonts-groff">7. Использование шрифтов в формате type 1 с программой Groff</a></span></dt><dt><span class="sect1"><a href="#convert-truetype">8. Преобразование файлов шрифтов TrueType в формат groff/PostScript для
      использования с groff</a></span></dt><dt><span class="sect1"><a href="#truetype-for-other-programs">9. Можно ли использовать шрифты в формате TrueType с другими
      программами?</a></span></dt><dt><span class="sect1"><a href="#obtaining-additional-fonts">10. Где можно найти дополнительные шрифты?</a></span></dt><dt><span class="sect1"><a href="#additional-questions">11. Дополнительные вопросы</a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="intro"></a>1. Введение</h2></div></div></div><p>Существует много мест, где можно найти файлы шрифтов, но встает
      вопрос о возможных способах их использования с FreeBSD.  Ответ может быть
      найден в результате тщательного изучения документации по тем компонентам,
      которые вы собираетесь использовать.  На это тратится очень много
      времени, и это пособие является попыткой дать готовые ответы для тех, кто
      заинтересуется такими вопросами.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="terminology"></a>2. Основные термины</h2></div></div></div><p>Имеется множество различных форматов файлов шрифтов и соответствующих
      окончаний имен файлов.  Здесь обсуждаются лишь следующие из них:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="filename">.pfa</code>, <code class="filename">.pfb</code></span></dt><dd><p>Файлы шрифтов <span class="trademark">PostScript</span>(R) type 1.  Файлы
	    <code class="filename">.pfa</code> являются текстовым (
	    <span class="emphasis"><em>A</em></span>scii) представлением, а
	    <code class="filename">.pfb</code> - двоичным
            (<span class="emphasis"><em>B</em></span>inary).</p></dd><dt><span class="term"><code class="filename">.afm</code></span></dt><dd><p>Параметры (метрики) соответствующих шрифтов типа type 1.</p></dd><dt><span class="term"><code class="filename">.pfm</code></span></dt><dd><p>Метрики для принтеров соответствующих шрифтов типа type
            1.</p></dd><dt><span class="term"><code class="filename">.ttf</code></span></dt><dd><p>Файл шрифтов <span class="trademark">TrueType</span>(R)</p></dd><dt><span class="term"><code class="filename">.fot</code></span></dt><dd><p>Неявная ссылка на файл шрифтов TrueType (реальной информации о
            шрифте здесь не содержится)</p></dd><dt><span class="term"><code class="filename">.fon</code>, <code class="filename">.fnt</code></span></dt><dd><p>Файлы экранных шрифтов с побитным представлением</p></dd></dl></div><p>Файлы <code class="filename">.fot</code> используются в <span class="trademark">Windows</span>(R) в качестве
      некой символической ссылки на файл со шрифтом в формате <span class="trademark">TrueType</span>(R)
      (<code class="filename">.ttf</code>).  Файлы шрифтов <code class="filename">.fon</code>
      также используются в <span class="trademark">Windows</span>(R).  Мне неизвестно, как можно использовать
      этот формат шрифтов во FreeBSD.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="font-formats"></a>3. Какие форматы файлов шрифтов я могу использовать?</h2></div></div></div><p>То, файл шрифтов какого формата будет полезен, зависит от
      используемого приложения.  Сама по себе FreeBSD шрифтов не использует.
      Прикладные программы и/или драйверы могут использовать файлы шрифтов.
      Вот краткий справочник по типам файлов шрифтов и
      приложениям/драйверам:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Драйвер</span></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">vt</span></dt><dd><p><code class="filename">.hex</code></p></dd><dt><span class="term">syscons</span></dt><dd><p><code class="filename">.fnt</code></p></dd></dl></div></dd><dt><span class="term">Приложение</span></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="application">Ghostscript</span></span></dt><dd><p><code class="filename">.pfa</code>,
		  <code class="filename">.pfb</code>,
		  <code class="filename">.ttf</code></p></dd><dt><span class="term"><span class="application">X11</span></span></dt><dd><p><code class="filename">.pfa</code>,
		  <code class="filename">.pfb</code></p></dd><dt><span class="term"><span class="application">Groff</span></span></dt><dd><p><code class="filename">.pfa</code>,
		  <code class="filename">.afm</code></p></dd><dt><span class="term"><span class="application">Povray</span></span></dt><dd><p><code class="filename">.ttf</code></p></dd></dl></div></dd></dl></div><p>Окончание <code class="filename">.fnt</code> используется достаточно часто.  Я
      полагаю, что когда кто-нибудь собирается создать файл шрифтов для своего
      приложения, чаще всего выбирается именно это окончание.  Поэтому файлы с
      таким окончанием не все имеют одинаковый формат; в частности, формат
      файлов <code class="filename">.fnt</code>, используемых драйвером syscons во
      FreeBSD, может отличаться от формата файлов <code class="filename">.fnt</code>,
      встречающихся в <span class="trademark">MS-DOS</span>(R)/<span class="trademark">Windows</span>(R).  Я даже не пытался использовать другие
      файлы <code class="filename">.fnt</code>, кроме тех, что поставляются с
      FreeBSD.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="virtual-console"></a>4. Настройка виртуальной консоли на режим работы 80x60</h2></div></div></div><p>Во-первых, должен быть загружен шрифт размера 8x8.  Для этого файл
      <code class="filename">/etc/rc.conf</code> должен содержать строчку (измените в
      ней имя файла со шрифтом на соответствующий вашей локализации):</p><div class="informalexample"><pre class="programlisting">font8x8="iso-8x8"		# font 8x8 from /usr/share/syscons/fonts/* (or NO).</pre></div><p>Команда для переключения режимов называется <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vidcontrol&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">vidcontrol</span>(1)</span></a>:</p><div class="informalexample"><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>vidcontrol VGA_80x60</code></strong></pre></div><p>Различные программы, ориентированные на работу с экраном, такие, как
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vi&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">vi</span>(1)</span></a>, должны уметь определять текущие размеры экрана.  Так как это
      делается через вызовы <code class="command">ioctl</code> к драйверу консоли
      (такому, как <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syscons&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">syscons</span>(4)</span></a>), то размеры будут определяться
      правильно.</p><p>Чтобы это проходило более гладко, можно включить эти команды в
      скрипты начальной загрузки, чтобы они выполнялись при запуске системы.
      Чтобы это сделать, добавьте такую строчку в
      <code class="filename">/etc/rc.conf</code></p><div class="informalexample"><pre class="programlisting">
        allscreens_flags="VGA_80x60"	# Set this vidcontrol mode for all virtual screens
      </pre></div><p>Справочная информация: <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vidcontrol&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">vidcontrol</span>(1)</span></a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="type1-fonts-x11"></a>5. Использование шрифтов type 1 с системой <span class="application">X11</span></h2></div></div></div><p><span class="application">X11</span> может использовать файлы шрифтов в формате
      <code class="filename">.pfa</code> или <code class="filename">.pfb</code>.  Шрифты для <span class="application">X11</span>
      располагаются в различных подкаталогах в
      <code class="filename">/usr/X11R6/lib/X11/fonts</code>.  На каждый файл со шрифтом
      имеется ссылка по его <span class="application">X11</span>-имени в файле <code class="filename">fonts.dir</code> в
      каждом таком каталоге.</p><p>Существует каталог по имени <code class="filename">Type1</code>.  Самым
      простым способом добавить новый шрифт заключается в помещении его в этот
      каталог.  Но лучше хранить все новые шрифты в отдельном каталоге и
      использовать символические ссылки для добавляемых шрифтов.  Это позволяет
      легко управлять отдельными добавляемыми шрифтами, не путая их с
      изначально поставляемыми.  Например:</p><div class="informalexample"><pre class="screen">
<em class="lineannotation"><span class="lineannotation">Создаем каталог для файлов шрифтов</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>mkdir -p /usr/local/share/fonts/type1</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>cd /usr/local/share/fonts/type1</code></strong>

<em class="lineannotation"><span class="lineannotation">Помещаем сюда файлы .pfa, .pfb и .afm</span></em>
<em class="lineannotation"><span class="lineannotation">Кому-то может потребоваться хранить здесь также</span></em>
<em class="lineannotation"><span class="lineannotation">сопроводительные файлы и документацию к шрифтам</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>cp /cdrom/fonts/atm/showboat/showboat.pfb .</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>cp /cdrom/fonts/atm/showboat/showboat.afm .</code></strong>

<em class="lineannotation"><span class="lineannotation">Обновление индексного файла со ссылками на файлы шрифтов</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>echo showboat - InfoMagic CICA, Dec 1994, /fonts/atm/showboat &gt;&gt;INDEX</code></strong></pre></div><p>Теперь, чтобы использовать новый шрифт с <span class="application">X11</span>, нужно дать доступ к
      файлу шрифтов и обновить файлы и именами шрифтов.  Имена шрифтов в <span class="application">X11</span>
      выглядят следующим образом:</p><div class="informalexample"><pre class="screen">
-bitstream-charter-medium-r-normal-xxx-0-0-0-0-p-0-iso8859-1
     |        |      |    |   |     |  | | | | | |    \    \
     |        |      |    |   |     \  \ \ \ \ \ \     +----+- набор символов
     |        |      |    |   \      \  \ \ \ \ \ +- средняя ширина
     |        |      |    |    \      \  \ \ \ \ +- spacing
     |        |      |    \	\      \  \ \ \ +- разрешение по вертикали
     |        |      |     \	 \	\  \ \ +- разрешение по горизонтали
     |        |      |      \	  \	 \  \ +- пунктов
     |        |      |       \     \	  \  +- пиксел
     |        |      |        \     \	   \
  foundry  family  weight   slant  width  additional style</pre></div><p>Для каждого нового файла шрифтов необходимо создать новое имя.  Если
      у вас есть какая-либо информация из сопроводительной документации к
      шрифту, то она может служить основой для создания имени.  Если информации
      нет, то можно получить некоторую информацию от использования программы
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=strings&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">strings</span>(1)</span></a> над файлом шрифта.  Например:</p><div class="informalexample"><pre class="screen">
<code class="prompt">%</code> <strong class="userinput"><code>strings showboat.pfb | more</code></strong>
%!FontType1-1.0: Showboat 001.001
%%CreationDate: 1/15/91 5:16:03 PM
%%VMusage: 1024 45747
% Generated by Fontographer 3.1
% Showboat
 1991 by David Rakowski.  Alle Rechte Vorbehalten.
FontDirectory/Showboat known{/Showboat findfont dup/UniqueID known{dup
/UniqueID get 4962377 eq exch/FontType get 1 eq and}{pop false}ifelse
{save true}{false}ifelse}{false}ifelse
12 dict begin
/FontInfo 9 dict dup begin
 /version (001.001) readonly def
 /FullName (Showboat) readonly def
 /FamilyName (Showboat) readonly def
 /Weight (Medium) readonly def
 /ItalicAngle 0 def
 /isFixedPitch false def
 /UnderlinePosition -106 def
 /UnderlineThickness 16 def
 /Notice (Showboat
 1991 by David Rakowski.  Alle Rechte Vorbehalten.) readonly def
end readonly def
/FontName /Showboat def
--stdin--</pre></div><p>Пользуясь этой информацией, можно составить возможное имя:</p><div class="informalexample"><pre class="screen">-type1-Showboat-medium-r-normal-decorative-0-0-0-0-p-0-iso8859-1</pre></div><p>Компонентами нашего имени являются:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Foundry</span></dt><dd><p>Давайте называть все новые шрифты
            <code class="literal">type1</code>.</p></dd><dt><span class="term">Family</span></dt><dd><p>Имя шрифта.</p></dd><dt><span class="term">Weight</span></dt><dd><p>Normal, bold, medium, semibold, и так далее.  Из результата
            работы команды <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=strings&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">strings</span>(1)</span></a> похоже, что этот шрифт имеет ширину
	    <span class="emphasis"><em>medium</em></span>.</p></dd><dt><span class="term">Slant</span></dt><dd><p><span class="emphasis"><em>r</em></span>oman, <span class="emphasis"><em>i</em></span>talic, <span class="emphasis"><em>o</em></span>blique, и так далее.  Так как
	    <span class="emphasis"><em>ItalicAngle</em></span> равен нулю, то будет
            использоваться <span class="emphasis"><em>roman</em></span>.</p></dd><dt><span class="term">Width</span></dt><dd><p>Normal, wide, condensed, extended, и так далее.  Пока это не
            будет проверено, предполагаем <span class="emphasis"><em>normal</em></span>.</p></dd><dt><span class="term">Дополнительный стиль</span></dt><dd><p>Обычно опускается, но он будет указывать, что в шрифте есть
            декоративные заглавные буквы.</p></dd><dt><span class="term">Spacing</span></dt><dd><p>proportional или monospaced.  Используется
	    <span class="emphasis"><em>proportional</em></span>, потому что
	    <span class="emphasis"><em>isFixedPitch</em></span> равен false.</p></dd></dl></div><p>Все эти имена произвольны, но нужно стараться следовать существующим
      соглашениям.  В программе для <span class="application">X11</span> на шрифт ссылаются по имени с
      применением шаблонов, так что в выбираемом имени это должно учитываться.
      Можно начать с простого использования

      </p><div class="informalexample"><pre class="screen">...-normal-r-normal-...-p-...
	</pre></div><p>

      в качестве имени, а затем использовать <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=xfontsel&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">xfontsel</span>(1)</span></a> для его проверки
      и изменения имени на основе того, как выглядит шрифт.</p><p>Итак, завершая наш пример:</p><div class="informalexample"><pre class="screen">
<em class="lineannotation"><span class="lineannotation">Делаем шрифт доступным для X11</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>cd /usr/X11R6/lib/X11/fonts/Type1</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>ln -s /usr/local/share/fonts/type1/showboat.pfb .</code></strong>

<em class="lineannotation"><span class="lineannotation">Редактируем файлы fonts.dir and fonts.scale, добавляя строку,
описывающую шрифт и увеличивая количество шрифтов в первой строке.</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>ex fonts.dir
:1p
25
:1c
26
.
:$a
showboat.pfb -type1-showboat-medium-r-normal-decorative-0-0-0-0-p-0-iso8859-1
.
:wq</code></strong>

<em class="lineannotation"><span class="lineannotation">fonts.scale идентичен
fonts.dir...</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>cp fonts.dir fonts.scale</code></strong>

<em class="lineannotation"><span class="lineannotation">Указываем X11, что произошли изменения</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>xset fp rehash</code></strong>

<em class="lineannotation"><span class="lineannotation">Проверяем новый шрифт</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>xfontsel -pattern -type1-*</code></strong></pre></div><p>Справочная информация: <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=xfontsel&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">xfontsel</span>(1)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=xset&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">xset</span>(1)</span></a>, <em class="citetitle">The
      X	Windows System in a Nutshell</em>, <a class="link" href="http://www.ora.com/" target="_top">O'Reilly &amp; Associates</a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="type1-fonts-ghostscript"></a>6. Использование шрифтов type 1 с пакетом Ghostscript</h2></div></div></div><p><span class="application">Ghostscript</span> ссылается на шрифт через свой файл
      <code class="filename">Fontmap</code>.  Он должен быть подправлен так же, как
      и файл <code class="filename">fonts.dir</code> в случае <span class="application">X11</span>.  <span class="application">Ghostscript</span> может
      использовать файлы шрифтов в форматах <code class="filename">.pfa</code> или
      <code class="filename">.pfb</code>.  Взяв шрифт из предыдущего примера, его можно
      использовать с <span class="application">Ghostscript</span> вот так:</p><div class="informalexample"><pre class="screen">
<em class="lineannotation"><span class="lineannotation">Помещаем файл со шрифтом в каталог со шрифтами Ghostscript</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>cd /usr/local/share/ghostscript/fonts</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>ln -s /usr/local/share/fonts/type1/showboat.pfb .</code></strong>

<em class="lineannotation"><span class="lineannotation">Редактируем Fontmap, чтобы Ghostscript знал о шрифте</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>cd /usr/local/share/ghostscript/4.01</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>ex Fontmap
:$a
/Showboat        (showboat.pfb) ; % From CICA /fonts/atm/showboat
.
:wq</code></strong>

<em class="lineannotation"><span class="lineannotation">Используем Ghostscript для проверки шрифта</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>gs prfont.ps</code></strong>
Aladdin Ghostscript 4.01 (1996-7-10)
Copyright (C) 1996 Aladdin Enterprises, Menlo Park, CA.  All rights
reserved.
This software comes with NO WARRANTY: see the file PUBLIC for details.
Loading Times-Roman font from /usr/local/share/ghostscript/fonts/tir_____.pfb...
 /1899520 581354 1300084 13826 0 done.
GS&gt;<strong class="userinput"><code>Showboat DoFont</code></strong>
Loading Showboat font from /usr/local/share/ghostscript/fonts/showboat.pfb...
 1939688 565415 1300084 16901 0 done.
&gt;&gt;showpage, press &lt;return&gt; to continue&lt;&lt;
&gt;&gt;showpage, press &lt;return&gt; to continue&lt;&lt;
&gt;&gt;showpage, press &lt;return&gt; to continue&lt;&lt;
GS&gt;<strong class="userinput"><code>quit</code></strong></pre></div><p>Справочная информация: <code class="filename">fonts.txt</code> из дистрибутива
      <span class="application">Ghostscript 4.01</span></p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="type1-fonts-groff"></a>7. Использование шрифтов в формате type 1 с программой Groff</h2></div></div></div><p>Теперь, когда новый шрифт может быть использован как с <span class="application">X11</span>, так и в
      <span class="application">Ghostscript</span>, как использовать его с программой <span class="application">groff</span>?  Во-первых, так как
      мы имеем дело со <span class="trademark">PostScript</span>(R)-шрифтами формата type 1, то подходящим
      устройством <span class="application">groff</span> является <span class="emphasis"><em>ps</em></span>.  Для каждого шрифта,
      который может использоваться программой <span class="application">groff</span>, должен быть создан файл
      шрифта.  Имя шрифта для <span class="application">groff</span> является просто именем файла из каталога
      <code class="filename">/usr/share/groff_font/devps</code>.  В нашем примере
      файлом шрифта может быть
      <code class="filename">/usr/share/groff_font/devps/SHOWBOAT</code>.  Файл должен
      быть создан с помощью утилит, поставляемых с программой <span class="application">groff</span>.</p><p>Первой утилитой является <code class="command">afmtodit</code>.  Обычно она не
      устанавливается, так что она должна быть получена из дистрибутива с
      исходными текстами.  Я обнаружил, что нужно изменить первую строку файла,
      что я делал так:</p><div class="informalexample"><pre class="screen">
<code class="prompt">%</code> <strong class="userinput"><code>cp /usr/src/gnu/usr.bin/groff/afmtodit/afmtodit.pl /tmp</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>ex /tmp/afmtodit.pl
:1c
#!/usr/bin/perl -P-
.
:wq</code></strong></pre></div><p>Эта утилита создаст файл шрифтов для <span class="application">groff</span> из файла метрик (с
      окончанием <code class="filename">.afm</code>).  Продолжая с нашим
      примером:</p><div class="informalexample"><pre class="screen">
<em class="lineannotation"><span class="lineannotation">Многие файлы .afm в формате Mac
... строки разделены символом ^M.  Нам нужно преобразовать их в
разделитель ^J в стиле <span class="trademark">UNIX</span>(R)</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>cd /tmp</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>cat /usr/local/share/fonts/type1/showboat.afm |
	tr '\015' '\012' &gt;showboat.afm</code></strong>

<em class="lineannotation"><span class="lineannotation">Теперь создаем файл шрифтов groff</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>cd /usr/share/groff_font/devps</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>/tmp/afmtodit.pl -d DESC -e text.enc /tmp/showboat.afm generate/textmap SHOWBOAT</code></strong></pre></div><p>Теперь к шрифту можно обращаться по имени SHOWBOAT.</p><p>Если в системе для управления принтерами используется программа
      <span class="application">Ghostscript</span>, то больше ничего делать не нужно.  Однако, если используются
      настоящие <span class="trademark">PostScript</span>(R)-принтеры, то для использования шрифта его нужно
      загрузить в принтер (если только в принтере шрифт showboat не встроен или
      не имеется на диске со шрифтами).  Последний шаг заключается в создании
      загружаемого шрифта.  Утилита <code class="command">pfbtops</code> используется для
      создания шрифта в формате <code class="filename">.pfa</code>, а файл для
      <code class="filename">загрузки</code> изменяется для указания нового шрифта.
      Файл для <code class="filename">загрузки</code> должен ссылаться на внутреннее имя
      шрифта.  Оно может быть легко определено из файла шрифтов groff, как
      это показывается здесь:</p><div class="informalexample"><pre class="screen">
<em class="lineannotation"><span class="lineannotation">Создание файла шрифта .pfa</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>pfbtops /usr/local/share/fonts/type1/showboat.pfb &gt;showboat.pfa</code></strong></pre></div><p>Конечно, если файл <code class="filename">.pfa</code> уже имеется, для его
      использования создаем символическую ссылку на него.</p><div class="informalexample"><pre class="screen">
<em class="lineannotation"><span class="lineannotation">Получение внутреннего имени шрифта</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>fgrep internalname SHOWBOAT</code></strong>
internalname Showboat

<em class="lineannotation"><span class="lineannotation">Указываем утилите groff, что шрифт должен быть загружен</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>ex download
:$a
Showboat      showboat.pfa
.
:wq</code></strong></pre></div><p>Для тестирования шрифта:</p><div class="informalexample"><pre class="screen">
<code class="prompt">%</code> <strong class="userinput"><code>cd /tmp</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>cat &gt;example.t &lt;&lt;EOF
.sp 5
.ps 16
This is an example of the Showboat font:
.br
.ps 48
.vs (\n(.s+2)p
.sp
.ft SHOWBOAT
ABCDEFGHI
.br
JKLMNOPQR
.br
STUVWXYZ
.sp
.ps 16
.vs (\n(.s+2)p
.fp 5 SHOWBOAT
.ft R
To use it for the first letter of a paragraph, it will look like:
.sp 50p
\s(48\f5H\s0\fRere is the first sentence of a paragraph that uses the
showboat font as its first letter.
Additional vertical space must be used to allow room for the larger
letter.
EOF</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>groff -Tps example.t &gt;example.ps</code></strong>

<em class="lineannotation"><span class="lineannotation">Для использования с ghostscript/ghostview</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>ghostview example.ps</code></strong>

<em class="lineannotation"><span class="lineannotation">Для его печати</span></em>
<code class="prompt">%</code> <strong class="userinput"><code>lpr -Ppostscript example.ps</code></strong></pre></div><p>Справочная информация:
      <code class="filename">/usr/src/gnu/usr.bin/groff/afmtodit/afmtodit.man</code>,
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=groff_font&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">groff_font</span>(5)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=groff_char&amp;sektion=7"><span class="citerefentry"><span class="refentrytitle">groff_char</span>(7)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfbtops&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pfbtops</span>(1)</span></a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="convert-truetype"></a>8. Преобразование файлов шрифтов TrueType в формат groff/PostScript для
      использования с groff</h2></div></div></div><p>Потенциально это требует некоторых усилий, просто потому что зависит
      некоторых утилит, которые в качестве части системы не устанавливаются.
      Это:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="command">ttf2pf</code></span></dt><dd><p>Утилита для преобразования TrueType в PostScript.  Она
            позволяет преобразовать шрифт TrueType в метрику шрифта в текстовом
            формате (файл <code class="filename">.afm</code>).</p><p>Доступна по адресу <code class="uri"><a class="uri" href="http://sunsite.icm.edu.pl/pub/GUST/contrib/BachoTeX98/ttf2pf/" target="_top">http://sunsite.icm.edu.pl/pub/GUST/contrib/BachoTeX98/ttf2pf/</a></code>.
            Замечание: Эти файлы являются PostScript-программами и должны быть
            скачаны на диск щелчком на ссылке при нажатой клавише
	    <span class="keycap"><strong>Shift</strong></span>.  В противном случае для их просмотра ваш
            браузер может попытаться запустить программу
            <span class="application">ghostview</span>.</p><p>Интерес представляют следующие файлы:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">GS_TTF.PS</code></p></li><li class="listitem"><p><code class="filename">PF2AFM.PS</code></p></li><li class="listitem"><p><code class="filename">ttf2pf.ps</code></p></li></ul></div><p>Смесь верхнего/нижнего регистров присутствует из-за того, что
            эти файлы предназначены и для DOS.  <code class="filename">ttf2pf.ps</code>
            использует остальные с именами в верхнем регистре, так что при
            переименовании это нужно учитывать.  (На самом деле
	    <code class="filename">GS_TTF.PS</code> и <code class="filename">PFS2AFM.PS</code>
            предположительно являются частью дистрибутива <span class="application">Ghostscript</span>, но их
            легко использовать как отдельные утилиты.  В поставку FreeBSD они
            не включены.)  Вы можете также установить их в каталог
	    <code class="filename">/usr/local/share/groff_font/devps</code>(?).</p></dd><dt><span class="term"><code class="command">afmtodit</code></span></dt><dd><p>Создает файлы шрифтов для использования с программой <span class="application">groff</span> из
            текстовых файлов с метриками шрифта.  Она обычно располагается в
            каталоге <code class="filename">/usr/src/contrib/groff/afmtodit</code> и
            для ее использования требуется проделать некоторую работу.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Если вы избегаете работать в дереве
              <code class="filename">/usr/src</code>, просто скопируйте содержимое
              вышеупомянутого каталога во временный рабочий каталог.</p></div><p>Во рабочем каталоге вам нужно построить утилиту.  Просто
            введите такую команду:</p><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>make -f Makefile.sub afmtodit</code></strong>
	  </pre><p>Вам может также потребоваться скопировать
	    <code class="filename">/usr/contrib/groff/devps/generate/textmap</code> в
	    <code class="filename">/usr/share/groff_font/devps/generate</code>, если его
              не существует.</p></dd></dl></div><p>Как только эти утилиты готовы, вы можете начать:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Создайте файл <code class="filename">.afm</code> по такой команде:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>gs -dNODISPLAY -q -- ttf2pf.ps <em class="replaceable"><code>TTF_name</code></em> <em class="replaceable"><code>PS_font_name</code></em> <em class="replaceable"><code>AFM_name</code></em></code></strong>
	</pre><p>Здесь <em class="replaceable"><code>TTF_name</code></em> обозначает ваш файл со
          шрифтом TrueType, <em class="replaceable"><code>PS_font_name</code></em> является
          именем для файла <code class="filename">.pfa</code>,
          <em class="replaceable"><code>AFM_name</code></em> задает имя для файла
          <code class="filename">.afm</code>.  Если вы не укажете имена выходных файлов,
          для форматов <code class="filename">.pfa</code> или <code class="filename">.afm</code>,
          то по умолчанию будут использоваться имена, получаемые из имени файла
          со шрифтом TrueType.</p><p>При этом также будет создан файл <code class="filename">.pfa</code>,
          текстовый файл с метриками PostScript-шрифта
          ((<code class="filename">.pfb</code> для двоичного представления).  Это не
          не обязательно, но может быть (я думаю) полезным для сервера
          шрифтов.</p><p>Например, для преобразования шрифта 30f9 Barcode с именами файлов
          по умолчанию, воспользуйтесь следующей командой:</p><pre class="screen">
<code class="prompt">%</code> <strong class="userinput"><code>gs -dNODISPLAY -- ttf2pf.ps 3of9.ttf</code></strong>
Aladdin Ghostscript 5.10 (1997-11-23)
Copyright (C) 1997 Aladdin Enterprises, Menlo Park, CA.  All rights reserved.
This software comes with NO WARRANTY: see the file PUBLIC for details.
Converting 3of9.ttf to 3of9.pfa and 3of9.afm.
	</pre><p>Если вы хотите, чтобы преобразованные шрифты сохранялись в файлы
	  <code class="filename">A.pfa</code> and <code class="filename">B.afm</code>, то
          выдайте такую команду:</p><pre class="screen">
<code class="prompt">%</code> <strong class="userinput"><code>gs -dNODISPLAY -- ttf2pf.ps 3of9.ttf A B</code></strong>
Aladdin Ghostscript 5.10 (1997-11-23)
Copyright (C) 1997 Aladdin Enterprises, Menlo Park, CA.  All rights reserved.
This software comes with NO WARRANTY: see the file PUBLIC for details.
Converting 3of9.ttf to A.pfa and B.afm.
	</pre></li><li class="listitem"><p>Создайте PostScript-файл для <span class="application">groff</span>:</p><p>Смените текущий каталог на
          <code class="filename">/usr/share/groff_font/devps</code> для облегчения
          запуска упоминаемых далее программ.  Для этого вам может понадобиться
          иметь привилегии администратора системы.  (Или, если вы избегаете
          здесь работать, обязательно посмотрите файлы
          <code class="filename">DESC</code>, <code class="filename">text.enc</code> и
	  <code class="filename">generate/textmap</code> в этом каталоге.)</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>afmtodit -d DESC -e text.enc file.afm \
	    generate/textmap <em class="replaceable"><code>PS_font_name</code></em></code></strong>
	</pre><p>Здесь <code class="filename">file.afm</code> является файлом
          <em class="replaceable"><code>AFM_name</code></em>, созданным программой
	  <code class="command">ttf2pf.ps</code> выше, а
          <em class="replaceable"><code>PS_font_name</code></em> является именем шрифта,
          используемым в той команде, так же, как и имя, которое будет
          использовать утилита <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=groff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">groff</span>(1)</span></a> для ссылки на этот шрифт.
          Например, полагая, что вы использовали первую команду
	  <code class="command">tiff2pf.ps</code> выше, то шрифт 3of9 Barcode может быть
          создан при помощи такой команды:</p><pre class="screen">
<code class="prompt">%</code> <strong class="userinput"><code>afmtodit -d DESC -e text.enc 3of9.afm \
                 generate/textmap 3of9</code></strong>
	</pre><p>Проверьте, что полученный файл
          <em class="replaceable"><code>PS_font_name</code></em> (к примеру,
          <code class="filename">3of9</code> из примера выше) расположен в каталоге
	  <code class="filename">/usr/share/groff_font/devps</code>, скопировав или
          перенеся его сюда.</p><p>Заметьте, что если <code class="filename">ttf2pf.ps</code> назначает
          имя шрифта, используя один из найденных в файле шрифта TrueType, а
          вы хотите использовать другое имя, то вы должны отредактировать файл
	  <code class="filename">.afm</code> до запуска команды
          <code class="command">afmtodit</code>.  Это имя к тому же должно
          совпадать с тем, что используется в файле Fontmap, если вы
          собираетесь перенаправлять вывод <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=groff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">groff</span>(1)</span></a> утилите
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gs&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">gs</span>(1)</span></a>.</p></li></ol></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="truetype-for-other-programs"></a>9. Можно ли использовать шрифты в формате TrueType с другими
      программами?</h2></div></div></div><p>Формат TrueType используется в Windows, Windows 95 и на компьютерах
      Macintosh.  Он достаточно популярен и в этом формате имеется большое
      количество шрифтов.</p><p>К сожалению, я знаю лишь несколько программ, которые могут
      использовать этот формат: на ум приходят <span class="application">Ghostscript</span> и <span class="application">Povray</span>.  Его
      поддержка в программе <span class="application">Ghostscript</span>, согласно документации, находится в
      зачаточном состоянии и получаемый результат хуже того, что получается при
      использовании шрифтов type 1.  Программа <span class="application">Povray</span> версии 3 также может
      использовать шрифты TrueType, но я очень сомневаюсь, что много кто
      создает документы как последовательность анимированных страниц
      :-).</p><p>Такая весьма печальная ситуация может вскоре измениться.  В рамках
      проекта <a class="link" href="http://www.freetype.org/" target="_top">FreeType Project</a>
      в настоящее время разрабатывается полезный набор инструментов для работы
      с FreeType:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Сервер шрифтов <code class="command">xfsft</code> для <span class="application">X11</span> может работать и
          со шрифтами TrueType, и с обычными шрифтами.  Хотя в настоящее время
          он еще находится в стадии отладки, но его уже можно использовать.
          Посмотрите <a class="link" href="http://www.dcs.ed.ac.uk/home/jec/programs/xfsft/" target="_top">страницу
          Juliusz Chroboczek</a>, чтобы получить более полную информацию.
          Указания по переносу на FreeBSD можно найти на странице <a class="link" href="http://math.missouri.edu/~stephen/software/" target="_top">Стивена
          Монтгомери</a> (Stephen Montgomery), посвященной программному
          обеспечению.</p></li><li class="listitem"><p><span class="application">xfstt</span> является еще одним сервером шрифтов для
          <span class="application">X11</span>, доступный по адресу <code class="uri"><a class="uri" href="ftp://sunsite.unc.edu/pub/Linux/X11/fonts" target="_top">ftp://sunsite.unc.edu/pub/Linux/X11/fonts</a></code>.</p></li><li class="listitem"><p>Программа, которая называется <code class="command">ttf2bdf</code>, может
          генерировать BDF-файлы, которые можно использовать в системе X
          Window, из файлов шрифтов TrueType.  Выполнимые файлы Linux могут
          находиться по адресу <code class="uri"><a class="uri" href="ftp://crl.nmsu.edu/CLR/multiling/General" target="_top">ftp://crl.nmsu.edu/CLR/multiling/General</a></code>.</p></li><li class="listitem"><p>и другие ...</p></li></ul></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="obtaining-additional-fonts"></a>10. Где можно найти дополнительные шрифты?</h2></div></div></div><p>Много шрифтов можно найти в сети Интернет.  Они либо абсолютно
      бесплатны, либо условно-бесплатны.  В добавок, множество шрифтов
      находится в категории <code class="filename">x11-fonts/</code> Коллекции
      Портов.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="additional-questions"></a>11. Дополнительные вопросы</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Для чего предназначены файлы <code class="filename">.pfm</code>?</p></li><li class="listitem"><p>Можно ли получить файл <code class="filename">.afm</code> из файла
	  <code class="filename">.pfa</code> или <code class="filename">.pfb</code>?</p></li><li class="listitem"><p>Как получить файлы преобразования символов <span class="application">groff</span> для
          PostScript-шрифтов с нестандартными названиями символов?</p></li><li class="listitem"><p>Можно ли настроить xditview и устройства devX?? на работу всех
          новых шрифтов?</p></li><li class="listitem"><p>Хорошо бы иметь примеры использования шрифтов TrueType с
          программами <span class="application">Povray</span> и <span class="application">Ghostscript</span>.</p></li></ul></div></div></div></body></html>