<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>6. Оптимизация таблицы страниц</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Элементы архитектуры системы виртуальной памяти во FreeBSD" /><link rel="up" href="index.html" title="Элементы архитектуры системы виртуальной памяти во FreeBSD" /><link rel="prev" href="prefault-optimizations.html" title="5. Оптимизация ошибок доступа к страницам и их обнуления" /><link rel="next" href="page-coloring-optimizations.html" title="7. Подгонка страниц" /><link rel="copyright" href="trademarks.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6. Оптимизация таблицы страниц</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="prefault-optimizations.html">Пред.</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="page-coloring-optimizations.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="pre-table-optimizations"></a>6. Оптимизация таблицы страниц</h2></div></div></div><p>Оптимизация таблицы страниц составляет самую содержательную часть
      архитектуры VM во FreeBSD и она проявляется при появлении нагрузки при
      значительном использовании <code class="function">mmap()</code>.  Я думаю, что это
      на самом деле особенность работы большинства BSD-систем, хотя я не
      уверен, когда это проявилось впервые.  Есть два основных подхода к
      оптимизации.  Первый заключается в том, что аппаратные таблицы страниц
      не содержат постоянного состояния, а вместо этого могут быть сброшены в
      любой момент с малыми накладными расходами.  Второй подход состоит в том,
      что каждая активная таблица страниц в системе имеет управляющую структуру
      <code class="literal">pv_entry</code>, которая связана в структуру
      <code class="literal">vm_page</code>.  FreeBSD может просто просматривать эти
      отображения, которые существуют, когда как в Linux должны проверяться все
      таблицы страниц, которые <span class="emphasis"><em>могут</em></span> содержать нужное
      отображение, что в некоторых ситуация дает увеличение сложности O(n^2).
      Из-за того, что FreeBSD стремится выбрать наиболее подходящую к
      повторному использованию или сбросу в область подкачки страницу, когда
      ощущается нехватка памяти, система дает лучшую производительность при
      нагрузке.  Однако во FreeBSD требуется тонкая настройка ядра для
      соответствия ситуациям с большим совместно используемым адресным
      пространством, которые могут случиться в системе, обслуживающей сервер
      телеконференций, потому что структуры <code class="literal">pv_entry</code> могут
      оказаться исчерпанными.</p><p>И в Linux, и во FreeBSD требуются доработки в этой области.  FreeBSD
      пытается максимизировать преимущества от потенциально редко применяемой
      модели активного отображения (к примеру, не всем процессам нужно
      отображать все страницы динамической библиотеки), когда как Linux
      пытается упростить свои алгоритмы.  FreeBSD имеет здесь общее преимущество
      в производительности за счет использования дополнительной памяти, но
      FreeBSD выглядит хуже в случае, когда большой файл совместно используется
      сотнями процессов.  Linux, с другой стороны, выглядит хуже в случае,
      когда много процессов частично используют одну и ту же динамическую
      библиотеку, а также работает неоптимально при попытке определить, может
      ли страница повторно использоваться, или нет.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="prefault-optimizations.html">Пред.</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="page-coloring-optimizations.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">5. Оптимизация ошибок доступа к страницам и их обнуления </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 7. Подгонка страниц</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>