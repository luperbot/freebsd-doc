<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>3. Construcción de la Release</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Proceso de generación de releases en FreeBSD" /><link rel="up" href="index.html" title="Proceso de generación de releases en FreeBSD" /><link rel="prev" href="release-proc.html" title="2. Proceso de ingeniería de releases" /><link rel="next" href="distribution.html" title="4. Distribución" /><link rel="copyright" href="trademarks.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3. Construcción de la Release</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="release-proc.html">Anterior</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="distribution.html">Siguiente</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="release-build"></a>3. Construcción de la Release</h2></div></div></div><p>Cualquier persona dueña de una potente máquina y con acceso de lectura
    al repositorio de código fuente puede <span class="quote">&#8220;<span class="quote">construir</span>&#8221;</span> las
    <span class="quote">&#8220;<span class="quote">releases</span>&#8221;</span> de FreeBSD.  En la práctica esto significa
    que cualquiera puede generar el proceso de construcción de
    releases, ya que, como se comentó con anterioridad, FreeBSD ofrece
    acceso CVS anónimo a todo el mundo (consulte el Handbook para más
    detalles).  El único requisito imprescindible para realizar este
    proceso es la existencia del dispositivo <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vn&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">vn</span>(4)</span></a>. (En -CURRENT,
    este dispositivo ha sido reemplazado por el nuevo driver de discos
    en memoria denominado <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a>.)  Si el dispositivo no se
    encuentra cargado en el kernel, debería cargarse automáticamente
    al ejecutar el comando <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vnconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">vnconfig</span>(8)</span></a> como parte de la fase de
    creación del medio de arranque.  Todas las herramientas necesarias
    para construir la release se encuentran disponibles en el
    repositorio de CVS dentro del directorio
    <code class="filename">src/release</code>.  Estas herramientas proporcionan
    una forma consistente y robusta de construir releases de FreeBSD.
    Una release completa se puede construir utilizando un único
    comando, incluyendo la creación de las imágenes
    <acronym class="acronym">ISO</acronym> necesarias para realizar copias en CDROM,
    junto con disquetes de instalación y un directorio para la
    instalación por FTP.  Este comando fue adecuadamente
    bautizado como <code class="command">make release</code>.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63766480"></a>3.1. <code class="command">make release</code></h3></div></div></div><p>Para poder construir la releases de una forma exitosa
      se debe rellenar primero el directorio
      <code class="filename">/usr/obj</code> ejecutando el comando
      <code class="command">make world</code> o simplemente <code class="command">make
      buildworld</code>.  El target release que utiliza el comando
      make necesita varias variables, tal como se muestra a
      continuación:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">CHROOTDIR</code> - El directorio que se utiliza para
	el entorno de chroot durante la construcción de la release
	entera.</p></li><li class="listitem"><p><code class="varname">BUILDNAME</code> - El nombre de la release que se va a
	construir.</p></li><li class="listitem"><p><code class="varname">CVSROOT</code> - La ubicación del repositorio de CVS.
        </p></li><li class="listitem"><p><code class="varname">RELEASETAG</code> - La etiqueta CVS correspondiente con la
	release que se quiere construir.</p></li></ul></div><p>Si no se dispone de acceso a un repositorio de CVS local,
       se puede realizar una copia espejo (un mirror) con
       <a class="link" href="http://www.FreeBSD.org/doc/en_US.ISO8859-1/books/handbook/synching.html#CVSUP" target="_top">CVSup</a>.
       El fichero
       <code class="filename">/usr/share/examples/cvsup/cvs-supfile</code>,
       sirve como buen punto de partida para realizar un mirror del
       repositorio de CVS.</p><p>Si se omite <code class="varname">RELEASETAG</code>, la release se
       construirá a partir de la rama <code class="literal">HEAD</code> (también
       conocida como -CURRENT).  Las releases que se construyen desde
       el principio se conocen normalmente con el nombre de
       <span class="quote">&#8220;<span class="quote">-CURRENT snapshots</span>&#8221;</span>.</p><p>Existen otras variables que se pueden editar para adaptar
       el proceso de construcción de la release.  La mayoría de estas
       variables se encuentran documentadas al comienzo de
       <code class="filename">src/release/Makefile</code>.  El comando exacto
       para contruir la release oficial de FreeBSD 4.7 (x86)
       fue:</p><pre class="screen"><code class="command">make release CHROOTDIR=/local3/release \
       BUILDNAME=4.7-RELEASE \
       CVSROOT=/host/cvs/usr/home/ncvs \
       RELEASETAG=RELENG_4_7_0_RELEASE
       </code>
     </pre><p>El <code class="filename">Makefile</code> de la release se puede
       dividir en varios pasos distintos.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Creación de un entorno de sistema limpio en una
	jerarquía de directorios separada utilizando
	<span class="quote">&#8220;<span class="quote"><code class="command">make installworld</code></span>&#8221;</span>.
        </p></li><li class="listitem"><p>Comprobación de la correcta versión de los ficheros fuentes
	  almacenados
	  en la jerarquía de directorios recién creada, junto con el
	  chequeo de la documentación y de los ports utilizando, todo
	  ello a través de CVS.</p></li><li class="listitem"><p>Relleno de los directorios <code class="filename">/etc</code> y
        <code class="filename">/dev</code> dentro del entorno chroot.</p></li><li class="listitem"><p>Creación de un <span class="quote">&#8220;<span class="quote">chroot</span>&#8221;</span> dentro de la jerarquía de
	directorios
	creada, para que resulte más dificil que el entorno de la
	máquina se vea contaminado por la construcción de la
	release.</p></li><li class="listitem"><p><code class="command">make world</code>
        dentro del entorno de chroot.</p></li><li class="listitem"><p>Contrucción de los binarios relacionados con Kerberos.</p></li><li class="listitem"><p>Construcción del kernel <code class="filename">GENERIC</code>.</p></li><li class="listitem"><p>Creación de un esqueleto del árbol de directorios donde
	se construirán y empaquetarán las distribuciones
	binarias.</p></li><li class="listitem"><p>Construcción e instalación del conjunto de herramientas de
	documentación necesarias para convertir los fuentes de la
	documentación (SGML) en los documentos HTML y de texto que pasarán
	a formar parte de la release.</p></li><li class="listitem"><p>Construcción e instalación de la documentación real
	(manuales de usuario, tutoriales, release notes, listas de
	compatibilidad de hardware, etc.)</p></li><li class="listitem"><p>Construcción de los <span class="quote">&#8220;<span class="quote">decisivos</span>&#8221;</span> binarios utilizados
	en los disquetes de instalación.</p></li><li class="listitem"><p>Colocación adecuada de los de los paquetes de distribución de
	binarios y de fuentes.</p></li><li class="listitem"><p>Creación del medio de arranque y del disquete <span class="quote">&#8220;<span class="quote">fixit</span>&#8221;</span>
	o salvamento.</p></li><li class="listitem"><p>Creación de la jerarquía de directorios de instalación por FTP.</p></li><li class="listitem"><p><span class="emphasis"><em></em></span> Creación de imágenes ISO para
	CDROM/DVD(opcional).</p></li></ul></div><p>Para más información sobre la infraestructura involucrada en
      el proceso de construcción de la release, el lector puede
      consultar <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=release&amp;sektion=7"><span class="citerefentry"><span class="refentrytitle">release</span>(7)</span></a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63850832"></a>3.2. Construcción de<span class="application"><span class="trademark">XFree86</span>&#8482;</span></h3></div></div></div><p><span class="application"><span class="trademark">XFree86</span>&#8482;</span> es un componente importante para muchos
      usuarios de entornos gráficos.  Antes de la release FreeBSD 4.6 las
      se usaba <span class="trademark">XFree86</span>&#8482;3.<em class="replaceable"><code>X</code></em> por defecto.  La forma
      más sencilla de construir estas versiones consiste en utilizar
      el script <code class="filename">src/release/scripts/X11/build_x.sh</code>.
      Este script requiere que <span class="trademark">XFree86</span>&#8482; y Tcl/Tk se encuentren
      instalados previamente en la máquina donde se realiza la
      construcción.  Después de compilar los servidores X necesarios,
      el script empaqueta todos los ficheros en
      <span class="quote">&#8220;<span class="quote">tarballs</span>&#8221;</span> que <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysinstall&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysinstall</span>(8)</span></a> sabe cómo
      localizar utilizando el directorio <code class="filename">XF86336</code>
      del medio de instalación.</p><p>A partir de FreeBSD 4.6, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysinstall&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysinstall</span>(8)</span></a> instala
      <span class="trademark">XFree86</span>&#8482; 4.<em class="replaceable"><code>X</code></em> por defecto, como
      cualquier otro conjunto de paquetes.  Estos paquetes se pueden
      construir a partir del <span class="quote">&#8220;<span class="quote">package-building cluster</span>&#8221;</span>
      o a partir de las etiquetas del árbol de ports adecuadas.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Es importante borrar cualquier configuración
      particular almacenada en <code class="filename">/etc/make.conf</code>.
      Por ejemplo, no sería una idea muy inteligente distribuir binarios que se
      construyeron en un sistema con la variable
      <code class="varname">CPUTYPE</code> asignada a un determinado
      procesador.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63879376"></a>3.3. Software Contribuido (<span class="quote">&#8220;<span class="quote">ports</span>&#8221;</span>)</h3></div></div></div><p>La colección de <a class="link" href="http://www.FreeBSD.org/ports" target="_top">FreeBSD Ports
      </a> está compuesta por más de 24,000 paquetes
      de software de terceras partes que se encuentran disponibles para
      FreeBSD.  El Grupo de administración de ports <code class="email">&lt;<a xmlns="" class="email" href="mailto:portmgr@FreeBSD.org">portmgr@FreeBSD.org</a>&gt;</code> se responsabiliza de mantener un árbol
      de ports consistente que se pueda utilizar para crear paquetes
      binarios, los cuales se añaden a las releases oficiales de
      FreeBSD.</p><p>Las actividades de ingeniería de releases para nuestra
      colección de paquetes software de terceras partes se encuentra
      más allá del objetivo de este documento.  Otro artículo,
      <code class="uri"><a class="uri" href="http://www.freebsd.org/doc/en_US.ISO8859-1/articles/releng-packages/" target="_top">http://www.freebsd.org/doc/en_US.ISO8859-1/articles/releng-packages/</a></code>,
      cubre este tema en profundidad.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63887056"></a>3.4. ISOs de la release</h3></div></div></div><p>A partir de FreeBSD 4.4, el Proyecto FreeBSD decidió lanzar
      gratuitamente al público las cuatro imágenes ISO que
      anteriormente se vendían en <span class="emphasis"><em>BSDi/Wind River
      Systems/FreeBSD Mall</em></span> como distribuciones en CDROM
      <span class="quote">&#8220;<span class="quote">oficiales</span>&#8221;</span>.  Cada uno de los cuatro discos debe
      contener un <code class="filename">README.TXT</code> que explica
      el contenido de cada disco, un
      <code class="filename">CDROM.INF</code> que proporciona metadatos para
      que <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysinstall&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysinstall</span>(8)</span></a> pueda validar la información en él
      contenida y un <code class="filename">filename.txt</code> que
      proporciona un <span class="quote">&#8220;<span class="quote">manifiesto</span>&#8221;</span>.  Este
      <span class="emphasis"><em>manifiesto</em></span> se puede crear utilizando un
      simple comando:</p><pre class="screen">/stage/cdrom<code class="prompt">#</code> <strong class="userinput"><code>find . -type f | sed -e 's/^\.\///' | sort &gt; filename.txt</code></strong></pre><p>Los requisitos concretos de cada CD se resumen a continuación.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63911760"></a>3.4.1. Disco 1</h4></div></div></div><p>El primer disco se crea casi en su totalidad a partir del
	comando <code class="command">make release</code>.  Los únicos cambios
	que se deben realizar dentro del directorio
	<code class="filename">disc1</code> son la adición de un directorio
	<code class="filename">tools</code>, de <span class="application"><span class="trademark">XFree86</span>&#8482;</span> y de los paquetes de
	terceras partes más populares que quepan dentro del espacio
	remanente de dicho primer disco.  El directorio
	<code class="filename">tools</code> contiene el software que permite a
	los usuarios crear disquetes de instalación desde otros
	sistemas operativos.  Este disco debe crearse como
	autoarrancable para que los usuarios de PCs modernos no
	necesiten crear disquetes de arranque y puedan utilizar la
	característica de autoarranque desde CD.</p><p>Si se proporciona una versión alternativa de <span class="trademark">XFree86</span>&#8482;,
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysinstall&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysinstall</span>(8)</span></a> debe actualizarse para reflejar la nueva
	localización y las instrucciones de instalación.  El código
	relevante se encuentra en
	<code class="filename">src/release/sysinstall</code> en -STABLE o en
	<code class="filename">src/usr.sbin/sysinstall</code> en -CURRENT.
	Específicamente, se deben actualizar
	<code class="filename">dist.c</code>, <code class="filename">menus.c</code> y
	<code class="filename">config.c</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63932880"></a>3.4.2. Disco 2</h4></div></div></div><p>El segundo disco se crea en su mayor parte a partir del
	comando <code class="command">make release</code>.  Este disco contiene
	un <span class="quote">&#8220;<span class="quote">sistema de ficheros vivo</span>&#8221;</span>,  que se puede
	utilizar a partir de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysinstall&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysinstall</span>(8)</span></a> para resolver
	problemas durante el proceso de instalación de FreeBSD.  Este
	disco se debe construir como autoarrancable y debe contener
	una copia comprimida del repositorio de CVS dentro del
	directorio <code class="filename">CVSROOT</code>, junto con
	demostraciones de software comercial localizadas dentro del
	directorio <code class="filename">commerce</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63949136"></a>3.4.3. Discos 3 and 4</h4></div></div></div><p>Los dos discos que quedan contienen paquetes de software
	para FreeBSD.  Estos paquetes deben agruparse de
	tal forma que un paquete y todas sus
	<span class="emphasis"><em>dependencias</em></span> quepan en el mismo disco.
	Se puede obtener más información sobre la creación de estos
	discos en el artículo <code class="uri"><a class="uri" href="http://www.freebsd.org/doc/en_US.ISO8859-1/articles/releng-packages/" target="_top">http://www.freebsd.org/doc/en_US.ISO8859-1/articles/releng-packages/</a></code>
        .</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-proc.html">Anterior</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="distribution.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">2. Proceso de ingeniería de releases </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 4. Distribución</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>