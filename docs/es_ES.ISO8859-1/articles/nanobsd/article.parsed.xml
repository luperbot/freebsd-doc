<?xml version="1.0" encoding="iso-8859-1"?>
<!-- The FreeBSD Spanish Documentation Project
     Original Revision: r1.3                   -->
<article xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:lang="es">

  <info><title xmlns:xlink="http://www.w3.org/1999/xlink">Introducción a NanoBSD</title>
    

    <authorgroup xmlns:xlink="http://www.w3.org/1999/xlink">
      <author xmlns:xlink="http://www.w3.org/1999/xlink"><personname xmlns:xlink="http://www.w3.org/1999/xlink"><firstname xmlns:xlink="http://www.w3.org/1999/xlink">Daniel</firstname><surname xmlns:xlink="http://www.w3.org/1999/xlink">Gerzo</surname></personname></author>
    </authorgroup>

    <copyright xmlns:xlink="http://www.w3.org/1999/xlink">
      <year xmlns:xlink="http://www.w3.org/1999/xlink">2006</year>
      <holder xmlns:xlink="http://www.w3.org/1999/xlink">The FreeBSD Documentation Project</holder>
    </copyright>

    <legalnotice xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="trademarks" role="trademarks">
      <para xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">FreeBSD is a registered trademark of
  the FreeBSD Foundation.</para> <para xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">Many of the designations used by
  manufacturers and sellers to distinguish their products are claimed
  as trademarks.  Where those designations appear in this document,
  and the FreeBSD Project was aware of the trademark claim, the
  designations have been followed by the <quote xmlns:xlink="http://www.w3.org/1999/xlink">&#8482;</quote> or the
  <quote xmlns:xlink="http://www.w3.org/1999/xlink">®</quote> symbol.</para>
    </legalnotice>

    <pubdate xmlns:xlink="http://www.w3.org/1999/xlink">$FreeBSD$</pubdate>

    <releaseinfo xmlns:xlink="http://www.w3.org/1999/xlink">$FreeBSD$</releaseinfo>

    <abstract xmlns:xlink="http://www.w3.org/1999/xlink">
      <para xmlns:xlink="http://www.w3.org/1999/xlink">Este documento trata sobre <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application>.
	<application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> es una herramienta que permite
        crear imágenes del sistema FreeBSD para su uso en
        aplicaciones empotradas y listas para cargarse en una
        tarjeta Compact Flash (u otro medio de almacenamiento
        masivo).</para>
	<para xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><emphasis xmlns:xlink="http://www.w3.org/1999/xlink">Traducción de Germán Marcos <email xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">gri.msg@gmail.com</email>.</emphasis></para>
    </abstract>
  </info>

  <sect1 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="intro">
    <title xmlns:xlink="http://www.w3.org/1999/xlink">Introducción a NanoBSD</title>

    <indexterm xmlns:xlink="http://www.w3.org/1999/xlink"><primary xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</primary></indexterm>

    <para xmlns:xlink="http://www.w3.org/1999/xlink"><application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> es una herramienta
      actualmente desarrollada por Poul-Henning Kamp.  Crea una imagen del
      sistema FreeBSD para aplicaciones empotradas lista para su uso en
      una tarjeta Compact Flash (u otro medio de almacenamiento
      masivo).</para>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">Puede utilizarse para generar imágenes
      instalables especiales; está diseñado pensando en una
      instalación y mantenimiento fáciles en sistemas
      conocidos como <quote xmlns:xlink="http://www.w3.org/1999/xlink">sistemas empotrados</quote>.  Los
      sistemas empotrados tienen hardware y software
      integrado en el producto, lo que significa que todas las
      aplicaciones están preinstaladas.  Estos dispositivos
      pueden conectarse a una red dada y comenzar a trabajar
      (casi) inmediatamente.</para>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">Las características
      de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> incluyen:</para>

    <itemizedlist xmlns:xlink="http://www.w3.org/1999/xlink">
      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink">Los ports y paquetes funcionan como en FreeBSD:
	      Cualquier aplicación puede instalarse y usarse en
	      una imagen de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> de la
	      misma forma que en FreeBSD.</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink">No se pierde funcionalidad: Si es posible hacer
          algo en FreeBSD es posible hacer lo mismo
          en <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application>, a menos que se haya
          eliminado explícitamente esa característica o
          características especiales al crear la imagen
          de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application>.</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink">Todo está en modo de sólo lectura
	      durante el funcionamiento del sistema: Un apagado
	      brusco es totalmente seguro.  No es necesario ejecutar
	      <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">fsck</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">8</manvolnum></citerefentry> después de que el sistema sufra
	      un apagón.</para>
      </listitem>

      <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink">Fácil de generar y personalizar: Usando
	      un solo script de shell y un fichero de configuración
	      pueden generarse imágenes reducidas y personalizadas
	      que satisfagan cualquier necesidad.</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="howto">
    <title xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD <quote xmlns:xlink="http://www.w3.org/1999/xlink">Howto</quote></title>

    <sect2 xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="design">
      <title xmlns:xlink="http://www.w3.org/1999/xlink">El diseño de NanoBSD</title>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Una vez que la imagen está en el medio puede
	    arrancar <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application>.  El medio
	    de almacenamiento se divide por omisión en tres
	    partes:</para>

      <itemizedlist xmlns:xlink="http://www.w3.org/1999/xlink">
	    <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	      <para xmlns:xlink="http://www.w3.org/1999/xlink">Dos particiones de la imagen: <literal xmlns:xlink="http://www.w3.org/1999/xlink">code#1</literal>
	        y <literal xmlns:xlink="http://www.w3.org/1999/xlink">code#2</literal>.</para>
	    </listitem>

	    <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	      <para xmlns:xlink="http://www.w3.org/1999/xlink">La partición que contiene los ficheros de
	        configuración, que puede montarse bajo
	        <filename xmlns:xlink="http://www.w3.org/1999/xlink">/cfg</filename> durante el
	        funcionamiento del sistema.</para>
	    </listitem>
      </itemizedlist>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Estas particiones se montan normalmente en modo de
        sólo lectura.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Los directorios <filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc</filename>
        y <filename xmlns:xlink="http://www.w3.org/1999/xlink">/var</filename> son discos
        <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">md</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">4</manvolnum></citerefentry> (malloc).</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">La partición de los ficheros de configuración
        permanece bajo el
        directorio <filename xmlns:xlink="http://www.w3.org/1999/xlink">/cfg</filename>.  Este
        directorio contiene ficheros que usa el
        directorio <filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc</filename> y se
        monta en modo de sólo lectura inmediatamente
        después del arranque; por lo tanto, es necesario que
        los ficheros que se modifiquen
        en <filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc</filename> se copien
        en <filename xmlns:xlink="http://www.w3.org/1999/xlink">/cfg</filename> si se desea que
        los cambios perduren después del reinicio del
        sistema.</para>

      <example xmlns:xlink="http://www.w3.org/1999/xlink">
	    <title xmlns:xlink="http://www.w3.org/1999/xlink">Cómo hacer cambios persistentes
	      en <filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc/resolv.conf</filename></title>

	    <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">vi /etc/resolv.conf</userinput>
[...]
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">mount /cfg</userinput>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">cp /etc/resolv.conf /cfg</userinput>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">umount /cfg</userinput></screen>
      </example>

      <note xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink">La partición que contiene el
	      directorio <filename xmlns:xlink="http://www.w3.org/1999/xlink">/cfg</filename>
	      debería montarse únicamente en el arranque y
	      mientras se sobreescriben los ficheros de
	      configuración.</para>

	    <para xmlns:xlink="http://www.w3.org/1999/xlink">No es buena idea montar siempre el
          directorio <filename xmlns:xlink="http://www.w3.org/1999/xlink">/cfg</filename>,
          especialmente si el
          sistema <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> se ejecuta en un
          dispositivo de almacenamiento masivo que pueda verse
          afectado negativamente por un número elevado de
          escrituras en la partición (i.e. cuando el sistema de
          ficheros sincroniza los datos con el sistema de
          discos).</para>
      </note>
    </sect2>

    <sect2 xmlns:xlink="http://www.w3.org/1999/xlink">
      <title xmlns:xlink="http://www.w3.org/1999/xlink">Cómo generar una imagen de NanoBSD</title>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Una imagen de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> se genera
	    usando el sencillo script de
	    shell <filename xmlns:xlink="http://www.w3.org/1999/xlink">nanobsd.sh</filename>, ubicado en el
	    directorio <filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr/src/tools/tools/nanobsd</filename>.
	    El script crea una imagen que se deberá copiar al medio
	    de almacenamiento mediante la utilidad <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">dd</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">1</manvolnum></citerefentry>.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Los comandos necesarios para generar una imagen
      de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> son:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">cd /usr/src/tools/tools/nanobsd</userinput> <co xml:id="nbsd-cd"/>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">sh nanobsd.sh</userinput> <co xml:id="nbsd-sh"/>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">cd /usr/obj/nanobsd.full</userinput> <co xml:id="nbsd-cd2"/>
<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">dd if=_.disk.full of=/dev/da0 bs=64k</userinput> <co xml:id="nbsd-dd"/></screen>

      <calloutlist xmlns:xlink="http://www.w3.org/1999/xlink">
	<callout arearefs="nbsd-cd">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Cambia el directorio actual por el directorio base del
	  script de generación
	  de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application>.</para>
	</callout>

	<callout arearefs="nbsd-sh">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Comienza el proceso de generación.</para>
	</callout>

	<callout arearefs="nbsd-cd2">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Cambia el directorio actual por el directorio donde se
        encuentra la imagen generada.</para>
	</callout>

	<callout arearefs="nbsd-dd">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Instala <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> dentro del
	    medio de almacenamiento.</para>
	</callout>
      </calloutlist>
    </sect2>

    <sect2 xmlns:xlink="http://www.w3.org/1999/xlink">
      <title xmlns:xlink="http://www.w3.org/1999/xlink">Personalización de una imagen de NanoBSD</title>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Esta es probablemente la característica más
        importante y más interesante
        de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application>. Tambié es donde
        usted pasará la mayor parte del tiempo cuando esté
        desarrollando con <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application>.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">La invocación del siguiente comando forzará
        al script <filename xmlns:xlink="http://www.w3.org/1999/xlink">nanobsd.sh</filename> a leer su
        configuración desde el
        fichero <filename xmlns:xlink="http://www.w3.org/1999/xlink">mi-configuracion.nano</filename> ubicado en el
        directorio actual:</para>

      <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">sh nanobsd.sh -c mi-configuracion.nano</userinput></screen>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">La personalización se hace de dos maneras:</para>

      <itemizedlist xmlns:xlink="http://www.w3.org/1999/xlink">
	<listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Opciones de configuración</para>
	</listitem>

	<listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	  <para xmlns:xlink="http://www.w3.org/1999/xlink">Funciones personalizadas</para>
	</listitem>
      </itemizedlist>

      <sect3 xmlns:xlink="http://www.w3.org/1999/xlink">
	<title xmlns:xlink="http://www.w3.org/1999/xlink">Opciones de configuración</title>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">Por medio de ajustes de configuración es posible
      configurar las opciones que se pasan a las
      fases <literal xmlns:xlink="http://www.w3.org/1999/xlink">buildworld</literal>
      e <literal xmlns:xlink="http://www.w3.org/1999/xlink">installworld</literal> del proceso de
      generación de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application>.
      Mediante estas opciones puede reducirse el tamaño del
      sistema de manera que pueda incluso encajar en algo tan
      pequeño como un dispositivo de 64MB.  Es posible recortar FreeBSD
      incluso más, hasta que consista únicamente
      en el kernel y dos o tres ficheros de
      <quote xmlns:xlink="http://www.w3.org/1999/xlink">userland</quote>.</para>

	<para xmlns:xlink="http://www.w3.org/1999/xlink">El fichero de configuración está compuesto por
	  opciones de configuración que sobreescriben los valores
	  por omisión.  Las directivas más importantes
	  son:</para>

	<itemizedlist xmlns:xlink="http://www.w3.org/1999/xlink">
	  <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink"><literal xmlns:xlink="http://www.w3.org/1999/xlink">NANO_NAME</literal> : Nombre de la
          generación que estamos ejecutando (se usa
	      para dar nombres a los directorios donde encontraremos el
          resultado del proceso).</para>
	  </listitem>

	  <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink"><literal xmlns:xlink="http://www.w3.org/1999/xlink">NANO_SRC</literal> : Ruta al código
	      fuente que se usará para generar la imagen.</para>
	  </listitem>

	  <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink"><literal xmlns:xlink="http://www.w3.org/1999/xlink">NANO_KERNEL</literal> : Nombre del fichero de
	      configuración del kernel que se usará para
	      generar el kernel.</para>
	  </listitem>

	  <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink"><literal xmlns:xlink="http://www.w3.org/1999/xlink">CONF_BUILD</literal> : Opciones que se pasan a
	      la fase <literal xmlns:xlink="http://www.w3.org/1999/xlink">buildworld</literal>.</para>
	  </listitem>

	  <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink"><literal xmlns:xlink="http://www.w3.org/1999/xlink">CONF_INSTALL</literal> : Opciones que se pasan a
	      la fase <literal xmlns:xlink="http://www.w3.org/1999/xlink">installworld</literal>.</para>
	  </listitem>

	  <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink"><literal xmlns:xlink="http://www.w3.org/1999/xlink">CONF_WORLD</literal> : Opciones que se pasan
	      tanto a <literal xmlns:xlink="http://www.w3.org/1999/xlink">buildworld</literal> como a
	      <literal xmlns:xlink="http://www.w3.org/1999/xlink">installworld</literal>.</para>
	  </listitem>

	  <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink"><literal xmlns:xlink="http://www.w3.org/1999/xlink">FlashDevice</literal> : Define el tipo de medio
	      de almacenamiento que se usará.  Para más
	      información consulte el
	      fichero <filename xmlns:xlink="http://www.w3.org/1999/xlink">FlashDevice.sub</filename>.</para>
	  </listitem>
	</itemizedlist>
      </sect3>

      <sect3 xmlns:xlink="http://www.w3.org/1999/xlink">
	<title xmlns:xlink="http://www.w3.org/1999/xlink">Funciones personalizadas</title>

	<para xmlns:xlink="http://www.w3.org/1999/xlink">Puede ajustar <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application>
	  de forma muy precisa mediante el uso de funciones de
	  shell en el fichero de configuración.  En el siguiente
	  ejemplo vemos un modelo básico de función
	  personalizada.</para>

	<programlisting xmlns:xlink="http://www.w3.org/1999/xlink">cust_foo () (
	echo "bar=topless" &gt; \
	  ${NANO_WORLDDIR}/etc/foo
)
customize_cmd cust_foo</programlisting>

    <para xmlns:xlink="http://www.w3.org/1999/xlink">A continuación vemos un ejemplo más útil
      de función personalizada, que cambia el tamaño por
      omisión del directorio
      <filename xmlns:xlink="http://www.w3.org/1999/xlink">/etc</filename> de 5MB a 30MB:</para>

	<programlisting xmlns:xlink="http://www.w3.org/1999/xlink">cust_etc_size () (
	cd ${NANO_WORLDDIR}/conf
	echo 30000 &gt; default/etc/md_size
)
customize_cmd cust_etc_size</programlisting>

	<para xmlns:xlink="http://www.w3.org/1999/xlink">Hay unas pocas funciones de personalización
      predefinidas listas para su uso:</para>

	<itemizedlist xmlns:xlink="http://www.w3.org/1999/xlink">
	  <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink"><literal xmlns:xlink="http://www.w3.org/1999/xlink">cust_comconsole</literal> : Deshabilita
	      <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">getty</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">8</manvolnum></citerefentry> en los dispositivos VGA (los nodos de
	      dispositivo <filename xmlns:xlink="http://www.w3.org/1999/xlink">/dev/tty*</filename>) y habilita el
	      uso del puerto serie COM1 para que sea la consola del
	      sistema.</para>
	  </listitem>

	  <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink"><literal xmlns:xlink="http://www.w3.org/1999/xlink">cust_allow_ssh_root</literal> : Permite a
	      <systemitem xmlns:xlink="http://www.w3.org/1999/xlink" class="username">root</systemitem> acceder a través de
	      <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">sshd</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">8</manvolnum></citerefentry>.</para>

	  </listitem>

	  <listitem xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink"><literal xmlns:xlink="http://www.w3.org/1999/xlink">cust_install_files</literal> : Instala ficheros
	      de configuración desde el
	      directorio <filename xmlns:xlink="http://www.w3.org/1999/xlink">nanobsd/files</filename>,
          que contiene scripts útiles para la
	      administración del sistema.</para>
	  </listitem>
	</itemizedlist>
      </sect3>

      <sect3 xmlns:xlink="http://www.w3.org/1999/xlink">
	<title xmlns:xlink="http://www.w3.org/1999/xlink">Cómo añadir paquetes</title>

	<para xmlns:xlink="http://www.w3.org/1999/xlink">Se pueden añadir paquetes a la imagen de
          <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> usando una función
          personalizada.  La siguiente función instalará
	  todos los paquetes que se encuentren en
          <filename xmlns:xlink="http://www.w3.org/1999/xlink">/usr/src/tools/tools/nanobsd/packages</filename>:
        </para>

	<programlisting xmlns:xlink="http://www.w3.org/1999/xlink">install_packages () (
    mkdir -p ${NANO_WORLDDIR}/packages
    cp /usr/src/tools/tools/nanobsd/packages/* ${NANO_WORLDDIR}/packages
    chroot ${NANO_WORLDDIR} sh -c 'cd packages; pkg_add -v *;cd ..;'
    rm -rf ${NANO_WORLDDIR}/packages
)
customize_cmd install_packages</programlisting>
      </sect3>

      <sect3 xmlns:xlink="http://www.w3.org/1999/xlink">
	<title xmlns:xlink="http://www.w3.org/1999/xlink">Ejemplo de fichero de configuración</title>

	<para xmlns:xlink="http://www.w3.org/1999/xlink">El siguiente es un ejemplo completo de fichero de
	  configuración para generar una imagen personalizada
	  de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application>:</para>

	<programlisting xmlns:xlink="http://www.w3.org/1999/xlink">NANO_NAME=custom
NANO_SRC=/usr/src
NANO_KERNEL=MYKERNEL
NANO_IMAGES=2

CONF_BUILD='
NO_KLDLOAD=YES
NO_NETGRAPH=YES
NO_PAM=YES
'

CONF_INSTALL='
NO_ACPI=YES
NO_BLUETOOTH=YES
NO_CVS=YES
NO_FORTRAN=YES
NO_HTML=YES
NO_LPR=YES
NO_MAN=YES
NO_SENDMAIL=YES
NO_SHAREDOCS=YES
NO_EXAMPLES=YES
NO_INSTALLLIB=YES
NO_CALENDAR=YES
NO_MISC=YES
NO_SHARE=YES
'

CONF_WORLD='
NO_BIND=YES
NO_MODULES=YES
NO_KERBEROS=YES
NO_GAMES=YES
NO_RESCUE=YES
NO_LOCALES=YES
NO_SYSCONS=YES
NO_INFO=YES
'

FlashDevice SanDisk 1G

cust_nobeastie() (
	touch ${NANO_WORLDDIR}/boot/loader.conf
	echo "beastie_disable=\"YES\"" &gt;&gt; ${NANO_WORLDDIR}/boot/loader.conf
)

customize_cmd cust_comconsole
customize_cmd cust_install_files
customize_cmd cust_allow_ssh_root
customize_cmd cust_nobeastie</programlisting>
      </sect3>
    </sect2>

    <sect2 xmlns:xlink="http://www.w3.org/1999/xlink">
      <title xmlns:xlink="http://www.w3.org/1999/xlink">Cómo actualizar NanoBSD</title>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">El proceso de actualización
        de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> es relativamente
        simple:</para>

      <procedure xmlns:xlink="http://www.w3.org/1999/xlink">
	    <step xmlns:xlink="http://www.w3.org/1999/xlink">
	      <para xmlns:xlink="http://www.w3.org/1999/xlink">Generar una nueva imagen
	        de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> de la forma
	        habitual.</para>
	    </step>

	    <step xmlns:xlink="http://www.w3.org/1999/xlink">
	      <para xmlns:xlink="http://www.w3.org/1999/xlink">Copiar la nueva imagen sobre la partición no
            	utilizada del sistema empotrado que está
            	usando <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application>.</para>

	      <para xmlns:xlink="http://www.w3.org/1999/xlink">La diferencia más importante entre este paso y
                la instalación inicial
            	de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> es que ahora en
            	lugar de usar el fichero <filename xmlns:xlink="http://www.w3.org/1999/xlink">_.disk.full</filename>
            	(que contiene una imagen de todo el disco) se instala
            	la imagen <filename xmlns:xlink="http://www.w3.org/1999/xlink">_.disk.image</filename> (que contiene
            	una imagen de una sola partición).</para>
	    </step>

	    <step xmlns:xlink="http://www.w3.org/1999/xlink">
	      <para xmlns:xlink="http://www.w3.org/1999/xlink">Reiniciar y arrancar el sistema desde la
            	partición que se acaba de instalar.</para>
	    </step>

	    <step xmlns:xlink="http://www.w3.org/1999/xlink">
	      <para xmlns:xlink="http://www.w3.org/1999/xlink">Si todo va bien la actualización ha
	        terminado.</para>
	    </step>

	    <step xmlns:xlink="http://www.w3.org/1999/xlink">
	      <para xmlns:xlink="http://www.w3.org/1999/xlink">Si algo va mal reinicie desde la partición
            	anterior (que contiene la imagen vieja, pero que
            	funciona) para recuperar el funcionamiento del
            	sistema lo antes posible.  Arregle los problemas
            	de la nueva generación y repita el proceso.</para>
	    </step>
      </procedure>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Para facilitar la instalación de una imagen
	nueva en su sistema <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> en
	funcionamiento dispone de los scripts <filename xmlns:xlink="http://www.w3.org/1999/xlink">updatep1</filename>
        y <filename xmlns:xlink="http://www.w3.org/1999/xlink">updatep2</filename>, ubicados en el directorio
        <filename xmlns:xlink="http://www.w3.org/1999/xlink">/root</filename>.  La
        elección de uno u otro script depende de qué
        partición esté ejecutando el sistema,
        la primera o la segunda.</para>

      <para xmlns:xlink="http://www.w3.org/1999/xlink">Dependiendo de los servicios disponibles en
        la máquina que va a servir la nueva imagen
        de <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> y del tipo de
        transferencia de datos que prefiera uno de estos tres
        métodos le resultará más o menos
	    interesante:</para>

      <sect3 xmlns:xlink="http://www.w3.org/1999/xlink">
	    <title xmlns:xlink="http://www.w3.org/1999/xlink">Uso de <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">ftp</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">1</manvolnum></citerefentry></title>

	    <para xmlns:xlink="http://www.w3.org/1999/xlink">Si la prioridad es la velocidad de la transferencia
              use usted este ejemplo:</para>

	    <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">ftp mi-maquina
get _.disk.image "| sh updatep1"</userinput></screen>
      </sect3>

      <sect3 xmlns:xlink="http://www.w3.org/1999/xlink">
	<title xmlns:xlink="http://www.w3.org/1999/xlink">Uso de <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">ssh</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">1</manvolnum></citerefentry></title>

	<para xmlns:xlink="http://www.w3.org/1999/xlink">Si la prioridad es la seguridad de la transferencia
          seguramente ejecutará algo muy parecido a lo
	  siguiente:</para>

	<screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">ssh mi-maquina cat _.disk.image.gz | zcat | sh updatep1</userinput></screen>
      </sect3>

      <sect3 xmlns:xlink="http://www.w3.org/1999/xlink">
	<title xmlns:xlink="http://www.w3.org/1999/xlink">Uso de <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">nc</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">1</manvolnum></citerefentry></title>

	<para xmlns:xlink="http://www.w3.org/1999/xlink">Si la máquina remota no dispone de servicios de
	  <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">ftp</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">1</manvolnum></citerefentry> ni de <citerefentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"><refentrytitle xmlns:xlink="http://www.w3.org/1999/xlink">sshd</refentrytitle><manvolnum xmlns:xlink="http://www.w3.org/1999/xlink">8</manvolnum></citerefentry> puede recurrir al siguiente
	  ejemplo:</para>

	<procedure xmlns:xlink="http://www.w3.org/1999/xlink">
	  <step xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink">Primero abra un puerto TCP de escucha en la
	      máquina que sirve la imagen y envíela
	      al cliente:</para>

	    <screen xmlns:xlink="http://www.w3.org/1999/xlink">mi-maquina<prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">nc -l 2222 &lt; _.disk.image</userinput></screen>

	    <note xmlns:xlink="http://www.w3.org/1999/xlink">
	      <para xmlns:xlink="http://www.w3.org/1999/xlink">Asegúrese de que el puerto elegido no tenga
                bloqueadas las conexiones entrantes desde la
                máquina <application xmlns:xlink="http://www.w3.org/1999/xlink">NanoBSD</application> por
	        ningún cortafuegos.</para>
 	    </note>
	  </step>

	  <step xmlns:xlink="http://www.w3.org/1999/xlink">
	    <para xmlns:xlink="http://www.w3.org/1999/xlink">Conéctese a la máquina que va servir la
	      nueva imagen y ejecute el script
          <filename xmlns:xlink="http://www.w3.org/1999/xlink">updatep1</filename>:</para>

	    <screen xmlns:xlink="http://www.w3.org/1999/xlink"><prompt xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">#</prompt> <userinput xmlns:xlink="http://www.w3.org/1999/xlink">nc mi-maquina 2222 | sh updatep1</userinput></screen>
	  </step>
	</procedure>
      </sect3>
    </sect2>
  </sect1>

  <index xmlns:xlink="http://www.w3.org/1999/xlink"/>
</article>
