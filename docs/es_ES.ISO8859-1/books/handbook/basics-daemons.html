<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>3.8. Dæmons, señales y cómo matar procesos</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manual de FreeBSD" /><link rel="up" href="basics.html" title="Capítulo 3. Conceptos básicos de Unix" /><link rel="prev" href="basics-processes.html" title="3.7. Procesos" /><link rel="next" href="shells.html" title="3.9. Shells" /><link rel="copyright" href="legalnotice.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3.8. Dæmons, señales y cómo matar procesos</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="basics-processes.html">Anterior</a> </td><th width="60%" align="center">Capítulo 3. Conceptos básicos de Unix</th><td width="20%" align="right"> <a accesskey="n" href="shells.html">Siguiente</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="basics-daemons"></a>3.8. Dæmons, señales y cómo matar procesos</h2></div></div></div><p>cuando ejecuta un editor es fácil controlarlo,
      decirle que cargue ficheros y demás.  Puede hacerse
      porque el editor permite ese control y porque el editor
      depende de una <em class="firstterm">terminal</em>.  Algunos
      programas no están diseñados para ejecutarse
      entradas continuas por parte del usuario, así que se desconectan
      de la terminal a la primera oportunidad.  Por ejemplo, un servidor
      web pasa todo el dia respondiendo peticiones web y normalmente
      no necesita que usted le haga caso.  Los programas que transportan
      correo electrónico de un sitio a otro son otro ejemplo de
      esta clase de aplicación.</p><p>Llamamos a estos programas <em class="firstterm">dæmons</em>.
      Los Dæmons eran personajes de la mitología griega;
      no eran ni buenos ni malos, eran pequeños espíritus
      sirvientes que, en gran medida, hacían cosas útiles por
      la humanidad. Algo muy parecido a cómo los servidores web y
      los servidores de correo hacen hoy día tantas cosas
      útiles para nosotros.  Por eso, desde hace mucho tiempo la
      mascota de BSD es ese dæmon de aspecto tan ufano con su tridente
      y su cómodo calzado deportivo.</p><p>Hay una norma según la cual se da nombre a los programas que
      suelen ejecutarse como dæmons con una «d» final.
      <span class="application">BIND</span> es el dæmon de nombres de
      Berkeley (y el programa que en realidad se ejecuta se llama
      <code class="command">named</code>); el servidor web
      <span class="application">Apache</span> se llama
      <code class="command">httpd</code>, el dæmon de «spool» de
      impresora de línea es <code class="command">lpd</code> y así
      sucesivamente.  Se trata de un acuerdo,  no una ley férrea; por
      ejemplo el dæmon principal de correo de
      <span class="application">Sendmail</span> se llama
      <code class="command">sendmail</code>, y no <code class="command">maild</code>,
      como podría suponerse visto lo precedente.</p><p>Algunas veces necesitará comunicarse con un dæmon.
      Estas comunicaciones se denominan <em class="firstterm">señales</em>;
      es posible comunicarse con un dæmon (o con cualquier otro proceso
      ejecutándose) mandándole una señal.  Existen
      diversos tipos de señales diferentes que puede mandar: algunas
      tienen un significado especial, otras son interpretadas por
      la aplicación y la documentación de la aplicación
      le dirá cómo interpreta la señal esa
      aplicación).  Solamente puede enviar una señal a un
      del que sea usted propietario.  Si manda una señal a un proceso
      de otro usuario con <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> o <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">kill</span>(2)</span></a> verá un mensaje
      del sistema en el que se le comunica que no tiene permiso para hacer
      tal cosa.  La excepción a esto es el usuario
      <code class="systemitem">root</code>, que puede mandar señales a los
      procesos de cualquier usuario del sistema.</p><p>FreeBSD también enviará señales de
      aplicación en determinados casos.  Si una aplicación
      está mal escrita y trata de acceder a  memoria a la que no
      está previsto que acceda FreeBSD manda al proceso la señal
      <em class="firstterm">Violación de segmento</em>
      (<code class="literal">SIGSEGV</code>).  Si una aplicación ha utilizado
      la llamada de sistema <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=alarm&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">alarm</span>(3)</span></a> para ser avisada después
      de que un periodo de tiempo haya transcurrido se le
      mandará la señal de alarma (<code class="literal">SIGALRM</code>),
      y así sucesivamente.</p><p>Hay dos señales que pueden usarse para detener un proceso,
      <code class="literal">SIGTERM</code> y <code class="literal">SIGKILL</code>.
      <code class="literal">SIGTERM</code> es la manera amable de matar un proceso;
      el proceso puede <span class="emphasis"><em>recibir</em></span> la señal,
      darse cuenta que usted quiere que se apague, cerrar cualquier
      fichero de log que pueda tener abierto y generalmente terminar
      cualquier tarea que esté realizando en ese momento antes
      de apagarse.  En algunos casos un proceso puede incluso ignorar
      <code class="literal">SIGTERM</code> si se encuentra inmerso en una
      tarea que no puede ser interrumpida.</p><p>Por el contrario, un proceso no puede ignorar una señal
    <code class="literal">SIGKILL</code>.
      Esta es la señal «No me importa lo que estás
      haciendo, detente ahora mismo».  Si manda un
      <code class="literal">SIGKILL</code> a un proceso FreeBSD detendrá ese
      proceso inmediatamente.<a href="#ftn.idp69671888" class="footnote" id="idp69671888"><sup class="footnote">[4]</sup></a>.</p><p>Otras señales que puede usar:
      <code class="literal">SIGHUP</code>, <code class="literal">SIGUSR1</code> y
      <code class="literal">SIGUSR2</code>.  Son señales de propósito
      general, y aplicaciones diferentes pueden hacer cosas diferentes
      cuando se utilicen.</p><p>Suponga que ha cambiado el fichero de configuración de su
      servidor web; es un buen momento para decirle al servidor
      web que lea y aplique la  configuración.  Podría detener y
      reiniciar <code class="command">httpd</code>, pero esto implicaría
      un período breve de suspensión del servicio de su
      servidor web, lo cual puede no ser asumible.  La mayoría de
      los dæmons fueron creados pensando en que fueran capaces de
      responder a la señal
      <code class="literal">SIGHUP</code> releyendo su fichero de configuración.
      En lugar de matar y reiniciar <code class="command">httpd</code>
      le podría mandar la  señal <code class="literal">SIGHUP</code>.
      Dado que no hay una manera estándar para responder a estas
      señales, diferentes dæmons tendrán diferente
      comportamiento, así que asegúrese de leer la
      documentación del dæmon en cuestión.</p><p>Las señales se envian mediante <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a>,
      como puede verse en el siguiente ejemplo.</p><div class="procedure"><a id="idp69677520"></a><div class="procedure-title">Procedimiento 3.1. Envío de una señal a un proceso</div><p>Este ejemplo muestra como enviar una señal a
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a>.  El fichero de configuración de
        <code class="command">inetd</code> es
        <code class="filename">/etc/inetd.conf</code> e <code class="command">inetd</code>
        releerá dicho fichero de configuración cuando
        se le envíe un <code class="literal">SIGHUP</code>.</p><ol class="procedure" type="1"><li class="step"><p>Identifique el ID de proceso del proceso al que quiere
          enviarle la señal mediante <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ps&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ps</span>(1)</span></a> y
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=grep&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">grep</span>(1)</span></a>.  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=grep&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">grep</span>(1)</span></a> se usa para buscar cadenas de
          texto de su elección en la salida estándar.
          Puede ejecutarse como un usuario normal, mientras que
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> se ejecuta como <code class="systemitem">root</code>,
          así que debe pasarle los parámetros
          <code class="option">ax</code> a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ps&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ps</span>(1)</span></a>.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ps -ax | grep inetd</code></strong>
  198  ??  IWs    0:00.00 inetd -wW</pre><p>Vemos que el PID de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> es 198.  En algunos casos
          <code class="literal">grep inetd</code> también
          puede aparecer en esta salida.  Esto se debe a la manera en que
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ps&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ps</span>(1)</span></a> tiene que encontrar la lista de procesos
          ejecutándose.</p></li><li class="step"><p>Utilice <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> para enviar la señal.  Debido a que
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> está siendo ejecutado po
          <code class="systemitem">root</code> tendrá que usar primero
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=su&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">su</span>(1)</span></a> para volverse <code class="systemitem">root</code>.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>su</code></strong>
<code class="prompt">Password:</code>
<code class="prompt">#</code> <strong class="userinput"><code>/bin/kill -s HUP 198</code></strong></pre><p>Del mismo modo que la mayoría de órdenes <span class="trademark">UNIX</span>®
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> no imprimirá ninguna salida si ha funcionado
          bien.
          Si envía una señal a un proceso del que no es
          el propietario verá lo siguiente: <span class="errorname">kill:
          <em class="replaceable"><code>PID</code></em>: Operation not permitted</span>.
          Si no teclea bien el PID puede enviar la señal a un
          proceso equivocado, lo cual puede ser malo, o si tiene suerte,
          habrá enviado la señal a un proceso que no está
          en uso y verá el sistema le dir´ <span class="errorname">kill:
          <em class="replaceable"><code>PID</code></em>: No such process</span>.</p><div xmlns="" class="note"><h3 class="admontitle">¿Por qué utilizar <code xmlns="http://www.w3.org/1999/xhtml" class="command">/bin/kill</code>?: </h3><p xmlns="http://www.w3.org/1999/xhtml">Muchas shells incorporan su propio <code class="command">kill</code>;
            esto es, el shell mandará la señal directamente,
            en lugar de ejecutar
            <code class="filename">/bin/kill</code>.  Esto puede ser útil
            pero las diferentes shells tienen diferentes sintaxis para
            especificar el nombre de la señal que envían.  En
            lugar de tratar de aprederse todas ellas, es más
            fácil simplemente usar
            <code class="command">/bin/kill ...</code>
            sea la que sea la shell que prefiera usar.</p></div></li></ol></div><p>El envío de otras señales es muy similar;
      sustituya <code class="literal">TERM</code> o <code class="literal">KILL</code>
      en la línea de órdenes según sea necesario.</p><div xmlns="" class="important"><h3 class="admontitle">Importante: </h3><p xmlns="http://www.w3.org/1999/xhtml">Matar procesos aleatorios en el sistema es una mala
        idea.  En particular, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=init&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">init</span>(8)</span></a>, ID de proceso 1, es muy
        especial.  Ejecutar <code class="command">/bin/kill -s KILL 1</code> es
        una manera rápida de apagar su sistema.
        <span class="emphasis"><em>Siempre</em></span> revise dos veces los argumentos con
        los que ejecuta <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> <span class="emphasis"><em>antes</em></span>
	de pulsar <span class="keycap"><strong>Intro</strong></span>.</p></div><div class="footnotes"><br /><hr class="footnote-hr" /><div id="ftn.idp69671888" class="footnote"><p><a href="#idp69671888" class="para"><sup class="para">[4] </sup></a>Esto no es del todo cierto (ciertas cosas no pueden
        ser interrumpidas.  Por ejemplo, si el proceso está tratando
        de leer desde un fichero que está en otro sistema de
        la red, y el otro sistema no está disponible por
        alguna razón (por estar apagada, o que la red tenga un fallo),
        tenemos un caso de lo que llamamos
        «proceso ininterrumpible».
        Más tarde, al proceso se le acabará el tiempo de
        espera, generalmente pasados dos minutos.  Tan pronto como esto
        ocurra el proceso será liquidado.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="basics-processes.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="basics.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="shells.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">3.7. Procesos </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 3.9. Shells</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>