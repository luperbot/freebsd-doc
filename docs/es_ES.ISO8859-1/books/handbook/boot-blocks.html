<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>12.3. El RMA y las etapas de arranque uno, dos y tres</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manual de FreeBSD" /><link rel="up" href="boot.html" title="Capítulo 12. El proceso de arranque en FreeBSD" /><link rel="prev" href="boot-introduction.html" title="12.2. El problema que representa arrancar el sistema" /><link rel="next" href="boot-kernel.html" title="12.4. Interacción con el kernel durante el arranque" /><link rel="copyright" href="legalnotice.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">12.3. El RMA y las etapas de arranque uno, dos y tres</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="boot-introduction.html">Anterior</a> </td><th width="60%" align="center">Capítulo 12. El proceso de arranque en FreeBSD</th><td width="20%" align="right"> <a accesskey="n" href="boot-kernel.html">Siguiente</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="boot-blocks"></a>12.3. El RMA y las etapas de arranque uno, dos y tres</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-boot0"></a>12.3.1. RMA, <code class="filename">/boot/boot0</code></h3></div></div></div><a id="idp74403408" class="indexterm"></a><p>El RMA de FreeBSD, se localiza en <code class="filename">/boot/boot0</code>.
        Este es una <span class="emphasis"><em>copia</em></span> del RMA, ya que el RMA real
        debe localizarse en una parte especial del disco duro, fuera de la
        área de FreeBSD.</p><p>El fichero <code class="filename">boot0</code> es muy simple, dado que el
        programa en el <abbr class="abbrev">RMA</abbr> sólo puede ser de 512 bytes.
        Si usted ha instalado el RMA de FreeBSD y ha instalado varios sistemas
        operativos en sus discos duros, entonces al momento de arrancar el
        sistema, visualizará una pantalla similar a la siguiente.</p><div class="example"><a id="boot-boot0-example"></a><div class="example-title">Ejemplo 12.1. Pantalla <code class="filename">boot0</code></div><div class="example-contents"><pre class="screen">F1 DOS
F2 FreeBSD
F3 Linux
F4 ??
F5 Drive 1

Default: F2</pre></div></div><br class="example-break" /><p>Es sabido que otros sistemas, en particular Windows 95, sobreescriben
        el RMA con el suyo.  Si esto le sucede, o bien desea reemplazar su RMA
        actual con el RMA de FreeBSD, entonces puede utilizar las siguientes
        órdenes.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>fdisk -B -b /boot/boot0 dispositivo</code></strong></pre><p>Donde <em class="replaceable"><code>dispositivo</code></em> es aquel, desde el
        cual usted pretende arrancar el sistema, tal como
        <code class="filename">ad0</code> para el disco conectado al primer IDE,
        <code class="filename">ad2</code> para el disco maestro conectado al IDE
        secundario, <code class="filename">da0</code> para el primer disco SCSI, y
        así sucesivamente.</p><p>Por otro lado, si usted es un usuario de Linux, y prefiere que
        la aplicación <span class="application">LILO</span> controle el
        proceso de arranque, puede editar el fichero
        <code class="filename">/etc/lilo.conf</code> para incluir a FreeBSD, o bien
        seleccionar la opción
        <code class="option">Leave The Master Boot Record Untouched</code> durante
        el proceso de instalación.  Si ha instalado el gestor de
        arranque de FreeBSD, puede arrancar Linux y modificar el fichero
        de configuración de <span class="application">LILO</span>,
        <code class="filename">/etc/lilo.conf</code>, añadiendo la
        siguiente opción:</p><pre class="programlisting">other=/dev/hdXY
table=/dev/hdb
loader=/boot/chain.b
label=FreeBSD</pre><p>lo que permitirá el arranque de FreeBSD y Linux, por
        medio de <span class="application">LILO</span>.  En nuestro ejemplo
        hemos utilizado <em class="replaceable"><code>XY</code></em> para especificar
        el disco utilizado y su partición.  Si usted utiliza un
        sistema <acronym class="acronym">SCSI</acronym>, deberá cambiar
        <em class="replaceable"><code>/dev/hdXY</code></em> por algo similar a
        <em class="replaceable"><code>/dev/sdXY</code></em>, que nuevamente utiliza
        la sintáxis <em class="replaceable"><code>XY</code></em>.  La opción
        <code class="option">loader=/boot/chain.b</code> puede omitirse si usted
        cuenta con ambos sistemas operativos en el mismo disco.  Una vez
        que esto se ha completado, puede ejecutar
        <code class="command">/sbin/lilo -v</code> para que se actualicen los cambios
        en el sistema, lo cual deberá verificarse con los
        mensajes que aparezcan en pantalla.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">N de T: La opción mencionada como;
	    <code class="option">Leave The Master Boot Record Untouched</code>, se
	    mostrará <span class="quote">&#8220;<span class="quote">tal cual</span>&#8221;</span> aparece en este
	    documento, una vez que ha terminado la fase de
	    partición del disco duro.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-boot1"></a>12.3.2. Etapa uno, <code class="filename">/boot/boot1</code>, y etapa dos,
	<code class="filename">/boot/boot2</code></h3></div></div></div><p>Conceptualmente las estapas uno y dos, son parte del mismo
        programa, en la misma área del disco.  Por cuestiones de
        espacio se han dividido en dos, pero estas siempre se instalaran
        de manera conjunta.</p><p>Estas son localizadas en el sector de arranque, de la
        partición de arranque, que es donde <a class="link" href="boot-blocks.html#boot-boot0" title="12.3.1. RMA, /boot/boot0">boot0</a>, o cualquier otro programa
        del <abbr class="abbrev">RMA</abbr> espera encontrar el programa que
        dará continuación al proceso de arranque.  Los
        ficheros localizados bajo el directorio <code class="filename">/boot</code>
        son copias de los ficheros reales, que se localizan fuera del
        sistema de ficheros de FreeBSD.</p><p>El fichero <code class="filename">boot1</code> es muy simple, en virtud
        de que sólo puede tener un tamaño de 512 bytes, y
        conocer simplemente del etiquetador de discos de FreeBSD
        (<em class="firstterm">disklabel</em>), el cual almacena la
        información de las particiones, para efecto de localizar
        y ejecutar <code class="filename">boot2</code>.</p><p>El fichero <code class="filename">boot2</code> es un poco más
        sofisticado, y comprende lo suficiente del sistema de ficheros de
        FreeBSD como para localizar ficheros en el, y puede proveer una
        interfaz simple, para seleccionar el kernel o cargador que
        deberá ejecutarse.</p><p>En virtud de que el <a class="link" href="boot-blocks.html#boot-loader" title="12.3.3. Etapa tres, /boot/loader (cargador de arranque)">cargador</a>
        (loader) es mucho más sofisticado, y provee una
        configuración de arranque más sencilla de utilizar,
        <code class="filename">boot2</code> la ejecuta normalmente, una vez que ha
        terminado de solicitar el arranque del kernel directamente.</p><div class="example"><a id="boot-boot2-example"></a><div class="example-title">Ejemplo 12.2. Pantalla de <code class="filename">boot2</code></div><div class="example-contents"><pre class="screen">&gt;&gt; FreeBSD/i386 BOOT
Default: 0:ad(0,a)/kernel
boot:</pre></div></div><br class="example-break" /><p>Si alguna vez requiere reemplazar los ficheros
	    <code class="filename">boot1</code> y <code class="filename">boot2</code>
	    instalados, utilice <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=disklabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">disklabel</span>(8)</span></a>.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>disklabel -B partición</code></strong></pre><p>Donde <em class="replaceable"><code>partición</code></em> es el disco
        y partición del cual pretende arrancar el sistema, tal como
        <code class="filename">ad0s1</code> para la primer partición del
        disco Mastro&#8212;Primario.</p><div xmlns="" class="warning"><h3 class="admontitle">Modo peligrosamente dedicado: </h3><p xmlns="http://www.w3.org/1999/xhtml">Si sólo utiliza el nombre del disco, tal como
	  <code class="filename">ad0</code>, al usar <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=disklabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">disklabel</span>(8)</span></a>
	  creará un disco peligrosamente dedicado, sin partición
	  alguna.  Seguramente esto no es lo que desea hacer, así que
	  asegurese dos veces antes de presionar la tecla <span class="keycap"><strong>Return</strong></span>
	  cuando utilice <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=disklabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">disklabel</span>(8)</span></a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-loader"></a>12.3.3. Etapa tres, <code class="filename">/boot/loader</code> (cargador de arranque)</h3></div></div></div><a id="idp74461264" class="indexterm"></a><p>El cargador es la etapa final de las tres etapas del mecanismo
      de arranque, y esta localizado en el sistema de ficheros, normalmente
      como <code class="filename">/boot/loader</code>.</p><p>El cargador pretende ser un metodo amistoso de
      configuración, utilizando una serie de órdenes integradas
      de fácil uso, respaldado por un intérprete más
      poderoso, con una serie de órdenes de mayor complejidad.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-loader-flow"></a>12.3.3.1. Flujo del programa cargador</h4></div></div></div><p>Durante la inicialización del sistema, el cargador
        hará una comprobación en busca de una
        consola y discos, y sabra de que disco se encuentra
        arrancando.  Establecerá las variables necesarias, y
        posteriormente es iniciado el intérprete donde se
        pueden introducir órdenes desde un <span class="quote">&#8220;<span class="quote">script</span>&#8221;</span> o de
        manera interactiva.</p><a id="idp74464592" class="indexterm"></a><a id="idp74465104" class="indexterm"></a><p>Posteriormente el cargador leerá el fichero
        <code class="filename">/boot/loader.rc</code>, que por default lee
        la información del fichero
        <code class="filename">/boot/defaults/loader.conf</code> que a su
        vez, establece las variables correspondientes y verifica en
        el fichero <code class="filename">/boot/loader.conf</code> los cambios
        locales que se hayan hecho, para establecer valores de las
        variables modificadas.  Una vez llevado a cabo esto,
        <code class="filename">loader.rc</code> actua sobre estas variables,
        cargando cualquier módulo y kernel seleccionado.</p><p>Finalmente, y por default, el cargador hace una pausa contando
        10 segundos y en espera de que al presionar una tecla se
        interrumpa el proceso, de no ser así, procederá a
        arrancar el kernel.  En el caso de que al hacer esta pausa, se haya
        presionado una tecla (diferente de <span class="keycap"><strong>Return</strong></span>), el
        proceso será interrumpido y se nos mostrará un
        <span class="quote">&#8220;<span class="quote">prompt</span>&#8221;</span>, que entiende el conjunto de órdenes
        de fácil-uso, y donde el usuario puede ajustar
        ciertas variables, cargar y descargar todos los módulos, y
        también arrancar o reiniciar el sistema.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-loader-commands"></a>12.3.3.2. Órdenes internas del cargador</h4></div></div></div><p>A continuación se presentan las órdenes más
        comunes del cargador.  Para ver una descripción detallada
        de los mismos, por favor consulte la página de manual de
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=loader&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">loader</span>(8)</span></a></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">autoboot <em class="replaceable"><code>segundos</code></em></span></dt><dd><p>Procede a iniciar el arranque del sistema, si es que
	      no es interrumpido el periodo dado, en segundos.  Despliega
	      una cuenta regresiva, y el tiempo dado es de 10 segundos.</p></dd><dt><span class="term">boot
	    [<span class="optional">-opciones</span>]
	    [<span class="optional">nombre_del_kernel</span>]</span></dt><dd><p>Procede a iniciar el kernel de manera inmediata, con
	      las opciones dadas, si es que fuera el caso y el kernel
	      especificado, si es que se especifica alguno.</p></dd><dt><span class="term">boot-conf</span></dt><dd><p>Rehace la configuración automática de
	      modulos en función a las variables definidas, como
	      sucede al arrancar.  Esta opción sólo tiene
	      sentido utilizarla, si en primer lugar hemos usado
	      <code class="command">unload</code>, y hemos modificado alguna
	      variable, siendo lo más común el
	      <code class="envar">kernel</code>.</p></dd><dt><span class="term">help
	    [<span class="optional">tema</span>]</span></dt><dd><p>Muestra la ayuda de un tema específico, que lee
	      del fichero <code class="filename">/boot/loader.help</code>.  Si el
	      tema que se indica es <code class="literal">index</code>, entonces se
	      mostrará una lista de todos los temas disponibles.</p></dd><dt><span class="term">include <em class="replaceable"><code>fichero</code></em>
	    &#8230;</span></dt><dd><p>Procesa el fichero que se ha especificado.
	      El fichero se lee e interpreta
	      línea por línea.  Cualquier
	      error detendrá inmediatamente a include.</p></dd><dt><span class="term">load [<span class="optional">-t
	    tipo</span>]
	    <em class="replaceable"><code>fichero</code></em></span></dt><dd><p>Carga el kernel, modulo del kernel, o el fichero
	      del tipo dado, en base al fichero especificado.  Cualquier
	      argumento que se añada, será pasado al
	      fichero.</p></dd><dt><span class="term">ls [<span class="optional">-l</span>]
	    [<span class="optional">ruta</span>]</span></dt><dd><p>Despliega un listado de todos los ficheros que se
	      localizan en la ruta especificada, o en el directorio
	      raíz, si es que no se le especifica ruta alguna.  Si
	      se utiliza la opción <code class="option">-l</code>, también
	      se mostrara el tamaño de los ficheros.</p></dd><dt><span class="term">lsdev [<span class="optional">-v</span>]</span></dt><dd><p>Nos muestra una lista de todos los dispositivos desde
	      los cuales puede ser posible cargar modulos.  Si se
	      incluye la opción <code class="option">-v</code>, el listado
	      que se obtiene cuenta con más detalle.</p></dd><dt><span class="term">lsmod [<span class="optional">-v</span>]</span></dt><dd><p>Despliega los módulos cargados. Si se utiliza la
	      opción <code class="option">-v</code>, se mostraran más
	      detalles.</p></dd><dt><span class="term">more <em class="replaceable"><code>fichero</code></em></span></dt><dd><p>Despliega el contenido del fichero especificado, haciendo
	      una pausa a cada numero determinado de <code class="varname">LINEAS</code>
	      mostradas.</p></dd><dt><span class="term">reboot</span></dt><dd><p>Reinicia el sistema de forma inmediata.</p></dd><dt><span class="term">set <em class="replaceable"><code>variable</code></em>, </span><span class="term">set
	    <em class="replaceable"><code>variable</code></em>=<em class="replaceable"><code>valor</code></em></span></dt><dd><p>Especifica los valores de las variables de entorno del
	      cargador.</p></dd><dt><span class="term">unload</span></dt><dd><p>Remueve todos los módulos cargados.</p></dd></dl></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-loader-examples"></a>12.3.3.3. Ejemplos de uso del cargador</h4></div></div></div><p>He aqui unos ejemplos prácticos sobre el uso
        correcto del cargador.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a id="idp74509648" class="indexterm"></a><p>Para arrancar simplemente su kernel usual, pero en modo
	    mono-usuario, deberá hacer lo siguiente:</p><pre class="screen"><strong class="userinput"><code>boot -s</code></strong></pre></li><li class="listitem"><p>Para descargar su kernel usual y sus módulos
	    correspondientes, y posteriormente cargar su kernel anterior
	    (o cualquier otro):</p><a id="idp74511952" class="indexterm"></a><pre class="screen"><strong class="userinput"><code>unload</code></strong>
<strong class="userinput"><code>load kernel.old</code></strong></pre><p>Puede utilizar <code class="filename">kernel.GENERIC</code> para
	    referirse al kernel generico actual que viene con la
	    instalación, o bien puede utilizar
	    <code class="filename">kernel.old</code> para hacer referencia al
	    kernel anterior (por ejemplo, cuando ha actualizado su
	    sistema o ha recompilado su propio kernel).</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Utilice lo siguiente para cargar sus módulos
	      actuales con otro kernel:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><strong class="userinput"><code>unload</code></strong>
<strong class="userinput"><code>set kernel="kernel.old"</code></strong>
<strong class="userinput"><code>boot-conf</code></strong></pre></div></li><li class="listitem"><p>Para cargar un escrito de configuración (script que
	    de forma automática hará todo lo que normalmente
	    hace usted de forma manual al momento de ejecutarse el
	    configurador de arranque):</p><pre class="screen"><strong class="userinput"><code>load -t escrito_de_configuración /boot/kernel.conf</code></strong></pre></li></ul></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="boot-introduction.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="boot.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="boot-kernel.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">12.2. El problema que representa arrancar el sistema </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 12.4. Interacción con el kernel durante el arranque</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>