<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>27.6. Conceptos Avanzados</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manual de FreeBSD" /><link rel="up" href="mail.html" title="Capítulo 27. Correo Electrónico" /><link rel="prev" href="mail-trouble.html" title="27.5. Depuración de Problemas" /><link rel="next" href="SMTP-UUCP.html" title="27.7. SMTP con UUCP" /><link rel="copyright" href="legalnotice.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">27.6. Conceptos Avanzados</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mail-trouble.html">Anterior</a> </td><th width="60%" align="center">Capítulo 27. Correo Electrónico</th><td width="20%" align="right"> <a accesskey="n" href="SMTP-UUCP.html">Siguiente</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mail-advanced"></a>27.6. Conceptos Avanzados</h2></div></div></div><p>La siguiente sección trata conceptos más
      específicos relacionados con la configuración del correo
      y la implantación del servicio de correo en una
      organización.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mail-config"></a>27.6.1. Configuración Básica</h3></div></div></div><a id="idp81331280" class="indexterm"></a><p>Por defecto debemos ser capaces de enviar correo a máquinas
        externas, siempre y cuando tengamos nuestro <code class="filename">
	/etc/resolv.conf</code> bien configurado o ejecutemos nuestro
        propio servidor de nombres.  Si queremos que el correo para nuestra
        máquina se nos entregue en nuestra propia máquina,
        es decir, a nuestro propio <span class="application">sendmail</span>,
        en lugar de tener que ir a recogerlo al servidor de correo de
        nuestra organización, podemos usar dos métodos:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Ejecutar nuestro propio servidor de nombres y comprar nuestro
            propio dominio.  Por ejemplo <code class="systemitem">FreeBSD.org</code></p></li><li class="listitem"><p>Conseguir la entrega de correo directa hacia nuestra
            máquina.  Esto se logra entregando el correo a la
            dirección IP que se asocia al nombre de DNS de nuestra
            máquina.  Por ejemplo <code class="systemitem">ejemplo.FreeBSD.org</code>.</p></li></ul></div><a id="idp81336400" class="indexterm"></a><p>Independientemente de la opción elegida para tener entrega
        directa en nuestra máquina debemos poseer una dirección
        IP estática (a diferencia de las direcciones dinámicas,
        que son utilizadas en configuraciones donde se utiliza el protocolo
        PPP).  Si nos encontramos detrás de un cortafuegos se debe
        permitir el tráfico SMTP (puerto 25) hacia nuestra
        máquina. Si además queremos recibir correo directamente
        en nuestra máquina se deben cumplir los siguientes
       requisitos:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Asegurar que el registro MX<a id="idp81338064" class="indexterm"></a> de menor numeración de
            nuestro DNS apunta a la dirección IP de nuestra
            máquina.</p></li><li class="listitem"><p>Asegurar que no existe ninguna entrada MX en nuestro DNS para
           nuestra máquina.  Es decir, mientras que el registro MX del
           punto anterior hace referencia al dominio administrativo que
           gestionamos con nuestro servidor de nombres, en este apartado se
           quiere destacar que no debe existir ningún registro MX
           específico para el nombre concreto de nuestra
           máquina.</p></li></ul></div><p>Cumpliendo las dos puntualizaciones anteriores podemos recibir
        correo electrónico mediante entrega directa en nuestra
        máquina.</p><p>Por ejemplo:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>hostname</code></strong>
ejemplo.FreeBSD.org
<code class="prompt">#</code> <strong class="userinput"><code>host ejemplo.FreeBSD.org</code></strong>
ejemplo.FreeBSD.org has address 204.216.27.XX</pre><p>Si se observa esta configuración la entrega directa de
        correo para <code class="email">&lt;<a xmlns="" class="email" href="mailto:su_login@ejemplo.FreeBSD.org">su_login@ejemplo.FreeBSD.org</a>&gt;</code> debería
        funcionar sin problemas (suponiendo que <span class="application">
        sendmail</span> se está ejecutando correctamente en
        <code class="systemitem">ejemplo.FreeBSD.org</code>).</p><p>Si en lugar de lo anterior ve algo como esto:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>host ejemplo.FreeBSD.org</code></strong>
ejemplo.FreeBSD.org has address 204.216.27.XX
ejemplo.FreeBSD.org mail is handled (pri=10) by hub.FreeBSD.org</pre><p>Todos los correos enviados a nuestro host (<code class="systemitem">ejemplo.FreeBSD.org</code>) serán recogidos por
	<code class="systemitem">hub</code> bajo el mismo nombre de usuario en lugar de ser
        enviados directamente a nuestra máquina.</p><p>La información anterior se gestiona utilizando el servidor
        de DNS. El registro de DNS que transporta la información
        de encaminamiento de correo eletrónico es el
        registro <span class="emphasis"><em>M</em></span>ail e<span class="emphasis"><em>X</em></span>change.
        Si no existe ningún registro MX el correo se entregará
        a la dirección IP que se obtenga de resolver el nombre
        de dominio que se encuentre a continuación del nombre de
        usuario en la dirección de correo de destino (esto es,
        (después de la @).</p><p>En un cierto momento la entrada MX para <code class="systemitem">freefall.FreeBSD.org</code> tenía este
        aspecto:</p><pre class="programlisting">freefall		MX	30	mail.crl.net
freefall		MX	40	agora.rdrop.com
freefall		MX	10	freefall.FreeBSD.org
freefall		MX	20	who.cdrom.com</pre><p>Como se puede observar, <code class="systemitem">freefall</code> tenía
        varias entradas MX.  El número de MX más bajo es la
        máquina que recibe correo directamente si se encuentra
        disponible; si dicha máquina no está accesible por
        algún motivo las otras máquinas (llamadas también
        <span class="quote">&#8220;<span class="quote">MXs de backup</span>&#8221;</span>) aceptarán los mensajes
        temporalmente, y los transmitirán de nuevo cuando alguna
        máquina perteneciente a alguna entrada MX de numeración
        más baja se encuentre disponible y el proceso se
        repetirá hasta que se alcance la máquina que tenga
        el registro MX más bajo.</p><p>Las organizaciones donde residen los servidores (MX) de backup
        deberían poseer acceso a internet de una forma independiente
        para minimizar el riesgo de pérdida de conectividad.  Nuestro
        ISP o cualquier otra organización independiente debería
        poder proporcionarnos este servicio sin problemas.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mail-domain"></a>27.6.2. Correo para Nuestro Dominio</h3></div></div></div><p>Para establecer un <span class="quote">&#8220;<span class="quote">mailhost</span>&#8221;</span> (servidor de correo)
        en nuestra organización debemos ser capaces de redirigir el
        correo destinado a cualquier máquina de nuestra
        organización hacia nuestro servidor de correo.
        Básicamente queremos <span class="quote">&#8220;<span class="quote">reclamar</span>&#8221;</span> como nuestro
        cualquier correo destinado a cualquier máquina de nuestro
        dominio (en este caso <code class="systemitem">*.FreeBSD.org</code>) y desviarlo a nuestro servidor
        de tal forma que los usuario lean su correo
        utilizando nuestra máquina servidora.</p><a id="idp81361872" class="indexterm"></a><p>Para hacer las cosas lo más sencillas posible se debe crear
        una cuenta de usuario (con el mismo <span class="emphasis"><em>
        nombre de usuario</em></span>) tanto en el servidor de correo como en
        la máquina del usuario o destinatario final del correo.
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=adduser&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">adduser</span>(8)</span></a> puede usarse para ello.</p><p>El servidor de correo debe funcionar como el agente de transporte
        predeterminado para todas las máquinas de nuestra
        organización.  Esto se realiza mediante la siguiente
        configuración del DNS:</p><pre class="programlisting">ejemplo.FreeBSD.org	A	204.216.27.XX		; Workstation
			MX	10 hub.FreeBSD.org	; Mailhost</pre><p>Esta configuración redirigirá el correo para
        cualquier estación de trabajo hacia nuestro servidor de correo
        sin que tengan importancia las direcciones IP asignadas mediante
        el registro de tipo A.  Recordemos que el correo siempre
        se encamina utilizando primero los registros de tipo MX.</p><p>Normalmente no podremos realizar esta configuración salvo
        que estemos ejecutando nuestro propio servidor de DNS
        para nuestro dominio.  Si no es el caso y no es posible ejecutar
        nuestro propio servidor de DNS debemos comunicarnos con nuestro
        proveedor de servicios o con quien pueda proporcionarnos servicio de
        DNS y solicitarle una modificación como la anterior.</p><p>Si además ofrecemos servicios de alojamiento virtual de
        correo la siguiente información puede resultar útil.
        Asumiremos que tenemos un cliente con su propio dominio, por ejemplo
        <code class="systemitem">cliente1.org</code> y queremos que todo el
        correo enviado a <code class="systemitem">cliente1.org</code> sea redirigido hasta nuestro
        servidor de correo, <code class="systemitem">mail.nuestroservidor.com</code>.  La entrada necesaria
        en el DNS debería ser la siguiente:</p><pre class="programlisting">cliente1.org		MX	10	mail.nuestroservidor.com</pre><p>No necesitamos <span class="emphasis"><em>ningún</em></span> registro de tipo
        A para <code class="systemitem">cliente1.org</code> si sólamente queremos
        gestionar el correo para ese dominio.
      </p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Tenga en cuenta que un ping a <code class="systemitem">cliente1.org</code> no funcionará a menos
          que exista un registro de tipo A para dicha máquina.
        </p></div><p>La última cosa que debemos realizar en nuestro servidor de
        correo es comunicar a <span class="application">sendmail</span> para
        qué dominios y/o máquinas debe aceptar correo.  Existen
        varias formas en las que se puede realizar esta tarea.
        Cualquiera de las siguiente funcionará:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Añadir las máquinas deseadas al fichero
	  <code class="filename">/etc/mail/local-host-names</code> si se está
          utlizando la macro
	  <code class="literal">FEATURE(use_cw_file)</code>.  Si se está
          utilizando una versión de <span class="application">
          sendmail</span> anterior a la 8.10 el fichero que se debe
	  utilizar es <code class="filename">/etc/sendmail.cw</code>.</p></li><li class="listitem"><p>Añadir la línea <code class="literal">
            Cwsu.servidor.com</code> al fichero
	    <code class="filename">/etc/sendmail.cf</code> o
	    <code class="filename">/etc/mail/sendmail.cf</code> si se está
            utilizando una versión de <span class="application">
            sendmail</span> posterior a la versión 8.10.</p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail-trouble.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="SMTP-UUCP.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">27.5. Depuración de Problemas </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 27.7. SMTP con UUCP</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>