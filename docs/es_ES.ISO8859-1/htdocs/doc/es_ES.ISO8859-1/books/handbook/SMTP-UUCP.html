<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>27.7. SMTP con UUCP</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manual de FreeBSD" /><link rel="up" href="mail.html" title="Capítulo 27. Correo Electrónico" /><link rel="prev" href="mail-advanced.html" title="27.6. Conceptos Avanzados" /><link rel="next" href="outgoing-only.html" title="27.8. Configuración para sólamente enviar correo" /><link rel="copyright" href="legalnotice.html" title="Aviso Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">27.7. SMTP con UUCP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mail-advanced.html">Anterior</a> </td><th width="60%" align="center">Capítulo 27. Correo Electrónico</th><td width="20%" align="right"> <a accesskey="n" href="outgoing-only.html">Siguiente</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="SMTP-UUCP"></a>27.7. SMTP con UUCP</h2></div></div></div><p>La configuración de <span class="application">sendmail</span> que
      se proporciona con la distribución de FreeBSD está
      diseñada para organizaciones que se conectan directamente a
      internet.  Las organizaciones que deseén enviar y recibir
      sus correos utilizando UUCP deben instalar otro fichero de
      configuración para <span class="application">
      sendmail</span>.</p><p>El ajuste de forma manual del archivo <code class="filename">
      /etc/mail/sendmail.cf</code> es un tema para expertos.
      La versión 8 de <span class="application">sendmail</span> genera
      ficheros de configuración mediante el preprocesador
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=m4&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">m4</span>(1)</span></a>, gracias al que las opciones de configuración se
      pueden escribir utilizando un nivel de abstracción mayor.
      Los archivos de configuración de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=m4&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">m4</span>(1)</span></a> se pueden encontrar
      en <code class="filename">/usr/src/usr.sbin/sendmail/cf</code>.</p><p>Si no se instaló el sistema base con todas las fuentes el
      conjunto de ficheros de configuración de <span class="application">
      sendmail</span> se puede obtener a partir de un paquete de
       fuentes determinado.  Suponiendo que tengamos el CDROM con el
       código fuente de FreeBSD montado se puede ejecutar:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /cdrom/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cat scontrib.?? | tar xzf - -C /usr/src/contrib/sendmail</code></strong></pre><p>Este comando extrae sólamente unos pocos cientos de
      kilobytes. El fichero <code class="filename">README</code> que hay en
      el directorio <code class="filename">cf</code> puede servirle como
      una introducción básica a la configuración
      mediante <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=m4&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">m4</span>(1)</span></a>.</p><p>La mejor forma de soportar la entrega de correo mediante UUCP es
      utilizando la característica <code class="literal">mailertable</code>.
      Esta característica crea una base de datos que
      <span class="application">sendmail</span> utiliza para tomar decisiones de
      encaminamiento.</p><p>En primer lugar creamon el fichero <code class="filename">.mc</code>.
      El directorio <code class="filename">/usr/src/usr.sbin/sendmail/cf/cf</code>
      alberga varios ejemplos del mismo.  Suponiendo que nuestro fichero
      configuración se llama
      <code class="filename">foo.mc</code> para convertir dicho archivo en un fichero
      <code class="filename">sendmail.cf</code> válido basta con ejecutar lo
      siguiente:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/usr.sbin/sendmail/cf/cf</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make foo.cf</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cp foo.cf /etc/mail/sendmail.cf</code></strong></pre><p>Un fichero <code class="filename">.mc</code> suele tener este aspecto:</p><pre class="programlisting">VERSIONID(`<em class="replaceable"><code>Su número de versión</code></em>') OSTYPE(bsd4.4)

FEATURE(accept_unresolvable_domains)
FEATURE(nocanonify)
FEATURE(mailertable, `hash -o /etc/mail/mailertable')

define(`UUCP_RELAY', <em class="replaceable"><code>su.relay.uucp</code></em>)
define(`UUCP_MAX_SIZE', 200000)
define(`confDONT_PROBE_INTERFACES')

MAILER(local)
MAILER(smtp)
MAILER(uucp)

Cw    <em class="replaceable"><code>alias.de.su.servidor</code></em>
Cw    <em class="replaceable"><code>nombredesunodouucp.UUCP</code></em></pre><p>Las líneas que contienen
      <code class="literal">accept_unresolvable_domains</code>,
      <code class="literal">nocanonify</code>, y
      <code class="literal">confDONT_PROBE_INTERFACES</code> prohíben la
      utilización del DNS durante la entrega de correo.
      La cláusula  <code class="literal">UUCP_RELAY</code> es necesaria
      para soportar entrega mediante UUCP.  Lo único que hay que hacer
      es escribir un nombre de máquina en ese punto.
      Dicha máquina debe ser capaz de gestionar las direcciones del
      pseudo-dominio .UUCP; en la mayoría de los casos se escribe en
      este punto el nombre de la máquina perteneciente al proveedor de
      servicios que hace de relay.</p><p>Una vez que tenemos esto configurado se necesita un fichero
      <code class="filename">/etc/mail/mailertable</code>.  Si solamente tenemos un
      enlace con el exterior, que usamos para todos nuestro correos,
      basta una configuración como la que se muestra a
      continuación:</p><pre class="programlisting">#
# makemap hash /etc/mail/mailertable.db &lt; /etc/mail/mailertable
.                             uucp-dom:<em class="replaceable"><code>su.relay.uucp</code></em></pre><p>Un ejemplo más complejo puede parecerse al siguiente:</p><pre class="programlisting">#
# makemap hash /etc/mail/mailertable.db &lt; /etc/mail/mailertable
#
horus.interface-business.de   uucp-dom:horus
.interface-business.de        uucp-dom:if-bus
interface-business.de         uucp-dom:if-bus
.heep.sax.de                  smtp8:%1
horus.UUCP                    uucp-dom:horus
if-bus.UUCP                   uucp-dom:if-bus
.                             uucp-dom:</pre><p>Las primeras tres líneas se encargan de manejar casos
      especiales en los que el correo dirigido directamente al dominio no se
      envía a la ruta por defecto sino a algún vecino UUCP para
      acortar el número de saltos involucrados en la entrega de dichos
      correos.
      La siguiente línea gestiona el correo para el dominio ethernet
      local, el cual puede ser entregado utilizando SMTP.  Finalmente los
      vecinos UUCP se mencionan en la notación de pseudo-dominio
      .UUCP para permitir que un
      <code class="literal">vecino UUCP receptor</code>
      de correo pueda sobreescribir las reglas por defecto.  La última
      línea siempre es un punto; se asocia con cualquier otra cosa que
      no ha sido tratada en reglas anteriores y donde se realiza entrega UUCP
      a un vecino UUCP que sirve como pasarela de correo universal para todo
      el mundo.  Todos los nombres de máquinas bajo la clave
      <code class="literal">uucp-dom:</code> deben ser vecinos UUCP válidos, lo
      cual se puede verificar utilizando el comando <code class="literal">
      uuname</code>.</p><p>Recuerde que este fichero debe convertirse en una base de datos DBM
      antes de que usarse.  El comando que se utiliza para realizar esta tarea
      se suele especificar como un comentario al principio del fichero
      <code class="filename">mailertable</code>.  Cada vez que se modifique el fichero
      <code class="filename">mailertable</code> se debe ejecutar dicho comando.</p><p>Un consejo final:  si dudamos sobre una determinada ruta de
      encaminamiento de correo se puede ejecutar <span class="application">
      sendmail</span> con el parámetro <code class="option">-bt</code>.
      Este parámetro ejecuta <span class="application">sendmail</span>
      en <span class="emphasis"><em>modo prueba de direcciones</em></span>;
      simplemente basta con escribir <code class="literal">3,0</code> seguido por la
      dirección de correo de la que queremos comprobar su correcto
      encaminamiento.  La última línea nos dice el agente de
      correo interno que se utiliza, la máquina de destino con que el
      agente será invocado y la dirección (posiblemente
      traducida) de correo.  Se puede abandonar este modo de funcionamiento
      escribiendo <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>D</strong></span>.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>sendmail -bt</code></strong>
ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)
Enter &lt;ruleset&gt; &lt;address&gt;
<code class="prompt">&gt;</code> <strong class="userinput"><code>3,0 prueba@ejemplo.com</code></strong>
canonify           input: foo @ example . com
...
parse            returns: $# uucp-dom $@ <em class="replaceable"><code>su.relay.uucp</code></em> $: prueba &lt; @ ejemplo . com . &gt;
<code class="prompt">&gt;</code> <strong class="userinput"><code>^D</code></strong></pre></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail-advanced.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="outgoing-only.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">27.6. Conceptos Avanzados </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 27.8. Configuración para sólamente enviar correo</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Puede descargar éste y muchos otros documentos desde
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Si tiene dudas sobre FreeBSD consulte la
    <a href="http://www.FreeBSD.org/docs.html">documentación</a> antes de escribir a la lista
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Envíe sus preguntas sobre la documentación a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>