<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>16.5. Event Audit Administration</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Podrêcznik FreeBSD" /><link rel="up" href="audit.html" title="Rozdzia³ 16. Security Event Auditing" /><link rel="prev" href="audit-config.html" title="16.4. Audit Configuration" /><link rel="next" href="disks.html" title="Rozdzia³ 17. Storage" /><link rel="copyright" href="legalnotice.html" title="Informacja Prawna" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">16.5. Event Audit Administration</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="audit-config.html">Poprzedni</a> </td><th width="60%" align="center">Rozdzia³ 16. Security Event Auditing</th><td width="20%" align="right"> <a accesskey="n" href="disks.html">Nastêpny</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="audit-administration"></a>16.5. Event Audit Administration</h2></div></div></div><p>Events written by the kernel audit subsystem cannot
      be altered or read in plain text.  Data is stored and accessed
      in a method similar to that of <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ktrace&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ktrace</span>(1)</span></a> and <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kdump&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kdump</span>(1)</span></a>,
      that is, they may only be viewed by dumping them using the
      <code class="command">praudit</code> command; audit trails may be reduced
      using the <code class="command">auditreduce</code> command, which selects
      records from an audit trail based on properties of interest, such
      as the user, time of the event, and type of operation.</p><p>For example, the <code class="command">praudit</code> utility will dump the
      entire contents of a specified audit log in plain text.  To dump an
      audit log in its entirety, use:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>praudit /var/audit/AUDITFILE</code></strong></pre><p>Where <em class="replaceable"><code>AUDITFILE</code></em> is the audit log
      of viewing choice.  Since audit logs may contain enormous
      amounts of data, an administrator may prefer to select records
      for specific users.  This is made possible with the following
      command, where <code class="systemitem">trhodes</code> is the user of
      choice:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>auditreduce -e trhodes /var/audit/AUDITFILE | praudit</code></strong></pre><p>This will select all audit records produced by the user
      <code class="systemitem">trhodes</code> stored in the
      <em class="replaceable"><code>AUDITFILE</code></em> file.</p><p>There are several other options available for reading audit
      records, see the aforementioned command's manual pages for
      a more in depth explanation.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88061648"></a>16.5.1. Rotating Audit Log Files</h3></div></div></div><p>Due to log reliability requirements, audit trails
	are written to only by the kernel, and managed only by
	<code class="command">auditd</code>.  Administrators should not
	attempt to use <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newsyslog.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">newsyslog.conf</span>(5)</span></a> or other tools to
	directly rotate audit logs.  Instead, the <code class="command">audit</code>
	management tool should be used to shut down auditing,
	reconfigure the audit system, and perform log rotation.
	The following command causes the audit daemon to create a
	new audit log and signal the kernel to switch to using the
	new log.  The old log will be terminated and renamed, at
	which point it may then be manipulated by the administrator.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>audit -n</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Ostrze¿enie: </h3><p xmlns="http://www.w3.org/1999/xhtml">If the <code class="command">auditd</code> daemon is not currently
	  running, the previous command will fail and an error message
	  will be produced.</p></div><p>Adding the following line to
	<code class="filename">/etc/crontab</code> will force the rotation
	every twelve hours from <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a>:</p><pre class="programlisting">*     */12       *       *       *       root    /usr/sbin/audit -n</pre><p>The change will take effect once you have saved the
	new <code class="filename">/etc/crontab</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88081488"></a>16.5.2. Delegating Audit Review Rights</h3></div></div></div><p>By default, only the root user has the right to read system audit
	logs.  However, that right may be delegated to members of the
	<code class="literal">audit</code> group, as the audit directory and audit
	trail files are assigned to that group, and made group-readable.  As
	the ability to track audit log contents provides significant insight
	into the behavior of users and processes, it is recommended that the
	delegation of audit review rights be performed with caution.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="audit-config.html">Poprzedni</a> </td><td width="20%" align="center"><a accesskey="u" href="audit.html">Pocz±tek rozdzia³u</a></td><td width="40%" align="right"> <a accesskey="n" href="disks.html">Nastêpny</a></td></tr><tr><td width="40%" align="left" valign="top">16.4. Audit Configuration </td><td width="20%" align="center"><a accesskey="h" href="index.html">Spis tre¶ci</a></td><td width="40%" align="right" valign="top"> Rozdzia³ 17. Storage</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>