<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>9.5. Si quelque chose se passe mal</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="kernelconfig.html" title="Chapitre 9. Configurer le noyau de FreeBSD" /><link rel="prev" href="kernelconfig-config.html" title="9.4. Le fichier de configuration" /><link rel="next" href="printing.html" title="Chapitre 10. Imprimer" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">9.5. Si quelque chose se passe mal</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="kernelconfig-config.html">Précédent</a> </td><th width="60%" align="center">Chapitre 9. Configurer le noyau de FreeBSD</th><td width="20%" align="right"> <a accesskey="n" href="printing.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="kernelconfig-trouble"></a>9.5. Si quelque chose se passe mal</h2></div></div></div><p>Il y a cinq types de problèmes qui peuvent survenir lors de
      la compilation d'un noyau sur mesure.  Ce sont:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">La commande <code class="command">config</code> échoue:</span></dt><dd><p>Si la commande <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=config&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">config</span>(8)</span></a> échoue quand
	    vous lui passez en paramètre la description de votre
	    noyau, vous avez probablement fait une simple erreur
	    quelque part.  Heureusement <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=config&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">config</span>(8)</span></a>
	    affichera le numéro de la ligne qui lui a posé
	    problème, vous pouvez donc localiser rapidement la
	    ligne contenant l'erreur.  Par exemple, si vous avez:</p><pre class="screen">config: line 17: syntax error</pre><p>Vérifiez que la ligne est
	    correctement écrite, en le comparant avec le noyau
	    <code class="filename">GENERIC</code> ou une autre
	    référence.</p></dd><dt><span class="term">La commande <code class="command">make</code> échoue:</span></dt><dd><p>Si la commande <code class="command">make</code> échoue,
	    cela signale habituellement une erreur dans la description
	    de votre noyau, mais qui n'est pas suffisamment sérieuse pour que
	    la commande <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=config&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">config</span>(8)</span></a> la détecte.
	    A nouveau, vérifiez votre fichier de configuration, et si
	    vous n'arrivez toujours pas à résoudre le
	    problème, envoyez un courrier électronique à la
	    <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-questions" target="_top">liste de diffusion pour les questions d'ordre général à propos de FreeBSD</a> en joignant votre fichier de configuration
	    du noyau, le diagnostic devrait être rapide.</p></dd><dt><span class="term">Le noyau ne démarre pas:<a id="kernelconfig-noboot"></a></span></dt><dd><p>Si votre nouveau noyau ne démarre pas, ou ne
	    reconnaît pas vos périphériques,
	    ne paniquez pas!  Heureusement, FreeBSD dispose d'un
	    excellent mécanisme pour récupérer si le
	    noyau ne fonctionne pas.  Sélectionnez simplement le noyau,
	    à partir duquel vous désirez démarrer,
	    à l'invite du chargeur de FreeBSD.  Vous pouvez y
	    accéder quand le menu de démarrage
	    apparaît.  Sélectionner l'option 6,
	    <span class="quote">« <span class="quote">Escape to a loader prompt</span> »</span>.  A l'invite,
	    tapez <code class="command">unload kernel</code> et ensuite
	    <code class="command">boot /boot/kernel.old/kernel</code>,
	    ou le nom de fichier d'un autre noyau qui pourra démarrer
	    proprement.  Quand on reconfigure un noyau, il est
	    toujours bon de conserver à portée de la main un
	    noyau dont on sait qu'il fonctionne.</p><p>Après avoir démarré avec un
	    noyau en état de marche, vous pouvez revérifier votre
	    fichier de configuration et essayer de recompiler à
	    nouveau votre noyau.  Une ressource utile est le fichier
	    <code class="filename">/var/log/messages</code> qui enregistre,
	    entre autres, tous les messages du noyau à chaque
	    démarrage réussi.  En outre, la commande
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dmesg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dmesg</span>(8)</span></a> affichera les messages du noyau pour le
	    dernier démarrage.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Si vous avez des difficultés à compiler
	      un noyau, veillez à conserver un noyau
	      <code class="filename">GENERIC</code>, ou un autre noyau dont
	      vous savez qu'il fonctionne, sous la main, avec un nom
	      différent de sorte qu'il ne soit pas
	      écrasé à la prochaine compilation.
	      Vous ne pouvez pas faire confiance au noyau
	      <code class="filename">kernel.old</code> parce qu'en installant
	      un nouveau noyau, <code class="filename">kernel.old</code> est
	      remplacé par le dernier noyau installé dont
	      il n'est pas certain qu'il soit opérationnel.  Aussi,
	      dès que possible, déplacez le noyau
	      opérationnel vers le
	      bon emplacement <code class="filename">/boot/kernel</code> où des commandes
	      comme <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ps&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ps</span>(1)</span></a> pourront ne pas fonctionner correctement.
	      Pour cela, renommez le répertoire contenant le bon
	      noyau:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mv /boot/kernel /boot/kernel.bad</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv /boot/kernel.good /boot/kernel</code></strong></pre></div></dd><dt><span class="term">Le noyau est opérationnel, mais la commande
	  <code class="command">ps</code> ne fonctionne plus du tout:</span></dt><dd><p>Si vous avez installé une version du noyau
	    différente de celle avec laquelle ont
	    été compilés les utilitaires système,
	    par exemple, un noyau
	    -CURRENT sur un système -RELEASE, de nombreuses commandes
	    d'affichage de l'état du système comme
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ps&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ps</span>(1)</span></a> and <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vmstat&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">vmstat</span>(8)</span></a> ne fonctionneront plus.
	    Vous devrez <a class="link" href="makeworld.html" title="24.6. Recompiler le système">recompiler et
	    installer un système</a> avec la même
	    version de l'arborescence des sources de celle
	    utilisée pour votre noyau.
	    C'est une des raisons pour lesquelles il n'est pas
	    judicieux d'utiliser des versions différentes du noyau et
	    du reste du système d'exploitation.</p></dd></dl></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="kernelconfig-config.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="kernelconfig.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="printing.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">9.4. Le fichier de configuration </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> Chapitre 10. Imprimer</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>