<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>21.7. Appellation des objets</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="vinum-vinum.html" title="Chapitre 21. Le gestionnaire de volume Vinum" /><link rel="prev" href="vinum-examples.html" title="21.6. Quelques exemples" /><link rel="next" href="vinum-config.html" title="21.8. Configuration de Vinum" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">21.7. Appellation des objets</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="vinum-examples.html">Précédent</a> </td><th width="60%" align="center">Chapitre 21. Le gestionnaire de volume Vinum</th><td width="20%" align="right"> <a accesskey="n" href="vinum-config.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="idp81634768"></a>21.7. Appellation des objets</h2></div></div></div><p>Comme décrit précédemment, Vinum
      assigne des noms par défaut aux plexes et aux sous-disques, bien
      qu'ils peuvent être imposés.  Ne pas conserver les
      noms par défaut n'est pas recommandé: une
      expérience avec le gestionnaire de volume VERITAS, qui autorise
      les noms arbitraires pour les objets, a montré que cette
      flexibilité n'apporte pas d'avantage significatif, et peut
      être à l'origine de confusion.</p><p>Les noms pourront contenir tout caractère non vide, mais il
      est recommandé de se cantonner aux lettres, chiffres ou le
      caractère souligné.  Les noms de volumes, plexes et
      sous-disques peuvent contenir jusqu'à 64 caractères,
      et le nom des disques 32 caractères.</p><p><a id="idp81636304" class="indexterm"></a>
      On assigne à chaque objet Vinum un fichier spécial de
      périphérique dans la hiérarchie
      <code class="filename">/dev/vinum</code>.  La configuration présentée
      plus haut aurait fait à Vinum créer les fichiers
      spéciaux de périphérique suivants:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Les périphériques de contrôle
	  <code class="filename">/dev/vinum/control</code> et
	  <code class="filename">/dev/vinum/controld</code>, qui sont
	  respectivement utilisés par <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vinum&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">vinum</span>(8)</span></a>et le
	  &#8220;daemon&#8221; Vinum.</p></li><li class="listitem"><p>Les entrées des périphériques en mode
	  bloc et caractères par chaque volume.  Ce sont les
	  périphériques principaux utilisés
	  par Vinum.  Les noms de périphériques en mode
	  bloc sont le nom du volume, alors que les noms de
	  périphériques en mode caractère suivent la
	  tradition BSD de faire précéder le nom de la lettre
	  <span class="emphasis"><em>r</em></span>.  Donc la configuration précédent
	  inclurait les périphériques en mode bloc
	  <code class="filename">/dev/vinum/myvol</code>,
	  <code class="filename">/dev/vinum/mirror</code>,
	  <code class="filename">/dev/vinum/striped</code>,
	  <code class="filename">/dev/vinum/raid5</code> et
	  <code class="filename">/dev/vinum/raid10</code>, et les
	  périphériques en mode caractères
	  <code class="filename">/dev/vinum/rmyvol</code>,
	  <code class="filename">/dev/vinum/rmirror</code>,
	  <code class="filename">/dev/vinum/rstriped</code>,
	  <code class="filename">/dev/vinum/rraid5</code> et
	  <code class="filename">/dev/vinum/rraid10</code>.
	  Un problème évident apparaît ici: il est
	  possible d'avoir deux volumes appelés
	  <span class="emphasis"><em>r</em></span> et <span class="emphasis"><em>rr</em></span>, mais il y
	  aurait un conflit lors de la création du fichier
	  spécial de périphérique
	  <code class="filename">/dev/vinum/rr</code>: c'est le
	  périphérique en mode caractère du volume
	  <span class="emphasis"><em>r</em></span> ou le périphérique en mode bloc
	  du volume <span class="emphasis"><em>rr</em></span>?  Actuellement Vinum ne
	  résout pas ce conflit: le premier volume défini
	  obtiendra le nom.</p></li><li class="listitem"><p>Un répertoire <code class="filename">/dev/vinum/drive</code>
	  avec des entrées pour chaque disque.  Ces entrées
	  sont en fait des liens symboliques vers les fichiers
	  spéciaux de périphérique de
	  disque correspondants.</p></li><li class="listitem"><p>Un répertoire <code class="filename">/dev/vinum/volume</code> avec
	  des entrées pour chaque volume.  Il contient des
	  sous-répertoires pour chaque plex, qui à leur tour
	  contiennent des sous-répertoires pour leurs
	  sous-disques.</p></li><li class="listitem"><p>Les répertoires <code class="filename">/dev/vinum/plex</code>,
	  <code class="filename">/dev/vinum/sd</code>, et
	  <code class="filename">/dev/vinum/rsd</code>, qui contiennent les
	  fichiers spéciaux de périphérique en mode bloc
	  pour chaque plex et les fichiers spéciaux de
	  périphérique en mode bloc
	  et caractère pour chaque sous-disque.</p></li></ul></div><p>Par exemple, considérons le fichier de configuration
      suivant:</p><pre class="programlisting">
	drive drive1 device /dev/sd1h
	drive drive2 device /dev/sd2h
	drive drive3 device /dev/sd3h
	drive drive4 device /dev/sd4h
    volume s64 setupstate
      plex org striped 64k
        sd length 100m drive drive1
        sd length 100m drive drive2
        sd length 100m drive drive3
        sd length 100m drive drive4</pre><p>Après traitement de ce fichier, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vinum&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">vinum</span>(8)</span></a>
      crée la structure suivante dans
      <code class="filename">/dev/vinum</code>:</p><pre class="programlisting">
	brwx------  1 root  wheel   25, 0x40000001 Apr 13 16:46 Control
	brwx------  1 root  wheel   25, 0x40000002 Apr 13 16:46 control
	brwx------  1 root  wheel   25, 0x40000000 Apr 13 16:46 controld
	drwxr-xr-x  2 root  wheel       512 Apr 13 16:46 drive
	drwxr-xr-x  2 root  wheel       512 Apr 13 16:46 plex
	crwxr-xr--  1 root  wheel   91,   2 Apr 13 16:46 rs64
	drwxr-xr-x  2 root  wheel       512 Apr 13 16:46 rsd
	drwxr-xr-x  2 root  wheel       512 Apr 13 16:46 rvol
	brwxr-xr--  1 root  wheel   25,   2 Apr 13 16:46 s64
	drwxr-xr-x  2 root  wheel       512 Apr 13 16:46 sd
	drwxr-xr-x  3 root  wheel       512 Apr 13 16:46 vol

	/dev/vinum/drive:
    total 0
    lrwxr-xr-x  1 root  wheel  9 Apr 13 16:46 drive1 -&gt; /dev/sd1h
    lrwxr-xr-x  1 root  wheel  9 Apr 13 16:46 drive2 -&gt; /dev/sd2h
    lrwxr-xr-x  1 root  wheel  9 Apr 13 16:46 drive3 -&gt; /dev/sd3h
    lrwxr-xr-x  1 root  wheel  9 Apr 13 16:46 drive4 -&gt; /dev/sd4h

    /dev/vinum/plex:
    total 0
    brwxr-xr--  1 root  wheel   25, 0x10000002 Apr 13 16:46 s64.p0

    /dev/vinum/rsd:
    total 0
    crwxr-xr--  1 root  wheel   91, 0x20000002 Apr 13 16:46 s64.p0.s0
    crwxr-xr--  1 root  wheel   91, 0x20100002 Apr 13 16:46 s64.p0.s1
    crwxr-xr--  1 root  wheel   91, 0x20200002 Apr 13 16:46 s64.p0.s2
    crwxr-xr--  1 root  wheel   91, 0x20300002 Apr 13 16:46 s64.p0.s3

    /dev/vinum/rvol:
    total 0
    crwxr-xr--  1 root  wheel   91,   2 Apr 13 16:46 s64

    /dev/vinum/sd:
    total 0
    brwxr-xr--  1 root  wheel   25, 0x20000002 Apr 13 16:46 s64.p0.s0
    brwxr-xr--  1 root  wheel   25, 0x20100002 Apr 13 16:46 s64.p0.s1
    brwxr-xr--  1 root  wheel   25, 0x20200002 Apr 13 16:46 s64.p0.s2
    brwxr-xr--  1 root  wheel   25, 0x20300002 Apr 13 16:46 s64.p0.s3

    /dev/vinum/vol:
    total 1
    brwxr-xr--  1 root  wheel   25,   2 Apr 13 16:46 s64
    drwxr-xr-x  3 root  wheel       512 Apr 13 16:46 s64.plex

    /dev/vinum/vol/s64.plex:
    total 1
    brwxr-xr--  1 root  wheel   25, 0x10000002 Apr 13 16:46 s64.p0
    drwxr-xr-x  2 root  wheel       512 Apr 13 16:46 s64.p0.sd

    /dev/vinum/vol/s64.plex/s64.p0.sd:
    total 0
    brwxr-xr--  1 root  wheel   25, 0x20000002 Apr 13 16:46 s64.p0.s0
    brwxr-xr--  1 root  wheel   25, 0x20100002 Apr 13 16:46 s64.p0.s1
    brwxr-xr--  1 root  wheel   25, 0x20200002 Apr 13 16:46 s64.p0.s2
    brwxr-xr--  1 root  wheel   25, 0x20300002 Apr 13 16:46 s64.p0.s3</pre><p>Bien qu'il soit recommandé de ne pas donner de nom
      spécifique aux plexes et sous-disques, les disques Vinum doivent
      avoir un nom.  Cela rend possible de déplacer un disque à un
      emplacement différent et qu'il soit toujours reconnu
      automatiquement.  Les noms de disques peuvent avoir jusqu'à 32
      caractères.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81654608"></a>21.7.1. Création de systèmes de fichiers</h3></div></div></div><p>Les volumes apparaissent pour le système comme des
	  disques, avec une seule exception.  Contrairement aux
	  disques UNIX&#8482;, Vinum ne partitionne pas les volumes, qui
	  ne contiennent donc pas de table de partitionnement.  Cela a
	  demandé de modifier certains utilitaires disque, en
	  particulier <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a>, qui auparavant tentait
	  d'interpréter la dernière lettre du nom de volume Vinum
	  comme un identifiant de partition.  Par exemple, un disque
	  peut avoir un nom comme <code class="filename">/dev/ad0a</code>$
	  ou <code class="filename">/dev/da2h</code>.  Ces noms
	  représentent respectivement la première partition
	  (<code class="filename">a</code>) sur le premier (0) disque IDE
	  (<code class="filename">ad</code>) la la huitième partition
	  (<code class="filename">h</code>) sur le troisième (2)
	  disque SCSI (<code class="filename">da</code>).  En revanche,
	  un volume Vinum pourra être appelé
	  <code class="filename">/dev/vinum/concat</code>, un nom qui n'a
	  pas de relation avec un nom de partition.</p><p>Normalement, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> interprète le nom du disque
	  et se plaint s'il ne peut le comprendre.  Par
	  exemple:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>newfs /dev/vinum/concat</code></strong>
newfs: /dev/vinum/concat: can't figure out file system partition</pre><p>Afin de créer un système de fichiers sur ce volume,
	  utilisez l'option <code class="option">-v</code> de
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>newfs -v /dev/vinum/concat</code></strong></pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="vinum-examples.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="vinum-vinum.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="vinum-config.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">21.6. Quelques exemples </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 21.8. Configuration de Vinum</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>