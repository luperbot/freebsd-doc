<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>Chapitre 4. Résolutions des incidents. **Mise à jour en cours**</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Questions Fréquemment Posées sur FreeBSD 2.X, 3.X et 4.X" /><link rel="up" href="index.html" title="Questions Fréquemment Posées sur FreeBSD 2.X, 3.X et 4.X" /><link rel="prev" href="ch03s25.html" title="3.25. FreeBSD supporte-t-il les Multiprocesseurs Symétriques (SMP) ?" /><link rel="next" href="ch04s02.html" title="4.2. FreeBSD ne reconnait pas ma carte EISA SCSI Bustek 742a !" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapitre 4. Résolutions des incidents. **Mise à jour en cours**</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch03s25.html">Précédent</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch04s02.html">Suivant</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="troubleshoot"></a>Chapitre 4. Résolutions des incidents. **Mise à jour en cours**</h1></div></div></div><div class="toc"><div class="toc-title">Table des matières</div><dl class="toc"><dt><span class="sect1"><a href="troubleshoot.html#awre">4.1. J'ai des secteurs défectueux sur mon disque dur !</a></span></dt><dt><span class="sect1"><a href="ch04s02.html">4.2. FreeBSD ne reconnait pas ma carte EISA SCSI Bustek 742a !</a></span></dt><dt><span class="sect1"><a href="ch04s03.html">4.3. Mon contrôleur SCSI HP Netserver n'est pas détecté !</a></span></dt><dt><span class="sect1"><a href="ch04s04.html">4.4.  Que se passe-t'il avec le contrôleur CMD640 IDE controller?  </a></span></dt><dt><span class="sect1"><a href="ch04s05.html">4.5.  Je n'arrête pas de voir ``<code class="filename">ed1: timeout</code>''.  </a></span></dt><dt><span class="sect1"><a href="ch04s06.html">4.6.  Quand je monte le CD-ROM, j'obtiens ``Incorrect super block''.  </a></span></dt><dt><span class="sect1"><a href="ch04s07.html">4.7.  Quand je monte un CDROM, j'obtiens ``Device not configured''.  </a></span></dt><dt><span class="sect1"><a href="ch04s08.html">4.8.  Mon imprimante est extrêmement lente, que puis-je faire ?  </a></span></dt><dt><span class="sect1"><a href="ch04s09.html">4.9. Mes programmes se tuent souvent avec l'erreur ``Signal 11''.</a></span></dt><dt><span class="sect1"><a href="ch04s10.html">4.10.  Quand je boote, l'écran devient noir, et perd sa synchronisation </a></span></dt><dt><span class="sect1"><a href="ch04s11.html">4.11.  J'ai 128 MB de RAM mais le système n'en voit que 64 MB.   </a></span></dt><dt><span class="sect1"><a href="ch04s12.html">4.12.  FreeBSD 2.0 panique avec ``kmem_map too small!'' </a></span></dt><dt><span class="sect1"><a href="ch04s13.html">4.13.  ``CMAP busy panic'' au moment d'un reboot avec un nouveau noyau.  </a></span></dt><dt><span class="sect1"><a href="ch04s14.html">4.14. ahc0: brkadrint,  Illegal Host Access at seqaddr 0x0</a></span></dt><dt><span class="sect1"><a href="ch04s15.html">4.15. Sendmail me dit ``mail loops back to myself''</a></span></dt><dt><span class="sect1"><a href="ch04s16.html">4.16.  Les applications plein-écran sur des machines distantes se comportent étrangement.  </a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="awre"></a>4.1. J'ai des secteurs défectueux sur mon disque dur !</h2></div></div></div><p>Pour les disques SCSI, le disque devrait être capable de réallouer
      ceux-ci automatiquement. Quoiqu'il en soit, beaucoup de disques sont
      livrés avec cette fonctionnalité désactivée, pour une raison
      mystérieuse...</p><p>Pour l'activer, vous aurez à éditer le <span class="foreignphrase"><em class="foreignphrase">first device
      page mode</em></span>, ce qui peut être fait sur FreeBSD en tapant
      la commande (sous root)

      </p><pre class="programlisting">
	scsi -f /dev/rsd0c -m 1 -e -P 3
      </pre><p>
    </p><p>et en changeant la valeur de AWRE et ARRE de 0 à 1 :

      </p><pre class="programlisting">
	AWRE (Auto Write Reallocation Enbld):  1
	ARRE (Auto Read Reallocation Enbld):  1
      </pre><p>
    </p><p>Les paragraphes suivants ont été soumis par
      <a class="link" href="mailto:tedm@toybox.placo.com" target="_top">Ted Mittelstaedt</a> :
      </p><p>Pour les disques IDE, le moindre secteur défectueux est habituellement
      un signe d'incident potentiel.
      Tous les disques IDE modernes sont livrés avec la réallocation des
      secteurs défectueux activée.
      Tous les fabriquants de disques durs IDE offrent aujourd'hui des
      garanties étendues et remplaceront les disques possédant des secteurs
      défectueux.</p><p>Si vous voulez toutefois essayer de récupérer un disque IDE avec des
      secteurs défectueux, vous pouvez essayer de télécharger le programme de
      diagnostic du fabriquant de disque IDE et de le faire exécuter sur le
      disque. Quelquefois, ces programmes peuvent être configurés pour
      forcer l'électronique du disque à rebalayer le disque pour les secteurs
      défectueux et leur inhibition.</p><p>Pour les disques ESDI, RLL et MFM, les secteurs défectueux font
      partie de la vie normale du disque et ne sont pas signes d'incidents,
      généralement. Avec un PC, la carte contrôleur de disque et le BIOS
      prennent en charge la tâche d'inhibition des secteurs défectueux.
      C'est bien pour les systèmes d'exploitation comme DOS qui
      utilisent le code du BIOS pour accéder au disque. Toutefois,
      le driver de disque FreeBSD ne passe pas par le BIOS, aussi
      un mécanisme, <span class="application">bad144</span>, existe pour remplacer
      cette fonctionnalité.
      <span class="application">bad144</span> ne fonctionne qu'avec le driver
      <code class="filename">wd</code>, il ne peut
      <span class="emphasis"><em>pas</em></span> être utilisé avec le SCSI.
      <span class="application">bad144</span> fonctionne en entrant tous les
      secteurs défectueux trouvés dans un fichier spécial.</p><p>Un inconvénient avec <span class="application">bad144</span> - 
      le fichier spécial des secteurs défectueux est placé sur la dernière
      piste du disque.
      Comme ce fichier contient peut-être une liste de secteurs dont l'un
      serait près du début du disque, où le fichier noyau
      <code class="filename">/kernel</code> serait aussi localisé, il doit donc être
      accéssible au progamme d'amorce (<span class="foreignphrase"><em class="foreignphrase">bootstrap</em></span>)
      qui utilise les appels du BIOS pour lire le fichier du noyau.
      Cela signifie qu'un disque géré avec <span class="application">bad144</span>
      ne peut dépasser 1024 cylindres, 16 têtes et 63 secteurs.
      Cela place une limite effective de 500Mo sur un disque qui est réalloué
      avec <span class="application">bad144</span>.</p><p>Pour utiliser <span class="application">bad144</span>, positionnez
      simplement le balayage des secteurs défectueux <span class="foreignphrase"><em class="foreignphrase">Bad
      Block</em></span> à <span class="foreignphrase"><em class="foreignphrase">ON</em></span> dans
      le menu <code class="command">fdisk</code> de FreeBSD lors de l'installation
      initiale.
      Cela marche jusqu'à la version 2.2.7 de FreeBSD.
      Le disque doit avoir moins de 1024 cylindres.
      Il est généralement recommandé de laisser tourner préalablement le disque
      pendant plus de 4 heures avant cette opération, pour tenir compte de la
      dilatation thermique et des pistes errantes.</p><p>Si le disque a plus de 1024 cylindres (comme un gros disque ESDI),
      le contrôleur ESDI utilise un mode de translation spécial pour le
      faire fonctionner sous DOS.
      Le driver <code class="filename">wd</code> comprend ces modes de translation,
      <span class="emphasis"><em>si</em></span> vous entrez la géométrie "translatée"
      avec la commande <code class="command">set geometry</code> dans
      <code class="command">fdisk</code>.
      De plus, vous ne devez <span class="emphasis"><em>pas</em></span> utiliser le
      mode <span class="foreignphrase"><em class="foreignphrase">dangerously dedicated</em></span> de création
      d'une partition FreeBSD, parce qu'il ignore la géométrie.
      De plus, même si <code class="command">fdisk</code> va utiliser votre géométrie
      surchargée, il continue à connaître la vrai taille du disque
      et va tenter de créer une partition FreeBSD trop grande.
      Si la géométrie du disque est remplacée par la géométrie
      translatée, la partition <span class="emphasis"><em>doit</em></span>
      être créée manuellement avec le nombre de secteurs.</p><p>Un truc rapide à utiliser est d'initialiser le gros disque
      ESDI avec le contrôleur ESDI, le démarrer avec un disque DOS
      et le formatter avec une partition DOS.
      Puis, démarrez l'installation FreeBSD et dans le menu
      <code class="command">fdisk</code>, lire depuis l'écran et écrire à côté la taille
      et le nombre de secteurs de la partition DOS.
      Puis, réinitilisez la géométrie comme celle de DOS en détruisant
      la partition DOS et en créant une partition FreeBSD
      <span class="foreignphrase"><em class="foreignphrase">cooperative</em></span> avec la taille
      précédemment notée.
      Puis positionnez la partition pour être amorçable et autorisez
      le balayage des secteurs défectueux.
      Pendant l'installation réelle, <code class="command">bad144</code>
      passera en premier, avant la moindre création de systèmes de
      fichiers (vous pouvez le voir avec un <code class="command">Alt-F2</code>).
      S'il a le moindre problème pour créer le fichier des secteurs
      défectueux, vous avez initialisé une géométrie de disque trop
      grande - redémarrez le système et recommencez tout
      depuis le début (y compris le repartitionnement et reformattage
      en DOS).</p><p>Si la réallocation est autorisée et que vous voyez des
      secteurs défectueux, envisagez un remplacement du disque.
      Les secteurs défectueux ne feront que s'aggaver au fil du temps.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch03s25.html">Précédent</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch04s02.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">3.25. FreeBSD supporte-t-il les Multiprocesseurs Symétriques (SMP) ? </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 4.2. FreeBSD ne reconnait pas ma carte EISA SCSI Bustek 742a !</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>