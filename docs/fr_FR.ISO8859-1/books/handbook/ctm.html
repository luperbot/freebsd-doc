<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>A.4. Utiliser CTM</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="mirrors.html" title="Annexe A. Se procurer FreeBSD" /><link rel="prev" href="anoncvs.html" title="A.3. CVS anonyme" /><link rel="next" href="cvsup.html" title="A.5. Utiliser CVSup" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">A.4. Utiliser CTM</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="anoncvs.html">Précédent</a> </td><th width="60%" align="center">Annexe A. Se procurer FreeBSD</th><td width="20%" align="right"> <a accesskey="n" href="cvsup.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="ctm"></a>A.4. Utiliser CTM</h2></div></div></div><a id="idp88166992" class="indexterm"></a><p><span class="application">CTM</span> est une méthode pour
	synchroniser une arborescence de répertoires distants
	avec une arborescence centrale.  Elle a été
	développée pour être utilisée avec
	l'arborescence des sources de FreeBSD, bien que d'autres
	puissent avec le temps la trouver utile pour d'autres
	besoins.  Il existe actuellement très peu, sinon aucune,
	documentation sur la façon de créer les deltas,
	contactez-donc la liste de diffusion <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-users" target="_top">ctm-users</a> pour obtenir plus
	d'informations et si vous souhaitez utiliser
	<span class="application">CTM</span> pour autre chose.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88169296"></a>A.4.1. Pourquoi utiliser <span class="application">CTM</span>?</h3></div></div></div><p><span class="application">CTM</span> vous procurera un
	  exemplaire local de l'arborescence des sources de FreeBSD.
	  Il y a plusieurs &#8220;moutures&#8221; de l'arborescence
	  disponibles.  Que vous désiriez suivre toute l'arborescence
	  CVS ou seulement une de ses branches,
	  <span class="application">CTM</span> peut vous fournir ce dont
	  vous avez besoin.  Si vous développez activement sous
	  FreeBSD, mais ne disposez que d'une connectivité TCP/IP
	  peu fiable ou n'en avez pas du tout, ou voulez tout
	  simplement que les modifications vous soient automatiquement
	  envoyées, <span class="application">CTM</span> est ce qu'il vous
	  faut.  Il vous faudra jusqu'à trois deltas par jour sur
	  les branches les plus actives.  Cependant, vous devriez
	  envisager de vous les faire envoyer automatiquement par
	  courrier électronique.  La taille des mises à jour
	  est toujours aussi petite que possible.  Typiquement moins
	  de 5KO, occasionnellement (une fois sur 10), entre 10 et
	  50KO, et de temps à autre, une grosse modification de 100KO
	  ou plus.</p><p>Vous devrez aussi vous tenir au courant des
	  différentes contre-parties liées au fait de
	  travailler directement avec les sources en cours de
	  développement plutôt qu'avec les versions
	  publiées.  C'est particulièrement vrai si vous
	  choisissez les sources de la branche &#8220;-CURRENT&#8221;.
	  Il est recommandé de lire <a class="link" href="current-stable.html#current" title="24.4.1. Se synchroniser avec la version -CURRENT de FreeBSD">Se
	  synchroniser avec la version -CURRENT de
	  FreeBSD</a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88172752"></a>A.4.2. Que vous faut-il pour utiliser
	  <span class="application">CTM</span>?</h3></div></div></div><p>Vous aurez besoin de deux choses: le programme
	  <span class="application">CTM</span>, et les deltas initiaux
	  à lui fournir (pour mettre à jour avec la version
	  &#8220;courante&#8221;).</p><p>Le programme <span class="application">CTM</span> fait partie
	  de FreeBSD depuis la publication de la version 2.0, et se
	  trouve dans <code class="filename">/usr/src/usr.sbin/ctm</code> si
	  vous avez un exemplaire des sources en ligne.</p><p>Vous pouvez obtenir les &#8220;deltas&#8221; à
	  fournir à <span class="application">CTM</span> de deux
	  façons, par FTP ou par courrier électronique.  Si vous
	  avez un accès FTP à l'Internet, les sites suivants
	  supportent l'accès à
	  <span class="application">CTM</span>:</p><p><code class="uri"><a class="uri" href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/" target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/</a></code></p><p>ou reportez-vous à la section <a class="link" href="ctm.html#mirrors-ctm" title="A.4.9. Miroirs CTM">Sites miroirs</a>.</p><p>Allez dans le répertoire vous concernant et commencez
	  par télécharger le fichier
	  <code class="filename">README</code>.</p><p>Si vous souhaitez récupérer vos deltas par
	  courrier électronique:</p><p>Abonnez-vous à l'une des listes de distribution
	  <span class="application">CTM</span>.  <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-cvs-cur" target="_top">ctm-cvs-cur</a>
	  comprend toute l'arborescence -CURRENT.
	  <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-src-4" target="_top">ctm-src-4</a> concerne la branche 4.X, etc...
	  (Si vous ne savez pas comment vous abonner à une liste,
	  cliquez sur le nom de la liste ci-dessus ou sur
	  <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo" target="_top">http://lists.FreeBSD.org/mailman/listinfo</a> puis cliquez sur la liste à
	  laquelle vous désirez vous abonner.  La page devrait
	  contenir toutes les instructions nécessaires à
	  l'abonnement.)</p><p>Dès que vous commencez à recevoir vos
	  mises à jour <span class="application">CTM</span> par courrier
	  électronique, vous pouvez utiliser le programme
	  <code class="command">ctm_rmail</code> pour les décompacter et
	  les appliquer.  Vous pouvez en fait utiliser directement le
	  programme <code class="command">ctm_rmail</code> à partir d'une
	  entrée dans <code class="filename">/etc/aliases</code> si vous
	  voulez automatiser complètement le processus.  Consultez les
	  pages de manuel de <code class="command">ctm_rmail</code> pour plus de
	  détails.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Quelle que soit la méthode que vous utilisez
	    pour récupérer les deltas
	    <span class="application">CTM</span>, vous devriez vous abonner
	    à la liste de diffusion <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-announce" target="_top">ctm-announce</a>.
	    Ce sera, dans l'avenir, le seul endroit où les
	    annonces concernant le fonctionnement du système
	    <span class="application">CTM</span> seront faites.
	    Cliquez sur le nom de la liste et suivez les instructions
	    pour s'inscrire à la liste.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88190928"></a>A.4.3. Utiliser <span class="application">CTM</span> pour la
	  première fois</h3></div></div></div><p>Avant de pouvoir utiliser les deltas
	  <span class="application">CTM</span>, il vous faut un point de
	  départ pour appliquer les deltas générés
	  à partir de là.</p><p>Tout d'abord vous devez déterminer ce que vous
	  avez déjà.  Tout le monde peut partir d'un
	  répertoire &#8220;vide&#8221;.  Vous devez utiliser
	  un delta &#8220;Empty&#8221; (vide) au départ pour
	  débuter votre arborescence supportée par
	  <span class="application">CTM</span>.
	  Il fut question que l'un de ces deltas de départ
	  soit distribué sur le CD, cependant ce n'est
	  actuellement pas le cas.</p><p>Puisque les arborescences représentent plusieurs
	  dizaines de mégaoctets, vous préférerez
	  commencer avec ce que vous avez déjà sous la main.
	  Si vous disposez d'une version de FreeBSD sur CD, vous
	  pouvez copier ou extraire les sources initiales
	  qui s'y trouvent.  Cela évitera un transfert de
	  données conséquent.</p><p>Vous pouvez reconnaître ces deltas de transition
	  au <code class="literal">X</code> qui suit leur numéro de
	  séquence
	  (<code class="filename">src-cur.3210XEmpty.gz</code> par exemple).
	  La dénomination après le <code class="literal">X</code>
	  correspond à l'origine de votre &#8220;racine&#8221;
	  initiale.  <code class="filename">Empty</code> est un répertoire
	  vide.  La règle est qu'une transition de base à
	  partir de <code class="filename">Empty</code> est
	  générée tous les 100 deltas.  Au passage,
	  elles sont volumineuses! De 70 à 80 mégaoctets de
	  données compressées avec <code class="command">gzip</code>
	  est une taille habituelle pour les deltas
	  <code class="filename">XEmpty</code>.</p><p>Une fois que vous avez sélectionné un delta
	  initial à partir duquel commencer, il vous faudra
	  également tous les deltas de numéro supérieur
	  qui le suivent.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88201808"></a>A.4.4. Utiliser <span class="application">CTM</span> au quotidien</h3></div></div></div><p>Pour appliquer les deltas, tapez simplement:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /où/vous/voulez/mettre/les/fichiers</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ctm -v -v /où/vous/mettez/vos/deltas/src-xxx.*</code></strong></pre><p><span class="application">CTM</span> reconnaît les deltas
	  qui ont été compressés avec <code class="command">gzip</code>,
	  vous n'avez donc pas besoin de les décompresser avant,
	  ce qui économise de l'espace disque.</p><p>A moins d'être absolument sûr du résultat,
	  <span class="application">CTM</span> ne touchera pas à
	  votre arborescence.  Pour contrôler la validité
	  d'un delta, vous pouvez également utiliser
	  l'indicateur <code class="option">-c</code> et
	  <span class="application">CTM</span> ne modifiera alors pas
	  votre arborescence; il vérifiera simplement
	  l'intégrité du delta et regardera s'il peut
	  s'appliquer proprement à votre arborescence en
	  l'état.</p><p>Il y a aussi d'autres option pour
	  <span class="application">CTM</span>, voyez les pages de manuel ou
	  lisez les sources pour plus d'informations.</p><p>C'est à peu près tout.  Chaque fois que vous recevez
	  un delta, passez-le à <span class="application">CTM</span>
	  pour tenir à jour votre arborescence des sources.</p><p>N'effacez pas les deltas s'il vous est difficile de
	  les télécharger de nouveau.  Vous pouvez en avoir
	  besoin si quelque chose mauvais se produit.  Même
	  si vous n'avez que des disquettes, envisagez d'utiliser
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fdwrite&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">fdwrite</span>(1)</span></a> pour en faire une copie.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88243280"></a>A.4.5. Conserver vos modifications locales</h3></div></div></div><p>Si vous êtes développeur vous voudrez
	  expérimenter et modifier des fichiers de l'arborescence
	  des sources.  <span class="application">CTM</span> supporte
	  de façon limitée les modifications locales: avant
	  de contrôler l'existence d'un fichier
	  <code class="filename">foo</code>, il regarde tout d'abord s'il y a
	  un fichier <code class="filename">foo.ctm</code>.  Si ce fichier
	  existe, <span class="application">CTM</span> l'utilisera au lieu
	  de <code class="filename">foo</code>.</p><p>Ce comportement vous permet de conserver de façon
	  simple des modifications locales: copiez simplement les
	  fichiers que vous envisagez de modifier dans des fichiers
	  de même nom, mais avec le suffixe
	  <code class="filename">.ctm</code>.  Vous pouvez ensuite bidouiller
	  tranquillement le code, pendant que
	  <span class="application">CTM</span> maintient à jour le
	  fichier <code class="filename">.ctm</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88247888"></a>A.4.6. D'autres options intéressantes de
	  <span class="application">CTM</span></h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88248912"></a>A.4.6.1. Savoir avec précision ce que va modifier
	    une mise à jour</h4></div></div></div><p>Vous pouvez connaître la liste des modifications
	    que <span class="application">CTM</span> appliquera à
	    votre archive des sources en utilisant
	    <span class="application">CTM</span> avec l'option
	    <code class="option">-l</code>.</p><p>C'est utile si vous voulez conserver la trace des
	    modifications, pré- ou post- modifier les fichiers
	    concernés, ou vous vous sentez un tantinet
	    paranoïaque.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88251856"></a>A.4.6.2. Faire des sauvegardes avant la mise
	    à jour</h4></div></div></div><p>Parfois vous voudrez sauvegarder tous les fichiers
	    qui seraient toucher par une mise à jour
	    <span class="application">CTM</span>.</p><p>Avec l'option
	    <code class="option">-B fichier_de_sauvegarde</code>,
	    <span class="application">CTM</span> sauvegarde tous les
	    fichiers que seraient modifiés par delta
	    <span class="application">CTM</span> donné dans
	    <code class="filename">fichier_de_sauvegarde</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88255312"></a>A.4.6.3. Restreindre la liste des fichiers touchés
	    par une mise à jour</h4></div></div></div><p>Parfois vous voudrez restreindre le champ d'application
	    d'une mise à jour <span class="application">CTM</span>,
	    ou serez intéressé à n'extraire que
	    quelques fichiers d'une séquence de deltas.</p><p>Vous pouvez contrôler la liste de fichiers
	    sur laquelle travaillera <span class="application">CTM</span>
	    en donnant comme filtre une expression régulière
	    avec les options <code class="option">-e</code> et
	    <code class="option">-x</code>.</p><p>Par exemple, pour extraire une version à jour
	    de <code class="filename">lib/libc/Makefile</code> de la série
	    de deltas <span class="application">CTM</span> que vous
	    avez sauvegardé, lancez les commandes:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /where/ever/you/want/to/extract/it/</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ctm -e '^lib/libc/Makefile' ~ctm/src-xxx.*</code></strong></pre><p>Pour chaque fichier d'un delta
	    <span class="application">CTM</span>, les options
	    <code class="option">-e</code> et <code class="option">-x</code> sont
	    appliquées dans l'ordre donné sur la ligne de
	    commande.  Le fichier est traité par
	    <span class="application">CTM</span> uniquement s'il est
	    sélectionné après application des options
	    <code class="option">-e</code> et <code class="option">-x</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88268240"></a>A.4.7. Perspectives pour <span class="application">CTM</span></h3></div></div></div><p>Il y en a des tonnes:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Utiliser une méthode d'authentification
	      au système <span class="application">CTM</span> pour
	      détecter la substitution de mises à
	      jour.</p></li><li class="listitem"><p>Faire le ménage dans les options de
	      <span class="application">CTM</span>, elles commencent à
	      engendrer de la confusion et à contredire
	      l'intuition.</p></li></ul></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp88272720"></a>A.4.8. Divers</h3></div></div></div><p>Il existe aussi une séquence de deltas pour le
	  catalogue des logiciels portés, mais elle n'a pas
	  reçue beaucoup d'écho jusqu'ici.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mirrors-ctm"></a>A.4.9. Miroirs <span class="application">CTM</span></h3></div></div></div><p><a class="link" href="ctm.html" title="A.4. Utiliser CTM">CTM</a>/FreeBSD est disponible via
      FTP anonyme sur les miroirs suivants.  Si vous faites le choix
      de vous procurer <span class="application">CTM</span> via FTP anonyme,
      utilisez s'il vous plaît un site proche de vous.</p><p>En cas de problème, contactez la liste de diffusion
      <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-users" target="_top">ctm-users</a>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Californie, Bay Area, source officielle</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li></ul></div></dd><dt><span class="term">Afrique du Sud, serveur de sauvegarde pour les anciens
	  deltas</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/" target="_top">ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/</a></code></p></li></ul></div></dd><dt><span class="term">Taïwan/R.O.C.</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li></ul></div></dd></dl></div><p>Si vous n'avez pas trouvé de miroir proche de vous,
      où si le miroir est incomplet, essayez d'utiliser un moteur
      de recherche comme
      <a class="link" href="http://www.alltheweb.com/" target="_top">alltheweb</a>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="anoncvs.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="mirrors.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="cvsup.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">A.3. CVS anonyme </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> A.5. Utiliser CVSup</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>