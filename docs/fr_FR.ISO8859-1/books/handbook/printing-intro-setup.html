<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>10.3. Configuration de base</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="printing.html" title="Chapitre 10. Imprimer" /><link rel="prev" href="printing-intro-spooler.html" title="10.2. Introduction" /><link rel="next" href="printing-advanced.html" title="10.4. Configuration avancée de l'imprimante" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">10.3. Configuration de base</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="printing-intro-spooler.html">Précédent</a> </td><th width="60%" align="center">Chapitre 10. Imprimer</th><td width="20%" align="right"> <a accesskey="n" href="printing-advanced.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="printing-intro-setup"></a>10.3. Configuration de base</h2></div></div></div><p>Pour utiliser des imprimantes avec le gestionnaire
      d'impression, il vous faudra configurer à la fois la
      partie matérielle (c'est à dire les imprimantes)
      et la partie logicielle (c'est à dire
      <span class="application">LPD</span>).  Ce document présente
      deux niveaux de configuration:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>La section <a class="link" href="printing-intro-setup.html#printing-simple" title="10.3.1. Configuration simple de l'imprimante">Configuration
	  simple de l'imprimante</a> vous apprendra à
	  connecter une imprimante, à renseigner
	  <span class="application">LPD</span> sur la façon dont il
	  doit communiquer avec elle, et à imprimer de simples
	  fichiers textes.</p></li><li class="listitem"><p>La section <a class="link" href="printing-advanced.html" title="10.4. Configuration avancée de l'imprimante">Configuration avancée de
	  l'imprimante</a> vous apprendra à imprimer
	  différents formats de fichiers, des pages
	  d'en-tête, par l'intermédiaire d'un
	  réseau, à contrôler l'accès aux
	  imprimantes, et comptabiliser leur utilisation.</p></li></ul></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-simple"></a>10.3.1. Configuration simple de l'imprimante</h3></div></div></div><p>Cette section vous apprendra à configurer
	l'imprimante et <span class="application">LPD</span>.  Elle
	présente les bases:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>La section <a class="link" href="printing-intro-setup.html#printing-hardware" title="10.3.1.1. Configuration matérielle">Configuration
	    matérielle</a> donne des indications sur la
	    façon de connecter l'imprimante à l'un des
	    ports de votre ordinateur.</p></li><li class="listitem"><p>La section <a class="link" href="printing-intro-setup.html#printing-software" title="10.3.1.2. Configuration logicielle">Configuration
	    logicielle</a> montre comment renseigner le fichier de
	    configuration du gestionnaire d'impression
	    <span class="application">LPD</span>
	    (<code class="filename">/etc/printcap</code>).</p></li></ul></div><p>Si vous mettez en oeuvre une imprimante
	réceptionnant les données à imprimer via
	un protocole réseau plutôt que par les interfaces
	locales de l'ordinateur, lisez la section <a class="link" href="printing-advanced.html#printing-advanced-network-net-if" title="10.4.3.2. Imprimantes avec des interfaces utilisant des flux réseau">Imprimantes avec
	des interfaces utilisant des flux réseau</a>.</p><p>Bien que cette section soit intitulée
	<span class="quote">« <span class="quote">Configuration simple de l'imprimante</span> »</span>, elle
	s'avère en réalité plutôt complexe.
	La partie la plus difficile consiste à faire
	fonctionner l'imprimante avec votre ordinateur et
	<span class="application">LPD</span>.  Les options avancées
	telles les pages d'en-tête ou les statistiques sont
	relativement faciles à mettre en oeuvre une fois que
	l'imprimante fonctionne.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-hardware"></a>10.3.1.1. Configuration matérielle</h4></div></div></div><p>Cette section détaille les différentes
	  manières de connecter une imprimante à votre
	  PC.  Elle discute les types de ports et de câbles, et
	  de la configuration noyau dont vous pourriez avoir besoin
	  afin que FreeBSD puisse communiquer avec l'imprimante.</p><p>Si vous avez déjà connecté votre
	  imprimante et réussi à imprimer sous un autre
	  système d'exploitation, vous pouvez probablement
	  passer à la section <a class="link" href="printing-intro-setup.html#printing-software" title="10.3.1.2. Configuration logicielle">Configuration
	  logicielle</a>.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-ports"></a>10.3.1.1.1. Les ports et les câbles</h5></div></div></div><p>Les imprimantes pour PC vendues aujourd'hui sont en
	    général pourvues d'une ou plusieurs des
	    trois interfaces suivantes:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a id="idp73504848" class="indexterm"></a><p>Les interfaces <span class="emphasis"><em>série</em></span>,
	       également connues sous les noms RS-232 ou ports
	       COM, utilisent un port série sur votre
	       ordinateur pour envoyer des données à
	       l'imprimante.  Les interfaces série sont
	       courantes, dans l'industrie informatique, et les
	       câbles sont à la fois disponibles et
	       faciles à réaliser.  Elles
	       réclament parfois des câbles
	       spéciaux et peuvent nécessiter le
	       paramétrage d'options de communication assez
	       complexes.  La plupart des ports série PC ont
	       une vitesse de transmission maximale de 115200 bps, ce
	       qui rend l'impression de travaux comportant beaucoup de
	       graphismes malaisée.</p></li><li class="listitem"><a id="idp73507152" class="indexterm"></a><p>Les interfaces
	       <span class="emphasis"><em>parallèles</em></span> utilisent un
	       port parallèle sur votre ordinateur pour envoyer
	       des données à l'imprimante.  Les
	       interfaces parallèles sont courantes dans
	       l'industrie informatique et plus rapides que les
	       interfaces série RS-232.  Les câbles sont
	       disponibles mais sont moins faciles à fabriquer
	       à la main. En général, il n'y a
	       aucune option de communication à
	       paramétrer avec ces interfaces, ce qui rend leur
	       configuration particulièrement simple.</p><a id="idp73517392" class="indexterm"></a><p>Les interfaces parallèles sont parfois
	       appelées <span class="quote">« <span class="quote">Centronics</span> »</span>, nom
	       tiré du type de connecteur de
	       l'imprimante</p></li><li class="listitem"><a id="idp73519824" class="indexterm"></a><p>Les interfaces USB, tenant leur nom de
	       <span class="quote">« <span class="quote">Universal Serial Bus</span> »</span>, ou <span class="quote">« <span class="quote">Bus
	       Série Universel</span> »</span>, s'avèrent plus
	       véloces encore que les interfaces
	       parallèles ou série RS-232.  Les
	       câbles sont simples et peu onéreux. L'USB
	       surpasse les interfaces série RS-232 et
	       parallèles pour l'impression, mais son support
	       par les systèmes <span class="trademark">UNIX</span>® n'est pas aussi bon.
	       Une façon d'éviter ce problème est
	       d'acheter une imprimante qui dispose à la fois
	       d'une interface USB et d'une interface
	       parallèle, comme beaucoup de
	       modèles.</p></li></ul></div><p>En règle générale, les interfaces
	    parallèles n'offrent qu'une communication
	    unidirectionnelle (de l'ordinateur vers l'imprimante)
	    alors que les interfaces série et USB permettent un
	    échange bidirectionnel.  Les imprimantes et ports
	    parallèles plus récents (EPP et ECP) peuvent
	    communiquer dans les deux sens sous FreeBSD lorsque l'on a
	    recourt à un câble conforme à la norme
	    IEEE-1284.</p><a id="idp73523280" class="indexterm"></a><p>La communication bidirectionnelle avec l'imprimante en
	    utilisant un port parallèle se fait en
	    général de l'une des deux manières
	    suivantes.  La première utilise un pilote
	    d'imprimante compilé pour FreeBSD comprenant le
	    langage propriétaire de l'imprimante.  C'est
	    couramment le cas des imprimantes jet d'encre et cela peut
	    être utilisé pour retourner les niveaux
	    d'encre et autres informations d'état.  La seconde
	    méthode est employée lorsque l'imprimante
	    supporte <span class="trademark">PostScript</span>®.</p><p>Les travaux <span class="trademark">PostScript</span>® sont en fait des programmes
	    envoyés à l'imprimante.  Ils ne
	    génèrent pas nécessairement de sortie
	    papier et peuvent retourner leurs résultats
	    directement à l'ordinateur.  <span class="trademark">PostScript</span>® utilise
	    aussi la communication bidirectionnelle pour avertir
	    l'ordinateur de problèmes, comme des erreurs dans
	    le programme <span class="trademark">PostScript</span>® ou des bourrages papier.  Vos
	    utilisateurs apprécieraient certainement de telles
	    informations.  De surcroît, la meilleure
	    façon de tenir des statistiques sérieusement
	    avec une imprimante <span class="trademark">PostScript</span>® nécessite la
	    communication bidirectionnelle: on demande à
	    l'imprimante quel est son compteur de pages (combien en
	    a-t-elle imprimées depuis sa fabrication), puis on
	    lui envoie le travail de l'utilisateur, enfin on lui
	    redemande son compteur de pages.  La différence
	    entre les deux valeurs donne la consommation de papier que
	    vous pouvez attribuer à cet utilisateur.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-parallel"></a>10.3.1.1.2. Les ports parallèles</h5></div></div></div><p>Pour raccorder une imprimante utilisant une interface
	    parallèle, branchez le câble Centronics sur
	    l'imprimante et sur l'ordinateur.  Les instructions
	    accompagnant l'imprimante, l'ordinateur, ou les deux,
	    devraient parfaitement vous renseigner.</p><p>Souvenez-vous du port parallèle que vous avez
	    utilisé sur l'ordinateur.  Pour FreeBSD, le premier se
	    nomme <code class="filename">ppc0</code>; le deuxième,
	    <code class="filename">ppc1</code>, et ainsi de suite.  Le nom du
	    fichier spécial de périphérique de
	    l'imprimante suit les mêmes règles:
	    <code class="filename">/dev/lpt0</code> pour celle connectée
	    sur le premier port parallèle, etc.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-serial"></a>10.3.1.1.3. Les ports série</h5></div></div></div><p>Pour raccorder une imprimante utilisant une interface
	    série, branchez le câble série
	    adéquat sur l'imprimante et sur l'ordinateur.  Les
	    instructions accompagnant l'imprimante, l'ordinateur, ou
	    les deux, devraient parfaitement vous renseigner.</p><p>Si vous n'êtes pas sûr de savoir quel est
	    le bon câble, voici ce que vous pouvez
	    essayer:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Un câble <span class="emphasis"><em>modem</em></span> relie
		chacune des broches du connecteur depuis l'une des
		extrémités du câble directement
		à la broche lui correspondant dans le
		connecteur de l'autre extrémité.  Ce
		type de câble est également connu sous le
		nom de câble <span class="quote">« <span class="quote">DTE-to-DCE</span> »</span>.</p></li><li class="listitem"><a id="idp66939344" class="indexterm"></a><p>Un câble <span class="emphasis"><em>null-modem</em></span>
		relie certaines des broches directement, en
		intervertit d'autres (par exemple,
		<span class="quote">« <span class="quote">émission de données</span> »</span> et
		<span class="quote">« <span class="quote">réception de données</span> »</span>), et
		en court-circuite d'autres en interne sur chacun des
		sertissages des connecteurs.  Ce type de câble
		est également connu sous le nom de câble
		<span class="quote">« <span class="quote">DTE-to-DTE</span> »</span>.</p></li><li class="listitem"><p>Un câble <span class="emphasis"><em>série pour
		imprimante</em></span>, requis par certaines
		imprimantes peu conventionnelles, ressemble au
		câble null-modem, à ceci près
		qu'il envoie certains signaux à l'autre
		extrémité au lieu de les court-circuiter
		en interne.</p></li></ul></div><a id="idp66943184" class="indexterm"></a><a id="idp66943696" class="indexterm"></a><a id="idp66944208" class="indexterm"></a><p>Vous devriez également définir les
	    paramètres de communication pour l'imprimante,
	    d'ordinaire en utilisant les contrôles sur la face
	    avant ou les commutateurs sur l'imprimante.  Choisissez la
	    valeur la plus élevée de
	    <code class="literal">bps</code> (bits par seconde, encore
	    appelés <span class="quote">« <span class="quote">vitesse de transmission</span> »</span>)
	    autorisée conjointement par votre ordinateur et
	    votre imprimante.  Choisissez 7 ou 8 bits de
	    données; aucun contrôle de parité ou
	    un bit de parité paire ou impaire; et 1 ou 2 bits
	    d'arrêt.  Choisissez également un protocole
	    de contrôle de flux: soit aucun, soit XON/XOFF
	    (également appelé <span class="quote">« <span class="quote">in-band</span> »</span>, ou
	    encore <span class="quote">« <span class="quote">contrôle logiciel</span> »</span>).  Retenez
	    ces paramètres pour la configuration logicielle,
	    dans la section qui suit.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-software"></a>10.3.1.2. Configuration logicielle</h4></div></div></div><p>Cette section détaille la configuration
	  logicielle nécessaire pour imprimer sous FreeBSD avec le
	  gestionnaire d'impression
	  <span class="application">LPD</span>.</p><p>Voici un aperçu des étapes à
	  suivre:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Configurez le noyau, si nécessaire, pour
	      utiliser le port sur lequel vous raccorderez votre
	      imprimante; la section <a class="link" href="printing-intro-setup.html#printing-kernel" title="10.3.1.2.1. Configuration du noyau">Configurer le noyau de
	      FreeBSD</a> vous donnera la marche à
	      suivre.</p></li><li class="step"><p>Paramétrez le mode de communication du port
	      parallèle si vous utilisez une imprimante de ce
	      type; la section <a class="link" href="printing-intro-setup.html#printing-parallel-port-mode" title="10.3.1.3. Paramétrer le mode de communication du port parallèle">Paramétrer
	      le mode de communication du port parallèle</a>
	      vous donnera les détails.</p></li><li class="step"><p>Configurez <span class="application">LPD</span> pour qu'il
	      communique avec l'imprimante en renseignant le fichier
	      <code class="filename">/etc/printcap</code>.  Vous apprendrez
	      comment faire un peu plus loin dans ce chapitre.</p></li></ol></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-kernel"></a>10.3.1.2.1. Configuration du noyau</h5></div></div></div><p>Le noyau du système d'exploitation est
	    compilé avec le support d'un certain ensemble de
	    périphériques.  Les interfaces série
	    ou parallèle de votre imprimante en font partie.
	    De ce fait, vous pourriez avoir à ajouter le
	    support d'un port série ou parallèle
	    supplémentaire si votre noyau n'a pas
	    déjà été configuré en
	    ce sens.</p><p>Pour savoir si le support d'une interface série
	    est activé dans le noyau que vous êtes en
	    train d'utiliser, entrez:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>grep sioN /var/run/dmesg.boot</code></strong></pre><p>Où <em class="replaceable"><code>N</code></em>
	    représente le numéro du port série,
	    en commençant à zéro.  Si vous
	    obtenez un affichage similaire à:</p><pre class="screen">sio2 at port 0x3e8-0x3ef irq 5 on isa sio2: type 16550A</pre><p>alors le port est activé dans le noyau.</p><p>Pour savoir si le noyau supporte une interface
	    parallèle, entrez:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>grep ppcN /var/run/dmesg.boot</code></strong></pre><p>Où <em class="replaceable"><code>N</code></em>
	    représente le numéro du port
	    parallèle, en commençant à
	    zéro.  Si vous obtenez un affichage similaire
	    à:</p><pre class="screen">ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
ppc0: SMC-like chipset (ECP/EPP/PS2/NIBBLE) in COMPATIBLE mode
ppc0: FIFO with 16/16/8 bytes threshold</pre><p>alors le port est activé dans le noyau.</p><p>Il se pourrait que vous ayez à reconfigurer le
	    noyau afin que le système détecte et puisse
	    utiliser un port parallèle ou série auquel
	    vous avez connecté votre imprimante.</p><p>Pour ajouter le support d'un port série, voyez
	    la section sur la configuration du noyau.  Pour ajouter le
	    support du port parallèle, voyez cette même
	    section <span class="emphasis"><em>et</em></span> celle qui suit.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-parallel-port-mode"></a>10.3.1.3. Paramétrer le mode de communication du port
	  parallèle</h4></div></div></div><p>Lorsque vous utilisez l'interface parallèle, vous
	  avez le choix entre deux modes de communication avec
	  l'imprimante: par interruption, ou par polling
	  (interrogation régulière ou scrutation).  Le
	  pilote d'imprimante générique (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpt&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">lpt</span>(4)</span></a>) de
	  FreeBSD utilise le système <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppbus&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ppbus</span>(4)</span></a>, qui
	  contrôle le chipset du port via le pilote
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ppc</span>(4)</span></a>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Le mode par <span class="emphasis"><em>interruption</em></span> est le
	      mode par défaut avec un noyau GENERIC.  De cette
	      manière, le système d'exploitation utilise
	      une ligne d'interruption (IRQ) pour déterminer si
	      l'imprimante est prête à recevoir des
	      données.</p></li><li class="listitem"><p>Le mode <span class="emphasis"><em>par scrutation</em></span> enjoint
	      au système d'exploitation d'interroger à
	      intervalles réguliers l'imprimante pour savoir si
	      elle est prête à recevoir d'autres
	      données.  Lorsqu'elle répond par
	      l'affirmative, le noyau lui en envoie plus.</p></li></ul></div><p>Le mode par interruption est en général
	  nettement plus rapide, mais consomme une précieuse
	  ligne d'interruption (IRQ).  On rapporte que certaines
	  imprimantes HP récentes ne fonctionneraient pas
	  correctement en mode par interruption, apparemment à
	  cause d'un problème (pas encore très bien
	  identifié) d'horloge.  Ces imprimantes
	  nécessitent le recours au mode par scrutation.
	  Utilisez celui des deux qui fonctionne.  Certaines
	  imprimantes fonctionnent dans les deux modes, mais
	  s'avèrent désagréablement lentes en
	  mode par interruption.</p><p>Vous pouvez choisir le mode de communication de deux
	  manières différentes: en configurant le noyau
	  ou en utilisant le programme <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lptcontrol</span>(8)</span></a>.</p><p><span class="emphasis"><em>Pour paramétrer le mode de
	  communication en configurant le noyau:</em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Editez le fichier de configuration de votre noyau.
	      Cherchez une entrée <code class="literal">ppc0</code>.  Si
	      vous voulez configurer le deuxième port
	      parallèle, cherchez plutôt
	      <code class="literal">ppc1</code>.  Ou <code class="literal">ppc2</code>
	      pour le troisième, et ainsi de suite.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Si vous souhaitez activer le mode par
		  interruption, éditez la ligne
		  suivante:</p><pre class="programlisting">hint.ppc.0.irq="<em class="replaceable"><code>N</code></em>"</pre><p>dans le fichier
		  <code class="filename">/boot/device.hints</code> et remplacez
		  <em class="replaceable"><code>N</code></em> par le numéro
		  d'IRQ approprié.  Le fichier de configuration
		  du noyau doit également comporter le pilote
		  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ppc</span>(4)</span></a>:</p><pre class="programlisting">device ppc</pre></li><li class="listitem"><p>Si vous souhaitez activer le mode par
		  scrutation, ôtez la ligne suivante de votre
		  fichier
		  <code class="filename">/boot/device.hints</code>:</p><pre class="programlisting">hint.ppc.0.irq="<em class="replaceable"><code>N</code></em>"</pre><p>Dans certains cas, positionner le port en mode
		  scrutation sous FreeBSD n'est pas suffisant.  La
		  plupart du temps cela vient du pilote <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">acpi</span>(4)</span></a>,
		  ce dernier étant capable de sonder et
		  d'attacher des périphériques, et donc
		  de contrôler le mode d'accès au port de
		  l'imprimante.  Vous devrez donc vérifier
		  votre configuration <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">acpi</span>(4)</span></a> pour
		  résoudre ce problème.</p></li></ul></div></li><li class="step"><p>Sauvegardez le fichier, puis configurez, compilez,
	      et installez le noyau avant de redémarrer.
	      Consultez la section <a class="link" href="kernelconfig.html" title="Chapitre 9. Configurer le noyau de FreeBSD">configuration du noyau</a>
	      pour plus de détails.</p></li></ol></div><p><span class="emphasis"><em>Pour paramétrer le mode de
	  communication avec</em></span> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lptcontrol</span>(8)</span></a>:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Entrez:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptcontrol -i -d /dev/lptN</code></strong></pre><p>pour sélectionner le mode par interruption
	      pour
	      <code class="literal">lptN</code>.</p></li><li class="step"><p>Entrez:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptcontrol -p -d /dev/lptN</code></strong></pre><p>pour sélectionner le mode par scrutation pour
	      <code class="literal">lptN</code>.</p></li></ol></div><p>Vous pouvez placer ces commandes dans votre fichier
	  <code class="filename">/etc/rc.local</code> pour sélectionner
	  le mode à chaque démarrage du système.
	  Consultez <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lptcontrol</span>(8)</span></a> pour obtenir plus
	  d'informations.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-testing"></a>10.3.1.4. Vérifier la communication avec
	  l'imprimante</h4></div></div></div><p>Avant de passer à la configuration du
	  gestionnaire d'impression, vous devriez vous assurer que le
	  système d'exploitation fait parvenir avec
	  succès des données à l'imprimante.  Il
	  est beaucoup plus facile de déboguer
	  séparément la communication avec l'imprimante
	  et la configuration du gestionnaire d'impression.</p><p>Pour tester l'imprimante, nous allons lui envoyer du
	  texte.  Pour les imprimantes qui peuvent
	  immédiatement imprimer les caractères qui leur
	  sont envoyés, le programme <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a> est
	  parfait: il génère les 96 caractères
	  ASCII imprimables sur 96 lignes.</p><a id="idp73628624" class="indexterm"></a><p>Pour une imprimante <span class="trademark">PostScript</span>® (ou basée sur un
	  autre langage), il va nous falloir un test plus
	  sophistiqué.  Un petit programme <span class="trademark">PostScript</span>®, tel
	  que celui qui suit, devrait suffire:</p><pre class="programlisting">%!PS
100 100 moveto 300 300 lineto stroke
310 310 moveto /Helvetica findfont 12 scalefont setfont
(Is this thing working?) show
showpage</pre><p>Le code <span class="trademark">PostScript</span>® ci-dessus peut être
	  placé dans un fichier et utilisé comme
	  indiqué dans les exemples qui apparaissent dans les
	  sections suivantes.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><a xmlns="http://www.w3.org/1999/xhtml" id="idp73632208" class="indexterm"></a><p xmlns="http://www.w3.org/1999/xhtml">Lorsque ce document fait référence
	    à un langage d'imprimante, il suppose un langage
	    comme <span class="trademark">PostScript</span>®, et pas le PCL de Hewlett-Packard.
	    Quoique PCL dispose de fonctionnalités
	    intéressantes, il est possible de mélanger
	    du texte simple avec des séquences
	    d'échappement.  <span class="trademark">PostScript</span>® ne permet pas
	    d'imprimer du texte clair, c'est le type de langage
	    d'imprimante pour lequel nous devons prendre des mesures
	    particulières.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-checking-parallel"></a>10.3.1.4.1. Tester une imprimante parallèle</h5></div></div></div><a id="idp73635024" class="indexterm"></a><p>Cette section vous apprendra à vérifier
	    si FreeBSD peut communiquer avec une imprimante
	    connectée sur un port parallèle.</p><p><span class="emphasis"><em>Pour tester une imprimante connectée
	    sur un port parallèle:</em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Passez en <code class="systemitem">root</code> avec
		<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=su&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">su</span>(1)</span></a>.</p></li><li class="step"><p>Envoyez des données à
		l'imprimante.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Si l'imprimante peut sortir du texte simple,
		    alors utilisez <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a>.  Entrez:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptest &gt; /dev/lptN</code></strong></pre><p>Où <em class="replaceable"><code>N</code></em> est le
		    numéro du port parallèle, en
		    commençant à zéro.</p></li><li class="listitem"><p>Si l'imprimante comprend le <span class="trademark">PostScript</span>® ou un
		    autre langage d'imprimante, alors envoyez lui un
		    petit programme.  Entrez:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cat &gt; /dev/lptN</code></strong></pre><p>Tapez ensuite le programme, ligne à
		    ligne et <span class="emphasis"><em>attentivement</em></span>, car
		    vous ne pouvez plus éditer une ligne une
		    fois que vous avez appuyé sur la touche
		    <code class="literal">Retour Chariot</code> ou
		    <code class="literal">Entrée</code>.  Une fois
		    terminé, faites
		    <code class="literal">CONTROL+D</code>, ou la combinaison
		    correspondant à votre fin de
		    fichier.</p><p>Une autre manière de procéder
		    est de placer le programme dans un fichier et
		    d'entrer:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cat fichier &gt; /dev/lptN</code></strong></pre><p>Où <em class="replaceable"><code>fichier</code></em>
		    désigne le nom du fichier que vous
		    désirez envoyer à
		    l'imprimante.</p></li></ul></div></li></ol></div><p>Vous devriez voir quelque chose s'imprimer.  Ne vous
	    inquiétez pas si l'apparence du texte n'est pas
	    satisfaisante; nous remédierons à ce genre
	    de soucis plus tard.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-checking-serial"></a>10.3.1.4.2. Tester une imprimante série</h5></div></div></div><a id="idp73655632" class="indexterm"></a><p>Dans cette section vous apprendrez à
	    vérifier si FreeBSD parvient à communiquer avec
	    une imprimante connectée à un port
	    série.</p><p><span class="emphasis"><em>Pour tester une imprimante connectée
	    sur un port série:</em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Passez en <code class="systemitem">root</code> avec
	      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=su&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">su</span>(1)</span></a>.</p></li><li class="step"><p>Editez le fichier
		<code class="filename">/etc/remote</code>.  Ajoutez
		l'entrée suivante:</p><pre class="programlisting">printer:dv=/dev/<em class="replaceable"><code>port</code></em>:br#<em class="replaceable"><code>bps-rate</code></em>:pa=<em class="replaceable"><code>parity</code></em></pre><a id="idp73662672" class="indexterm"></a><a id="idp73663184" class="indexterm"></a><a id="idp73663696" class="indexterm"></a><p>Où <em class="replaceable"><code>port</code></em>
		représente le fichier de
		périphérique du port série
		(<code class="literal">ttyd0</code>, <code class="literal">ttyd1</code>,
		etc.), <em class="replaceable"><code>bps-rate</code></em>
		représente la vitesse en bits-par-seconde
		à laquelle l'imprimante communique, et
		<em class="replaceable"><code>parity</code></em> représente la
		parité réclamée par l'imprimante
		(<code class="literal">even</code> pour paire,
		<code class="literal">odd</code> pour impaire,
		<code class="literal">none</code> pour aucune, ou
		<code class="literal">zero</code> pour zéro).</p><p>Voici un exemple d'entrée pour une
		imprimante connectée à 19200 bps,
		sans parité, sur le troisième port
		série:</p><pre class="programlisting">printer:dv=/dev/ttyd2:br#19200:pa=none</pre></li><li class="step"><p>Connectez-vous à l'imprimante avec
	        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a>.  Entrez:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>tip printer</code></strong></pre><p>Si cette étape ne fonctionne pas,
		éditez le fichier
		<code class="filename">/etc/remote</code> à nouveau et
		essayez d'utiliser
		<code class="filename">/dev/cuaaN</code>
		au lieu de
		<code class="filename">/dev/ttydN</code>.</p></li><li class="step"><p>Envoyez des données à
		l'imprimante.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Si l'imprimante peut sortir du texte simple,
		    alors utilisez <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a>.  Entrez:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>$lptest</code></strong></pre></li><li class="listitem"><p>Si l'imprimante comprend le <span class="trademark">PostScript</span>® ou
		    tout autre langage d'imprimante, envoyez-lui un
		    petit programme.  Entrez-le ligne à ligne
		    et <span class="emphasis"><em>très attentivement</em></span>,
		    dans la mesure où les touches
		    d'édition, comme retour-arrière,
		    peuvent revêtir une signification
		    particulière pour l'imprimante.  Vous
		    pourriez également avoir besoin d'un
		    caractère de fin de fichier
		    (<span class="quote">« <span class="quote">EOF</span> »</span>) particulier pour que
		    l'imprimante sache qu'elle a reçu tout le
		    programme.  Pour les imprimantes <span class="trademark">PostScript</span>®,
		    appuyez sur <code class="literal">CONTROL+D</code>.</p><p>Une autre manière de procéder
		    est de placer le programme dans un fichier et
		    d'entrer:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>&gt;fichier</code></strong></pre><p>Où <em class="replaceable"><code>fichier</code></em>
		    est le nom du fichier contenant le programme.
		    Après avoir envoyé le fichier avec
		    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a>, appuyez sur la touche de fin de
		    fichier appropriée.</p></li></ul></div></li></ol></div><p>Vous devriez voir quelque chose s'imprimer.  Ne vous
	    inquiétez pas si l'apparence du texte n'est pas
	    satisfaisante; nous remédierons à ce genre
	    de soucis plus tard.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-printcap"></a>10.3.1.5. Mettre en place le gestionnaire d'impression: le
	  fichier <code class="filename">/etc/printcap</code></h4></div></div></div><p>A ce stade, votre imprimante doit être
	  branchée, votre noyau configuré pour
	  communiquer avec elle (si cela est nécessaire); et
	  vous avez réussi à faire parvenir des
	  données simples à l'imprimante.  Nous sommes
	  maintenant prêts à paramétrer
	  <span class="application">LPD</span> pour qu'il contrôle
	  l'accès à l'imprimante.</p><p><span class="application">LPD</span> se paramètre en
	  éditant le fichier
	  <code class="filename">/etc/printcap</code>.  Le gestionnaire
	  d'impression <span class="application">LPD</span> le lit à
	  chaque fois que le gestionnaire est solicité, donc
	  les mises à jour du fichier sont immédiatement
	  prises en compte.</p><a id="idp73699280" class="indexterm"></a><p>Le format du fichier <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=printcap&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">printcap</span>(5)</span></a> est explicite.
	  Utilisez votre éditeur favori pour modifier
	  <code class="filename">/etc/printcap</code>.  Le format est identique
	  aux autres fichiers de configuration comme
	  <code class="filename">/usr/share/misc/termcap</code> et
	  <code class="filename">/etc/remote</code>.  Pour obtenir des
	  informations complètes concernant ce format,
	  consultez <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cgetent&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">cgetent</span>(3)</span></a>.</p><p>Le paramétrage simple du gestionnaire
	  d'impression s'effectue selon les étapes
	  suivantes:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Choisissez un nom (et quelques alias
	      appropriés) pour l'imprimante, et placez-les dans
	      <code class="filename">/etc/printcap</code>; lisez la section
	      <a class="link" href="printing-intro-setup.html#printing-naming" title="10.3.1.5.1. Nommer l'imprimante">Nommer
	      l'imprimante</a> pour plus d'informations sur le
	      nommage.</p></li><li class="step"><a id="idp73710288" class="indexterm"></a><p>Désactivez les pages d'en-tête (elles
	      sont activées par défaut) en
	      insérant le paramètre
	      <code class="literal">sh</code>; lisez la section <a class="link" href="printing-intro-setup.html#printing-no-header-pages" title="10.3.1.5.2. Supprimer les pages d'en-tête">Supprimer les pages
	      d'en-tête</a> pour plus d'informations.</p></li><li class="step"><p>Créez un répertoire de file d'attente,
	      et précisez son chemin d'accès avec le
	      paramètre <code class="literal">sd</code>; lisez la section
	      <a class="link" href="printing-intro-setup.html#printing-spooldir" title="10.3.1.5.3. Créer le répertoire de file d'attente">Créer le
	      répertoire de fil d'attente</a> pour obtenir
	      plus d'informations.</p></li><li class="step"><p>Sélectionnez l'entrée
	      <code class="filename">dev</code> à utiliser pour
	      l'imprimante, et notez la dans
	      <code class="filename">/etc/printcap</code> avec le
	      paramètre <code class="literal">lp</code>; lisez la section
	      <a class="link" href="printing-intro-setup.html#printing-device" title="10.3.1.5.4. Identifier le périphérique d'imprimante">Identifier le
	      périphérique d'imprimante</a> pour
	      obtenir plus d'informations.  De plus, si l'imprimante
	      est reliée par un port série,
	      précisez les paramètres de communication
	      avec le paramètre <code class="literal">ms#</code>, qui est
	      détaillé dans la section <a class="link" href="printing-intro-setup.html#printing-commparam" title="10.3.1.5.5. Configurer les paramètres de communication du gestionnaire d'impression">Configurer les
	      paramètres de communication du gestionnaire
	      d'impression</a>.</p></li><li class="step"><p>Installez un filtre d'entrée sous forme de
	      fichier texte simple; lisez la section <a class="link" href="printing-intro-setup.html#printing-textfilter" title="10.3.1.5.6. Installer le filtre texte">Installer le filtre
	      texte</a> pour obtenir plus de détails.</p></li><li class="step"><p>Testez la configuration en imprimant quelque chose
	      avec la commande <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a>.  Vous trouverez plus de
	      détails dans les sections <a class="link" href="printing-intro-setup.html#printing-trying" title="10.3.1.5.8. Tester la configuration">Tester l'impression</a> et
	      <a class="link" href="printing-troubleshooting.html" title="10.7. Troubleshooting ** Traduction en Cours **">Résolution des
	      problèmes</a>.</p></li></ol></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Les imprimantes basées sur un langage d'impression,
	    telles les imprimantes <span class="trademark">PostScript</span>®, ne peuvent imprimer
	    du texte simple directement.  La configuration simple
	    esquissée ci-dessus et détaillée dans
	    les sections suivantes présuppose que si vous
	    installez ce genre d'imprimante vous n'imprimerez que des
	    fichiers qu'elle peut comprendre.</p></div><p>Les utilisateurs s'attendent souvent à pouvoir
	  imprimer du texte simple sur n'importe laquelle des
	  imprimante installées sur votre système.  Les
	  applications qui s'en remettent à
	  <span class="application">LPD</span> pour imprimer s'y attendent
	  en général elles aussi.  Si vous installez ce
	  genre d'imprimante et désirez pouvoir imprimer
	  à la fois des travaux dans le langage de l'imprimante
	  <span class="emphasis"><em>et</em></span> des travaux en texte simple, vous
	  êtes instamment prié d'ajouter une étape
	  supplémentaire à la configuration simple
	  esquissée ci-dessus: installez un programme de
	  conversion automatique texte simple vers <span class="trademark">PostScript</span>® (ou
	  tout autre langage d'imprimante).  La section <a class="link" href="printing-advanced.html#printing-advanced-if-conversion" title="10.4.1.2. Gérer les travaux d'impression de texte brut sur des imprimantes PostScript®">Prendre en charge
	  des travaux texte sur des imprimantes <span class="trademark">PostScript</span>®</a>
	  vous apprendra à le faire.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-naming"></a>10.3.1.5.1. Nommer l'imprimante</h5></div></div></div><p>La première étape (facile) est de
	    choisir un nom pour l'imprimante.  Que vous choisissiez un
	    nom fonctionnel ou fantaisiste n'a aucune importance
	    puisque vous pouvez également fournir une
	    série d'alias.</p><p>Au moins l'une des imprimantes définies dans le
	    fichier <code class="filename">/etc/printcap</code> devrait avoir
	    pour alias <code class="literal">lp</code>.  C'est le nom de
	    l'imprimante par défaut.  Si les utilisateurs n'ont
	    pas positionné la variable d'environnement
	    <code class="envar">PRINTER</code> et ne spécifient pas le nom
	    d'une imprimante lorsqu'ils utilisent une ligne de
	    commande relative à <span class="application">LPD</span>,
	    <code class="literal">lp</code> sera l'imprimante par défaut
	    utilisée.</p><p>Par ailleurs, l'usage commun veut que le dernier alias
	    d'une imprimante en soit une description complète,
	    en incluant le fabricant et le modèle.</p><p>Une fois le nom et des alias communs choisis,
	    placez-les dans le fichier
	    <code class="filename">/etc/printcap</code>.  Le nom de
	    l'imprimante devrait commencer dans la colonne la plus
	    à gauche.  Séparez chaque alias par une
	    barre verticale et mettez le caractère deux-points
	    après le dernier alias.</p><p>Dans l'exemple suivant, nous commençons avec le
	    squelette d'un <code class="filename">/etc/printcap</code> qui
	    définit deux imprimantes (une Diablo 630 et une
	    imprimante <span class="trademark">PostScript</span>® laser Panasonic KX-P4455):</p><pre class="programlisting">#
#  /etc/printcap for host rose
#
rattan|line|diablo|lp|Diablo 630 Line Printer:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:</pre><p>Dans cet exemple, la première imprimante se
	    nomme <code class="literal">rattan</code> et possède les
	    alias suivants: <code class="literal">line</code>,
	    <code class="literal">diablo</code>, <code class="literal">lp</code> et
	    <code class="literal">Diablo 630 Line Printer</code>.  Puisque
	    l'alias <code class="literal">lp</code> lui est attribué,
	    elle est également l'imprimante par défaut.
	    La seconde s'appelle <code class="literal">bamboo</code> et
	    possède les alias suivants: <code class="literal">ps</code>,
	    <code class="literal">PS</code>, <code class="literal">S</code>,
	    <code class="literal">panasonic</code> et <code class="literal">Panasonic
	    KX-P4455 PostScript v51.4</code>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-no-header-pages"></a>10.3.1.5.2. Supprimer les pages d'en-tête</h5></div></div></div><a id="idp73750352" class="indexterm"></a><p>Par défaut, le gestionnaire d'impression
	    <span class="application">LPD</span> imprime une <span class="emphasis"><em>page
	    d'en-tête</em></span> pour chaque impression.
	    Celle-ci mentionne le nom de l'utilisateur qui a
	    demandé l'impression, la machine qui l'a
	    envoyé, et le nom de l'impression, en grands et
	    jolis caractères.  Malheureusement, tout ce texte
	    supplémentaire parasite le débogage d'une
	    configuration simple de l'imprimante, aussi
	    supprimerons-nous ces pages d'en-têtes.</p><p>Pour cela, ajoutez le paramètre
	    <code class="literal">sh</code> à l'entrée de
	    l'imprimante dans <code class="filename">/etc/printcap</code>.
	    Voici un exemple de <code class="filename">/etc/printcap</code>
	    où <code class="literal">sh</code> a été
	    ajouté:</p><pre class="programlisting">#
#  /etc/printcap for host rose - no header pages anywhere
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:</pre><p>Observez la façon dont nous avons
	    respecté le format correct: la première
	    ligne commence dans la colonne la plus à gauche, et
	    les lignes suivantes sont indentées.  Toutes les
	    lignes d'une entrée sauf la dernière se
	    terminent par un antislash.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-spooldir"></a>10.3.1.5.3. Créer le répertoire de file
	    d'attente</h5></div></div></div><a id="idp73756368" class="indexterm"></a><a id="idp73756880" class="indexterm"></a><p>La prochaine étape dans la configuration simple
	    du gestionnaire d'impression consiste à
	    créer un <span class="emphasis"><em>répertoire de file
	    d'attente</em></span>, c'est à dire un
	    répertoire où les travaux vont demeurer
	    jusqu'à ce qu'ils soient imprimés, et
	    où un certain nombre d'autres fichiers
	    nécessaires au gestionnaire d'impression prennent
	    place.</p><p>A cause de la nature variable des répertoires
	    de file d'attente, il est d'usage de les placer dans
	    <code class="filename">/var/spool</code>.  Il n'est pas non plus
	    nécessaire de sauvegarder leur contenu.  Les
	    recréer est aussi simple que de faire un
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mkdir&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">mkdir</span>(1)</span></a>.</p><p>Il est également d'usage de créer le
	    répertoire avec un nom identique à celui de
	    l'imprimante, comme dans l'exemple ci-dessous:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/nom-de-l-imprimante</code></strong></pre><p>Toutefois, si votre réseau comporte beaucoup
	    d'imprimantes, vous pouvez préférer placer
	    les répertoires de file d'attente dans un unique
	    répertoire que vous réserverez à
	    l'impression avec <span class="application">LPD</span>.  C'est
	    ce que nous allons faire pour les deux imprimantes de
	    notre exemple, <code class="literal">rattan</code> et
	    <code class="literal">bamboo</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/lpd</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/lpd/rattan</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/lpd/bamboo</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Si la confidentialité des travaux
	      imprimés par les utilisateurs vous importe, vous
	      souhaiterez certainement protéger le
	      répertoire de file d'attente afin qu'il ne soit
	      pas accessible par tout le monde.  Les
	      répertoires de file d'attente doivent appartenir,
	      être accessibles en lecture et écriture et
	      pouvoir être parcourus par l'utilisateur
	      <code class="systemitem">daemon</code> et le groupe
	      <code class="systemitem">daemon</code>, et personne d'autre.
	      C'est ce que nous allons faire pour les deux imprimantes
	      de notre exemple:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chown daemon:daemon /var/spool/lpd/rattan</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chown daemon:daemon /var/spool/lpd/bamboo</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chmod 770 /var/spool/lpd/rattan</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chmod 770 /var/spool/lpd/bamboo</code></strong></pre></div><p>Pour finir, vous devez avertir
	    <span class="application">LPD</span> de l'existence de ces
	    répertoires en utilisant le fichier
	    <code class="filename">/etc/printcap</code>.  Vous spécifiez
	    le chemin du répertoire file d'attente avec le
	    paramètre <code class="literal">sd</code>:</p><pre class="programlisting">#
#  /etc/printcap for host rose - added spooling directories
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:</pre><p>Notez que le nom de l'imprimante commence dans la
	    première colonne mais que toutes les autres
	    entrées décrivant l'imprimante doivent
	    être indentées et que chaque fin de ligne
	    doit être protégée par un
	    antislash.</p><p>Si vous ne précisez pas de répertoire de
	    file d'attente avec <code class="literal">sd</code>, le gestionnaire
	    d'impression utilisera <code class="filename">/var/spool/lpd</code>
	    par défaut.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-device"></a>10.3.1.5.4. Identifier le périphérique
	    d'imprimante</h5></div></div></div><p>Dans la section Entrées des
	    périphériques nous avons identifié
	    l'entrée du répertoire
	    <code class="filename">/dev</code> que FreeBSD utiliserait pour
	    communiquer avec l'imprimante.  Maintenant, nous allons
	    passer cette information à
	    <span class="application">LPD</span>.  Quand le gestionnaire
	    d'impression aura une impression à effectuer, il
	    ouvrira le périphérique
	    spécifié au nom du programme de filtre (qui
	    est responsable de la transmission des données
	    à l'imprimante).</p><p>Positionnez l'entrée pour le chemin
	    d'accès <code class="filename">/dev</code> dans le fichier
	    <code class="filename">/etc/printcap</code> en utilisant le
	    paramètre <code class="literal">lp</code>.</p><p>Dans notre exemple, supposons que
	    <code class="literal">rattan</code> est sur le premier port
	    parallèle, et que <code class="literal">bamboo</code> est sur
	    un sixième port série; voici les ajouts
	    à apporter à
	    <code class="filename">/etc/printcap</code>:</p><pre class="programlisting">#
#  /etc/printcap for host rose - identified what devices to use
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:</pre><p>Si dans votre <code class="filename">/etc/printcap</code> vous
	    ne précisez pas le paramètre
	    <code class="literal">lp</code> pour une imprimante,
	    <span class="application">LPD</span> utilisera
	    <code class="filename">/dev/lp</code> par défaut.  A l'heure
	    actuelle, il n'existe pas d'entrée
	    <code class="filename">/dev/lp</code> sous FreeBSD.</p><p>Si l'imprimante que vous êtes en train
	    d'installer est connectée à un port
	    parallèle, vous pouvez directement vous rendre
	    à la section <a class="link" href="printing-intro-setup.html#printing-textfilter" title="10.3.1.5.6. Installer le filtre texte">Installer le filtre
	    texte</a>.  Sinon, assurez-vous de suivre les
	    instructions de la section qui suit.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-commparam"></a>10.3.1.5.5. Configurer les paramètres de communication du
	    gestionnaire d'impression</h5></div></div></div><a id="idp73795664" class="indexterm"></a><p>Pour les imprimantes connectées au port
	    série, <span class="application">LPD</span> peut
	    configurer la vitesse en bps, la parité, et
	    d'autres paramètres de communication série,
	    pour le compte du programme de filtre qui envoie les
	    données à l'imprimante.  C'est avantageux
	    dans la mesure où:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Cela vous laisse essayer divers paramètres
		simplement en éditant le fichier
		<code class="filename">/etc/printcap</code>; vous n'avez pas
		besoin de recompiler le programme de filtre.</p></li><li class="listitem"><p>Cela permet au gestionnaire d'impression
		d'utiliser le même programme pour de multiples
		imprimantes qui peuvent avoir des paramètres de
		communication série différents.</p></li></ul></div><p>Les paramètres
	    <code class="filename">/etc/printcap</code> suivants
	    contrôlent les options de communication série
	    pour le périphérique spécifié
	    dans le paramètre <code class="literal">lp</code>:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">br#vitesse-bps</code></span></dt><dd><p>Positionne la vitesse de transmission du
		  périphérique à
		  <em class="replaceable"><code>vitesse-bps</code></em>, où
		  <em class="replaceable"><code>vitesse-bps</code></em> peut prendre
		  l'une des valeurs suivantes: 50, 75, 110, 134, 150,
		  200, 300, 600, 1200, 1800, 2400, 4800, 9600, 19200,
		  38400, 57600, ou 115200 bits par seconde.</p></dd><dt><span class="term"><code class="literal">ms#stty-mode</code></span></dt><dd><p>Positionne les options du
		  périphérique de terminal après
		  l'avoir ouvert.  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stty&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stty</span>(1)</span></a> présente les
		  options disponibles.</p></dd></dl></div><p>Quand <span class="application">LPD</span> ouvre le
	    périphérique spécifié par le
	    paramètre <code class="literal">lp</code>, il positionne les
	    caractéristiques de ce périphérique
	    aux valeurs précisées par le
	    paramètre <code class="literal">ms#</code>.  Les modes
	    suivants, détaillés dans <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stty&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stty</span>(1)</span></a> sont
	    particulièrement intéressants:
	    <code class="literal">parenb</code>, <code class="literal">parodd</code>,
	    <code class="literal">cs5</code>, <code class="literal">cs6</code>,
	    <code class="literal">cs7</code>, <code class="literal">cs8</code>,
	    <code class="literal">cstopb</code>, <code class="literal">crtscts</code>, et
	    <code class="literal">ixon</code>.</p><p>Peaufinons notre exemple pour l'imprimante qui est
	    connectée au sixième port série. Nous
	    allons paramétrer sa vitesse à 38400 bps.
	    Quant au mode, nous allons spécifier aucune
	    parité avec <code class="literal">-parenb</code>, des
	    caractères 8 bits avec <code class="literal">cs8</code>,
	    aucun contrôle modem avec <code class="literal">clocal</code>
	    et un contrôle de flux matériel avec
	    <code class="literal">crtscts</code>:</p><pre class="programlisting">bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:</pre></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-textfilter"></a>10.3.1.5.6. Installer le filtre texte</h5></div></div></div><a id="idp73832016" class="indexterm"></a><p>Nous sommes maintenant en mesure de dire à
	    <span class="application">LPD</span> quel filtre texte utiliser
	    pour envoyer les travaux à l'imprimante.  Un
	    <span class="emphasis"><em>filtre texte</em></span>, également connu
	    sous le nom de <span class="emphasis"><em>filtre
	    d'entrée</em></span>, est un programme que
	    <span class="application">LPD</span> lance lorsqu'il a une
	    impression à effectuer.  Lorsque
	    <span class="application">LPD</span> exécute le filtre
	    texte pour une imprimante, il redirige l'entrée
	    standard du filtre sur le travail d'impression, et la
	    sortie standard sur le fichier spécial de
	    périphérique spécifié par le
	    paramètre <code class="literal">lp</code>.  On attend du
	    filtre qu'il lise le travail d'impression sur son
	    entrée standard, effectue les transformations
	    nécessaires pour l'imprimante, et écrive le
	    résultat sur sa sortie standard, qui sera
	    imprimée.  Pour plus d'informations sur les filtres
	    texte, lisez la section <a class="link" href="printing-advanced.html#printing-advanced-filters" title="10.4.1.1. Fonctionnement des filtres">Filtres</a>.</p><p>Pour notre configuration simple de l'imprimante, le
	    filtre texte peut être une petite procédure
	    d'interpréteur de commandes qui ne fera
	    qu'exécuter <code class="command">/bin/cat</code> pour
	    envoyer le travail d'impression à l'imprimante.  Un
	    autre filtre est livré avec FreeBSD, nommé
	    <code class="filename">lpf</code>, qui se charge de faire des
	    suppressions arrière et des soulignements pour les
	    imprimantes qui ne sauraient pas gérer correctement
	    ce genre de flux de caractères.  Et bien sûr,
	    vous pouvez utiliser un autre filtre, quel qu'il soit.  Le
	    filtre <code class="filename">lpf</code> est détaillé
	    dans la section <a class="link" href="printing-advanced.html#printing-advanced-lpf" title="10.4.1.6. lpf: un filtre texte">lpf: un filtre
	    texte</a>.</p><p>Tout d'abord, composons le filtre
	    <code class="filename">/usr/local/libexec/if-simple</code> qui sera
	    un simple filtre texte.  Ecrivez ceci avec votre
	    éditeur de texte favori:</p><pre class="programlisting">#!/bin/sh
#
# if-simple - Simple text input filter for lpd
# Installed in /usr/local/libexec/if-simple
#
# Simply copies stdin to stdout.  Ignores all filter arguments.

/bin/cat &amp;&amp; exit 0
exit 2</pre><p>Rendez le fichier exécutable:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chmod 555 /usr/local/libexec/if-simple</code></strong></pre><p>Et avertissez <span class="application">LPD</span> qu'il
	    doit l'utiliser, en renseignant le paramètre
	    <code class="literal">if</code> dans
	    <code class="filename">/etc/printcap</code>.  Nous l'ajouterons aux
	    deux imprimantes utilisées jusqu'ici dans notre
	    <code class="filename">/etc/printcap</code> d'exemple:</p><pre class="programlisting">#
#  /etc/printcap for host rose - added text filter
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\ :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:\
        :if=/usr/local/libexec/if-simple:</pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Vous trouverez une copie du filtre
	      <code class="filename">if-simple</code> dans le répertoire
	      <code class="filename">/usr/share/examples/printing</code>.</p></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp73845072"></a>10.3.1.5.7. Lancer <span class="application">LPD</span></h5></div></div></div><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lpd</span>(8)</span></a> se lance depuis
	    <code class="filename">/etc/rc</code>, avec la variable de
	    contrôle <code class="literal">lpd_enable</code>.  Cette
	    variable a <code class="literal">NO</code> pour valeur par
	    défaut.  Si vous ne l'avez pas déjà
	    fait, ajoutez la ligne:</p><pre class="programlisting">lpd_enable="YES"</pre><p>à votre <code class="filename">/etc/rc.conf</code>, puis
	    relancez votre machine, ou lancez simplement
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lpd</span>(8)</span></a>.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lpd</code></strong></pre></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-trying"></a>10.3.1.5.8. Tester la configuration</h5></div></div></div><p>Vous avez achevé la configuration simple de
	    <span class="application">LPD</span>.  Malheureusement, les
	    félicitations ne sont pas encore à l'ordre
	    du jour, puisque nous devons encore tester la
	    configuration et résoudre tout problème.
	    Pour tester la configuration, essayez d'imprimer quelque
	    chose.  Pour imprimer avec le système
	    <span class="application">LPD</span>, vous devez utiliser la
	    commande <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a>, qui soumet un travail
	    d'impression.</p><p>Vous pouvez combiner <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> au programme
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a>, que nous avons présenté
	    à la section <a class="link" href="printing-intro-setup.html#printing-testing" title="10.3.1.4. Vérifier la communication avec l'imprimante">Vérifier la
	    communication avec l'imprimante</a>, pour produire du
	    texte de test.</p><p><span class="emphasis"><em>Pour tester la configuration simple de
	    <span class="application">LPD</span></em></span></p><p>Entrez:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptest 20 5 | lpr -Pnom-de-l-imprimante</code></strong></pre><p>Où
	    <em class="replaceable"><code>nom-de-l-imprimante</code></em>
	    représente le nom (ou l'alias) d'une imprimante tel
	    que spécifié dans
	    <code class="filename">/etc/printcap</code>.  Pour tester
	    l'imprimante par défaut, tapez <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> sans
	    aucun argument <code class="option">-P</code>.  Encore une fois, si
	    vous faites ce test avec une imprimante qui s'attend
	    à recevoir du <span class="trademark">PostScript</span>®, envoyez un programme
	    <span class="trademark">PostScript</span>® au lieu d'employer <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a>.  Vous
	    pouvez le faire en plaçant le programme dans un
	    fichier et en entrant <code class="command">lpr
	    fichier</code>.</p><p>Pour une imprimante <span class="trademark">PostScript</span>®, vous devriez obtenir
	    le résultat du programme.  Si vous utilisez
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a>, alors votre sortie devrait ressembler
	    à ça:</p><pre class="programlisting">!"#$%&amp;'()*+,-./01234
"#$%&amp;'()*+,-./012345
#$%&amp;'()*+,-./0123456
$%&amp;'()*+,-./01234567
%&amp;'()*+,-./012345678</pre><p>Pour tester l'imprimante plus encore,
	    téléchargez des programmes (pour les
	    imprimantes basées sur un langage
	    spécifique) plus longs, ou lancez <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a>
	    avec des arguments différents.  Par exemple,
	    <code class="command">lptest 80 60</code> produira 60 lignes de 80
	    caractères chacune.</p><p>Si l'impression ne fonctionne pas, lisez la section
	    <a class="link" href="printing-troubleshooting.html" title="10.7. Troubleshooting ** Traduction en Cours **">Résolution
	    des problèmes</a>.</p></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="printing-intro-spooler.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="printing.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="printing-advanced.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">10.2. Introduction </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 10.4. Configuration avancée de l'imprimante</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>