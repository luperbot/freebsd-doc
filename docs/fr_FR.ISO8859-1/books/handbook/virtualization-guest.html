<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>22.2. FreeBSD comme système d'exploitation invité</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="virtualization.html" title="Chapitre 22. Virtualisation" /><link rel="prev" href="virtualization.html" title="Chapitre 22. Virtualisation" /><link rel="next" href="virtualization-host.html" title="22.3. FreeBSD comme système d'exploitation hôte" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">22.2. FreeBSD comme système d'exploitation
      invité</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="virtualization.html">Précédent</a> </td><th width="60%" align="center">Chapitre 22. Virtualisation</th><td width="20%" align="right"> <a accesskey="n" href="virtualization-host.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="virtualization-guest"></a>22.2. FreeBSD comme système d'exploitation
      invité</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="virtualization-guest-parallels"></a>22.2.1. Parallels sur <span class="trademark">Mac OS</span>®</h3></div></div></div><p><span class="application">Parallels Desktop</span> pour <span class="trademark">Mac</span>®
	est un logiciel commercial pour les ordinateurs <span class="trademark">Apple</span>® <span class="trademark">Mac</span>®
	à base <span class="trademark">Intel</span>® tournant sous <span class="trademark">Mac OS</span>® 10.4.6 our
	versions supérieures.  FreeBSD est totalement
	supporté en tant que système d'exploitation
	invité.  Une fois que
	<span class="application">Parallels</span> a été
	installé sur <span class="trademark">Mac OS</span>® X, l'utilisateur doit configurer
	une machine virtuelle et installer le système
	d'exploitation invité qu'il désire.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="virtualization-guest-parallels-install"></a>22.2.1.1. Installer FreeBSD sur Parallels/<span class="trademark">Mac OS</span>® X</h4></div></div></div><p>La première étape pour installer FreeBSD
	    sur <span class="trademark">Mac OS</span>® X/<span class="application">Parallels</span> est de
	    créer une machine virtuelle pour l'installation de
	    FreeBSD.  Sélectionnez
	    <span class="guimenuitem">FreeBSD</span> comme
	    <span class="guimenu">Système d'exploitation
	    invité</span> quand on vous le demandera:</p><div class="mediaobject"><img src="virtualization/parallels-freebsd1.png" /></div><p>Et
	    choisissez une taille de disque dur et de mémoire
	    vive en fonction de l'utilisation que vous projetez pour
	    votre FreeBSD virtuel.  4Go de disque et 512Mo de RAM
	    conviennent pour la plupart des utilisations de FreeBSD sous
	    <span class="application">Parallels</span>:</p><div class="mediaobject"><img src="virtualization/parallels-freebsd2.png" /></div><div class="mediaobject"><img src="virtualization/parallels-freebsd3.png" /></div><div class="mediaobject"><img src="virtualization/parallels-freebsd4.png" /></div><div class="mediaobject"><img src="virtualization/parallels-freebsd5.png" /></div><p>Sélectionnez le type de réseau et une
	    carte réseau:</p><div class="mediaobject"><img src="virtualization/parallels-freebsd6.png" /></div><div class="mediaobject"><img src="virtualization/parallels-freebsd7.png" /></div><p>Sauvegardez et achevez la configuration:</p><div class="mediaobject"><img src="virtualization/parallels-freebsd8.png" /></div><div class="mediaobject"><img src="virtualization/parallels-freebsd9.png" /></div><p>Une fois votre machine virtuelle créée,
	    vous devrez y installer FreeBSD.  Le meilleur moyen est
	    d'utiliser un CDROM FreeBSD officiel ou une image ISO
	    récupérée sur un site FTP officiel.
	    Quand vous avez l'image ISO adéquate sur votre
	    système de fichiers <span class="trademark">Mac</span>® ou un CDROM dans le
	    lecteur de CD du <span class="trademark">Mac</span>®, cliquez sur l'icône disque
	    située dans le coin droit en bas de votre
	    fenêtre <span class="application">Parallels</span>.  Une
	    fenêtre s'ouvrira pour vous permettre d'associer le
	    lecteur de CDROM de votre machine virtuelle avec un
	    fichier ISO ou le véritable lecteur de CDROM de
	    votre ordinateur.</p><div class="mediaobject"><img src="virtualization/parallels-freebsd11.png" /></div><p>Dès que vous avez effectué cette
	    association, redémarrez votre machine virtuelle FreeBSD
	    en cliquant sur l'icône de redémarrage.
	    <span class="application">Parallels</span> redémarrera
	    avec un BIOS particulier qui vérifiera si vous
	    disposez d'un CDROM tout comme le ferait un BIOS
	    classique.</p><div class="mediaobject"><img src="virtualization/parallels-freebsd10.png" /></div><p>Dans notre cas il trouvera le disque
	    d'installation de FreeBSD et lancera une installation normale
	    avec <span class="application">sysinstall</span> comme
	    décrit dans le <a class="xref" href="install.html" title="Chapitre 2. Installer FreeBSD">Chapitre 2, <em>Installer FreeBSD</em></a>.  Vous
	    pouvez installer X11 mais ne tentez pas de le configurer
	    pour le moment.</p><div class="mediaobject"><img src="virtualization/parallels-freebsd12.png" /></div><p>Quand l'installation est terminée,
	    redémarrez votre machine virtuelle FreeBSD.</p><div class="mediaobject"><img src="virtualization/parallels-freebsd13.png" /></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="virtualization-guest-parallels-configure"></a>22.2.1.2. Configurer FreeBSD sur <span class="trademark">Mac OS</span>® X/Parallels</h4></div></div></div><p>Après avoir installé avec succès
	    FreeBSD sur <span class="trademark">Mac OS</span>® X avec
	    <span class="application">Parallels</span>,
	    il reste plusieurs points à
	    configurer pour optimiser le système
	    virtuel.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p class="title"><strong>Paramétrer les variables du
		chargeur</strong></p><p>L'étape la plus importante est la
		diminution du paramètre
		<code class="option">kern.hz</code> afin de réduire
		l'utilisation du CPU de FreeBSD sous l'environnement
		<span class="application">Parallels</span>.  Pour cela, il
		faut ajouter la ligne suivante au fichier
		<code class="filename">/boot/loader.conf</code>:</p><pre class="programlisting">kern.hz=100</pre><p>Sans ce paramétrage, un système
		d'exploitation invité FreeBSD inactif sous
		<span class="application">Parallels</span> utilisera environ
		15% du CPU sur un <span class="trademark">iMac</span>® à mono-processeur.
		Après ce changement l'utilisation du processeur
		sera plus proche d'un petit 5%.</p></li><li class="step"><p class="title"><strong>Créer un nouveau fichier de configuration
		du noyau</strong></p><p>Vous pouvez retirer tous les pilotes de
		périphériques SCSI, FireWire et USB.
		<span class="application">Parallels</span> fournit une carte
		réseau virtuelle utilisant le pilote
		<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ed&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ed</span>(4)</span></a>, aussi tous les autres pilotes
		réseau exceptés <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ed&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ed</span>(4)</span></a> et
		<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=miibus&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">miibus</span>(4)</span></a> peuvent être retirés du
		noyau.</p></li><li class="step"><p class="title"><strong>Configuration du réseau</strong></p><p>La configuration réseau la plus simple
		utilise DHCP pour connecter votre machine virtuelle
		sur le même réseau local que votre
		machine <span class="trademark">Mac</span>® hôte.  Cette configuration se fait
		en ajoutant la ligne
		<code class="literal">ifconfig_ed0="DHCP"</code> au fichier
		<code class="filename">/etc/rc.conf</code>.  Des configurations
		réseau plus avancées sont
		décrites dans le <a class="xref" href="advanced-networking.html" title="Chapitre 31. Administration réseau avancée">Chapitre 31, <em>Administration réseau avancée</em></a>.</p></li></ol></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="virtualization-guest-xen"></a>22.2.2. FreeBSD avec <span class="trademark">Xen</span>&#8482; sur Linux</h3></div><div><span class="authorgroup">Contribution de <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Fukang</span> <span class="surname">Chen (Loader)</span></span>. </span></div></div></div><p>L'hyperviseur <span class="application"><span class="trademark">Xen</span>&#8482;</span> est un
	  logiciel libre de para-virtualisation qui est
	  supporté par l'entreprise commerciale XenSource.  Les
	  systèmes d'exploitation invités sont
	  appelés domaines domU, et le système
	  d'exploitation hôte est appelé dom0.  La
	  première étape pour faire tourner un FreeBSD
	  virtuel sous <span class="trademark">Linux</span>® est d'installer
	  <span class="application"><span class="trademark">Xen</span>&#8482;</span> pour le domaine dom0
	  <span class="trademark">Linux</span>®.  Le système d'exploitation hôte sera
	  une distribution <span class="trademark">Linux</span>® Slackware.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="xen-slackware-dom0"></a>22.2.2.1. Configuration de <span class="trademark">Xen</span>&#8482; 3 sur un dom0 <span class="trademark">Linux</span>®</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p class="title"><strong>Télécharger <span class="trademark">Xen</span>&#8482; 3.0 auprès
		de XenSource</strong></p><p>Récupérez l'archive <a class="link" href="http://bits.xensource.com/oss-xen/release/3.0.4-1/src.tgz/xen-3.0.4_1-src.tgz" target="_top">xen-3.0.4_1-src.tgz</a>
		auprès de <code class="uri"><a class="uri" href="http://www.xensource.com/" target="_top">http://www.xensource.com/</a></code>.</p></li><li class="step"><p class="title"><strong>Extraire l'archive</strong></p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd xen-3.0.4_1-src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>KERNELS="linux-2.6-xen0 linux-2.6-xenU" make world</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make install</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Pour recompiler le noyau pour le domaine
		  dom0:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd xen-3.0.4_1-src/linux-2.6.16.33-xen0</code></strong>
  <code class="prompt">#</code> <strong class="userinput"><code>make menuconfig</code></strong>
  <code class="prompt">#</code> <strong class="userinput"><code>make</code></strong>
  <code class="prompt">#</code> <strong class="userinput"><code>make install</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">D'anciennes versions de
		  <span class="application"><span class="trademark">Xen</span>&#8482;</span> peuvent
		  nécessiter l'utilisation de la commande
		  <code class="command">make ARCH=xen menuconfig</code></p></div></li><li class="step"><p class="title"><strong>Ajouter une entrée au menu de Grub
		(menu.lst)</strong></p><p>Editez <code class="filename">/boot/grub/menu.lst</code> et
		ajoutez les lignes suivantes:</p><pre class="programlisting">title Xen-3.0.4
root (hd0,0)
kernel /boot/xen-3.0.4-1.gz dom0_mem=262144
module /boot/vmlinuz-2.6.16.33-xen0 root=/dev/hda1 ro</pre></li><li class="step"><p class="title"><strong>Redémarrer votre ordinateur sous
		<span class="trademark">Xen</span>&#8482;</strong></p><p>Tout d'abord, éditez
		<code class="filename">/etc/xen/xend-config.sxp</code>, et
		ajoutez la ligne suivante:</p><pre class="programlisting">(network-script 'network-bridge netdev=eth0')</pre><p>Nous pouvons maintenant lancer
		<span class="application"><span class="trademark">Xen</span>&#8482;</span>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/init.d/xend start</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>/etc/init.d/xendomains start</code></strong></pre><p>Notre domaine dom0 fonctionne:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>xm list</code></strong>
Name                                      ID   Mem VCPUs      State   Time(s)
Domain-0                                   0   256     1     r-----  54452.9</pre></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81807312"></a>22.2.2.2. Domaine domU FreeBSD 7-CURRENT</h4></div></div></div><p>Téléchargez le noyau pour domU FreeBSD pour
	    <span class="application"><span class="trademark">Xen</span>&#8482; 3.0</span> et l'image disque
	    auprès de <a class="link" href="http://www.fsmware.com/" target="_top">http://www.fsmware.com/</a></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="http://www.fsmware.com/xenofreebsd/7.0/download/kernel-current" target="_top">kernel-current</a></p></li><li class="listitem"><p><a class="link" href="http://www.fsmware.com/xenofreebsd/7.0/download/mdroot-7.0.bz2" target="_top">mdroot-7.0.bz2</a></p></li><li class="listitem"><p><a class="link" href="http://www.fsmware.com/xenofreebsd/7.0/download/config/xmexample1.bsd" target="_top">xmexample1.bsd</a></p></li></ul></div><p>Placez le fichier de configuration
	    <code class="filename">xmexample1.bsd</code> dans le
	    répertoire <code class="filename">/etc/xen/</code> et modifiez les
	    entrées relatives à l'emplacement du noyau
	    et de l'image disque.  Cela devrait donner quelque chose
	    comme:</p><pre class="programlisting">kernel = "/opt/kernel-current"
memory = 256
name = "freebsd"
vif = [ '' ]
disk = [ 'file:/opt/mdroot-7.0,hda1,w' ]
#on_crash    = 'preserve'
extra = "boot_verbose"
extra += ",boot_single"
extra += ",kern.hz=100"
extra += ",vfs.root.mountfrom=ufs:/dev/xbd769a"</pre><p>Le fichier <code class="filename">mdroot-7.0.bz2</code> doit
	    être décompressé.</p><p>Ensuite, la section __xen_guest du fichier
	    <code class="filename">kernel-current</code> doit être
	    modifiée pour y ajouter le paramètre
	    VIRT_BASE dont a besoin <span class="application"><span class="trademark">Xen</span>&#8482;
	    3.0.3</span>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>objcopy kernel-current -R __xen_guest</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>perl -e 'print "LOADER=generic,GUEST_OS=freebsd,GUEST_VER=7.0,XEN_VER=xen-3.0,BSD_SYMTAB,VIRT_BASE=0xC0000000\x00"' &gt; tmp</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>objcopy kernel-current --add-section __xen_guest=tmp</code></strong></pre><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>objdump -j __xen_guest -s kernel-current</code></strong>

kernel-current:     file format elf32-i386

Contents of section __xen_guest:
 0000 4c4f4144 45523d67 656e6572 69632c47  LOADER=generic,G
 0010 55455354 5f4f533d 66726565 6273642c  UEST_OS=freebsd,
 0020 47554553 545f5645 523d372e 302c5845  GUEST_VER=7.0,XE
 0030 4e5f5645 523d7865 6e2d332e 302c4253  N_VER=xen-3.0,BS
 0040 445f5359 4d544142 2c564952 545f4241  D_SYMTAB,VIRT_BA
 0050 53453d30 78433030 30303030 3000      SE=0xC0000000. </pre><p>Nous sommes maintenant prêt à
	    créer et lancer notre domU:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>xm create /etc/xen/xmexample1.bsd -c</code></strong>
Using config file "/etc/xen/xmexample1.bsd".
Started domain freebsd
WARNING: loader(8) metadata is missing!
Copyright (c) 1992-2006 The FreeBSD Project.
Copyright (c) 1979, 1980, 1983, 1986, 1988, 1989, 1991, 1992, 1993, 1994
The Regents of the University of California. All rights reserved.
FreeBSD 7.0-CURRENT #113: Wed Jan  4 06:25:43 UTC 2006
    kmacy@freebsd7.gateway.2wire.net:/usr/home/kmacy/p4/freebsd7_xen3/src/sys/i386-xen/compile/XENCONF
WARNING: DIAGNOSTIC option enabled, expect reduced performance.
Xen reported: 1796.927 MHz processor.
Timecounter "ixen" frequency 1796927000 Hz quality 0
CPU: Intel(R) Pentium(R) 4 CPU 1.80GHz (1796.93-MHz 686-class CPU)
  Origin = "GenuineIntel"  Id = 0xf29  Stepping = 9
  Features=0xbfebfbff&lt;FPU,VME,DE,PSE,TSC,MSR,PAE,MCE,CX8,APIC,SEP,MTRR,PGE,MCA,CMOV,PAT,PSE36,CLFLUSH,
  DTS,ACPI,MMX,FXSR,SSE,SSE2,SS,HTT,TM,PBE&gt;
  Features2=0x4400&lt;CNTX-ID,&lt;b14&gt;&gt;
real memory  = 265244672 (252 MB)
avail memory = 255963136 (244 MB)
xc0: &lt;Xen Console&gt; on motherboard
cpu0 on motherboard
Timecounters tick every 10.000 msec
[XEN] Initialising virtual ethernet driver.
xn0: Ethernet address: 00:16:3e:6b:de:3a
[XEN]
Trying to mount root from ufs:/dev/xbd769a
WARNING: / was not properly dismounted
Loading configuration files.
No suitable dump device was found.
Entropy harvesting: interrupts ethernet point_to_point kickstart.
Starting file system checks:
/dev/xbd769a: 18859 files, 140370 used, 113473 free (10769 frags, 12838 blocks, 4.2% fragmentation)
Setting hostname: demo.freebsd.org.
lo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 16384
	  inet6 ::1 prefixlen 128
	  inet6 fe80::1%lo0 prefixlen 64 scopeid 0x2
	  inet 127.0.0.1 netmask 0xff000000
Additional routing options:.
Mounting NFS file systems:.
Starting syslogd.
/etc/rc: WARNING: Dump device does not exist.  Savecore not run.
ELF ldconfig path: /lib /usr/lib /usr/lib/compat /usr/X11R6/lib /usr/local/lib
a.out ldconfig path: /usr/lib/aout /usr/lib/compat/aout /usr/X11R6/lib/aout
Starting usbd.
usb: Kernel module not available: No such file or directory
Starting local daemons:.
Updating motd.
Starting sshd.
Initial i386 initialization:.
Additional ABI support: linux.
Starting cron.
Local package initialization:.
Additional TCP options:.
Starting background file system checks in 60 seconds.

Sun Apr  1 02:11:43 UTC 2007

FreeBSD/i386 (demo.freebsd.org) (xc0)

login: </pre><p>Le domaine domU devrait exécuter le noyau
	    FreeBSD 7.0-CURRENT:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>uname -a</code></strong>
FreeBSD demo.freebsd.org 7.0-CURRENT FreeBSD 7.0-CURRENT #113: Wed Jan  4 06:25:43 UTC 2006
kmacy@freebsd7.gateway.2wire.net:/usr/home/kmacy/p4/freebsd7_xen3/src/sys/i386-xen/compile/XENCONF  i386</pre><p>Le réseau peut maintenant être
	    configuré sur le domaine domU.  Le domaine domU
	    FreeBSD utilisera une interface spécifique
	    appelée <code class="filename">xn0</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig xn0 10.10.10.200 netmask 255.0.0.0</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ifconfig</code></strong>
xn0: flags=843&lt;UP,BROADCAST,RUNNING,SIMPLEX&gt; mtu 1500
    inet 10.10.10.200 netmask 0xff000000 broadcast 10.255.255.255
    ether 00:16:3e:6b:de:3a
lo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 16384
      inet6 ::1 prefixlen 128
      inet6 fe80::1%lo0 prefixlen 64 scopeid 0x2
      inet 127.0.0.1 netmask 0xff000000 </pre><p>Sur le domaine dom0 Slackware, des interfaces
	    réseaux relatives à
	    <span class="application"><span class="trademark">Xen</span>&#8482;</span> devraient
	    apparaître:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig</code></strong>
eth0      Link encap:Ethernet  HWaddr 00:07:E9:A0:02:C2
          inet addr:10.10.10.130  Bcast:0.0.0.0  Mask:255.0.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:815 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1400 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:204857 (200.0 KiB)  TX bytes:129915 (126.8 KiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:99 errors:0 dropped:0 overruns:0 frame:0
          TX packets:99 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:9744 (9.5 KiB)  TX bytes:9744 (9.5 KiB)

peth0     Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:1853349 errors:0 dropped:0 overruns:0 frame:0
          TX packets:952923 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:2432115831 (2.2 GiB)  TX bytes:86528526 (82.5 MiB)
          Base address:0xc000 Memory:ef020000-ef040000

vif0.1    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:1400 errors:0 dropped:0 overruns:0 frame:0
          TX packets:815 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:129915 (126.8 KiB)  TX bytes:204857 (200.0 KiB)

vif1.0    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:3 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2 errors:0 dropped:157 overruns:0 carrier:0
          collisions:0 txqueuelen:1
          RX bytes:140 (140.0 b)  TX bytes:158 (158.0 b)

xenbr1    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:4 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:112 (112.0 b)  TX bytes:0 (0.0 b)</pre><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>brctl show</code></strong>
bridge name     bridge id           STP enabled         interfaces
xenbr1          8000.feffffffffff   no                  vif0.1
                                                        peth0
                                                        vif1.0</pre></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="virtualization-guest-virtualpc"></a>22.2.3. Virtual PC sur <span class="trademark">Windows</span>®</h3></div></div></div><p><span class="application">Virtual PC</span> pour <span class="trademark">Windows</span>® est
	un logiciel <span class="trademark">Microsoft</span>® librement
	téléchargeable.  Consultez la page concernant la
	<a class="link" href="http://www.microsoft.com/windows/downloads/virtualpc/sysreq.mspx" target="_top">configuration
	minimale requise</a>.  Une fois <span class="application">Virtual
	PC</span> installé sous <span class="trademark">Microsoft</span>® <span class="trademark">Windows</span>®,
	l'utilisateur doit configurer une machine virtuelle puis
	installer le système d'exploitation invité
	désiré.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="virtualization-guest-virtualpc-install"></a>22.2.3.1. Installer FreeBSD sous Virtual
	    PC/<span class="trademark">Microsoft</span>® <span class="trademark">Windows</span>®</h4></div></div></div><p>La première étape de l'installation de
	    FreeBSD sous <span class="trademark">Microsoft</span>® <span class="trademark">Windows</span>®/<span class="application">Virtual
	    PC</span> est la création d'une nouvelle
	    machine virtuelle pour permettre l'installation de FreeBSD.
	    Sélectionnez <span class="guimenuitem">Create a virtual
	    machine</span>:</p><div class="mediaobject"><img src="virtualization/virtualpc-freebsd1.png" /></div><div class="mediaobject"><img src="virtualization/virtualpc-freebsd2.png" /></div><p>Puis sélectionnez
	    <span class="guimenuitem">Other</span> pour
	    <span class="guimenuitem">Operating system</span>:</p><div class="mediaobject"><img src="virtualization/virtualpc-freebsd3.png" /></div><p>Choisissez ensuite une quantité raisonnable
	    d'espace disque et de mémoire en fonction de vos
	    projets pour cette installation de FreeBSD.  4Go d'espace de
	    disque et 512Mo de mémoire vive conviennent pour la
	    plupart des utilisateurs de FreeBSD sous <span class="application">Virtual
	    PC</span>:</p><div class="mediaobject"><img src="virtualization/virtualpc-freebsd4.png" /></div><div class="mediaobject"><img src="virtualization/virtualpc-freebsd5.png" /></div><p>Sauvegardez et poursuivez la configuration:</p><div class="mediaobject"><img src="virtualization/virtualpc-freebsd6.png" /></div><p>Sélectionnez votre machine virtuelle FreeBSD,
	    cliquez sur <span class="guimenu">Settings</span>, puis
	    précisez le type de réseau et l'interface
	    réseau:</p><div class="mediaobject"><img src="virtualization/virtualpc-freebsd7.png" /></div><div class="mediaobject"><img src="virtualization/virtualpc-freebsd8.png" /></div><p>Une fois votre machine virtuelle FreeBSD
	    créée, vous devrez y installer FreeBSD.  La
	    meilleure manière étant d'utiliser un CDROM
	    FreeBSD officiel ou une image ISO
	    téléchargée depuis un site FTP
	    officiel.  Quand vous avez l'image ISO appropriée
	    sur votre système de fichiers <span class="trademark">Windows</span>® ou sur un
	    CDROM dans votre lecteur de CD, double-cliquez sur votre
	    machine virtuelle FreeBSD pour démarrer.  Puis cliquez
	    sur <span class="guimenu">CD</span> et sélectionnez
	    <span class="guimenu">Capture ISO Image...</span> dans la
	    fenêtre <span class="application">Virtual PC</span>.  Une
	    fenêtre apparaîtra et vous permettra
	    d'associer le lecteur de CDROM de votre machine virtuelle
	    avec une image ISO ou votre lecteur de CDROM
	    réel.</p><div class="mediaobject"><img src="virtualization/virtualpc-freebsd9.png" /></div><div class="mediaobject"><img src="virtualization/virtualpc-freebsd10.png" /></div><p>L'association avec votre CDROM source
	    effectuée, redémarrez votre machine
	    virtuelle FreeBSD en cliquant sur <span class="guimenu">Action</span>
	    puis sur <span class="guimenu">Reset</span>.  <span class="application">Virtual
	    PC</span> redémarrera, son BIOS
	    vérifiera tout d'abord que vous disposez d'un CDROM
	    comme le ferait n'importe quel BIOS normal.</p><div class="mediaobject"><img src="virtualization/virtualpc-freebsd11.png" /></div><p>Dans ce cas, le support d'installation FreeBSD sera
	    trouvé et une installation classique basée
	    sur <span class="application">sysinstall</span> débutera
	    comme décrit dans le <a class="xref" href="install.html" title="Chapitre 2. Installer FreeBSD">Chapitre 2, <em>Installer FreeBSD</em></a>.
	    Vous pouvez installez X11 mais ne tentez pas pour le
	    moment de le configurer.</p><div class="mediaobject"><img src="virtualization/virtualpc-freebsd12.png" /></div><p>Quand vous avez achevé l'installation, pensez
	    à éjecter le CDROM ou l'image ISO.  Enfin,
	    redémarrez dans votre machine virtuelle FreeBSD
	    fraîchement installée.</p><div class="mediaobject"><img src="virtualization/virtualpc-freebsd13.png" /></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="virtualization-guest-virtualpc-configure"></a>22.2.3.2. Configuration de FreeBSD sous
	    <span class="trademark">Microsoft</span>® <span class="trademark">Windows</span>®/Virtual PC</h4></div></div></div><p>Après avoir installé avec succès
	    FreeBSD sur <span class="trademark">Microsoft</span>® <span class="trademark">Windows</span>® avec <span class="application">Virtual
	    PC</span>, il reste plusieurs points à
	    configurer pour optimiser le système
	    virtuel.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p class="title"><strong>Paramétrer les variables du
		chargeur</strong></p><p>L'étape la plus importante est la
		diminution du paramètre
		<code class="option">kern.hz</code> afin de réduire
		l'utilisation du CPU de FreeBSD sous l'environnement
		<span class="application">Virtual PC</span>.  Pour cela, il
		faut ajouter la ligne suivante au fichier
		<code class="filename">/boot/loader.conf</code>:</p><pre class="programlisting">kern.hz=100</pre><p>Sans ce paramétrage, un système
		d'exploitation invité FreeBSD inactif sous
		<span class="application">Virtual PC</span>
		utilisera environ 40% du CPU pour un
		micro-ordinateur monoprocesseur.  Après ce
		changement l'utilisation du processeur sera plus
		proche d'un petit 3%.</p></li><li class="step"><p class="title"><strong>Créer un nouveau fichier de configuration
		du noyau</strong></p><p>Vous pouvez retirer tous les pilotes de
		périphériques SCSI, FireWire, et USB.
		<span class="application">Virtual PC</span> fournit une
		interface réseau virtuelle utilisant
		le pilote <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=de&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">de</span>(4)</span></a>, aussi tous les autres pilotes
		réseau en dehors de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=de&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">de</span>(4)</span></a> et
		<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=miibus&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">miibus</span>(4)</span></a> peuvent être supprimés du
		noyau.</p></li><li class="step"><p class="title"><strong>Configuration du réseau</strong></p><p>La configuration réseau la plus simple
		utilise DHCP pour connecter votre machine virtuelle
		sur le même réseau local que votre
		machine <span class="trademark">Mac</span>® hôte.  Cette configuration se fait
		en ajoutant la ligne
		<code class="literal">ifconfig_de0="DHCP"</code> au fichier
		<code class="filename">/etc/rc.conf</code>.  Des configurations
		réseau plus avancées sont
		présentées dans le <a class="xref" href="advanced-networking.html" title="Chapitre 31. Administration réseau avancée">Chapitre 31, <em>Administration réseau avancée</em></a>.</p></li></ol></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="virtualization-guest-vmware"></a>22.2.4. VMware sur <span class="trademark">Windows</span>®/<span class="trademark">Mac</span>®/<span class="trademark">Linux</span>®</h3></div></div></div><p>Cette section n'est pas encore écrite.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="virtualization.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="virtualization.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="virtualization-host.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">Chapitre 22. Virtualisation </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 22.3. FreeBSD comme système d'exploitation hôte</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>