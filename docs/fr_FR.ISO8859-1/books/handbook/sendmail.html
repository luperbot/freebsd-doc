<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>28.3. Configuration de sendmail</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="mail.html" title="Chapitre 28. Courrier électronique" /><link rel="prev" href="mail-using.html" title="28.2. Utilisation du courrier électronique" /><link rel="next" href="mail-changingmta.html" title="28.4. Changer votre agent de transfert de courrier" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">28.3. Configuration de <span class="application">sendmail</span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mail-using.html">Précédent</a> </td><th width="60%" align="center">Chapitre 28. Courrier électronique</th><td width="20%" align="right"> <a accesskey="n" href="mail-changingmta.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="sendmail"></a>28.3. Configuration de <span class="application">sendmail</span></h2></div><div><span class="authorgroup">Contribution de <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Christopher</span> <span class="surname">Shumway</span></span>. </span></div></div></div><a id="idp83994704" class="indexterm"></a><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sendmail</span>(8)</span></a> est l'agent de transfert de courrier (Mail
      Transfert Agent&#8212;MTA) par défaut sous FreeBSD.  Le rôle
      de <span class="application">sendmail</span> est d'accepter le
      courrier en provenance des agents de courrier utilisateur (Mail
      User Agents&#8212;MUA) et de délivrer le courrier aux programmes de
      gestion du courrier définis dans son fichier de configuration.
      <span class="application">sendmail</span> peut également accepter
      les connexions réseau et délivrer le courrier dans des
      boîtes aux lettres locales ou le transmettre à un autre
      programme.</p><p><span class="application">sendmail</span> utilise les fichiers de
      configuration suivants:</p><a id="idp83998160" class="indexterm"></a><a id="idp83999056" class="indexterm"></a><a id="idp83999952" class="indexterm"></a><a id="idp84000848" class="indexterm"></a><a id="idp84001744" class="indexterm"></a><a id="idp84002640" class="indexterm"></a><a id="idp84003536" class="indexterm"></a><div class="informaltable"><table border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Fichier</th><th>Fonction</th></tr></thead><tbody><tr><td>
	      <code class="filename">/etc/mail/access</code>
	    </td><td>Fichier de la base de données d'accès
	      de <span class="application">sendmail</span></td></tr><tr><td>
	      <code class="filename">/etc/mail/aliases</code>
	    </td><td>Alias de boîte aux lettres</td></tr><tr><td>
	      <code class="filename">/etc/mail/local-host-names</code>
	    </td><td>Liste des machines pour lesquelles
	      <span class="application">sendmail</span> accepte du
	      courrier</td></tr><tr><td>
	      <code class="filename">/etc/mail/mailer.conf</code>
	    </td><td>Configuration du programme de gestion du
	      courrier</td></tr><tr><td>
	      <code class="filename">/etc/mail/mailertable</code>
	    </td><td>Table de livraison du courrier</td></tr><tr><td>
	      <code class="filename">/etc/mail/sendmail.cf</code>
	    </td><td>Fichier de configuration principal
	      de <span class="application">sendmail</span></td></tr><tr><td>
	      <code class="filename">/etc/mail/virtusertable</code>
	    </td><td>Table des domaines et utilisateurs virtuels</td></tr></tbody></table></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84027344"></a>28.3.1. <code class="filename">/etc/mail/access</code></h3></div></div></div><p>La base de données d'accès définit
      quelle(s) machine(s) ou adresses IP ont accès au serveur de
      courrier local et quel type d'accès ils ont.
      Les machines peuvent être listées avec <code class="option">OK</code>,
      <code class="option">REJECT</code>, <code class="option">RELAY</code> ou simplement
      transférées à la routine de gestion des erreurs
      <span class="application">sendmail</span> avec une erreur donnée.
      Les machines qui sont listées avec <code class="option">OK</code>, qui est le
      comportement par défaut, sont autorisées à envoyer du
      courrier à cette machine dès que la destination finale
      du courrier est la machine locale.  Les machines listées avec
      <code class="option">REJECT</code> se verront rejeter pour toute connexion
      au serveur.  Les machines présentes avec l'option
      <code class="option">RELAY</code> sont autorisées à envoyer du
      courrier à n'importe quelle destination par
      l'intermédiaire de ce serveur de courrier.</p><div class="example"><a id="idp84035408"></a><div class="example-title">Exemple 28.1. Configuration de la base de données d'accès
	de <span class="application">sendmail</span></div><div class="example-contents"><pre class="programlisting">cyberspammer.com                550 We don't accept mail from spammers
FREE.STEALTH.MAILER@            550 We don't accept mail from spammers
another.source.of.spam          REJECT
okay.cyberspammer.com           OK
128.32                          RELAY</pre></div></div><br class="example-break" /><p>Dans cet exemple nous avons cinq entrées.
     Les émetteurs de courrier qui correspondent à la partie
     gauche de la table sont affectés par l'action donnée
     sur la partie droite de la table.  Les deux premiers
     exemples donnent un code d'erreur à la routine de gestion
     d'erreur de <span class="application">sendmail</span>.
     Le message est affiché sur la machine distante quand un courrier
     électronique correspond à la partie gauche de la table.
     L'entrée suivante rejette le courrier en provenance
     d'une machine précise de l'Internet,
     <code class="systemitem">another.source.of.spam</code>.  L'entrée suivante
     accepte les connexions à partir de la machine
     <code class="systemitem">okay.cyberspammer.com</code>, qui est plus précis
     que le <code class="systemitem">cyberspammer.com</code> de la ligne
     précédente.  Les correspondances plus spécifiques
     priment sur les moins précises.  La dernière
     entrée autorise le relais du courrier électronique en
     provenance de machines avec une adresse IP qui commence par
     <code class="systemitem">128.32</code>.  Ces machines seront en mesure
     d'envoyer du courrier destiné à d'autres
     serveurs de courrier par l'intermédiaire de ce serveur de
     courrier.</p><p>Quand ce fichier est mis à jour, vous devez exécuter
     la commande <code class="command">make</code> dans
     <code class="filename">/etc/mail/</code> pour mettre à jour la base
     de données.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84040656"></a>28.3.2. <code class="filename">/etc/mail/aliases</code></h3></div></div></div><p>La base de données d'alias contient une liste
      de boîtes aux lettres virtuelles dont le contenu sera transmis
      à d'autres utilisateurs, fichiers, programmes ou d'autres
      alias.  Voici quelques exemples qui peuvent être
      utilisés dans <code class="filename">/etc/mail/aliases</code>:</p><div class="example"><a id="idp84042320"></a><div class="example-title">Exemple 28.2. Exemple de base de données d'alias</div><div class="example-contents"><pre class="programlisting">root: localuser
ftp-bugs: joe,eric,paul
bit.bucket:  /dev/null
procmail: "|/usr/local/bin/procmail"</pre></div></div><br class="example-break" /><p>Le format du fichier est simple; le nom de la boîte
      aux lettres à gauche et la cible sur la droite.
      Le premier exemple transfère la boîte aux lettres
      <code class="systemitem">root</code> vers la boîte aux lettres
      <code class="systemitem">localuser</code>, qui est ensuite recherchée
      dans la base de données d'alias.  Si aucune correspondance n'est
      trouvée alors le message est délivré à
      l'utilisateur locale
      <code class="systemitem">localuser</code>.  L'exemple suivant montre une
      liste de correspondance.  Un courrier envoyé à la
      boîte aux lettres <code class="systemitem">ftp-bugs</code> sera
      délivré aux trois boites locales <code class="systemitem">joe</code>,
      <code class="systemitem">eric</code>, et <code class="systemitem">paul</code>.  Notez
      qu'une boîte aux lettres distante comme <code class="literal">user@exemple.com</code>/procmail
      pourra
      être spécifiée.  L'exemple suivant montre comment
      transférer le courrier dans un fichier, dans notre cas
      <code class="filename">/dev/null</code>.  Le dernier exemple montre
      l'envoi du courrier à un programme, dans le cas présent
      le message est écrit sur l'entrée standard de
      <code class="filename">/usr/local/bin/procmail</code> par
      l'intermédiaire d'un tube <span class="trademark">UNIX</span>®.</p><p>Quand ce fichier est mis à jour, vous devez
      exécuter la commande <code class="command">make</code> dans
      <code class="filename">/etc/mail/</code> pour mettre à jour
      la base de données.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84054736"></a>28.3.3. <code class="filename">/etc/mail/local-host-names</code></h3></div></div></div><p>C'est la liste des machines pour lesquelles <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sendmail</span>(8)</span></a>
      accepte du courrier comme s'il était destiné
      à la machine locale.
      Placez-y tous les domaines ou machines pour lesquels
      <span class="application">sendmail</span> doit recevoir du courrier.
      Par exemple, si le serveur de courrier devait accepter du
      courrier pour le domaine <code class="systemitem">exemple.com</code> et la machine
      <code class="systemitem">mail.exemple.com</code>, sont
      <code class="filename">local-host-names</code> ressemblera à quelque
      chose comme ceci:</p><pre class="programlisting">exemple.com
mail.exemple.com</pre><p>Quand ce fichier est mis à jour, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendmail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sendmail</span>(8)</span></a> doit
      être relancé pour lire les changements.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84060240"></a>28.3.4. <code class="filename">/etc/mail/sendmail.cf</code></h3></div></div></div><p>Fichier principal de configuration de
      <span class="application">sendmail</span>,
      <code class="filename">sendmail.cf</code> contrôle le comportement
      général de <span class="application">sendmail</span>,
      y compris tout depuis la réécriture des adresses
      de courrier jusqu'à l'envoi de message de rejet aux
      serveurs de courrier distants.  Naturellement, avec tant de
      différentes activités, ce fichier de configuration
      est relativement complexe et son étude détaillée
      n'est pas le but de cette section.  Heureusement, ce fichier a
      rarement besoin d'être modifié pour les serveurs de courrier
      standards.</p><p>Le fichier de configuration principal de
      <span class="application">sendmail</span> peut être
      créé à partir de macros <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=m4&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">m4</span>(1)</span></a> qui
      définissent les fonctions
      et le comportement de <span class="application">sendmail</span>.
      Veuillez consulter
      <code class="filename">/usr/src/contrib/sendmail/cf/README</code> pour
      plus de détails.</p><p>Quand des modifications à ce fichier sont apportées,
      <span class="application">sendmail</span> doit être
      redémarré pour que les changements prennent effet.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84074192"></a>28.3.5. <code class="filename">/etc/mail/virtusertable</code></h3></div></div></div><p>La table <code class="filename">virtusertable</code> fait
      correspondre les adresses de courrier électronique pour des
      domaines virtuels et les boîtes aux lettres avec des
      boîtes aux lettres réelles.  Ces boîtes aux lettres
      peuvent être locales, distantes, des alias définis dans
      <code class="filename">/etc/mail/aliases</code> ou des fichiers.</p><div class="example"><a id="idp84076112"></a><div class="example-title">Exemple 28.3. Exemple de correspondance de domaine virtuel de
	courrier</div><div class="example-contents"><pre class="programlisting">root@exemple.com                root
postmaster@exemple.com          postmaster@noc.exemple.net
@exemple.com                    joe</pre></div></div><br class="example-break" /><p>Dans l'exemple ci-dessus, nous avons une correspondance pour
      un domaine <code class="systemitem">exemple.com</code>.  Ce fichier est traité
      jusqu'à trouver la première correspondance.
      Le premier élément fait correspondre <code class="literal">root@exemple.com</code>
      à la boîte aux lettres root locale.  L'entrée
      suivante fait correspondre <code class="literal">postmaster@exemple.com</code> à la
      boîte aux lettres postmaster sur la machine <code class="systemitem">noc.exemple.net</code>.
      Et enfin, si un courrier en provenance de <code class="systemitem">exemple.com</code> n'a pas
      trouvé de correspondance, il correspondra à la
      dernière ligne, qui régira tous les autres messages
      adressés à
      quelqu'un du domaine <code class="systemitem">exemple.com</code>.
      La correspondance sera la boîte aux lettres locale
      <code class="systemitem">joe</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail-using.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="mail-changingmta.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">28.2. Utilisation du courrier électronique </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 28.4. Changer votre agent de transfert de courrier</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>