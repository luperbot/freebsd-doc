<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>29.7. Serveur HTTP Apache</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="network-servers.html" title="Chapitre 29. Serveurs réseau" /><link rel="prev" href="network-dns.html" title="29.6. Serveurs de noms (DNS)" /><link rel="next" href="network-ftp.html" title="29.8. Protocole de transfert de fichiers (FTP)" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">29.7. Serveur HTTP Apache</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-dns.html">Précédent</a> </td><th width="60%" align="center">Chapitre 29. Serveurs réseau</th><td width="20%" align="right"> <a accesskey="n" href="network-ftp.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-apache"></a>29.7. Serveur HTTP Apache</h2></div><div><span class="authorgroup">Contribution de <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Murray</span> <span class="surname">Stokely</span></span>. </span></div></div></div><a id="idp85775568" class="indexterm"></a><a id="idp85776464" class="indexterm"></a><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85776976"></a>29.7.1. Généralités</h3></div></div></div><p>FreeBSD est utilisé pour faire tourner certains des
	sites les plus chargés au monde.  La majorité
	des serveurs web sur l'Internet utilisent le serveur HTTP
	<span class="application">Apache</span>.  Les versions
	pré-compilées
	d'<span class="application">Apache</span> devraient se trouver sur
	le support d'installation de FreeBSD que vous avez
	utilisé.  Si vous n'avez pas installé
	<span class="application">Apache</span> à l'installation de
	FreeBSD, alors vous pouvez installer le serveur à partir
	du logiciel porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache13/pkg-descr">www/apache13</a> ou <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache20/pkg-descr">www/apache20</a>.</p><p>Une fois qu'<span class="application">Apache</span> a
	été installé avec succès, il doit
	être configuré.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Cette section traite de la version 1.3.X du serveur
	  HTTP <span class="application">Apache</span> étant
	  donné que  c'est la version la plus largement
	  utilisée sous FreeBSD.
	  <span class="application">Apache</span> 2.X introduit de
	  nombreuses nouvelles technologies mais elles ne sont pas
	  abordées ici.  Pour plus d'informations concernant
	  <span class="application">Apache</span> 2.X veuillez
	  consulter <code class="uri"><a class="uri" href="http://httpd.apache.org/" target="_top">http://httpd.apache.org/</a></code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85783504"></a>29.7.2. Configuration</h3></div></div></div><a id="idp85784144" class="indexterm"></a><p>Le fichier principal de configuration du serveur HTTP
	<span class="application">Apache</span> est, sous FreeBSD, le fichier
	<code class="filename">/usr/local/etc/apache/httpd.conf</code>.  Ce
	fichier est un fichier texte de configuration <span class="trademark">UNIX</span>® typique
	avec des lignes de commentaires débutant par un
	caractère <code class="literal">#</code>.  Une description
	complète de toutes les options de configuration
	possibles dépasse le cadre de cet ouvrage, aussi seules
	les directives les plus fréquemment modifiées
	seront décrites ici.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ServerRoot "/usr/local"</code></span></dt><dd><p>Indique le répertoire d'installation par
	      défaut pour l'arborescence
	      <span class="application">Apache</span>.  Les binaires sont
	      stockés dans les sous-répertoires <code class="filename">bin</code> et <code class="filename">sbin</code> de la racine du serveur,
	      et les fichiers de configuration dans <code class="filename">etc/apache</code>.</p></dd><dt><span class="term"><code class="literal">ServerAdmin you@your.address</code></span></dt><dd><p>L'adresse électronique à laquelle tous
	      les problèmes concernant le serveur doivent
	      être rapportés.  Cette adresse apparaît
	      sur certaines pages générées par le
	      serveur, comme des pages d'erreur.</p></dd><dt><span class="term"><code class="literal">ServerName www.example.com</code></span></dt><dd><p>La directive <code class="literal">ServerName</code> vous
	      permet de fixer un nom de machine qui est renvoyé
	      aux clients de votre serveur si le nom est
	      différent de celui de la machine (i.e, utilisez
	      <code class="systemitem">www</code> à la place du véritable
	      nom de la machine).</p></dd><dt><span class="term"><code class="literal">DocumentRoot "/usr/local/www/data"</code></span></dt><dd><p><code class="literal">DocumentRoot</code> est le
	      répertoire où se trouvent les documents que
	      votre serveur diffusera.  Par défaut, toutes les
	      requêtes sont prises en compte par rapport à
	      ce répertoire, mais des liens symboliques et des
	      alias peuvent être utilisés pour pointer vers
	      d'autres emplacements.</p></dd></dl></div><p>C'est toujours une bonne idée de faire des copies
	de sauvegarde de votre fichier de configuration
	d'<span class="application">Apache</span> avant de faire des
	modifications.  Une fois que vous êtes satisfait avec
	votre configuration, vous êtes prêt à
	lancer <span class="application">Apache</span>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85802960"></a>29.7.3. Exécuter <span class="application">Apache</span></h3></div></div></div><a id="idp85803984" class="indexterm"></a><p><span class="application">Apache</span> n'est pas lancé
	à partir du &#8220;super-serveur&#8221;
	<span class="application">inetd</span> comme pour beaucoup d'autres
	serveurs réseau.  Il est configuré pour tourner
	de façon autonome pour de meilleures performances
	à la réception des requêtes HTTP des
	navigateurs web.  Une procédure est fournie pour rendre
	le démarrage, l'arrêt, et le redémarrage
	du serveur aussi simple que possible.  Pour démarrer
	<span class="application">Apache</span> pour la première
	fois, exécutez:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/usr/local/sbin/apachectl start</code></strong></pre><p>Vous pouvez arrêter le serveur à tout moment
	en tapant:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/usr/local/sbin/apachectl stop</code></strong></pre><p>Après avoir effectué des modifications dans
	le fichier de configuration, vous devez redémarrer le
	serveur:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/usr/local/sbin/apachectl restart</code></strong></pre><p>Pour redémarrer <span class="application">Apache</span>
	sans faire échouer les connexions en cours,
	exécutez:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/usr/local/sbin/apachectl graceful</code></strong></pre><p>Des informations supplémentaires sont disponibles
	dans la page de manuel d'<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=apachectl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">apachectl</span>(8)</span></a>.</p><p>Pour lancer <span class="application">Apache</span> au
	démarrage du système, ajoutez la ligne suivante
	au fichier <code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">apache_enable="YES"</pre><p>Si vous désirez passer des options en ligne de
	commande supplémentaires au programme
	<code class="command">httpd</code> d'<span class="application">Apache</span>
	lancé au démarrage du système, vous
	pouvez les spécifier à l'aide d'une ligne dans
	<code class="filename">rc.conf</code>:</p><pre class="programlisting">apache_flags=""</pre><p>Maintenant que le serveur web tourne, vous pouvez voir
	votre site web en pointant votre navigateur sur
	<code class="literal">http://localhost/</code>.  La page web
	affichée par défaut est
	<code class="filename">/usr/local/www/data/index.html</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85817808"></a>29.7.4. Serveurs virtuels</h3></div></div></div><p><span class="application">Apache</span> supporte deux types
	différents de serveurs virtuels.  Le premier type est
	celui des serveurs virtuels basés sur les noms.  Ce
	type de serveurs virtuels utilise les entêtes HTTP/1.1
	pour déterminer le nom de la machine.  Cela autorise le
	partage de la même adresse IP entre plusieurs domaines
	différents.</p><p>Pour configurer <span class="application">Apache</span> à
	l'utilisation de serveurs virtuels basés sur les noms,
	ajoutez une entrée comme la suivante à votre
	fichier <code class="filename">httpd.conf</code>:</p><pre class="programlisting">NameVirtualHost *</pre><p>Si votre serveur web est appelé <code class="systemitem">www.domain.tld</code> et que vous voulez mettre
	en place un domain virtuel pour <code class="systemitem">www.someotherdomain.tld</code> alors vous
	ajouterez les entrées suivantes au fichier
	<code class="filename">httpd.conf</code>:</p><pre class="screen">&lt;VirtualHost *&gt;
ServerName www.domain.tld
DocumentRoot /www/domain.tld
&lt;/VirtualHost&gt;

&lt;VirtualHost *&gt;
ServerName www.someotherdomain.tld
DocumentRoot /www/someotherdomain.tld
&lt;/VirtualHost&gt;</pre><p>Remplacez les addresses avec celles que vous
	désirez utiliser et le chemin d'accès des
	documents avec celui que vous utilisez.</p><p>Pour plus d'informations sur la mise en place de serveurs
	virtuels, veuillez consulter la documentation officielle
	d'<span class="application">Apache</span> à l'adresse <code class="uri"><a class="uri" href="http://httpd.apache.org/docs/vhosts/" target="_top">http://httpd.apache.org/docs/vhosts/</a></code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85833168"></a>29.7.5. Modules Apache</h3></div></div></div><a id="idp85833808" class="indexterm"></a><p>Il existe de nombreux modules
	<span class="application">Apache</span> disponibles en vue d'ajouter
	des fonctionnalités au serveur de base.  Le catalogue
	des logiciels portés offre une méthode simple
	d'installation d'<span class="application">Apache</span> avec
	certains des modules les plus populaires.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85835856"></a>29.7.5.1. mod_ssl</h4></div></div></div><a id="idp85836624" class="indexterm"></a><a id="idp85837520" class="indexterm"></a><a id="idp85838032" class="indexterm"></a><p>Le module <span class="application">mod_ssl</span> utilise la
	  bibliothèque OpenSSL pour offrir un chiffrement
	  solide à l'aide des protocoles &#8220;Secure Sockets
	  Layer&#8221; (SSL v2/v3) et &#8220;Transport Layer
	  Security&#8221;.  Ce module fourni tout ce qui est
	  nécessaire à la demande de certificats
	  signés auprès d'une autorité de
	  certification connue de façon à pouvoir faire
	  tourner un serveur web sécurisé sous
	  FreeBSD.</p><p>Si vous n'avez pas déjà installé
	  <span class="application">Apache</span>, alors une version
	  d'<span class="application">Apache</span> 1.3.X comprenant
	  <span class="application">mod_ssl</span> peut être
	  installée à l'aide du logiciel porté
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache13-modssl/pkg-descr">www/apache13-modssl</a>.  Le support
	  SSL est également disponible pour
	  <span class="application">Apache</span> 2.X avec le logiciel
	  porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache20/pkg-descr">www/apache20</a>, où il est
	  activé par défaut.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85843024"></a>29.7.5.2. Sites Web dynamiques avec Perl &amp; PHP</h4></div></div></div><p>Ces dernières années, de plus en plus
	  d'entreprises se sont tournées vers l'Internet pour
	  augmenter leurs revenus et renforcer leur exposition.  Cela
	  a eu pour conséquence d'accroître le besoin de
	  contenus Web interactifs.  Quand certaines entreprises,
	  comme <span class="trademark">Microsoft</span>®, ont introduit dans leurs produits
	  propriétaires des solutions à ces besoins, la
	  communauté des logiciels libres a également
	  répondu à l'appel.  Deux options pour obtenir
	  du contenu Web dynamique sont
	  <span class="application">mod_perl</span> et
	  <span class="application">mod_php</span>.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85845456"></a>29.7.5.2.1. mod_perl</h5></div></div></div><a id="idp85846096" class="indexterm"></a><p>Le projet d'intégration
	  <span class="application">Apache</span>/Perl réuni la
	  puissance du langage de programmation Perl et le serveur
	  HTTP <span class="application">Apache</span>.  Avec le module
	  <span class="application">mod_perl</span> il est alors possible
	  d'écrire des modules
	  <span class="application">Apache</span> entièrement en
	  Perl.  De plus, la présence d'un interpréteur
	  intégré au serveur évite la surcharge
	  due au lancement d'un interpréteur externe et le
	  délai pénalisant du démarrage de
	  Perl.</p><p>Le module <span class="application">mod_perl</span> est peut
	    être obtenu de diverses manières.  Pour
	    l'utilisation du module
	    <span class="application">mod_perl</span> souvenez-vous que
	    <span class="application">mod_perl</span> 1.0 ne fonctionne
	    qu'avec <span class="application">Apache</span> 1.3 et
	    <span class="application">mod_perl</span> 2.0 ne fonctionne
	    qu'avec <span class="application">Apache</span> 2.  Le module
	    <span class="application">mod_perl</span> 1.0 est disponible
	    sous <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/mod_perl/pkg-descr">www/mod_perl</a> et
	    une version compilée en statique sous <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache13-modperl/pkg-descr">www/apache13-modperl</a>.  Le module
	    <span class="application">mod_perl</span> 2.0 est disponible
	    sous <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/mod_perl2/pkg-descr">www/mod_perl2</a>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85854032"></a>29.7.5.2.2. mod_php</h5></div><div><span class="authorgroup">Ecrit par <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><a id="idp85856464" class="indexterm"></a><p><acronym class="acronym">PHP</acronym>, aussi connu sous le nom de
	  <span class="quote">« <span class="quote">PHP: Hypertext Preprocessor</span> »</span> est un langage de
	  script tout particulièrement adapté au
	  développement Web.  Pouvant être
	  intégré à du <acronym class="acronym">HTML</acronym>,
	  sa syntaxe est dérivée du C, <span class="trademark">Java</span>&#8482;, et du
	  Perl avec pour objectif de permettre aux développeurs
	  Web d'écrire rapidement des pages Web au contenu
	  généré dynamiquement.</p><p>Pour ajouter le support de <acronym class="acronym">PHP</acronym>5 au
	  serveur Web <span class="application">Apache</span>, commencez par
	  installer le logiciel porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/php5/pkg-descr">lang/php5</a>.</p><p>Si c'est la première installation du logiciel
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/php5/pkg-descr">lang/php5</a>, les
	  <code class="literal">OPTIONS</code> disponibles seront
	  affichées automatiquement.  Si aucun menu n'est
	  affiché, parce que le logiciel porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/php5/pkg-descr">lang/php5</a> a été
	  installé par le passé, il est toujours
	  possible de forcer l'affichage du menu des options de
	  compilation en utilisant la commande:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make config</code></strong></pre><p>dans le répertoire du logiciel
	  porté.</p><p>Dans le menu des options de compilation,
	  sélectionnez l'option <code class="literal">APACHE</code> pour
	  compiler <span class="application">mod_php5</span> sous forme de
	  module chargeable pour le serveur Web
	  <span class="application">Apache</span>.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">De nombreux sites utilisent toujours
	    <acronym class="acronym">PHP</acronym>4 pour diverses raisons (des
	    problèmes de compatibilité ou des
	    applications Web déjà
	    déployées).  Si
	    <span class="application">mod_php4</span> est requis à la
	    place de <span class="application">mod_php5</span>, utilisez
	    alors le logiciel porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/php4/pkg-descr">lang/php4</a>.  Le logiciel
	    porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/php4/pkg-descr">lang/php4</a>
	    supporte plusieurs des options de configuration et de
	    compilation du logiciel porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/php5/pkg-descr">lang/php5</a>.</p></div><p>Cela installera et configurera les modules requis au
	  support des applications dynamiques <acronym class="acronym">PHP</acronym>.
	  Assurez-vous que les sections suivantes ont
	  été ajoutées au fichier
	  <code class="filename">/usr/local/etc/apache/httpd.conf</code>:</p><pre class="programlisting">LoadModule php5_module        libexec/apache/libphp5.so</pre><pre class="programlisting">AddModule mod_php5.c
    &lt;IfModule mod_php5.c&gt;
        DirectoryIndex index.php index.html
    &lt;/IfModule&gt;
    &lt;IfModule mod_php5.c&gt;
        AddType application/x-httpd-php .php
        AddType application/x-httpd-php-source .phps
    &lt;/IfModule&gt;</pre><p>Ensuite, un simple appel à la commande
	  <code class="command">apachectl</code> pour un redémarrage
	  élégant est requis pour charger le module
	  <acronym class="acronym">PHP</acronym>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>apachectl graceful</code></strong></pre><p>Lors des futures mises à jour de
	  <acronym class="acronym">PHP</acronym>, la commande <code class="command">make
	  config</code> ne sera pas nécessaire; les
	  <code class="literal">OPTIONS</code> précédemment
	  sélectionnées sont automatiquement
	  sauvegardées par le système des logiciels
	  portés de FreeBSD.</p><p>Le support de <acronym class="acronym">PHP</acronym> sous FreeBSD est
	  extrêmement modulaire ce qui donne lieu à une
	  installation de base limitée.  Il est très
	  simple d'ajouter une fonctionnalité en utilisant le
	  logiciel porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/lang/php5-extensions/pkg-descr">lang/php5-extensions</a>.  Ce logiciel
	  porté fournit un menu pour l'installation des
	  extensions <acronym class="acronym">PHP</acronym>.  Alternativement, il est
	  possible d'installer les extensions individuellement en
	  utilisant les logiciels portés correspondants.</p><p>Par exemple, pour ajouter à
	  <acronym class="acronym">PHP</acronym>5 le support pour le serveur de bases
	  de données <span class="application">MySQL</span>,
	  installez simplement le logiciel porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/databases/php5-mysql/pkg-descr">databases/php5-mysql</a>.</p><p>Après l'installation d'une extension, le serveur
	  <span class="application">Apache</span> doit être
	  redémarré pour prendre en compte les
	  changements de configuration:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>apachectl graceful</code></strong></pre></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-dns.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="network-servers.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="network-ftp.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">29.6. Serveurs de noms (<acronym class="acronym">DNS</acronym>) </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 29.8. Protocole de transfert de fichiers (FTP)</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>