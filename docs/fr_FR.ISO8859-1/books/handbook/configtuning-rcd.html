<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>12.7. Utilisation du système rc sous FreeBSD</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="config-tuning.html" title="Chapitre 12. Configuration et optimisation" /><link rel="prev" href="configtuning-cron.html" title="12.6. Configuration de l'utilitaire cron" /><link rel="next" href="config-network-setup.html" title="12.8. Configuration des cartes réseaux" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">12.7. Utilisation du système rc sous FreeBSD</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="configtuning-cron.html">Précédent</a> </td><th width="60%" align="center">Chapitre 12. Configuration et optimisation</th><td width="20%" align="right"> <a accesskey="n" href="config-network-setup.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="configtuning-rcd"></a>12.7. Utilisation du système rc sous FreeBSD</h2></div><div><span class="authorgroup">Contribution de <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><p>En 2002, le système <code class="filename">rc.d</code> de NetBSD pour
      l'initialisation du système a
      été intégré à FreeBSD.  Les
      utilisateurs noteront les fichiers présents dans le
      répertoire <code class="filename">/etc/rc.d</code>.  Plusieurs de ces
      fichiers sont destinés aux services de base qui peuvent
      être contrôlés avec les options
      <code class="option">start</code>, <code class="option">stop</code>, et
      <code class="option">restart</code>.  Par exemple, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sshd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sshd</span>(8)</span></a> peut
      être relancé avec la commande suivante:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/sshd restart</code></strong></pre><p>Cette procédure est similaire pour d'autres services.
      Bien sûr, les services sont généralement
      lancés automatiquement au démarrage dès qu'ils sont
      spécifiés dans le fichier <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>.  Par
      exemple, activer le &#8220;daemon&#8221; de translation d'adresses
      au démarrage est aussi simple que d'ajouter la ligne
      suivante au fichier <code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">natd_enable="YES"</pre><p>Si une ligne <code class="option">natd_enable="NO"</code> est
      déjà présente, modifiez alors le
      <code class="option">NO</code> par <code class="option">YES</code>.  Les
      procédures rc chargeront automatiquement les autres
      services dépendants lors du prochain redémarrage
      comme décrit ci-dessous.</p><p>Comme le système <code class="filename">rc.d</code> est
      à l'origine destiné pour lancer/arrêter les
      services au démarrage/à l'arrêt du
      système, les options standards <code class="option">start</code>,
      <code class="option">stop</code> et <code class="option">restart</code> ne seront
      effectives que si les variables appropriées sont
      positionnées dans le fichier
      <code class="filename">/etc/rc.conf</code>.  Par exemple, la commande
      <code class="command">sshd restart</code> ci-dessus ne fonctionnera que si
      <code class="varname">sshd_enable</code> est fixée à
      <code class="option">YES</code> dans <code class="filename">/etc/rc.conf</code>.
      Pour lancer, arrêter ou redémarrer un service
      indépendemment des paramétrages du fichier
      <code class="filename">/etc/rc.conf</code>, les commandes doivent
      être précédées par
      <span class="quote">« <span class="quote">one</span> »</span>.  Par exemple pour redémarrer
      <code class="command">sshd</code> indépendemment du
      paramétrage du fichier <code class="filename">/etc/rc.conf</code>,
      exécutez la commande suivante:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/sshd onerestart</code></strong></pre><p>Il est facile de contrôler si un service est
      activé dans le fichier <code class="filename">/etc/rc.conf</code>
      en exécutant la procédure
      <code class="filename">rc.d</code> appropriée avec l'option
      <code class="option">rcvar</code>.  Ainsi, un administrateur peut
      contrôler que <code class="command">sshd</code> est
      réellement activé dans
      <code class="filename">/etc/rc.conf</code> en exécutant:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/sshd rcvar</code></strong>
# sshd
$sshd_enable=YES</pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">La seconde ligne (<code class="literal"># sshd</code>) est la sortie
	de la commande <code class="command">sshd</code> et non pas une console
	<code class="systemitem">root</code>.</p></div><p>Pour déterminer si un service est actif, une option
      appelée <code class="option">status</code> est disponible.  Par
      exemple pour vérifier que <code class="command">sshd</code> a
      réellement été lancé:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/sshd status</code></strong>
sshd is running as pid 433.</pre><p>Dans certains cas, il est également possible de recharger un service
      avec l'option <code class="option">reload</code>.  Le système
      tentera d'envoyer un signal à un service individuel, le
      forçant à recharger ses fichiers de configuration.
      Dans la plupart des cas cela signifie envoyer un signal
      <code class="literal">SIGHUP</code> au service.  Le support de cette
      fonctionnalité n'est pas disponible pour chaque
      service.</p><p>Le système <code class="filename">rc.d</code> n'est pas
      uniquement utilisée pour les services réseaux,
      elle participe à la majeure partie de l'initialisation du
      système.  Prenez par exemple le fichier
      <code class="filename">bgfsck</code>.  Quand cette procédure est
      exécutée, il affichera le message suivant:</p><pre class="screen">Starting background file system checks in 60 seconds.</pre><p>Donc ce fichier est utilisé pour les
      vérifications du système de fichiers en
      arrière plan, qui sont uniquement effectuées lors
      de l'initialisation du système.</p><p>De nombreux services système dépendent
      d'autres services pour fonctionner correctement.  Par exemple,
      NIS et les autres services basés sur les RPCs peuvent
      échouer s'ils sont lancés après le
      lancement du service <code class="command">rpcbind</code> (portmapper).
      Pour résoudre ce problème, l'information
      concernant les dépendances et autres
      méta-données est inclue dans les commentaires au
      début de chaque procédure de démarrage.  Le
      programme <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcorder&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rcorder</span>(8)</span></a> est alors utilisé pour analyser
      ces commentaires lors de l'initialisation du système en
      vue de déterminer l'ordre dans lequel les services
      système seront invoqués pour satisfaire les
      dépendances.  Les mots suivants peuvent être
      présents en tête de chaque fichier de
      démarrage:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">PROVIDE</code>: indique les services que
	  fournit ce fichier.</p></li><li class="listitem"><p><code class="literal">REQUIRE</code>: liste les fichiers dont
	  dépend ce service.  Ce fichier sera
	  exécuté <span class="emphasis"><em>après</em></span> les
	  services indiqués.</p></li><li class="listitem"><p><code class="literal">BEFORE</code>: liste les services qui
	  dépendent du service présent.  Ce fichier sera
	  exécuté <span class="emphasis"><em>avant</em></span> les services
	  indiqués.</p></li></ul></div><p>En utilisant ce système, un administrateur peut
      facilement contrôler les services du système sans
      avoir à se battre avec les &#8220;runlevels&#8221; comme
      sur d'autres systèmes d'exploitation <span class="trademark">UNIX</span>®.</p><p>Des informations supplémentaires concernant le
      système <code class="filename">rc.d</code>
      peuvent être trouvées dans les pages de manuel
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a> et <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.subr&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc.subr</span>(8)</span></a>.  Si vous êtes
      intéressé par l'écriture de vos propres
      procédures <code class="filename">rc.d</code> ou pour
      l'amélioration des procédures existantes, vous
      trouverez <a class="link" href="../../../../doc/en_US.ISO8859-1/articles/rc-scripting" target="_top">cette
      article</a> utile.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="configtuning-cron.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="config-tuning.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="config-network-setup.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">12.6. Configuration de l'utilitaire
      <code class="command">cron</code> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 12.8. Configuration des cartes réseaux</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>