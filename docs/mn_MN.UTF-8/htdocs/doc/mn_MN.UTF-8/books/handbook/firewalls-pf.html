<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>31.4. OpenBSD Пакет шүүгч (PF) ба ALTQ</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD гарын авлага" /><link rel="up" href="firewalls.html" title="Бүлэг 31. Галт хана" /><link rel="prev" href="firewalls-apps.html" title="31.3. Галт ханын багцууд" /><link rel="next" href="firewalls-ipf.html" title="31.5. IPFILTER (IPF) Галт хана" /><link rel="copyright" href="legalnotice.html" title="Хуулийн заалт" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">31.4. OpenBSD Пакет шүүгч (PF) ба
      <acronym class="acronym">ALTQ</acronym></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="firewalls-apps.html">Өмнөх</a> </td><th width="60%" align="center">Бүлэг 31. Галт хана</th><td width="20%" align="right"> <a accesskey="n" href="firewalls-ipf.html">Дараах</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="firewalls-pf"></a>31.4. OpenBSD Пакет шүүгч (PF) ба
      <acronym class="acronym">ALTQ</acronym></h2></div><div><span class="authorgroup">Хянан залруулж шинэчилсэн <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Жон</span> <span class="surname">Феррел</span></span>. </span></div></div></div><a id="idp91774032" class="indexterm"></a><p>2003 оны 7 сард OpenBSD-н галт ханын програм болох
      <acronym class="acronym">PF</acronym> FreeBSD уруу шилжиж, FreeBSD Портын Цуглуулгад
      орсон. 2004 онд гарсан FreeBSD 5.3 нь <acronym class="acronym">PF</acronym>-г
      үндсэн системийн багцын нэг хэсэг болгон оруулсан анхны хувилбар юм.
      <acronym class="acronym">PF</acronym> нь бүрэн хэмжээнд ажиллах чадвартай
      галт хана бөгөөд <acronym class="acronym">ALTQ</acronym>-тай (Alternate
      Queuing буюу Ээлжлэн солигдох дараалал) хамтран ажиллах боломжтой.  <acronym class="acronym">ALTQ</acronym> нь
      Quality of Service буюу Үйлчилгээний Чанарын (<acronym class="acronym">QoS</acronym>)
      боломжоор хангадаг.
      OpenBSD Төсөл нь <a class="link" href="http://www.openbsd.org/faq/pf/" target="_top">PF FAQ</a>-г хөтлөн
      явуулдаг.
      Тиймээс гарын авлагын энэ хэсэг нь FreeBSD-д хамаатай
      <acronym class="acronym">PF</acronym> дээр илүү анхаарлаа хандуулахахаас гадна
      хэрэглээний талаар зарим нэг ерөнхий мэдээллийг өгнө. Хэрэглээний
      мэдээллийн талаар илүү дэлгэрэнгүйг <a class="link" href="http://www.openbsd.org/faq/pf/" target="_top">PF FAQ</a>-с үзнэ үү.</p><p>FreeBSD-д зориулсан  <acronym class="acronym">PF</acronym>-ийн талаар илүү дэлгэрэнгүй мэдээллийг
      <code class="uri"><a class="uri" href="http://pf4freebsd.love2party.net/" target="_top">http://pf4freebsd.love2party.net/</a></code> хаягаас үзэж болно.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91784784"></a>31.4.1. Цөмийн дуудагдах PF модулиудыг ашиглах нь</h3></div></div></div><p>PF цөмийн модулийг дуудахдаа <code class="filename">/etc/rc.conf</code> файлд
	дараах мөрийг нэмнэ:</p><pre class="programlisting">pf_enable="YES"</pre><p>Дараа нь модулийг дуудахдаа эхлүүлэх скриптийг ажиллуулна:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/pf start</code></strong></pre><p>PF модуль нь дүрмийн тохиргооны файлаа олж чадахгүй бол дуудагдахгүйг
	санаарай. Анхдагч байрлал нь <code class="filename">/etc/pf.conf</code> байна.
	Хэрэв PF дүрмийн олонлог өөр хаа нэгтээ байгаа бол <code class="filename">/etc/rc.conf</code>
	файлд доор дурдсантай адил мөрийг нэмж PF дүрмийн олонлогоо тэр газраас
	хайхаар зааж өгч болно:</p><pre class="programlisting">pf_rules="<em class="replaceable"><code>/path/to/pf.conf</code></em>"</pre><p>Жишээ <code class="filename">pf.conf</code> файлыг <code class="filename">/usr/share/examples/pf/</code> сангаас олж болно.</p><p><acronym class="acronym">PF</acronym> модулийг тушаалын мөрөөс бас дуудан ажиллуулж
	болно:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kldload pf.ko</code></strong></pre><p>PF-д зориулсан бүртгэл хөтлөх дэмжлэгийг
	<code class="literal">pflog.ko</code> хангадаг бөгөөд
	<code class="filename">/etc/rc.conf</code> файлд дараах мөрийг нэмж
	дуудаж болно:</p><pre class="programlisting">pflog_enable="YES"</pre><p>Дараа нь модулийг дуудахдаа эхлүүлэх скриптийг ажиллуулна:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/pflog start</code></strong></pre><p>Хэрэв танд <acronym class="acronym">PF</acronym>-ийн өөр боломжууд хэрэгтэй
	бол <acronym class="acronym">PF</acronym>-ийн дэмжлэгийг цөмд оруулан эмхэтгэх
	хэрэгтэй.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91805008"></a>31.4.2. PF цөмийн тохиргоонууд</h3></div></div></div><a id="idp91805648" class="indexterm"></a><a id="idp91806800" class="indexterm"></a><a id="idp91807952" class="indexterm"></a><p><acronym class="acronym">PF</acronym> дэмжлэгийг FreeBSD цөмд оруулж эмхэтгэх нь
	шаардлагагүй боловч дуудагдах модульд ороогүй байдаг PF-ийн нэмэлт
	боломжуудын нэг бөгөөд <acronym class="acronym">PF</acronym>-ийн ашигладаг төлвийн хүснэгтэд
	зарим өөрчлөлтүүдийг ил гаргадаг псевдо төхөөрөмж болох <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfsync&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pfsync</span>(4)</span></a>
	гэгддэг боломжийг ашиглахын тулд та тэгж хийж өгч болох юм. Үүнийг
	 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=carp&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">carp</span>(4)</span></a>-тэй хослуулан ажиллагаа доголдоход тойрон гарах галт ханаыг
	<acronym class="acronym">PF</acronym> ашиглан бүтээж болно. <acronym class="acronym">CARP</acronym>-ийн
	талаар дэлгэрэнгүйг гарын авлагын <a class="xref" href="carp.html" title="32.13. Common Address Redundancy Protocol (CARP)">Хэсэг 32.13, «Common Address Redundancy Protocol (CARP)»</a>-с
	үзэж болно.</p><p>Цөмийн <acronym class="acronym">PF</acronym> тохиргоонуудыг
	<code class="filename">/usr/src/sys/conf/NOTES</code>-с олж болох бөгөөд
	доор үзүүлэв:</p><pre class="programlisting">device pf
device pflog
device pfsync</pre><p><code class="literal">device pf</code> тохиргоо <span class="quote">«<span class="quote">Packet Filter</span>»</span>
галт ханыг (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pf&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pf</span>(4)</span></a>) дэмждэг болгоно.</p><p><code class="literal">device pflog</code> тохиргоо
псевдо буюу хуурамч <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pflog&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pflog</span>(4)</span></a> сүлжээний төхөөрөмжийг идэвхжүүлнэ. Энэ хуурамч
төхөөрөмжийн тусламжтайгаар <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bpf&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bpf</span>(4)</span></a> дескриптор уруу урсгалыг бүртгэх
боломжтой. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pflogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pflogd</span>(8)</span></a> дэмонг бүртгэлийг дискэн дээр хадгалахад хэрэглэнэ.</p><p><code class="literal">device pfsync</code> тохиргоо
псевдо буюу хуурамч <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfsync&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pfsync</span>(4)</span></a> сүлжээний төхөөрөмжийг идэвхжүүлнэ. Энэ хуурамч
төхөөрөмжийн тусламжтайгаар <span class="quote">«<span class="quote">төлвийн өөрчлөлтүүдийг</span>»</span> хянах боломжтой.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91821392"></a>31.4.3. rc.conf боломжууд</h3></div></div></div><p>Дараах <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> илэрхийллүүд
	<acronym class="acronym">PF</acronym> болон <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pflog&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pflog</span>(4)</span></a>-ийг ачаалах үед тохируулна:</p><pre class="programlisting">pf_enable="YES"                 # Enable PF (load module if required)
pf_rules="/etc/pf.conf"         # rules definition file for pf
pf_flags=""                     # additional flags for pfctl startup
pflog_enable="YES"              # start pflogd(8)
pflog_logfile="/var/log/pflog"  # where pflogd should store the logfile
pflog_flags=""                  # additional flags for pflogd startup</pre><p>Хэрвээ энэ галт ханын цаана LAN байгаа бөгөөд
LAN-д байгаа компьютерууд уруу пакет дамжуулах шаардлагатай бол эсвэл
NAT ашиглах бодолтой байгаа бол дараах илэрхийлэл танд бас хэрэгтэй:</p><pre class="programlisting">gateway_enable="YES"            # Enable as LAN gateway</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91833936"></a>31.4.4. Шүүгч дүрмүүдийг үүсгэх нь</h3></div></div></div><p><acronym class="acronym">PF</acronym> нь <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pf.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">pf.conf</span>(5)</span></a>-с (анхдагчаар <code class="filename">/etc/pf.conf</code>)
	өөрийн тохиргооны дүрмүүдийг унших бөгөөд тэнд заагдсан дүрмүүд буюу тодорхойлолтуудын
	дагуу пакетуудыг өөрчлөх, орхих буюу эсвэл дамжуулдаг. FreeBSD суулгацад
	<code class="filename">/usr/share/examples/pf/</code>-д байрлах хэд хэдэн жишээ
	файлууд байдаг. <acronym class="acronym">PF</acronym>-ийн дүрмийн олонлогуудын талаар бүрэн мэдээллийг
	<a class="link" href="http://www.openbsd.org/faq/pf/" target="_top">PF FAQ</a>-с
	лавлана уу.</p><div xmlns="" class="warning"><h3 class="admontitle">Сануулга: </h3><p xmlns="http://www.w3.org/1999/xhtml"><a class="link" href="http://www.openbsd.org/faq/pf/" target="_top">PF FAQ</a>-г үзэж байхдаа
	  FreeBSD-ийн хувилбар бүр өөр өөр PF хувилбартай байж болохыг
	  анхаарах хэрэгтэй. Одоогоор FreeBSD 8.<em class="replaceable"><code>X</code></em> болон
	  түүнээс өмнөх хувилбарууд OpenBSD 4.1-ийн нэгэн адил
	  <acronym class="acronym">PF</acronym>-ийн хувилбарыг ашигладаг.
	  FreeBSD 9.<em class="replaceable"><code>X</code></em> болон түүнээс хойшхи хувилбарууд
	  OpenBSD 4.5-ийн нэгэн адил
	  <acronym class="acronym">PF</acronym>-ийн хувилбарыг ашигладаг.</p></div><p><a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-pf" target="_top">FreeBSD пакет шүүгчийн захидлын жагсаалт</a> нь <acronym class="acronym">PF</acronym> галт ханыг тохируулж ажиллуулах
	талаар асуухад тохиромжтой газар юм. Асуулт асуухаасаа өмнө захидлын
	жагсаалтын архиваас шалгахаа мартуузай!</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91841872"></a>31.4.5. PF-тэй ажиллах нь</h3></div></div></div><p><acronym class="acronym">PF</acronym>-ийг хянахдаа <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pfctl</span>(8)</span></a>-г ашиглана.
	Зарим нэг хэрэгтэй тушаалуудыг доор жагсаав (Бүх боломжит тохиргоонуудын
	талаар <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pfctl</span>(8)</span></a> гарын авлагын хуудаснаас лавлахаа мартуузай):</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Тушаал</th><th>Зорилго</th></tr></thead><tbody><tr><td><code class="command">pfctl -e</code></td><td>PF-г идэвхжүүлэх</td></tr><tr><td><code class="command">pfctl -d</code></td><td>PF-г болиулах</td></tr><tr><td><code class="command">pfctl -F all -f /etc/pf.conf</code></td><td>Бүх дүрмүүдийг арилгаж (nat, шүүх, төлөв, хүснэгт, гэх мэт.)
		<code class="filename">/etc/pf.conf</code> файлаас дахин ачаалах</td></tr><tr><td><code class="command">pfctl -s [ rules | nat | state ]</code></td><td>Шүүх дүрмүүд, nat дүрмүүд, эсвэл төлвийн хүснэгтийн талаар тайлан гаргах</td></tr><tr><td><code class="command">pfctl -vnf /etc/pf.conf</code></td><td>Дүрмийн олонлогийг ачаалалгүйгээр <code class="filename">/etc/pf.conf</code>-д
		алдаа байгаа эсэхийг шалгах</td></tr></tbody></table></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91855312"></a>31.4.6. <acronym class="acronym">ALTQ</acronym>-г идэвхжүүлэх</h3></div></div></div><p><acronym class="acronym">ALTQ</acronym>-г идэвхжүүлэх ганц арга зам бол түүний боломжуудыг
FreeBSD цөмтэй хамт хөрвүүлэн эмхэтгэх юм. Мөн сүлжээний картын драйвер болгон <acronym class="acronym">ALTQ</acronym>-г
дэмждэггүй тул өөрийн тань хэрэглэж буй FreeBSD хувилбарын хувьд дэмжигддэг драйверуудын жагсаалтыг
<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=altq&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">altq</span>(4)</span></a> гарын авлагын хуудаснаас үзнэ үү.</p><p>Дараах тохируулгууд
<acronym class="acronym">ALTQ</acronym>-г идэвхжүүлж нэмэлт үүргүүдийг оруулдаг.</p><pre class="programlisting">options         ALTQ
options         ALTQ_CBQ        # Class Bases Queuing (CBQ)
options         ALTQ_RED        # Random Early Detection (RED)
options         ALTQ_RIO        # RED In/Out
options         ALTQ_HFSC       # Hierarchical Packet Scheduler (HFSC)
options         ALTQ_PRIQ       # Priority Queuing (PRIQ)
options         ALTQ_NOPCC      # Required for SMP build</pre><p><code class="literal">options ALTQ</code> мөр <acronym class="acronym">ALTQ</acronym>
-г бүхэлд нь идэвхжүүлнэ.</p><p><code class="literal">options ALTQ_CBQ</code> мөр <span class="emphasis"><em>Class Based Queuing</em></span>
буюу Ангиллаас Хамаарсан Дараалал Үүсгэх(<acronym class="acronym">CBQ</acronym>) боломжийг идэвхжүүлнэ.
<acronym class="acronym">CBQ</acronym> нь шүүгч дүрмүүд дээр үндэслэн урсгалуудад эрэмбэ тогтоох зорилгоор
зурвасын өргөнийг өөр өөр ангиллуудад болон дарааллуудад хуваах боломжийг олгоно.</p><p><code class="literal">options ALTQ_RED</code> мөр <span class="emphasis"><em>Random Early
	Detection</em></span> буюу Санамсаргүй Эрт Илрүүлэлт(<acronym class="acronym">RED</acronym>)-г идэвхжүүлнэ.
<acronym class="acronym">RED</acronym>-г сүлжээний даац хэтрэхээс сэргийлэхэд хэрэглэдэг.
<acronym class="acronym">RED</acronym> дарааллын уртыг хэмжиж, түүнийг байх ёстой дээд ба
доод хэмжээтэй жиших байдлаар ажилладаг. Хэрэв дараалал дээд хэмжээнээс урт болбол
шинэ пакетууд орхигдох болно. Нэртэйгээ адилаар, <acronym class="acronym">RED</acronym> нь холболтуудаас пакетийг
санамсаргүйгээр орхигдуулдаг.</p><p><code class="literal">options ALTQ_RIO</code> мөр нь <span class="emphasis"><em>Random Early
	Detection In and Out</em></span> буюу Орох ба Гарах Санамсаргүй Эрт Илрүүлэлтийг идэвхжүүлнэ.</p><p><code class="literal">options ALTQ_HFSC</code> мөр нь
<span class="emphasis"><em>Hierarchical Fair Service Curve Packet Scheduler</em></span> буюу Үе давхаргат Зохимжит Үйлчилгээний Муруйн Пакет Хуваарилагчийг
идэвхжүүлнэ. <acronym class="acronym">HFSC</acronym> талаар илүү дэлгэрэнгүй мэдээллийг дараах хаягаас үзнэ үү:
<code class="uri"><a class="uri" href="http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html" target="_top">http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html</a></code>.</p><p><code class="literal">options ALTQ_PRIQ</code> мөр нь <span class="emphasis"><em>Priority Queuing</em></span> буюу Эрэмбэт Дараалал Үүсгэх
(<acronym class="acronym">PRIQ</acronym>)-г идэвхжүүлнэ. <acronym class="acronym">PRIQ</acronym> нь эрэмбэ өндөртэй дараалалд байгаа
урсгалыг эхэнд нэвтрүүлэх зарчмаар ажилладаг.</p><p><code class="literal">options ALTQ_NOPCC</code> мөр нь <acronym class="acronym">ALTQ</acronym>-г
<acronym class="acronym">SMP</acronym>-тай хамт ажиллах боломжтой болгоно.
<acronym class="acronym">SMP</acronym> системийн хувьд энэ боломжийг заавал идэвхжүүлэх хэрэгтэй.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="firewalls-apps.html">Өмнөх</a> </td><td width="20%" align="center"><a accesskey="u" href="firewalls.html">Дээш</a></td><td width="40%" align="right"> <a accesskey="n" href="firewalls-ipf.html">Дараах</a></td></tr><tr><td width="40%" align="left" valign="top">31.3. Галт ханын багцууд </td><td width="20%" align="center"><a accesskey="h" href="index.html">Эхлэл</a></td><td width="40%" align="right" valign="top"> 31.5. IPFILTER (IPF) Галт хана</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Энэ болон бусад баримтуудыг
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    хаягаас татаж авч болно.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD-ийн талаар
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;
    хаягтай холбоо барихаасаа өмнө
    <a href="http://www.FreeBSD.org/docs.html">баримтыг</a> уншина уу.<br></br>
    Энэ бичиг баримттай холбоотой асуулт байвал
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;
    хаягаар цахим захидал явуулна уу.<br></br>
    Энэ бичиг баримтын орчуулгатай холбоотой асуулт байвал
    &lt;<a href="mailto:admin@mnbsd.org">admin@mnbsd.org</a>&gt;
    хаягаар цахим захидал явуулна уу.</small></p></body></html>