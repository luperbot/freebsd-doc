<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>18.5. Аудит дэд системийг удирдах нь</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD гарын авлага" /><link rel="up" href="audit.html" title="Бүлэг 18. Аюулгүй байдлын үйл явцад аудит хийх нь" /><link rel="prev" href="audit-config.html" title="18.4. Аудитийн тохиргоо" /><link rel="next" href="disks.html" title="Бүлэг 19. Хадгалалт" /><link rel="copyright" href="legalnotice.html" title="Хуулийн заалт" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">18.5. Аудит дэд системийг удирдах нь</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="audit-config.html">Өмнөх</a> </td><th width="60%" align="center">Бүлэг 18. Аюулгүй байдлын үйл явцад аудит хийх нь </th><td width="20%" align="right"> <a accesskey="n" href="disks.html">Дараах</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="audit-administration"></a>18.5. Аудит дэд системийг удирдах нь</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81716176"></a>18.5.1. Аудит мөрүүдийг харах нь</h3></div></div></div><p>Аудит мөрүүд нь BSM хоёртын хэлбэрээр хадгалагддаг бөгөөд өөрчлөх болон текст
	уруу хөрвүүлэхэд тусгай хэрэгслүүд ашиглах шаардлагатай. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=praudit&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">praudit</span>(1)</span></a>
	тушаал нь мөрийн файлуудыг хялбар текст хэлбэрт хөрвүүлдэг; <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=auditreduce&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">auditreduce</span>(1)</span></a>
	тушаал нь аудит мөрийн файлыг шинжлэх, архивлах эсвэл хэвлэх зорилгоор багасгахад
	ашиглагддаг. <code class="command">auditreduce</code> нь үйл явцын төрөл, үйл явцын
	ангилал, үйл явцын хэрэглэгч, огноо эсвэл цаг, файлын зам эсвэл обьектийн үйлдэл үзүүлсэн
	зэрэг төрөл бүрийн сонголтын параметрүүдийг дэмждэг.</p><p>Жишээ нь <code class="command">praudit</code> хэрэгсэл нь заасан аудит бүртгэлийн бүх агуулгыг
	жирийн текстээр харуулна:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>praudit /var/audit/AUDITFILE</code></strong></pre><p> <code class="filename">AUDITFILE</code> нь харуулах аудит бүртгэл юм.</p><p>Аудит мөрүүд нь токенуудаас бүтэх аудит бичлэгүүдийн цувралаас тогтох бөгөөд
	<code class="command">praudit</code> нь мөр болгонд нэгийг дараалуулан хэвлэнэ.
	Токен бүр аудит бичлэгийн толгойг агуулсан <code class="literal">header</code>
	эсвэл нэрийн хайлтаас гарсан файлын замыг агуулсан <code class="literal">path</code>
	зэрэг тусгай төрлийн байна. Дараах жишээ нь <code class="literal">execve</code>
	үйл явцыг харуулж байна:</p><pre class="programlisting">header,133,10,execve(2),0,Mon Sep 25 15:58:03 2006, + 384 msec
exec arg,finger,doug
path,/usr/bin/finger
attribute,555,root,wheel,90,24918,104944
subject,robert,root,wheel,root,wheel,38439,38032,42086,128.232.9.100
return,success,0
trailer,133</pre><p>Энэхүү аудит нь амжилттай <code class="literal">execve</code> дуудлагыг илэрхийлж
	байгаа бөгөөд түүнд <code class="literal">finger doug</code> тушаал ажиллажээ. Нэмэлт өгөгдлийн токен нь
	цөм уруу бүрхүүлээс гарч боловсруулагдсан тушаалын мөрийг агуулна. <code class="literal">path</code> буюу замын токен
	нь цөмийн хайсан ажиллах файлын замыг агуулна. <code class="literal">attribute</code> буюу шинж чанарын токен
	нь хоёртын файлыг тайлбарлах ба тухайлбал програм setuid эсэхийг тодорхойлоход
	ашиглагдах файлын горимыг агуулна. <code class="literal">subject</code> буюу субьект токен нь субьект процессийг
	тайлбарлах бөгөөд аудит хэрэглэгчийн ID, идэвхитэй хэрэглэгчийн ID ба бүлгийн ID,
	жинхэнэ хэрэглэгчийн ID ба бүлгийн ID, процессийн ID, сессийн ID, портын ID болон
	нэвтрэлтийн хаяг гэсэн дарааллаар хадгална. Аудит хэрэглэгчийн ID ба жинхэнэ хэрэглэгчийн
	ID нь ялгаатайг анхаарах хэрэгтэй:
	<code class="systemitem">robert</code> гэдэг хэрэглэгч энэ тушаалыг ажиллуулахаасаа өмнө
	<code class="systemitem">root</code> бүртгэл уруу шилжсэн бөгөөд энэ нь эхний шалгуулсан
	хэрэглэгчийг ашиглан аудит хийгдсэн байна. Төгсгөлд нь <code class="literal">return</code> буюу буцах токен нь
	амжилттай ажиллагааг харуулж <code class="literal">trailer</code> нь бичлэгийг төгсгөнө.</p><p><code class="command">praudit</code> нь бас
	XML гаралтын хэлбэрийг дэмждэг бөгөөд үүнийг <code class="option">-x</code> нэмэлт өгөгдлийг
	ашиглан сонгож болдог.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81749840"></a>18.5.2. Аудитийн мөрүүдийг багасгах нь</h3></div></div></div><p>Аудит бүртгэлүүд нь маш их байж болно, администратор зарим хэрэглэгчтэй холбоотой
	бичлэгүүд зэрэг хэсэг бичлэгүүдийг ашиглахын тулд шилж сонгохыг магадгүй хүснэ:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>auditreduce -u trhodes /var/audit/AUDITFILE | praudit</code></strong></pre><p>Энэ нь <code class="filename">AUDITFILE</code> файлд хадгалагдсан
	<code class="systemitem">trhodes</code> хэрэглэгчийн бүх аудитийн бичлэгүүдийг сонгож
	байна.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81753168"></a>18.5.3. Аудит хянах эрхүүдийг томилох нь</h3></div></div></div><p><code class="systemitem">audit</code> бүлгийн гишүүд <code class="filename">/var/audit</code>
	дахь аудит мөрүүдийг унших эрхтэй; анхандаа энэ бүлэг нь хоосон байх бөгөөд тэгэхээр зөвхөн
	<code class="systemitem">root</code> хэрэглэгч аудит мөрүүдийг уншиж чадна. Аудит хянах эрхүүдийг хэрэглэгчдэд
	томилохын тулд хэрэглэгчдийг <code class="systemitem">audit</code> бүлэгт нэмж болно. Аудитийн
	бүртгэлийн агуулгыг хянах чадвар нь хэрэглэгчид болон процессуудын үйл хөдлөлийн дотоод уруу
	нэлээн гүнзгий ханддаг учир аудит хянах эрхүүдийг томилохдоо болгоомжтой хийхийг зөвлөж байна.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81756112"></a>18.5.4. Аудит хоолойнуудыг шууд монитор хийх нь</h3></div></div></div><p>Аудит хоолойнууд нь төхөөрөмжийн файлын систем дахь клон хийгдсэн псевдо төхөөрөмжүүд
	бөгөөд програмыг шууд явж байгаа аудит бичлэгийн урсгалд холбох боломж олгоно. Энэ нь голчлон
	халдлага илрүүлэх болон систем монитор хийх програмуудын зохиогчдын сонирхлыг татдаг.
	Гэхдээ администраторуудын хувьд аудитийн хоолойны төхөөрөмж нь аудитийн мөрийн файлын
	эзэмшил эсвэл үйл явцын урсгалыг зогсоох, бүртгэл эргүүлэх зэрэг асуудлуудтай холбогдолгүйгээр
	шууд монитор хийх эвтэйхэн боломжийг бүрдүүлдэг. Шууд явж байгаа аудитийн үйл явцын урсгалыг
	хянахдаа дараах тушаалын мөрийг ашиглана:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>praudit /dev/auditpipe</code></strong></pre><p>Анхандаа аудитийн  хоолойны төхөөрөмжийн цэгүүдэд зөвхөн <code class="systemitem">root</code> хэрэглэгч хандах
	эрхтэй байдаг. <code class="systemitem">audit</code> бүлгийн хэрэглэгчид хандах боломжтой
	болгохын тулд <code class="literal">devfs</code> дүрмийг <code class="filename">devfs.rules</code> -д
	нэмнэ:</p><pre class="programlisting">add path 'auditpipe*' mode 0440 group audit</pre><p>devfs файлын системийг тохируулах талаар дэлгэрэнгүй мэдээллийг <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs.rules&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">devfs.rules</span>(5)</span></a> -ээс
	харна уу.</p><div xmlns="" class="warning"><h3 class="admontitle">Сануулга: </h3><p xmlns="http://www.w3.org/1999/xhtml">Аудитийн үйл явцын буцааж өгөх давталтуудыг үүсгэх нь хялбар бөгөөд
	аудит үйл явц бүрийн үзэлт нь олон аудитийн үйл явцуудыг үүсгэхэд хүргэнэ. Жишээ нь,
	хэрэв сүлжээний бүх I/O аудит хийгдсэн бөгөөд <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=praudit&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">praudit</span>(1)</span></a> нь SSH сессээс ажилласан
	бол үйл явц бүр хэвлэгдэхэд өөр үйл явцыг бас үүсгэх учраас үргэлжилсэн аудитийн үйл
	явцууд их хэмжээгээр үүсэх болно. Энэ асуудлыг бий болгохгүйн тулд нарийн тохируулаагүй
	I/O аудит хийх сессээс <code class="command">praudit</code>-ийг аудитийн хоолойны төхөөрөмж дээр ажиллуулахыг
	зөвлөж байна.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81772240"></a>18.5.5. Аудит мөрийн файлуудыг эргүүлэх нь</h3></div></div></div><p>Аудит мөрүүд нь зөвхөн цөмөөр бичигдэх бөгөөд <span class="application">auditd</span>
	аудит дэмоноор удирдагддаг. Администраторууд аудит бүртгэлүүдийг шууд эргүүлэхдээ
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newsyslog.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">newsyslog.conf</span>(5)</span></a> эсвэл бусад хэрэгслүүдийг ашиглан хийх ёсгүй юм. Харин
	<code class="command">audit</code> удирдах хэрэгслийг ашиглан аудитийг унтраах,
	аудит системийг дахин тохируулах, болон бүртгэлийг эргүүлэх үйлдлүүдийг хийх боломжтой
	байдаг. Дараах тушаал аудит дэмонг шинэ аудит бүртгэл үүсгэж цөмийг шинэ бүртгэл
	уруу шилжихийг дохино. Хуучин бүртгэл нь төгсөж нэр нь өөрчлөгдөх бөгөөд дараагаар түүнтэй
	администратор ажиллах боломж бүрдэнэ.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>audit -n</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Сануулга: </h3><p xmlns="http://www.w3.org/1999/xhtml">Хэрэв <span class="application">auditd</span> дэмон ажиллахгүй байгаа бол энэ тушаал
	нь амжилтгүй болох бөгөөд алдааны мэдээлэл үүсгэнэ.</p></div><p>Дараах мөрийг <code class="filename">/etc/crontab</code> -д нэмснээр
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a> -оос арван хоёр цаг тутам эргүүлэх болно:</p><pre class="programlisting">0     */12       *       *       *       root    /usr/sbin/audit -n</pre><p>Шинэ <code class="filename">/etc/crontab</code> -ийг хадгалсны дараа өөрчлөлт
	үйлчилж эхлэх болно.</p><p>Файлын хэмжээн дээр тулгуурласан аудитийн мөрийн файлыг автоматаар эргүүлэх нь
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=audit_control&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">audit_control</span>(5)</span></a> дахь <code class="option">filesz</code> тохиргоогоор хийгдэх
	боломжтой бөгөөд гарын авлагын энэ бүлгийн тохиргооны файлуудын хэсэгт тайлбарласан болно.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81789648"></a>18.5.6. Аудит мөрүүдийг шахах нь</h3></div></div></div><p>Аудит мөрийн файлууд асар их болох тусам мөрүүдийг аудит дэмоноор хаалгасны
	дараа шахах эсвэл архивлах нь зүйтэй юм. <code class="filename">audit_warn</code>
	скрипт нь аудитийн мөрүүдийг эргүүлэх үеийн цэвэр төгсгөл зэрэг төрөл бүрийн аудиттай
	холбоотой үйл явцуудад зориулан өөрчилсөн үйлдлүүдийг гүйцэтгэхэд ашиглагдана.
	Жишээ нь хаагдах үед аудит мөрүүдийг шахах дараах кодыг <code class="filename">audit_warn</code>
	скриптэд нэмж болно:</p><pre class="programlisting">#
# Compress audit trail files on close.
#
if [ "$1" = closefile ]; then
        gzip -9 $2
fi</pre><p>Бусад архивлах идэвхүүдэд мөрийн файлуудыг төв сервер уруу хуулах, хуучин мөрийн
	файлуудыг устгах эсвэл хэрэггүй бичлэгүүдийг хасч аудит мөрийг багасгах зэрэг орж болно.
	Аудит мөрийн файлууд цэвэрхэн дууссан тохиолдолд скрипт ажиллана, тэгэхээр буруу унтраасны
	дараа дуусаагүй мөрүүд дээр ажиллахгүй.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="audit-config.html">Өмнөх</a> </td><td width="20%" align="center"><a accesskey="u" href="audit.html">Дээш</a></td><td width="40%" align="right"> <a accesskey="n" href="disks.html">Дараах</a></td></tr><tr><td width="40%" align="left" valign="top">18.4. Аудитийн тохиргоо </td><td width="20%" align="center"><a accesskey="h" href="index.html">Эхлэл</a></td><td width="40%" align="right" valign="top"> Бүлэг 19. Хадгалалт</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Энэ болон бусад баримтуудыг
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    хаягаас татаж авч болно.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD-ийн талаар
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;
    хаягтай холбоо барихаасаа өмнө
    <a href="http://www.FreeBSD.org/docs.html">баримтыг</a> уншина уу.<br></br>
    Энэ бичиг баримттай холбоотой асуулт байвал
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;
    хаягаар цахим захидал явуулна уу.<br></br>
    Энэ бичиг баримтын орчуулгатай холбоотой асуулт байвал
    &lt;<a href="mailto:admin@mnbsd.org">admin@mnbsd.org</a>&gt;
    хаягаар цахим захидал явуулна уу.</small></p></body></html>