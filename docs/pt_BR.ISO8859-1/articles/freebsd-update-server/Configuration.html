<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>4. Instalação &amp; Configuração</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Construa Seu Próprio Servidor de Atualização do FreeBSD" /><link rel="up" href="index.html" title="Construa Seu Próprio Servidor de Atualização do FreeBSD" /><link rel="prev" href="prerequisites.html" title="3. Pré-Requisitos" /><link rel="next" href="build.html" title="5. Preparando a atualização" /><link rel="copyright" href="trademarks.html" title="Nota Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4. Instalação &amp; Configuração</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="prerequisites.html">Anterior</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="build.html">Próxima</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="Configuration"></a>4. Instalação &amp; Configuração</h2></div></div></div><p>Para efetuar o download do software <a class="link" href="http://svnweb.freebsd.org/base/user/cperciva/freebsd-update-build/" target="_top">freebsd-update-server</a>
      instale o <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/subversion/pkg-descr">devel/subversion</a> e
      execute:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>svn co http://svn.freebsd.org/base/user/cperciva/freebsd-update-build freebsd-update-server</code></strong></pre><p>Atualize o <code class="filename">scripts/build.conf</code> de forma
      adequada.  Ele é usado durante as operações de
      compilação.</p><p>Aqui está o <code class="filename">build.conf</code> padrão, que
      deverá ser modificado para se adequar ao seu ambiente.</p><div class="informalexample"><pre class="programlisting">

# Main configuration file for FreeBSD Update builds.  The
# release-specific configuration data is lower down in
# the scripts tree.

# Location from which to fetch releases
export FTP=ftp://ftp2.freebsd.org/pub/FreeBSD/releases<a id="ftp-id"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>

# Host platform
export HOSTPLATFORM=`uname -m`

# Host name to use inside jails
export BUILDHOSTNAME=${HOSTPLATFORM}-builder.daemonology.net<a id="buildhost-id"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>

# Location of SSH key
export SSHKEY=/root/.ssh/id_dsa<a id="sshkey-id"></a><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span>

# SSH account into which files are uploaded
MASTERACCT=builder@wadham.daemonology.net<a id="mstacct-id"></a><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span>

# Directory into which files are uploaded
MASTERDIR=update-master.freebsd.org<a id="mstdir-id"></a><span><img src="./imagelib/callouts/5.png" alt="5" border="0" /></span></pre></div><p>Parâmentros que devem ser considerados:</p><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#ftp-id"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Este é o local de onde serão feitos os downloads das
	  imagens ISO (pela sub-rotina <code class="function">fetchiso()</code>
	  do <code class="filename">scripts/build.subr</code>).  O local a ser
	  configurado não é limitado a URIs de FTP.  Qualquer URI
	  suportada pela ferramenta <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fetch&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">fetch</span>(1)</span></a> pode ser
	  usada.</p><p>Customizações do código da
          <code class="function">fetchiso()</code> podem ser feitas copiando
          o script padrão <code class="filename">build.subr</code> para o
          local da sua versão e arquitetura específica
          <code class="filename">scripts/RELEASE/ARCHITECTURE/build.subr</code> e
          alterando o arquivo.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#buildhost-id"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>O nome do computador que fará a compilação.  Esta
	  informação será exibida durante a atualização dos
	  sistemas:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>uname -v</code></strong></pre></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#sshkey-id"><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span></a> </p></td><td valign="top" align="left"><p>A chave <span class="application">SSH</span> para enviar os
	  arquivos para o servidor de atualização.  O par de chaves
	  pode ser criado digitando <code class="command">ssh-keygen -t
	  dsa</code>.  Este parâmetro é opcional; a autenticação
	  por senha será usada como método de autenticação quando a
	  variável <code class="literal">SSHKEY</code> não estiver
	  definida.</p><p>A página do manual <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a> tem informações
	  mais detalhadas sobre o <span class="application">SSH</span> e os
	  passos apropriados para criar e usar chaves.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#mstacct-id"><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Conta para enviar os arquivos para o servidor de
	  atualização.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#mstdir-id"><span><img src="./imagelib/callouts/5.png" alt="5" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Diretório do servidor de atualização para o qual os 
	  arquivos serão enviados.</p></td></tr></table></div><p>O arquivo <code class="filename">build.conf</code> padrão, distribuído
      com o fonte do <span class="application">freebsd-update-server</span>,
      está preparado para compilar a versão i386 do FreeBSD.
      A titulo de exemplo sobre como compilar um servidor de 
      atualização para outras arquiteturas, as seguintes modificações
      são necessárias para a arquitetura amd64:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Crie um ambiente de compilação para o
	  amd64:</p><div class="informalexample"><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>mkdir -p /usr/local/freebsd-update-server/scripts/7.2-RELEASE/amd64</code></strong></pre></div></li><li class="step"><p>Copie o arquivo <code class="filename">build.conf</code> para o
	  diretório recém criado.  As configurações de compilação para
	  o FreeBSD 7.2-RELEASE na arquitetura amd64 devem ser
	  similares a:</p><div class="informalexample"><pre class="programlisting"># SHA256 hash of RELEASE disc1.iso image.
export RELH=1ea1f6f652d7c5f5eab7ef9f8edbed50cb664b08ed761850f95f48e86cc71ef5<a id="sha256-id"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>

# Components of the world, source, and kernels
export WORLDPARTS="base catpages dict doc games info manpages proflibs lib32"
export SOURCEPARTS="base bin contrib crypto etc games gnu include krb5  \
                lib libexec release rescue sbin secure share sys tools  \
                ubin usbin cddl"
export KERNELPARTS="generic"

# EOL date
export EOL=1275289200<a id="eol-id"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#sha256-id"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>A chave hash <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sha256&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">sha256</span>(1)</span></a> da versão desejada, 
	      ela é publicada no <a class="link" href="../../../../releases/" target="_top">anúncio da versão</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#eol-id"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Para gerar o número "End of Life" (Fim da Vida) para
	      o <code class="filename">build.conf</code>, consulte a informação
	      sobre o "Estimated EOL" publicada no <a class="link" href="../../../../security/security.html" target="_top">Site de 
	      Segurança do FreeBSD</a>.  O valor do
	      <code class="literal">EOL</code> pode ser derivado a partir da 
	      data listada no site, usando a ferramenta <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=date&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">date</span>(1)</span></a>,
	      por exemplo:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>date -j -f '%Y%m%d-%H%M%S' '20090401-000000' '+%s'</code></strong></pre></td></tr></table></div></li></ol></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="prerequisites.html">Anterior</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="build.html">Próxima</a></td></tr><tr><td width="40%" align="left" valign="top">3. Pré-Requisitos </td><td width="20%" align="center"><a accesskey="h" href="index.html">Principal</a></td><td width="40%" align="right" valign="top"> 5. Preparando a atualização</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Este, e outros documentos, podem ser obtidos em
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Para perguntas sobre FreeBSD, leia a
    <a href="http://www.FreeBSD.org/docs.html">documentação</a> antes de contatar
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Para perguntas sobre esta documentação, envie e-mail para
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>