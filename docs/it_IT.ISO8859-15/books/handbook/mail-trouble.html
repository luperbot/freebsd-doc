<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>26.5. Risoluzione dei Problemi</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuale di FreeBSD" /><link rel="up" href="mail.html" title="Capitolo 26. Posta Elettronica" /><link rel="prev" href="mail-changingmta.html" title="26.4. Sostituzione del proprio Mail Transfer Agent" /><link rel="next" href="mail-advanced.html" title="26.6. Argomenti Avanzati" /><link rel="copyright" href="legalnotice.html" title="Nota Legale" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">26.5. Risoluzione dei Problemi</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mail-changingmta.html">Indietro</a> </td><th width="60%" align="center">Capitolo 26. Posta Elettronica</th><td width="20%" align="right"> <a accesskey="n" href="mail-advanced.html">Avanti</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mail-trouble"></a>26.5. Risoluzione dei Problemi</h2></div></div></div><a id="idp86924368" class="indexterm"></a><div class="qandaset"><a id="idp86925520"></a><dl><dt>26.5.1. <a href="mail-trouble.html#idp86925904">Perché devo usare nomi di dominio completi (FQDN) per gli
            host del mio dominio?</a></dt><dt>26.5.2. <a href="mail-trouble.html#idp86935888">sendmail riporta l'errore
            mail loops back to myself</a></dt><dt>26.5.3. <a href="mail-trouble.html#idp86941648">Come posso eseguire un server di posta su un host connesso in
            dial-up tramite PPP?</a></dt><dt>26.5.4. <a href="mail-trouble.html#idp86974160">Perché continuo a ottenere l'errore Relaying
            Denied quando spedisco posta da altri host?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp86925904"></a><a id="idp86926160"></a><p><strong>26.5.1.</strong></p></td><td align="left" valign="top"><p>Perché devo usare nomi di dominio completi (FQDN) per gli
            host del mio dominio?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Probabilmente ti accorgerai che l'host è effettivamente
            in un dominio differente; per esempio, se sei in <code class="systemitem">foo.bar.edu</code> e desideri raggiungere un host
            chiamato <code class="systemitem">mumble</code> appartenente al dominio <code class="systemitem">bar.edu</code>, dovrai riferirti a questo
            tramite un nome di dominio completo, <code class="systemitem">mumble.bar.edu</code>, invece del solo
            <code class="systemitem">mumble</code>.</p><p>Tradizionalmente, questo era permesso dai resolver
	    BIND<a id="idp86930128" class="indexterm"></a> di
            BSD.  Tuttavia la versione corrente di
            <span class="application">BIND</span> equipaggiata con FreeBSD non
            prevede più l'abbreviazione di default per nomi di dominio
            non completi all'infuori del dominio in cui sei.  Quindi l'host
            <code class="systemitem">mumble</code> sarà giudicato come <code class="systemitem">mumble.foo.bar.edu</code>, oppure sarà
            ricercato per il dominio radice.</p><p>Questo differisce dal comportamento precedente, dove la ricerca
            continuava attraverso <code class="systemitem">mumble.bar.edu</code>, e <code class="systemitem">mumble.edu</code>.  Dai un'occhiata all'RFC
            1535 per i motivi per cui questa sia considerata una cattiva
            pratica, o persino un buco di sicurezza.</p><p>Come buona soluzione al problema, puoi mettere la linea:
            </p><pre class="programlisting">search foo.bar.edu bar.edu</pre><p>
            al posto della precedente:
            </p><pre class="programlisting">domain foo.bar.edu</pre><p>
            nel tuo <code class="filename">/etc/resolv.conf</code>. Comunque, assicurati
            che l'ordine di ricerca non oltrepassi il
            <span class="quote">«<span class="quote">confine tra amministrazione locale e pubblica</span>»</span>, come
            definito nell'RFC 1535.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp86935888"></a><a id="idp86936144"></a><p><strong>26.5.2.</strong></p></td><td align="left" valign="top"><p><span class="application">sendmail</span> riporta l'errore
            <span class="errorname">mail loops back to myself</span></p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>La risposta è contenuta nelle FAQ di
            <span class="application">sendmail</span> come segue:</p><pre class="programlisting">Ottengo messaggi di errore, come questo:

553 MX list for domain.net points back to relay.domain.net
554 &lt;user@domain.net&gt;... Local configuration error

Come posso risolvere questo problema?

Hai chiesto che la posta per il dominio (es., domain.net) sia inoltrata
a un host specifico (in questo caso, relay.domain.net) attraverso l'uso di
un record MX<a id="idp86938704" class="indexterm"></a>,
ma la macchina di inoltro non si riconosce appartenente a
domain.net. Aggiungi domain.net in /etc/mail/local-host-names
[chiamato /etc/sendmail.cw nelle versioni precedenti alla 8.10]
(se stai usando FEATURE(use_cw_file)) oppure aggiungi <span class="quote">«<span class="quote">Cw domain.net</span>»</span>
in /etc/mail/sendmail.cf.</pre><p>Le FAQ di <span class="application">sendmail</span> possono essere
            trovate su <code class="uri"><a class="uri" href="http://www.sendmail.org/faq/" target="_top">http://www.sendmail.org/faq/</a></code> ed
            è raccomandato leggerle se vuoi <span class="quote">«<span class="quote">perfezionare</span>»</span>
            la tua configurazione di posta.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp86941648"></a><a id="idp86941904"></a><p><strong>26.5.3.</strong></p></td><td align="left" valign="top"><p>Come posso eseguire un server di posta su un host connesso in
            dial-up tramite PPP<a id="idp86942544" class="indexterm"></a>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Vuoi collegare ad Internet una macchina FreeBSD posta sulla tua
            LAN.  La macchina FreeBSD sarà un gateway di posta per la
            LAN.  La connessione PPP non è molto indicata per questo
            scopo.</p><p>Esistono almeno due modi per far questo. Un modo è
            usare UUCP<a id="idp86944336" class="indexterm"></a>.</p><p>L'altro è trovare un server Internet a tempo pieno
            che fornisca un servizio MX<a id="idp86945232" class="indexterm"></a> secondario per il tuo dominio.
            Per esempio, se il dominio della tua società è
            <code class="systemitem">example.com</code> e il tuo fornitore
            di servizi Internet ha attivato <code class="systemitem">example.net</code> per fornire il servizio
            MX secondario al tuo dominio, allora:</p><pre class="programlisting">example.com.         MX        10      example.com.
                     MX        20      example.net.</pre><p>Solo un host deve essere specificato come ultimo
            ricevente (aggiungi <code class="literal">Cw example.com</code> in
            <code class="filename">/etc/mail/sendmail.cf</code> su <code class="systemitem">example.com</code>).</p><p>Quando <code class="command">sendmail</code> tenterà di consegnare
            la posta proverà a connettersi alla tua connessione modem
            (<code class="systemitem">example.com</code>).  Molto
            probabilmente finirà in time out poiché non sei
            online.  In modo automatico <code class="command">sendmail</code>
            consegnerà la posta al server MX secondario, ad esempio il
            tuo provider Internet (<code class="systemitem">example.net</code>).  Il server MX secondario
            tenterà periodicamente di collegarsi al tuo host per
            consegnare la posta all'host MX primario (<code class="systemitem">example.com</code>).</p><p>Come script di login potresti usare qualcosa di simile a
            questo:</p><pre class="programlisting">#!/bin/sh
# Mettimi in /usr/local/bin/pppmyisp
( sleep 60 ; /usr/sbin/sendmail -q ) &amp;
/usr/sbin/ppp -direct pppmyisp</pre><p>Se hai intenzione di creare uno script di login separato per
            un utente potresti usare <code class="command">sendmail -qRexample.com</code>
            nello script precedente.  Questo forzerà a processare
            immediatamente tutta la posta per <code class="systemitem">example.com</code> situata nella tua
            coda.</p><p>Segue un'ulteriore sottigliezza della situazione:</p><p>Messaggio rubato dalla <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-isp" target="_top">mailing list degli Internet Service Provider che usano FreeBSD</a>.</p><pre class="programlisting">&gt; forniamo l'MX secondario per un cliente. Il cliente si connette
&gt; automaticamente ai nostri servizi molte volte al giorno per ottenere la
&gt; posta per il suo MX primario (non chiamiamo il suo server quando arriva
&gt; posta per il suo dominio). Il nostro sendmail processa la posta in coda
&gt; ogni 30 minuti. Attualmente il cliente sta 30 minuti online per assicurarsi
&gt; che tutta la posta vada all'MX primario.
&gt;
&gt; Esiste un comando che permetta di configurare sendmail in modo tale da
&gt; spedire tutta la posta in quel momento? Naturalmente l'utente non ha
&gt; privilegi di root sulla nostra macchina.

Nella sezione <span class="quote">«<span class="quote">privacy flags</span>»</span> di sendmail.cf, c'è una
definizione Opgoaway,restrictqrun

Rimuovi restrictqrun per permettere a utenti non root di avviare l'elaborazione
della coda. Inoltre potresti risistemare gli MX. Noi siamo l'MX primario per i
nostri clienti come questo, e abbiamo definito:

# Se siamo il miglior MX per un host, prova direttamente invece di generare
# errori di configurazione locale.
OwTrue

In questo modo un server remoto consegnerà direttamente a te, senza
tentare di connettersi al cliente. Dopodiché tu spedisci al tuo cliente.
Funziona solamente con gli <span class="quote">«<span class="quote">host</span>»</span>, quindi hai bisogno che il tuo
cliente chiami la sua macchina di posta <span class="quote">«<span class="quote">customer.com</span>»</span> così come
<span class="quote">«<span class="quote">nomehost.customer.com</span>»</span> nel DNS.
Basta mettere un record A nel DNS per <span class="quote">«<span class="quote">customer.com</span>»</span>.</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp86974160"></a><a id="idp86974416"></a><p><strong>26.5.4.</strong></p></td><td align="left" valign="top"><p>Perché continuo a ottenere l'errore <span class="errorname">Relaying
            Denied</span> quando spedisco posta da altri host?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Con l'installazione di default di FreeBSD,
            <span class="application">sendmail</span> viene configurato in modo tale
            da permettere di spedire posta solamente dall'host sul quale
            è in esecuzione.  Per esempio, se c'è installato un
            server <acronym class="acronym">POP</acronym>, allora gli utenti saranno in grado di
            controllare la posta da scuola, dal lavoro, o da altre postazioni
            remote ma tuttavia non potranno inviare messaggi di posta
            all'esterno da postazioni esterne.  Tipicamente, pochi istanti dopo
            il tentativo, verrà spedita una email da
            <span class="application">MAILER-DAEMON</span> con il messaggio di errore
            <span class="errorname">5.7 Relaying Denied</span>.</p><p>Esistono diversi modi per aggirare questo problema.  La
            soluzione più semplice è mettere il proprio
            indirizzo assegnato dall'ISP nel file che contiene i domini
            a cui viene permesso di effettuare il relay,
            <code class="filename">/etc/mail/relay-domains</code>.  Un modo veloce
            per far questo può essere:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>echo "your.isp.example.com" &gt; /etc/mail/relay-domains</code></strong></pre><p>Dopo aver creato o modificato questo file devi riavviare
            <span class="application">sendmail</span>.  Questa soluzione è
            ideale se sei un amministratore del server e non desideri
            spedire posta localmente, o se vorresti usare un client/sistema
            punta e clicca su un'altra macchina o perfino su un altro ISP.
            Inoltre è molto utile se hai solo uno o due account
            di posta configurati.  Se ci sono molti indirizzi da aggiungere,
            puoi semplicemente aprire questo file con il tuo editor di testo
            preferito e aggiungere i domini, uno per riga:</p><pre class="programlisting">your.isp.example.com
other.isp.example.net
users-isp.example.org
www.example.org</pre><p>Ora l'invio della posta tramite il tuo sistema, da parte di
            qualche host in lista (a condizione che l'utente abbia un account
            sul tuo sistema), avrà successo.  Questo è un buon
            metodo per permettere agli utenti di spedire posta dal tuo sistema
            in modo remoto senza dare la possibilità a qualcuno di
            spedire SPAM tramite il tuo sistema.</p></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail-changingmta.html">Indietro</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">Risali</a></td><td width="40%" align="right"> <a accesskey="n" href="mail-advanced.html">Avanti</a></td></tr><tr><td width="40%" align="left" valign="top">26.4. Sostituzione del proprio Mail Transfer Agent </td><td width="20%" align="center"><a accesskey="h" href="index.html">Partenza</a></td><td width="40%" align="right" valign="top"> 26.6. Argomenti Avanzati</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Questo, ed altri documenti, possono essere scaricati da
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Per domande su FreeBSD, leggi la
    <a href="http://www.FreeBSD.org/docs.html">documentazione</a> prima di contattare
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Per domande su questa documentazione, invia una e-mail a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>