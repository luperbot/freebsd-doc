<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>17.4. Configurazione dell'Audit</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuale di FreeBSD" /><link rel="up" href="audit.html" title="Capitolo 17. Auditing degli Eventi di Sicurezza" /><link rel="prev" href="audit-install.html" title="17.3. Installare il Supporto Audit" /><link rel="next" href="audit-administration.html" title="17.5. Amministrare il Sottosistema Audit" /><link rel="copyright" href="legalnotice.html" title="Nota Legale" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">17.4. Configurazione dell'Audit</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="audit-install.html">Indietro</a> </td><th width="60%" align="center">Capitolo 17. Auditing degli Eventi di Sicurezza</th><td width="20%" align="right"> <a accesskey="n" href="audit-administration.html">Avanti</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="audit-config"></a>17.4. Configurazione dell'Audit</h2></div></div></div><p>Tutti i file di configurazione per l'audit di sicurezza
      si trovano in <code class="filename">/etc/security</code>.
      I seguenti file devono essere presenti prima dell'avvio
      del demone audit:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">audit_class</code> - Contiene le definizioni
          delle classi di audit.</p></li><li class="listitem"><p><code class="filename">audit_control</code> - Controlla aspetti
          del sottosistema dell'audit, come le classi audit di default,
          il minimo spazio su disco da lasciare al log di audit,
          la massima dimensione della traccia di audit, etc.</p></li><li class="listitem"><p><code class="filename">audit_event</code> - Nomi testuali e descrizioni
          degli eventi di audit di sistema, cosí come una lista
          di quali classi contengano quali eventi.</p></li><li class="listitem"><p><code class="filename">audit_user</code> - Requisiti specifici dell'audit
          per l'utente, combinati con i default globali
          al login.</p></li><li class="listitem"><p><code class="filename">audit_warn</code> - Uno script customizzabile
          usato da <span class="application">auditd</span> per generare messaggi di
          warning in situazioni eccezionali,
          come ad esempio quando sta finendo lo spazio per i record
          o quando le tracce dell'audit sono ruotate.</p></li></ul></div><div xmlns="" class="warning"><h3 class="admontitle">Avvertimento: </h3><p xmlns="http://www.w3.org/1999/xhtml">I file di configurazione dell'audit dovrebbero essere editati
        e manotenuti con attenzione, dato che errori nella
        configurazione possono risultare in un tracciamento improprio
        degli eventi.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84422864"></a>17.4.1. Espressioni per la Selezione degli Eventi</h3></div></div></div><p>Le espressioni per la selezione sono usate in un certo
        numero di posti nella configurazione dell'audit per determinare
        quali eventi dovrebbero essere sotto audit.
        Le espressioni contengono una serie di classi di eventi,
        ognuna con un prefisso che indica se i record che sono indicati
        debbano essere accettati o ignorati, ed opzionalmente ad indicare
        se i record che vengono individuati siano da tracciare ad
        un successo o ad un fallimento.  Le espressioni di selezione
        sono valutate da sinistra a destra, e due espressioni sono
        combinate aggiungendo una all'altra.</p><p>La seguente lista contiene le classi di eventi di default
        presenti in <code class="filename">audit_class</code>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">all</code> - <span class="emphasis"><em>all</em></span> - Indica
            tutte le classi di eventi.</p></li><li class="listitem"><p><code class="literal">ad</code> - <span class="emphasis"><em>administrative</em></span>
            - Le azioni amministrative eseguite su un sistema
            nel suo complesso.</p></li><li class="listitem"><p><code class="literal">ap</code> - <span class="emphasis"><em>application</em></span> -
            Azioni definite dall'applicazione.</p></li><li class="listitem"><p><code class="literal">cl</code> - <span class="emphasis"><em>file close</em></span> -
            Chiamate audit alla system call <code class="function">close</code>.</p></li><li class="listitem"><p><code class="literal">ex</code> - <span class="emphasis"><em>exec</em></span> - Fa l'audit
            delle esecuzioni di un programma.  L'audit degli argomenti
            della command line e delle variabili di ambiente è
            controllato da <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=audit_control&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">audit_control</span>(5)</span></a> usando i parametri
            <code class="literal">argv</code> e <code class="literal">envv</code> nelle
            impostazioni della <code class="literal">policy</code>.</p></li><li class="listitem"><p><code class="literal">fa</code> - <span class="emphasis"><em>file attribute access</em></span>
            - Fa l'audit dell'accesso ad attributi di accesso
            come <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stat&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stat</span>(1)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pathconf&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">pathconf</span>(2)</span></a> ed eventi simili.</p></li><li class="listitem"><p><code class="literal">fc</code> - <span class="emphasis"><em>file create</em></span>
            - Fa l'audit di eventi che hanno come risultato
            la creazione di un file.</p></li><li class="listitem"><p><code class="literal">fd</code> - <span class="emphasis"><em>file delete</em></span>
            - Fa l'audit di eventi in cui avvenga una cancellazione
            di file.</p></li><li class="listitem"><p><code class="literal">fm</code> - <span class="emphasis"><em>file attribute modify</em></span>
            - Fa l'audit di eventi in cui avvenga una modifica
            degli attributi dei file, come <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chown&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">chown</span>(8)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chflags&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">chflags</span>(1)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=flock&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">flock</span>(2)</span></a>,
            etc.</p></li><li class="listitem"><p><code class="literal">fr</code> - <span class="emphasis"><em>file read</em></span>
            - Fa l'audit di eventi nei quali dei dati siano letti,
            file siano aperti in lettura, etc.</p></li><li class="listitem"><p><code class="literal">fw</code> - <span class="emphasis"><em>file write</em></span> -
            Fa l'audit di eventi in cui dati siano scritti,
            file siano scritti o modificati, etc.</p></li><li class="listitem"><p><code class="literal">io</code> - <span class="emphasis"><em>ioctl</em></span> -
            Fa l'audit dell'uso della system call <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ioctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a>.</p></li><li class="listitem"><p><code class="literal">ip</code> - <span class="emphasis"><em>ipc</em></span> - Fa l'audit
            di varie forme di Inter-Process Communication, incluse pipe
            POSIX e operazioni  <acronym class="acronym">IPC</acronym> System V.</p></li><li class="listitem"><p><code class="literal">lo</code> - <span class="emphasis"><em>login_logout</em></span> -
            Fa l'audit di eventi di <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=login&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">login</span>(1)</span></a> e <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=logout&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">logout</span>(1)</span></a> che occorrano
            nel sistema.</p></li><li class="listitem"><p><code class="literal">na</code> - <span class="emphasis"><em>non attributable</em></span> -
            Fa l'audit di eventi non attribuibili.</p></li><li class="listitem"><p><code class="literal">no</code> - <span class="emphasis"><em>invalid class</em></span> -
            Indica nessun evento di audit.</p></li><li class="listitem"><p><code class="literal">nt</code> - <span class="emphasis"><em>network</em></span> -
            Fa l'audit di eventi relativi ad azioni di rete, come
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=connect&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">connect</span>(2)</span></a> e <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=accept&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>.</p></li><li class="listitem"><p><code class="literal">ot</code> - <span class="emphasis"><em>other</em></span> -
            Fa l'audit di eventi miscellanei.</p></li><li class="listitem"><p><code class="literal">pc</code> - <span class="emphasis"><em>process</em></span> -
            Fa l'audit di operazioni dei processi, come
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exec&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">exec</span>(3)</span></a> e <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exit&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">exit</span>(3)</span></a>.</p></li></ul></div><p>Queste classi di eventi audit possono essere personalizzate
        modificando i file di configurazione
        <code class="filename">audit_class</code> e
        <code class="filename">audit_event</code>.</p><p>Ogni classe di audit nella lista è combinata
        con un prefisso che indica se le operazione di successo
        o andate in fallimento siano intercettate, e se la entry
        sta aggiungendo o togliendo delle regole di intercettazione
        per la classe ed il tipo.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>(none) Fa l'audit di istanze dell'evento sia di successo
            che fallite.</p></li><li class="listitem"><p><code class="literal">+</code> Fa l'audit di eventi di successo
            in questa classe.</p></li><li class="listitem"><p><code class="literal">-</code> fa l'audit di eventi falliti
            in questa classe.</p></li><li class="listitem"><p><code class="literal">^</code> Non fa l'audit di eventi nè
            di successo nè falliti in questa classe.</p></li><li class="listitem"><p><code class="literal">^+</code> Non fa l'audit di eventi di successo
            in questa classe.</p></li><li class="listitem"><p><code class="literal">^-</code> Non fa l'audit di eventi falliti in
            questa classe.</p></li></ul></div><p>Il seguente esempio di selezione indica eventi di login/logout
        sia di successo che non, ma solo eventi di successo di esecuzione:</p><pre class="programlisting">lo,+ex</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84486096"></a>17.4.2. File di Configurazione</h3></div></div></div><p>Nella maggior parte dei casi, gli amministratori dovranno
        solo modificare due file quando configurano il sistema audit:
        <code class="filename">audit_control</code> ed <code class="filename">audit_user</code>.
        Il primo controlla le proprietà e le politiche di tutto
        il sistema, il secondo può essere usato per fare del
        fine tuning iper il singolo utente.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="audit-auditcontrol"></a>17.4.2.1. Il File <code class="filename">audit_control</code></h4></div></div></div><p>Il file <code class="filename">audit_control</code> specifica un certo numero
          di valori di default per il sottosistema audit.  Leggendo i contenuti
          di questo file, notiamo le seguenti righe:</p><pre class="programlisting">dir:/var/audit
flags:lo
minfree:20
naflags:lo
policy:cnt
filesz:0</pre><p>L'opzione <code class="option">dir</code> viene usata per impostare
         una o più directory dove i file di log dell'audit vengono
         salvati.  Se appare più di una directory, saranno
         usati in ordine uno dopo l'altro, dopo che uno si riempie.
         È comune configurare
         audit cosicchè i log siano tenuti in un filesystem
         dedicato, per prevenire interferenze fra il sottosistema
         audit ed altri sottosistemi se il filesystem si riempie.</p><p>Il campo <code class="option">flags</code> imposta la maschera di preselzione
          per gli eventi attribuibili per tutto il sistema.  Nell'esempio
          sopra, i login ed i logout di successo e quelli falliti
          sono tenuti sotto audit per tutto il sistema.</p><p>L'opzione <code class="option">minfree</code> definisce la minima percentuale
          di spazio libero per i file system dove vengono conservate
          le tracce dell'audit.  Quando questo limite viene superato,
          sarà generato un warning.  L'esempio sopra imposta
          il minimo spazio libero al venti per cento.</p><p>L'opzione <code class="option">naflags</code> specifica le classi di audit
          da tenere sotto audit per gli eventi non attribuibili, come
          il processo di login ed i demoni di sistema.</p><p>L'opzione <code class="option">policy</code> specifica una lista separata
          da virgole di flag per le politiche che controllano vari aspetti
          del comportamento dell'audit.  Il flag di default <code class="literal">cnt</code>
          indica che il sistema dovrebbe continuare a funzionare nonostante
          un errore dell'audit (questa flag è altamente consigliato).
          Un altro flag usato di comune è <code class="literal">argv</code>,
          che fa sì che gli argomenti di command line della sistema call <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=execve&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">execve</span>(2)</span></a>
          siano tenuti sotto audit come parte dell'esecuzione del comando.</p><p>L'opzione <code class="option">filesz</code> specifica la massima dimensione
          in bytes da tenere per le tracce di audit, prima di terminarli
          automaticamente e routarli.  Il default, 0, disabilita la rotazione
          dei file di log.  Se la dimensione è diversa di zero
          ma minore del minimo, 512k, sarà ignorata ed un messaggio di log
          sarà generato.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="audit-audituser"></a>17.4.2.2. Il File <code class="filename">audit_user</code></h4></div></div></div><p>Il file <code class="filename">audit_user</code> permette all'amministratore
          di specificare ulteriori requisiti dell'audit per utenti
          specifici.  Ogni linea configura l'audit per un utente
          attraverso due campi: il primo campo è <code class="literal">alwaysaudit</code>,
          che specifica un insieme di eventi che dovrebbero sempre essere tenuti
          sotto audit per l'utente, ed il secondo è il campo
          <code class="literal">neveraudit</code>, che specifica un insieme di eventi
          che non dovrebbero mai essere tenuti sotto audit per l'utente.
        </p><p>Il seguente esempio di file <code class="filename">audit_user</code> fa
          l'audit di eventi di login/logout e delle esecuzioni di successo
          per l'utente <code class="systemitem">root</code>, e fa l'audit della creazione
          e dell'esecuzione di successo per l'utente <code class="systemitem">www</code>.
          Se usato con il file di esempio <code class="filename">audit_control</code>
          sopra riportato, l'entry <code class="literal">lo</code> per
          <code class="systemitem">root</code> è ridondante, e gli eventi di
          login/logout sarano tenuti sotto audit anche per l'utente
          <code class="systemitem">www</code>.</p><pre class="programlisting">root:lo,+ex:no
www:fc,+ex:no</pre></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="audit-install.html">Indietro</a> </td><td width="20%" align="center"><a accesskey="u" href="audit.html">Risali</a></td><td width="40%" align="right"> <a accesskey="n" href="audit-administration.html">Avanti</a></td></tr><tr><td width="40%" align="left" valign="top">17.3. Installare il Supporto Audit </td><td width="20%" align="center"><a accesskey="h" href="index.html">Partenza</a></td><td width="40%" align="right" valign="top"> 17.5. Amministrare il Sottosistema Audit</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Questo, ed altri documenti, possono essere scaricati da
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Per domande su FreeBSD, leggi la
    <a href="http://www.FreeBSD.org/docs.html">documentazione</a> prima di contattare
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Per domande su questa documentazione, invia una e-mail a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>