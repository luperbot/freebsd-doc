<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>27.10. Sincronizzazione del Clock con NTP</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuale di FreeBSD" /><link rel="up" href="network-servers.html" title="Capitolo 27. Server di rete" /><link rel="prev" href="network-samba.html" title="27.9. Servizi di File e Stampa per client Microsoft® Windows® (Samba)" /><link rel="next" href="firewalls.html" title="Capitolo 28. Firewall" /><link rel="copyright" href="legalnotice.html" title="Nota Legale" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">27.10. Sincronizzazione del Clock con NTP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-samba.html">Indietro</a> </td><th width="60%" align="center">Capitolo 27. Server di rete</th><td width="20%" align="right"> <a accesskey="n" href="firewalls.html">Avanti</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-ntp"></a>27.10. Sincronizzazione del Clock con NTP</h2></div><div><span class="authorgroup">Grazie al contributo di <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Hukins</span></span>. </span></div></div></div><a id="idp89169872" class="indexterm"></a><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89170384"></a>27.10.1. Uno sguardo d'insieme</h3></div></div></div><p>Al passare del tempo, il clock di un computer tende
        a perdere la sincronizzazione.  Il Network Time Protocol
        (NTP) fornisce un modo per assicurarti che il tuo
        clock sia accurato.</p><p>Molti servizi Internet si basano sul fatto che
        il clock del computer sia accurato, o comunque
        traggono notevole beneficio
        da questo fatto.  Per esempio, un web server
        può ricevere richieste di inviare un file se
        questo è stato modificato da una certa
        data.  In un ambiente locale di rete, è
        essenziale che i computer che condividono
        i file dallo stesso file server abbiano clock
        sincronizzati cosicchè i timestamp dei file
        siano consistenti.  Anche servizi come <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a>
        si basano su un clock di sistema accurato per eseguire
        comandi al momento specificato.</p><a id="idp89172560" class="indexterm"></a><p>FreeBSD è dotato del server <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a>
        <acronym class="acronym">NTP</acronym>
        che può essere usato per interrogare altri
        server <acronym class="acronym">NTP</acronym>
        per impostare il clock sulla tua macchina o fornire
        servizi di time ad altri.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89176144"></a>27.10.2. Scegliere Server NTP Appropriati</h3></div></div></div><a id="idp89176784" class="indexterm"></a><p>Per sincronizzare il tuo
        clock, avrai bisogno di scegliere uno o più
        server <acronym class="acronym">NTP</acronym>
        da usare.  Il tuo amministratore di rete o ISP
        potrebbe aver impostato un server NTP, a questo scopo
        - controlla la loro documentazione per vedere se
        questo è il caso.  C'è una
        <a class="link" href="http://ntp.isc.org/bin/view/Servers/WebHome" target="_top">
        lista online di server NTP pubblicamente accessibili
        </a> che tu puoi usare per trovare un server NTP
        vicino a te.  Accertati di essere al corrente della
        politica di ogni server che scegli, e chiedi il
        permesso se necessario.</p><p>Scegliere molti server NTP non connessi
        fra loro è una buona idea in caso uno
        dei server che stai usando diventa irraggiungibile
        o il suo clock è inaffidabile.
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> usa le risposte che riceve
        da altri server in modo intelligente;
        favorirà server inaffidabili meno di quelli
        affidabili.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89180624"></a>27.10.3. Configurare la tua Macchina</h3></div></div></div><a id="idp89181264" class="indexterm"></a><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89182416"></a>27.10.3.1. Configurazione Base</h4></div></div></div><a id="idp89187280" class="indexterm"></a><p>Se desideri solo sincronizzare il tuo clock
          al momento del boot della macchina, puoi usare
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a>.  Questo può essere
          appropriato per alcune macchine desktop che sono
          rebootate di frequente e richiedono
          sincronizzazione non frequente, ma le altre macchine
          dovrebbero eseguire <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a>.</p><p>Usare <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a> al momento del boot
          è una buona idea per le macchine che eseguono
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a>.  Il programma <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> cambia il
          clock gradualmente, mentre <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a> imposta
          il clock, indipentemente da quanto grande sia la
          differenza fra l'impostazione di clock corrente di una
          macchina e l'ora corretta.</p><p>Per abilitare <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a> al momento del boot,
          aggiungi <code class="literal">ntpdate_enable="YES"</code>
          a <code class="filename">/etc/rc.conf</code>.  Avrai anche
          bisogno di specificare tutti i server
          con i quali ti desideri
          sincronizzare ed ogni flags passato a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a>
          in <code class="varname">ntpdate_flags</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89208784"></a>27.10.3.2. Configurazione Generale</h4></div></div></div><a id="idp89209424" class="indexterm"></a><p>NTP è configurato dal file
          <code class="filename">/etc/ntp.conf</code> nel formato
          descritto da <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ntp.conf</span>(5)</span></a>.  Questo è
          un semplice esempio:</p><pre class="programlisting">server ntplocal.example.com prefer
server timeserver.example.org
server ntp2a.example.net

driftfile /var/db/ntp.drift</pre><p>L'opzione <code class="literal">server</code> specifica
          quali server siano da usare, con un server elencato
          su ogni linea.  Se un server è specificato con
          l'argomento <code class="literal">prefer</code>, come con
          <code class="systemitem">ntplocal.example.com</code>,
          quel server saraà preferito rispetto ad
          altri.  Una risposta da un server preferito
          sarà scartata se differisce
          in modo significativo dalle risposte di altri server,
          altrimenti sarà usata senza nessuna
          considerazione delle altre risposte.  L'argomento
          <code class="literal">prefer</code> è normalmente usato
          per server NTP che sono noti per
          essere molto accurati, come quelli con hardware a
          monitoraggio speciale del tempo.</p><p>L'opzione <code class="literal">driftfile</code> specifica
          quale file sia usato per conservare la frequenza di
          scostamento dal clock di sistema.  Il programma
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> usa questo dato per compensare
          automaticamente le imprecisioni naturali del clock,
          permettendo di mantenere una impostazione ragionevolmente
          corretta anche se gli è impedito di accedere
          a tutte le sorgenti di sincronizzazione tempo esterne
          per un certo periodo di tempo.</p><p>L'opzione <code class="literal">driftfile</code> specifica
          quale file sia usato per conservare informazioni sulle
          risposte precedenti dai server NTP che usi.  Questo file
          contiene informazioni interne per NTP.  Non dovrebbe
          essere modificato da altri processi.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89221328"></a>27.10.3.3. Controllare l'Accesso ad i tuoi Server</h4></div></div></div><p>Di default, il tuo server NTP sarà accessibile
          a tutti gli host su Internet.  L'opzione
          <code class="literal">restrict</code> in
          <code class="filename">/etc/ntp.conf</code> ti permette
          di controllare quali macchine possano accedere al tuo
          server.</p><p>Se vuoi negare a tutte le macchine accesso
          al tuo server NTP, aggiungi la seguente linea a
          <code class="filename">/etc/ntp.conf</code>:</p><pre class="programlisting">restrict default ignore</pre><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Inoltre questo settaggio vieta l'accesso
            al tuo server dai server elencati nella tua configurazione
            locale.  Se hai bisogno di sincronizzare il tuo
            server NTP con un server NTP esterno devi permettere
            il server che vuoi usare.  Guada la pagina man
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ntp.conf</span>(5)</span></a> per ulteriori dettagli.</p></div><p>Se vuoi permettere solo alle macchine della tua rete
          di sincronizzare il loro clock con il tuo server,
          ma assicurarti che non gli sia permesso configurare
          il server o che non sianousate
          come punto di riferimento per
          sincronizzarsi, aggiungi</p><pre class="programlisting">restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap</pre><p>invece, dove<code class="systemitem">192.168.1.0</code>
          è un indirizzo IP sulla tua rete e
          <code class="systemitem">255.255.255.0</code>
          è la netmask della tua rete.</p><p><code class="filename">/etc/ntp.conf</code> può
          contenere molte opzioni <code class="literal">restrict</code>.
          Per maggiori dettagli, consulta la sezione
          <code class="literal">Access Control Support</code> di
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ntp.conf</span>(5)</span></a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89234768"></a>27.10.4. Eseguire il Server NTP</h3></div></div></div><p>Per assicurarsi che il server NTP sia avviato
        al momento del boot, aggiungi la linea
        <code class="literal">ntpd_enable="YES"</code> a
        <code class="filename">/etc/rc.conf</code>.  Se desideri
        passare flag addizionali a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a>, edita
        il parametro <code class="varname">ntpd_flags</code>
        in <code class="filename">/etc/rc.conf</code>.</p><p>Per avviare il server senza riavviare la tua
        macchina, esegui <code class="command">ntpd</code> accertandoti
        di specificare ogni parametro addizionale in
        <code class="varname">ntpd_flags</code> presente in
        <code class="filename">/etc/rc.conf</code>.  Per esempio:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ntpd -p /var/run/ntpd.pid</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89240784"></a>27.10.5. Usare ntpd con una Connessione Temporanea
        ad Internet</h3></div></div></div><p>Il programma <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> non necessita di una
        connessione permanente ad Internet per funzionnare
        correttamente.  Comunque, se hai una connessione
        temporanea che è configurata per effettuare
        una chiamata su richiesta, è una buona idea
        evitare che il traffico NTP causi la chiamata
        o mantenga la connessione attiva.  Se stai usando
        PPP utente, puoi usare le direttive
        <code class="literal">filter</code> in
        <code class="filename">/etc/ppp/ppp.conf</code>.
        Per esempio:</p><pre class="programlisting"> set filter dial 0 deny udp src eq 123
# Prevent NTP traffic from initiating dial out
set filter dial 1 permit 0 0
set filter alive 0 deny udp src eq 123
# Prevent incoming NTP traffic from keeping the connection open
set filter alive 1 deny udp dst eq 123
# Prevent outgoing NTP traffic from keeping the connection open
set filter alive 2 permit 0/0 0/0</pre><p>Pre maggiori dettagli consulta la sezione
        <code class="literal">PACKET FILTERING</code> in <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppp&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ppp</span>(8)</span></a>
        e gli esempi in
        <code class="filename">/usr/share/examples/ppp/</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Alcuni provider di accesso ad Internet bloccano
          le porte dal numero basso, impedendo ad NTP di
          funzionare dato che le repliche non raggiungono mai
          la tua macchina.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp89246544"></a>27.10.6. Informazioni Ulteriori</h3></div></div></div><p>La documentazione per il server NTP
        può essere trovata in formato HTML in
        <code class="filename">/usr/share/doc/ntp/</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-samba.html">Indietro</a> </td><td width="20%" align="center"><a accesskey="u" href="network-servers.html">Risali</a></td><td width="40%" align="right"> <a accesskey="n" href="firewalls.html">Avanti</a></td></tr><tr><td width="40%" align="left" valign="top">27.9. Servizi di File e Stampa per client
      <span class="trademark">Microsoft</span>® <span class="trademark">Windows</span>® (Samba) </td><td width="20%" align="center"><a accesskey="h" href="index.html">Partenza</a></td><td width="40%" align="right" valign="top"> Capitolo 28. Firewall</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Questo, ed altri documenti, possono essere scaricati da
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Per domande su FreeBSD, leggi la
    <a href="http://www.FreeBSD.org/docs.html">documentazione</a> prima di contattare
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Per domande su questa documentazione, invia una e-mail a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>