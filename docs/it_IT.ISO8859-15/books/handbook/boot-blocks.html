<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>12.3. Il Boot Manager e le Fasi di Boot</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuale di FreeBSD" /><link rel="up" href="boot.html" title="Capitolo 12. La Procedura di Avvio di FreeBSD" /><link rel="prev" href="boot-introduction.html" title="12.2. Il Problema dell'Avvio" /><link rel="next" href="boot-kernel.html" title="12.4. Interazione con il Kernel Durante l'Avvio" /><link rel="copyright" href="legalnotice.html" title="Nota Legale" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">12.3. Il Boot Manager e le Fasi di Boot</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="boot-introduction.html">Indietro</a> </td><th width="60%" align="center">Capitolo 12. La Procedura di Avvio di FreeBSD</th><td width="20%" align="right"> <a accesskey="n" href="boot-kernel.html">Avanti</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="boot-blocks"></a>12.3. Il Boot Manager e le Fasi di Boot</h2></div></div></div><a id="idp83504080" class="indexterm"></a><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-boot0"></a>12.3.1. Il Boot Manager</h3></div></div></div><a id="idp83505360" class="indexterm"></a><p>Il codice nel MBR o nel boot manager è solitamente
        riferito alla <span class="emphasis"><em>fase zero</em></span> del processo di boot.
        Questa sezione discute dei due boot manager menzionati in
        precedenza: <span class="application">boot0</span> e
        <span class="application">LILO</span>.</p><p><span class="formalpara-title">Il Boot Manager <span class="application">boot0</span>: </span>Il MBR installato dall'installer di FreeBSD o da <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=boot0cfg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">boot0cfg</span>(8)</span></a>,
          di default, si basa su <code class="filename">/boot/boot0</code>.
          (Il programma <span class="application">boot0</span> è molto
          semplice, poichè il programma nel <abbr class="abbrev">MBR</abbr>
          può essere al più di 446 byte a causa della tabella
          della slice e dell'identificatore <code class="literal">0x55AA</code>
          alla fine del MBR.)
          Se hai installato <span class="application">boot0</span> e hai più di
          un sistema operativo sui tuoi dischi, allora vedrai
          una schermata simile alla seguente nella fase di avvio:</p><div class="example"><a id="boot-boot0-example"></a><div class="example-title">Esempio 12.1. Screenshot di <code class="filename">boot0</code></div><div class="example-contents"><pre class="screen">F1 DOS
F2 FreeBSD
F3 Linux
F4 ??
F5 Drive 1

Default: F2</pre></div></div><br class="example-break" /><p>Altri sistemi operativi, in particolare <span class="trademark">Windows</span>®, sono noti
        per l'abitudine di sovrascrivere l'MBR esistente con il proprio.
        Se accade questo, o se vuoi rimpiazzare l'MBR pre-esistente con quello
        di FreeBSD puoi usare il seguente comando:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>fdisk -B -b /boot/boot0 dispositivo</code></strong></pre><p>dove <em class="replaceable"><code>dispositivo</code></em> è il dispositivo
        dal quale vuoi avviare, come <code class="filename">ad0</code> per il primo
        disco IDE, <code class="filename">ad2</code> per il primo disco ide sul
        secondo canale, <code class="filename">da0</code> per il primo disco SCSI,
        e così via.  Se vuoi una configurazione ad hoc dell'MBR,
        usa <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=boot0cfg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">boot0cfg</span>(8)</span></a>.</p><p><span class="formalpara-title">Il Boot Manager LILO: </span>Per installare questo boot manager affinchè possa avviare
          anche FreeBSD, avvia Linux e aggiungi le seguenti cose nel
          tuo file di configurazione
          <code class="filename">/etc/lilo.conf</code>:</p><pre class="programlisting">other=/dev/hdXY
table=/dev/hdX
loader=/boot/chain.b
label=FreeBSD</pre><p>Specifica la partizione primaria di FreeBSD e il disco usando le
        direttive di Linux, rimpiazzando <em class="replaceable"><code>X</code></em> con
        la lettera del dispositivo di Linux e <em class="replaceable"><code>Y</code></em> con
        il numero della partizione primaria di Linux.  Se stai usando un
        dispositivo <acronym class="acronym">SCSI</acronym>, devi modificare
        <em class="replaceable"><code>/dev/hd</code></em> in qualcosa simile a
        <em class="replaceable"><code>/dev/sd</code></em>.  La linea
        <code class="option">loader=/boot/chain.b</code> può essere omessa
        se hai entrambi i sistemi operativi sullo stesso disco.  Esegui
        <code class="command">/sbin/lilo -v</code> per apportare le modifiche al
        sistema; verificando il relativo messaggio a video.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-boot1"></a>12.3.2. Stadio Uno, <code class="filename">/boot/boot1</code>, e Stadio Due,
        <code class="filename">/boot/boot2</code></h3></div></div></div><p>Concettualmente il primo ed il secondo stadio sono parte dello
        stesso programma, sulla stessa area del disco.  Per limitazioni di
        spazio sono stati divisi in due, ma li installerai sempre
        insieme.  Sono copiati dal file
        <code class="filename">/boot/boot</code> dall'installer o da
        <span class="application">bsdlabel</span> (vedi sotto).</p><p>Questi sono posizionati fuori dai file system, nella prima
        traccia della slice di boot, a partire dal primo settore.
        Questo è il posto dove <a class="link" href="boot-blocks.html#boot-boot0" title="12.3.1. Il Boot Manager">boot0</a>, o qualsiasi altro boot manager,
        si aspetta di trovare un programma da avviare per continuare il
        processo di boot.  Il numero di settori usati è facilmente
        determinabile dalla dimensione di
        <code class="filename">/boot/boot</code>.</p><p><code class="filename">boot1</code> è molto semplice, poiché
        può essere lungo solo 512 byte, e conosce solo lo stretto
        necessario del <em class="firstterm">bsdlabel</em> di FreeBSD, il quale
        memorizza le informazioni sulle slice, per trovare ed eseguire
        <code class="filename">boot2</code>.</p><p><code class="filename">boot2</code> è leggermente più
        sofisticato, e conosce il file system di FreeBSD abbastanza da potervi
        trovare dei file, e può fornire una semplice interfaccia per
        scegliere quale kernel o loader eseguire.</p><p>Poiché il <a class="link" href="boot-blocks.html#boot-loader" title="12.3.3. Stadio Tre, /boot/loader">loader</a> è
        molto più complesso, e fornisce una gradevole interfaccia di
        facile utilizzo alla configurazione di avvio, <code class="filename">boot2</code>
        in genere lo esegue, ma in precedenza era incaricato di lanciare il
        kernel direttamente.</p><div class="example"><a id="boot-boot2-example"></a><div class="example-title">Esempio 12.2. Screenshot di <code class="filename">boot2</code></div><div class="example-contents"><pre class="screen">&gt;&gt; FreeBSD/i386 BOOT
Default: 0:ad(0,a)/boot/loader
boot:</pre></div></div><br class="example-break" /><p>Se mai avrai bisogno di rimpiazzare il <code class="filename">boot1</code> ed
        il <code class="filename">boot2</code> installati, usa <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">bsdlabel</span>(8)</span></a>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>bsdlabel -B discoslice</code></strong></pre><p>dove <em class="replaceable"><code>discoslice</code></em> sono il disco e la slice
        dal quale vuoi effettuare l'avvio, come ad esempio
        <code class="filename">ad0s1</code> per la prima slice sul primo disco
        IDE.</p><div xmlns="" class="warning"><h3 class="admontitle">Modalità Pericolosamente Dedicata: </h3><p xmlns="http://www.w3.org/1999/xhtml">Se nella sintassi del comando <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">bsdlabel</span>(8)</span></a> usi solo il
          nome del disco, come <code class="filename">ad0</code>, creerai un disco
          pericolosamente dedicato, senza slice.  Quasi sicuramente non è
          questo quello che vuoi fare, quindi controlla due volte il comando
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">bsdlabel</span>(8)</span></a> prima di premere <span class="keycap"><strong>Invio</strong></span>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-loader"></a>12.3.3. Stadio Tre, <code class="filename">/boot/loader</code></h3></div></div></div><a id="idp83549008" class="indexterm"></a><p>Il loader è l'ultimo stadio della procedura di avvio divisa
        in tre, e si trova sul file system, generalmente come
        <code class="filename">/boot/loader</code>.</p><p>Il loader deve essere inteso come un metodo user-friendly per la
        configurazione di avvio, tramite l'uso di un insieme di comandi
        integrati facili da usare, sostenuto da un potente interprete, con un
        insieme di comandi più complessi.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-loader-flow"></a>12.3.3.1. Sequenza di Operazioni del Loader</h4></div></div></div><p>Durante l'inizializzazione, il loader controllerà
          la console e i dischi, e cercherà di capire da quale disco si
          stia avviando.  Imposterà le variabili di conseguenza, ed
          avvierà un interprete al quale potranno essere passati i
          comandi dell'utente in maniera interattiva o attraverso uno
          script.</p><a id="idp83556048" class="indexterm"></a><a id="idp83556560" class="indexterm"></a><p>Poi il loader leggerà <code class="filename">/boot/loader.rc</code>,
          che di default legge i settaggi di
          <code class="filename">/boot/defaults/loader.conf</code> il quale imposta
          dei valori di default ragionevoli per le variabili e inoltre
          <code class="filename">/boot/loader.rc</code> legge
          <code class="filename">/boot/loader.conf</code> per i cambiamenti locali a
          quelle variabili.  In base a queste variabili
          <code class="filename">loader.rc</code> carica i moduli ed il kernel
          prescelti.</p><p>Infine, di default, il loader attende per 10 secondi la pressione
          di un tasto, ed avvia il kernel se non viene interrotto.  Se invece
          viene interrotto, viene presentato all'utente un prompt in grado di
          comprendere un semplice insieme di comandi, dal quale l'utente
          può impostare precisamente le variabili, scaricare dalla
          memoria tutti i moduli, o caricarli, ed infine avviare o
          ri-avviare.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-loader-commands"></a>12.3.3.2. Comandi Integrati nel Loader</h4></div></div></div><p>Questi sono i comandi usati più comunemente.  Per una
          discussione completa su tutti i comandi disponibili, guarda
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=loader&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">loader</span>(8)</span></a>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">autoboot <em class="replaceable"><code>secondi</code></em></span></dt><dd><p>Procede all'avvio del kernel se non viene interrotto
                nell'intervallo di tempo specificato, in secondi.  Mostra un
                conto alla rovescia, e l'intervallo predefinito è di
                10 secondi.</p></dd><dt><span class="term">boot
              [<span class="optional">-opzioni</span>]
              [<span class="optional">nomekernel</span>]</span></dt><dd><p>Procede immediatamente all'avvio del kernel, con le opzioni
                date, se ce ne sono, e con il nome del kernel specificato, se
                fornito.</p></dd><dt><span class="term">boot-conf</span></dt><dd><p>Va avanti con la stessa configurazione automatica di moduli
                basati sulle variabili come accade al boot.  Questo ha senso
                solo se prima usi <code class="command">unload</code>, e cambi delle
                variabili, in generale <code class="envar">kernel</code>.</p></dd><dt><span class="term">help
              [<span class="optional">argomento</span>]</span></dt><dd><p>Mostra un messaggio d'aiuto letto da
                <code class="filename">/boot/loader.help</code>.  Se l'argomento dato
                è <code class="literal">index</code>, allora elenca tutti gli
                argomenti disponibili.</p></dd><dt><span class="term">include <em class="replaceable"><code>nomefile</code></em> ...</span></dt><dd><p>Processa il file specificato.  Il file viene letto, e
                interpretato riga per riga.  Un errore blocca il comando include
                immediatamente.</p></dd><dt><span class="term">load [<span class="optional">-t
                tipo</span>]
              <em class="replaceable"><code>nomefile</code></em></span></dt><dd><p>Carica il kernel, il modulo del kernel, o il file
                del tipo specificato, con il nome specificato.  Ogni argomento
                dopo <em class="replaceable"><code>nomefile</code></em> viene passato al
                file.</p></dd><dt><span class="term">ls [<span class="optional">-l</span>]
              [<span class="optional">percorso</span>]</span></dt><dd><p>Mostra un elenco dei file nel percorso dato, o nella
                directory root, se non ne viene specificato uno.  Se è
                specificato <code class="option">-l</code>, verranno mostrate anche le
                dimensioni dei file.</p></dd><dt><span class="term">lsdev [<span class="optional">-v</span>]</span></dt><dd><p>Elenca tutti i dispositivi dai quali potrebbe essere
                possibile caricare moduli.  Se viene specificata l'opzione
                <code class="option">-v</code>, verranno stampati dettagli maggiori.</p></dd><dt><span class="term">lsmod [<span class="optional">-v</span>]</span></dt><dd><p>Mostra i moduli caricati.  Se viene specificato
                <code class="option">-v</code>, verranno stampati dettagli maggiori.</p></dd><dt><span class="term">more <em class="replaceable"><code>nomefile</code></em></span></dt><dd><p>Mostra i file specificati, con una pausa ad ogni
                pagina visualizzata.</p></dd><dt><span class="term">reboot</span></dt><dd><p>Riavvia immediatamente il sistema.</p></dd><dt><span class="term">set <em class="replaceable"><code>variabile</code></em>, </span><span class="term">set
              <em class="replaceable"><code>variabile</code></em>=<em class="replaceable"><code>valore</code></em></span></dt><dd><p>Imposta le variabili di ambiente del loader.</p></dd><dt><span class="term">unload</span></dt><dd><p>Rimuove tutti i moduli caricati.</p></dd></dl></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="boot-loader-examples"></a>12.3.3.3. Esempi sul Loader</h4></div></div></div><p>Qui ci sono alcuni esempi pratici sull'uso del loader:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Per avviare semplicemente il vostro kernel abituale,
            ma in modalità singolo utente:<a id="idp83604944" class="indexterm"></a></p><pre class="screen"><strong class="userinput"><code>boot -s</code></strong></pre></li><li class="listitem"><p>Per scaricare dalla memoria i moduli e il kernel usuali,
              e poi caricare solo il vecchio (o un altro) kernel:</p><pre class="screen"><strong class="userinput"><code>unload</code></strong>
<strong class="userinput"><code>load kernel.old</code></strong></pre><p>Puoi usare <code class="filename">kernel.GENERIC</code> per riferirti
              al kernel generico che viene fornito nel disco d'installazione, o
              <code class="filename">kernel.old</code><a id="idp83608784" class="indexterm"></a> per riferirti al kernel installato
              precedentemente (quando hai aggiornato o configurato il kernel, ad
              esempio).</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Usa il comando seguente  per caricare i tuoi soliti moduli
                con un altro kernel:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><strong class="userinput"><code>unload</code></strong>
<strong class="userinput"><code>set kernel="kernel.old"</code></strong>
<strong class="userinput"><code>boot-conf</code></strong></pre></div></li><li class="listitem"><p>Per caricare uno script di configurazione del kernel
              (uno script automatizzato che faccia le cose che faresti tu
              normalmente configurando il kernel all'avvio):</p><pre class="screen"><strong class="userinput"><code>load -t userconfig_script /boot/kernel.conf</code></strong></pre></li></ul></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="boot-introduction.html">Indietro</a> </td><td width="20%" align="center"><a accesskey="u" href="boot.html">Risali</a></td><td width="40%" align="right"> <a accesskey="n" href="boot-kernel.html">Avanti</a></td></tr><tr><td width="40%" align="left" valign="top">12.2. Il Problema dell'Avvio </td><td width="20%" align="center"><a accesskey="h" href="index.html">Partenza</a></td><td width="40%" align="right" valign="top"> 12.4. Interazione con il Kernel Durante l'Avvio</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Questo, ed altri documenti, possono essere scaricati da
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Per domande su FreeBSD, leggi la
    <a href="http://www.FreeBSD.org/docs.html">documentazione</a> prima di contattare
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Per domande su questa documentazione, invia una e-mail a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>