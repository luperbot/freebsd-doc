<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>27.3. Network File System (NFS)</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuale di FreeBSD" /><link rel="up" href="network-servers.html" title="Capitolo 27. Server di rete" /><link rel="prev" href="network-inetd.html" title="27.2. Il «Super-Server» inetd" /><link rel="next" href="network-nis.html" title="27.4. Network Information System (NIS/YP)" /><link rel="copyright" href="legalnotice.html" title="Nota Legale" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">27.3. Network File System (NFS)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-inetd.html">Indietro</a> </td><th width="60%" align="center">Capitolo 27. Server di rete</th><td width="20%" align="right"> <a accesskey="n" href="network-nis.html">Avanti</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-nfs"></a>27.3. Network File System (NFS)</h2></div><div><span class="authorgroup">Riorganizzato e migliorato da <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div><div><span class="authorgroup">Scritto da <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Bill</span> <span class="surname">Swingle</span></span>. </span></div></div></div><a id="idp87651408" class="indexterm"></a><p>Fra i molti differenti file system che
      FreeBSD supporta c'è il Network File System,
      conosciuto anche come <acronym class="acronym">NFS</acronym>.  <acronym class="acronym">NFS</acronym> permette ad un sistema di
      condividere directory
      e file con altri sistemi in rete.  Usando <acronym class="acronym">NFS</acronym>,
      utenti e programmi possono
      accedere a file su sistemi remoti quasi
      come se fossero files locali.</p><p>Alcuni dei più notevoli benefici che
      <acronym class="acronym">NFS</acronym> ci fornisce sono:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Workstation locali usano meno spazio su
          disco perchè i dati usati in locale possono
          essere conservati su una singola
          macchina e restano accessibili agli altri sulla rete.</p></li><li class="listitem"><p>Non c'è bisogno per gli utenti di avere
          home directory separate su ogni macchina in rete.
          Le home directory possono essere poste sul
          server <acronym class="acronym">NFS</acronym> e
          rese disponibili attraverso la rete.</p></li><li class="listitem"><p>Device di storage come floppy disk, drive
          CDROM, e drive <span class="trademark">Zip</span>® possono essere usati
          da altre macchine sulla rete.
          Questo può ridurre il numero di device di
          storage rimuovibili sulla rete.</p></li></ul></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87658320"></a>27.3.1. Come Funziona <acronym class="acronym">NFS</acronym></h3></div></div></div><p><acronym class="acronym">NFS</acronym> consiste di almeno due parti:
        un server ed uno o più client.  Il client
        accede da remoto ai dati conservati sulla macchina
        server.  Affinchè questo funzioni, alcuni processi
        devono essere configurati
        e devono essere attivi.</p><p>Il server deve avere attivi i seguenti demoni:</p><a id="idp87660368" class="indexterm"></a><a id="idp87661520" class="indexterm"></a><a id="idp87662672" class="indexterm"></a><a id="idp87663568" class="indexterm"></a><a id="idp87664464" class="indexterm"></a><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Demone</th><th>Descrizione</th></tr></thead><tbody><tr><td><span class="application">nfsd</span></td><td>Il demone <acronym class="acronym">NFS</acronym> che serve
                richieste da client <acronym class="acronym">NFS</acronym>.</td></tr><tr><td><span class="application">mountd</span></td><td>Il demone di mount <acronym class="acronym">NFS</acronym>
                che serve le richieste
                che <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=nfsd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">nfsd</span>(8)</span></a> gli passa.</td></tr><tr><td><span class="application">rpcbind</span></td><td> Questo demone permette ai client
                <acronym class="acronym">NFS</acronym> di scoprire quali porte il server
                <acronym class="acronym">NFS</acronym> sta usando.</td></tr></tbody></table></div><p>Il client può anche eseguire un demone,
        noto come <span class="application">nfsiod</span>.
        Il demone <span class="application">nfsiod</span>
        serve le richieste dal server
        <acronym class="acronym">NFS</acronym>.  E' opzionale, aiuta a
        migliorare le prestazioni ma non è indispensabile
        per operazioni corrette.  Consultare la pagina
        di manuale di <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=nfsiod&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">nfsiod</span>(8)</span></a>
        per più informazioni.
      </p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-configuring-nfs"></a>27.3.2. Configurare <acronym class="acronym">NFS</acronym></h3></div></div></div><a id="idp87687760" class="indexterm"></a><p>La configurazione di <acronym class="acronym">NFS</acronym>
        è un processo relativamente semplice.
        I processi che devono essere attivi
        possono essere tutti avviati al boot della macchina
        con poche modifiche al tuo file
        <code class="filename">/etc/rc.conf</code>.</p><p>Sul server <acronym class="acronym">NFS</acronym> assicurati
        che le seguenti opzioni sono configurati nel file
        <code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">rpcbind_enable="YES"
nfs_server_enable="YES"
mountd_flags="-r"</pre><p><span class="application">mountd</span> viene
        eseguito automaticamente in caso il server
        <acronym class="acronym">NFS</acronym> sia abilitato.</p><p>Sul client, accertati che questa riga sia
        attiva nel file
        <code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">nfs_client_enable="YES"</pre><p>Il file <code class="filename">/etc/exports</code>
        specifica quali file system <acronym class="acronym">NFS</acronym>
        dovrebbe esportare (talora
        chiamate anche <span class="quote">«<span class="quote">share</span>»</span>).  Ogni linea di
        <code class="filename">/etc/exports</code> specifica un
        file system che deve essere esportato e quali
        macchine hanno accesso a quel file system.
        Assieme alle macchine che hanno accesso a quel file system,
        possono esserci specificate anche opzioni.   Ci
        sono molte opzioni di questo tipo che possono essere
        usate in questo file ma solo poche saranno menzionate
        qui.  Puoi facilmente
        scoprire le altre opzioni leggendo la pagina di manuale
        di <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exports&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">exports</span>(5)</span></a>.</p><p>Queste sono alcune linee di esempio del file
        <code class="filename">/etc/exports</code>:</p><a id="idp87697360" class="indexterm"></a><p>I seguenti esempi danno un'idea di
        come esportare file system, anche se le
        impostazioni possono essere diverse
        a seconda del tuo ambiente e della tua
        configurazione di rete.
        Ad esempio, per esportare la directory
        <code class="filename">/cdrom</code>
        a tre macchine di esempio che hanno lo
        stesso nome di dominio del server (da qui
        la mancanza di nome dominio per ognuno)
        o hanno delle linee nel vostro file
        <code class="filename">/etc/hosts</code>.
        L'opzione <code class="option">-ro</code> rende il
        file system esportato read-only.  Con
        questo flag, il sistema remoto non sarà in grado
        di scrivere alcun cambiamento sul file system
        esportato.</p><pre class="programlisting">/cdrom -ro host1 host2 host3</pre><p>La seguente linea esporta la directory
        <code class="filename">/home</code> a tre host
        identificati da indirizzo IP.  E' una
        impostazione utile in caso tu abbia
        una rete privata senza un <acronym class="acronym">DNS</acronym> server
        configurato.  Opzionalmente il file
        <code class="filename">/etc/hosts</code>
        può essere configurato per hostname interni.
        Per favore rileggi
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hosts&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">hosts</span>(5)</span></a> per più informazioni.  Il flag
        <code class="option">-alldirs</code> permette alle sottodirectory
        di fungere da mount point.  In altre parole, non monterà
        le sottodirectory ma permetterà  ai client di montare
        solo le directory che necessita o di cui ha bisogno.</p><pre class="programlisting">/home  -alldirs  10.0.0.2 10.0.0.3 10.0.0.4</pre><p>La linea seguente esporta <code class="filename">/a</code>
        cosicchè due client da diversi domini possono accedere
        al file system.  L'opzione <code class="option">-maproot=root</code>
        permette all'utente <code class="systemitem">root</code> sul
        sistema remoto di scrivere dati
        sul file system esportato come utente <code class="systemitem">root</code>.
        Se il flag <code class="literal">-maproot=root</code> non
        è specificato, anche se l'utente ha accesso come
        <code class="systemitem">root</code> sul file system remoto,
        non sarà  in grado di modificare files sul file system
        esportato.</p><pre class="programlisting">/a  -maproot=root  host.example.com box.example.org</pre><p>Affinchè un client abbia accesso ad
        un file system, questo deve avere permessi adeguati.
        Assicurati che il client sia elencato nel
        file <code class="filename">/etc/exports</code>.</p><p>In <code class="filename">/etc/exports</code>, ogni
        linea rappresenta le informazioni per un
        file system esportato ad un host.  Un
        host remoto può essere specificato solo
        una volta per file system, e può
        avere solo una entry di default.  Ad esempio,
        supponi che <code class="filename">/usr</code> sia
        un singolo file system.  Il seguente
        <code class="filename">/etc/exports</code> sarebbe
        invalido:</p><pre class="programlisting"># Invalid when /usr is one file system
/usr/src   client
/usr/ports client</pre><p>Un file system, <code class="filename">/usr</code>,
        ha due linee che specificano exports verso lo stesso
        host, <code class="systemitem">client</code>.
        Il formato corretto per questa situazione è:</p><pre class="programlisting">/usr/src /usr/ports  client</pre><p>Le proprietà di un file system esportato
        ad un dato host devono essere tutte su una
        riga.  Linee senza un cliente specificato
        sono trattate come un singolo host.  Questo
        limita il modo di esportare file system, ma
        per la maggior parte delle persone
        non è un problema.</p><p>Il seguente è un esempio di valida
        lista di esportazione, dove
        <code class="filename">/usr</code> e <code class="filename">/exports</code>
        <code class="filename">/usr</code> and <code class="filename">/exports</code>
        sono file system locali:</p><pre class="programlisting"># Export src and ports to client01 and client02, but
only
# client01 has root privileges on it
/usr/src /usr/ports -maproot=root    client01
/usr/src /usr/ports               client02
# The client machines have root and can mount anywhere
# on /exports. Anyone in the world can mount /exports/obj read-only
/exports -alldirs -maproot=root      client01 client02
/exports/obj -ro</pre><p>Il demone <span class="application">mountd</span> deve
        essere forzato a rileggere il file <code class="filename">/etc/exports</code>
        ogni volta che lo modifichi,
        cosicchè i cambiamenti abbiano effetto.
        Questo può essere ottenuto inviando un segnale HUP
        al processo <code class="command">mountd</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kill -HUP `cat /var/run/mountd.pid`</code></strong></pre><p>o invocando lo script <code class="command">mountd</code> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a>
        con i parametri appropriati:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/mountd onereload</code></strong></pre><p>Sei invitato a far riferimento a <a class="xref" href="configtuning-initial.html" title="11.2. Configurazione Iniziale">Sezione 11.2, «Configurazione Iniziale»</a> per
        maggiori informazioni sugli script rc.</p><p>Alternativamente, un reboot farà  sì
        che FreeBSD imposti tutto
        correttamente.  Non è necessario tuttavia effettuare
        un reboot.  L'esecuzione del seguente comando da
        utente <code class="systemitem">root</code>
        dovrebbe avviare tutto.</p><p>Sul server <acronym class="acronym">NFS</acronym>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>rpcbind</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>nfsd -u -t -n 4</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mountd -r</code></strong></pre><p>Sul client <acronym class="acronym">NFS</acronym>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>nfsiod -n 4</code></strong></pre><p>Ora dovrebbe essere tutto pronto per montare
        un file system remoto.
        In questi esempi il nome del server
        sarà  <code class="systemitem">server</code> e quello del client
        sarà  <code class="systemitem">client</code>.  Se vuoi solo
        temporaneamente montare un file system remoto o
        anche testare la configurazione, basta che
        esegui un comando come questo
        come utente <code class="systemitem">root</code> sul client:</p><a id="idp87756112" class="indexterm"></a><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount server:/home
/mnt</code></strong></pre><p>Questo monterà  la directory
        <code class="filename">/home</code> del server
        sopra <code class="filename">/mnt</code> sul client.  Se
        tutto è impostato correttamente dovresti
        essere in grado di entrare nella directory
        <code class="filename">/mnt</code> sul client e vedere
        tutti i file che sono sul server.</p><p>Se vuoi montare automaticamente un
        file system remoto ogni volta che il
        computer fa boot, aggiungi il file system
        al file <code class="filename">/etc/fstab</code>.
        Questo è un esempio:</p><pre class="programlisting">server:/home /mnt nfs rw 0 0</pre><p>La pagina di manuale di <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fstab&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">fstab</span>(5)</span></a>
        elenca tutte le possibili opzioni.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87766352"></a>27.3.3. Locking</h3></div></div></div><p>Alcune applicazioni (es. <span class="application">mutt</span>)
        richiedono il lock dei file per operare in modo corretto.
        In caso di <acronym class="acronym">NFS</acronym>, può essere utilizzato
        <span class="application">rpc.lockd</span> per il lock dei file.
        Per abilitarlo, aggiungi la seguente riga al file
        <code class="filename">/etc/rc.conf</code> sia sul client che sul
        server (assumendo che il client e server <acronym class="acronym">NFS</acronym>
        siano già configurati):</p><pre class="programlisting">rpc_lockd_enable="YES"
rpc_statd_enable="YES"</pre><p>Avvia l'applicazione con:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/nfslocking start</code></strong></pre><p>Se non è richiesto un lock reale tra il server
       e il client <acronym class="acronym">NFS</acronym>, è possibile
       dire al client <acronym class="acronym">NFS</acronym>  di fare un lock locale
       passando l'opzione <code class="option">-L</code> a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount_nfs</span>(8)</span></a>.
       Ulteriori dettagli possono essere trovati nella pagina man di
       <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount_nfs</span>(8)</span></a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87774288"></a>27.3.4. Usi Pratici</h3></div></div></div><p><acronym class="acronym">NFS</acronym> ha molti usi
        pratici.  Alcuni
        dei più usati sono elencati di seguito:</p><a id="idp87775568" class="indexterm"></a><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Fa sì che alcune macchine
            condividano un CDROM o un altro media
            fra di loro.  Questo è un metodo
            più economico e spesso più convieniente
            di installare software su molte macchine.</p></li><li class="listitem"><p>Su grandi reti, potrebbe essere più
            conveniente configurare un server
            <acronym class="acronym">NFS</acronym> centrale in cui
            conservare tutte le home directory degi utenti.
            Queste home directory
            possono essere esportate sulla rete cosicchè
            gli utenti abbiano sempre la stessa directory,
            indipendentemente dalla workstation dalla quale
            effettuino il login.</p></li><li class="listitem"><p>Molte macchine potrebbero avere una
            directory comune
            <code class="filename">/usr/ports/distfiles</code>.
            In questo modo, quando hai bisogno di
            installare un port su molte macchine,
            puoi velocemente accedere al sorgente senza
            scaricarlo su ogni macchina.</p></li></ul></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-amd"></a>27.3.5. Mount automatici con <span class="application">amd</span></h3></div><div><span class="authorgroup">Grazie al contributo di <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Wylie</span> <span class="surname">Stilwell</span></span>. </span></div><div><span class="authorgroup">Riscritto da <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Chern</span> <span class="surname">Lee</span></span>. </span></div></div></div><a id="idp87784784" class="indexterm"></a><a id="idp87785296" class="indexterm"></a><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=amd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">amd</span>(8)</span></a> (il demone di mount automatico)
        monta automaticamente un file system remoto
        ogni volta che un file o una directory in quel
        file system viene acceduto.  I file system che sono
        inattivi per un certo periodo di tempo possono
        anche essere smontati automaticamente da
        <span class="application">amd</span>.  L'uso di
        <span class="application">amd</span> fornisce una semplice
        alternativa a mount permanenti, dato che i mount
        permanenti sono di solito
        elencati in <code class="filename">/etc/fstab</code>.</p><p><span class="application">amd</span> opera connettendosi
        ad un server NFS sulle directory
        <code class="filename">/host</code> e
        <code class="filename">/net</code>.  Quando si accede ad un file
        all'interno di una di queste directory,
        <span class="application">amd</span>
        fa una ricerca del mount remoto corrispondente e lo
        monta automaticamente.  <code class="filename">/net</code>
        è usato per montare
        un file system esportato da un indirizzo IP,
        mentre <code class="filename">/host</code>
        è usato per montare un export da un hostname remoto.</p><p>Un accesso ad un file in
        <code class="filename">/host/foobar/usr</code> dovrebbe
        comunicare a <span class="application">amd</span> di
        cercare di montare
        l'export <code class="filename">/usr</code> sull'host
        <code class="systemitem">foobar</code>.</p><div class="example"><a id="idp87800912"></a><div class="example-title">Esempio 27.2. Montare un export con
          <span class="application">amd</span></div><div class="example-contents"><p>Puoi osservare i mount disponibili di un
          host remoto con il comando
          <code class="command">showmount</code>.  Ad esempio, per
          vedere i mounts di un host chiamato
          <code class="systemitem">foobar</code>, puoi usare:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>showmount -e foobar</code></strong>
Exports list on foobar:
/usr                               10.10.10.0
/a                                 10.10.10.0
<code class="prompt">%</code> <strong class="userinput"><code>cd /host/foobar/usr</code></strong></pre></div></div><br class="example-break" /><p>Come si vede nell'esempio,
        il comando <code class="command">showmount</code> mostra
        <code class="filename">/usr</code> come un export.
        Quando si cambia directory in
        <code class="filename">/host/foobar/usr</code>,
        <span class="application">amd</span>
        cerca di risolvere <code class="systemitem">foobar</code> e
        automaticamente monta l'export desiderato.</p><p><span class="application">amd</span> può essere
        avviato dagli scripts di startup inserendo le
        seguenti linee in
        <code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">amd_enable="YES"</pre><p>Inoltre, altri flags personalizzati possono essere
        ad <span class="application">amd</span> con le opzioni
        <code class="varname">amd_flags</code>.  Di default,
        <code class="varname">amd_flags</code> è impostato a:</p><pre class="programlisting">amd_flags="-a /.amd_mnt -l syslog /host /etc/amd.map
/net /etc/amd.map"</pre><p>Il file <code class="filename">/etc/amd.map</code>
        definisce le opzioni di default con le quali
        gli export sono montati.  Il file
        <code class="filename">/etc/amd.conf</code> definisce
        alcune delle più avanzate caratteristiche di
        <span class="application">amd</span>.</p><p>Consulta le pagine di manuale di <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=amd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">amd</span>(8)</span></a>
        e <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=amd.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">amd.conf</span>(5)</span></a>
        per maggiori informazioni.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-nfs-integration"></a>27.3.6. Problemi nell'integrazione con altri sistemi</h3></div><div><span class="authorgroup">Grazie al contributo di <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">John</span> <span class="surname">Lind</span></span>. </span></div></div></div><p>Alcuni adapter Ethernet per sistemi PC hanno
        limitazioni che possono portare a seri
        problemi seri di rete, in particolare con NFS.
        Questa difficoltà  non è specifica a FreeBSD,
        ma i sistemi FreeBSD ne sono affetti.</p><p>I problemi avvengono quasi sempre
        quando sistemi PC (FreeBSD) sono
        connessi in rete con workstation ad alta
        performance, tipo quelli di
        Silicon Graphics, Inc., e Sun Microsystems, Inc.
        Il mount NFS funziona, ed alcune operazioni possono
        avere successo, ma d'improvviso sembra che il
        server non dia più risposte al client,
        anche se le richieste da e verso altri sistemi
        continuano ad essere processate.
        Questo avviene sul sistema client, sia che
        il client sia il sistema
        FreeBSD sia che sia la workstation.  Su molti sistemi,
        non c'è modo di effettuare lo shutdown del client
        in modo pulito una volta che questo problema si
        sia manifestato.  L'unica soluzione
        è spesso quella di resettare il client,
        poichè la situazione NFS
        non può essere risolta.</p><p>Anche se la soluzione <span class="quote">«<span class="quote">corretta</span>»</span>
        è usare un adapter Ethernet dalle migliori
        prestazioni e capacità , c'è un semplice
        workaround che permetterà  operazioni soddisfacenti.
        Se il sistem FreeBSD è il <span class="emphasis"><em>server</em></span>,
        includi le opzioni <code class="option">-w=1024</code> al
        mount dal client.  Se il sistema FreeBSD
        è il <span class="emphasis"><em>client</em></span>, allora monta
        il file system NFS con l'opzione <code class="option">-r=1024</code>.
        Queste opzioni possono essere specificate usando
        il quarto campo della linea di
        <code class="filename">fstab</code> sul client per
        mount automatici, o usa il parametro <code class="option">-o</code>
        del comando <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> per mount manuali.</p><p>Bisognerebbe notare che c'è un problema diverso,
        a volte confuso con questo, quando il server NFS ed
        il client sono su reti diverse.  Se è questo
        il caso, <span class="emphasis"><em>accertatevi</em></span>
        che i vostri router indirizzino correttamente l'informazione
        necessaria su <acronym class="acronym">UDP</acronym>, o non andrai
        da nessuna parte, indipendentemente da cosa tu
        stia cercando di fare.</p><p>Nei seguenti esempi, <code class="systemitem">fastws</code> è
        il nome host (interfaccia) di una workstation
        ad alte prestazioni, e <code class="systemitem">freebox</code>
        è il nome host (interfaccia) di un sistema FreeBSD con
        un adapter Ethernet a basse prestazioni.  Inoltre,
        <code class="filename">/sharedfs</code> sarà  il file system esportato
        (vedi <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exports&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">exports</span>(5)</span></a>), e <code class="filename">/project</code>
        sarà  il mount point sul client per il file system
        montato.  In tutti i casi, nota che le opzioni
        <code class="option">hard</code> o <code class="option">soft</code> e
        <code class="option">bg</code> possono essere utili
        nella tua applicazione.</p><p>Esempi dal sistema FreeBSD (<code class="systemitem">freebox</code>)
        come client da <code class="filename">/etc/fstab</code> su
        <code class="systemitem">freebox</code>:</p><pre class="programlisting">fastws:/sharedfs /project nfs rw,-r=1024 0 0</pre><p>Come comando manuale di mount da
        <code class="systemitem">freebox</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -t nfs -o -r=1024 fastws:/sharedfs /project</code></strong></pre><p>Esempi dal sistema FreeBSD come server in
        <code class="filename">/etc/fstab</code> su
        <code class="systemitem">fastws</code>:</p><pre class="programlisting">freebox:/sharedfs /project nfs rw,-w=1024 0 0</pre><p>Come comando di mount manuale su
        <code class="systemitem">fastws</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -t nfs -o -w=1024 freebox:/sharedfs /project</code></strong></pre><p>Praticamente ogni Ethernet adapter a 16-bit permetterà 
        operazioni senza le succitate restrizioni sulla dimensione
        di lettura e scrittura.</p><p>Per chiunque è interessato, ecco cosa succede quando
        occorre il problema, il che spiega anche perchè sia
        non riparabile.  NFS tipicamente lavora con una dimensione
        di <span class="quote">«<span class="quote">block</span>»</span> di 8 K (anche se può creare
        frammenti di dimensione minore).  Dal momento che la
        massima dimensione dei pacchetti Ethernet è attorno
        a 1500 bytes, il <span class="quote">«<span class="quote">block</span>»</span> NFS sarà 
        diviso in molti pacchetti Ethernet
        anche se è pur sempre una singola unità  per il codice
        di più alto livello e deve essere ricevuto, assemblato
        e <span class="emphasis"><em>riconosciuto</em></span> come una unità .
        La workstation ad alta performance può inviare
        pacchetti che comprendono le unità  NFS una dietro l'altra,
        l'una vicino all'altra come permette lo standard.i
        Sulla scheda a minore capacità , gli ultimi pacchetti
        sovrascrivono i precedenti pacchetti della stessa
        unità  prima che possano essere trasferiti all'host
        e l'unità  nella
        sua interezza non può essere ricostruita
        o riconosciuta.  Come risultato, la workstation andrà 
        in timeout e cercherà  ancora di ripetere l'operazione,
        ma cercherà  con la stessa unità  da 8 K, ed il
        processo sarà  ripetuto ancora, all'infinito.</p><p>Mantenendo la dimensione dell'unità  al di sotto
        della limitazione dei pacchetti Ethernet, ci assicuriamo che
        ogni completo pacchetto Ethernet ricevuto possa essere
        ricono sciuto individualmente, evitando così la
        situazione deadlock.</p><p>Sovrascritture possono anche capitare quando una
        workstation ad alte prestazioni riversi dati verso
        un sistema PC, ma con la scheda di rete migliore,
        sovrascritture di questo tipo non sono garantite su
        <span class="quote">«<span class="quote">unità </span>»</span> NFS.  Quando una sovrascrittura
        avviene, le unità  affette saranno ritrasmesse,
        e c'è una buona probabilità  che saranno
        ricevute, assemblate, e riconosciute.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-inetd.html">Indietro</a> </td><td width="20%" align="center"><a accesskey="u" href="network-servers.html">Risali</a></td><td width="40%" align="right"> <a accesskey="n" href="network-nis.html">Avanti</a></td></tr><tr><td width="40%" align="left" valign="top">27.2. Il
      <span class="quote">«<span class="quote">Super-Server</span>»</span> <span class="application">inetd</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Partenza</a></td><td width="40%" align="right" valign="top"> 27.4. Network Information System (NIS/YP)</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Questo, ed altri documenti, possono essere scaricati da
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Per domande su FreeBSD, leggi la
    <a href="http://www.FreeBSD.org/docs.html">documentazione</a> prima di contattare
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Per domande su questa documentazione, invia una e-mail a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>