<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>24.6. Impostazione della Console Seriale</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuale di FreeBSD" /><link rel="up" href="serialcomms.html" title="Capitolo 24. Comunicazioni Seriali" /><link rel="prev" href="dialout.html" title="24.5. Servizio di Effettuazione Chiamate" /><link rel="next" href="ppp-and-slip.html" title="Capitolo 25. PPP e SLIP" /><link rel="copyright" href="legalnotice.html" title="Nota Legale" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">24.6. Impostazione della Console Seriale</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="dialout.html">Indietro</a> </td><th width="60%" align="center">Capitolo 24. Comunicazioni Seriali</th><td width="20%" align="right"> <a accesskey="n" href="ppp-and-slip.html">Avanti</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="serialconsole-setup"></a>24.6. Impostazione della Console Seriale</h2></div><div><span class="authorgroup">Contributo di <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Kazutaka</span> <span class="surname">YOKOTA</span></span>. </span></div><div><span class="authorgroup">Basato su un documento di <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Bill</span> <span class="surname">Paul</span></span>. </span></div></div></div><a id="idp86403280" class="indexterm"></a><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-intro"></a>24.6.1. Introduzione</h3></div></div></div><p>FreeBSD ha la capacità di avviare un sistema con soltanto un
        terminale stupido su porta seriale come console.  Una configurazione
        simile dovrebbe essere utile per due tipi di persone:  amministratori di
        sistema che desiderano installare FreeBSD su macchine che non hanno
        tastiera o monitor connesso, e sviluppatori che vogliono effettuare il
        debug del kernel o dei driver.</p><p>Come descritto nel <a class="xref" href="boot.html" title="Capitolo 12. La Procedura di Avvio di FreeBSD">Capitolo 12, <em>La Procedura di Avvio di FreeBSD</em></a>, FreeBSD implementa un
        avviamento composto da tre stadi.  I primi due stadi sono
        nel blocco di avvio che viene immagazzinato all'inizio
        della slice di FreeBSD sul disco d'avvio.  Il blocco di avvio
        poi carica ed avvia il loader (<code class="filename">/boot/loader</code>)
        come terzo stadio.</p><p>Per poter impostare la console seriale devi configurare il codice
        del blocco di avvio, il codice del loader ed il kernel.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-howto-fast"></a>24.6.2. Configurazione della Console Seriale, Versione Essenziale</h3></div></div></div><p>Questa sezione presuppone che stai usando una configurazione
        di default e vuoi solamente una veloce panoramica su come abilitare
        una console seriale.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Connetti il cavo seriale alla COM1 e al terminale.</p></li><li class="step"><p>Per vedere tutti i messaggi di boot sulla console seriale,
            dai il comando seguente mentre sei loggato come superuser:</p><pre class="screen"><code class="prompt">#</code> echo 'console="comconsole"' &gt;&gt; /boot/loader.conf</pre></li><li class="step"><p>Modifica il file <code class="filename">/etc/ttys</code> e cambia
            <code class="literal">off</code> in <code class="literal">on</code> e
            <code class="literal">dialup</code> in <code class="literal">vt100</code> per l'entry
            <code class="literal">ttyd0</code>.  Altrimenti non verrà chiesta la
            password per connettersi via console seriale, con il risultato di
            creare un potenziale buco di sicurezza.</p></li><li class="step"><p>Riavvia il sistema per vedere se i cambiamenti
             funzionano.</p></li></ol></div><p>Se si necessita di una diversa configurazione, esiste una spiegazione
        maggiormente dettagliata nella sezione <a class="xref" href="serialconsole-setup.html#serialconsole-howto" title="24.6.3. Configurazione della Console Seriale">Sezione 24.6.3, «Configurazione della Console Seriale»</a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-howto"></a>24.6.3. Configurazione della Console Seriale</h3></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Preparazione di un cavo seriale.</p><a id="idp86416976" class="indexterm"></a><p>Avrai bisogno di un cavo null-modem o di un cavo seriale
            standard ed un adattatore null-modem.  Guarda
            <a class="xref" href="serial.html#serial-cables-ports" title="24.2.2. Cavi e Porte">Sezione 24.2.2, «Cavi e Porte»</a> per una discussione
            sui cavi seriali.</p></li><li class="step"><p>Scollegamento della tastiera.</p><p>La maggior parte dei sistemi PC verifica la presenza di una
            tastiera durante il Power-On Self-Test (POST) e dà un errore
            se la tastiera non viene rilevata.  Alcune macchine si lamentano
            parecchio per la mancanza della tastiera e non proseguono l'avvio
            finché non viene collegata.</p><p>Se il tuo computer si lamenta per questo errore,
            ma si avvia lo stesso, allora non devi fare nulla di speciale.
            (Alcune macchine con BIOS Phoenix semplicemente dicono
            <span class="errorname">Keyboard failed</span> e continuano ad avviarsi
            normalmente).</p><p>Se il tuo computer rifiuta di avviarsi senza la tastiera
            allora dovrai configurare il BIOS affinché ignori questo
            errore (se possibile).  Consulta il manuale della tua scheda madre
            per maggiori dettagli su come fare ciò.</p><div xmlns="" class="tip"><h3 class="admontitle">Suggerimento: </h3><p xmlns="http://www.w3.org/1999/xhtml">Imposta la tastiera su <span class="quote">«<span class="quote">Non installata</span>»</span> nel
              setup del BIOS.  Sarai ancora in grado di
              usare la tastiera.  Tutto quel che fa è dire al BIOS
              di non verificare la presenza di una tastiera all'accensione.
              Il tuo BIOS non dovrebbe segnalare che la tastiera non
              è collegata.
              Puoi lasciare la tastiera collegata anche con questa opzione
              impostata a <span class="quote">«<span class="quote">Non installata</span>»</span> e la tastiera
              funzionerà lo stesso.</p></div><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Se il tuo sistema ha un mouse <span class="trademark">PS/2</span>®, le possibilità di
              dover scollegare il mouse allo stesso modo della tastiera
              sono alte.
              Questo perché i mouse <span class="trademark">PS/2</span>® condividono dell'hardware
              con la tastiera e lasciando il mouse collegato potresti
              ingannare la verifica della tastiera facendogli credere
              che sia ancora presente.  Si dice che il sistema
              Gateway 2000 Pentium 90 MHz con BIOS AMI funzioni
              così.
              In generale, questo non è un problema perché il
              mouse non è comunque particolarmente utile senza la
              tastiera.</p></div></li><li class="step"><p>Collegamento di un terminale stupido alla
            <code class="filename">COM1</code>
            (<code class="filename">sio0</code>).</p><p>Se non possiedi un terminale stupido, puoi usare un
            vecchio PC/XT con un programma per modem, o la porta seriale di un
            altra macchina <span class="trademark">UNIX</span>®.  Se non hai una <code class="filename">COM1</code>
            (<code class="filename">sio0</code>), trovane una.
            Attualmente, non c'è altro modo di scegliere
            una porta diversa dalla <code class="filename">COM1</code>
            per i blocco di avvio senza doverlo ricompilare.  Se stai
            già usando la <code class="filename">COM1</code> per un altro
            dispositivo, dovrai rimuoverlo temporaneamente ed
            installare un nuovo blocco di avvio ed un nuovo kernel
            una volta che FreeBSD sia funzionante.  (Si assume che la
            <code class="filename">COM1</code> sia sempre disponibile
            su un server di file/calcolo/terminali; se davvero hai bisogno
            della <code class="filename">COM1</code> per qualcos'altro
            (e non puoi passare quel qualcosa alla
            <code class="filename">COM2</code> (<code class="filename">sio1</code>)),
            allora probabilmente non dovresti nemmeno avere a che fare con
            tutto questo in primo luogo).</p></li><li class="step"><p>Assicurati che il file di configurazione del tuo kernel abbia
            i parametri appropriati impostati per la
            <code class="filename">COM1</code>
            (<code class="filename">sio0</code>).</p><p>I parametri rilevanti sono:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">0x10</code></span></dt><dd><p>Abilita il supporto alla console per questa unità.
                  Gli altri parametri di console sono ignorati se non è
                  fissato questo.
                  Attualmente, al massimo un'unità può avere il
                  supporto alla console;  verrà preferita la prima
                  (secondo l'ordine nel file di configurazione) con questo
                  parametro.
                  Questa opzione non renderà la porta seriale la
                  console.
                  Imposta il parametro seguente o usa l'opzione
                  <code class="option">-h</code> descritta più in basso, insieme a
                  questa impostazione.</p></dd><dt><span class="term"><code class="literal">0x20</code></span></dt><dd><p>Forza questa unità ad essere la console (a meno che
                  sia presente un'altra console con priorità più
                  alta), trascurando l'opzione <code class="option">-h</code> discussa
                  precedentemente.  Il parametro
                  <code class="literal">0x20</code> deve essere usato insieme al
                  <code class="option">0x10</code>.</p></dd><dt><span class="term"><code class="literal">0x40</code></span></dt><dd><p>Riserva questa unità (insieme a
                  <code class="literal">0x10</code>) e rende l'unità indisponibile
                  per l'accesso normale.  Non dovresti impostare questo
                  parametro sull'unità della porta seriale che desideri
                  usare come console seriale.  L'unico uso di questo parametro
                  è per designare l'unità per il debug remoto
                  del kernel.  Guarda il <a class="link" href="../../../../doc/it_IT.ISO8859-15/books/developers-handbook/index.html" target="_top">Developer's
                    Handbook</a> per maggiori informazioni sul
                  debugging remoto.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">In FreeBSD 4.0 o successivo, la semantica del
                    parametro <code class="literal">0x40</code> è leggermente
                    differente e c'è un altro parametro per specificare
                    una porta seriale per il debug remoto.</p></div></dd></dl></div><p>Esempio:</p><pre class="programlisting">device sio0 at isa? port IO_COM1 flags 0x10 irq 4</pre><p>Guarda la pagina man <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sio&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sio</span>(4)</span></a> per maggiori dettagli.</p><p>Se i parametri non sono stati impostati, sarà necessario
            eseguire UserConfig (su una console differente) o ricompilare il
            kernel.</p></li><li class="step"><p>Creazione di <code class="filename">boot.config</code> nella directory
            radice della partizione <code class="literal">a</code> nel disco di
            avvio.</p><p>Questo file istruirà il codice del blocco di avvio su
            come vuoi avviare il sistema.  Per poter attivare la console
            seriale, avrai bisogno di una o più delle seguenti
            opzioni-se vuoi opzioni multiple, includile tutte sulla
            stessa linea:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-h</code></span></dt><dd><p>Passa dalla console interna a quella seriale.  Puoi usarla
                  per cambiare i dispositivi console.  Ad esempio, se avvii
                  dalla console interna (video), puoi usare
                  <code class="option">-h</code> per dirigere il loader ed il kernel
                  in modo che usino la porta seriale come dispositivo per la
                  console.  Alternativamente, se avvii da porta seriale, puoi
                  usare l'opzione <code class="option">-h</code> per dire al loader ed al
                  kernel di usare lo schermo come console.</p></dd><dt><span class="term"><code class="option">-D</code></span></dt><dd><p>Passa da una configurazione singola a una duplice.  Nella
                  configurazione singola la console sarà o quella interna
                  (il display video) o la porta seriale, a seconda dello
                  stato dell'opzione <code class="option">-h</code> già descritta.
                  Nella configurazione duplice, sia il display video che la
                  porta seriale diventeranno la console allo stesso momento,
                  senza curarsi dello stato dell'opzione <code class="option">-h</code>.
                  Ad ogni modo, nota che questa configurazione duplice ha
                  effetto solo durante l'esecuzione del blocco di avvio.
                  Una volta che il loader ha assunto il controllo, la console
                  specificata da <code class="option">-h</code> diventa l'unica.</p></dd><dt><span class="term"><code class="option">-P</code></span></dt><dd><p>Fa sì che il blocco di avvio verifichi la presenza
                  della tastiera.  Se non ne viene rilevata nessuna, le opzioni
                  <code class="option">-D</code> e <code class="option">-h</code>
                  vengono impostate automaticamente.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">A causa delle costrizioni relative allo spazio
                    nelle versioni attuali del blocco di avvio, l'opzione
                    <code class="option">-P</code> è in grado di riconoscere solo le
                    tastiere estese.  Le tastiere con meno di 101 tasti (e senza
                    i tasti F11 e F12) potrebbero non essere rilevate.
                    Le tastiere su alcuni computer portatili potrebbero
                    non essere rilevate a causa di questa limitazione.
                    Se questo è il caso del tuo sistema,
                    devi abbandonare l'opzione <code class="option">-P</code>.
                    Sfortunatamente non c'è nessun metodo per aggirare
                    questo problema.</p></div></dd></dl></div><p>Usa l'opzione <code class="option">-P</code> per selezionare
            la console automaticamente, o l'opzione <code class="option">-h</code> per
            attivare la console seriale.</p><p>Puoi includere altre opzioni come descritte in
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=boot&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">boot</span>(8)</span></a>.</p><p>Le opzioni, eccetto <code class="option">-P</code>, verranno passate al
            loader (<code class="filename">/boot/loader</code>).  Il loader
            determinerà quale tra il video interno o la console seriale
            debba diventare la console esaminando lo stato dell'opzione
            <code class="option">-h</code>.  Ciò significa che se specifichi
            l'opzione <code class="option">-D</code> ma non la <code class="option">-h</code>
            in <code class="filename">/boot.config</code>, puoi usare la porta seriale
            come console soltanto durante l'esecuzione del blocco di avvio; il
            loader userà il video interno come console.</p></li><li class="step"><p>Avviamento della macchina.</p><p>Quando avvii la tua macchina FreeBSD, il blocco di avvio
            scriverà il contenuto di <code class="filename">/boot.config</code>
            sulla console.  Ad esempio:</p><pre class="screen">/boot.config: -P
Keyboard: no</pre><p>La seconda linea appare solo se metti l'opzione
            <code class="option">-P</code> in <code class="filename">/boot.config</code> ed indichi
            la presenza/assenza della tastiera.  Questo messaggio va alla
            console seriale o a quella interna, o a entrambe, a seconda
            dell'opzione in <code class="filename">/boot.config</code>.</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Opzioni</th><th align="left">I messaggi vanno a</th></tr></thead><tbody><tr><td>nessuna</td><td>console interna</td></tr><tr><td><code class="option">-h</code></td><td>console seriale</td></tr><tr><td><code class="option">-D</code></td><td>console seriale ed interna</td></tr><tr><td><code class="option">-Dh</code></td><td>console seriale ed interna</td></tr><tr><td><code class="option">-P</code>, tastiera presente</td><td>console interna</td></tr><tr><td><code class="option">-P</code>, tastiera assente</td><td>console seriale</td></tr></tbody></table></div><p>Dopo i messaggi precedenti, ci sarà una piccola pausa
            prima che il blocco di avvio continui nel caricamento del loader e
            prima che ulteriori messaggi vengano scritti sulla console.
            In circostanze normali, non hai necessità di interrompere il
            blocco di avvio, ma potresti volerlo fare per verificare che tutto
            sia impostato correttamente.</p><p>Premi un tasto qualsiasi, differente da
            <span class="keycode">Invio</span>, alla console per interrompere il processo
            di avvio.  Il blocco di avvio aspetterà ulteriori azioni.
            Dovresti vedere qualcosa del genere:</p><pre class="screen">&gt;&gt; FreeBSD/i386 BOOT
Default: 0:ad(0,a)/boot/loader
boot:</pre><p>Verifica se il messaggio precedente appare sulla console seriale
            o su quella interna o su entrambe, secondo le opzioni poste in
            <code class="filename">/boot.config</code>.  Se il messaggio appare nella
            console corretta, premi <span class="keycode">Invio</span> per continuare il
            processo di avvio.</p><p>Se vuoi la console seriale ma non riesci a vedere il prompt sul
            terminale seriale, qualcosa è sbagliato nelle tue
            impostazioni.  Nel frattempo, scrivi <code class="option">-h</code> e premi
            Invio (se possibile) per dire al blocco di avvio (e al loader e al
            kernel) di scegliere la porta seriale per la console.  Una volta
            che il sistema è attivo, torna indietro e verifica cosa
            è andato storto.</p></li></ol></div><p>Dopo che il loader è stato caricato e ti trovi nel terzo
        stadio del processo di avvio puoi ancora passare dalla console interna
        alla console seriale impostando le variabili d'ambiente appropriate nel
        loader.  Guarda la <a class="xref" href="serialconsole-setup.html#serialconsole-loader" title="24.6.6. Cambiamento della Console dal Loader">Sezione 24.6.6, «Cambiamento della Console dal Loader»</a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-summary"></a>24.6.4. Sommario</h3></div></div></div><p>Qui c'è il sommario delle varie impostazioni discusse in
        questa sezione e la console eventualmente selezionata.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86497616"></a>24.6.4.1. Caso 1: Imposti il Flag 0x10 per
          <code class="filename">sio0</code></h4></div></div></div><pre class="programlisting">device sio0 at isa? port IO_COM1 flags 0x10 irq 4</pre><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th align="left">Opzioni in /boot.config</th><th align="left">Console durante i blocco di avvio</th><th align="left">Console durante il loader</th><th align="left">Console nel kernel</th></tr></thead><tbody><tr><td>niente</td><td>interna</td><td>interna</td><td>interna</td></tr><tr><td><code class="option">-h</code></td><td>seriale</td><td>seriale</td><td>seriale</td></tr><tr><td><code class="option">-D</code></td><td>seriale ed interna</td><td>interna</td><td>interna</td></tr><tr><td><code class="option">-Dh</code></td><td>seriale ed interna</td><td>seriale</td><td>seriale</td></tr><tr><td><code class="option">-P</code>, tastiera presente</td><td>interna</td><td>interna</td><td>interna</td></tr><tr><td><code class="option">-P</code>, tastiera assente</td><td>seriale ed interna</td><td>seriale</td><td>seriale</td></tr></tbody></table></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86520144"></a>24.6.4.2. Caso 2: Imposti il Flag 0x30 per sio0</h4></div></div></div><pre class="programlisting">device sio0 at isa? port IO_COM1 flags 0x30 irq 4</pre><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th align="left">Opzioni in /boot.config</th><th align="left">Console durante i blocco di avvio</th><th align="left">Console durante il loader</th><th align="left">Console nel kernel</th></tr></thead><tbody><tr><td>niente</td><td>interna</td><td>interna</td><td>seriale</td></tr><tr><td><code class="option">-h</code></td><td>seriale</td><td>seriale</td><td>seriale</td></tr><tr><td><code class="option">-D</code></td><td>seriale ed interna</td><td>interna</td><td>seriale</td></tr><tr><td><code class="option">-Dh</code></td><td>seriale ed interna</td><td>seriale</td><td>seriale</td></tr><tr><td><code class="option">-P</code>, tastiera presente</td><td>interna</td><td>interna</td><td>seriale</td></tr><tr><td><code class="option">-P</code>, tastiera assente</td><td>seriale ed interna</td><td>seriale</td><td>seriale</td></tr></tbody></table></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-tips"></a>24.6.5. Consigli per una Console Seriale</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86547536"></a>24.6.5.1. Impostazione di una Velocità Maggiore della Porta
          Seriale</h4></div></div></div><p>Di default, le impostazioni della porta seriale sono: 9600 baud, 8
          bit, nessuna parità, ed 1 bit di stop.  Se desideri cambiare
          la velocità, avrai bisogno di ricompilare almeno il blocco di
          avvio.  Aggiungi la linea seguente a
          <code class="filename">/etc/make.conf</code> e compila il nuovo blocco di
          avvio:</p><pre class="programlisting">BOOT_COMCONSOLE_SPEED=19200</pre><p>Guarda <a class="xref" href="serialconsole-setup.html#serialconsole-com2" title="24.6.5.2. Utilizzo di una Porta Seriale Differente da sio0 per la Console">Sezione 24.6.5.2, «Utilizzo di una Porta Seriale Differente da
          <code class="filename">sio0</code> per la Console»</a> per istruzioni
          dettagliate su come costruire e installare nuovi blocchi di
          avvio.</p><p>Se la console seriale è configurata in qualche altra
          maniera invece di essere selezionata all'avvio con
          <code class="option">-h</code>, o se la console seriale usata dal kernel
          è differente da quella usata dal blocco di avvio, allora
          dovrai aggiungere anche le opzioni seguenti al file di
          configurazione del kernel e compilare un nuovo kernel:</p><pre class="programlisting">options CONSPEED=19200</pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-com2"></a>24.6.5.2. Utilizzo di una Porta Seriale Differente da
          <code class="filename">sio0</code> per la Console</h4></div></div></div><p>Usare una porta seriale differente da
          <code class="filename">sio0</code> come
          console richiede un po' di ricompilazione.  Se vuoi usare un'altra
          porta seriale per qualche motivo, ricompila il blocco di avvio, il
          loader ed il kernel come segue.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Ottieni i sorgenti del kernel.  (Guarda il <a class="xref" href="cutting-edge.html" title="Capitolo 23. Lo Stato dell'Arte">Capitolo 23, <em>Lo Stato dell'Arte</em></a>)</p></li><li class="step"><p>Modifica <code class="filename">/etc/make.conf</code> e imposta
              <code class="literal">BOOT_COMCONSOLE_PORT</code> all'indirizzo della
              porta che vuoi usare (0x3F8, 0x2F8, 0x3E8 o 0x2E8).  Solo
              i dispositivi da <code class="filename">sio0</code> a
              <code class="filename">sio3</code> (<code class="filename">COM1</code>
              a <code class="filename">COM4</code>) possono essere usati; le schede
              seriali multiporta non funzioneranno.  Non sono necessarie
              impostazioni per gli interrupt.</p></li><li class="step"><p>Crea un file di configurazione del kernel personalizzato e
              aggiungi i flag appropriati per la porta seriale che intendi
              usare.
              Ad esempio, se vuoi fare di <code class="filename">sio1</code>
              (<code class="filename">COM2</code>) la console:</p><pre class="programlisting">device sio1 at isa? port IO_COM2 flags 0x10 irq 3</pre><p>o</p><pre class="programlisting">device sio1 at isa? port IO_COM2 flags 0x30 irq 3</pre><p>I flag di console per le altre porte seriali non dovrebbero
              essere impostati.</p></li><li class="step"><p>Ricompila ed installa il blocco di avvio ed il loader:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /sys/boot</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make clean</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make install</code></strong></pre></li><li class="step"><p>Ricompila ed installa il kernel.</p></li><li class="step"><p>Scrivi il blocco di avvio sul disco di avvio con
              <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=disklabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">disklabel</span>(8)</span></a> ed avvia con il nuovo kernel.</p></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-ddb"></a>24.6.5.3. Accesso al Debugger DDB dalla Linea Seriale</h4></div></div></div><p>Se desideri entrare nel debugger del kernel dalla console seriale
          (utile per diagnostiche remote, ma anche molto pericoloso se generi
          un BREAK spurio sulla porta seriale!) allora dovrai compilare
          il tuo kernel con le opzioni seguenti:</p><pre class="programlisting">options BREAK_TO_DEBUGGER
options DDB</pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86577744"></a>24.6.5.4. Come Ottenere un Prompt di Login sulla Console Seriale</h4></div></div></div><p>Anche se questo non è necessario, potresti desiderare un
          prompt di <span class="emphasis"><em>login</em></span> sulla linea seriale, ora
          che puoi vedere i messaggi di avvio e puoi accedere a sessioni di
          debug del kernel attraverso la console seriale.
          Qui è spiegato come fare.</p><p>Apri il file <code class="filename">/etc/ttys</code> con un editor
          e trova queste linee:</p><pre class="programlisting">ttyd0 "/usr/libexec/getty std.9600" unknown off secure
ttyd1 "/usr/libexec/getty std.9600" unknown off secure
ttyd2 "/usr/libexec/getty std.9600" unknown off secure
ttyd3 "/usr/libexec/getty std.9600" unknown off secure</pre><p>I dispositivi da <code class="literal">ttyd0</code> a
          <code class="literal">ttyd3</code>
          corrispondono a <code class="filename">COM1</code> fino a
          <code class="filename">COM4</code>.  Cambia <code class="literal">off</code> a
          <code class="literal">on</code> per la porta desiderata.  Se hai cambiato la
          velocità della porta seriale, dovrai cambiare
          <code class="literal">std.9600</code> affinché corrisponda
          all'impostazione corrente, ad es. <code class="literal">std.19200</code>.</p><p>Potresti anche desiderare cambiare il tipo di terminale da
          <code class="literal">unknown</code> al tipo effettivo del tuo terminale
          seriale.</p><p>Dopo avere modificato il file, devi dare un <code class="command">kill -HUP
            1</code> affinché i cambiamenti abbiano effetto.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-loader"></a>24.6.6. Cambiamento della Console dal Loader</h3></div></div></div><p>Le sezioni precedenti hanno descritto come impostare la console
        seriale lavorando sul blocco di avvio.  Questa sezione mostra come
        specificare a console inserendo alcuni comandi ed alcune variabili
        di ambiente nel loader.  Quando il loader verrà invocato al terzo
        stadio del processo di avvio, dopo il blocco di avvio, le impostazioni
        nel loader prenderanno il posto di quelle nel blocco di avvio.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86595024"></a>24.6.6.1. Impostazione della Console Seriale</h4></div></div></div><p>Puoi facilmente specificare al loader ed al kernel di usare
          la console seriale scrivendo una sola riga in
          <code class="filename">/boot/loader.rc</code>:</p><pre class="programlisting">set console="comconsole"</pre><p>Ciò sarà efficace in ogni caso, qualunque siano le
          impostazioni nel blocco di avvio discusse nella sezione
          precedente.</p><p>Sarebbe meglio mettere la linea precedente come prima linea
          di <code class="filename">/boot/loader.rc</code> in modo da vedere
          i messaggi sulla console seriale il prima possibile.</p><p>Altrimenti, puoi specificare la console interna come:</p><pre class="programlisting">set console="vidconsole"</pre><p>Se non imposti la variabile di ambiente
         <code class="envar">console</code> del loader, quest'ultimo, e
          conseguentemente anche il kernel, useranno
          una console qualunque indicata dall'opzione
          <code class="option">-h</code> nel blocco di avvio.</p><p>Nelle versioni 3.2 o successive, è possibile specificare
          la console in
          <code class="filename">/boot/loader.conf.local</code> o
          <code class="filename">/boot/loader.conf</code>, piuttosto che in
          <code class="filename">/boot/loader.rc</code>.  Con questo metodo il tuo
          <code class="filename">/boot/loader.rc</code> dovrebbe apparire
          così:</p><pre class="programlisting">include /boot/loader.4th
start</pre><p>Poi, crea <code class="filename">/boot/loader.conf.local</code>  ed
          aggiungi lì la linea seguente.</p><pre class="programlisting">console=comconsole</pre><p>o</p><pre class="programlisting">console=vidconsole</pre><p>Guarda <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=loader.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">loader.conf</span>(5)</span></a> per maggiori informazioni.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Al momento il loader non ha un'opzione equivalente alla
            <code class="option">-P</code> del blocco di avvio, e non c'è
            possibilità di scegliere automaticamente la console interna e
            la console seriale basandosi sulla presenza di una tastiera.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86606800"></a>24.6.6.2. Utilizzo di una Porta Seriale Diversa da
          <code class="filename">sio0</code> per la Console</h4></div></div></div><p>Sarà necessario ricompilare il loader per usare una
          porta seriale differente da <code class="filename">sio0</code> per la
          console seriale.  Segui la procedura descritta nella <a class="xref" href="serialconsole-setup.html#serialconsole-com2" title="24.6.5.2. Utilizzo di una Porta Seriale Differente da sio0 per la Console">Sezione 24.6.5.2, «Utilizzo di una Porta Seriale Differente da
          <code class="filename">sio0</code> per la Console»</a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-caveats"></a>24.6.7. Avvertimento</h3></div></div></div><p>L'idea di tutto questo è di permettere alla gente di mettere
        su server dedicati che non abbiano bisogno di hardware grafico o di
        tastiere.  Sfortunatamente, mentre la maggior parte dei sistemi
        ti permetteranno di avviare senza tastiera, ce ne sono alcuni che
        non ti permetteranno di partire senza un adattatore grafico.
        Le macchine con BIOS AMI possono essere configurate per partire senza
        adattatori grafici cambiando semplicemente il valore di <span class="quote">«<span class="quote">graphics
          adapter</span>»</span> nella configurazione CMOS a <span class="quote">«<span class="quote">Not
          installed</span>»</span>.</p><p>Ad ogni modo, molte macchine non supportano questa opzione e si
        rifiuteranno di avviarsi se non si ha hardware grafico nel sistema.
        Con queste macchine, avrai bisogno di lasciare un qualche tipo di scheda
        grafica attaccata, (anche una scheda monocromatica di recupero) sebbene
        non avrai necessità di collegare un monitor.
        Potresti anche tentare di installare un BIOS AMI.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="dialout.html">Indietro</a> </td><td width="20%" align="center"><a accesskey="u" href="serialcomms.html">Risali</a></td><td width="40%" align="right"> <a accesskey="n" href="ppp-and-slip.html">Avanti</a></td></tr><tr><td width="40%" align="left" valign="top">24.5. Servizio di Effettuazione Chiamate </td><td width="20%" align="center"><a accesskey="h" href="index.html">Partenza</a></td><td width="40%" align="right" valign="top"> Capitolo 25. PPP e SLIP</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Questo, ed altri documenti, possono essere scaricati da
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Per domande su FreeBSD, leggi la
    <a href="http://www.FreeBSD.org/docs.html">documentazione</a> prima di contattare
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Per domande su questa documentazione, invia una e-mail a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>