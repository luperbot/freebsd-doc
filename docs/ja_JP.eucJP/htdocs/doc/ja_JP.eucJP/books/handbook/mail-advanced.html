<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>21.6. 先進的なトピックス</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD ハンドブック" /><link rel="up" href="mail.html" title="第21章 電子メール" /><link rel="prev" href="mail-trouble.html" title="21.5. トラブルシュート" /><link rel="next" href="SMTP-UUCP.html" title="21.7. UUCP とともに SMTP を使う" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">21.6. 先進的なトピックス</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mail-trouble.html">戻る</a>〓</td><th width="60%" align="center">第21章 電子メール</th><td width="20%" align="right">〓<a accesskey="n" href="SMTP-UUCP.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mail-advanced"></a>21.6. 先進的なトピックス</h2></div></div></div><p>これからのセクションでは、
      メールの設定やドメイン全体のためのメールの設定といったさらに突込んだ話題について触れます。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mail-config"></a>21.6.1. 基本事項</h3></div></div></div><a id="idp95137104" class="indexterm"></a><p>あなたのマシンに FreeBSD を普通にインストールして、
	<code class="filename">/etc/resolv.conf</code> ファイルを設定するか、
	またはネームサーバを走らせれば、
	他のホストへ電子メールを送ることができるようになります。
	あなたのホスト宛のメールをあなた自身の FreeBSD ホスト上の
	MTA (たとえば <span class="application">sendmail</span>)
	に配送するようにしたい場合には、次の二つの方法があります。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>自身でネームサーバーを実行し、
	    自分のドメインを持つ。例えば
	    <code class="systemitem">FreeBSD.org</code>。</p></li><li class="listitem"><p>あなたのホストへ直接メールが配送されるようにする。
	    これはメールがあなたのマシンの現在の
	    DNS 名に直接配送されるようにすることにより実現できます。
	    たとえば <code class="systemitem">example.FreeBSD.org</code>。</p></li></ul></div><a id="idp95146576" class="indexterm"></a><p>上のどちらを選ぶ場合でも、自分のホストに直接メールが配送されるようにするには恒久的で
	静的 な IP アドレス
	(ほとんどの PPP ダイアルアップ設定で用いられる動的なアドレスではなく)
	を持っていなければなりません。
	もしファイアウォールの中にいるならば、
	SMTP トラフィックが通過してくれないといけません。
	もし自分のホストでメールを直接受け取りたいならば、
	次の二つのうちのどちらかができていることを確認してください。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>自分のドメインでの
	    (一番値の小さい) MX レコード<a id="idp95148240" class="indexterm"></a>が自分のホストの
	    IP アドレスを差していることを確認する。</p></li><li class="listitem"><p>自分のドメインの中に自分のホスト用の
	    MX エントリがないことを確認する。</p></li></ul></div><p>上のどちらかが設定されていれば、
	自分のホストでメールを受け取ることができるでしょう。</p><p>次のコマンドを実行してみてください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>hostname</code></strong>
example.FreeBSD.org
<code class="prompt">#</code> <strong class="userinput"><code>host example.FreeBSD.org</code></strong>
example.FreeBSD.org has address 204.216.27.XX</pre><p>もしあなたのマシンが上記のメッセージだけを出力したならば、
	<code class="email">&lt;<a xmlns="" class="email" href="mailto:yourlogin@example.FreeBSD.org">yourlogin@example.FreeBSD.org</a>&gt;</code>
	へのメールは問題なく配送されるでしょう
	(<span class="application">sendmail</span> が
	<code class="systemitem">example.FreeBSD.org</code>
	上で正しく動作していると仮定します)。</p><p>上記のメッセージの代わりに、</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>host example.FreeBSD.org</code></strong>
example.FreeBSD.org has address 204.216.27.XX
example.FreeBSD.org mail is handled (pri=10) by hub.FreeBSD.org</pre><p>というメッセージが出力された場合は、
	あなたのホスト (<code class="systemitem">example.FreeBSD.org</code>)
	に宛てたメールは全て直接配送されずに <code class="systemitem">hub</code>
	上の同じユーザー名に配送されます。</p><p>上の情報は DNS サーバーが扱います。
	メールルーティング情報をもつ DNS レコードは、
	<span class="emphasis"><em>M</em></span>ail e<span class="emphasis"><em>X</em></span>change エントリーです。
	MX エントリが存在しない場合には、IP アドレスにしたがって、
	直接宛先ホストに配送されます。</p><p><code class="systemitem">freefall.FreeBSD.org</code>
	の現時点での MX エントリは、次のようになっています。</p><pre class="programlisting">freefall		MX	30	mail.crl.net
freefall		MX	40	agora.rdrop.com
freefall		MX	10	freefall.FreeBSD.org
freefall		MX	20	who.cdrom.com</pre><p><code class="systemitem">freefall</code> は多くの MX エントリを持っています。
	一番 MX の値の小さいホストが利用可能な場合は直接メールを受け取ります。
	もしなにかの理由でアクセスができない時には、
	他のホスト (ときどき <span class="quote">「<span class="quote">バックアップ MX</span>」</span> と呼ばれます)
	が一時的にメールを受け取ります。そして、
	より値の小さいホストが利用可能になったときにメールを渡し、
	最終的に一番値の小さいホストに渡ります。</p><p>使い勝手をよくするためには、代替の MX サイトは、それぞれ
	別の経路でインターネットへ接続しているとよいでしょう。
	インターネットプロバイダまたは他の関連サイトが、このサービスを
	提供することができます。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mail-domain"></a>21.6.2. あなたのドメインに対するメール設定</h3></div></div></div><p><span class="quote">「<span class="quote">メールホスト</span>」</span> (メールサーバーとしても知られています)
	をセットアップするためには、
	いろいろなワークステーションに宛てた全てのメールを受ける必要があります。
	基本的には、あなたのドメイン内 (この場合だと
	<code class="systemitem">*.FreeBSD.org</code>)
	のすべてのホスト名宛てのすべてのメールを <span class="quote">「<span class="quote">受け取って</span>」</span>、
	そのメールをあなたのメールサーバーに配送し、
	ユーザーがマスタメールサーバ上でメールをチェックできるようにします。</p><a id="idp95163856" class="indexterm"></a><p>話を簡単にするために、あるユーザーのアカウントはどのマシンでも同じ<span class="emphasis"><em>ユーザー名</em></span>にすべきです。
	そのためには <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=adduser&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">adduser</span>(8)</span></a> を使ってください。</p><p>使用する予定のメールホストは、
	各ワークステーションごとにメール交換が
	できるように設定されていなければなりません。
	これは DNS の設定で次のように行なうことができます。</p><pre class="programlisting">example.FreeBSD.org	A	204.216.27.XX		; ワークステーション
MX	10 hub.FreeBSD.org	; メールホスト</pre><p>これは、ワークステーションの A レコードがどこを指していようとも
	そのワークステーション宛てのメールをメールホストに転送する、というものです。</p><p>自前で DNS サーバを運用しているのでなければ、
	この作業は自分では行えません。自分で DNS
	サーバを運用しないとかできないという場合は、
	あなたの DNS を提供しているインターネットプロバイダなどに依頼して
	作業を行ってもらってください。</p><p>もしバーチャル電子メールホストを運用するなら次の情報が役に立つでしょう。
	例として、あなたには自分のドメイン、ここでは
	<code class="systemitem">customer1.org</code>、
	を持っている顧客がいるとしましょう。
	あなたは <code class="systemitem">customer1.org</code> 宛ての全てのメールを
	<code class="systemitem">mail.myhost.com</code> というメールホストに集めたいとします。
	DNS エントリーは次のようになるでしょう。</p><pre class="programlisting">customer1.org		MX	10 mail.myhost.com</pre><p><code class="systemitem">customer1.org</code>
	に対して電子メールを送りたいだけなら、
	A レコードは必要<span class="emphasis"><em>ありません</em></span>。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="systemitem">customer1.org</code>
	  に対して ping を実行しても、
	  A レコードが存在しない限りうまくいかないことに留意しておいてください。</p></div><p>やらなければいけない最後のことは、
	メールホスト上の <span class="application">sendmail</span>
	に対してどんなドメインやホスト宛のメールを受け取るのか、
	を教えることです。いくつかの方法がありますが次のどちらかでいいでしょう。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">FEATURE(use_cw_file)</code> を使っているなら、
	    <code class="filename">/etc/mail/local-host-names</code>
	    ファイルにホストを加えます。
	    もし <span class="application">sendmail</span> のバージョンが
	    8.10 より前であれば該当ファイルは
	    <code class="filename">/etc/sendmail.cw</code> です。</p></li><li class="listitem"><p><code class="filename">/etc/sendmail.cf</code> もしくは
	    <span class="application">sendmail</span> 8.10 以降なら
	    <code class="filename">/etc/mail/sendmail.cf</code>
	    といったファイルに <code class="literal">Cwyour.host.com</code> という行を加えます。</p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail-trouble.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="mail.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="SMTP-UUCP.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">21.5. トラブルシュート〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓21.7. UUCP とともに SMTP を使う</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>