<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>5.5. Ports Collection の利用</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD ハンドブック" /><link rel="up" href="ports.html" title="第5章 アプリケーションのインストール - packages と ports" /><link rel="prev" href="pkgng-intro.html" title="5.4. pkg によるバイナリ package の管理" /><link rel="next" href="ports-poudriere.html" title="5.6. Poudriere を用いた package の構築" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.5. Ports Collection の利用</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="pkgng-intro.html">戻る</a>〓</td><th width="60%" align="center">第5章 アプリケーションのインストール - packages と ports</th><td width="20%" align="right">〓<a accesskey="n" href="ports-poudriere.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="ports-using"></a>5.5. Ports Collection の利用</h2></div></div></div><p>Ports Collection とは、<code class="filename">/usr/ports</code>
      以下に置かれる <code class="filename">Makefile</code>, 修正パッチ、
      説明文などの一連のファイルのことです。このファイルのセットは、
      アプリケーションをコンパイルして FreeBSD
      にインストールするのに用いられます。
      port を用いてアプリケーションをコンパイルできるようにするには、
      まず最初に Ports Collection をインストールする必要があります。
      FreeBSD のインストール時に Ports Collection をインストールしなかった場合に、
      以下の方法のどれかを用いてインストールしてください。</p><div class="procedure"><a id="ports-using-portsnap-method"></a><div class="procedure-title">手順5.1 Portsnap を利用する方法</div><p>FreeBSD のベースシステムには、<span class="application">Portsnap</span>
	が含まれています。
	これはは Ports Collection
	を取得するための速くて使いやすく、
	多くのユーザに推奨されるツールです。
	このユーティリティは、FreeBSD のサイトに接続し、セキュリティキーを検証し、
	Ports Collection の最新版をダウンロードします。
	セキュリティキーは、
	ダウンロードしたすべてのファイルの検証に用いられます。</p><ol class="procedure" type="1"><li class="step"><p>圧縮された Ports Collection のスナップショットを
	  <code class="filename">/var/db/portsnap</code>
	  にダウンロードするには以下を実行してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portsnap fetch</code></strong></pre></li><li class="step"><p>初めて <span class="application">Portsnap</span> を使う時は、
	  スナップショットをまず <code class="filename">/usr/ports</code>
	  に展開してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portsnap extract</code></strong></pre></li><li class="step"><p>上で示した <span class="application">Portsnap</span>
	  を初めて利用する際に行うコマンドを実行した後は、
	  以下のコマンドで
	  <code class="filename">/usr/ports</code>
	  をアップデートしてください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portsnap fetch</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>portsnap update</code></strong></pre><p><code class="literal">fetch</code> を使う場合には、以下のよう
	  <code class="literal">extract</code> または <code class="literal">update</code>
	  を連続して行うことができます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portsnap fetch update</code></strong></pre></li></ol></div><div class="procedure"><a id="ports-using-subversion-method"></a><div class="procedure-title">手順5.2 Subversion を用いる方法</div><p>ports ツリーの管理が必要な場合や、
	ローカルで変更点をメンテナンスする必要がある場合には、
	<span class="application">Subversion</span> を使って
	Ports Collection を取得する方法があります。
	<span class="application">Subversion</span> のより詳細な説明については、
	<a class="link" href="../../../../doc/en_US.ISO8859-1/articles/committers-guide/subversion-primer.html" target="_top">
	Subversion Primer</a> を参照してください。</p><ol class="procedure" type="1"><li class="step"><p><span class="application">Subversion</span>
	  を使って ports ツリーをチェックアウトする前に、
	  <span class="application">Subversion</span>
	  をインストールしておく必要があります。
	  ports ツリーがすでにインストールされていれば、
	  以下のようにして <span class="application">Subversion</span>
	  をインストールできます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/ports/devel/subversion</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make install clean</code></strong></pre><p>ports ツリーが利用できない場合や、
	  package の管理に <span class="application">pkg</span>
	  を使っているのであれば、package から
	  <span class="application">Subversion</span> をインストールできます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pkg install subversion</code></strong></pre></li><li class="step"><p>ports ツリーをチェックアウトしてください。
	  パフォーマンスを良くするため、
	  <em class="replaceable"><code>svn0.us-east.FreeBSD.org</code></em>
	  を
	  <a class="link" href="svn.html#svn-mirrors" title="A.4.4. Subversion ミラーサイト">Subversion
	   ミラー</a>
	  の中から地理的に近い場所にあるミラーに置き換えてください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>svn checkout https://<em class="replaceable"><code>svn0.us-east.FreeBSD.org</code></em>/ports/head /usr/ports</code></strong></pre></li><li class="step"><p><span class="application">Subversion</span>
	  で最初のチェックアウトを行ったら、必要に応じて
	  <code class="filename">/usr/ports</code>
	  をアップデートしてください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>svn update /usr/ports</code></strong></pre></li></ol></div><p>Ports Collection
      はソフトウェアのカテゴリを表すディレクトリを持ち、
      各カテゴリには、各アプリケーションのサブディレクトリがあります。
      ports スケルトンとも呼ばれる各サブディレクトリには、
      プログラムを FreeBSD
      上で正しくコンパイルしてインストールする方法を提供するファイルのセットが含まれています。
      それぞれの port スケルトンには、
      次のファイルおよびディレクトリが含まれています。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">Makefile</code>:
	  このファイルにはアプリケーションのコンパイル方法やシステムのどこにインストールするかを指定する命令文が含まれています。</p></li><li class="listitem"><p><code class="filename">distinfo</code>:
	  このファイルには、その port
	  を構築するためにダウンロードする必要があるファイルのファイル名と、
	  チェックサム情報が含まれています。</p></li><li class="listitem"><p><code class="filename">files</code>:
	  このディレクトリには FreeBSD 上でプログラムをコンパイルし、
	  インストールするための修正パッチが含まれています。
	  このディレクトリには、その port
	  の構築に必要なその他のファイルが入る場合もあります。</p></li><li class="listitem"><p><code class="filename">pkg-descr</code>:
	  このファイルにはプログラムに関する、
	  より詳しい説明文が含まれます。</p></li><li class="listitem"><p><code class="filename">pkg-plist</code>:
	  これは、その port によってインストールされる全ファイルのリストです。
	  これにはプログラムを削除する際に、
	  どのファイルを削除すれば良いのかを ports
	  システムに伝える役割もあります。</p></li></ul></div><p>これらの他に <code class="filename">pkg-message</code>
      や特殊な状況に対応するためのファイルを含む ports もあります。
      これらのファイルについての詳細および
      ports の一般的な説明については、
      <a class="link" href="../../../../doc/ja_JP.eucJP/books/porters-handbook/index.html" target="_top">port
      作成者のためのハンドブック</a> をご覧下さい。</p><p>port は実際のソースコード
      (<code class="filename">distfile</code> とも呼ばれます)
      を含んではいません。
      port の構築の展開部で、ダウンロードされたソースは自動的に <code class="filename">/usr/ports/distfiles</code>
      に保存されます。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ports-skeleton"></a>5.5.1. ports のインストール</h3></div></div></div><a id="idp83644496" class="indexterm"></a><p>この節では、Ports Collection
	を利用してプログラムをインストールしたり、
	システムから削除したりする基本的な手順について説明します。
	利用可能な <code class="command">make</code>
	のターゲットや環境変数についての詳細は
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ports&amp;sektion=7"><span class="citerefentry"><span class="refentrytitle">ports</span>(7)</span></a> をご覧ください。</p><div xmlns="" class="warning"><h3 class="admontitle">警告: </h3><p xmlns="http://www.w3.org/1999/xhtml">いかなる port でも、構築する前には、
	  前節に書かれているように、Ports Collection
	  をアップデートしてください。
	  サードパーティ製のソフトウェアをインストールすると、
	  セキュリティの脆弱性を引き起こす可能性があります。
	  その port に関連したセキュリティ上の問題がないことを、まずは
	  <a class="link" href="http://vuxml.freebsd.org/" target="_top">http://vuxml.freebsd.org/</a>
	  で確認してください。または、
	  新しい port をインストールする前に、
	  <code class="command">pkg audit -F</code> を実行してください。
	  毎日のシステムのセキュリティ確認時に、
	  自動的にセキュリティの検査およびデータベースの更新を行うようにこのコマンドを設定できます。
	  詳しくは、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg-audit&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pkg-audit</span>(8)</span></a> および
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=periodic&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">periodic</span>(8)</span></a> を参照してください。</p></div><p>Ports Collection は、ネットワークに接続できることを想定しています。
	また、superuser の権限も必要となります。</p><p><a class="link" href="http://www.freebsdmall.com/" target="_top">freebsdmaill.com</a>
	の FreeBSD Toolkit のようなサードパーティ製の DVD-ROM
	製品の中には distfiles を収録しているものがあります。
	これらを使うとインターネットへの接続がなくても
	ports をインストールするのに使うことができます。
	DVD を <code class="filename">/cdrom</code>
	にマウントしてください。
	ほかのマウントポイントを使用したければ、
	<code class="varname">CD_MOUNTPTS</code> 変数を設定してください。
	ディスク上に必要な distfiles が存在すると、
	自動的に利用されます。port には DVD
	への収録を許可しないライセンス条項を持つものがあります。
	これにはダウンロード前に登録を必要としたり、
	再配布が禁止されているという理由があります。
	DVD に含まれていない port をインストールしたい場合には、
	ネットワークに接続する必要があります。</p><p>port をコンパイルしてインストールするには、
	インストールしたい port のディレクトリに移動してください。
	その後、プロンプトから
	<code class="command">make install</code> と入力してください。
	すると、次のような出力が現われるはずです。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/ports/sysutils/lsof</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make install</code></strong>
&gt;&gt; lsof_4.88D.freebsd.tar.gz doesn't seem to exist in /usr/ports/distfiles/.
&gt;&gt; Attempting to fetch from ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/.
===&gt;  Extracting for lsof-4.88
...
[extraction output snipped]
...
&gt;&gt; Checksum OK for lsof_4.88D.freebsd.tar.gz.
===&gt;  Patching for lsof-4.88.d,8
===&gt;  Applying FreeBSD patches for lsof-4.88.d,8
===&gt;  Configuring for lsof-4.88.d,8
...
[configure output snipped]
...
===&gt;  Building for lsof-4.88.d,8
...
[compilation output snipped]
...
===&gt;  Installing for lsof-4.88.d,8

===&gt;  Installing for lsof-4.88.d,8
...
[installation output snipped]
...
===&gt;   Generating temporary packing list
===&gt;   Compressing manual pages for lsof-4.88.d,8
===&gt;   Registering installation for lsof-4.88.d,8
===&gt;  SECURITY NOTE:
      This port has installed the following binaries which execute with
      increased privileges.
/usr/local/sbin/lsof
<code class="prompt">#</code></pre><p><code class="command">lsof</code> は高い権限で動作するプログラムなので、
	インストールする時にセキュリティに関する警告が表示されます。
	インストールが終わったら、プロンプトが戻ります。</p><p>シェルによってはコマンドの実行ファイルを探す時間を短縮するために、
	環境変数 <code class="envar">PATH</code> に登録されている
	ディレクトリのコマンド一覧をキャッシュするものがあります。
	<code class="command">tcsh</code> シェルを使っているのであれば、
	フルパスを指定することなく新しくインストールしたコマンドを利用できるように、
	<code class="command">rehash</code> を実行してください。
	<code class="command">sh</code> シェルを使っているのであれば
 	かわりに <code class="command">hash -r</code> を実行してください。
	詳細については、
	あなたの使っているシェルのドキュメントをご覧ください。</p><p>インストールの間に、作業用ディレクトリが作成されます。
	このディレクトリにはコンパイル時に使用されるすべての一時ファイルが含まれています。
	このディレクトリを削除することで、ディスク容量を節約でき、また port
	を新しいバージョンへアップデートする際に問題が起こる可能性を小さくします。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make clean</code></strong>
===&gt;  Cleaning for lsof-88.d,8
<code class="prompt">#</code></pre><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">port を構築する際に、
	  <code class="command">make install clean</code>
	  と実行することで、
	  これらの余分な手順を省くことができます。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp83710672"></a>5.5.1.1. ports のインストールのカスタマイズ</h4></div></div></div><p>ports の中にはビルドオプションを指定できるものがあります。
	  このオプションを指定することで、
	  アプリケーションの機能の一部を有効もしくは無効にできます。
	  また、セキュリティオプションを設定したり、
	  その他のカスタマイズを行うことができます。
	  このようなアプリケーションには
	  <code class="filename">www/firefox</code>,
	  <code class="filename">security/gpgme</code> や
	  <code class="filename">mail/sylpheed-claws</code>
	  などがあります。
	  port が他のカスタマイズ可能なオプションを持つ ports
	  に依存する場合には、デフォルトでは、ユーザに port
	  のオプションをメニューから選択させる設定のため、
	  何度もユーザとの対話が起こり待たされることがあります。
	  これを避けるには、まず最初に port スケルトンで
	  <code class="command">make config-recursive</code>
	  を実行して設定を一括で行い、その後
	  <code class="command">make install [clean]</code>
	  を実行して port を構築してインストールしてください。</p><div xmlns="" class="tip"><h3 class="admontitle">ヒント: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="buildtarget">config-recursive</code> を実行する際、
	    <code class="buildtarget">all-depends-list</code>
	    を実行すると、設定すべき ports の一覧を得ることができます。
	    多くの場合は、すべての依存 ports のオプションが定義され、
	    ports オプションの画面が表示されなくなり、
	    すべてのオプションが設定されたことを確認できるまで
	    <code class="command">make config-recursive</code>
	    を実行すると良いでしょう。</p></div><p>port の構築後、
	  再びこのメニューを表示させてオプションの追加や削除、
	  設定の変更を行う方法はたくさんあります。
	  一つ目は port のディレクトリに <code class="command">cd</code> で移動し、
	  <code class="command">make	config</code>
	  と入力する方法です。
	  別の方法は <code class="command">make showconfig</code>
	  を使う方法です。
	  他の方法は <code class="command">make rmconfig</code>
	  の実行です。
	  このコマンドを実行すると選択されているすべてのオプションが削除され、
	  設定をもう一度やり直すことができます。
	  これらの方法や他の方法についての詳細は、
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ports&amp;sektion=7"><span class="citerefentry"><span class="refentrytitle">ports</span>(7)</span></a> マニュアルで説明されています。</p><p>ports は、いくつかの環境変数を参照する <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fetch&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">fetch</span>(1)</span></a>
	  を用いてソースファイルをダウンロードします。
	  FreeBSD システムがファイアウォールの内側であったり、
	  FTP/HTTP プロキシを使う場合には、
	  <code class="envar">FTP_PASSIVE_MODE</code>,
	  <code class="envar">FTP_PROXY</code>, <code class="envar">FTP_PASSWORD</code>
	  の環境変数を設定することなります。
	  対応している環境変数の一覧については
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fetch&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">fetch</span>(3)</span></a> をご覧ください。</p><p>インターネットに常時接続できないユーザのために
	  <code class="command">make fetch</code>
	  コマンドが用意されています。
	  このコマンドを
	  <code class="filename">/usr/ports</code>
	  で実行してすべての distfiles をダウンロードするか、
	  <code class="filename">/usr/ports/net</code>
	  といったカテゴリや、あるスケルトンにおいても実行できます。
	  ある port がライブラリやその他の ports に依存している場合には、
	  別のカテゴリの ports の distfiles
	  はダウンロードされ<span class="emphasis"><em>ない</em></span>ことに注意してください。
	  port が依存しているすべての distfiles をダウンロードしたければ、
	  <code class="command">make fetch-recursive</code>
	  を使ってください。</p><p>めったにないことかもしれませんが、
	  ローカルに distfiles のリポジトリがあるような場合に、
	  <code class="varname">MASTER_SITES</code> 変数を変更することで
	  <code class="filename">Makefile</code> で指定されているダウンロードの場所を
	  変更することができます。
	  設定する場合には、変更先を以下のようにして指定してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/ports/<em class="replaceable"><code>directory</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make MASTER_SITE_OVERRIDE= \
<em class="replaceable"><code>ftp://ftp.organization.org/pub/FreeBSD/ports/distfiles/</code></em> fetch</code></strong></pre><p><code class="varname">WRKDIRPREFIX</code> 変数と
	  <code class="varname">PREFIX</code> 変数を変更することで、
	  作業ディレクトリやターゲットディレクトリをデフォルトのものから変更できます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make WRKDIRPREFIX=/usr/home/example/ports install</code></strong></pre><p>とすると、ports は <code class="filename">/usr/home/example/ports</code>
	  でコンパイルされ、すべて <code class="filename">/usr/local</code>
	  以下にインストールされます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make PREFIX=/usr/home/example/local install</code></strong></pre><p>この場合、port のコンパイルは <code class="filename">/usr/ports</code>
	  でおこない、<code class="filename">/usr/home/example/local</code>
	  にインストールします。そして</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make WRKDIRPREFIX=../ports PREFIX=../local install</code></strong></pre><p>とすれば両者を組み合わせることが可能です。</p><p>これらを環境変数に設定する方法もあります。
	  どのように環境変数を設定するかについては、
	  あなたの使っているシェルのマニュアルページを参照してください。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ports-removing"></a>5.5.2. インストールした ports の削除</h3></div></div></div><a id="idp83756880" class="indexterm"></a><p>インストールされた ports は、
	<code class="command">pkg delete</code> コマンドで削除できます。
	このコマンドの使用例は、<a class="xref" href="pkgng-intro.html" title="5.4. pkg によるバイナリ package の管理">「<span class="application">pkg</span> によるバイナリ
      package の管理」</a> にあります。</p><p>あるいは、port のディレクトリにて
	<code class="command">make deinstall</code> を実行することでも削除できます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/ports/sysutils/lsof</code></strong>
<strong class="userinput"><code>make deinstall</code></strong>
===&gt;  Deinstalling for sysutils/lsof
===&gt;   Deinstalling
Deinstallation has been requested for the following 1 packages:

	lsof-4.88.d,8

The deinstallation will free 229 kB
[1/1] Deleting lsof-4.88.d,8... done</pre><p>port が削除されるときに表示されるメッセージを読むことをお勧めします。
	もし削除した port に依存するアプリケーションがあった場合には、
	その情報が表示されますが、port の削除は行われます。
	そのようなケースでは、依存を直すためにアプリケーションを再インストールするとよいでしょう。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ports-upgrading"></a>5.5.3. ports のアップグレード</h3></div></div></div><a id="idp83766864" class="indexterm"></a><p>ports のインストール後、時間が経過すると、Ports Collection
	で新しいバージョンのソフトウェアを利用できるようになります。
	この章では、
	どのようにしてアップグレードする必要のあるソフトウェアを判断するか、
	そしてアップグレードの方法について説明します。</p><p>インストールされている ports
	の新しいバージョンを利用できるかどうかを知るには、まず、
	最新の ports ツリーがインストールされていることを確認してください。
	これには、<a class="xref" href="ports-using.html#ports-using-portsnap-method" title="手順5.1 Portsnap を利用する方法">手順5.1「Portsnap を利用する方法」</a> もしくは
	<a class="xref" href="ports-using.html#ports-using-subversion-method" title="手順5.2 Subversion を用いる方法">手順5.2「Subversion を用いる方法」</a>
	で書かれているアップデートのコマンドを使ってください。
	FreeBSD 10 以降のシステム、または、<span class="application">pkg</span>
	に変換されたシステムでは、
	以下のコマンドを実行すると、現在利用可能なバージョンよりも古い
	ports の一覧が表示されます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pkg version -l "&lt;"</code></strong></pre><p>FreeBSD 9.<em class="replaceable"><code>X</code></em> より前のシステムでは、
	現在利用可能なバージョンよりも古い
	ports の一覧を表示されるには、以下のコマンドを実行してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pkg_version -l "&lt;"</code></strong></pre><div xmlns="" class="important"><h3 class="admontitle">重要: </h3><p xmlns="http://www.w3.org/1999/xhtml">アップグレードする前に
	  <code class="filename">/usr/ports/UPDATING</code>
	  を、ファイルの頭から、ports を最後にアップデートした日、
	  もしくはシステムをインストールをした日に最も近い日まで目を通してください
	  このファイルには
	  port をアップグレードする際にユーザが遭遇するであろう問題や、
	  追加で必要な作業などが記述されています。
	  例えば、ファイル形式の変更や設定ファイルの場所の変更、
	  前のバージョンと互換性がなくなったことなどが書かれています。
	  アップグレードする必要のある ports に関連した手順に注意し、
	  アップグレードする際にはこれらの手順に従ってください。</p></div><p>実際にアップグレードを行うには、
	<span class="application">Portmaster</span> もしくは
	<span class="application">Portupgrade</span> を使ってください。</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="portmaster"></a>5.5.3.1. <span class="application">portmaster</span>
	  を用いた ports のアップグレード</h4></div></div></div><a id="idp83775952" class="indexterm"></a><p><a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/portmaster/pkg-descr">ports-mgmt/portmaster</a> package または port は、
	  FreeBSD と共にインストールされているツールだけを使うので、
	  インストールされている ports のアップグレードに推奨されているツールです。
	  <span class="application">portmaster</span> は、
	  他の ports に依存せずに、<span class="quote">「<span class="quote">base</span>」</span>
	  システムのツールのみを使うように設計されています。
	  このアプリケーションは、
	  どの ports をアップグレードすべきかの判断を、
	  <code class="filename">/var/db/pkg/</code> の情報を使って行います。port
	  からこのユーティリティをインストールするには以下のようにしてください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/ports/ports-mgmt/portmaster</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make install clean</code></strong></pre><p><span class="application">Portmaster</span> は、
	  ports を 4 つのカテゴリに分類します。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Root ports: 他の port に依存せず、
	      他の port からも依存されない ports。</p></li><li class="listitem"><p>Trunk ports: 他の port には依存しないが、
	      他の port から依存されている ports。</p></li><li class="listitem"><p>Branch ports: 他の port に依存し、
	      他の port からも依存されている ports。</p></li><li class="listitem"><p>Leaf ports: 他の port に依存するが、
	      他の port からは依存されない ports。</p></li></ul></div><p>これらのカテゴリの一覧や、アップデート可能な
	  port の一覧を表示するには以下のようにしてください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portmaster -L</code></strong>
===&gt;&gt;&gt; Root ports (No dependencies, not depended on)
===&gt;&gt;&gt; ispell-3.2.06_18
===&gt;&gt;&gt; screen-4.0.3
        ===&gt;&gt;&gt; New version available: screen-4.0.3_1
===&gt;&gt;&gt; tcpflow-0.21_1
===&gt;&gt;&gt; 7 root ports
...
===&gt;&gt;&gt; Branch ports (Have dependencies, are depended on)
===&gt;&gt;&gt; apache22-2.2.3
        ===&gt;&gt;&gt; New version available: apache22-2.2.8
...
===&gt;&gt;&gt; Leaf ports (Have dependencies, not depended on)
===&gt;&gt;&gt; automake-1.9.6_2
===&gt;&gt;&gt; bash-3.1.17
        ===&gt;&gt;&gt; New version available: bash-3.2.33
...
===&gt;&gt;&gt; 32 leaf ports

===&gt;&gt;&gt; 137 total installed ports
        ===&gt;&gt;&gt; 83 have new versions available</pre><p>以下のコマンドを使うと、
	  古くなった ports をすべてアップデートします。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portmaster -a</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><span class="application">Portmaster</span> のデフォルトの設定では、
	  インストールされている port を削除する前にバックアップ用の
	  package が作成されます。
	  このバックアップは、
	  新しいバージョンのインストールに成功すると削除されます。
	  <code class="option">-b</code> を使うと、
	  <span class="application">Portmaster</span>
	  の自動的なバックアップの削除は行いません。
	  <code class="option">-i</code> を追加すると、
	  <span class="application">Portmaster</span> をインタラクティブモードで使用できます。
	  このモードでは、各 port
	  をアップグレードするかどうかの選択を対話的に行うことがでます。
	  多くのオプションが利用可能です。portmaster(8) のマニュアルページから、
	  それらの使用方法に関する詳細な説明を読んでください。</p></div><p>アップグレードの過程でエラーに遭遇した場合には、
	  <code class="option">-f</code> を使ってすべての
	  ports のアップグレードや再構築を行なってください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portmaster -af</code></strong></pre><p><span class="application">Portmaster</span>
	  を使ってシステムに新しい ports をインストールしたり、
	  新しい port のコンパイルやインストール前に依存するすべての
	  port をアップグレードできます。この機能を使う時には、
	  Ports Collection の場所を指定してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portmaster <em class="replaceable"><code>shells/bash</code></em></code></strong></pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="portupgrade"></a>5.5.3.2. Portupgrade を用いた ports のアップグレード</h4></div></div></div><a id="idp83798352" class="indexterm"></a><p><span class="application">Portupgrade</span> は、
	  インストールした ports
	  のアップグレードを行なうためのもう一つのユーティリティです。
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/portupgrade/pkg-descr">ports-mgmt/portupgrade</a>
	  package または port から利用できます。
	  このユーティリティは ports
	  を管理するために用いられるアプリケーションをインストールします。
	  Ruby に依存します。
	  port をインストールするには、以下を実行してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/ports/ports-mgmt/portupgrade</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make install clean</code></strong></pre><p>このユーティリティを使ってアップグレードを行う前に、
	  <code class="command">pkgdb -F</code> を使って、
	  インストールされている ports の一覧を調べてください。
	  矛盾が検出された場合には修復してください。</p><p>システムにインストールされている port
	  の中で古くなったものをすべてアップデートするには
	  <code class="command">portupgrade -a</code> を実行してください。
	  もし、すべての ports
	  に対して個別にアップグレードするかどうかを確認したいのであれば、
	  <code class="option">-i</code> を追加してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portupgrade -ai</code></strong></pre><p>ports で利用可能なすべてのアプリケーションではなく、
	  ある特定のアプリケーションだけを更新したいのであれば、
	  <code class="command">portupgrade <em class="replaceable"><code>pkgname</code></em></code>
	  を実行してください。
	  アップグレードするアプリケーションが依存しているすべての
	  ports をまず先に更新したい場合には、
	  <code class="option">-R</code> を使ってください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portupgrade -R firefox</code></strong></pre><p><code class="option">-P</code> オプションを使うと、
	  <span class="application">portupgrade</span> は
	  <code class="envar">PKG_PATH</code> に登録されているローカルディレクトリから、
	  利用可能な package を探します。
	  ローカルに利用可能な packages が見つからなければ、
	  リモートサイトから package のダウンロードを試みます。
	  packages をローカルに見つけることができず、
	  リモートサイトからもダウンロードできない場合には、
	  <span class="application">portupgrade</span>
	  は ports からインストールを行ないます。
	  ports を使用したくなければ、<code class="option">-PP</code>
	  オプションを指定してください。
	  この最後のオプションを設定すると、
	  もし package が利用できなければ
	  <span class="application">Portupgrade</span> は終了します。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portupgrade -PP gnome2</code></strong></pre><p>また、ビルドやインストールを行なわず、
	distfiles または packages だけをダウンロードしたければ、
	<code class="option">-F</code> オプションを指定してください。
	利用可能なすべてのオプションについては、
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=portupgrade&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">portupgrade</span>(1)</span></a> のマニュアルを参照してください。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ports-disk-space"></a>5.5.4. ports とディスク容量</h3></div></div></div><a id="idp83825616" class="indexterm"></a><p>Ports Collection を使い続けていると、
	そのうちディスクを食いつぶしてしまうでしょう。
	ports をビルドしてインストールした後、
	ports スケルトンで <code class="command">make clean</code>
	を実行すると、作業用の <code class="filename">work</code>
	ディレクトリを削除します。
	<span class="application">Portmaster</span> を使って port
	をインストールする場合には、<code class="option">-K</code>
	を使わなければこのディレクトリは自動的に削除されます。
	<span class="application">Portupgrade</span>
	がインストールされている場合には、
	以下のコマンドはローカルの Ports Collection
	に見つかったすべての <code class="filename">work</code>
	ディレクトリを削除します。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portsclean -C</code></strong></pre><p>さらに、時間が経つにつれ
	<code class="filename">/usr/ports/distfiles</code>
	には、古くなったソースファイルがたまっていきます。
	<span class="application">Portupgrade</span>
	がインストールされている場合には、
	次のコマンドで、どの ports からも使われていない
	distfiles を削除できます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portsclean -D</code></strong></pre><p><span class="application">Portupgrade</span>
	を使って、システムにインストールされている port から使われていない
	distfiles をすべて削除するには、以下のコマンドを使ってください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portsclean -DD</code></strong></pre><p>もし <span class="application">Portmaster</span>
	がインストールされているのであれば、以下を実行してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portmaster --clean-distfiles</code></strong></pre><p>デフォルトでは、このコマンドはインタラクティブに設定されているため、
	ユーザに対して distfile
	を削除すべきかどうかを確認するプロンプトが表示されます。</p><p>これらのコマンドに加え、<code class="filename">ports-mgmt/pkg_cutleaves</code>
	package または port は、
	必要なくなった ports を削除する作業を自動化します。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="pkgng-intro.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="ports.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="ports-poudriere.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">5.4. <span class="application">pkg</span> によるバイナリ
      package の管理〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓5.6. <span class="application">Poudriere</span> を用いた
      package の構築</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>