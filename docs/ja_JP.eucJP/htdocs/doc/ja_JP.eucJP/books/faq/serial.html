<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>第11章 シリアル接続</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 2.X、3.X、4.X についての FAQ (よくある質問とその答え)" /><link rel="up" href="index.html" title="FreeBSD 2.X、3.X、4.X についての FAQ (よくある質問とその答え)" /><link rel="prev" href="ppp.html" title="第10章 PPP" /><link rel="next" href="misc.html" title="第12章 その他の質問" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第11章 シリアル接続</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ppp.html">戻る</a>〓</td><th width="60%" align="center">〓</th><td width="20%" align="right">〓<a accesskey="n" href="misc.html">次へ</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serial"></a>第11章 シリアル接続</h1></div></div></div><p>
      <span class="emphasis"><em>訳:
        一宮 亮 <code class="email">&lt;<a xmlns="" class="email" href="mailto:ryo@azusa.shinshu-u.ac.jp">ryo@azusa.shinshu-u.ac.jp</a>&gt;</code>、
        1997 年 11 月 16 日</em></span>
    </p><p>
      このセクションでは、FreeBSD でシリアル接続をする時の一般的な質問に答えます。
      <acronym class="acronym">PPP</acronym> および
      <acronym class="acronym">SLIP</acronym> については、
      <a class="xref" href="networking.html" title="第9章 ネットワーキング">9章<em>ネットワーキング</em></a>のセクションを参照してください。
    </p><div class="qandaset"><a id="idp82771152"></a><dl><dt>11.1. <a href="serial.html#idp82771408">どうやったら FreeBSD がシリアルポートを認識したことを知る事ができますか?</a></dt><dt>11.2. <a href="serial.html#idp82776784">
            どうやったら FreeBSD がモデムカードを認識したことを知ることができますか?</a></dt><dt>11.3. <a href="serial.html#idp82778832">FreeBSD 2.0.5 にアップグレードしたら
	    tty0X
            が見つからなくなってしまったのですが</a></dt><dt>11.4. <a href="serial.html#idp82781648">どうやったら FreeBSD でシリアルポートにアクセスできますか?</a></dt><dt>11.5. <a href="serial.html#idp82789968">マルチポートシリアルカードをサポートさせるにはどうしたらよいのでしょうか?</a></dt><dt>11.6. <a href="serial.html#idp82804432">FreeBSD で複数のマルチポートシリアルカード間で
            irq を共有することはできますか?</a></dt><dt>11.7. <a href="serial.html#idp82806480">
            ポートにデフォルトのパラメータを設定する事は出来ますか?</a></dt><dt>11.8. <a href="serial.html#idp82817616">どのようにしたらモデム経由でダイヤルアップログインができるのでしょうか?</a></dt><dt>11.9. <a href="serial.html#idp82844624">ダムターミナルを FreeBSD マシンに接続するにはどうしたらよいのでしょうか?</a></dt><dt>11.10. <a href="serial.html#idp82872400">どうして tip や
            cu が動かないのですか?</a></dt><dt>11.11. <a href="serial.html#idp82886224">私の Hayes モデムはサポートされていないのですが、
            どうしたらいいのでしょうか。</a></dt><dt>11.12. <a href="serial.html#idp82899408">これらの AT コマンドを入力するには?</a></dt><dt>11.13. <a href="serial.html#idp82920784">pn 機能の &lt;@&gt; 記号が使えません!</a></dt><dt>11.14. <a href="serial.html#idp82925520">コマンドラインから電話番号を指定するには?</a></dt><dt>11.15. <a href="serial.html#idp82934480">毎回 bps レートを入力しなければいけませんか?</a></dt><dt>11.16. <a href="serial.html#idp82943312">ターミナルサーバを経由して複数のホストへアクセスしたいのですが。</a></dt><dt>11.17. <a href="serial.html#idp82951376">
            tip
            を使ってそれぞれのサイトの複数の回線に接続できますか?</a></dt><dt>11.18. <a href="serial.html#idp82968400">CTRL+P を
            1 回送るために 2 度押す必要があるのはなぜ?</a></dt><dt>11.19. <a href="serial.html#idp82983888">打ち込んだ文字が突然すべて大文字になりました??</a></dt><dt>11.20. <a href="serial.html#idp83002064">tip でファイルを転送するには?</a></dt><dt>11.21. <a href="serial.html#idp83008848">tip から zmodem を実行するには?</a></dt><dt>11.22. <a href="serial.html#idp83036112">設定が正しいのにもかかわらず、FreeBSD がシリアルポートを見付けられません。</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp82771408"></a><a id="found-serial"></a><p><strong>11.1.</strong></p></td><td align="left" valign="top"><p>どうやったら FreeBSD がシリアルポートを認識したことを知る事ができますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            FreeBSD のカーネルが起動する時、カーネルはその設定にしたがって、
            システムのシリアルポートを検出します。起動時に表示されるメッセージをよく観察するか、
            起動後に次のコマンドを実行する事によって確認できます。
          </p><pre class="screen">dmesg | grep sio</pre><p>ここに上に挙げたコマンドの出力例を示します。</p><pre class="screen">sio0 at 0x3f8-0x3ff irq 4 on isa
sio0: type 16550A
sio1 at 0x2f8-0x2ff irq 3 on isa
sio1: type 16550A</pre><p>
            これは、二つのシリアルポートを示しています。1 番目は、
            irq が 4 で <code class="literal">0x3f8</code> のポートアドレスを使用しています。
            そして、16550A-type UART チップが存在します。
            2 番目は、同じチップを使っていますが、
            irq は 3 で、<code class="literal">0x2f8</code>
            のポートアドレスを使用しています。内蔵のモデムカードは、
            通常のシリアルポートと同じように扱われますが、
            常時シリアルポートにモデムが接続されているという点で異なります。
          </p><p>
            GENERIC カーネルは、上の例と同じ irq
            とポートアドレスの設定の二つのシリアルポートをサポートしています。
            これらの設定があなたのシステムに合わない場合、
            またはモデムカードを追加した場合やカーネルの設定以上にシリアルポートを持っている場合は、
            カーネルを再構築してください。
            詳しくは、
            <a class="link" href="kernelconfig.html#make-kernel" title="6.1.">カーネルの構築</a>の項を参照してください。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82776784"></a><a id="found-modem"></a><p><strong>11.2.</strong></p></td><td align="left" valign="top"><p>
            どうやったら FreeBSD がモデムカードを認識したことを知ることができますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            前の質問を参照してください。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82778832"></a><a id="missing-tty0X"></a><p><strong>11.3.</strong></p></td><td align="left" valign="top"><p>FreeBSD 2.0.5 にアップグレードしたら
	    <code class="filename">tty0X</code>
            が見つからなくなってしまったのですが</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>心配ありません。
	    <code class="filename">ttydX</code>
	    に統合されました。
            ただ、古い設定ファイルのすべてを更新する必要があります。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82781648"></a><a id="access-serial-ports"></a><p><strong>11.4.</strong></p></td><td align="left" valign="top"><p>どうやったら FreeBSD でシリアルポートにアクセスできますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            3 番目のポート
            <code class="filename">sio2</code> (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sio&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sio</span>(4)</span></a> をご覧ください。DOS
            では、<code class="filename">COM3</code> と呼ばれます。) には、
            ダイヤルアウトデバイスとしては <code class="filename">/dev/cuaa2</code>、
            ダイヤルインデバイスとして <code class="filename">/dev/ttyd2</code> があります。
            それではこの両者にはどのような違いがあるのでしょうか?
          </p><p>
            まず、ダイヤルインの時には
            <code class="filename">ttydX</code>
	    を使います。
            <code class="filename">/dev/ttydX</code>
            をブロッキングモードでオープンすると、プロセスは対応する
            <code class="filename">cuaaX</code>
            デバイスがインアクティブになるのを待ちます。
            次に <acronym class="acronym">CD</acronym> 信号がアクティブになるのを待ちます。
            <code class="filename">cuaaX</code>
            デバイスをオープンすると、シリアルポートが
            <code class="filename">ttydX</code>
            デバイスによってすでに使われていないかどうかを確認します。
            もしこのポートが使用可能であれば、ポートの使用権を
            <code class="filename">ttydX</code>
            から「奪い取る」のです。また、
            <code class="filename">cuaaX</code>
            デバイスは <acronym class="acronym">CD</acronym> 信号を監視しません。
            この仕組みと自動応答モデムによって、
            リモートユーザーをログインさせたり、
            同じモデムでダイヤルアウトしたりすることができ、
            システムのあらゆるトラブルの面倒を見ることができるでしょう。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82789968"></a><a id="enable-multiport-serial"></a><p><strong>11.5.</strong></p></td><td align="left" valign="top"><p>マルチポートシリアルカードをサポートさせるにはどうしたらよいのでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            繰り返しになりますが、
            <a class="link" href="kernelconfig.html#make-kernel" title="6.1.">カーネルコンフィグレーション</a>のセクションでは、
            あなたのカーネルの設定についての情報が得られるでしょう。
            マルチポートシリアルカードを使用するためには、カーネルの設定ファイルに、
            カードの持つそれぞれのシリアルポートに対応する
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sio&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sio</span>(4)</span></a>
            の行を記述する必要があります。しかし、
            irq とベクタアドレスは一つのエントリにのみ記述してください。
            カード上のすべてのポートは一つの irq を共有しなければなりません。
            一貫性を持たせるためにも、
            最後のシリアルポートの所で irq を指定してください。
            また、<code class="literal">COM_MULTIPORT</code> オプションも付けてください。
          </p><p>
            次に示す例は、AST の 4 ポートシリアルカードを irq 7 で設定したものです。
          </p><pre class="programlisting">options "COM_MULTIPORT"
device sio4 at isa? port 0x2a0 tty flags 0x781
device sio5 at isa? port 0x2a8 tty flags 0x781
device sio6 at isa? port 0x2b0 tty flags 0x781
device sio7 at isa? port 0x2b8 tty flags 0x781 irq 7 vector siointr</pre><p>
            このフラグはマスタポートがマイナー番号 7
            (<code class="literal">0x700</code>) を持っていて、
            検出時の診断機能を有効にし (<code class="literal">0x080</code>)、
            そしてすべてのポートで irq
            を共有する (<code class="literal">0x001</code>) ということを意味しています。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82804432"></a><a id="multiport-serial-share-irq"></a><p><strong>11.6.</strong></p></td><td align="left" valign="top"><p>FreeBSD で複数のマルチポートシリアルカード間で
            irq を共有することはできますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            現在のところはできません。それぞれのカード毎に異なった irq
            を使ってください。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82806480"></a><a id="default-serial-params"></a><p><strong>11.7.</strong></p></td><td align="left" valign="top"><p>
            ポートにデフォルトのパラメータを設定する事は出来ますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p><code class="filename">ttydX</code>
	    デバイス (または
            <code class="filename">cuaaX</code>
            デバイス) は、
            アプリケーションのためにオープンする標準的なデバイスです。
            プロセスがそのポートをオープンする時、
            プロセスはデフォルトの端末 I/O 設定を取得します。
            これらの設定は次のコマンドで確認することができます。
          </p><pre class="programlisting">stty -a -f /dev/ttyd1</pre><p>
            このデバイスに対する設定を変更した場合、
            その設定はデバイスをクローズするまで有効です。
            デバイスを再オープンした場合、それらの設定はデフォルトに戻ってしまいます。
            デフォルトの設定に変更を加えるために、
            「初期設定」デバイスをオープンし、
            設定を修正することができます。
            たとえば、<acronym class="acronym">CLOCAL</acronym> モード、8 ビット、
            <acronym class="acronym">XON/XOFF</acronym>
            フロー制御という設定を
            <code class="filename">ttyd5</code>
            のデフォルトにしたい場合、次のように行なってください。
          </p><pre class="programlisting">stty -f /dev/ttyid5 clocal cs8 ixon ixoff</pre><p>
            この設定を行なうためのコマンドを記述するのに適切なファイルは、
            <code class="filename">/etc/rc.serial</code> です。
            これでアプリケーションが
            <code class="filename">ttyd5</code> をオープンした時に、
            これらの設定をデフォルトで取得します。
            しかし、こういったリンクによる設定は変更可能です。
          </p><p>
            「設定固定」デバイスを調整してやることによって、
            アプリケーションによる設定の変更を禁止することができます。
            たとえば、<code class="filename">ttyd5</code>
            の通信速度を 57600bps
            に固定するには、次のように行ってください。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>stty -f /dev/ttyld5 57600</code></strong></pre><p>
            これにより、アプリケーションは <code class="filename">ttyd5</code>
            をオープンし、ポートの通信速度を変更しようとしますが、
            通信速度は 57600bps のままになります。
          </p><p>
            当然のことながら、初期設定デバイスおよび、設定固定デバイスは
            <code class="systemitem">root</code> のみが書き込みできるようになっていなければなりません。
            しかし、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=MAKEDEV&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">MAKEDEV</span>(8)</span></a>
            スクリプトはデバイスエントリを作成する時に、
            このような設定は<span class="emphasis"><em>行いません</em></span>。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82817616"></a><a id="enable-dialup"></a><p><strong>11.8.</strong></p></td><td align="left" valign="top"><p>どのようにしたらモデム経由でダイヤルアップログインができるのでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            つまり、インターネットサービスプロバイダーになりたいのですね。
            それにはまず、1 台ないし複数の自動応答モデムが必要です。
            モデムには、キャリアーを検出した時には
            <acronym class="acronym">CD</acronym> 信号を出力し、
            そうでない場合には出力しないことが必要とされます。
            また <acronym class="acronym">DTR</acronym> 信号が
            on から off になった時には、
            電話回線を切断し、モデム自身をリセットしなければなりません。
            おそらく、<acronym class="acronym">RTS/CTS</acronym> フロー制御を使うか、
            ローカルフロー制御をまったく使わないかのどちらかでしょう。
            最後に、コンピュータとモデムの間は固定速度でなければなりません。
            ただ、(ダイヤルアップの発呼者に対して親切であるためには、
            ) こちらのモデムと相手側のモデムの間の速度を、
            モデム間で自動調整できるようにすべきでしょう。
          </p><p>
            多くあるヘイズコマンド互換モデムに対して、次のコマンドはこれらの設定を行ない、
            その設定を不揮発性メモリーに保存します。
          </p><pre class="programlisting">AT&amp;C1&amp;D3&amp;K3&amp;Q6S0=1&amp;W</pre><p>
            MS-DOS のターミナルプログラムに頼らずに AT コマンドを送出するには、
            <a class="link" href="serial.html#direct-at" title="11.12.">「AT
              コマンドを入力するには」</a>のセクションを参照してください。
          </p><p>
            次に、モデム用のエントリを
            <code class="filename">/etc/ttys</code> (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ttys&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ttys</span>(5)</span></a> 参照)
            に作成しましょう。
            このファイルには、
            オペレーティングシステムがログインを待っているすべてのポートが記述されています。
            以下のような行を追加してください。
          </p><pre class="programlisting">ttyd1 "/usr/libexec/getty std.57600" dialup on insecure</pre><p>
            この行は、2 番目のシリアルポート
            (<code class="filename">/dev/ttyd1</code>) には、
            57600bps の通信速度でノンパリティ (<code class="literal">std.57600</code>:
            これは
            <code class="filename">/etc/gettytab</code>
            に記述されています。<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gettytab&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">gettytab</span>(5)</span></a> 参照)
            のモデムが接続されていることを示しています。
            このポートの端末タイプは <code class="literal">dialup</code> です。
            またこのポートは、<code class="literal">on</code>
            すなわちログイン可能であり、<code class="literal">insecure</code> です。
            これは <code class="systemitem">root</code>
            がこのポートから直接ログインするのは、
            許可されていないということを意味します。
            このようなダイヤルインポートに対しては、
            <code class="filename">ttydX</code>
            のエントリを使用してください。
          </p><p>
            これが一般的な、ターミナルタイプとして <code class="literal">dialup</code>
            を使う方法です。多くのユーザーは、
            <code class="filename">.profile</code> や
            <code class="filename">.login</code> で、
            ログイン時の端末タイプが
            <code class="literal">dialup</code> であった場合には、
            実際の端末タイプをユーザーに問い合わせるように設定しています。
            この例は、ポートが <code class="literal">insecure</code>
            でした。このポートで <code class="systemitem">root</code> になるには、
            一般ユーザーとしてログインし、それから
            <span class="quote">「<span class="quote"><a class="link" href="http://www.FreeBSD.org/cgi/man.cgi?su" target="_top">su</a></span>」</span> を使って
            <code class="systemitem">root</code> になってください。
            もし、<code class="literal">secure</code>
            を指定したならば、
            直接 <code class="systemitem">root</code> がそのポートからログインできます。
          </p><p>
            <code class="filename">/etc/ttys</code>
            に変更を加えた後は、<acronym class="acronym">HUP</acronym> シグナル (SIGHUP) を
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=init&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">init</span>(8)</span></a>
            プロセスに送る必要があります。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kill -HUP 1</code></strong></pre><p>
            この操作は <code class="command">init</code> プロセスに
            <code class="filename">/etc/ttys</code>
            を再読み込みさせます。
            これにより、init プロセスは
            <code class="command">getty</code> プロセスをすべての
            <code class="literal">on</code>
            となっているポートに起動させます。
            次のようにして、ポートがログイン可能かを知ることができます。
          </p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ps -ax | grep '[t]tyd1'</code></strong></pre><p>
            ログイン可能であれば、次のような出力が得られるはずです。
          </p><pre class="screen">747 ??  I      0:00.04 /usr/libexec/getty std.57600 ttyd1</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82844624"></a><a id="dumb-terminal"></a><p><strong>11.9.</strong></p></td><td align="left" valign="top"><p>ダムターミナルを FreeBSD マシンに接続するにはどうしたらよいのでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            もし、他のコンピューターを FreeBSD の端末として接続したいのならば、
            お互いのシリアルポート間をつなぐヌルモデムケーブル
            (訳注: リバースケーブルもしくはクロスケーブルとも呼ばれます)
            を用意してください。
            もし、既製の端末を使う場合は、付属するマニュアルを参照してください。
          </p><p>
            そして、<code class="filename">/etc/ttys</code> (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ttys&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ttys</span>(5)</span></a> 参照)
            を上と同じように変更してください。
            たとえば、WYSE-50 という端末を 5 番目のポートに接続するならば、
            次のようなエントリを使用してください。
          </p><pre class="programlisting">ttyd4 "/usr/libexec/getty std.38400" wyse50 on secure</pre><p>
            この例は、<code class="filename">/dev/ttyd4</code> ポートにノンパリティ、
            端末タイプが wyse50、通信速度が
            38400bps (<code class="literal">std.38400</code>: この設定は、
            <code class="filename">/etc/gettytab</code>
            に記述されています。<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gettytab&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">gettytab</span>(5)</span></a> 参照) の端末が存在しており、
            <code class="systemitem">root</code>
            のログインが許可されている (<code class="literal">secure</code>) であることを示しています。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82872400"></a><a id="cannot-tip"></a><p><strong>11.10.</strong></p></td><td align="left" valign="top"><p>どうして <code class="command">tip</code> や
            <code class="command">cu</code> が動かないのですか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            おそらくあなたのシステムでは
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a> や <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cu&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">cu</span>(1)</span></a> は
            <code class="systemitem">uucp</code> ユーザーか、
            <code class="systemitem">dialer</code> グループによってのみ実行可能なのでしょう。
            <code class="systemitem">dialer</code> グループは、
            モデムやリモートシステムにアクセスするユーザーを管理するために、
            使用することができます。
            それには、<code class="filename">/etc/group</code>
            ファイルの <code class="systemitem">dialer</code>
            グループにあなた自身を追加してください。
          </p><p>
            そうする代わりに、次のようにタイプすることにより、
            あなたのシステムの全ユーザーが
            <code class="command">tip</code> や
            <code class="command">cu</code>
            を実行できるようになります。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chmod 4511 /usr/bin/cu</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chmod 4511 /usr/bin/tip</code></strong></pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82886224"></a><a id="hayes-unsupported"></a><p><strong>11.11.</strong></p></td><td align="left" valign="top"><p>私の Hayes モデムはサポートされていないのですが、
            どうしたらいいのでしょうか。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            実際、
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a>
            のオンラインマニュアルは古くなっています。
            すでに、Hayes ダイアラが実装されています。
            <code class="filename">/etc/remote</code>
            ファイル (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=remote&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">remote</span>(5)</span></a> 参照) で、
            <span class="quote">「<span class="quote"><code class="literal">at=hayes</code></span>」</span>
            と指定してください。
          </p><p>
            Hayes ドライバは、最近のモデムの新しい機能である、
            <code class="literal">BUSY</code>、
            <code class="literal">NO DIALTONE</code>、
            <code class="literal">CONNECT 115200</code>
            などのメッセージを認識できるほど賢くはなく、
            単に混乱を起こすだけです。
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a>
            を使う場合には (<code class="literal">ATX0&amp;W</code>とするなどして)、
            これらのメッセージを表示させないようにしなくてはいけません。
          </p><p>
            また、<code class="literal">tip</code> のダイヤルのタイムアウトは 60 秒です。
            モデムのタイムアウト設定はそれより短くすべきであり、
            そうしないと <code class="literal">tip</code>
            は通信に問題があると判断するでしょう。
            <code class="literal">ATS7=45&amp;W</code> を実行してください。
          </p><p>
            実際、デフォルトの
            <code class="literal">tip</code> は Hayes
            の完全なサポートをしているわけではありません。
            解決方法は <code class="filename">/usr/src/usr.bin/tip/tip</code>
            の下の <code class="filename">tipconf.h</code> を変更することです。
            もちろん、これにはソース配布ファイルが必要です。
          </p><p>
            <span class="quote">「<span class="quote"><code class="literal">#define HAYES 0</code></span>」</span>
            と記述されている行を
            <span class="quote">「<span class="quote"><code class="literal">#define HAYES1</code></span>」</span> と変更し、そして
            <span class="quote">「<span class="quote"><code class="command">make</code></span>」</span> と
            <span class="quote">「<span class="quote"><code class="command">make install</code></span>」</span>
            を実行します。これでうまく動作するでしょう。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82899408"></a><a id="direct-at"></a><p><strong>11.12.</strong></p></td><td align="left" valign="top"><p>これらの AT コマンドを入力するには?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            <code class="filename">/etc/remote</code>
            ファイル (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=remote&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">remote</span>(5)</span></a> 参照) の中で
            <span class="quote">「<span class="quote">direct</span>」</span> エントリを作ります。
            たとえばモデムが 1 番目のシリアルポートである
            <code class="filename">/dev/cuaa0</code>に接続されている場合、
            次のようにします。</p><pre class="programlisting">cuaa0:dv=/dev/cuaa0:br#19200:pa=none</pre><p>
            モデムがサポートする最大の bps レートを
            <code class="literal">br</code> フィールドに使います。
            そして <code class="command">tip cuaa0</code> (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a> 参照)
            を実行すると、モデムが利用できるようになります。
          </p><p>
            <code class="filename">/dev/cuaa0</code>がシステムに存在しない場合は、次のようにします。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /dev</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>./MAKEDEV cuaa0</code></strong></pre><p>
            または <code class="systemitem">root</code>
            になって以下のように cu を使います。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cu -lline -sspeed</code></strong></pre><p><em class="replaceable"><code>line</code></em>
            にはシリアルポート (たとえば
            <code class="filename">/dev/cuaa0</code>)を指定します。
            そして <em class="replaceable"><code>speed</code></em>
            には接続する速度 (たとえば
            <code class="literal">57600</code>) を指定します。
            その後 AT コマンドを実行したら、
            <code class="literal">~.</code>
            と入力すれば終了します。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82920784"></a><a id="gt-failure"></a><p><strong>11.13.</strong></p></td><td align="left" valign="top"><p>pn 機能の <code class="literal">&lt;@&gt;</code> 記号が使えません!</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>電話番号 (pn) 機能の中での
            <code class="literal">&lt;@&gt;</code> 記号は、
            <code class="command">tip</code> に
            <code class="filename">/etc/phones</code>
            にある電話番号を参照するように伝えます。しかし
            <code class="literal">&lt;@&gt;</code> の文字は
            <code class="filename">/etc/remote</code>
            のような設定ファイルの中では特殊文字となります。
            そこで、バックスラッシュを使ってエスケープを行います。
          </p><pre class="programlisting">pn=\@</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82925520"></a><a id="dial-command-line"></a><p><strong>11.14.</strong></p></td><td align="left" valign="top"><p>コマンドラインから電話番号を指定するには?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            <span class="quote">「<span class="quote"><code class="literal">generic</code></span>」</span>
            エントリと呼ばれるものを
            <code class="filename">/etc/remote</code> ファイル
            (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=remote&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">remote</span>(5)</span></a> 参照) に追加します。
            たとえば、次のようにします。
          </p><pre class="programlisting">tip115200|Dial any phone number at 115200 bps:\
:dv=/dev/cuaa0:br#115200:at=hayes:pa=none:du:
tip57600|Dial any phone number at 57600 bps:\
:dv=/dev/cuaa0:br#57600:at=hayes:pa=none:du:</pre><p>
            そして
            <span class="quote">「<span class="quote"><code class="command">tip -115200 5551234</code></span>」</span>
            のように利用できます。
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a> より <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cu&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">cu</span>(1)</span></a> を使いたい場合、
            <code class="command">cu</code> の
            <code class="literal">generic</code> エントリを使います。
          </p><pre class="programlisting">cu115200|Use cu to dial any number at 115200bps:\
:dv=/dev/cuaa1:br#57600:at=hayes:pa=none:du:</pre><p>
            そして <span class="quote">「<span class="quote"><code class="command">cu 5551234 -s 115200</code></span>」</span>
            と実行します。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82934480"></a><a id="set-bps"></a><p><strong>11.15.</strong></p></td><td align="left" valign="top"><p>毎回 bps レートを入力しなければいけませんか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            <code class="literal">tip1200</code> や
            <code class="literal">cu1200</code> 用のエントリを記述し、
            適切な通信速度を <code class="literal">br</code>
            フィールドに設定します。
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a> は
            1200bps が正しいデフォルト値であるとみなすので、
            <span class="quote">「<span class="quote"><code class="literal">tip1200</code></span>」</span> エントリを参照します。
            もちろん 1200bps を使わなければならないわけではありません。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82943312"></a><a id="terminal-server"></a><p><strong>11.16.</strong></p></td><td align="left" valign="top"><p>ターミナルサーバを経由して複数のホストへアクセスしたいのですが。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            毎回接続されるのを待って
            <span class="quote">「<span class="quote"><strong class="userinput"><code>CONNECT &lt;host&gt;</code></strong></span>」</span>
            と入力するかわりに、
            <code class="command">tip</code> の
            <code class="literal">cm</code> 機能を使います。
            たとえば、<code class="filename">/etc/remote</code> (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=remote&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">remote</span>(5)</span></a> 参照)
            に次のようなエントリを追加します。
          </p><pre class="programlisting">pain|pain.deep13.com|Forrester's machine:\
	:cm=CONNECT pain\n:tc=deep13:
muffin|muffin.deep13.com|Frank's machine:\
	:cm=CONNECT muffin\n:tc=deep13:
deep13:Gizmonics Institute terminal server:\
	:dv=/dev/cuaa2:br#38400:at=hayes:du:pa=none:pn=5551234:</pre><p>
            これで、<span class="quote">「<span class="quote"><code class="command">tip pain</code></span>」</span>
            や <span class="quote">「<span class="quote"><code class="command">tip muffin</code></span>」</span>
            と実行すると
            <code class="systemitem">pain</code> や
            <code class="systemitem">muffin</code> のホストに接続することができ、
            <span class="quote">「<span class="quote"><code class="command">tip deep13</code></span>」</span>
            を実行するとターミナルサーバに接続します。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82951376"></a><a id="tip-multiline"></a><p><strong>11.17.</strong></p></td><td align="left" valign="top"><p>
            <code class="command">tip</code>
            を使ってそれぞれのサイトの複数の回線に接続できますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            これは大学に電話回線がいくつかあって、
            数千人の学生が接続しようとする場合によくある問題です。
          </p><p>
            あなたの大学のエントリを
            <code class="filename">/etc/remote</code>
            ファイル (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=remote&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">remote</span>(5)</span></a> 参照) に作成して、
            <code class="literal">pn</code> のフィールドには
            <code class="literal">&lt;\@&gt;</code> を使います。
          </p><pre class="programlisting">big-university:\
:pn=\@:tc=dialout
dialout:\
:dv=/dev/cuaa3:br#9600:at=courier:du:pa=none:</pre><p>
            そして
            <code class="filename">/etc/phones</code> ファイル
            (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=phones&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">phones</span>(5)</span></a> 参照) に大学の電話番号の一覧を書きます。
          </p><pre class="programlisting">big-university 5551111
big-university 5551112
big-university 5551113
big-university 5551114</pre><p>
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a>
            は一連の電話番号を上から順に試みて、
            最終的に接続できなければあきらめます。リトライを続けさせたい場合は、
            <code class="command">tip</code> を
            while ループに入れて実行します。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82968400"></a><a id="multi-controlp"></a><p><strong>11.18.</strong></p></td><td align="left" valign="top"><p><span class="keycap"><strong>CTRL</strong></span>+<span class="keycap"><strong>P</strong></span> を
            1 回送るために 2 度押す必要があるのはなぜ?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p><span class="keycap"><strong>CTRL</strong></span>+<span class="keycap"><strong>P</strong></span>
            は通常「強制 (force)」文字であり、
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a>
            に次の文字がリテラルデータであることを伝えます。
            強制文字は「変数の設定」を意味する
            <code class="literal">~s</code> エスケープによって、
            他の文字にすることができます。
          </p><p>
            <span class="quote">「<span class="quote"><code class="literal">~sforce=&lt;single-char&gt;</code></span>」</span>
            と入力して改行します。
            <em class="replaceable"><code>&lt;single-char&gt;</code></em> は、任意の 1 バイト文字です。
            <em class="replaceable"><code>&lt;single-char&gt;</code></em> を省略すると
            <code class="literal">NUL</code> 文字になり、
            これは <span class="keycap"><strong>CTRL</strong></span>+<span class="keycap"><strong>2</strong></span> や
            <span class="keycap"><strong>CTRL</strong></span>+<span class="keycap"><strong>SPACE</strong></span>
            を押しても入力できます。
            いくつかのターミナルサーバで使われているのを見ただけですが、
            <em class="replaceable"><code>&lt;single-char&gt;</code></em> に
            <span class="keycap"><strong>SHIFT</strong></span>+<span class="keycap"><strong>CTRL</strong></span>+<span class="keycap"><strong>6</strong></span>
            に割り当てるのもよいでしょう。
          </p><p>
            <code class="filename">$HOME/.tiprc</code> に次のように定義することで、
            任意の文字を強制文字として利用できます。
          </p><pre class="programlisting">force=<em class="replaceable"><code>&lt;single-char&gt;</code></em></pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82983888"></a><a id="uppercase"></a><p><strong>11.19.</strong></p></td><td align="left" valign="top"><p>打ち込んだ文字が突然すべて大文字になりました??</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            <span class="keycap"><strong>CTRL</strong></span>+<span class="keycap"><strong>A</strong></span>
            を押してしまい、<span class="keycap"><strong>caps-lock</strong></span>
            キーが壊れている場合のために設計された
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a>
            の <span class="quote">「<span class="quote">raise character</span>」</span> モードに入ったのでしょう。
            既に述べた <code class="literal">~s</code> を使って、
            <span class="quote">「<span class="quote">raisechar</span>」</span> をより適切な値に変更してください。
            もしこれら両方の機能を使用しないのであれば、
            強制文字と同じ設定にすることもできます。
          </p><p>
            以下は <span class="keycap"><strong>CTRL</strong></span>+<span class="keycap"><strong>2</strong></span> や
            <span class="keycap"><strong>CTRL</strong></span>+<span class="keycap"><strong>A</strong></span>
            などを頻繁に使う必要のある Emacs ユーザにうってつけの
            <code class="filename">.tiprc</code> ファイルのサンプルです。
          </p><pre class="programlisting">force=^^
raisechar=^^</pre><p>
            <code class="literal">^</code> は
            <span class="keycap"><strong>SHIFT</strong></span>+<span class="keycap"><strong>CTRL</strong></span>+<span class="keycap"><strong>6</strong></span> です。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp83002064"></a><a id="tip-filetransfer"></a><p><strong>11.20.</strong></p></td><td align="left" valign="top"><p><code class="command">tip</code> でファイルを転送するには?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            もし他の UNIX のシステムと接続しているなら、
            <code class="literal">~p</code> (送信) や
            <code class="literal">~t</code> (受信) でファイルの送受信ができます。
            これらのコマンドは、相手のシステムの上で
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cat&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">cat</span>(1)</span></a> や <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=echo&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">echo</span>(1)</span></a>
            を実行することで送受信をします。書式は以下のようになります。
          </p><pre class="programlisting">~p <em class="replaceable"><code>&lt;ローカルのファイル名&gt;</code></em> <em class="replaceable"><code>[&lt;リモートのファイル名&gt;]</code></em>
~t <em class="replaceable"><code>&lt;リモートのファイル名&gt;</code></em> <em class="replaceable"><code>[&lt;ローカルのファイル名&gt;]</code></em></pre><p>
            この方法ではエラーチェックを行いませんので、
            zmodem などの他のプロトコルを使った方がよいでしょう。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp83008848"></a><a id="zmodem-tip"></a><p><strong>11.21.</strong></p></td><td align="left" valign="top"><p><span class="application">tip</span> から zmodem を実行するには?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            まず始めに、FreeBSD Ports
            Collection から zmodem プログラムのいずれか
            (<span class="application">lrzsz</span>と <span class="application">rzsz</span>
            の、通信カテゴリーの2 つのプログラムのどちらか) をインストールします。
          </p><p>
            ファイルを受信するには、リモート側で送信プログラムを起動します。
            そして、<span class="keycap"><strong>Enter</strong></span> キーを押してから
            <span class="quote">「<span class="quote"><code class="literal">~C rz</code></span>」</span>
            (lrzsz をインストールした場合は
            <span class="quote">「<span class="quote"><code class="literal">~C lrz</code></span>」</span>) と入力すると、
            ローカル側へのファイルの受信が始まります。
          </p><p>
            ファイルを送信するには、リモート側で受信プログラムを起動します。
            そして、<span class="keycap"><strong>Enter</strong></span> キーを押してから
            <span class="quote">「<span class="quote"><code class="literal">~C sz &lt;files&gt;</code></span>」</span>
            (lrzsz をインストールした場合は
            <span class="quote">「<span class="quote"><code class="literal">~C lsz
              &lt;files&gt;</code></span>」</span>)
            と入力すると、リモート側へのファイルの送信が始まります。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp83036112"></a><a id="cannot-find-serial"></a><p><strong>11.22.</strong></p></td><td align="left" valign="top"><p>設定が正しいのにもかかわらず、FreeBSD がシリアルポートを見付けられません。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            マザーボードやシリアルカードが Acer の UART チップを使った物の場合、
            FreeBSD の <code class="filename">sio</code> ドライバでは正しく検出する事が出来ません。
            この問題を解決するためには、
            <a class="link" href="http://www.lemis.com/serial-port-patch.html" target="_top">www.lemis.com</a>
            からパッチを入手してください。
          </p></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ppp.html">戻る</a>〓</td><td width="20%" align="center">〓</td><td width="40%" align="right">〓<a accesskey="n" href="misc.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第10章 PPP〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓第12章 その他の質問</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>