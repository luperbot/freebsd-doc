<?xml version="1.0" encoding="euc-jp"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>FreeBSD port 作成者のためのハンドブック</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><meta name="description" content="このハンドブックは FreeBSD の port 作成者 (porter) 向けに、 具体的な port の作成方法や注意点などをまとめたものです。 日本語版の作成は FreeBSD 日本語ドキュメンテーション プロジェクト (FreeBSD doc-jp) が行なっています。 日本語訳および、日本語版のみに関することは FreeBSD 日本語ドキュメンテーションプロジェクト doc-jp@jp.FreeBSD.org に おいて日本語で議論されています。 文書の日本語訳に関するお問い合わせや、 文書の原文に関する問い合わせをしたいが英語が得意でないという方は、 FreeBSD 日本語ドキュメンテーションプロジェクト doc-jp@jp.FreeBSD.org まで日本語でコメントをお寄せください。" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div xml:lang="ja" class="book" lang="ja"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp73878864"></a>FreeBSD port 作成者のためのハンドブック</h1></div><div><div xmlns="http://www.w3.org/1999/xhtml" class="authorgroup"><div class="author"><h3 class="author"><span class="orgname">FreeBSD ドキュメンテーションプロジェクト</span></h3></div></div></div><div>改訂: <a href="https://svnweb.freebsd.org/changeset/doc/"><span class="svnref"></span></a></div><div><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">製作著作 © 2000-2004 The FreeBSD Documentation
	Project</p></div><div><div xmlns="http://www.w3.org/1999/xhtml" class="legalnotice"><a id="trademarks"></a><p class="legalnotice-title"><strong>Legal Notice</strong></p><p>FreeBSD is a registered trademark of The FreeBSD Foundation.</p><p>UNIX is a registered trademark of The Open Group in the US and
    other countries.</p><p>Sun, Sun Microsystems, SunOS, Solaris,
    Java, JDK, and OpenJDK are trademarks
    or registered trademarks of Sun Microsystems, Inc. in the United
    States and other countries.</p><p>Apple and QuickTime are trademarks of Apple Computer, Inc.,
    registered in the U.S. and other countries.</p><p>Macromedia and Flash are trademarks or registered
    trademarks of Macromedia, Inc. in the United States and/or other
    countries.</p><p>Microsoft, Windows, and Windows Media are either registered
    trademarks or trademarks of Microsoft Corporation in the United
    States and/or other countries.</p><p>PartitionMagic is a registered trademark of PowerQuest
    Corporation in the United States and/or other countries.</p><p>Many of the designations used by manufacturers and sellers to
    distinguish their products are claimed as trademarks.  Where those
    designations appear in this book, and the FreeBSD Project was
    aware of the trademark claim, the designations have been followed
    by the ™ symbol.</p></div></div><div><div xmlns="http://www.w3.org/1999/xhtml" class="legalnotice"><a id="legalnotice"></a><p class="legalnotice-title"><strong>Copyright</strong></p><p>Redistribution and use in source (XML DocBook) and 'compiled'
    forms (XML, HTML, PDF, PostScript, RTF and so forth) with or without
    modification, are permitted provided that the following conditions are
    met:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Redistributions of source code (XML DocBook) must retain the
        above copyright notice, this list of conditions and the following
        disclaimer as the first lines of this file unmodified.</p></li><li class="listitem"><p>Redistributions in compiled form (transformed to other DTDs,
        converted to PDF, PostScript, RTF and other formats) must
        reproduce the above copyright notice, this list of conditions and
        the following disclaimer in the documentation and/or other
        materials provided with the distribution.</p></li></ol></div><div xmlns="" class="important"><h3 class="admontitle">重要: </h3><p xmlns="http://www.w3.org/1999/xhtml">THIS DOCUMENTATION IS PROVIDED BY THE FREEBSD DOCUMENTATION
      PROJECT "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING,
      BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
      FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL
      THE FREEBSD DOCUMENTATION PROJECT BE LIABLE FOR ANY DIRECT, INDIRECT,
      INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
      BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS
      OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
      ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR
      TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
      USE OF THIS DOCUMENTATION, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
      DAMAGE.</p></div></div></div><div>  2000 年 4 月 ： .</div><div><div xmlns="http://www.w3.org/1999/xhtml" class="abstract"><div class="abstract-title">概要</div><p>このハンドブックは FreeBSD の port 作成者 (porter) 向けに、
	具体的な port の作成方法や注意点などをまとめたものです。</p><p>日本語版の作成は FreeBSD 日本語ドキュメンテーション
	プロジェクト (FreeBSD doc-jp) が行なっています。
	日本語訳および、日本語版のみに関することは FreeBSD 日本語ドキュメンテーションプロジェクト <code class="email">&lt;<a xmlns="" class="email" href="mailto:doc-jp@jp.FreeBSD.org">doc-jp@jp.FreeBSD.org</a>&gt;</code> に
	おいて日本語で議論されています。
      </p><p>文書の日本語訳に関するお問い合わせや、
	文書の原文に関する問い合わせをしたいが英語が得意でないという方は、
	FreeBSD 日本語ドキュメンテーションプロジェクト <code class="email">&lt;<a xmlns="" class="email" href="mailto:doc-jp@jp.FreeBSD.org">doc-jp@jp.FreeBSD.org</a>&gt;</code> まで日本語でコメントをお寄せください。</p></div></div></div><div class="docformatnavi">
      [
      <a href="index.html">分割版</a>
      /
      
	  単一版
	
      ]
    </div><hr /></div><div class="toc"><div class="toc-title">目次</div><dl class="toc"><dt><span class="chapter"><a href="#why-port">1. はじめに</a></span></dt><dt><span class="chapter"><a href="#own-port">2. 自分で port を作成するには</a></span></dt><dt><span class="chapter"><a href="#quick-porting">3. 3 分間 porting</a></span></dt><dd><dl><dt><span class="sect1"><a href="#porting-makefile">3.1. <code class="filename">Makefile</code> の作成</a></span></dt><dt><span class="sect1"><a href="#porting-desc">3.2. package 記述ファイルの作成</a></span></dt><dt><span class="sect1"><a href="#porting-checksum">3.3. チェックサムファイルの作成</a></span></dt><dt><span class="sect1"><a href="#porting-testing">3.4. port のテスト</a></span></dt><dt><span class="sect1"><a href="#porting-portlint">3.5. <code class="command">portlint</code> によるチェック</a></span></dt><dt><span class="sect1"><a href="#porting-submitting">3.6. port の提出</a></span></dt></dl></dd><dt><span class="chapter"><a href="#slow">4. 本格的な port</a></span></dt><dd><dl><dt><span class="sect1"><a href="#slow-work">4.1. port 構築の詳細</a></span></dt><dt><span class="sect1"><a href="#slow-sources">4.2. オリジナルのソースの入手</a></span></dt><dt><span class="sect1"><a href="#slow-modifying">4.3. port の修正</a></span></dt><dt><span class="sect1"><a href="#slow-patch">4.4. パッチの適用</a></span></dt><dt><span class="sect1"><a href="#slow-configure">4.5. コンフィグレーション</a></span></dt><dt><span class="sect1"><a href="#slow-user-input">4.6. ユーザからの入力の扱い</a></span></dt></dl></dd><dt><span class="chapter"><a href="#makefile">5. <code class="filename">Makefile</code> の作成</a></span></dt><dd><dl><dt><span class="sect1"><a href="#makefile-source">5.1. オリジナルのソース</a></span></dt><dt><span class="sect1"><a href="#makefile-naming">5.2. 名前の付け方</a></span></dt><dt><span class="sect1"><a href="#makefile-categories">5.3. カテゴリ分類</a></span></dt><dt><span class="sect1"><a href="#makefile-distfiles">5.4. 配布ファイル</a></span></dt><dt><span class="sect1"><a href="#makefile-maintainer">5.5. <code class="varname">MAINTAINER</code></a></span></dt><dt><span class="sect1"><a href="#makefile-comment">5.6. <code class="varname">COMMENT</code></a></span></dt><dt><span class="sect1"><a href="#makefile-depend">5.7. 依存関係</a></span></dt><dt><span class="sect1"><a href="#makefile-wrkdir">5.8. 作業ディレクトリの指定</a></span></dt><dt><span class="sect1"><a href="#conflicts">5.9. <code class="varname">CONFLICTS</code></a></span></dt><dt><span class="sect1"><a href="#makefile-build">5.10. ビルドのメカニズム</a></span></dt></dl></dd><dt><span class="chapter"><a href="#special">6. 特別な配慮</a></span></dt><dd><dl><dt><span class="sect1"><a href="#porting-shlibs">6.1. 共有ライブラリ</a></span></dt><dt><span class="sect1"><a href="#porting-restrictions">6.2. 配布制限がある ports</a></span></dt><dt><span class="sect1"><a href="#using-perl">6.3. <code class="literal">perl</code> の利用</a></span></dt><dt><span class="sect1"><a href="#using-x11">6.4. X11 の利用</a></span></dt><dt><span class="sect1"><a href="#using-automake">6.5. <code class="command">automake</code>, <code class="command">autoconf</code>
	および <code class="command">libtool</code> の利用</a></span></dt><dt><span class="sect1"><a href="#using-gnome">6.6. GNOME の利用</a></span></dt><dt><span class="sect1"><a href="#using-kde">6.7. KDE の利用</a></span></dt><dt><span class="sect1"><a href="#using-bison">6.8. Bison の利用</a></span></dt><dt><span class="sect1"><a href="#using-java">6.9. Java の利用</a></span></dt><dt><span class="sect1"><a href="#using-python">6.10. Python の利用</a></span></dt><dt><span class="sect1"><a href="#using-emacs">6.11. Emacs の利用</a></span></dt><dt><span class="sect1"><a href="#using-ruby">6.12. Ruby の利用</a></span></dt><dt><span class="sect1"><a href="#using-sdl">6.13. SDL の利用</a></span></dt></dl></dd><dt><span class="chapter"><a href="#porting-masterdir">7. <code class="varname">MASTERDIR</code></a></span></dt><dt><span class="chapter"><a href="#shared">8. 共有ライブラリのバージョン</a></span></dt><dt><span class="chapter"><a href="#porting-manpages">9. マニュアルページ</a></span></dt><dt><span class="chapter"><a href="#porting-motif">10. Motif を必要とする port</a></span></dt><dd><dl><dt><span class="sect1"><a href="#motif-use">10.1. <code class="varname">USE_MOTIF</code></a></span></dt><dt><span class="sect1"><a href="#motif-lib">10.2. <code class="varname">MOTIFLIB</code></a></span></dt></dl></dd><dt><span class="chapter"><a href="#x11-fonts">11. X11 のフォント</a></span></dt><dt><span class="chapter"><a href="#porting-info">12. Info ファイル</a></span></dt><dt><span class="chapter"><a href="#pkg-files">13. <code class="filename">pkg-*</code> ファイル</a></span></dt><dd><dl><dt><span class="sect1"><a href="#porting-message">13.1. <code class="filename">pkg-message</code></a></span></dt><dt><span class="sect1"><a href="#pkg-install">13.2. <code class="filename">pkg-install</code></a></span></dt><dt><span class="sect1"><a href="#pkg-deinstall">13.3. <code class="filename">pkg-deinstall</code></a></span></dt><dt><span class="sect1"><a href="#pkg-req">13.4. <code class="filename">pkg-req</code></a></span></dt><dt><span class="sect1"><a href="#porting-plist">13.5. make の変数にあわせた
	<code class="filename">pkg-plist</code> の変更</a></span></dt><dt><span class="sect1"><a href="#pkg-names">13.6. <code class="filename">pkg-*</code>
	ファイルの名前変更</a></span></dt></dl></dd><dt><span class="chapter"><a href="#testing">14. port のテスト</a></span></dt><dd><dl><dt><span class="sect1"><a href="#testing-portlint">14.1. portlint</a></span></dt><dt><span class="sect1"><a href="#porting-prefix">14.2. <code class="varname">PREFIX</code></a></span></dt><dt><span class="sect1"><a href="#testing-freshports">14.3. FreshPorts 正当性テスト</a></span></dt></dl></dd><dt><span class="chapter"><a href="#port-upgrading">15. アップグレード</a></span></dt><dt><span class="chapter"><a href="#porting-dads">16. やっていいことといけないこと</a></span></dt><dd><dl><dt><span class="sect1"><a href="#dads-intro">16.1. はじめに</a></span></dt><dt><span class="sect1"><a href="#dads-strip">16.2. バイナリの strip</a></span></dt><dt><span class="sect1"><a href="#dads-install">16.3. <code class="varname">INSTALL_*</code> マクロ</a></span></dt><dt><span class="sect1"><a href="#porting-wrkdir">16.4. <code class="varname">WRKDIR</code></a></span></dt><dt><span class="sect1"><a href="#porting-wrkdirprefix">16.5. <code class="varname">WRKDIRPREFIX</code></a></span></dt><dt><span class="sect1"><a href="#porting-versions">16.6. OS の種類やバージョンの識別</a></span></dt><dt><span class="sect1"><a href="#freebsd-versions">16.7. __FreeBSD_version の値</a></span></dt><dt><span class="sect1"><a href="#dads-after-port-mk">16.8. <code class="filename">bsd.port.mk</code> の後に書くこと</a></span></dt><dt><span class="sect1"><a href="#dads-documentation">16.9. 付加的な文書のインストール</a></span></dt><dt><span class="sect1"><a href="#dads-subdirs">16.10. ディレクトリ構成</a></span></dt><dt><span class="sect1"><a href="#porting-cleaning">16.11. 空のディレクトリの削除</a></span></dt><dt><span class="sect1"><a href="#dads-uid">16.12. UID</a></span></dt><dt><span class="sect1"><a href="#dads-rational">16.13. 合理的な port</a></span></dt><dt><span class="sect1"><a href="#dads-cc">16.14. <code class="varname">CC</code> および <code class="varname">CXX</code>
	  の尊重</a></span></dt><dt><span class="sect1"><a href="#dads-cflags">16.15. <code class="varname">CFLAGS</code> の尊重</a></span></dt><dt><span class="sect1"><a href="#dads-config">16.16. コンフィグレーション (設定) ファイル</a></span></dt><dt><span class="sect1"><a href="#dads-freedback">16.17. フィードバック</a></span></dt><dt><span class="sect1"><a href="#dads-readme">16.18. <code class="filename">README.html</code></a></span></dt><dt><span class="sect1"><a href="#dads-broken">16.19. Port に <code class="varname">BROKEN</code>, <code class="varname">FORBIDDEN</code>
	などの印をつける</a></span></dt><dt><span class="sect1"><a href="#dads-workarounds">16.20. 必要な回避策</a></span></dt><dt><span class="sect1"><a href="#dads-misc">16.21. その他諸々</a></span></dt><dt><span class="sect1"><a href="#dads-stuck">16.22. 困ったら…</a></span></dt></dl></dd><dt><span class="chapter"><a href="#porting-samplem">17. <code class="filename">Makefile</code> のサンプル</a></span></dt><dt><span class="chapter"><a href="#porting-autoplist">18. パッキングリストの自動生成</a></span></dt><dt><span class="chapter"><a href="#changes">19. この文書と ports システムの変更</a></span></dt></dl></div><div class="list-of-tables"><div class="toc-title">表の一覧</div><dl><dt>5.1. <a href="#idp78549072"><code class="varname">USE_<em class="replaceable"><code>*</code></em></code>
	    変数</a></dt><dt>6.1. <a href="#idp78757200"><code class="literal">perl</code> を使用する ports 用の変数</a></dt><dt>6.2. <a href="#idp78806224">X を利用する ports 用の変数</a></dt><dt>6.3. <a href="#idp78819408">automake, autoconf または libtool
	  を使用する ports 用の変数</a></dt><dt>6.4. <a href="#idp78897104">KDE を利用する ports 用の変数</a></dt><dt>6.5. <a href="#idp78928208">Java を利用する ports で定義すべき変数</a></dt><dt>6.6. <a href="#idp78955728">Java を利用する ports で設定される変数</a></dt><dt>16.1. <a href="#idp79376592">__FreeBSD_version values</a></dt></dl></div><div class="list-of-examples"><div class="toc-title">例の一覧</div><dl><dt>5.1. <a href="#ports-master-sites-n-example-simple-use-one-file-per-site">各サイトに 1 つファイルがある場合の、簡単な
	      <code class="literal">MASTER_SITES:n</code> の使用法</a></dt><dt>5.2. <a href="#ports-master-sites-n-example-simple-use-more-than-one-file-per-site">各サイトに 1 つ以上ファイルがある場合の、簡単な
	      <code class="literal">MASTER_SITES:n</code> の使用法</a></dt><dt>5.3. <a href="#ports-master-sites-n-example-detailed-use-master-site-subdir"><code class="varname">MASTER_SITE_SUBDIR</code> における
		      <code class="literal">MASTER_SITES:n</code> の詳細な使用法</a></dt><dt>5.4. <a href="#ports-master-sites-n-example-detailed-use-complete-example-master-sites">カンマ演算子、複数のファイル、複数のサイト、
			複数のサブディレクトリと合わせた
			<code class="literal">MASTER_SITES:n</code>
			の詳細な使用法</a></dt><dt>5.5. <a href="#ports-master-sites-n-example-detailed-use-master-site-sourceforge"><code class="varname">MASTER_SITE_SOURCEFORGE</code>
		  と合わせた <code class="literal">MASTER_SITES:n</code>
		  の詳しい使用法</a></dt><dt>5.6. <a href="#ports-master-sites-n-example-detailed-use-patch-sites"><code class="varname">PATCH_SITES</code> と合わせた
		  <code class="literal">MASTER_SITES:n</code> の簡単な使用法</a></dt></dl></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="why-port"></a>第1章 はじめに</h1></div></div></div><p>FreeBSD Ports Collection は、ほとんどの人が FreeBSD
      でアプリケーション ("ports") をインストールする手段です。
      FreeBSD に関する他のすべてと同じく、
      これも基本的にボランティア活動によるものです。
      この文書を読む際には必ずこのことを念頭においてください。</p><p>FreeBSD では、誰もが新たな port を提出したり、
      メンテナンスされていない既存の port をメンテナンスできます。
      そのためには特にソースコードを管理する (commit) 権限は必要ありません。</p></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="own-port"></a>第2章 自分で port を作成するには</h1></div></div></div><p>自分で port を作ることや、既存の port の
      更新作業に興味があるのですか。それはすばらしい!</p><p>ここでは FreeBSD 用の port を作る際の
      ガイドラインをいくつか示します。
      既存の port を更新したいと考えている場合であっても、
      まずこの章を読んでから、次に
      <a class="xref" href="#port-upgrading" title="第15章 アップグレード">15章<em>アップグレード</em></a> を読むようにしてください。</p><p>この文書では充分に詳細がわからない場合には、
      <code class="filename">/usr/ports/Mk/bsd.port.mk</code> を参照してください。
      このファイルは、port の Makefile が例外なくインクルードしているものです。
      これには細かくコメントが書かれていますので、Makefile を読むのに
      あまり慣れていない人でも、たくさんの情報を得ることができるでしょう。
      それでも解決できないような質問は、<a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">FreeBSD ports メーリングリスト</a> にポストしてみるのも
      良いでしょう。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">この文書では、上書き可能な
	変数 (<code class="varname"><em class="replaceable"><code>VAR</code></em></code>) のうち
	一部のものについてだけ述べています。
	(すべてでは無いかもしれませんが、) ほとんどの変数は
	<code class="filename">bsd.port.mk</code> の先頭部分に記述されています。
	それ以外のものも記述すべきかもしれません。
	なお、このファイルは非標準のタブ設定を使用しています。
	<span class="application">Emacs</span> や <span class="application">Vim</span> は、
	この設定をファイルの読み込み時に認識するはずです。
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vi&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">vi</span>(1)</span></a> と <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ex&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ex</span>(1)</span></a> では、
	一旦ファイルを読み込んでから <code class="command">:set tabstop=4</code> と
	タイプすることで、正しい値に設定することができます。</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="quick-porting"></a>第3章 3 分間 porting</h1></div></div></div><div class="toc"><div class="toc-title">目次</div><dl class="toc"><dt><span class="sect1"><a href="#porting-makefile">3.1. <code class="filename">Makefile</code> の作成</a></span></dt><dt><span class="sect1"><a href="#porting-desc">3.2. package 記述ファイルの作成</a></span></dt><dt><span class="sect1"><a href="#porting-checksum">3.3. チェックサムファイルの作成</a></span></dt><dt><span class="sect1"><a href="#porting-testing">3.4. port のテスト</a></span></dt><dt><span class="sect1"><a href="#porting-portlint">3.5. <code class="command">portlint</code> によるチェック</a></span></dt><dt><span class="sect1"><a href="#porting-submitting">3.6. port の提出</a></span></dt></dl></div><p>このセクションでは、簡単な port の作り方について説明します。
      多くの場合、これだけでは不十分なので、
      この文書の続きを読まなければならないでしょう。</p><p>まず、元の tar ファイルを
      <code class="varname">DISTDIR</code> に置きます。この変数の
      デフォルト値は <code class="filename">/usr/ports/distfiles</code> です。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">以下の例では、そのソフトウェアが
	そのままコンパイル可能なものと仮定しています。
	つまり、FreeBSD マシンで動かすために、
	変更がまったく必要ないという意味です。
	もし何か変更が必要な場合には、次のセクションも
	参照する必要があるでしょう。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-makefile"></a>3.1. <code class="filename">Makefile</code> の作成</h2></div></div></div><p>最小限の <code class="filename">Makefile</code> は
	次のようなものになります。</p><pre class="programlisting"># New ports collection makefile for:   oneko
# Date created:     5 December 1994
# Whom:             asami
#
# $FreeBSD$
#

PORTNAME=       oneko
PORTVERSION=    1.1b
CATEGORIES=     games
MASTER_SITES=   ftp://ftp.cs.columbia.edu/archives/X11R5/contrib/

MAINTAINER=     asami@FreeBSD.org
COMMENT=        A cat chasing a mouse all over the screen

MAN1=           oneko.1
MANCOMPRESSED=  yes
USE_IMAKE=      yes

.include &lt;bsd.port.mk&gt;</pre><p>おわかりでしょうか。<code class="literal">$FreeBSD$</code> を
	含む行の内容については、気にする必要はありません。
	この行は、このファイルが FreeBSD の ports ツリーに
	取り込まれる際に、CVS によって自動的に書き込まれます。
	もっと詳しい例が見たい場合には、
	<a class="link" href="#porting-samplem" title="第17章 Makefile のサンプル">Makefile のサンプル</a>の
	セクションをご覧ください。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-desc"></a>3.2. package 記述ファイルの作成</h2></div></div></div><p>package にするしないに関わらず、どのような port でも
	2 つの記述ファイルが必要です。それは
	<code class="filename">pkg-descr</code> と
	<code class="filename">pkg-plist</code> です。ファイル名が
	<code class="filename">pkg-</code> で始まっていることで
	他のファイルと区別できるようになっています。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74398160"></a>3.2.1. <code class="filename">pkg-descr</code></h3></div></div></div><p>このファイルには、その port についての少し長い説明を書きます。
	  その port が何をするのかについての、
	  数段落程度の簡潔な解説があれば充分です。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">これはマニュアルでもなければ、使用方法やコンパイル方法に
	    ついての細かい説明書でも<span class="emphasis"><em>ありません</em></span>。
	    <span class="emphasis"><em><code class="filename">README</code> ファイルや
	    マニュアルを引用するつもりなら注意が必要です</em></span>。
	    これらは多くの場合、その port の簡潔な説明になっていなかったり、
	    扱いにくい形式になっていたりします。
	    (マニュアルの場合、行を揃えるために空白が調整されていたりします。)
	    このソフトウェアに公式のウェブサイトがあるのなら、
	    ここに書いてください。その際自動化ツールが正しく動作するように、
	    ウェブサイトのうちの<span class="emphasis"><em>一つ</em></span>には、
	    先頭に <code class="literal">WWW:</code> をつけておいてください。</p></div><p>このファイルの最後に、あなたの名前を書くことが推奨されています。
	  たとえば、こんな具合です。</p><pre class="programlisting">This is a port of oneko, in which a cat chases a poor mouse all over
the screen.
 :
(うんぬん。)

WWW: http://www.oneko.org/

- Satoshi
asami@cs.berkeley.edu</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74410192"></a>3.2.2. <code class="filename">pkg-plist</code></h3></div></div></div><p>このファイルには、その port によってインストールされる
	  すべてのファイルを列挙します。
	  このファイルは package を作る際のリストとして使われるため、
	  <span class="quote">「<span class="quote">パッキングリスト (packing list)</span>」</span> とも呼ばれます。
	  ここに書くパス名は、インストール時のプレフィックス
	  (通常 <code class="filename">/usr/local</code> または
	  <code class="filename">/usr/X11R6</code>) からの相対パスです。
	  <code class="varname">MAN<em class="replaceable"><code>n</code></em></code> 変数を
	  使用している場合 (使用することが推奨されています)、このリストに
	  マニュアルは入れないようにしてください。</p><p>簡単な例を載せておきましょう。</p><pre class="programlisting">bin/oneko
lib/X11/app-defaults/Oneko
lib/X11/oneko/cat1.xpm
lib/X11/oneko/cat2.xpm
lib/X11/oneko/mouse.xpm
@dirrm lib/X11/oneko</pre><p>パッキングリストの詳細については、
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_create&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_create</span>(1)</span></a> のマニュアルを参照してください。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">このリストには、すべてのファイルを列挙しなければ
	    なりませんが、ディレクトリそのものは列挙する必要がありません。
	    また、この port がインストール時に独自のディレクトリを
	    作成する場合には、この port が削除されるときに
	    そのディレクトリも削除されるよう、<code class="literal">@dirrm</code> の行を
	    追加しておくのを忘れないでください。</p><p xmlns="http://www.w3.org/1999/xhtml">このファイルでは、すべてのファイル名を
	    アルファベット順にソートしておくことを推奨します。
	    そうすることで、port を更新する際の
	    変更点の確認が楽になります。</p><p xmlns="http://www.w3.org/1999/xhtml">パッキングリストを手作業で作成するのは、
	    時にとても退屈な作業になります。
	    その port が非常に多数のファイルをインストールするとしたら、
	    <a class="link" href="#porting-autoplist" title="第18章 パッキングリストの自動生成"> パッキングリストの
	    自動生成</a>を行なえば、時間の節約になるかもしれません。</p></div></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-checksum"></a>3.3. チェックサムファイルの作成</h2></div></div></div><p><code class="command">make makesum</code> と入力するだけで、
	(訳注: <code class="filename">bsd.port.mk</code> に書かれている)
	port 生成ルールに従い、
	自動的に <code class="filename">distinfo</code> ファイルが生成されます。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-testing"></a>3.4. port のテスト</h2></div></div></div><p>package 化も含め、その port が思った通りに
	動くことを確認してください。
	確認の必要な重要ポイントは以下の通りです。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>その port がインストールしないものが
	    <code class="filename">pkg-plist</code> に含まれていないこと。</p></li><li class="listitem"><p>その port がインストールする、すべてのものが
	    <code class="filename">pkg-plist</code> に含まれていること。</p></li><li class="listitem"><p><code class="buildtarget">reinstall</code>
	    ターゲットを使うことで、その port が
	    何度でもインストール可能なこと。</p></li><li class="listitem"><p>その port が deintall される際には
	    <a class="link" href="#porting-cleaning" title="16.11. 空のディレクトリの削除">後片付け</a>をすること。</p></li></ul></div><div class="procedure"><a id="idp74472400"></a><div class="procedure-title">手順3.1 推奨されるテストの手順</div><ol class="procedure" type="1"><li class="step"><p><code class="command">make install</code></p></li><li class="step"><p><code class="command">make package</code></p></li><li class="step"><p><code class="command">make deinstall</code></p></li><li class="step"><p><code class="command">pkg_add package 名
	    </code></p></li><li class="step"><p><code class="command">make deinstall</code></p></li><li class="step"><p><code class="command">make reinstall</code></p></li><li class="step"><p><code class="command">make package</code></p></li></ol></div><p><code class="buildtarget">package</code> および
	<code class="buildtarget">deinstall</code> の段階で、
	どんな警告 (warning) も出力されないことを確認してください。
	ステップ 3 の後、(訳注: その port が作成した) すべての新しい
	ディレクトリが正しく消去されていることを確認してください。
	また、ステップ 4 の後にそのソフトウェアを使用してみて、
	package からインストールされた場合にも正しく動作することを
	確認してください。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-portlint"></a>3.5. <code class="command">portlint</code> によるチェック</h2></div></div></div><p><code class="command">portlint</code> を使い、その port が FreeBSD の
	ガイドラインに沿っているかどうかを確認してください。
	<code class="command">portlint</code> プログラムは ports collection に
	含まれています。
	特に、<a class="link" href="#porting-samplem" title="第17章 Makefile のサンプル">Makefile</a> が
	正しい形式になっているか、
	<a class="link" href="#porting-pkgname" title="5.2.4. package 名についての規則">package</a> の
	名前が正しいかどうかをチェックするのに良いでしょう。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-submitting"></a>3.6. port の提出</h2></div></div></div><p>まず、<a class="link" href="#porting-dads" title="第16章 やっていいことといけないこと"> やって良いこと悪いこと</a>の
	セクションを読んでください。</p><p>さて、満足のいく port が完成したら、残るは
	それを FreeBSD のメインの ports ツリーに置いて、
	他の人にも使ってもらうだけです。
	<code class="filename">work</code> ディレクトリや
	<code class="filename">pkgname.tgz</code> といった package は
	必要ありませんから、まずこれらを消去してください。
	あとは <code class="command">shar `find port_dir`</code> の出力を
	バグレポートに入れ、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=send-pr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">send-pr</span>(1)</span></a> プログラムを使用して
	送ってください (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=send-pr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">send-pr</span>(1)</span></a> についての詳細は<a class="link" href="../../articles/contributing/contrib-how.html#CONTRIB-GENERAL" target="_top">
	バグ報告と一般的な論評</a>を参照してください)。
	もし、圧縮していない状態で 20KB 以上あるような port であれば、
	それを ひとつの tar ファイルにまとめて圧縮し、
	バグレポートに入れる前に <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=uuencode&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">uuencode</span>(1)</span></a> を使用してください
	(20KB 以下のものを tar ファイルにして送っても良いのですが、
	あまり歓迎されません)。
	バクレポートの category は必ず <code class="literal">ports</code>,
	class は <code class="literal">change-request</code> としてください
	(レポートを <code class="literal">confidential</code> (機密) 指定には
	しないでください!)。
	また、port 化したプログラムの短い説明文を
	バグレポートの <span class="quote">「<span class="quote">Description</span>」</span> フィールドに追加して、
	<span class="quote">「<span class="quote">Fix</span>」</span> フィールドには shar したファイル、
	もしくは uuencode した
	tar ファイルを追加するようにしてください。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">障害報告の概要 (synopsis) 欄がよく書けていると、
	  わたしたちが作業しやすくなります。
	  新しい port を提出するなら
	  <span class="quote">「<span class="quote">New port: &lt;カテゴリ&gt;/&lt;port 名&gt;
	  &lt;短い port の概要&gt;</span>」</span>、
	  port の更新なら、
	  <span class="quote">「<span class="quote">Update port: &lt;カテゴリ&gt;/&lt;port 名&gt;
	  &lt;短い更新の概要&gt;</span>」</span>
	  のような形が歓迎されます。
	  この考え方に沿っていれば、
	  誰かがあなたの障害報告を時間をおかずに見てくれる可能性が高くなります。</p></div><p>もう一度、<span class="emphasis"><em>オリジナルのソースファイルや
	<code class="filename">work</code> ディレクトリ、
	<code class="command">make package</code> で作成した package が
	含まれていないこと</em></span>を確認してください。</p><p>port を提出したら、辛抱強くお待ちください。時には、ある
	port が FreeBSD に取り込まれるまで、数日しかかかりそうもないの
	に、数ヶ月かかることもあります。<a class="link" href="http://www.FreeBSD.org/cgi/query-pr-summary.cgi?category=ports" target="_top">
	FreeBSD へのコミット待ちの ports</a> の一覧が見られます。</p><p>わたしたちがひとたびその port をチェックしたら、必要なら
	あなたに確認して、それをツリーへ置きます。
	あなたの名前は<a class="link" href="../../articles/contributors/contrib-additional.html" target="_top">その他の
	  FreeBSD への貢献者</a>の一覧やその他のファイルにも載るでしょう。
	う〜ん、素晴らしい。:-)</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="slow"></a>第4章 本格的な port</h1></div></div></div><div class="toc"><div class="toc-title">目次</div><dl class="toc"><dt><span class="sect1"><a href="#slow-work">4.1. port 構築の詳細</a></span></dt><dt><span class="sect1"><a href="#slow-sources">4.2. オリジナルのソースの入手</a></span></dt><dt><span class="sect1"><a href="#slow-modifying">4.3. port の修正</a></span></dt><dt><span class="sect1"><a href="#slow-patch">4.4. パッチの適用</a></span></dt><dt><span class="sect1"><a href="#slow-configure">4.5. コンフィグレーション</a></span></dt><dt><span class="sect1"><a href="#slow-user-input">4.6. ユーザからの入力の扱い</a></span></dt></dl></div><p>残念ながら移植がそう簡単ではなく、それを動かすために
      多少の変更が必要になる場合もあるでしょう。
      このセクションでは、模範的な ports の作法に従い、
      どのように変更を行なって動くようにするのかを
      順を追って説明します。</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-work"></a>4.1. port 構築の詳細</h2></div></div></div><p>まず、あなたが port のディレクトリで
	<code class="command">make</code> と
	入力してから起こる一連の出来事について、
	順を追って説明します。
	ここを読むときには、別のウィンドウに
	<code class="filename">bsd.port.mk</code> を表示しておくと
	理解の助けになるかもしれません。</p><p>しかし、<code class="filename">bsd.port.mk</code> が何をしているのか
	完全に理解できなくても 心配する必要はありません。
	それほど多くの人が理解している というわけでは ありませんから…。
	<span class="emphasis"><em>f(^_^;)</em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>まず、<code class="buildtarget">fetch</code> という
	    ターゲットが実行されます。
	    この <code class="buildtarget">fetch</code> ターゲットは、
	    配布ファイルがローカルの <code class="varname">DISTDIR</code> に
	    存在することを保証する役目を持っています。
	    もし必要なファイルが <code class="varname">DISTDIR</code> に
	    存在しなければ、<code class="buildtarget">fetch</code> ターゲットは
	    <code class="filename">Makefile</code> で指定された
	    <code class="varname">MASTER_SITES</code> 中の URL や、
	    FreeBSD のメイン FTP サイト <code class="uri"><a class="uri" href="ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/" target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/</a></code>
	    (ここにはバックアップとして、われわれ ports 管理者が確認した
	    配布ファイルを置いてあります) を探しにいきます。
	    <code class="command">make</code> を実行するマシンがインターネットに
	    接続されていて、目的のファイルを <code class="varname">FETCH</code> で
	    取ってこれた場合には、それを <code class="varname">DISTDIR</code> に
	    保存します。</p></li><li class="step"><p>次に <code class="buildtarget">extract</code> ターゲットが実行されます。
	    このターゲットは <code class="varname">DISTDIR</code> から
	    配布ファイル (普通は gzip された tar ファイル) を読み込み、
	    その内容を作業ディレクトリ <code class="varname">WRKDIR</code>
	    (デフォルトでは <code class="filename">work</code>) に展開します。</p></li><li class="step"><p>次に <code class="buildtarget">patch</code> ターゲットが実行されます。
	    まず、<code class="varname">PATCHFILES</code> にパッチファイルが
	    指定されていれば、そのパッチを適用します。

	    次に、<code class="varname">PATCHDIR</code> ディレクトリ
	    (デフォルトでは <code class="filename">files</code> サブディレクトリ) に
	    <code class="filename">patch-*</code> という
	    名前のパッチファイルが存在すれば、
	    これらをアルファベット順に適用します。</p></li><li class="step"><p>次に <code class="buildtarget">configure</code> ターゲットが
	    実行されます。
	    これには、いろいろな場合があります。</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><code class="filename">scripts/configure</code> が
		存在する場合には、そのスクリプトが実行されます。</p></li><li class="listitem"><p><code class="varname">HAS_CONFIGURE</code> または
		<code class="varname">GNU_CONFIGURE</code> がセットされていれば、
		<code class="filename">WRKSRC/configure</code> が
		実行されます。</p></li><li class="listitem"><p><code class="varname">USE_IMAKE</code> がセットされていれば、
		<code class="varname">XMKMF</code>
		(デフォルトでは <code class="command">xmkmf -a</code>) が
		実行されます。</p></li></ol></div></li><li class="step"><p>最後に <code class="buildtarget">build</code> ターゲットが実行されます。
	    これは作業ディレクトリ (<code class="varname">WRKSRC</code>) に降りていき、
	    ビルド (コンパイル) を実行するのが役目です。
	    <code class="varname">USE_GMAKE</code> がセットされていれば
	    GNU <code class="command">make</code> が使用され、
	    セットされていなければ FreeBSD の <code class="command">make</code> が
	    使用されます。</p></li></ol></div><p>上記はデフォルトの動作です。これに加えて
	<code class="buildtarget">pre-<em class="replaceable"><code> 何とか</code></em></code>や
	<code class="buildtarget">post-<em class="replaceable"><code> 何とか</code></em></code>という
	ターゲットを定義したり、そのような名前のスクリプトを
	<code class="filename">scripts</code> サブディレクトリに置くことも可能で、
	それぞれデフォルトの動作の前や後に実行されます。</p><p>たとえば、<code class="buildtarget">post-extract</code> ターゲットが
	<code class="filename">Makefile</code> に定義されていて、
	<code class="filename">scripts</code> サブディレクトリに
	<code class="filename">pre-build</code> というファイルが置かれている場合、
	<code class="buildtarget">post-extract</code> ターゲットは
	通常の展開動作の後に呼び出され、
	<code class="filename">pre-build</code> スクリプトは
	デフォルトのコンパイル動作の前に実行されます。
	実行する動作が簡単であれば、スクリプトよりも
	<code class="filename">Makefile</code> のターゲットを使用することが
	推奨されています。
	なぜなら、その port では どのような非標準の動作が必要とされるのか、
	一箇所にまとめて書いてあった方が他の人に理解しやすいからです。</p><p>デフォルトの動作は <code class="filename">bsd.port.mk</code> の
	<code class="buildtarget">do-<em class="replaceable"><code> 何とか</code></em></code>という
	ターゲットで実行されます。
	たとえば port を展開するコマンドは
	<code class="buildtarget">do-extract</code> ターゲットに書かれています。
	もしデフォルトのターゲットに不満があれば、
	<code class="filename">Makefile</code> 中で
	<code class="buildtarget">do-<em class="replaceable"><code> 何とか</code></em></code>という
	ターゲットを再定義することにより、
	好きなように変更することができます。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><span class="quote">「<span class="quote">メイン</span>」</span>のターゲット
	  (たとえば <code class="buildtarget">extract</code>,
	  <code class="buildtarget">configure</code>、その他) は、
	  すべての前段階が実行されていることを確認してから、
	  実際のターゲットやスクリプトを呼び出す以外のことは
	  行ないませんし、これらが変更されることも想定されていません。
	  もし展開の方法を変更したいときには
	  <code class="buildtarget">do-extract</code> の変更によって実現し、
	  <code class="buildtarget">extract</code>
	  の動作は絶対に変更しないでください。</p></div><p>これで、ユーザが <code class="command">make</code> と
	入力したときに何が起こるのかが理解できたと思います。
	では、完璧な port を作成するための推奨手順を
	順に見ていきましょう。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-sources"></a>4.2. オリジナルのソースの入手</h2></div></div></div><p>(通常の場合、) 圧縮された tar ファイルの形
	(<code class="filename">foo.tar.gz</code> あるいは
	<code class="filename">foo.tar.Z</code>) で
	オリジナルのソースを入手して、
	それを <code class="varname">DISTDIR</code> にコピーします。
	できる限り、<span class="emphasis"><em>主流の</em></span>ソースを
	使用するようにしてください。</p><p>もとの tar ファイルがどこにあるかを示すために、変数
	<code class="varname">MASTER_SITES</code> を設定する必要があります。
	主なサイトのほとんどについては省略形が
	<code class="filename">bsd.sites.mk</code> で定義されています。
	これらのサイト (と付随する定義)
	を、ソースコード内で同じ情報が繰り返されるのを避けるために、
	可能な限り使うようにしてください。
	これらのサイトは時とともに変わってゆきますので、そうしないと、
	関係者一同にとってメンテナンスの悪夢になってしまいます。</p><p>ネットワークへの接続の良好な FTP/HTTP サイトを
	見つけることができなかったり、頭にくるような非標準的な形式しか
	置いていないサイトしか見つけられないときには、
	自分の管理下にあり信頼できる FTP サーバや HTTP サーバ
	(たとえば、あなた自身のホームページ) に置くこともできます。</p><p>そのような便利かつ信頼のおける置き場所が見つからない場合、
	我々が <code class="systemitem">ftp.FreeBSD.org</code> に
	<span class="quote">「<span class="quote">置き場所</span>」</span>を提供することもできますが、
	これはなるべく避けたい解決法です。
	配布ファイルは、誰かの <code class="systemitem">freefall</code> アカウントの
	<code class="filename">~/public_distfiles/</code> に置かれることでしょう。
	その port をコミットする人に、置いてもらえるように頼んでください。
	その人は配布ファイルを置いて、<code class="varname">MASTER_SITES</code> を
	<code class="varname">MASTER_SITE_LOCAL</code> にセットし、
	<code class="varname">MASTER_SITE_SUBDIR</code> には
	自分の <code class="systemitem">freefall</code> ユーザ名を
	入れておいてくれるでしょう。</p><p>その port の配布ファイルが、
	作者によるバージョン更新のようなことがなく変更されるなら、
	その配布ファイルを
	あなたのホームページに置いて、<code class="varname">MASTER_SITES</code> の
	最初に指定することも考えてみてください。できれば、その port
	の作者にそういうことをしないようにお願いしてみてください。
	そのためには、何かしらのソースコード管理を行うと役に立つでしょう。
	あなたが独自のバージョンを置けば、ユーザが
	<span class="errorname">checksum mismatch</span>
	エラーに悩まされることもなくなりますし、FreeBSD の FTP サイトの
	保守担当者の負担も減らすこともできます。
	また、その port にマスターサイトが一つしか存在しない場合には、
	あなたのサイトにバックアップを置き、
	それを <code class="varname">MASTER_SITES</code> の 2 番目に
	指定すると良いでしょう。</p><p>その port がインターネット上で入手できる追加パッチを
	必要とするのなら、それも取ってきて
	<code class="varname">DISTDIR</code> に置いてください。
	それらがメインのソースの tar ファイルとは別のサイトに
	あったとしても、心配する必要はありません。
	そのような状況にも ちゃんと対応できるようになっています
	(後述の <a class="link" href="#porting-patchfiles" title="5.4.6. PATCHFILES">PATCHFILES の記述</a>を
	ご覧ください)。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-modifying"></a>4.3. port の修正</h2></div></div></div><p>作業用のディレクトリに tar ファイルを展開し、
	最新バージョンの FreeBSD 上で正しくコンパイルするために必要な、
	あらゆる変更を行ないます。
	この処理は最終的に自動化するわけですから、
	何を行なったかを<span class="emphasis"><em>注意深く記録しておきましょう</em></span>。
	この port が完成した暁には、ファイルの削除、追加、
	修正を含むすべての処理が自動化されたスクリプトや
	パッチファイルで行なえるようになっていなければなりません。</p><p>その port のコンパイルやインストールのために必要な手作業が
	あまりに多いようならば、Larry Wall の芸術的な
	<span class="application">Configure</span> スクリプトを
	参考にしたほうが良いかもしれません。
	新しい ports collection は、エンドユーザにとって個々の port が
	可能な限り<span class="quote">「<span class="quote">プラグ &amp; プレイ</span>」</span>かつ
	最小のディスク消費で make できることを目指しています。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">明示的に記述されている場合を除き、あなたが作成して
	  FreeBSD の ports collection に寄付したパッチファイル、
	  スクリプトおよびその他のファイルは、標準的な BSD の
	  著作権条件によりカバーされているものと見なされます。</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-patch"></a>4.4. パッチの適用</h2></div></div></div><p>port の準備段階で追加されたり変更されたりしたファイルは、
	再帰的 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> により後で <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=patch&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">patch</span>(1)</span></a>
	に与えられる形にすることができます。
	パッチは適当にまとめて
	<code class="filename">patch-*</code>
	という名前のファイルに入れてください。
	<code class="filename">*</code>
	はパッチが適用される順番を示します ― これらは
	<span class="emphasis"><em>アルファベット順</em></span>、
	つまり <code class="literal">aa</code> が最初、
	<code class="literal">ab</code> が その次といった順番で処理されます。
	お望みなら、<code class="filename">patch-Imakefile</code> とか
	<code class="filename">patch-src-config.h</code> のように、
	パッチ対象のファイルのパス名を示す名前を使うこともできます。
	これらのファイルは <code class="varname">PATCHDIR</code> に置いてください。
	そうすれば自動的に適用されるようになっています。
	すべてのパッチは <code class="varname">WRKSRC</code>
	からの相対パスにするべきです (通常、<code class="varname">WRKSRC</code>
	は port の tar ファイルが展開されるディレクトリで、
	make が実行されるところと同じです)。
	修正やアップグレードを容易にするため、
	複数のパッチで同じファイルを修正するのは避けてください
	(たとえば、<code class="filename">patch-aa</code> と
	<code class="filename">patch-ab</code> が共に
	<code class="filename">WRKSRC/foobar.c</code>
	を修正するなど)。</p><p>RCS
	にとって特別な意味を持つ文字列をパッチ内に入れないようにしてください。
	ファイルを私たちのソースツリーに入れる時、
	これらの文字列は CVS によって書き換えられてしまい、
	後でまたパッチを使おうとした時にうまくいかないことがあります。
	RCS 文字列はドル記号 (<code class="literal">$</code>)
	で囲まれており、
	<code class="literal">$FreeBSD</code> や
	<code class="literal">$RCS</code>
	などで始まります。</p><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> の再帰 (<code class="option">-r</code>)
	フラグを使って再帰的なパッチを作るのは大変結構なのですが、
	でき上がったパッチは必ず目でチェックして余計なゴミが入っていないことを確認してください。
	よくあるのはバックアップファイル同士の変更点、あるいは
	<code class="command">Imake</code> や
	GNU <code class="command">configure</code>
	を使うソフトウェアの
	<code class="filename">Makefile</code>
	の変更点が入っている場合などです。
	また <code class="filename">configure.in</code> を編集して
	<code class="command">autoconf</code> を使って
	<code class="command">configure</code> を作り直すときには、
	<code class="command">configure</code> の diff は含めずに
	(それらは良く数千行におよぶことがあります)、
	<code class="literal">USE_AUTOCONF=yes</code> を定義して
	<code class="filename">configure.in</code> の
	diff をとってください。</p><p>ファイルをまるごと消す場合には、
	パッチを使わずに
	<code class="buildtarget">post-extract</code>
	ターゲットで消す方が簡単です。
	できあがった差分に満足したら、
	それらをソースのファイルごとに別々のパッチファイルに分割してください。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-configure"></a>4.5. コンフィグレーション</h2></div></div></div><p>カスタマイズのために追加したいコマンドがあれば、
	<code class="filename">configure</code> という名前のスクリプトに入れて
	<code class="filename">scripts</code> サブディレクトリに置いてください。
	上で述べたように、<code class="filename">pre-configure</code>
	あるいは <code class="filename">post-configure</code> という
	<code class="filename">Makefile</code> ターゲットや、
	スクリプトで処理することもできます。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slow-user-input"></a>4.6. ユーザからの入力の扱い</h2></div></div></div><p>もし、その port がビルド、コンフィグレーション、または
	インストールの際にユーザからの入力を必要とするならば、
	<code class="filename">Makefile</code> 中で
 	<code class="varname">IS_INTERACTIVE</code> を設定しなければなりません。
	これにより、ユーザが環境変数 <code class="envar">BATCH</code> を
	セットしている場合には、この port の処理がスキップされるので
	<span class="quote">「<span class="quote">夜間の無人ビルド</span>」</span> が実行可能になります。
	(逆に環境変数 <code class="envar">INTERACTIVE</code> がセットされていると、
	ユーザからの入力を必要とする port <span class="emphasis"><em>だけ</em></span>が
 	コンパイルされます)。
 	これは、連続して ports をビルドするマシン群で、
 	無駄になる時間を大きく減らします。</p><p>もし、適切なデフォルト設定が存在するのであれば、
	<code class="varname">PACKAGE_BUILDING</code> 変数をチェックして、
	それが設定されている場合には
	ユーザ入力のスクリプトを起動しないようにしてください。
	こうすることによって、我々 ports 管理者が
	CDROM や FTP に 置く package を作成することができます。
      </p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile"></a>第5章 <code class="filename">Makefile</code> の作成</h1></div></div></div><div class="toc"><div class="toc-title">目次</div><dl class="toc"><dt><span class="sect1"><a href="#makefile-source">5.1. オリジナルのソース</a></span></dt><dt><span class="sect1"><a href="#makefile-naming">5.2. 名前の付け方</a></span></dt><dt><span class="sect1"><a href="#makefile-categories">5.3. カテゴリ分類</a></span></dt><dt><span class="sect1"><a href="#makefile-distfiles">5.4. 配布ファイル</a></span></dt><dt><span class="sect1"><a href="#makefile-maintainer">5.5. <code class="varname">MAINTAINER</code></a></span></dt><dt><span class="sect1"><a href="#makefile-comment">5.6. <code class="varname">COMMENT</code></a></span></dt><dt><span class="sect1"><a href="#makefile-depend">5.7. 依存関係</a></span></dt><dt><span class="sect1"><a href="#makefile-wrkdir">5.8. 作業ディレクトリの指定</a></span></dt><dt><span class="sect1"><a href="#conflicts">5.9. <code class="varname">CONFLICTS</code></a></span></dt><dt><span class="sect1"><a href="#makefile-build">5.10. ビルドのメカニズム</a></span></dt></dl></div><p><code class="filename">Makefile</code> の作成は非常に単純です。
      繰り返しますが、始めるまえに既存の例を見ておくことを推奨します。
      また、このハンドブックには <a class="link" href="#porting-samplem" title="第17章 Makefile のサンプル">Makefile のサンプル</a>があります。
      それを見て、Makefile 内の変数の順番や
      空行を入れるところなどの参考にしてください。
      そうすると他の人々にも読みやすいものとなります。</p><p>では、<code class="filename">Makefile</code> を設計するときに
      問題となるところを順に追って見てみましょう。</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-source"></a>5.1. オリジナルのソース</h2></div></div></div><p>ソースは <code class="filename">foozolix-1.2.tar.gz</code> といった名前の
	標準的な gzip された tar ファイルの形式で
	<code class="varname">DISTDIR</code> に置かれていますか?
	そうなっていれば、次のステップに進めます。
	異なっている場合には、変数 <code class="varname">DISTNAME</code>,
	<code class="varname">EXTRACT_CMD</code>,
	<code class="varname">EXTRACT_BEFORE_ARGS</code>,
	<code class="varname">EXTRACT_AFTER_ARGS</code>,
	<code class="varname">EXTRACT_SUFX</code>,
	<code class="varname">DISTFILES</code> のうち
	いくつかを書き換える必要があります。
	どれだけ変更しないといけないかは、その port の配布ファイルが
	どの程度標準からかけはなれているかによります
	(最もよくあるのは gzip ではなく普通の compress コマンドで
	tar ファイルが圧縮されている場合で、そのときは
	<code class="literal">EXTRACT_SUFX=.tar.Z</code> とするだけです)。</p><p>最悪の場合には、自分で
	<code class="buildtarget">do-extract</code> ターゲットを作成して、
	デフォルトを上書きすることもできます。
	しかし、そこまでする必要があることはめったにないでしょう。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-naming"></a>5.2. 名前の付け方</h2></div></div></div><p>Port の <code class="filename">Makefile</code> のはじめの部分で port
      に名前をつけ、バージョン番号を記述し、適切なカテゴリに載せます。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74828624"></a>5.2.1. <code class="varname">PORTNAME</code> および
	<code class="varname">PORTVERSION</code></h3></div></div></div><p><code class="varname">PORTNAME</code> には
	port の名前の基幹部分を入れ、
	<code class="varname">PORTVERSION</code>
	には port のバージョン番号を入れます。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74835024"></a>5.2.2. <code class="varname">PORTREVISION</code> および
	<code class="varname">PORTEPOCH</code></h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74839760"></a>5.2.2.1. <code class="varname">PORTREVISION</code></h4></div></div></div><p><code class="varname">PORTREVISION</code> 変数は単調増加する値です。
	  <code class="varname">PORTVERSION</code> が増加した時 (つまり、
	  新しいオフィシャルベンダーリリースが行なわれた時) には
	  いつでも 0 にリセットされます。
	  また、その値が 0 でない場合には package 名に追加されます。
	  <code class="varname">PORTREVISION</code> の変更は、(例えば
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_version&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_version</span>(1)</span></a> 等の) 自動化ツールが、
	  新たな package が入手できることを示すのに使われます。</p><p>その port から作られる package の内容や構造に
	  大きな影響を与える変更を行なった時には、
	  <code class="varname">PORTREVISION</code> を増やしてください。</p><p><code class="varname">PORTREVISION</code>
	  を上げる必要がある変更の例:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>セキュリティ上の脆弱性やバグを修正するため、または
	      その port に新しい機能を追加するためのパッチの追加。</p></li><li class="listitem"><p>package のコンパイル時オプションの有効化や
	      無効化のための port の <code class="filename">Makefile</code>
	      の変更。</p></li><li class="listitem"><p>パッキングリストの変更や、package のインストール時の
	      挙動の変更 (たとえば、ssh のホストキーのような package の
	      初期データを生成するスクリプトの変更など)。</p></li><li class="listitem"><p>その port が依存する共有ライブラリのバージョンを
	      上げる場合 (新しいバージョンの共有ライブラリが
	      インストールされた後に、そのライブラリに依存していた
	      古い package をインストールを試みる場合、
	      その package は新しい libfoo.(x+1) ではなく
	      古い libfoo.x を探そうとするため、インストールに失敗します。
	      (訳注: そのため、PORTREVISION を上げた package を
	      作成する必要があるわけです))。</p></li><li class="listitem"><p>ひそかに port 配布ファイルの変更が行なわれ、
	      その機能に大きな変化があった場合。
	      つまり、<code class="filename">distinfo</code> の修正を
	      必要とするような配布ファイルの変更が行なわれ、
	      新旧のバージョンの <code class="command">diff -ru</code> を取ると
	      些細とは言えない変更が認められるにもかかわらず、
	      オリジナルのバージョン番号が変更されていないことから
	      <code class="varname">PORTVERSION</code> の変更は難しい場合。</p></li></ul></div><p>PORTREVISION を上げる必要の無い変更の例:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>生成される package に機能の変化が起らないような
	      port スケルトンのスタイル変更。</p></li><li class="listitem"><p>生成される package に影響しないような
	      <code class="varname">MASTER_SITES</code> その他の
	      port に対する機能変更。</p></li><li class="listitem"><p>誤植の修正などの些細な変更で、その package のユーザが
	      アップグレードを必要とするほどには重要でないパッチ。</p></li><li class="listitem"><p>以前にはコンパイルが通らなかった package を
	      ビルド可能にするための修正 (その port が以前にビルド可能だった
	      プラットフォームにおいて、その変更により何らかの機能的な
	      違いが発生しない場合に限ります)。
	      <code class="varname">PORTREVISION</code> は package
	      の内容を反映したものなので、その package
	      が以前にビルド可能でなかったのなら、変更を示すために、
	      <code class="varname">PORTREVISION</code> を
	      増やす必要はありません。</p></li></ul></div><p>経験的な判断方法としては、ある port にコミットされた変更が
	  (それが強化や修正によるものであれ、新しい package による
	  実質的な効能であれ)、アップデートすることにより、
	  誰もが利益を受けるような何かかどうか、また定期的に ports
	  ツリーを更新している人に更新を強制するということに値するか自問してみることです。
	  もし答がイエスであれば、
	  <code class="varname">PORTREVISION</code> を上げるべきでしょう。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74898896"></a>5.2.2.2. <code class="varname">PORTEPOCH</code></h4></div></div></div><p>ソフトウェアのベンダや FreeBSD の port 作成者は、
	  以前のものよりも小さい数字のバージョン番号をつけたソフトウェアをリリースするといった、
	  何か馬鹿げたことをすることが時々あります。
	  例をあげると、ある port が foo-20000801 から foo-1.0
	  になるといった具合です
	  (数字として見ると 20000801 は 1 よりも大きいため、
	  間違って前者の方が新しいバージョンとして扱われてしまいます)。</p><p>このような場合には <code class="varname">PORTEPOCH</code>
	  バージョンを増やしてください。
	  上のセクション 0 で説明したように、
	  <code class="varname">PORTEPOCH</code> がゼロでない場合には、
	  それがパッケージ名の後ろにつけられます。絶対に
	  <code class="varname">PORTEPOCH</code>
	  を減らしたり、ゼロにリセットしてはいけません。
	  さもないと、以前に作成された package との比較に失敗する
	  (つまり、その package が古くなっていることがわからない) ためです:
	  新しいバージョン番号 (上の例では<code class="literal">1.0,1</code>) は
	  依然として前のバージョン番号 (20000801) よりも
	  数字としては小さいのですが、自動化ツールが
	  サフィックス <code class="literal">,1</code> を特別扱いすることで、
	  以前の package には明示されていないサフィックス
	  <code class="literal">,0</code> よりも新しいことがわかります。</p><p>誤って <code class="varname">PORTEPOCH</code>
	  を削除したりリセットしたりすると、終わりのない悲劇に見舞われます。
	  上記の議論を理解できないなら、
	  わかるまで議論をたどるかメーリングリストで質問してください。</p><p>大多数の ports では、<code class="varname">PORTEPOCH</code> が
	  必要になることは まず無いものと考えられています。
	  また、注意深く <code class="varname">PORTVERSION</code> を使用することで、
	  そのソフトウェアの将来のリリースがバージョン構造を変更する必要が出てきた場合にも、
	  多くの場合前もって対応しておくことができるでしょう。
	  しかし、<span class="quote">「<span class="quote">スナップショット</span>」</span>リリースのように、
	  オフィシャルなバージョン番号を持たないベンダーリリースが行なわれた時には、
	  FreeBSD 版の port 作者によるケアが必要になります。
	  そういったリリースに対し、
	  リリース日付を使ったラベルを付けたいという誘惑にかられることがあるでしょうが、
	  そうすると新しい<span class="quote">「<span class="quote">オフィシャル</span>」</span>リリースが行なわれた時に、
	  上の例で示したような問題が起きることでしょう。</p><p>例えば、あるソフトウェアのスナップショットリリースが
	  20000917 に行なわれ、以前のバージョン番号が 1.2 だったとすると、
	  そのスナップショットの <code class="varname">PORTVERSION</code> には
	  20000917 ではなく 1.2.20000917 か何か、そのような番号を
	  指定するのが良いでしょう。
	  そうしておけば、例えばバージョン番号 1.3 として後続のリリースが
	  行なわれた場合にも、大小関係が崩されずにすむわけです。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74918992"></a>5.2.2.3. <code class="varname">PORTREVISION</code> と
	  <code class="varname">PORTEPOCH</code> の使い方の例</h4></div></div></div><p><code class="literal">gtkmumble</code> の port,
	  バージョン <code class="literal">0.10</code> が
	  ports collection にコミットされます。</p><pre class="programlisting">PORTNAME=       gtkmumble
PORTVERSION=    0.10</pre><p><code class="varname">PKGNAME</code> は
	  <code class="literal">gtkmumble-0.10</code> になります。</p><p>ローカルな FreeBSD パッチを必要とする
	  セキュリティホールが発見されました。
	  それに合わせて <code class="varname">PORTREVISION</code> を増やします。</p><pre class="programlisting">PORTNAME=       gtkmumble
PORTVERSION=    0.10
PORTREVISION=   1</pre><p><code class="varname">PKGNAME</code> は
	  <code class="literal">gtkmumble-0.10_1</code> になります。</p><p>ベンダから <code class="literal">0.2</code> という番号が振られた
	  新バージョンがリリースされます (これにより、
	  作者は <code class="literal">0.10</code> という番号を
	  <span class="quote">「<span class="quote">0.9 の次という意味ではなく</span>」</span>、
	  実際には <code class="literal">0.1.0</code> のつもりで
	  使用していたことがわかります - あらら、今さら遅すぎる)。
	  新しいマイナーバージョン <code class="literal">2</code>
	  は数字として以前のバージョン番号
	  <code class="literal">10</code> より小さいので、
	  強制的に新しい package <span class="quote">「<span class="quote">の方が新しい</span>」</span>と認識させるため
	  <code class="varname">PORTEPOCH</code> を増やす必要があります。
	  これは新しいベンダーリリースなので、
	  <code class="varname">PORTREVISION</code> は 0 にリセット
	  (または <code class="filename">Makefile</code> から削除) されます。</p><pre class="programlisting">PORTNAME=       gtkmumble
PORTVERSION=    0.2
PORTEPOCH=      1</pre><p><code class="varname">PKGNAME</code> は
	  <code class="literal">gtkmumble-0.2,1</code> になります。</p><p>次のリリースは 0.3 です。
	  <code class="varname">PORTEPOCH</code> は減少することが無いため、
	  今度のバージョン変数は次のようになります:</p><pre class="programlisting">PORTNAME=       gtkmumble
PORTVERSION=    0.3
PORTEPOCH=      1</pre><p><code class="varname">PKGNAME</code> は
	  <code class="literal">gtkmumble-0.3,1</code> になります。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">もし、このアップグレードによって
	    <code class="varname">PORTEPOCH</code> が <code class="literal">0</code> に
	    リセットされたとすると、<code class="literal">3</code> は数字として
	    <code class="literal">10</code> よりも小さいため、
	    <code class="literal">gtkmumble-0.10_1</code>
	    の package をインストールした誰かは
	    <code class="literal">gtkmumble-0.3</code> の package
	    の方が新しいことに気がつかないことになるでしょう。
	    これが、そもそも <code class="varname">PORTEPOCH</code>
	    が導入された肝心な理由です。</p></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp74991952"></a>5.2.3. <code class="varname">PKGNAMEPREFIX</code> および
	<code class="varname">PKGNAMESUFFIX</code></h3></div></div></div><p>二つのオプション変数 <code class="varname">PKGNAMEPREFIX</code> と
	<code class="varname">PKGNAMESUFFIX</code> は、
	<code class="varname">PORTNAME</code> および
	<code class="varname">PORTVERSION</code> と結合され、
	<code class="varname">PKGNAME</code> を
	<code class="literal">${PKGNAMEPREFIX}${PORTNAME}${PKGNAMESUFFIX}-${PORTVERSION}</code>
	として定義します。
	この時、<a class="link" href="#porting-pkgname" title="5.2.4. package 名についての規則">適切な package 名を選ぶための
	ガイドライン</a>に沿っているかどうかを確認してください。
	特に、<code class="varname">PORTVERSION</code> 中に
	ハイフン (<code class="literal">-</code>)
	を使用することは<span class="emphasis"><em>禁止</em></span>されています。
	また、package 名に
	<em class="replaceable"><code>language-</code></em> もしくは
	<em class="replaceable"><code>-compiled.specifics</code></em> 部分が
	含まれる場合、それぞれ <code class="varname">PKGNAMEPREFIX</code> と
	<code class="varname">PKGNAMESUFFIX</code> を使用してください。
	これらを <code class="varname">PORTNAME</code> の一部としてはいけません。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-pkgname"></a>5.2.4. package 名についての規則</h3></div></div></div><p>package の名前は以下のルールにしたがってつけてください。
	  これは package のディレクトリを見やすくするためで、
	  既に何千ものパッケージがありますし、
	  目を痛めてしまうようだとユーザはそっぽを向くでしょう。</p><p>package の名前は以下のようにしてください。
	  <code class="filename">言語-名前-オプションバージョン.番号</code></p><p>package 名は
	  <code class="literal">${PKGNAMEPREFIX}${PORTNAME}${PKGNAMESUFFIX}-${PORTVERSION}</code>
	  というように定義されています。
	  変数がこの書式と適合していることを確認してください。</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>FreeBSD
	      はユーザの慣れ親しんだ言語のサポートに力を入れています。
	      特定の言語のための port の package 名には
	      <em class="replaceable"><code>言語-</code></em> に ISO-639
	      で定義されている言語名の略称を入れてください。
	      たとえば日本語なら <code class="literal">ja</code>、
	      ロシア語なら <code class="literal">ru</code>、
	      ベトナム語なら <code class="literal">vi</code>、
	      中国語なら <code class="literal">zh</code>、
	      韓国語ならば <code class="literal">ko</code>、
	      ドイツ語なら <code class="literal">de</code>
	      といった具合です。</p><p>port がある言語地域に特化したものである場合には、
	      さらに二文字の国名コードを付加してください。
	      たとえば合衆国英語圏は <code class="literal">en_US</code> となり、
	      スイスのフランス語圏は <code class="literal">fr_CH</code> となります。</p><p><em class="replaceable"><code>言語-</code></em> 部分は、
	      <code class="varname">PKGNAMEPREFIX</code> 変数に
	      定義されなければなりません。</p></li><li class="listitem"><p><code class="filename">名前</code>の部分の最初の文字は
	      小文字でなければなりません。
	      (名前の残りの部分は大文字を含んでいても構わないため、
	      大文字を含んだソフトウェア名を変換する際の規則は、
	      あなた自身の裁量に任されています。)

	      <code class="literal">perl 5</code> のモジュールでは先頭に
	      <code class="literal">p5-</code> を付け、
	      二重コロン (<code class="literal">::</code>)
	      のセパレータをハイフン
	      (<code class="literal">-</code>)
	      に置きかえる習慣になっています。
	      たとえば
	      <code class="literal">Data::Dumper</code> は
	      <code class="literal">p5-Data-Dumper</code> になります。
	      また、そのソフトウェアの名前として通常使われるものに番号、
	      ハイフン、あるいは下線が入っている場合には、
	      それらを使うことも構いません
	      (<code class="literal">kinput2</code>など)。</p></li><li class="listitem"><p>コンパイル時に環境変数や
	      <code class="command">make</code> の引数などで<a class="link" href="#porting-masterdir" title="第7章 MASTERDIR">ハードコードされたデフォルト</a>を変えてコンパイルできる場合、
	      <em class="replaceable"><code>-compiled.specifics</code></em>
	      にそのコンパイル時のデフォルトを入れてください
	      (ハイフンはあってもなくてもかまいません)。
	      用紙のサイズ、あるいはフォントの解像度などがこれにあたります。</p><p><em class="replaceable"><code>-compiled.specifics</code></em> 部分は、
	      <code class="varname">PKGNAMESUFFIX</code> 変数に定義されなければなりません。</p></li><li class="listitem"><p>バージョン番号は数字とアルファベットからなり、
	      ピリオド (.) で区切ります。
	      アルファベットは二文字以上続けてはいけません。
	      唯一の例外は<span class="quote">「<span class="quote">パッチレベル</span>」</span>を意味する文字列
	      <code class="literal">pl</code> で、
	      それ以外にバージョン番号がまったくついていない場合にのみ使うことができます。
	      もしソフトウェアのバージョンに
	      <span class="quote">「<span class="quote">alpha</span>」</span>, <span class="quote">「<span class="quote">beta</span>」</span>, <span class="quote">「<span class="quote">rc</span>」</span>
	      や <span class="quote">「<span class="quote">pre</span>」</span> といった文字列が含まれるなら、
	      ピリオドの後に最初の一文字をとってください。
	      これらの後に、さらにバージョン文字列が続く場合には、
	      一文字のアルファベットの後にピリオドをつけずに番号を続けます。</p><p>この考え方は、
	      バージョン文字列を見て簡単に ports を並べられるようにするためのものです。
	      特に、バージョン番号の各部分が必ずピリオドで区切られていること、
	      また日付の部分がバージョン文字列の一部となっている場合には

	      <code class="literal">yyyy.mm.dd</code>

	      という書式を使っていることを確認してください。

	      <code class="literal">dd.mm.yyyy</code>

	      や、2000 年問題に対応していない

	      <code class="literal">yy.mm.dd</code>

	      という書式を使ってはいけません。</p></li></ol></div><p>では、<code class="varname">DISTNAME</code>を正しい
	  <code class="varname">PKGNAME</code>
	  に直す例を見てみましょう:</p><p>以下は、ソフトウェアの作者が決めた名前から
	  適切な package 名に変換する方法を示した (実際の) 例です。</p><div class="informaltable"><table border="0"><colgroup><col /><col /><col /><col /><col /><col /></colgroup><thead><tr><th>配布名</th><th><code class="varname">PKGNAMEPREFIX</code></th><th><code class="varname">PORTNAME</code></th><th><code class="varname">PKGNAMESUFFIX</code></th><th><code class="varname">PORTVERSION</code></th><th>理由</th></tr></thead><tbody><tr><td>mule-2.2.2</td><td>(空)</td><td>mule</td><td>(空)</td><td>2.2.2</td><td>変更の必要はありません</td></tr><tr><td>XFree86-3.3.6</td><td>(空)</td><td>XFree86</td><td>(空)</td><td>3.3.6</td><td>変更の必要はありません</td></tr><tr><td>EmiClock-1.0.2</td><td>(空)</td><td>emiclock</td><td>(空)</td><td>1.0.2</td><td>プログラム一つだけの時は小文字のみ</td></tr><tr><td>rdist-1.3alpha</td><td>(空)</td><td>rdist</td><td>(空)</td><td>1.3.a</td><td><code class="literal">alpha</code> のような文字列は使えない</td></tr><tr><td>es-0.9-beta1</td><td>(空)</td><td>es</td><td>(空)</td><td>0.9.b1</td><td><code class="literal">alpha</code> のような文字列は使えない</td></tr><tr><td>mailman-2.0rc3</td><td>(空)</td><td>mailman</td><td>(空)</td><td>2.0.r3</td><td><code class="literal">rc</code> のような文字列は使えない</td></tr><tr><td>v3.3beta021.src</td><td>(空)</td><td>tiff</td><td>(空)</td><td>3.3</td><td>なんなんでしょう ;)</td></tr><tr><td>tvtwm</td><td>(空)</td><td>tvtwm</td><td>(空)</td><td>pl11</td><td>バージョン番号は必ず必要</td></tr><tr><td>piewm</td><td>(空)</td><td>piewm</td><td>(空)</td><td>1.0</td><td>同上</td></tr><tr><td>xvgr-2.10pl1</td><td>(空)</td><td>xvgr</td><td>(空)</td><td>2.10.1</td><td><code class="literal">pl</code> が使えるのは、
		  他にメジャー/マイナーバージョン番号がない場合のみ</td></tr><tr><td>gawk-2.15.6</td><td>ja-</td><td>gawk</td><td>(空)</td><td>2.15.6</td><td>日本語バージョン</td></tr><tr><td>psutils-1.13</td><td>(空)</td><td>psutils</td><td>-letter</td><td>1.13</td><td>コンパイル時に用紙のサイズを指定</td></tr><tr><td>pkfonts</td><td>(空)</td><td>pkfonts</td><td>300</td><td>1.0</td><td>300dpiフォント用の package</td></tr></tbody></table></div><p>オリジナルのソースにまったくバージョン情報が見当たらず、
	  また原作者が新しいバージョンをリリースする可能性が低いときには、
	  バージョン番号として
	  <code class="literal">1.0</code> を使えばいいでしょう
	  (上記の <code class="literal">piewm</code> の例がこれにあたります)。
	  そうでない場合には原作者に聞くか、日付
	  (<code class="literal">yyyy.mm.dd</code>)
	  を使うなどしてください。</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-categories"></a>5.3. カテゴリ分類</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75247568"></a>5.3.1. <code class="varname">CATEGORIES</code></h3></div></div></div><p>パッケージが作成されると
	  <code class="filename">/usr/ports/packages/All</code> に置かれ、一つ以上の
	  <code class="filename">/usr/ports/packages</code>
	  のサブディレクトリからリンクが張られます。
	  これらのサブディレクトリの名称は、<code class="varname">CATEGORIES</code>
	  変数で指定されます。これは、ユーザが FTP サイトや CDROM
	  のパッケージの山から探し出すのを容易にするためのものです。
	  既存の<a class="link" href="#porting-categories" title="5.3.2. 現在のカテゴリのリスト">カテゴリ</a>を参照して、
	  あなたの port にふさわしいものを選んでください。</p><p>また、このリストは、その port が
	  ports ツリーのどこにインポートされるかも決定します。
	  ここに複数のカテゴリを指定すると、port
	  のファイルは最初のカテゴリ名のサブディレクトリに置かれることになります。
	  適切なカテゴリの選択方法については<a class="link" href="#porting-categories" title="5.3.2. 現在のカテゴリのリスト">カテゴリ</a>節をご覧ください。</p><p>あなたが作成した port
	  が、本当に既存のどのカテゴリにも当てはまらない場合には、
	  新たにカテゴリ名を作成することもできます。
	  その場合、新しいカテゴリを提案するメールを <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">FreeBSD ports メーリングリスト</a>
	  宛に送ってください。
	  しかし、一般的にはあなたが提案したカテゴリにあてはまる ports
	  が一握りではすまない場合でなければ、
	  あなたの提案は却下されるでしょう。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">時々、カテゴリを 2 階層構造や、
	  何か他のキーワードを利用した構造に再構成することを提案する人がいます。
	  今日まで、その提案はどれも実現しませんでした。
	  なぜなら、その構成を実現することは簡単なのですが、既存の Ports
	  Collection 全体を構成しなおしたものに合わせて改修する労力は、
	  控え目にいっても気が遠くなるものだからです。
	  こういうアイディアを送る前に、
	  それらの提案の歴史をメーリングリストのアーカイブで調べてください。
	  さらに、動作するプロトタイプを示せと言われるのに対する準備をしておきましょう。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-categories"></a>5.3.2. 現在のカテゴリのリスト</h3></div></div></div><p>ここに現在の port のカテゴリの一覧を示します。
	  アスタリスク(<code class="literal">*</code>)
	  が付いているものは仮想 (<span class="emphasis"><em>virtual</em></span>)
	  カテゴリです ―
	  これらには対応するサブディレクトリが
	
	  port ツリーにはありません。
	  これらは第 2 の補助的なカテゴリとして、
	  検索目的にしか使われません。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">仮想カテゴリでないものは、
	  そのサブディレクトリ内の
	  <code class="filename">pkg/COMMENT</code>
	  に一行の記述があります
	  (例: <code class="filename">archivers/pkg/COMMENT</code>)。</p></div><div class="informaltable"><table border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>カテゴリ</th><th>説明</th><th>Notes</th></tr></thead><tbody><tr><td><code class="filename">accessibility</code></td><td>障害を持ったユーザの役に立つ ports</td><td>〓</td></tr><tr><td><code class="filename">afterstep*</code></td><td><a class="link" href="http://www.afterstep.org" target="_top">AfterStep</a>
		  ウィンドウマネージャをサポートする ports</td><td>〓</td></tr><tr><td><code class="filename">arabic</code></td><td>アラビア語サポート</td><td>〓</td></tr><tr><td><code class="filename">archivers</code></td><td>アーカイブ用ツール</td><td>〓</td></tr><tr><td><code class="filename">astro</code></td><td>天文学関連の ports</td><td>〓</td></tr><tr><td><code class="filename">audio</code></td><td>サウンドをサポートする ports</td><td>〓</td></tr><tr><td><code class="filename">benchmarks</code></td><td>ベンチマークユーティリティ</td><td>〓</td></tr><tr><td><code class="filename">biology</code></td><td>生物学関連のソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">cad</code></td><td>CAD ツール</td><td>〓</td></tr><tr><td><code class="filename">chinese</code></td><td>中国語サポート</td><td>〓</td></tr><tr><td><code class="filename">comms</code></td><td>通信ソフトウェア</td><td>ほとんどはシリアルポート用のソフトウェア</td></tr><tr><td><code class="filename">converters</code></td><td>文字コード変換</td><td>〓</td></tr><tr><td><code class="filename">databases</code></td><td>データベース</td><td>〓</td></tr><tr><td><code class="filename">deskutils</code></td><td>コンピュータが発明される以前に机上で使われていた道具</td><td>(訳注: いわゆるデスクトップユーティリティのこと)</td></tr><tr><td><code class="filename">devel</code></td><td>開発ユーティリティ</td><td>単にライブラリだからというだけで、
		  どうしてもここに置かなければならない理由があるのでない限り、
		  ライブラリをここに含めないでください。</td></tr><tr><td><code class="filename">dns</code></td><td>DNS 関連ソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">editors</code></td><td>一般的なエディタ</td><td>特殊なエディタはそれぞれふさわしいセクションに入れます
		  (たとえば数式エディタは
		  <code class="filename">math</code> です)。</td></tr><tr><td><code class="filename">elisp</code></td><td>Emacs-lisp の ports</td><td>〓</td></tr><tr><td><code class="filename">emulators</code></td><td>他のオペレーティングシステム用のエミュレータ</td><td>端末エミュレータはここに<span class="emphasis"><em>含まれません</em></span>
		  ― X ベースのものは <code class="filename">x11</code> に、
		  テキストベースのものは機能によって
		  <code class="filename">comms</code> か
		  <code class="filename">misc</code> に分類されます。</td></tr><tr><td><code class="filename">finance</code></td><td>金融や財務会計関連のアプリケーション。</td><td>〓</td></tr><tr><td><code class="filename">french</code></td><td>フランス語サポート</td><td>〓</td></tr><tr><td><code class="filename">ftp</code></td><td>FTP クライアントとサーバユーティリティ</td><td>port が FTP と HTTP の両方に対応していれば、
		  <code class="filename">ftp</code> に入れ、第 2 カテゴリを
		  <code class="filename">www</code> とします。</td></tr><tr><td><code class="filename">games</code></td><td>ゲーム</td><td>〓</td></tr><tr><td><code class="filename">german</code></td><td>ドイツ語サポート</td><td>〓</td></tr><tr><td><code class="filename">gnome*</code></td><td><a class="link" href="http://www.gnome.org" target="_top">GNOME</a>
		  プロジェクトの ports</td><td>〓</td></tr><tr><td><code class="filename">graphics</code></td><td>グラフィックユーティリティ</td><td>〓</td></tr><tr><td><code class="filename">haskell*</code></td><td>Haskell 言語関連のソフトウェア。</td><td>〓</td></tr><tr><td><code class="filename">hebrew</code></td><td>ヘブライ語サポート</td><td>〓</td></tr><tr><td><code class="filename">hungarian</code></td><td>ハンガリー語サポート</td><td>〓</td></tr><tr><td><code class="filename">ipv6*</code></td><td>IPv6 関連のソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">irc</code></td><td>インターネットリレーチャット (IRC)
		  用ユーティリティ</td><td>〓</td></tr><tr><td><code class="filename">japanese</code></td><td>日本語サポート</td><td>〓</td></tr><tr><td><code class="filename">java</code></td><td>Java 言語関連のソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">kde*</code></td><td><a class="link" href="http://www.kde.org" target="_top">K Desktop
		  Environment (kde)</a> プロジェクトの
		  ports</td><td>〓</td></tr><tr><td><code class="filename">korean</code></td><td>韓国語サポート</td><td>〓</td></tr><tr><td><code class="filename">lang</code></td><td>プログラミング言語</td><td>〓</td></tr><tr><td><code class="filename">linux*</code></td><td>Linux アプリケーションとサポートユーティリティ</td><td>〓</td></tr><tr><td><code class="filename">lisp*</code></td><td>Lisp 言語関連のソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">mail</code></td><td>メールソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">math</code></td><td>数値計算ソフトウェアやその他の数学ソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">mbone</code></td><td>MBone アプリケーション</td><td>〓</td></tr><tr><td><code class="filename">misc</code></td><td>種々のユーティリティ</td><td>基本的に他のカテゴリに属さないものです。
		  これは他の仮想でないカテゴリを伴わない、唯一のカテゴリです。
		  <code class="literal">misc</code> と他のカテゴリが
		  <code class="varname">CATEGORIES</code> 行に書かれている場合、
		  <code class="literal">misc</code>
		  を削除して他のサブディレクトリにおいて良いという意味になります。
		  このカテゴリに置かれた ports は見落とされやすいので、
		  可能な限り <code class="literal">misc</code>
		  よりふさわしいカテゴリを探してください。</td></tr><tr><td><code class="filename">multimedia</code></td><td>マルチメディアソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">net</code></td><td>種々のネットワークソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">net-mgmt</code></td><td>ネットワーク管理ソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">news</code></td><td>USENET ニュースソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">offix*</code></td><td><a class="link" href="http://leb.net/OffiX/" target="_top">OffiX</a>
		  suite の ports</td><td>〓</td></tr><tr><td><code class="filename">palm</code></td><td><a class="link" href="http://www.palm.com/" target="_top">Palm™</a>
		  シリーズをサポートするソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">parallel*</code></td><td>並列計算を行うアプリケーション</td><td>〓</td></tr><tr><td><code class="filename">pear*</code></td><td>Pear PHP フレームワーク関連の ports</td><td>〓</td></tr><tr><td><code class="filename">perl5*</code></td><td>実行に <span class="application">Perl</span>
		  バージョン 5 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">picobsd</code></td><td><a class="link" href="http://people.FreeBSD.org/~picobsd/" target="_top">PicoBSD</a>
		  をサポートするための ports</td><td>〓</td></tr><tr><td><code class="filename">plan9*</code></td><td><a class="link" href="http://www.cs.bell-labs.com/plan9dist/" target="_top">Plan9</a>
		  に由来するさまざまなソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">polish</code></td><td>ポーランド語サポート</td><td>〓</td></tr><tr><td><code class="filename">portuguese</code></td><td>ポルトガル語サポート</td><td>〓</td></tr><tr><td><code class="filename">print</code></td><td>印刷ソフトウェア</td><td>DTP 用ツール (プレビューアなど)
		  もここに分類されます。</td></tr><tr><td><code class="filename">python*</code></td><td><a class="link" href="http://www.python.org/" target="_top">Python</a>
		  言語関連のソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">ruby*</code></td><td><a class="link" href="http://www.ruby-lang.org/" target="_top">Ruby</a>
		  言語関連のソフトウェア</td><td>〓</td></tr><tr><td><code class="filename">russian</code></td><td>ロシア語サポート</td><td>〓</td></tr><tr><td><code class="filename">science</code></td><td><code class="filename">astro</code> や
		  <code class="filename">biology</code>,
		  <code class="filename">math</code> 等、
		  他のカテゴリにはあてはまらない科学関連の ports</td><td>〓</td></tr><tr><td><code class="filename">security</code></td><td>セキュリティ関連のユーティリティ</td><td>〓</td></tr><tr><td><code class="filename">shells</code></td><td>コマンドラインシェル</td><td>〓</td></tr><tr><td><code class="filename">sysutils</code></td><td>システムユーティリティ</td><td>〓</td></tr><tr><td><code class="filename">tcl76*</code></td><td>実行に Tcl バージョン 7.6 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">tcl80*</code></td><td>実行に Tcl バージョン 8.0 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">tcl81*</code></td><td>実行に Tcl バージョン 8.1 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">tcl82*</code></td><td>実行に Tcl バージョン 8.2 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">tcl83*</code></td><td>実行に Tcl バージョン 8.3 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">textproc</code></td><td>テキスト処理ユーティリティ</td><td>DTP ツールはここではなく、<code class="filename">print</code>
		  に分類されます。</td></tr><tr><td><code class="filename">tk42*</code></td><td>実行に Tk バージョン 4.2 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">tk80*</code></td><td>実行に Tk バージョン 8.0 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">tk81*</code></td><td>実行に Tk バージョン 8.1 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">tk82*</code></td><td>実行に Tk バージョン 8.2 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">tk83*</code></td><td>実行に Tk バージョン 8.3 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">tkstep80*</code></td><td>実行に TkSTEP バージョン 8.0 を必要とする ports</td><td>〓</td></tr><tr><td><code class="filename">ukrainian</code></td><td>ウクライナ語サポート</td><td>〓</td></tr><tr><td><code class="filename">vietnamese</code></td><td>ベトナム語サポート</td><td>〓</td></tr><tr><td><code class="filename">windowmaker*</code></td><td>WindowMaker ウィンドウマネージャをサポートする ports</td><td>〓</td></tr><tr><td><code class="filename">www</code></td><td>World Wide Web 関連のソフトウェア</td><td>HTML 言語サポートもここに分類されます。</td></tr><tr><td><code class="filename">x11</code></td><td>X ウィンドウシステムとその関連ソフトウェア</td><td>このカテゴリは、
		  直接ウィンドウシステムをサポートするソフトウェアのみを対象とするものです。
		  通常の X アプリケーションをここに分類しないでください。
		  ほとんどは他の <code class="filename">x11-*</code> カテゴリ
		  (下記参照) に分類されるべきです。
		  あなたの port が X アプリケーションで、
		  <code class="varname">USE_XLIB</code> を定義し
		  (<code class="varname">USE_IMAKE</code>
		  を定義すると自動的に定義されます)、
		  適切なカテゴリに分類してください。</td></tr><tr><td><code class="filename">x11-clocks</code></td><td>X11 用時計</td><td>〓</td></tr><tr><td><code class="filename">x11-fm</code></td><td>X11 用ファイルマネージャ</td><td>〓</td></tr><tr><td><code class="filename">x11-fonts</code></td><td>X11 フォントとフォントユーティリティ</td><td>〓</td></tr><tr><td><code class="filename">x11-servers</code></td><td>X11 サーバ</td><td>〓</td></tr><tr><td><code class="filename">x11-toolkits</code></td><td>X11 ツールキット</td><td>〓</td></tr><tr><td><code class="filename">x11-wm</code></td><td>X11 ウィンドウマネージャ</td><td>〓</td></tr><tr><td><code class="filename">zope*</code></td><td><a class="link" href="http://www.zope.org/" target="_top">Zope</a>
		  サポート</td><td>〓</td></tr></tbody></table></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78141136"></a>5.3.3. 適切なカテゴリの選択</h3></div></div></div><p>多くのカテゴリに重なるので、
	  どれを<span class="quote">「<span class="quote">第一</span>」</span>カテゴリにするかを決めなければならないことがたびたびあるでしょう。
	  これをうまく決めるルールがいくつかあります。
	  以下はその優先順のリストで、優先度の高いものから低いものの順に書いてあります。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>言語特有のカテゴリがまず最初です。
	      たとえば日本語の
	      X11 のフォントをインストールする port の場合、
	      <code class="varname">CATEGORIES</code> 行は
	      <code class="filename">japanese x11-fonts</code>
	      となるでしょう。</p></li><li class="listitem"><p>より特徴的なカテゴリが、
	      一般的なカテゴリより優先されます。
	      たとえば、HTML エディタの場合は <code class="filename">www editors</code> となります。
	      これを逆順にはしないでください。
	      また、
	      port が <code class="filename">irc</code>,
	      <code class="filename">mail</code>,
	      <code class="filename">mbone</code>,
	      <code class="filename">news</code>,
	      <code class="filename">security</code>,
	      <code class="filename">www</code>
	      のいずれかに属する場合には <code class="filename">net</code>
	      は暗黙のうちに含まれますので、入れるべきではありません。</p></li><li class="listitem"><p><code class="filename">x11</code>
	      を第二カテゴリにするのは第一カテゴリが自然言語の場合のみにしてください。
	      特に X のアプリケーションには
	      <code class="filename">x11</code> を指定しないでください。</p></li><li class="listitem"><p><span class="application">Emacs</span> のモードは、
	      そのモードで対応しているアプリケーションと同じ
	      ports カテゴリに置くようにして、
	      <code class="filename">editors</code> には置かないでください。
	      例えば、あるプログラミング言語のソースファイルを編集するための
	      <span class="application">Emacs</span> モードは、
	      <code class="filename">lang</code> に置くべきです。</p></li><li class="listitem"><p>もし、あなたの port が他のどのカテゴリにも属しない場合には
	      <code class="filename">misc</code> にしてください。</p></li></ul></div><p>もし、あなたがカテゴリについて自信が持てない場合には、
	  そのことを <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=send-pr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">send-pr</span>(1)</span></a> する時に書き加えてください。
	  そうすればインポートする前にそれについて議論できます
	  (もしあなたがコミッターであれば、
	  そのことを <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">FreeBSD ports メーリングリスト</a> に送って先に議論するようにしてください。
	  新しい port が間違ったカテゴリに import されて、
	  すぐ移動されることがあまりに多いのです。そうなると、
	  ソースリポジトリのマスターが不要で好ましくない膨れ方をしてしまいます。</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-distfiles"></a>5.4. 配布ファイル</h2></div></div></div><p><code class="filename">Makefile</code> の第二の部分では、
	その port をビルドするためにダウンロードしなければならないファイルと、
	それをどこからダウンロードできるか説明しています。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78156624"></a>5.4.1. <code class="varname">DISTNAME</code></h3></div></div></div><p><code class="varname">DISTNAME</code>
	  は製作者が決めたソフトウェアの名前です。
	  デフォルトでは <code class="varname">DISTNAME</code> は
	  <code class="literal">${PORTNAME}-${PORTVERSION}</code> になりますので、
	  必要にな場合だけ書き換えるようにしてください。
	  <code class="varname">DISTNAME</code> は二つの場所でしか使われません。
	  一つ目は配布ファイルリスト (<code class="varname">DISTFILES</code>) のデフォルト
	  <code class="varname">${DISTNAME}</code><code class="varname">${EXTRACT_SUFX}</code>
	  で、二つ目は配布ファイルが展開されるサブディレクトリ
	  <code class="varname">WRKSRC</code> のデフォルト
	  <code class="filename">work/${DISTNAME}</code>
	  です。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">PKGNAMEPREFIX</code> や
	    <code class="varname">PKGNAMESUFFIX</code> は
	    <code class="varname">DISTNAME</code> に影響を与えません。
	    また、元のソースアーカイブが
	    <code class="varname">${PORTNAME}-${PORTVERSION}${EXTRACT_SUFX}</code> という
	    名前ではないのに、<code class="varname">WRKSRC</code> を
	    <code class="filename">work/${PORTNAME}-${PORTVERSION}</code>
	    と設定しているなら、おそらく <code class="varname">DISTNAME</code>
	    はそのままにしておく必要があることに注意してください ―
	    <code class="varname">DISTNAME</code> と <code class="varname">WRKSRC</code>
	    の両方を (そして おそらく <code class="varname">EXTRACT_SUFX</code> も)
	    セットするよりは、<code class="varname">DISTFILES</code>
	    を定義する方が楽でしょう。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78170192"></a>5.4.2. <code class="varname">MASTER_SITES</code></h3></div></div></div><p>元になる配布ファイルを指し示す、FTP/HTTP の URL のファイル名を除いた部分を
	  <code class="varname">MASTER_SITES</code> に設定します。
	  最後にスラッシュ (<code class="filename">/</code>)
	  をつけることをお忘れなく!</p><p>このシステム上に配布ファイルが見つからなかった場合、
	  <code class="command">make</code> マクロは <code class="varname">FETCH</code>
	  を使ってこの変数に指定されたサイトから配布ファイルを取得しようとします。</p><p>このリストには、
	  できれば異なる大陸に存在する複数のサイトを入れておくことが推奨されています。
	  これにより、広域ネットワークのトラブルに対する耐性を高めることができます。
	  さらに私たちは、自動的に最も近いマスタサイトを判断して、
	  そこから取ってくるメカニズムの導入を計画しています。
	  複数のサイトがあれば、この取組を大きく助けることになります。</p><p>元になる tar ファイルが X-contrib や GNU, Perl CPAN
	  等の有名なアーカイブサイトに置かれている場合には、
	  <code class="varname">MASTER_SITE_<em class="replaceable"><code>*</code></em></code>
	  を使ってこれらのサイトを簡潔に
	  (例えば <code class="varname">MASTER_SITE_XCONTRIB</code> とか、
	  <code class="varname">MASTER_SITE_PERL_CPAN</code> のように) 指定することができます。
	  <code class="varname">MASTER_SITES</code> を これらの変数の一つにセットし、
	  サイト内でのパスを <code class="varname">MASTER_SITE_SUBDIR</code>
	  に指定するだけです。
	  以下に例を示します。</p><pre class="programlisting">MASTER_SITES=         ${MASTER_SITE_XCONTRIB}
MASTER_SITE_SUBDIR=   applications</pre><p>これらの変数は <code class="filename">/usr/ports/Mk/bsd.sites.mk</code>
	  で定義されています。
	  いつでも新しい項目が追加されて行きますので、
	  port を提出する前に このファイルの最新版を
	  チェックするように心掛けてください。</p><p>ユーザは <code class="filename">/etc/make.conf</code> 中で
	  <code class="varname">MASTER_SITE_*</code> 変数を上書きすることもできます。
	  そうすることで、これらの有名なアーカイブそのものではなく、
	  好みのミラーサイトを使用することができます。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78191056"></a>5.4.3. <code class="varname">EXTRACT_SUFX</code></h3></div></div></div><p>配布ファイルが 1 つで、
	  圧縮方式を示すのに普通と異なる接尾辞を使っていたら、
	  <code class="varname">EXTRACT_SUFX</code> を設定してください。</p><p>例えば、配布ファイルがより一般的な
	  <code class="filename">foo.tar.gz</code> ではなく、
	  <code class="filename">foo.tgz</code> となっていたら、
	  次のように書きます。</p><pre class="programlisting">DISTNAME=      foo
EXTRACT_SUFX=  .tgz</pre><p><code class="varname">USE_BZIP2</code> と <code class="varname">USE_ZIP</code>
	  変数を設定すると、<code class="varname">EXTRACT_SUFX</code>
	  は必要に応じて自動的に <code class="literal">.bz2</code>
	  または <code class="literal">.zip</code> に設定されます。
	  どちらも設定されていなければ、<code class="varname">EXTRACT_SUFX</code>
	  は <code class="literal">.tar.gz</code> に設定されます。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">EXTRACT_SUFX</code> と
	    <code class="varname">DISTFILES</code>
	    を両方設定する必要はありません。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78203088"></a>5.4.4. <code class="varname">DISTFILES</code></h3></div></div></div><p>時々、ダウンロードするファイルの名称が port
	  の名称とまったく似ていないことがあります。たとえば、
	  <code class="filename">source.tar.gz</code>
	  などと名づけられていることもあるでしょう。
	  ほかに、ソースコードがいくつかのアーカイブに分かれていて、
	  そのすべてをダウンロードしなければならないならないこともあります。</p><p>この場合、<code class="varname">DISTFILES</code>
	  に、ダウンロードしなければならないファイルすべてのリストを、
	  スペースで区切って設定してください。</p><pre class="programlisting">DISTFILES=     source1.tar.gz source2.tar.gz</pre><p>明示的に設定されていない場合、
	  <code class="varname">DISTFILES</code> は
	  <code class="literal">${DISTNAME}${EXTRACT_SUFX}</code>
	  に設定されます。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78207184"></a>5.4.5. <code class="varname">EXTRACT_ONLY</code></h3></div></div></div><p><code class="varname">DISTFILES</code> の一部だけを展開すべき
	  (例えば、一方がソースコードで、もう一方は圧縮されていない文書という)
	  場合、展開しなければならないファイル名を
	  <code class="varname">EXTRACT_ONLY</code> に設定してください。</p><pre class="programlisting">DISTFILES=     source.tar.gz manual.html
EXTRACT_ONLY=  source.tar.gz</pre><p><span class="emphasis"><em>どの</em></span> <code class="varname">DISTFILES</code>
	  も展開すべきでは<span class="emphasis"><em>ない</em></span>なら、
	  <code class="varname">EXTRACT_ONLY</code>
	  に空文字列を設定してください。</p><pre class="programlisting">EXTRACT_ONLY=</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-patchfiles"></a>5.4.6. <code class="varname">PATCHFILES</code></h3></div></div></div><p>その port が配布ファイルの他に FTP や HTTP
	  で手に入る追加パッチを必要とする場合には、
	  <code class="varname">PATCHFILES</code> にはそのパッチのファイル名を、
	  <code class="varname">PATCH_SITES</code>
	  にはそのファイルが置かれているディレクトリの URL
	  をセットしてください。(書き方は
	  <code class="varname">MASTER_SITES</code> と同じです。)</p><p>そのパッチに記録されているファイル名に余計なパス名がついていて、
	  ソースツリーのトップディレクトリ
	  (つまり <code class="varname">WKRSRC</code>)
	  からの相対パスになっていない場合には、
	  それに応じた <code class="varname">PATCH_DIST_STRIP</code> を指定してください。
	  たとえば、パッチ内のすべてのファイル名の先頭に、余計な
	  <code class="literal">foozolix-1.0/</code> がついている場合には、
	  <code class="literal">PATCH_DIST_STRIP=-p1</code>
	  としてください。</p><p>これらのパッチは圧縮されていても大丈夫です。
	  ファイル名が <code class="filename">.gz</code> や <code class="filename">.Z</code>
	  で終わる場合には、自動的に展開されるようになっています。</p><p>もしパッチが、ドキュメント等その他のファイルと一緒に
	  gzip された tar ファイルで配布されている場合には、単に
	  <code class="varname">PATCHFILES</code> を使うだけではうまくいきません。
	  このような場合には、このパッチの tar ファイルの名前と場所を
	  <code class="varname">DISTFILES</code> と
	  <code class="varname">MASTER_SITES</code> に追加しておきます。
	  それから、<code class="varname">EXTRA_PATCHES</code>
	  変数にそれらのパッチを指定すれば、
	  <code class="filename">bsd.port.mk</code> が
	  自動的にパッチを適用してくれます。
	  特に注意が必要なのは、パッチファイルを
	  <code class="varname">PATCHDIR</code>
	  ディレクトリにコピー<span class="emphasis"><em>してはならない</em></span>ことです
	  ― (訳注: port が CD-ROM 上に置かれている等の場合には、)
	  そのディレクトリには書き込みができないかもしれません。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">それが普通の gzip か compress された tar ファイルであれば、
	    通常のソースファイルと一緒にパッチ適用時までに展開されていますので、
	    明示的に展開する必要はありません。
	    もしパッチを <code class="varname">DISTFILES</code>
	    に追加した場合には、パッチを含むファイルが展開される際に、
	    そのディレクトリにある何かを上書きしないように注意してください。
	    さらに、コピーされたパッチファイルを削除するコマンドを
	    <code class="buildtarget">pre-clean</code>
	    ターゲットに追加することを忘れないでください。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-master-sites-n"></a>5.4.7. 異なるサイトやサブディレクトリからの複数の配布ファイルまたはパッチ
	  (<code class="literal">MASTER_SITES:n</code>)</h3></div></div></div><p>(これはいささか<span class="quote">「<span class="quote">高度な話題</span>」</span>です。
	  この文書を初めて読む人は、
	  最初はこの節を飛ばしてもよいでしょう)。</p><p>この節は <code class="literal">MASTER_SITES:n</code> や
	  <code class="literal">MASTER_SITES_NN</code>
	  と呼ばれる取得方法について説明しています。
	  ここでは、この方式を <code class="literal">MASTER_SITES:n</code>
	  と呼びます。</p><p>まず、背景を少し説明しておきましょう。OpenBSD
	  には、<code class="varname">DISTFILES</code> と
	  <code class="varname">PATCHFILES</code>
	  変数の両方に素敵な機能があります。ファイル、パッチの両方とも、
	  後ろに <code class="literal">:n</code> (<code class="literal">n</code>
	  は <code class="literal">[0-9]</code> のどれかになります)
	  をつけてグループを指示できます。たとえば、</p><pre class="programlisting">DISTFILES=      alpha:0 beta:1</pre><p>OpenBSD では、配布ファイル <code class="filename">alpha</code>
	  は、通常の <code class="varname">MASTER_SITES</code> ではなく
	  <code class="varname">MASTER_SITES0</code> に、
	  <code class="filename">beta</code> は <code class="varname">MASTER_SITES1</code>
	  に結び付けられます。</p><p>これは、正しいダウンロードサイトを際限なく探す羽目になるのを減らせる、
	  興味深い機能です。</p><p><code class="varname">DISTFILES</code> にファイルが
	  2 つ指定され、<code class="varname">MASTER_SITES</code> が
	  20 サイトあって、サイトはものすごく遅く、
	  <code class="filename">beta</code> は <code class="varname">MASTER_SITES</code>
	  中のすべてのサイトに置かれていますが、
	  <code class="filename">alpha</code> は
	  20 番目のサイトにしかないという場合を考えてください。
	  メンテナがあらかじめそのことを知っていたら、
	  すべてのサイトを確認するのは無駄だと思いませんか?
	  楽しい週末のはじまりというわけにはゆきませんね。</p><p>イメージできたら、今度は <code class="varname">DISTFILES</code>
	  や <code class="varname">MASTER_SITES</code>
	  がもっと沢山あるのを想像してください。
	  <span class="quote">「<span class="quote">distfiles 調査マイスタ</span>」</span>は、
	  ネットワーク負荷が緩和されることを喜ぶに違いありません。</p><p>次節からは、FreeBSD におけるこのアイディアの実装について説明します。
	  OpenBSD の考え方を多少改良しています。</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78247888"></a>5.4.7.1. 簡単な説明</h4></div></div></div><p>この節では、複数の配布ファイルやパッチを、
	    異なるサイトやサブディレクトリから細かく分けて取得する簡単な設定を示します。
	    ここでは、単純化した <code class="literal">MASTER_SITES:n</code>
	    の使い方を説明します。ほとんどの場面ではこれで十分です。
	    さらに詳しいことを知りたければ、次の節をお読みください。</p><p>アプリケーションによっては、
	    いくつもの異なるサイトからダウンロードする複数の配布ファイルからなっているものがあります。
	    たとえば、<span class="application">Ghostscript</span>
	    は、中核部のプログラムと、
	    ユーザのプリンタに応じて使い分けられる多数のドライバファイルからなっています。
	    このドライバファイルの一部は中核部と共に配布されますが、
	    多くはさまざまなサイトからダウンロードしなければなりません。</p><p>これに対応するため、<code class="varname">DISTFILES</code>
	    の各項目の後ろには、コロンと<span class="quote">「<span class="quote">タグ名</span>」</span>
	    をつけられるようになっています。<code class="varname">MASTER_SITES</code>
	    に設定されているそれぞれのサイトの末尾にも、コロンと、
	    そのサイトからダウンロードすべきファイルを示すためのタグを加えます。</p><p>たとえば、ソースコードが
	    <code class="filename">source1.tar.gz</code> と
	    <code class="filename">source2.tar.gz</code> の
	    2 つに分けられていて、
	    2 つの別のサイトからダウンロードしなければならないアプリケーションを考えてみましょう。
	    その port の <code class="filename">Makefile</code>
	    には、<a class="xref" href="#ports-master-sites-n-example-simple-use-one-file-per-site" title="例5.1 各サイトに 1 つファイルがある場合の、簡単な MASTER_SITES:n の使用法">例5.1「各サイトに 1 つファイルがある場合の、簡単な
	      <code class="literal">MASTER_SITES:n</code> の使用法」</a>
	    のような行があるとします。</p><div class="example"><a id="ports-master-sites-n-example-simple-use-one-file-per-site"></a><div class="example-title">例5.1 各サイトに 1 つファイルがある場合の、簡単な
	      <code class="literal">MASTER_SITES:n</code> の使用法</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=   ftp://ftp.example1.com/:source1 \
                ftp://ftp.example2.com/:source2
DISTFILES=      source1.tar.gz:source1 \
                source2.tar.gz:source2</pre></div></div><br class="example-break" /><p>複数の配布ファイルに同じタグがついていてもかまいません。
	  先ほどの例に続いて、3 番目の配布ファイル
	  <code class="filename">source3.tar.gz</code> があって、
	  <code class="systemitem">ftp.example2.com</code> からダウンロードすべきだとしましょう。
	  <code class="filename">Makefile</code> は <a class="xref" href="#ports-master-sites-n-example-simple-use-more-than-one-file-per-site" title="例5.2 各サイトに 1 つ以上ファイルがある場合の、簡単な MASTER_SITES:n の使用法">例5.2「各サイトに 1 つ以上ファイルがある場合の、簡単な
	      <code class="literal">MASTER_SITES:n</code> の使用法」</a>
	    のようになります。</p><div class="example"><a id="ports-master-sites-n-example-simple-use-more-than-one-file-per-site"></a><div class="example-title">例5.2 各サイトに 1 つ以上ファイルがある場合の、簡単な
	      <code class="literal">MASTER_SITES:n</code> の使用法</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=   ftp://ftp.example1.com/:source1 \
                ftp://ftp.example2.com/:source2
DISTFILES=      source1.tar.gz:source1 \
                source2.tar.gz:source2 \
                source3.tar.gz:source2</pre></div></div><br class="example-break" /></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78271568"></a>5.4.7.2. 詳しい説明</h4></div></div></div><p>分かりました。
	    前節の例ではあなたの要求を満足できなかったわけですね。
	    この節では、ファイルの取得を細かく制御する仕組み
	    <code class="literal">MASTER_SITES:n</code>
	    がどう働くかと、これを利用するために
	    ports をどう変更すればよいかを詳しく説明します。</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>要素の末尾に
		<code class="literal">:n</code>
		をつけることができます。
		ここで、<em class="replaceable"><code>n</code></em> は
		<code class="literal">[^:,]+</code>
		つまり、概念上はいかなる文字と数字からなる文字列でもよいのですが、
		われわれとしては、当面は
		<code class="literal">[a-zA-Z_][0-9a-zA-Z_]+</code>
		に制限します。</p><p>さらに、文字列のマッチは大文字と小文字を区別します。
		つまり、<code class="literal">n</code> と <code class="literal">N</code>
		は別の文字として扱われます。</p><p>しかし、
		<code class="literal">default</code>, <code class="literal">all</code>,
		<code class="literal">ALL</code>
		は特別な意味を与えられているので、
		末尾に付加するのには使えません
		(これは、<a class="xref" href="#porting-master-sites-n-what-changes-in-port-targets">ii</a>
		項で内部的に利用されています)。
		さらに、<code class="literal">DEFAULT</code>
		は特別な意味を持つ単語です
		(<a class="xref" href="#porting-master-sites-n-DEFAULT-group">3</a>
		の項を確認してください)。</p></li><li class="listitem"><p><code class="literal">:n</code> がついた要素は、グループ
		<code class="literal">n</code> に属し、
		<code class="literal">:m</code> がついた要素は、グループ
		<code class="literal">m</code>
		に属するということになります。</p></li><li class="listitem"><p><a id="porting-master-sites-n-DEFAULT-group"></a>接尾辞がついていない要素はグループに属しません。
		これは、特別なグループ <code class="literal">DEFAULT</code>
		に属しているとして扱われます。
		要素の後ろに <code class="literal">DEFAULT</code>
		をつけるのは、その要素を <code class="literal">DEFAULT</code>
		とそれ以外のグループに同時に割り当てたいのでなければ、
		冗長に過ぎません
		(<a class="xref" href="#porting-master-sites-n-comma-operator">5</a>
		の項を確認してください)。</p><p>次の例はどちらも同じ意味ですが、
		最初の方が好ましいです。</p><pre class="programlisting">MASTER_SITES=   alpha

MASTER_SITES=   alpha:DEFAULT</pre></li><li class="listitem"><p>グループは相互排他ではありません。
		ひとつの要素が同時に複数のグループに属することができ、
		ひとつのグループには複数の要素が属することも、
		何も割り当てないこともできます。
		同じグループで何回も指定された要素は、
		単に複数回指定された要素ということになります。</p></li><li class="listitem"><p><a id="porting-master-sites-n-comma-operator"></a>ある要素を同時にいくつものグループに所属させたい時は、
		カンマ演算子 (<code class="literal">,</code>) が使えます。</p><p>その都度別の接尾辞をつけて繰り返すかわりに、
		一度だけ接尾辞を指定して複数のグループを指定できます。
		たとえば、<code class="literal">:m,n,o</code>
		と書くと、その要素はグループ <code class="literal">m</code>,
		<code class="literal">n</code> および <code class="literal">o</code>
		に属することを示します。</p><p>以下の例はすべて同等ですが、
		最後の形式がもっともよいでしょう。</p><pre class="programlisting">MASTER_SITES=   alpha alpha:SOME_SITE

MASTER_SITES=   alpha:DEFAULT alpha:SOME_SITE

MASTER_SITES=   alpha:SOME_SITE,DEFAULT

MASTER_SITES=   alpha:DEFAULT,SOME_SITE</pre></li><li class="listitem"><p>任意のグループ内のサイトは、
		<code class="varname">MASTER_SORT_AWK</code>
		によって整列されます。
		<code class="varname">MASTER_SITES</code> と
		<code class="varname">PATCH_SITES</code>
		内のすべてのグループについても同様に整列されます。</p></li><li class="listitem"><p><a id="porting-master-sites-n-group-semantics"></a>グループの概念は、変数
		<code class="varname">MASTER_SITES</code>,
		<code class="varname">PATCH_SITES</code>,
		<code class="varname">MASTER_SITE_SUBDIR</code>,
		<code class="varname">PATCH_SITE_SUBDIR</code>,
		<code class="varname">DISTFILES</code> および
		<code class="varname">PATCHFILES</code>
		においても、下記の文法に従って使えます。</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p><code class="varname">MASTER_SITES</code>,
		    <code class="varname">PATCH_SITES</code>,
		    <code class="varname">MASTER_SITE_SUBDIR</code> および
		    <code class="varname">PATCH_SITE_SUBDIR</code>
		    のすべての要素はスラッシュ <code class="literal">/</code>
		    記号で終端されていなければなりません。
		    ある要素がどれかのグループに属しているなら、
		    グループの接尾辞
		    <code class="literal">:n</code>
		    は、終端記号 <code class="literal">/</code>
		    のすぐ後にこなければなりません。
		    <code class="literal">MASTER_SITES:n</code>
		    の仕組みでは、終端記号
		    <code class="literal">/</code> があることで、
		    <code class="literal">:n</code> が要素の有効な一部である場合と、
		    <code class="literal">:n</code> がグループ <code class="literal">n</code>
		    を示す場合の混同を避けることができます。
		    以前は、
		    <code class="varname">MASTER_SITE_SUBDIR</code> と
		    <code class="varname">PATCH_SITE_SUBDIR</code>
		    要素のいずれにおいても終端記号 <code class="literal">/</code>
		    は不要だったので、互換性を保つために、
		    接尾辞の直前の文字が <code class="literal">/</code>
		    でなければ、
		    要素の接尾辞が <code class="literal">:n</code> であっても、
		    グループの接尾語ではなく、
		    要素の有効な一部分として扱われます。
		    <a class="xref" href="#ports-master-sites-n-example-detailed-use-master-site-subdir" title="例5.3 MASTER_SITE_SUBDIR における MASTER_SITES:n の詳細な使用法">例5.3「<code class="varname">MASTER_SITE_SUBDIR</code> における
		      <code class="literal">MASTER_SITES:n</code> の詳細な使用法」</a>
		    と <a class="xref" href="#ports-master-sites-n-example-detailed-use-complete-example-master-sites" title="例5.4 カンマ演算子、複数のファイル、複数のサイト、 複数のサブディレクトリと合わせた MASTER_SITES:n の詳細な使用法">例5.4「カンマ演算子、複数のファイル、複数のサイト、
			複数のサブディレクトリと合わせた
			<code class="literal">MASTER_SITES:n</code>
			の詳細な使用法」</a>
		    の両方をご覧ください。</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-master-site-subdir"></a><div class="example-title">例5.3 <code class="varname">MASTER_SITE_SUBDIR</code> における
		      <code class="literal">MASTER_SITES:n</code> の詳細な使用法</div><div class="example-contents"><pre class="programlisting">MASTER_SITE_SUBDIR=     old:n new/:NEW</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>グループ <code class="literal">DEFAULT</code>
			  に属するディレクトリ -&gt; old:n</p></li><li class="listitem"><p>グループ <code class="literal">NEW</code>
			  に属するディレクトリ -&gt; new</p></li></ul></div></div></div><br class="example-break" /><div class="example"><a id="ports-master-sites-n-example-detailed-use-complete-example-master-sites"></a><div class="example-title">例5.4 カンマ演算子、複数のファイル、複数のサイト、
			複数のサブディレクトリと合わせた
			<code class="literal">MASTER_SITES:n</code>
			の詳細な使用法</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=   http://site1/%SUBDIR%/ http://site2/:DEFAULT \
                http://site3/:group3 http://site4/:group4 \
                http://site5/:group5 http://site6/:group6 \
                http://site7/:DEFAULT,group6 \
                http://site8/%SUBDIR%/:group6,group7 \
                http://site9/:group8
DISTFILES=      file1 file2:DEFAULT file3:group3 \
                file4:group4,group5,group6 file5:grouping \
                file6:group7
MASTER_SITE_SUBDIR=     directory-trial:1 directory-n/:groupn \
                        directory-one/:group6,DEFAULT \
                        directory</pre><p>上の例は、次のような細かく分けた取得を実現します。
		      サイトは、利用される順番で挙げられています。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">file1</code>
			  は次のサイトから取得されます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site1/directory/</p></li><li class="listitem"><p>http://site1/directory-one/</p></li><li class="listitem"><p>http://site1/directory-trial:1/</p></li><li class="listitem"><p>http://site2/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file2</code>
			  は、<code class="filename">file1</code>
			  と同じグループに属しているので、
			  まったく同じように取得されます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site1/directory/</p></li><li class="listitem"><p>http://site1/directory-one/</p></li><li class="listitem"><p>http://site1/directory-trial:1/</p></li><li class="listitem"><p>http://site2/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file3</code>
			  は次のサイトから取得されます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site3/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file4</code>
			  は次のサイトから取得されます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site4/</p></li><li class="listitem"><p>http://site5/</p></li><li class="listitem"><p>http://site6/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p>http://site8/directory-one/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file5</code>
			  は次のサイトから取得されます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file6</code>
			  は次のサイトから取得されます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site8/directory-one/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li></ul></div></div></div><br class="example-break" /></li></ol></div></li><li class="listitem"><p><code class="varname">MASTER_SITE_SOURCEFORGE</code>
		のように、<code class="filename">bsd.sites.mk</code>
		で定義される特別な変数をグループに割り当てるにはどうすればよいですか?</p><p><a class="xref" href="#ports-master-sites-n-example-detailed-use-master-site-sourceforge" title="例5.5 MASTER_SITE_SOURCEFORGE と合わせた MASTER_SITES:n の詳しい使用法">例5.5「<code class="varname">MASTER_SITE_SOURCEFORGE</code>
		  と合わせた <code class="literal">MASTER_SITES:n</code>
		  の詳しい使用法」</a>
		をご覧ください。</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-master-site-sourceforge"></a><div class="example-title">例5.5 <code class="varname">MASTER_SITE_SOURCEFORGE</code>
		  と合わせた <code class="literal">MASTER_SITES:n</code>
		  の詳しい使用法</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=   http://site1/ ${MASTER_SITE_SOURCEFORGE:S/$/:sourceforge,TEST/}
DISTFILES=      something.tar.gz:sourceforge</pre></div></div><br class="example-break" /><p><code class="filename">something.tar.gz</code>
		は、<code class="varname">MASTER_SITE_SOURCEFORGE</code>
		に含まれるあらゆるサイトから取得されます。</p></li><li class="listitem"><p>これを <code class="varname">PATCH*</code>
		変数と組み合わせて使うにはどうすればよいでしょうか?</p><p>すべての例で <code class="varname">MASTER*</code>
		変数を使っていますが、<a class="xref" href="#ports-master-sites-n-example-detailed-use-patch-sites" title="例5.6 PATCH_SITES と合わせた MASTER_SITES:n の簡単な使用法">例5.6「<code class="varname">PATCH_SITES</code> と合わせた
		  <code class="literal">MASTER_SITES:n</code> の簡単な使用法」</a>
		にあるように、<code class="varname">PATCH*</code>
		変数に対してもまったく同じように働きます。</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-patch-sites"></a><div class="example-title">例5.6 <code class="varname">PATCH_SITES</code> と合わせた
		  <code class="literal">MASTER_SITES:n</code> の簡単な使用法</div><div class="example-contents"><pre class="programlisting">PATCH_SITES=    http://site1/ http://site2/:test
PATCHFILES=     patch1:test</pre></div></div><br class="example-break" /></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78387152"></a>5.4.7.3. ports
	    について何が変更され、何が変わらないのでしょうか?</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem"><p>現在のすべての ports はそのまま変わりません。
		<code class="literal">MASTER_SITES:n</code>
		機能のコードは、<a class="xref" href="#porting-master-sites-n-group-semantics">7</a>
		で述べた文法に従う
		<code class="literal">:n</code>
		のような形式が後ろについた要素がある場合だけ動作します。</p></li><li class="listitem"><p><a id="porting-master-sites-n-what-changes-in-port-targets"></a>port を make する際のターゲットにも変更はありません。
		<code class="buildtarget">checksum</code>,
		<code class="buildtarget">makesum</code>,
		<code class="buildtarget">patch</code>,
		<code class="buildtarget">configure</code>,
		<code class="buildtarget">build</code> 等です。
		もちろん、<code class="buildtarget">do-fetch</code>,
		<code class="buildtarget">fetch-list</code>,
		<code class="buildtarget">master-sites</code> それから
		<code class="buildtarget">patch-sites</code>
		は例外です。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="buildtarget">do-fetch</code>
		    は、新しくグループ分けの接尾辞のついた
		    <code class="varname">DISTFILES</code> と
		    <code class="varname">PATCHFILES</code>
		    を設定します。それぞれが、対応する
		    <code class="varname">MASTER_SITES</code> と
		    <code class="varname">PATCH_SITES</code>
		    を利用し、さらに対応する
		    <code class="varname">MASTER_SITE_SUBDIR</code> と
		    <code class="varname">PATCH_SITE_SUBDIR</code>
		    を利用します。<a class="xref" href="#ports-master-sites-n-example-detailed-use-complete-example-master-sites" title="例5.4 カンマ演算子、複数のファイル、複数のサイト、 複数のサブディレクトリと合わせた MASTER_SITES:n の詳細な使用法">例5.4「カンマ演算子、複数のファイル、複数のサイト、
			複数のサブディレクトリと合わせた
			<code class="literal">MASTER_SITES:n</code>
			の詳細な使用法」</a>
		    をご覧ください。</p></li><li class="listitem"><p><code class="buildtarget">fetch-list</code>
		    は、<code class="buildtarget">do-fetch</code>
		    と同じようにグループを利用するということを除いて、以前の
		    <code class="buildtarget">fetch-list</code>
		    のように動作します。</p></li><li class="listitem"><p><code class="buildtarget">master-sites</code> および
		    <code class="buildtarget">patch-sites</code> は、
		    (古いバージョンと互換性がなくなり)
		    <code class="literal">DEFAULT</code>
		    グループの要素を返すだけになっています。
		    実際は、それぞれ
		    <code class="buildtarget">master-sites-default</code> および
		    <code class="buildtarget">patch-sites-default</code>
		    というターゲットを実行します。</p><p>さらに、
		    <code class="buildtarget">MASTER_SITES</code> や
		    <code class="buildtarget">PATCH_SITES</code>
		    を直接確認するよりも、
		    <code class="buildtarget">master-sites-all</code> または
		    <code class="buildtarget">patch-sites-all</code>
		    のどちらかのターゲットを使う方がよいです。
		    また、将来のバージョンでも直接確認ができるかどうかは保証されていません。
		    これら新規 port ターゲットについては、<a class="xref" href="#porting-master-sites-n-new-port-targets-master-sites-all">B</a>
		    の項をご確認ください。</p></li></ul></div></li><li class="listitem"><p>新規の port ターゲット</p><div class="orderedlist"><ol class="orderedlist" type="A"><li class="listitem"><p><code class="varname">MASTER_SITES</code> および
		    <code class="varname">PATCH_SITES</code>
		    のそれぞれについて、
		    グループ <em class="replaceable"><code>n</code></em> の要素を表示する
		    <code class="buildtarget">master-sites-<em class="replaceable"><code>n</code></em></code>
		    および
		    <code class="buildtarget">patch-sites-<em class="replaceable"><code>n</code></em></code>
		    ターゲットがあります。たとえば、
		    <code class="buildtarget">master-sites-DEFAULT</code> および
		    <code class="buildtarget">patch-sites-DEFAULT</code>
		    のいずれも <code class="literal">DEFAULT</code>
		    グループの要素を返し、
		    <code class="buildtarget">master-sites-test</code> および
		    <code class="buildtarget">patch-sites-test</code>
		    は <code class="literal">test</code>
		    グループの要素を返します。</p></li><li class="listitem"><p><a id="porting-master-sites-n-new-port-targets-master-sites-all"></a>以前の
		    <code class="buildtarget">master-sites</code> および
		    <code class="buildtarget">patch-sites</code>
		    が行っていた作業を行う
		    <code class="buildtarget">master-sites-all</code> および
		    <code class="buildtarget">patch-sites-all</code>
		    という新たなターゲットがあります。
		    これらのターゲットは、
		    すべてのグループの要素をすべてが同じグループに属しているかのように返します。
		    ただし、
		    <code class="buildtarget">master-sites-all</code> および
		    <code class="buildtarget">patch-sites-all</code>
		    のそれぞれについて、
		    <code class="varname">DISTFILES</code> や
		    <code class="varname">PATCHFILES</code>
		    で定義されているグループと同じ数だけ
		    <code class="varname">MASTER_SITE_BACKUP</code> と
		    <code class="varname">MASTER_SITE_OVERRIDE</code>
		    を表示します。</p></li></ol></div></li></ol></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78425680"></a>5.4.8. <code class="varname">DIST_SUBDIR</code></h3></div></div></div><p><code class="filename">/usr/ports/distfiles</code>
	  ディレクトリ内をあまり散らかさないようにしてください。
	  たくさんのファイルを取ってくる port
	  や、他の port と名前の衝突が起きる恐れのあるファイル
	  (<code class="filename">Makefile</code> など)
	  がある場合には、
	  <code class="varname">DIST_SUBDIR</code> に port の名前
	  (<code class="literal">${PORTNAME}</code> か
	  <code class="literal">${PKGNAMEPREFIX}${PORTNAME}</code>
	  を使うといいでしょう)
	  を入れてください。すると <code class="varname">DISTDIR</code>
	  がデフォルトの
	  <code class="filename">/usr/ports/distfiles</code> から
	  <code class="filename">/usr/ports/distfiles/DIST_SUBDIR</code>
	  に変更され、
	  取ってきたファイルはすべてそのサブディレクトリの中に置かれるようになります。</p><p>また、
	  ファイルを取ってくるときにバックアップサイトとして使われる
	  <code class="filename">ftp.FreeBSD.org</code>
	  のディレクトリ名にもこの変数の値が使われます
	  (<code class="varname">Makefile</code> の中で
	  <code class="varname">DISTDIR</code> を明示的に指定した場合、
	  ローカルのファイルを置くところは変わりますが、
	  このサイトのディレクトリ名は変わりません。
	  必ず <code class="varname">DIST_SUBDIR</code>
	  を使うようにしてください)。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">この変数は <code class="filename">Makefile</code>
	    中で明示的に指定された
	    <code class="varname">MASTER_SITES</code>
	    には影響しません。</p></div></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-maintainer"></a>5.5. <code class="varname">MAINTAINER</code></h2></div></div></div><p>あなたのメールアドレスをここに入れてください。
	お願いします。
	<span class="emphasis"><em>:-)</em></span></p><p><code class="varname">MAINTAINER</code>
	の値は、コメント部のない単一のアドレスしか受け付けられません。
	<code class="literal">user@hostname.domain</code>
	という形式を利用してください。この項目には、
	あなたの本名などの説明用のテキストは一切いれないでください。
	(そうしても、ただ <code class="filename">bsd.port.mk</code>
	が混乱するだけです)。そういう情報は
	<code class="filename">pkg-descr</code> に書いてください。</p><p>保守担当者 (maintainer) の責任に関する詳細説明は、
	<a class="link" href="../developers-handbook/policies.html#POLICIES-MAINTAINER" target="_top">
	Makefile 中の MAINTAINER</a> の
	セクションを参照してください。</p><p>Port のメンテナがユーザからの更新要求に
	(主な公休日を除いて) 2 週間返答しなかったら、
	保守担当者の持ち時間が切れたとみなして、
	保守担当者の明示的な了承なしに更新して構いません。
	保守担当者が 3 ヶ月以内に返答しない場合は、
	その保守担当者は無断で不在にしているとみなして、
	問題となっている port の保守担当者を入れ替えても構いません。
	例外となるは、ports 管理チーム <code class="email">&lt;<a xmlns="" class="email" href="mailto:portmgr@FreeBSD.org">portmgr@FreeBSD.org</a>&gt;</code> または セキュリティオフィサチーム <code class="email">&lt;<a xmlns="" class="email" href="mailto:security-officer@FreeBSD.org">security-officer@FreeBSD.org</a>&gt;</code>
	が保守しているものです。このグループが保守している port
	に対しては許可を得ずにコミットしてはいけません。</p><p>ports 管理チーム <code class="email">&lt;<a xmlns="" class="email" href="mailto:portmgr@FreeBSD.org">portmgr@FreeBSD.org</a>&gt;</code> は、何か理由があれば、
	誰かを保守担当から外したり、別の方を担当者にする権利を持ちます。
	セキュリティオフィサチーム <code class="email">&lt;<a xmlns="" class="email" href="mailto:security-officer@FreeBSD.org">security-officer@FreeBSD.org</a>&gt;</code> は、セキュリティ上の理由で、
	保守担当者の権限を剥奪したり担当者を変更する権利を持ちます。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-comment"></a>5.6. <code class="varname">COMMENT</code></h2></div></div></div><p>その port の 1 行の説明です。
	コメントにはパッケージ名 (やソフトウェアのバージョン)
	を<span class="emphasis"><em>入れないでください</em></span>。
	コメントは大文字で始め、最後にピリオドは付けないでください。
	たとえば、こんな具合です。</p><pre class="programlisting">COMMENT=       A cat chasing a mouse all over the screen</pre><p><code class="filename">Makefile</code> 中で、
	COMMENT 変数は MAINTAINER 変数の直後においてください。</p><p>COMMENT 行は、port
	の 1 行の要約としてユーザに示されるので、
	70 文字未満に抑えるようにしてください。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-depend"></a>5.7. 依存関係</h2></div></div></div><p>多くの port は他の port に依存しています。
	必要なものすべてがユーザのマシン上に存在することを
	保証するために使用可能な、7 つの変数が用意されています。
	よくあるケースのためにあらかじめ設定された依存変数に加え、
	いくつかの依存関係の制御のための変数があります。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78449488"></a>5.7.1. <code class="varname">LIB_DEPENDS</code></h3></div></div></div><p>その port が必要とする共有ライブラリを、この変数で指定します。
	  (訳注: libc 等、標準のライブラリは指定する必要がありません。)
	  これは <em class="replaceable"><code>lib</code></em>:<em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>] という
	  組のリストです。
	  <em class="replaceable"><code>lib</code></em> が共有ライブラリの名前、
	  <em class="replaceable"><code>dir</code></em> が
	  そのライブラリが見つからない場合に
	  インストールされる port のディレクトリ、
	  <em class="replaceable"><code>target</code></em>が
	  そのディレクトリで呼ばれるターゲットです。
	  たとえば、

	</p><pre class="programlisting">LIB_DEPENDS= jpeg.9:${PORTSDIR}/graphics/jpeg:install</pre><p>

	  と指定されていた場合、まずメジャーバージョンが 9 の jpeg
	  共有ライブラリがインストールされているかどうかを確認します。
	  インストールされていない場合には、ports ツリーの
	  <code class="filename">graphics/jpeg</code> サブディレクトリに移動し、
	  <em class="replaceable"><code>target</code></em>
	  のコンパイルとインストールを行ないます。
	  <em class="replaceable"><code>target</code></em> の部分は、
	  それが <code class="varname">DEPENDS_TARGET</code>
	  (デフォルトでは <code class="literal">install</code>) と
	  等しいときには省略することができます。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">先頭の <em class="replaceable"><code>lib</code></em> の部分は
	    <code class="command">ldconfig -r | grep -wF</code> への引数になります。
	    この変数には正規表現を入れないようにしてください。
	  </p></div><p>
	  この依存関係のチェックは、
	  <code class="buildtarget">extract</code> ターゲットと
	  <code class="buildtarget">install</code> ターゲットの中で、2 回行なわれます。
	  (訳注: これは、その port
	   をビルドするマシンとインストールされるマシンが違う場合、
	   どちらのマシンでもそのライブラリが利用できることを確認するためです)。
	  同様に、依存するライブラリの名前は package 中にも書き込まれていて、
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_add</span>(1)</span></a>
	  実行時にそのライブラリがユーザのシステムに存在していなければ、
	  自動的にインストールされます。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78495696"></a>5.7.2. <code class="varname">RUN_DEPENDS</code></h3></div></div></div><p>この port の実行時に必要となるプログラム、
	  またはファイルがあるときにはこの変数で指定します。これは
	  <em class="replaceable"><code>path</code></em>:<em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>]
	  という組のリストです。
	  <em class="replaceable"><code>path</code></em> がファイルまたはプログラムの名前、
	  <em class="replaceable"><code>dir</code></em>
	  が それが見つからない場合にインストールされる port のディレクトリ、
	  <em class="replaceable"><code>target</code></em>
	  が そのディレクトリで呼ばれるターゲットです。
	  <em class="replaceable"><code>path</code></em> の最初の文字がスラッシュ
	  (<code class="literal">/</code>) の場合にはファイルかディレクトリとみなし、
	  存在するかどうか
	  <code class="command">test -e</code> を使ってチェックします。
	  そうでない場合には実行可能ファイルであると考えて、
	  そのプログラムがユーザのサーチパス上にあるかどうか
	  <code class="command">which -s</code> を使って確認します。</p><p>たとえば Makefile に以下のように書いてあるとします。</p><pre class="programlisting">RUN_DEPENDS=   ${LOCALBASE}/etc/innd:${PORTSDIR}/news/inn \
                wish8.0:${PORTSDIR}/x11-toolkits/tk80</pre><p>まず、<code class="filename">/usr/local/etc/innd</code>
	  というファイルかディレクトリが存在するか確認します。
	  存在しない場合には、ports ツリーの
	  <code class="filename">news/inn</code> というサブディレクトリで
	  ビルドとインストールを行ないます。
	  さらに、<code class="command">wish8.0</code>
	  というプログラムがユーザのサーチパス中にあるかどうか探します。
	  ない場合には同じく ports ツリーの
	  <code class="filename">x11-toolkits/tk80</code>
	  というサブディレクトリでコンパイルとインストールを行ないます。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">この例で、<code class="command">innd</code> は実際にはプログラムです。
	    このように、プログラムであっても一般ユーザのサーチパスに
	    含まれているとは考えにくいところに置かれているものの場合には、
	    絶対パスで指定してください。</p></div><p>この依存関係は <code class="buildtarget">install</code>
	  ターゲット中でチェックされます。
	  また、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_add</span>(1)</span></a> によるインストールの際に、その package
	  が依存するものがユーザのシステムに存在しない場合には自動的に追加インストールできるように、
	  依存するものの名前も package 中に記録されます。
	  <em class="replaceable"><code>target</code></em> の部分が
	  <code class="varname">DEPENDS_TARGET</code> と同じ場合には、
	  <em class="replaceable"><code>target</code></em> の部分を省略することができます。
	</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78515792"></a>5.7.3. <code class="varname">BUILD_DEPENDS</code></h3></div></div></div><p>この port のビルド時に必要となるプログラム、
	  またはファイルがあるときにはこの変数で指定します。
	  <code class="varname">RUN_DEPENDS</code> と同様に、これは
	  <em class="replaceable"><code>path</code></em>:<em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>]
	  という組のリストです。たとえば、

	  </p><pre class="programlisting">BUILD_DEPENDS=unzip:${PORTSDIR}/archivers/unzip</pre><p>

	  と指定されていた場合、まず <code class="command">unzip</code>
	  という名前のプログラムがインストールされているかどうかを確認します。
	  インストールされていない場合には ports ツリーの
	  <code class="filename">archivers/unzip</code> サブディレクトリに移動し、
	  ビルドとインストールを行ないます。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">ここで言う<span class="quote">「<span class="quote">ビルド</span>」</span>とは、
	    ファイルの展開からコンパイルまでのすべての処理を意味します。
	    この依存関係は、<code class="buildtarget">extract</code>
	    ターゲットの中でチェックされます。
	    <em class="replaceable"><code>target</code></em> の部分は、
	    <code class="varname">DEPENDS_TARGET</code>
	    と同じ場合には省略することができます。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78522448"></a>5.7.4. <code class="varname">FETCH_DEPENDS</code></h3></div></div></div><p>この port を取ってくるのに必要となるプログラム、
	  またはファイルがあるときにはこの変数で指定します。
	  上の二つと同様に、これは
	  <em class="replaceable"><code>path</code></em>:<em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>]
	  という組のリストです。たとえば、

	  </p><pre class="programlisting">FETCH_DEPENDS=ncftp2:${PORTSDIR}/net/ncftp2</pre><p>

	  と指定されていれば、<code class="command">ncftp2</code>
	  という名前のプログラムを探します。
	  見つからない場合には、ports ツリーの
	  <code class="filename">net/ncftp2</code>
	  サブディレクトリでビルドとインストールを行ないます。</p><p>この依存関係は <code class="buildtarget">fetch</code>
	  ターゲット中でチェックされます。
	  <em class="replaceable"><code>target</code></em> の部分は、
	  <code class="varname">DEPENDS_TARGET</code>
	  と同じ場合には省略することができます。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78527952"></a>5.7.5. <code class="varname">EXTRACT_DEPENDS</code></h3></div></div></div><p>この変数には、この port
	  の展開に必要な実行ファイルや、他のファイルを指定します。
	  前の変数と同じく、これは
	  <em class="replaceable"><code>path</code></em>:<em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>]
	  のタプルの一覧です。たとえば、</p><pre class="programlisting">EXTRACT_DEPENDS=
	    unzip:${PORTSDIR}/archivers/unzip</pre><p>
	  は、<code class="command">unzip</code>
	  という実行形式のファイルがあるかどうか確認し、
	  見つからなければ、ports ツリーの
	  <code class="filename">archivers/unzip</code>
	  サブディレクトリに降りてビルドおよびインストールを行います。</p><p>依存関係は <code class="buildtarget">extract</code>
	  ターゲットにおいて確認されます。
	  <em class="replaceable"><code>target</code></em> 部分が
	  <code class="varname">DEPENDS_TARGET</code>
	  と同じなら、省いて構いません。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">この変数は、展開が働いておらず
	    (デフォルトでは <code class="command">gzip</code> を仮定しています)、
	    <a class="xref" href="#use-vars" title="5.7.8. USE_*">「<code class="varname">USE_<em class="replaceable"><code>*</code></em></code>」</a> で説明されている
	    <code class="varname">USE_ZIP</code> や <code class="varname">USE_BZIP2</code>
	    を使っても動かない場合にだけ使ってください。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78535504"></a>5.7.6. <code class="varname">PATCH_DEPENDS</code></h3></div></div></div><p>この変数は、この port
	  がパッチを当てる際に必要とする実行ファイルや他のファイルを指定します。
	  前の変数と同じく、これは
	  <em class="replaceable"><code>path</code></em>:<em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>]
	  のタプルの一覧です。たとえば、</p><pre class="programlisting"> PATCH_DEPENDS=
	    ${NONEXISTENT}:${PORTSDIR}/java/jfc:extract
	    </pre><p> は、ports ツリーの
	  <code class="filename">java/jfc</code> サブディレクトリに移動して、
	  ビルドおよびインストールを行います。</p><p>依存関係は、<code class="buildtarget">patch</code>
	  ターゲットにおいて確認されます。<em class="replaceable"><code>target</code></em>
	  部分が <code class="varname">DEPENDS_TARGET</code>
	  と同じなら省略して構いません。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78540112"></a>5.7.7. <code class="varname">DEPENDS</code></h3></div></div></div><p>上記のいずれにもあてはまらないような依存関係がある場合、
	  または他の port がインストールされているだけではなく
	  ソースが展開されている必要がある場合には、この変数を使います。
	  これは上記の四つと違い、特に<span class="quote">「<span class="quote">確認</span>」</span>するものが
	  ありませんので、
	  <em class="replaceable"><code>dir</code></em>[<span class="optional">:target</span>]
	  という形式のリストになります。
	  <em class="replaceable"><code>target</code></em> の部分は
	  <code class="varname">DEPENDS_TARGET</code>
	  と同じ場合には省略することができます。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="use-vars"></a>5.7.8. <code class="varname">USE_<em class="replaceable"><code>*</code></em></code></h3></div></div></div><p>多くの ports に共通の依存関係をカプセル化するために、
	  いくつもの変数が存在しています。</p><div class="table"><a id="idp78549072"></a><div class="table-title">表5.1 <code class="varname">USE_<em class="replaceable"><code>*</code></em></code>
	    変数</div><div class="table-contents"><table summary="USE_*&#10;&#9;    変数" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>変数</th><th>意味</th></tr></thead><tbody><tr><td><code class="varname">USE_BZIP2</code></td><td>その port の tarball は <code class="command">bzip2</code>
		  で圧縮されています。</td></tr><tr><td><code class="varname">USE_ZIP</code></td><td>その port の tarball は <code class="command">zip</code>
		  で圧縮されています。</td></tr><tr><td><code class="varname">USE_GMAKE</code></td><td>その port をビルドするのに <code class="command">gmake</code>
		  が必要です。</td></tr><tr><td><code class="varname">USE_PERL5</code></td><td>その port をビルドしてインストールするのに
		  <code class="literal">perl 5</code> が必要です。
		  <code class="literal">perl</code>
		  に関連して設定可能な他の変数については
		  <a class="xref" href="#using-perl" title="6.3. perl の利用">「<code class="literal">perl</code> の利用」</a> をご覧ください。</td></tr><tr><td><code class="varname">USE_X_PREFIX</code></td><td>その port は <code class="varname">PREFIX</code> ではなく
		  <code class="varname">X11BASE</code> にインストールされます。
		  X11 に関連して設定可能な他の変数については、
		  <a class="xref" href="#using-x11" title="6.4. X11 の利用">「X11 の利用」</a> をご覧ください。</td></tr><tr><td><code class="varname">USE_AUTOMAKE</code></td><td>その port のビルドに GNU <code class="command">automake</code>
		  が使われます。<code class="command">automake</code>
		  に関わる他に設定可能な変数については、
		  <a class="xref" href="#using-automake" title="6.5. automake, autoconf および libtool の利用">「<code class="command">automake</code>, <code class="command">autoconf</code>
	および <code class="command">libtool</code> の利用」</a> をご覧ください。</td></tr><tr><td><code class="varname">USE_AUTOCONF</code></td><td>その port のビルドに GNU <code class="command">autoconf</code>
		  が使われます。<code class="command">autoconf</code>
		  に関わる他に設定可能な変数については、
		  <a class="xref" href="#using-automake" title="6.5. automake, autoconf および libtool の利用">「<code class="command">automake</code>, <code class="command">autoconf</code>
	および <code class="command">libtool</code> の利用」</a> をご覧ください。</td></tr><tr><td><code class="varname">USE_LIBTOOL</code></td><td>その port のビルドに GNU <code class="command">libtool</code>
		  が使われます。<code class="command">libtool</code>
		  に関わる他に設定可能な変数については、
		  <a class="xref" href="#using-automake" title="6.5. automake, autoconf および libtool の利用">「<code class="command">automake</code>, <code class="command">autoconf</code>
	および <code class="command">libtool</code> の利用」</a> をご覧ください。</td></tr><tr><td><code class="varname">GMAKE</code></td><td><code class="command">gmake</code> が
		  <code class="envar">PATH</code> に入っていない場合のフルパス</td></tr><tr><td><code class="varname">USE_BISON</code></td><td>その port のビルドに <code class="command">bison</code>
		  が使われます。</td></tr><tr><td><code class="varname">USE_SDL</code></td><td>その port のビルドや実行に
		  <code class="literal">SDL</code> が使われます。
		  <code class="varname">USE_SDL</code> の使い方について、詳しくは
		  <a class="xref" href="#using-sdl" title="6.13. SDL の利用">「SDL の利用」</a> をご覧ください。</td></tr><tr><td><code class="varname">NO_INSTALL_MANPAGES</code></td><td><code class="buildtarget">install.man</code>
		  ターゲットを使いません。</td></tr></tbody></table></div></div><br class="table-break" /><p>その ports が X Window System を必要とするのであれば、
	  <code class="literal">USE_XLIB=yes</code> を定義してください
	  (これは <code class="varname">USE_IMAKE</code>
	  が定義されていれば自動的に定義されます)。
	  BSD <code class="command">make</code> ではなく
	  GNU <code class="command">make</code> を必要とする場合には
	  <code class="literal">USE_GMAKE=yes</code> を、
	  GNU autoconf を実行する必要がある場合には
	  <code class="literal">USE_AUTOCONF=yes</code> を、
	  最新の qt toolkit を使用する場合には
	  <code class="literal">USE_QT=yes</code> を、
	  <code class="literal">perl</code> 言語のバージョン 5 を必要とする場合には
	  <code class="literal">USE_PERL5=yes</code> を定義してください
	  (特に最後のものは重要です。
	  FreeBSD のバージョンにより、基本システムに
	  <code class="literal">perl5</code>
	  が含まれていたり、いなかったりします)。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78591056"></a>5.7.9. 依存関係に関する注意</h3></div></div></div><p>上で述べたように、依存する ports
	  が必要になったときに呼ばれるデフォルトのターゲットは
	  <code class="buildtarget">DEPENDS_TARGET</code>
	  で、そのデフォルトは <code class="literal">install</code> です。
	  これはユーザが使用する変数であり、
	  port の <code class="filename">Makefile</code> で定義するものではありません。
	  もし、その port が特別な方法で依存関係を扱う必要がある場合には、
	  <code class="varname">DEPENDS_TARGET</code> を再定義するのではなく
	  <code class="varname">*_DEPENDS</code> 変数の
	  <code class="literal">:target</code> 部分を使用してください。</p><p><code class="command">make clean</code> と入力したときには、
	  その port が依存する port も自動的に clean されます。
	  そうならないようにしたい場合には、
	  環境変数 <code class="varname">NOCLEANDEPENDS</code>
	  を設定してください。KDE, GNOME や Mozilla
	  のように、再ビルドするのに時間がかかる port
	  に依存している場合は特に望ましいかもしれません。</p><p>無条件に他の port に依存させるには、
	  <code class="varname">BUILD_DEPENDS</code> や
	  <code class="varname">RUN_DEPENDS</code> の最初のフィールドに
	  <code class="varname">${NONEXISTENT}</code> という変数を指定してください。
	  これは、他の port のソースが必要なときのみ使用してください。
	  ターゲットも指定することで、
	  コンパイルの時間を節約できる場合もあります。
	  たとえば

	  </p><pre class="programlisting">BUILD_DEPENDS=   ${NONEXISTENT}:${PORTSDIR}/graphics/jpeg:extract</pre><p>

	  とすると、常に <code class="literal">jpeg</code> port
	  のディレクトリに行ってソースの展開を行ないます。</p><p>あなたがやりたいことが他の方法ではできない場合以外には
	  <code class="varname">DEPENDS</code> を使わないでください。
	  これは常に他の port の作成を行ない (さらにデフォルトでは
	  インストールも行ない)、package まで作成します。
	  この動作が本当に所望のものでしたら、
	  それを <code class="literal">BUILD_DEPENDS</code> と
	  <code class="literal">RUN_DEPENDS</code> に書くべきでしょう
	  ― 少なくとも意図を明確にすることができます。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78619984"></a>5.7.10. オプション選択可能な依存ライブラリ</h3></div></div></div><p>巨大なアプリケーションの中には、
	複数のコンフィギュレーションでビルドすることができるものがあります。
	つまり、いくつもの外部ライブラリやアプリケーションの中の、
	あるものが利用可能な場合に、
	それを拡張機能として使用するように設定することができるということです。
	それらのライブラリやアプリケーションを、
	必ずしも すべてのユーザが必要としているわけではありませんので、ports
	システムではどのコンフィギュレーションがビルドされるべきかを
	port 作者が決めるために使えるフックを用意しています。
	これらを適切にサポートすることにより、ユーザをハッピーにしたり、
	port 1 つ分のコストで 2 つまたはそれ以上の
	port を提供するのと同様の効率化を行なうことが可能です。</p><p>これらのフックのうちで最も簡単に使えるものは
	<code class="varname">WITHOUT_X11</code> でしょう。
	その port が X Window System のサポートありと、
	サポートなしの設定でビルドできるのであれば、
	通常は X Window System サポートありでビルドするべきでしょう。
	ビルド時に <code class="varname">WITHOUT_X11</code> が定義されていれば、
	その時は X Window System サポートなしのバージョンが
	ビルドされるべきです。</p><p>GNOME 環境の様々なパーツも、そのようなノブ (フック)
	を持っていますが、それらは幾分使いにくいものです。
	<code class="filename">Makefile</code> 中で その目的に使用される変数は
	<code class="varname">WANT_*</code> と <code class="varname">HAVE_*</code> になります。
	そのアプリケーションが、
	以下に示されている依存ライブラリの一つについて、
	サポートあり、なしの両方でビルドできる場合、
	<code class="filename">Makefile</code> には <code class="varname">WANT_PKG</code>
	をセットする必要があります。
	そして、ビルド時に <code class="varname">HAVE_PKG</code> が定義されていれば
	<code class="varname">PKG</code> を使うバージョンがビルドされることになります。</p><p>現在、このような形でサポートされている
	<code class="varname">WANT_*</code> 変数は、
	<code class="varname">WANT_GLIB</code>, <code class="varname">WANT_GTK</code>,
	<code class="varname">WANT_ESOUND</code>, <code class="varname">WANT_IMLIB</code>,
	そして <code class="varname">WANT_GNOME</code> です。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78628176"></a>5.7.11. 致命的な依存の循環</h3></div></div></div><div xmlns="" class="important"><h3 class="admontitle">重要: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ports ツリーに循環する依存性を持ち込まないでください!</p></div><p>Ports の構築技術は循環依存性を許容していません。
	  循環依存させてしまうと、たちまちどこかの誰かがインストールしている
	  FreeBSD を駄目にしてしまい、その数はまたたく間に増えて行きます。
	  この問題は見付けるのが非常に難しいです。
	  問題がありそうな場合は、その変更を行う前に
	  <code class="command">cd /usr/ports; make index</code>
	  を実行するようにしてください。
	  この処理は古いマシンではかなり遅いかもしれませんが、
	  (あなたも含めて)
	  多くの人がその処理を行って嘆くことにならずに済ませられるでしょう。</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-wrkdir"></a>5.8. 作業ディレクトリの指定</h2></div></div></div><p>それぞれの port は作業ディレクトリに展開されるので、
	作業ディレクトリは書き込み可能でなければなりません。
	Ports システムは、デフォルトでは
	<code class="varname">DISTFILES</code> が
	<code class="literal">${DISTNAME}</code>
	というディレクトリに展開されると想定します。
	つまり、次のように設定していたら、</p><pre class="programlisting">PORTNAME=      foo
PORTVERSION=   1.0</pre><p>その port の配布ファイルの内容は、最上位のディレクトリが
	<code class="filename">foo-1.0</code> で、
	残りのファイルはそのディレクトリの下に置かれているということです。</p><p>そうでない場合に上書きできる変数がたくさんあります。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78642384"></a>5.8.1. <code class="varname">WRKSRC</code></h3></div></div></div><p>この変数は、
	  アプリケーションの配布ファイルが展開された時に作成されるディレクトリの名称を示します。
	  前の例で、(<code class="filename">foo-1.0</code> ではなく)
	  <code class="filename">foo</code> というディレクトリに展開されるなら、</p><pre class="programlisting">WRKSRC=      ${WRKDIR}/foo</pre><p>または、</p><pre class="programlisting">WRKSRC=      ${WRKDIR}/${PORTNAME}</pre><p>と書いてください。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78645968"></a>5.8.2. <code class="varname">NO_WRKSUBDIR</code></h3></div></div></div><p>その port がサブディレクトリに展開しないのであれば、
	  それを示すために <code class="varname">NO_WRKSUBDIR</code>
	  を設定してください。</p><pre class="programlisting">NO_WRKSUBDIR= yes</pre></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="conflicts"></a>5.9. <code class="varname">CONFLICTS</code></h2></div></div></div><p>あなたが作成している package が他の packageと
	(ファイルの衝突や実行時の非互換性により)
	共存できないのであれば、<code class="varname">CONFLICTS</code>
	変数にその package の名称を挙げてください。
	<code class="literal">*</code> や <code class="literal">?</code>
	のようなシェルの補完が利用できます。package 名は
	<code class="filename">/var/db/pkg</code>
	にあるのと同じ形式で並べてください。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-build"></a>5.10. ビルドのメカニズム</h2></div></div></div><p>そのソフトウェアがビルドの際に GNU <code class="command">make</code>
	を使う場合には、<code class="literal">USE_GMAKE=yes</code> をセットしてください。
	<code class="command">configure</code> を使う場合には、
	<code class="literal">HAS_CONFIGURE=yes</code> をセットしてください。
	GNU <code class="command">configure</code> を使う場合には、
	<code class="literal">GNU_CONFIGURE=yes</code> をセットしてください (これにより
	<code class="literal">HAS_CONFIGURE</code> もセットされます)。
	<code class="command">configure</code> に追加の引数を渡したい場合には、
	追加部分を <code class="varname">CONFIGURE_ARGS</code> に指定してください。
	(デフォルトの引数リストは、GNU <code class="command">configure</code> では
	<code class="literal">--prefix=${PREFIX}</code> に、
	GNU でない <code class="command">configure</code> では空リストになります。)
	GNU <code class="command">autoconf</code> を使う場合には、
	<code class="literal">USE_AUTOCONF=yes</code> をセットしてください。
	これにより <code class="varname">GNU_CONFIGURE</code> もセットされ、
	<code class="command">configure</code> を実行する前に
	<code class="command">autoconf</code> が実行されます。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">もしそのパッケージが GNU <code class="command">configure</code>
	  を使っていて、作成された実行形式のファイルが
	  <code class="filename">i386-portbld-freebsd4.7-</code><em class="replaceable"><code>appname</code></em>
	  のような<span class="quote">「<span class="quote">奇妙な</span>」</span>名称だった場合は、さらに
	  <code class="varname">CONFIGURE_TARGET</code>
	  を上書きして、新しいバージョンの <code class="command">autoconf</code>
	  で生成されたスクリプトが要求する方法でターゲットを指定する必要があります。
	  <code class="filename">Makefile</code> の
	  <code class="literal">GNU_CONFIGURE=yes</code>
	  行のすぐ後に次の行を追加してください。</p><p xmlns="http://www.w3.org/1999/xhtml">
	  <code class="literal">CONFIGURE_TARGET=--build=${MACHINE_ARCH}-portbld-freebsd${OSREL}</code>
	</p></div><p>そのソフトウェアが X Window System のアプリケーションなどで、
	<code class="command">imake</code> を使って <code class="filename">Imakefile</code> から
	<code class="filename">Makefile</code> を作成する場合には、
	<code class="literal">USE_IMAKE=yes</code> を指定してください。
	そうするとコンフィグレーションステージで自動的に
	<code class="command">xmkmf -a</code> が実行されます。
	もし <code class="option">-a</code> フラグが問題を引き起こすなら、
	さらに <code class="literal">XMKMF=xmkmf</code> をセットしてください。
	もし、その port が <code class="command">imake</code> を使用するけれども
	<code class="buildtarget">install.man</code> ターゲットを持たない場合には、
	<code class="literal">NO_INSTALL_MANPAGES=yes</code> をセットしてください。
	ついでに、そのソフトウェアの作者を探し出して八つ裂きにするといいでしょう。
	<span class="emphasis"><em>(-_-#)</em></span></p><p>そのソフトウェアの元々の <code class="filename">Makefile</code> が
	<code class="buildtarget">all</code>
	以外のものをメインのターゲットとしている場合には、それを
	<code class="varname">ALL_TARGET</code> に指定してください。
	<code class="buildtarget">install</code> と
	<code class="varname">INSTALL_TARGET</code> も同様です。</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="special"></a>第6章 特別な配慮</h1></div></div></div><div class="toc"><div class="toc-title">目次</div><dl class="toc"><dt><span class="sect1"><a href="#porting-shlibs">6.1. 共有ライブラリ</a></span></dt><dt><span class="sect1"><a href="#porting-restrictions">6.2. 配布制限がある ports</a></span></dt><dt><span class="sect1"><a href="#using-perl">6.3. <code class="literal">perl</code> の利用</a></span></dt><dt><span class="sect1"><a href="#using-x11">6.4. X11 の利用</a></span></dt><dt><span class="sect1"><a href="#using-automake">6.5. <code class="command">automake</code>, <code class="command">autoconf</code>
	および <code class="command">libtool</code> の利用</a></span></dt><dt><span class="sect1"><a href="#using-gnome">6.6. GNOME の利用</a></span></dt><dt><span class="sect1"><a href="#using-kde">6.7. KDE の利用</a></span></dt><dt><span class="sect1"><a href="#using-bison">6.8. Bison の利用</a></span></dt><dt><span class="sect1"><a href="#using-java">6.9. Java の利用</a></span></dt><dt><span class="sect1"><a href="#using-python">6.10. Python の利用</a></span></dt><dt><span class="sect1"><a href="#using-emacs">6.11. Emacs の利用</a></span></dt><dt><span class="sect1"><a href="#using-ruby">6.12. Ruby の利用</a></span></dt><dt><span class="sect1"><a href="#using-sdl">6.13. SDL の利用</a></span></dt></dl></div><p>port を作成する場合、
      考慮しなくてはいけないことが他にもいくつかあります。
      このセクションでは、それらのうちでも特によくあることについて説明します。</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-shlibs"></a>6.1. 共有ライブラリ</h2></div></div></div><p>その port が共有ライブラリのインストールを行なう場合、
	make 変数 <code class="varname">INSTALLS_SHLIB</code> を定義してください。
	これにより、<code class="filename">bsd.port.mk</code> が
	<code class="buildtarget">post-install</code>
	ターゲットの実行時に新しいライブラリがインストールされたディレクトリ
	(通常は	<code class="filename">PREFIX/lib</code>) に
	<code class="literal">${LDCONFIG} -m</code> を実行し、
	共有ライブラリキャッシュへの登録が行なわれるようになります。
	また、この変数が定義されている場合、共有ライブラリを
	インストールしたユーザが それをすぐに使い始められるように、
	また、削除の際には そのライブラリが まだ存在していると
	システムに誤認されないように、
	適切な <code class="literal">@exec /sbin/ldconfig -m</code> と
	<code class="literal">@unexec /sbin/ldconfig -R</code> のペアが
	<code class="filename">pkg-plist</code> ファイルに
	指定されているように扱われます。</p><p>必要であれば、
	共有ライブラリがインストールされるディレクトリのリストを格納する
	make 変数 <code class="varname">LDCONFIG_DIRS</code> を定義することにより、
	新しいライブラリがインストールされるデフォルトの位置を上書きすることも可能です。
	例えば、その port が共有ライブラリを
	<code class="filename">PREFIX/lib/foo</code> と
	<code class="filename">PREFIX/lib/bar</code> に
	インストールする場合、<code class="filename">Makefile</code>
	で以下の記述を使用することができます:</p><pre class="programlisting">INSTALLS_SHLIB= yes
LDCONFIG_DIRS=  %%PREFIX%%/lib/foo %%PREFIX%%/lib/bar</pre><p><code class="filename">pkg-plist</code> の他の部分と同様に、
	<code class="varname">LDCONFIG_DIRS</code> の内容も <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sed&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">sed</span>(1)</span></a>
	による処理が行なわれるため、ここでも <code class="varname">PLIST_SUB</code>
	に指定した置換が行なわれることに注意してください。
	<code class="varname">PREFIX</code> には <code class="literal">%%PREFIX%%</code> を、
	<code class="varname">LOCALBASE</code> には <code class="literal">%%LOCALBASE%%</code>,
	<code class="varname">X11BASE</code> には <code class="literal">%%X11BASE%%</code>
	を使用することを推奨します。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-restrictions"></a>6.2. 配布制限がある ports</h2></div></div></div><p>ライセンスにはさまざまなものがあり、なかには、
	アプリケーションをパッケージ化するやり方、営利目的で販売できるか、
	といったことに制限をかけているものがあります。</p><div xmlns="" class="important"><h3 class="admontitle">重要: </h3><p xmlns="http://www.w3.org/1999/xhtml">port 作成者として、あなたには、使用許諾条件をよく読み、
	  FTP/HTTP または CD-ROM
	  で再配布してはいけないソースコードやコンパイルされたバイナリを配布してしまい、
	  その責任が FreeBSD プロジェクトにかかってくることのないよう注意する義務があります。
	  疑わしい場合には <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">FreeBSD ports メーリングリスト</a> で聞いてみてください。</p></div><p>そのような場合、次の節で説明されている変数が設定できます。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">RESTRICTED</code>
	  は、それだけを設定すれば済むように、暗黙のうちに
	  <code class="varname">NO_CDROM</code> と <code class="varname">NO_PACKAGE</code>
	  を設定します。それに対して、
	  <code class="varname">NO_PACKAGE</code> と <code class="varname">NO_CDROM</code>
	  は独立で、同時に設定可能です。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78710096"></a>6.2.1. <code class="varname">NO_PACKAGE</code></h3></div></div></div><p>この変数が設定されていたら、
	  このアプリケーションのバイナリパッケージを作成してはいけないということです。
	  ただし、この port の <code class="varname">DISTFILES</code>
	  は自由に配布できます。</p><p>また、<code class="varname">NO_PACKAGE</code>
	  は、バイナリパッケージが汎用的ではなく、
	  いつもアプリケーションをソースコードからコンパイルすべき場合にも利用すべきです。
	  たとえば、アプリケーションにサイト特有の設定情報がコンパイル時にハードコードされるような場合には、
	  <code class="varname">NO_PACKAGE</code> を設定してください。</p><p><code class="varname">NO_PACKAGE</code> には、
	  パッケージを作成すべきではない理由を述べた文字列を設定すべきです。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78713552"></a>6.2.2. <code class="varname">NO_CDROM</code></h3></div></div></div><p>この変数は、バイナリパッケージの作成は許可されていますが、
	  その package や port の <code class="varname">DISTFILES</code>
	  を販売用の CD-ROM (や DVD-ROM)
	  に載せるのは許されていないことを表します。なんにせよ、
	  バイナリパッケージと port の <code class="varname">DISTFILES</code>
	  は、FTP/HTTP で入手できます。</p><p><code class="varname">NO_CDROM</code> には、その port が何故 CD-ROM
	  で再配布できないか説明する文字列を設定するべきです。
	  これはたとえば、その port のライセンスが<span class="quote">「<span class="quote">非商用</span>」</span>
	  利用に限っている場合に使うべきです。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78716880"></a>6.2.3. <code class="varname">RESTRICTED</code></h3></div></div></div><p>アプリケーションのライセンスが、FTP/HTTP
	  で、そのアプリケーションの <code class="varname">DISTFILES</code>
	  をミラーすることや、
	  バイナリパッケージを配布することを禁じていたら、
	  この変数を設定してください。</p><p><code class="varname">RESTRICTED</code> には、その port
	  が何故再配布できないか説明する文字列を設定するべきです。
	  典型的な場合としては、その port
	  がプロプライエタリなソフトウェアを含んでいて、
	  <code class="varname">DISTFILES</code>
	  を、おそらくソフトウェアに関する登録を行ったり、
	  <acronym class="acronym">EULA</acronym> を承諾した後で、
	  手動でダウンロードしなければならないことを表します。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78752848"></a>6.2.4. <code class="varname">RESTRICTED_FILES</code></h3></div></div></div><p><code class="varname">RESTRICTED</code> や <code class="varname">NO_CDROM</code>
	  が設定されている時は、この変数はデフォルトで
	  <code class="literal">${DISTFILES} ${PATCHFILES}</code>
	  になります。それ以外は空です。
	  一部の配布ファイルだけに制限がかかっていたら、
	  この変数にそのファイルのリストを設定してください。</p><p>port committer は、設定した配布ファイル毎に
	  <code class="filename">/usr/ports/LEGAL</code>
	  に制限の内容を説明する項目を追加すべきことに注意してください。</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-perl"></a>6.3. <code class="literal">perl</code> の利用</h2></div></div></div><div class="table"><a id="idp78757200"></a><div class="table-title">表6.1 <code class="literal">perl</code> を使用する ports 用の変数</div><div class="table-contents"><table summary="perl を使用する ports 用の変数" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>変数</th><th>意味</th></tr></thead><tbody><tr><td><code class="varname">USE_PERL5</code></td><td>その port のビルドと実行に <code class="literal">perl 5</code>
		を使用することを示します。</td></tr><tr><td><code class="varname">USE_PERL5_BUILD</code></td><td>その port をビルドするのに <code class="literal">perl 5</code>
		を使用することを示します。</td></tr><tr><td><code class="varname">USE_PERL5_RUN</code></td><td>その port を実行するのに <code class="literal">perl 5</code>
		を使用することを示します。</td></tr><tr><td><code class="varname">PERL</code></td><td>システムまたは port からインストールされた
		<code class="literal">perl 5</code>
		の完全なパスからバージョン番号を省いたもの。
		スクリプトの
		<span class="quote">「<span class="quote"><code class="literal">#!</code></span>」</span>
		行を置き換える必要があれば使ってください。</td></tr><tr><td><code class="varname">PERL_CONFIGURE</code></td><td>Perl の MakeMaker
 		を使ってコンフィグレーションを行います。暗黙のうちに
 		<code class="varname">USE_PERL5</code> を設定します。</td></tr></tbody></table><table summary="perl を使用する ports 用の変数" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>読み取り専用変数</th><th>意味</th></tr></thead><tbody><tr><td><code class="varname">PERL_VERSION</code></td><td>インストールされている <code class="literal">perl</code>
 		の完全なバージョン
		(たとえば <code class="literal">5.00503</code>)。</td></tr><tr><td><code class="varname">PERL_VER</code></td><td>インストールされている <code class="literal">perl</code>
 		のバージョンの短縮形
		(たとえば <code class="literal">5.005</code>)。</td></tr><tr><td><code class="varname">PERL_LEVEL</code></td><td>インストールされている <code class="literal">perl</code> の
 		<code class="literal">MNNNPP</code> 形式の整数で表されるバージョン
		(たとえば <code class="literal">500503</code>)。</td></tr><tr><td><code class="varname">PERL_ARCH</code></td><td><code class="literal">perl</code>
		がアーキテクチャ依存のライブラリをインストールする場所。
		デフォルトは <code class="literal">${ARCH}-freebsd</code>。</td></tr><tr><td><code class="varname">PERL_PORT</code></td><td>インストールされている <code class="literal">perl</code>
		の port の名称 (例えば <code class="literal">perl5</code>)。</td></tr><tr><td><code class="varname">SITE_PERL</code></td><td>サイト独自の <code class="literal">perl</code>
		パッケージの入るディレクトリ名。
		この値は PLIST_SUB に追加されます。</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-x11"></a>6.4. X11 の利用</h2></div></div></div><div class="table"><a id="idp78806224"></a><div class="table-title">表6.2 X を利用する ports 用の変数</div><div class="table-contents"><table summary="X を利用する ports 用の変数" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USE_X_PREFIX</code></td><td>その port は <code class="varname">PREFIX</code> ではなく
		<code class="varname">X11BASE</code> にインストールされます。</td></tr><tr><td><code class="varname">USE_XLIB</code></td><td>その port は X ライブラリを使用します。</td></tr><tr><td><code class="varname">USE_MOTIF</code></td><td>その port は Motif ツールキットを使用します。
		<code class="varname">USE_XPM</code> が自動的に設定されます。</td></tr><tr><td><code class="varname">USE_IMAKE</code></td><td>その port は <code class="command">imake</code>
		を使用します。<code class="varname">USE_X_PREFIX</code>
		が自動的に設定されます。</td></tr><tr><td><code class="varname">XMKMF</code></td><td><code class="command">xmkmf</code> が <code class="envar">PATH</code>
		にない場合にパスを設定してください。
		デフォルトは <code class="literal">xmkmf -a</code> になります。</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-automake"></a>6.5. <code class="command">automake</code>, <code class="command">autoconf</code>
	および <code class="command">libtool</code> の利用</h2></div></div></div><div class="table"><a id="idp78819408"></a><div class="table-title">表6.3 automake, autoconf または libtool
	  を使用する ports 用の変数</div><div class="table-contents"><table summary="automake, autoconf または libtool&#10;&#9;  を使用する ports 用の変数" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>変数</th><th>意味</th></tr></thead><tbody><tr><td><code class="varname">USE_AUTOMAKE</code></td><td>その port は <code class="command">automake</code> を使用します。
		<code class="varname">USE_AUTOCONF</code> と
		<code class="literal">USE_AUTOMAKE_VER?=14</code>
		が自動的に設定されます。</td></tr><tr><td><code class="varname">AUTOMAKE</code></td><td><code class="command">automake</code> が <code class="envar">PATH</code>
		に含まれない場合のフルパス。</td></tr><tr><td><code class="varname">USE_AUTOMAKE_VER</code></td><td>その port は <code class="command">automake</code>
		を使用します。この変数の有効な値は
		<code class="literal">14</code> と <code class="literal">15</code>
		で、<code class="varname">AUTOMAKE_DIR</code> および
		<code class="varname">ACLOCAL_DIR</code>
		変数が適切な値に設定されます。</td></tr><tr><td><code class="varname">AUTOMAKE_ARGS</code></td><td><code class="varname">USE_AUTOMAKE_VER</code>
		が設定されていた場合に <code class="varname">AUTOMAKE</code>
		に渡す 1 つまたはそれ以上のコマンドライン引数</td></tr><tr><td><code class="varname">AUTOMAKE_ENV</code></td><td><code class="varname">AUTOMAKE</code>
		を実行する前に設定する 1 つまたはそれ以上の環境変数 (とその値)</td></tr><tr><td><code class="varname">ACLOCAL</code></td><td>GNU <code class="command">aclocal</code> が <code class="envar">PATH</code>
		にない場合にパスを設定してください。デフォルトは
		<code class="varname">USE_AUTOMAKE_VER</code>
		変数に応じて設定されます。</td></tr><tr><td><code class="varname">ACLOCAL_DIR</code></td><td>GNU <code class="command">aclocal</code>
		の共有ディレクトリのパスを設定してください。
		デフォルトは <code class="varname">USE_AUTOMAKE_VER</code>
		変数に応じて設定されます。</td></tr><tr><td><code class="varname">AUTOMAKE_DIR</code></td><td>GNU <code class="command">automake</code>
		の共有ディレクトリのパスを設定してください。
		デフォルトは <code class="varname">USE_AUTOMAKE_VER</code>
		変数に応じて設定されます。</td></tr><tr><td><code class="varname">USE_AUTOCONF_VER</code></td><td>その port が <code class="command">autoconf</code>
		を使用することを指定します。デフォルト値は 213 です。</td></tr><tr><td><code class="varname">USE_AUTOCONF</code></td><td>その port が <code class="command">autoconf</code>
		を使用することを指定します。<code class="literal">GNU_CONFIGURE</code>
		および <code class="literal">USE_AUTOCONF_VER?=213</code>
		を自動的に設定します。</td></tr><tr><td><code class="varname">AUTOCONF</code></td><td>GNU <code class="command">autoconf</code> が <code class="envar">PATH</code>
		にない場合にパスを設定してください。デフォルトは
		<code class="varname">USE_AUTOCONF_VER</code>
		変数の値に応じて設定されます。</td></tr><tr><td><code class="varname">AUTOCONF_ARGS</code></td><td><code class="command">autoconf</code>
		に渡すコマンドライン引数</td></tr><tr><td><code class="varname">AUTOCONF_ENV</code></td><td>この変数で指定された
		<code class="literal">変数=値</code>
		の組を <code class="command">autoconf</code>
		を実行する前に環境変数として設定してください。</td></tr><tr><td><code class="varname">AUTOHEADER</code></td><td>GNU <code class="command">autoheader</code> が <code class="envar">PATH</code>
		にない場合にパスを設定してください。デフォルトは
		<code class="varname">USE_AUTOCONF_VER</code>
		の値に応じて設定されます。</td></tr><tr><td><code class="varname">AUTORECONF</code></td><td>GNU <code class="command">autoreconf</code> が <code class="envar">PATH</code>
		にない場合にパスを設定してください。デフォルトは
		<code class="varname">USE_AUTOCONF_VER</code>
		に応じて設定されます。</td></tr><tr><td><code class="varname">AUTOSCAN</code></td><td>GNU <code class="command">autoscan</code> が <code class="envar">PATH</code>
		にない場合にパスを設定してください。デフォルトは
		<code class="varname">USE_AUTOCONF_VER</code>
		に応じて設定されます。</td></tr><tr><td><code class="varname">AUTOIFNAMES</code></td><td>GNU <code class="command">autoifnames</code> が <code class="envar">PATH</code>
		にない場合にパスを設定してください。デフォルトは
		<code class="varname">USE_AUTOCONF_VER</code>
		に応じて設定されます。</td></tr><tr><td><code class="varname">USE_LIBTOOL</code></td><td>その port は <code class="command">libtool</code>
		を使用します。<code class="varname">GNU_CONFIGURE</code>
		を自動的に設定します。</td></tr><tr><td><code class="varname">LIBTOOL</code></td><td><code class="command">libtool</code> が <code class="envar">PATH</code>
		にない場合にパスを設定してください。</td></tr><tr><td><code class="varname">LIBTOOLFILES</code></td><td><code class="command">libtool</code> 用のパッチファイル。
		デフォルトは <code class="varname">USE_AUTOCONF</code>
		が設定されていれば <code class="literal">aclocal.m4</code>、
		それ以外は <code class="literal">configure</code> です。</td></tr><tr><td><code class="varname">LIBTOOLFLAGS</code></td><td><code class="command">ltconfig</code> に追加で渡すフラグ。
		デフォルトは <code class="literal">--disable-ltlibs</code>。</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-gnome"></a>6.6. GNOME の利用</h2></div></div></div><p>FreeBSD/GNOME プロジェクトは、ある特定の port
	が使っている GNOME コンポーネントを特定するために
	独自の変数群を使っています。
	FreeBSD/GNOME プロジェクトのページに
	<a class="link" href="http://www.FreeBSD.org/gnome/docs/porting.html" target="_top">その変数のわかりやすい一覧</a>
	があります。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-kde"></a>6.7. KDE の利用</h2></div></div></div><div class="table"><a id="idp78897104"></a><div class="table-title">表6.4 KDE を利用する ports 用の変数</div><div class="table-contents"><table summary="KDE を利用する ports 用の変数" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USE_QT_VER</code></td><td>その port は Qt ツールキットを使用します。
		設定できる値は、
		<code class="literal">1</code>, <code class="literal">2</code> および
		<code class="literal">3</code> で、それぞれ使用する Qt
		のメジャーバージョンを示します。
		これは、<code class="varname">MOC</code> と <code class="varname">QTCPPFLAGS</code>
		をデフォルトの適切な値に設定します。</td></tr><tr><td><code class="varname">USE_KDELIBS_VER</code></td><td>その port は KDE ライブラリを使用します。
		設定できる値は、
		<code class="literal">1</code>, <code class="literal">2</code> および
		<code class="literal">3</code> で、それぞれ使用する KDE
		のメジャーバージョンを示します。
		暗黙で <code class="varname">USE_QT_VER</code>
		に適切なバージョンを設定します。</td></tr><tr><td><code class="varname">USE_KDEBASE_VER</code></td><td>その port は KDE base を使用します。
		設定できる値は、
		<code class="literal">1</code>, <code class="literal">2</code> および
		<code class="literal">3</code> で、それぞれ使用する KDE
		のメジャーバージョンを示します。
		暗黙で <code class="varname">USE_KDELIBS_VER</code>
		に適切なバージョンを設定します。</td></tr><tr><td><code class="varname">MOC</code></td><td><code class="command">moc</code> へのパスを設定してください。
		デフォルトでは、<code class="varname">USE_QT_VER</code>
		の値に応じて設定されます。</td></tr><tr><td><code class="varname">QTCPPFLAGS</code></td><td>Qt のコードを処理する際の <code class="varname">CPPFLAGS</code>
		を設定してください。デフォルトでは
		<code class="varname">USE_QT_VER</code> の値に応じて設定されます。</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-bison"></a>6.8. Bison の利用</h2></div></div></div><p>この節はまだ書かれていません。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-java"></a>6.9. Java の利用</h2></div></div></div><p>あなたが作成している port の構築、実行、
	または配布ファイルの展開に Java™ 開発キット (JDK)
	が必要なら、<code class="varname">USE_JAVA</code>
	を定義してください。</p><p>Ports Collection には、さまざまなベンダの JDK
	のいろいろなバージョンがあります。
	あなたが作成している port
	がその中のいずれかのバージョンを使わなければならないなら、
	どれを使うか指定できます。最新のバージョンは、
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/java/jdk14/pkg-descr">java/jdk14</a> です。</p><div class="table"><a id="idp78928208"></a><div class="table-title">表6.5 Java を利用する ports で定義すべき変数</div><div class="table-contents"><table summary="Java を利用する ports で定義すべき変数" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>変数</th><th>意味</th></tr></thead><tbody><tr><td><code class="varname">USE_JAVA</code></td><td>この後の変数を有効にするには、
		この変数を定義しなければなりません。</td></tr><tr><td><code class="varname">JAVA_VERSION</code></td><td>スペースで区切られた、適合する Java
		のバージョン一覧。<code class="literal">"+"</code>
		を使ってバージョンの範囲を指定することもできます
		(使える値は、
		<code class="literal">1.1[+] 1.2[+] 1.3[+] 1.4[+]</code>)
		です)。</td></tr><tr><td><code class="varname">JAVA_OS</code></td><td>スペースで区切られた、その port に適合する JDK
		port の OS 一覧。(使える値は、
		<code class="literal">native linux</code>) です。</td></tr><tr><td><code class="varname">JAVA_VENDOR</code></td><td>スペースで区切られた、その port に適合する JDK
		port のベンダの一覧。(使える値は、
		<code class="literal">freebsd bsdjava sun ibm blackdown</code>)
		です。</td></tr><tr><td><code class="varname">JAVA_BUILD</code></td><td>この変数が設定されていると、選択した JDK を、その
		port の構築依存性に追加します。</td></tr><tr><td><code class="varname">JAVA_RUN</code></td><td>この変数が設定されていると、選択した JDK を、その
		port の実行依存性に追加します。</td></tr><tr><td><code class="varname">JAVA_EXTRACT</code></td><td>この変数が設定されていると、選択した JDK を、その
		port の展開依存性に追加します。</td></tr><tr><td><code class="varname">USE_JIKES</code></td><td>その port の構築に <code class="command">jikes</code>
		バイトコードコンパイラを使うべきかどうかを示します。
		この変数に何の値も設定されていない時は、port は
		<code class="command">jikes</code> が使えたら構築に利用します。
		<code class="command">jikes</code> の利用を明示的に禁止したり、
		強制したりすることも可能です (<code class="literal">'no'</code>
		か <code class="literal">'yes'</code> を設定してください)。
		後者の場合は、<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/jikes/pkg-descr">devel/jikes</a>
		が port の構築依存性に追加されます。</td></tr></tbody></table></div></div><br class="table-break" /><p>以下は、<code class="varname">USE_JAVA</code>
	を設定した port で行われる設定の一覧です。</p><div class="table"><a id="idp78955728"></a><div class="table-title">表6.6 Java を利用する ports で設定される変数</div><div class="table-contents"><table summary="Java を利用する ports で設定される変数" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>変数</th><th>値</th></tr></thead><tbody><tr><td><code class="varname">JAVA_PORT</code></td><td>JDK port の名称 (例:
		<code class="literal">'java/jdk14'</code>)。</td></tr><tr><td><code class="varname">JAVA_PORT_VERSION</code></td><td>JDK の完全なバージョン (例:
		<code class="literal">'1.4.2'</code>)。最初の数字
		2 つだけしか必要でなければ、
		<code class="varname">${JAVA_PORT_VERSION:C/^([0-9])\.([0-9])(.*)$/\1.\2/}</code>
		を使ってください。</td></tr><tr><td><code class="varname">JAVA_PORT_OS</code></td><td>JDK port が利用する OS (例:
		<code class="literal">'linux'</code>)。</td></tr><tr><td><code class="varname">JAVA_PORT_VENDOR</code></td><td>JDK port のベンダ (例:
		<code class="literal">'sun'</code>)。</td></tr><tr><td><code class="varname">JAVA_PORT_OS_DESCRIPTION</code></td><td>JDK port が利用する OS の説明 (例:
		<code class="literal">'Linux'</code>)。</td></tr><tr><td><code class="varname">JAVA_PORT_VENDOR_DESCRIPTION</code></td><td>JDK port のベンダの説明 (例:
		<code class="literal">'FreeBSD Foundation'</code>)。</td></tr><tr><td><code class="varname">JAVA_HOME</code></td><td>JDK がインストールされているディレクトリのパス
		(例: <code class="filename">'/usr/local/jdk1.3.1'</code>)。</td></tr><tr><td><code class="varname">JAVAC</code></td><td>使用する Java コンパイラのパス (例:
		<code class="filename">'/usr/local/jdk1.1.8/bin/javac'</code>
		または
		<code class="filename">'/usr/local/bin/jikes'</code>)。</td></tr><tr><td><code class="varname">JAR</code></td><td>使用する <code class="command">jar</code> ツールのパス (例:
		<code class="filename">'/usr/local/jdk1.2.2/bin/jar'</code>
		または
		<code class="filename">'/usr/local/bin/fastjar'</code>)。</td></tr><tr><td><code class="varname">APPLETVIEWER</code></td><td><code class="command">appletviewer</code>
		ユーティリティへのパス (例:
		<code class="filename">'/usr/local/linux-jdk1.2.2/bin/appletviewer'</code>)。</td></tr><tr><td><code class="varname">JAVA</code></td><td><code class="command">java</code> 実行ファイルへのパス。
		Java プログラムの実行にはこれを使ってください (例:
		<code class="filename">'/usr/local/jdk1.3.1/bin/java'</code>)。</td></tr><tr><td><code class="varname">JAVADOC</code></td><td><code class="command">javadoc</code>
		ユーティリティプログラムへのパス。</td></tr><tr><td><code class="varname">JAVAH</code></td><td><code class="command">javah</code>
		プログラムへのパス。</td></tr><tr><td><code class="varname">JAVAP</code></td><td><code class="command">javap</code>
		プログラムへのパス。</td></tr><tr><td><code class="varname">JAVA_KEYTOOL</code></td><td><code class="command">keytool</code>
		ユーティリティプログラムへのパス。
		この変数は、JDK が Java 1.2
		以上の場合のみ利用可能です。</td></tr><tr><td><code class="varname">JAVA_N2A</code></td><td><code class="command">native2ascii</code>
		ツールへのパス。</td></tr><tr><td><code class="varname">JAVA_POLICYTOOL</code></td><td><code class="command">policytool</code>
		プログラムへのパス。この変数は、JDK が Java 1.2
		以上の場合のみ利用可能です。</td></tr><tr><td><code class="varname">JAVA_SERIALVER</code></td><td><code class="command">serialver</code>
		ユーティリティプログラムへのパス。</td></tr><tr><td><code class="varname">RMIC</code></td><td>RMI スタブ/スケルトンジェネレータ
		<code class="command">rmic</code> へのパス。</td></tr><tr><td><code class="varname">RMIREGISTRY</code></td><td>RMI レジストリプログラム
		<code class="command">rmiregistry</code> へのパス。</td></tr><tr><td><code class="varname">RMID</code></td><td>RMI デーモンプログラム <code class="command">rmid</code>
		へのパス。この変数は、JDK が Java 1.2
		以上の場合のみ利用可能です。</td></tr><tr><td><code class="varname">JAVA_CLASSES</code></td><td>JDK クラスファイルが入っているアーカイブへのパス。
		JDK 1.2 以降では、これは
		<code class="filename">${JAVA_HOME}/jre/lib/rt.jar</code> です。
		それより前の JDK は、
		<code class="filename">${JAVA_HOME}/lib/classes.zip</code>
		を使います。</td></tr></tbody></table></div></div><br class="table-break" /><p>Port のデバッグ情報を得るのに、
	<code class="literal">java-debug</code> make ターゲットが使えます。
	これは、前述の変数の多くについて値を表示します。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-python"></a>6.10. Python の利用</h2></div></div></div><p>この節はまだ書かれていません。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-emacs"></a>6.11. Emacs の利用</h2></div></div></div><p>この節はまだ書かれていません。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-ruby"></a>6.12. Ruby の利用</h2></div></div></div><p>この節はまだ書かれていません。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-sdl"></a>6.13. SDL の利用</h2></div></div></div><p><code class="varname">USE_SDL</code> 変数は、
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/sdl12/pkg-descr">devel/sdl12</a> や
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/sdl_gui/pkg-descr">x11-toolkits/sdl_gui</a>
	など、SDL ベースの ports
	への依存を自動設定するのに使われます。</p><p>今のところ、次の SDL ライブラリが認識されます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>sdl: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/sdl12/pkg-descr">devel/sdl12</a></p></li><li class="listitem"><p>gfx: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sdl_gfx/pkg-descr">graphics/sdl_gfx</a></p></li><li class="listitem"><p>gui: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/sdl_gui/pkg-descr">x11-toolkits/sdl_gui</a></p></li><li class="listitem"><p>image: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sdl_image/pkg-descr">graphics/sdl_image</a></p></li><li class="listitem"><p>ldbad: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/sdl_ldbad/pkg-descr">devel/sdl_ldbad</a></p></li><li class="listitem"><p>mixer: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/sdl_mixer/pkg-descr">audio/sdl_mixer</a></p></li><li class="listitem"><p>mm: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/sdlmm/pkg-descr">devel/sdlmm</a></p></li><li class="listitem"><p>net: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/sdl_net/pkg-descr">net/sdl_net</a></p></li><li class="listitem"><p>sound: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/sdl_sound/pkg-descr">audio/sdl_sound</a></p></li><li class="listitem"><p>ttf: <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sdl_ttf/pkg-descr">graphics/sdl_ttf</a></p></li></ul></div><p>したがって、ある port が
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/sdl_net/pkg-descr">net/sdl_net</a> と
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/sdl_mixer/pkg-descr">audio/sdl_mixer</a>
	に依存していたら、構文は次のようになります。</p><pre class="programlisting">USE_SDL=	  net mixer</pre><p><a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/sdl_net/pkg-descr">net/sdl_net</a> と
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/audio/sdl_mixer/pkg-descr">audio/sdl_mixer</a>
	が必要とする <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/devel/sdl12/pkg-descr">devel/sdl12</a>
	の依存も自動的に追加されます。</p><p><code class="varname">USE_SDL</code>
	を使うと、以下のことが自動的に行われます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">BUILD_DEPENDS</code> に
	    <span class="application">sdl11-config</span>
	    への依存を追加します。</p></li><li class="listitem"><p><code class="varname">CONFIGURE_ENV</code> に
	    <code class="varname">SDL_CONFIG</code> 変数を追加します。</p></li><li class="listitem"><p><code class="varname">LIB_DEPENDS</code>
	    に選択したライブラリへの依存を追加します。</p></li></ul></div><p>SDL ライブラリが利用できるかどうか調べるためには、
	<code class="varname">WANT_SDL</code> 変数を使ってください。</p><pre class="programlisting">WANT_SDL=yes

.include &lt;bsd.port.pre.mk&gt;

.if ${HAVE_SDL:Mmixer}!=""
USE_SDL+=   mixer
.endif

.include &lt;bsd.port.post.mk&gt;</pre></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-masterdir"></a>第7章 <code class="varname">MASTERDIR</code></h1></div></div></div><p>その port の変数 (たとえば解像度とか紙のサイズなど) を
      変えたりした、少しだけ違うバージョンを作成する必要があるときには、
      ユーザが分りやすいように package ごとに別々のサブディレクトリを作成し、
      できるだけ port 間でファイルを共有するようにしてください。
      ほとんどの場合、うまく変数を使えば、一つを除くすべてのディレクトリには
      とても短い <code class="filename">Makefile</code> を置くだけで済みます。
      その短い <code class="filename">Makefile</code> では、
      <code class="varname">MASTERDIR</code> を使って、
      残りのファイルがあるディレクトリを指定できます。
      また、<a class="link" href="#porting-pkgname" title="5.2.4. package 名についての規則"><code class="varname">PKGNAMESUFFIX</code></a> の
      一部に変数に使って、package が別々の名前を持つようにしてください。</p><p>具体的な例を示すのが一番わかりやすいでしょう。
      これは <code class="filename">japanese/xdvi300/Makefile</code> の一部です。</p><pre class="programlisting">PORTNAME=       xdvi
PORTVERSION=    17
PKGNAMEPREFIX=  ja-
PKGNAMESUFFIX=  ${RESOLUTION}
 :
# default
RESOLUTION?=   300
.if ${RESOLUTION} != 118 &amp;&amp; ${RESOLUTION} != 240 &amp;&amp; \
       ${RESOLUTION} != 300 &amp;&amp; ${RESOLUTION} != 400
       @${ECHO} "Error: invalid value for RESOLUTION: \"${RESOLUTION}\""
       @${ECHO} "Possible values are: 118, 240, 300 (default) and 400."
       @${FALSE}
.endif</pre><p><a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/japanese/xdvi300/pkg-descr">japanese/xdvi300</a> には
      <code class="filename">Makefile</code> の他に通常のパッチや、
      package ファイル等が置かれています。
      このディレクトリで <code class="command">make</code> を実行すると、
      デフォルトの解像度 (300) を使って、
      普通に port のビルドを行ないます。</p><p>他の解像度に関していうと、
      <code class="filename">xdvi118/Makefile</code> に
      必要なのは<span class="emphasis"><em>これだけ</em></span>です:</p><pre class="programlisting">RESOLUTION=     118
MASTERDIR=      ${.CURDIR}/../xdvi300

.include "${MASTERDIR}/Makefile"</pre><p>(<code class="filename">xdvi240/Makefile</code> や
      <code class="filename">xdvi400/Makefile</code> も同様のものになります)。
      <code class="filename">bsd.port.mk</code> は、
      <code class="varname">MASTERDIR</code> の定義から
      <code class="varname">FILESDIR</code> や <code class="varname">SCRIPTDIR</code> 等の
      通常のサブディレクトリが <code class="filename">xdvi300</code>
      以下に存在することを理解します。
      <code class="literal">RESOLUTION=118</code> の行が、
      <code class="filename">xdvi300/Makefile</code> の
      <code class="literal">RESOLUTION=300</code> の行を上書きし、
      port は解像度を 118 として作成されます。</p></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="shared"></a>第8章 共有ライブラリのバージョン</h1></div></div></div><p>まず<a class="link" href="../developers-handbook/policies-shlib.html" target="_top">
      共有ライブラリのバージョンについての指針</a>を読んで、
      一般的に共有ライブラリのバージョンをどうすれば良いかを理解してください。
      ソフトウェアの作者は自分がしていることを理解していると、
      盲目的に信じていてはいけません。多くの場合は理解していないのです。
      細部にわたって注意深く考慮することは大変重要です。なぜなら我々は、
      互換性がないかもしれない大量のソフトウェアを共存させようとする特殊な状況にあるからです。
      むかし、不注意な port
      の導入が共有ライブラリに関する重大な問題を引き起してしまったことがあります
      (なぜ <code class="filename">jpeg-6b</code> の共有ライブラリのバージョン番号が
      9 なのか、今まで不思議に思ったことはありませんか?)。
      もし疑問があれば、<a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">FreeBSD ports メーリングリスト</a> にメールを送ってください。
      ほとんどの時間は正しい共有ライブラリのバージョンを決めることと、
      それを実現するためのパッチを作成することに終始します。</p></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-manpages"></a>第9章 マニュアルページ</h1></div></div></div><p><code class="varname">MAN[1-9LN]</code> 変数に指定したマニュアルは
      自動的に <code class="filename">pkg-plist</code> に追加されます
      (つまり、マニュアルを <code class="filename">pkg-plist</code>
      に加えては<span class="emphasis"><em>いけません</em></span>― <a class="link" href="#porting-plist" title="13.5. make の変数にあわせた pkg-plist の変更">pkg-plist の生成</a>を参照してください)。
      また、<code class="filename">/etc/make.conf</code> 中の
      <code class="varname">NOMANCOMPRESS</code> の設定に従って、インストール時に
      マニュアルを自動的に圧縮したり復元したりします。</p><p>その port が、シンボリックリンクやハードリンクを用いて、
      複数のファイル名を持つマニュアルをインストールする場合には、
      それらを識別するために <code class="varname">MLINKS</code>
      変数を使用しなければなりません。
      port によってインストールされたリンクは、
      意図したファイルをきちんと指しているかどうか確認するため、
      <code class="filename">bsd.port.mk</code> によって削除されたり、
      再作成されたりします。
      MLINKS に指定されたマニュアルも、
      <code class="filename">pkg-plist</code> に含めてはいけません。</p><p>マニュアルをインストール時に圧縮するかどうかを指定するには、
      <code class="varname">MANCOMPRESSED</code> 変数を使用します。
      この変数は <code class="literal">yes</code>, <code class="literal">no</code>
      そして <code class="literal">maybe</code> の三つの値をとることができます、
      <code class="literal">yes</code>
      はマニュアルが既に圧縮されてインストールされていること、
      <code class="literal">no</code> は圧縮されていないこと、
      <code class="literal">maybe</code> は既にそのソフトウェアが
      <code class="varname">NOMANCOMPRESS</code> の値に従っていて、
      <code class="filename">bsd.port.mk</code>
      は特別なにもする必要がないことを意味します。</p><p><code class="varname">USE_IMAKE</code> がセットされていて、
      <code class="varname">NO_INSTALL_MANPAGES</code> がセットされていなければ、
      <code class="varname">MANCOMPRESSED</code> は自動的に <code class="literal">yes</code>
      に設定されます。それ以外の場合には、<code class="varname">MANCOMPRESSED</code>
      は <code class="literal">no</code> に設定されます。
      その port にとって、デフォルトの設定が適切でない場合以外には、
      明示的に設定する必要はありません。</p><p><code class="varname">PREFIX</code>
      以外のディレクトリの下にマニュアルを置くような port
      では、そのディレクトリを <code class="varname">MANPREFIX</code>
      で指定することができます。
      さらに、いくつかの <code class="literal">perl</code> モジュールの ports のように、
      特定のセクションのマニュアルだけを非標準の場所にインストールする場合、
      個々のマニュアルのパスを
      <code class="varname">MAN<em class="replaceable"><code>sect</code></em>PREFIX</code>
      (ここで <em class="replaceable"><code>sect</code></em> は <code class="literal">1-9</code>,
      <code class="literal">L</code>, または <code class="literal">N</code> のいずれか)
      により指定することができます。</p><p>マニュアルが言語特有のサブディレクトリに置かれる場合には、
      その言語名を <code class="varname">MANLANG</code> に設定してください。
      この変数のデフォルト値は <code class="literal">""</code>
      になっています (つまり、英語のみ)。</p><p>これは、全部をまとめた例です。</p><pre class="programlisting">MAN1=           foo.1
MAN3=           bar.3
MAN4=           baz.4
MLINKS=         foo.1 alt-name.8
MANLANG=        "" ja
MAN3PREFIX=     ${PREFIX}/share/foobar
MANCOMPRESSED=  yes</pre><p>これは、この port により以下の
      6 個のファイルがインストールされることを表しています。</p><pre class="programlisting">${PREFIX}/man/man1/foo.1.gz
${PREFIX}/man/ja/man1/foo.1.gz
${PREFIX}/share/foobar/man/man3/bar.3.gz
${PREFIX}/share/foobar/man/ja/man3/bar.3.gz
${PREFIX}/man/man4/baz.4.gz
${PREFIX}/man/ja/man4/baz.4.gz</pre><p>さらに
      <code class="filename">${PREFIX}/man/man8/alt-name.8.gz</code>
      がこの port によってインストールされるかどうかわかりませんが、
      それとは無関係に foo(1) と alt-name(8)
      のマニュアルページを指すシンボリックリンクが作成されます。</p></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-motif"></a>第10章 Motif を必要とする port</h1></div></div></div><div class="toc"><div class="toc-title">目次</div><dl class="toc"><dt><span class="sect1"><a href="#motif-use">10.1. <code class="varname">USE_MOTIF</code></a></span></dt><dt><span class="sect1"><a href="#motif-lib">10.2. <code class="varname">MOTIFLIB</code></a></span></dt></dl></div><p>コンパイルに Motif ライブラリを必要とするアプリケーションがいくつかあります
      (Motif 自体は有料のものがいくつかの会社から手に入りますし、
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/lesstif/pkg-descr">x11-toolkits/lesstif</a>
      には多くのアプリケーションを動作させることが可能な無料の互換ライブラリもあります)。
      Motif は広く使われているツールキットですし、
      有料のもののライセンスでもライブラリを静的にリンクした実行形式の再配布が認められている場合が多いので、
      Motif を必要とするソフトウェアを簡単に
      (port からコンパイルする人々のために) 動的にでも、
      (package を配布する人々のために) 静的にでもリンクできるような仕組みが用意されています。</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="motif-use"></a>10.1. <code class="varname">USE_MOTIF</code></h2></div></div></div><p>Motif が無いとコンパイルできない port
	の <code class="filename">Makefile</code> では、この変数を指定してください。
	これにより、Motif を持っていない人がこの
	port をコンパイルしようとするのを未然に防ぎます。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="motif-lib"></a>10.2. <code class="varname">MOTIFLIB</code></h2></div></div></div><p>この変数は <code class="filename">bsd.port.mk</code> によって適当な
	Motif ライブラリの指定に置き換えられます。Port のソースの
	<code class="filename">Makefile</code> や <code class="filename">Imakefile</code>
	で Motif ライブラリを参照しているところを、
	この変数を参照するようにパッチを適用してください。</p><p>代表的な例としては以下の二つがあげられます:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Makefile か Imakefile の中で Motif ライブラリが
	    <code class="option">-lXm</code> として使われている場合には、
	    かわりに
	    <code class="varname">MOTIFLIB</code>
	    と書いてください。</p></li><li class="listitem"><p>Imakefile の中で <code class="literal">XmClientLibs</code>
	    が使われている場合には、それを
	    <code class="literal">${MOTIFLIB} ${XTOOLLIB} ${XLIB}</code>
	    と書きかえてください。</p></li></ol></div><p>なお <code class="varname">MOTIFLIB</code> は通常、
	<code class="literal">-L/usr/X11R6/lib   -lXm</code> か
	<code class="literal">/usr/X11R6/lib/libXm.a</code>
	に置き換えられます。
	したがって前に <code class="option">-L</code> や
	<code class="option">-l</code> をつける必要はありません。</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="x11-fonts"></a>第11章 X11 のフォント</h1></div></div></div><p>もし、あなたの port が X Window System
      のフォントをインストールするのであれば、
      それらを
      <code class="filename">X11BASE/lib/X11/fonts/local</code>
      に置くようにしてください。このディレクトリは
      <span class="application">XFree86 3.3.3</span> で新設されたものです。
      このディレクトリが存在しなければ作成して、ユーザに
      <span class="application">XFree86</span> を
      3.3.3 かそれより新しいものに更新するか、
      少なくともこのディレクトリを <code class="filename">/etc/XF86Config</code>
      のフォントパスに加えるように促すメッセージを出力するようにしてください。
    </p></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-info"></a>第12章 Info ファイル</h1></div></div></div><p>あなたが作成している package で GNU info
       ファイルをインストールする必要があれば、それを
       <code class="varname">INFO</code> 変数に (後ろの <code class="literal">.info</code>
       なしで) 書いてください。package 登録の前に一時的に生成された
       <code class="filename">pkg-plist</code> に、
       適切なインストールおよびアンインストールコードが自動的に追加されます。</p></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="pkg-files"></a>第13章 <code class="filename">pkg-*</code> ファイル</h1></div></div></div><div class="toc"><div class="toc-title">目次</div><dl class="toc"><dt><span class="sect1"><a href="#porting-message">13.1. <code class="filename">pkg-message</code></a></span></dt><dt><span class="sect1"><a href="#pkg-install">13.2. <code class="filename">pkg-install</code></a></span></dt><dt><span class="sect1"><a href="#pkg-deinstall">13.3. <code class="filename">pkg-deinstall</code></a></span></dt><dt><span class="sect1"><a href="#pkg-req">13.4. <code class="filename">pkg-req</code></a></span></dt><dt><span class="sect1"><a href="#porting-plist">13.5. make の変数にあわせた
	<code class="filename">pkg-plist</code> の変更</a></span></dt><dt><span class="sect1"><a href="#pkg-names">13.6. <code class="filename">pkg-*</code>
	ファイルの名前変更</a></span></dt></dl></div><p><code class="filename">pkg-*</code> ファイルには、
      まだ取り上げていない何かと重宝なトリックがいくつかあります。</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-message"></a>13.1. <code class="filename">pkg-message</code></h2></div></div></div><p>もしインストールする人にメッセージを表示する必要がある場合には、
	そのメッセージを
	<code class="filename">pkg-message</code> に置くことができます。
	この機能は <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_add</span>(1)</span></a>
	の後の追加のインストール手続きを表示するときなどに重宝します。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">
	  <code class="filename">pkg-message</code> ファイルは
	  <code class="filename">pkg-plist</code> に加える必要はありません。
	  また、もしユーザが package ではなく
	  port を使用している場合には自動的には表示されませんので、
	  明示的に <code class="buildtarget">post-install</code>
	  で表示するようにするべきでしょう。</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="pkg-install"></a>13.2. <code class="filename">pkg-install</code></h2></div></div></div><p>バイナリパッケージが <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_add</span>(1)</span></a>
	でインストールされるときに実行する必要のあるコマンドがあれば、
	<code class="filename">pkg-install</code>
	スクリプトを使って実行することができます。
	このスクリプトは自動的に package に加えられ、
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_add</span>(1)</span></a> によって 2 回実行されます。
	1 回目は
	<code class="literal">${SH} pkg-install ${PKGNAME} PRE-INSTALL</code>
	として、2 回目には
	<code class="literal">${SH} pkg-install ${PKGNAME} POST-INSTALL</code>
	として実行されます。
	どちらのモードで実行されているかは
	<code class="literal">$2</code> を調べることによってわかります。
	環境変数 <code class="envar">PKG_PREFIX</code> には
	package がインストールされるディレクトリが設定されます。
	詳細は <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_add</span>(1)</span></a> を見てください。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">
	  port を <code class="command">make install</code>
	  でインストールするときにはこのスクリプトは自動的に実行されません。
	  もし実行される必要があるならば port の Makefile
	  から明示的に呼ぶ必要があります。
	</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="pkg-deinstall"></a>13.3. <code class="filename">pkg-deinstall</code></h2></div></div></div><p>このスクリプトは package が削除される際に実行されます。</p><p>このスクリプトは、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_delete</span>(1)</span></a> から
	2 回実行されます。1 回目は
	<code class="literal">${SH} pkg-install ${PKGNAME} DEINSTALL</code>
	と、2 回目は
	<code class="literal">${SH} pkg-install ${PKGNAME} POST-DEINSTALL</code>
	という形で実行されます。 </p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="pkg-req"></a>13.4. <code class="filename">pkg-req</code></h2></div></div></div><p>(訳注: 実行されるマシンの状態に応じて) その port
	をインストールするべきか、そうでないかを判断する必要があるときには、
	<span class="quote">「<span class="quote">要件 (requirements)</span>」</span> スクリプト
	<code class="filename">pkg-req</code> を作ることができます。
	インストールや削除を実行すべきかどうか判断するために、
	このスクリプトがインストールや削除を実行する際に自動的に実行されます。</p><p>このスクリプトはインストール時には <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_add</span>(1)</span></a> により
	<code class="literal">pkg-req ${PKGNAME} INSTALL</code> として実行され、
	削除時には <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_delete</span>(1)</span></a> により
	<code class="literal">pkg-req ${PKGNAME} DEINSTALL</code> として
	実行されます。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-plist"></a>13.5. make の変数にあわせた
	<code class="filename">pkg-plist</code> の変更</h2></div></div></div><p>いくつかの port、特に <code class="literal">p5-</code> ports
	などは、configure のオプション
	(あるいは、<code class="literal">p5-</code>
	の場合は <code class="literal">perl</code> のバージョン) によって
	<code class="filename">pkg-plist</code> を変える必要があります。
	これを容易に実現するために
	<code class="filename">pkg-plist</code> 中の
	<code class="literal">%%OSREL%%</code>,
	<code class="literal">%%PERL_VER%%</code>,
	<code class="literal">%%PERL_VERSION%%</code>
	は適切に置き換えられるようになっています。
	<code class="literal">%%OSREL%%</code>
	の値はオペレーティングシステムの数字で表されたリビジョンです
	(たとえば <code class="literal">4.9</code>)。
	<code class="literal">%%PERL_VERSION%%</code> は <code class="command">perl</code>
	のバージョン番号全体
	(たとえば <code class="literal">5.00502</code>)
	で、<code class="literal">%%PERL_VER%%</code> は <code class="command">perl</code>
	のバージョン番号からパッチレベルを引いたものです
	(たとえば <code class="literal">5.005</code>)。</p><p>他の置き換えが必要であれば、<code class="varname">PLIST_SUB</code>
	変数に
	<code class="literal">VAR=VALUE</code>
	という形式のペアのリストを設定することによって、
	<code class="filename">pkg-plist</code> 中の
	<code class="literal">%%VAR%%</code> は
	<em class="replaceable"><code>VALUE</code></em> に置き換えられます。
	たとえばバージョンに固有のたくさんのファイルをインストールする場合には、
	<code class="filename">Makefile</code> に</p><pre class="programlisting">OCTAVE_VERSION= 2.0.13
PLIST_SUB=      OCTAVE_VERSION=${OCTAVE_VERSION}</pre><p>と書いて、<code class="filename">PLIST</code>
	中のバージョン番号が表われるすべてのところに、
	<code class="literal">%%OCTAVE_VERSION%%</code> と書きます。
	このようにしておけば、port をアップグレードするときに、
	何十行 (時として、何百行) も
	<code class="filename">pkg-plist</code>
	を書き替えないですみます。</p><p>この書き換えは
	(<a class="link" href="#porting-manpages" title="第9章 マニュアルページ">マニュアル</a>の追加も)
	<code class="buildtarget">pre-install</code> と
	<code class="buildtarget">do-install</code> ターゲットの間に
	<code class="varname">pkg-plist</code> を読み
	<code class="varname">TMPPLIST</code>
	(デフォルトは
	<code class="filename">WRKDIR/.PLIST.mktmp</code>)
	に書き込むことによって行なわれます。
	もし、あなたの port が
	<code class="varname">PLIST</code> を実行時に生成するのであれば、
	<code class="buildtarget">pre-install</code>
	の間かその前に行なうようにしてください。
	また、書きかえられたあとのファイルを編集する必要がある場合には、
	<code class="buildtarget">post-install</code>
	で <code class="varname">TMPPLIST</code> を書きかえてください。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="pkg-names"></a>13.6. <code class="filename">pkg-*</code>
	ファイルの名前変更</h2></div></div></div><p><code class="filename">pkg-*</code>
	ファイルの名前はすべて変数を使用して定義されていますので、
	必要であれば
	<code class="filename">Makefile</code> 中で変更可能です。
	いくつかの ports で一つの
	<code class="filename">pkg-*</code>
	ファイルを共有する場合や、
	上記のファイルに書き込みをしなければならないときなど特に便利です
	(<code class="filename">pkg-*</code>
	サブディレクトリに直接書き込むのが良くない理由については
	<a class="link" href="#porting-wrkdir" title="16.4. WRKDIR"><code class="varname">WRKDIR</code>
	以外への書きこみ</a> を参照してください)。</p><p>以下に変数名と そのデフォルト値のリストを示します。
	(<code class="varname">PKGDIR</code> のデフォルト値は
	<code class="varname">${MASTERDIR}</code> になっています。)</p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><thead><tr><th>変数名</th><th>デフォルト値</th></tr></thead><tbody><tr><td><code class="varname">DESCR</code></td><td><code class="literal">${PKGDIR}/pkg-descr</code></td></tr><tr><td><code class="varname">PLIST</code></td><td><code class="literal">${PKGDIR}/pkg-plist</code></td></tr><tr><td><code class="varname">PKGINSTALL</code></td><td><code class="literal">${PKGDIR}/pkg-install</code></td></tr><tr><td><code class="varname">PKGDEINSTALL</code></td><td><code class="literal">${PKGDIR}/pkg-deinstall</code></td></tr><tr><td><code class="varname">PKGREQ</code></td><td><code class="literal">${PKGDIR}/pkg-req</code></td></tr><tr><td><code class="varname">PKGMESSAGE</code></td><td><code class="literal">${PKGDIR}/pkg-message</code></td></tr></tbody></table></div><p><code class="varname">PKG_ARGS</code>
	を上書きせずにこれらの変数を変更するようにしてください。
	<code class="varname">PKG_ARGS</code>
	を変更すると、これらのファイルは port から正しく
	<code class="filename">/var/db/pkg</code>
	にインストールされなくなります。</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="testing"></a>第14章 port のテスト</h1></div></div></div><div class="toc"><div class="toc-title">目次</div><dl class="toc"><dt><span class="sect1"><a href="#testing-portlint">14.1. portlint</a></span></dt><dt><span class="sect1"><a href="#porting-prefix">14.2. <code class="varname">PREFIX</code></a></span></dt><dt><span class="sect1"><a href="#testing-freshports">14.3. FreshPorts 正当性テスト</a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="testing-portlint"></a>14.1. portlint</h2></div></div></div><p>送付や commit をする前に
	<a class="link" href="#porting-portlint" title="3.5. portlint によるチェック"><code class="command">portlint</code></a>
	を使ってチェックしましょう。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-prefix"></a>14.2. <code class="varname">PREFIX</code></h2></div></div></div><p>なるべく port は <code class="varname">PREFIX</code>
	に対する相対パスにインストールすることができるように心がけてください
	(この変数の値は
	<code class="varname">USE_X_PREFIX</code> か
	<code class="varname">USE_IMAKE</code> が指定してある時には
	<code class="varname">X11BASE</code>
	(デフォルトは <code class="filename">/usr/X11R6</code>)、
	そうでない場合には<code class="varname">LOCALBASE</code>
	(デフォルトは <code class="filename">/usr/local</code>)
	にセットされます)。</p><p>サイトによってフリーソフトウェアがインストールされる場所が違いますので、
	ソース内で
	<code class="filename">/usr/local</code> や
	<code class="filename">/usr/X11R6</code>
	を明示的に書かないようにしてください。
	X のプログラムで
	<code class="command">imake</code> を使うものについては、
	
	これは問題にはなりません。
 	それ以外の場合には port の <code class="filename">scripts/Makefile</code> で
	<code class="filename">/usr/local</code>
	(imake を使わない X のプログラムは <code class="filename">/usr/X11R6</code>)
	と書いてあるところを、
	<code class="varname">${PREFIX}</code> に書き換えてください。
	この値は port のコンパイルおよび、
	インストールの全段階において、自動的に下位のプロセスに渡されます。</p><p>そのアプリケーションが <code class="varname">PREFIX</code> を
	使用しないで、何かを直接 <code class="filename">/usr/local</code> に
	インストールしないことを確認してください。
	以下のようにすると、簡単なテストを行なうことができます:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make clean; make package PREFIX=/var/tmp/port-name</code></strong></pre><p>この時、もし <code class="varname">PREFIX</code> の外に
	何かがインストールされていた場合、package 生成プロセスは
	ファイルが見つからないと文句を言うはずです。</p><p>ただし、これは そのソフトウェアが内部で決め打ちの参照を
	していないかどうか だとか、他の port によってインストールされる
	ファイルを参照する際に <code class="varname">LOCALBASE</code> を
	正しく使用しているかどうかをテストしているわけではありません。
	その port を他の場所にインストールした状態で、
	<code class="filename">/var/tmp/port-name</code> に
	対するインストールを試みることにより、
	そのテストをすることができるでしょう。</p><p><code class="varname">USE_X_PREFIX</code> は本当に必要な時 (つまり
	X のライブラリをリンクしたり、<code class="varname">X11BASE</code> 以下にある
	ファイルを参照したりする必要がある時) 以外には
	設定しないでください。</p><p>変数 <code class="varname">PREFIX</code> の値は
	port の Makefile やユーザの環境で変更することもできます。
	しかし、個々の port が Makefile
	でこの変数の値を明示的に設定することはなるべくしないでください。</p><p>また、他の port によりインストールされるプログラムや
	ファイルを指定する場合には、直接的なパス名を使用するのではなく
	上で述べた変数を使用してください。
	たとえば <code class="command">less</code> のフルパスを
	<code class="literal">PAGER</code> というマクロに入れたい場合は、
	<code class="literal">-DPAGER=\"/usr/local/bin/less\"</code>
	というフラグをコンパイラに渡すかわりに
	</p><pre class="programlisting">-DPAGER=\"${PREFIX}/bin/less\"</pre><p>
	(X Window System を使う port の場合には
	</p><pre class="programlisting">-DPAGER=\"${LOCALBASE}/bin/less\"</pre><p>)
	を渡してください。
	こうしておけば、システム管理者が <code class="filename">/usr/local</code> を
	まるごと どこか他の場所に移していたとしても、その port が
	そのまま使える可能性が高くなります。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="testing-freshports"></a>14.3. FreshPorts 正当性テスト</h2></div></div></div><p><code class="uri"><a class="uri" href="http://www.FreshPorts.org/" target="_top">http://www.FreshPorts.org/</a></code>
	には、FreeBSD ports へ commit されたものについて、
	自動的に正当性テストを行う仕組みがあります。
	このサービスに登録すると、あなたが commit したものについて、
	正当性テストでエラーが起きると連絡が行きます。</p><p>このサービスを利用したい場合、必要なのは FreshPorts
	のアカウントだけです。登録したメールアドレスが
	<code class="literal">@FreeBSD.org</code>	のものであれば、
	ウェブページの右側にサービスを選択するリンクがあるはずです。
	FreshPorts にアカウントを持っていても
	<code class="literal">@FreeBSD.org</code>
	のメールアドレスを利用していない場合、メールアドレスを
	<code class="literal">@FreeBSD.org</code> に変え、登録したあとで、
	メールアドレスをまた変更してください。</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="port-upgrading"></a>第15章 アップグレード</h1></div></div></div><p>port のバージョンが原作者からのものに比べて古いことに気がついたら、
      まずはあなたの持っている port が私たちの最新のもの
      (最新の port は FreeBSD FTP ミラーサイトの <code class="filename">ports/ports-current</code>
      というディレクトリにあります)
      であることを確認してください。
      また、Ports Collection 全体を最新の状態に保つために
      <span class="application">CVSup</span> を利用することもできます。
      詳しくは
      <a class="link" href="../handbook/synching.html#CVSUP-CONFIG" target="_top">FreeBSD
	ハンドブック</a>をご覧ください。</p><p>次に port の
      <code class="filename">Makefile</code> に
      <code class="varname">MAINTAINER</code> (保守担当者)
      のアドレスが書いてある場合には、その人にメールを出してみましょう。
      保守担当者の人がすでにアップグレードの準備をしているかも知れませんし、
      (新しいバージョンの安定度に問題があるなど)
      あえてアップグレードをしない理由があるのかも知れません。
      その人たちと作業を重複させたくはないでしょう。
      なお、保守されていない ports は、保守担当者が
      <code class="literal">ports@FreeBSD.org</code>
      になっています。その場合は、
      そのアドレスにメールを送っても役に立たないでしょう。</p><p>保守担当者にアップグレードをしてくれと頼まれた場合、
      あるいは、保守担当者が <code class="literal">ports@FreeBSD.org</code>
      の場合は、あなたがアップグレードをしてくださると助かります。
      その場合にはアップグレードを作成した後、
      変更前と変更後のディレクトリの再帰的 <code class="command">diff</code>
      の出力結果を保存してください
      (たとえば変更前のディレクトリが
      <code class="filename">superedit.bak</code>
      という名前でとってあり、変更後のものが
      <code class="filename">superedit</code>
      に入っているなら、
      <code class="command">diff -ruN superedit.bak superedit</code>
      の結果を保存してください)。
      unified または context diff のどちらでも構いませんが
      port のコミッターは一般に unified diff の方を好むようです。
      <code class="literal">-N</code> オプションの使い方を覚えておいてください。
      これは、新たにファイルが追加されたり、
      古いファイルが削除された場合を diff
      が正しく扱えるようにする方法です。わたしたちに差分を送る前に、
      すべての変更が正しくなされているか出力結果を確認してください。</p><p>差分を送る一番良い方法は <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=send-pr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">send-pr</span>(1)</span></a>
      (カテゴリは <code class="literal">ports</code>)
      に diff の出力結果を添えて、わたしたちに送ってもらうのが一番良いです。
      commit する際に CVS に明確に記述しなければならないので、
      あなたがその port のメンテナになるなら、概要 (synopsis) 行の先頭に
      <code class="literal">[maintainer update]</code>
      と記入し、PR の <span class="quote">「<span class="quote">Class</span>」</span> を
      <code class="literal">maintainer-update</code> にしてください。
      付け加えたり削除したりしたファイルがあればそれについて書いておいてください。
      もし diff の大きさが 20 KB 程度を超えるようであれば、
      圧縮したものを uuencode してください。
      そうでなければそのまま PR に入れるだけで構いません。</p><p>最後に、役に立つ障害報告の書き方について詳しいことは、
	障害報告についての記事の
	<a class="link" href="../../articles/problem-reports/pr-writing.html" target="_top">
	障害報告の書き方</a>の節を読んでください。</p><div xmlns="" class="important"><h3 class="admontitle">重要: </h3><p xmlns="http://www.w3.org/1999/xhtml">更新の動機が、セキュリティ上の問題や、
	  現在 commit されている port に重大な欠陥である場合は、
	  ports 管理チーム <code class="email">&lt;<a xmlns="" class="email" href="mailto:portmgr@FreeBSD.org">portmgr@FreeBSD.org</a>&gt;</code> に連絡して、あなたの port
	  のパッケージをただちに作りなおして再配布するように要求してください。
	  そうしないと、無防備な <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_add</span>(1)</span></a>
	  のユーザたちが、何週間にもわたって <code class="command">pkg_add -r</code>
	  で古いバージョンをインストールし続けてしまいます。</p></div><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">繰り返しになりますが、既存の ports の変更を送るときには
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=shar&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">shar</span>(1)</span></a> ではなく <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> を使用してください!</p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-dads"></a>第16章 やっていいことといけないこと</h1></div></div></div><div class="toc"><div class="toc-title">目次</div><dl class="toc"><dt><span class="sect1"><a href="#dads-intro">16.1. はじめに</a></span></dt><dt><span class="sect1"><a href="#dads-strip">16.2. バイナリの strip</a></span></dt><dt><span class="sect1"><a href="#dads-install">16.3. <code class="varname">INSTALL_*</code> マクロ</a></span></dt><dt><span class="sect1"><a href="#porting-wrkdir">16.4. <code class="varname">WRKDIR</code></a></span></dt><dt><span class="sect1"><a href="#porting-wrkdirprefix">16.5. <code class="varname">WRKDIRPREFIX</code></a></span></dt><dt><span class="sect1"><a href="#porting-versions">16.6. OS の種類やバージョンの識別</a></span></dt><dt><span class="sect1"><a href="#freebsd-versions">16.7. __FreeBSD_version の値</a></span></dt><dt><span class="sect1"><a href="#dads-after-port-mk">16.8. <code class="filename">bsd.port.mk</code> の後に書くこと</a></span></dt><dt><span class="sect1"><a href="#dads-documentation">16.9. 付加的な文書のインストール</a></span></dt><dt><span class="sect1"><a href="#dads-subdirs">16.10. ディレクトリ構成</a></span></dt><dt><span class="sect1"><a href="#porting-cleaning">16.11. 空のディレクトリの削除</a></span></dt><dt><span class="sect1"><a href="#dads-uid">16.12. UID</a></span></dt><dt><span class="sect1"><a href="#dads-rational">16.13. 合理的な port</a></span></dt><dt><span class="sect1"><a href="#dads-cc">16.14. <code class="varname">CC</code> および <code class="varname">CXX</code>
	  の尊重</a></span></dt><dt><span class="sect1"><a href="#dads-cflags">16.15. <code class="varname">CFLAGS</code> の尊重</a></span></dt><dt><span class="sect1"><a href="#dads-config">16.16. コンフィグレーション (設定) ファイル</a></span></dt><dt><span class="sect1"><a href="#dads-freedback">16.17. フィードバック</a></span></dt><dt><span class="sect1"><a href="#dads-readme">16.18. <code class="filename">README.html</code></a></span></dt><dt><span class="sect1"><a href="#dads-broken">16.19. Port に <code class="varname">BROKEN</code>, <code class="varname">FORBIDDEN</code>
	などの印をつける</a></span></dt><dt><span class="sect1"><a href="#dads-workarounds">16.20. 必要な回避策</a></span></dt><dt><span class="sect1"><a href="#dads-misc">16.21. その他諸々</a></span></dt><dt><span class="sect1"><a href="#dads-stuck">16.22. 困ったら…</a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-intro"></a>16.1. はじめに</h2></div></div></div><p>このセクションではソフトウェアを port する上で、
      良くある落し穴などについて説明します。
      このリストを使ってあなた自身が作成した port のチェックはもとより、
      さらに<a class="link" href="http://www.FreeBSD.org/cgi/query-pr-summary.cgi?query" target="_top">障害報告データベース</a>
      にある他の人が提出した port のチェックもできます。
      PR データベースにある、
      他の人が作成した port のチェックもできます。
      あなたがチェックした port についてのコメントを<a class="link" href="../../articles/contributing/contrib-how.html#CONTRIB-GENERAL" target="_top">
      バグ報告と一般的な論評</a>にしたがって送ってください。
      PR データベースにある port をチェックすることは、
      わたしたちがそれらを commit するのを早めるとともに、
      何をしているかをあなたが理解していることも証明します。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-strip"></a>16.2. バイナリの strip</h2></div></div></div><p>バイナリは特に必要がなければ、手動で strip しないでください。
	すべてのバイナリは strip すべきですが、
	<code class="buildtarget">INSTALL_PROGRAM</code>
	マクロがバイナリのインストールと strip を同時に行います
	(次節をご覧ください)。</p><p>ファイルを strip する必要はあるものの
	<code class="varname">INSTALL_PROGRAM</code> マクロを使いたくない場合は、
	<code class="varname">${STRIP_CMD}</code> でプログラムを strip できます。
	これは、多くの場合 <code class="literal">post-install</code>
	ターゲット内で行われます。たとえば</p><pre class="programlisting">post-install:
	${STRIP_CMD} ${PREFIX}/bin/xdl</pre><p>インストールされた実行形式がすでに strip
	されているかどうかは <code class="command">file</code>
	コマンドで確認できます。
	<span class="quote">「<span class="quote">not stripped</span>」</span>
	と表示されなければ strip されていることを示しています。
	さらに、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=strip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">strip</span>(1)</span></a> はすでに strip されたプログラムは
	strip せず、問題なく終了します。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-install"></a>16.3. <code class="varname">INSTALL_*</code> マクロ</h2></div></div></div><p>あなた自身の <code class="buildtarget">*-install</code>
	ターゲットでファイルの正しいモードとオーナを保証するために、
	必ず
	<code class="filename">bsd.port.mk</code>
	で提供されているマクロを使用してください。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">${INSTALL_PROGRAM}</code>
	    は実行可能なバイナリをインストール
	    (し、その過程で strip 処理)するコマンドです。</p></li><li class="listitem"><p><code class="varname">${INSTALL_SCRIPT}</code>
	    は実行可能なスクリプトをインストールするコマンドです。</p></li><li class="listitem"><p><code class="varname">${INSTALL_DATA}</code>
	    は共有可能なデータをインストールするコマンドです。</p></li><li class="listitem"><p><code class="varname">${INSTALL_MAN}</code>
	    はマニュアルとその他の文書をインストールするコマンドです
	    (圧縮はしません)。</p></li></ul></div><p>これらは基本的に <code class="command">install</code>
	コマンドに適切なフラグを与えたものです。
	それらは distfile の <code class="filename">Makefile</code>
	で、頭に <span class="quote">「<span class="quote">BSD_</span>」</span> が付けられた
	(つまり BSD_INSTALL_PROGRM というような)
	形で使うことができます。
	どのようにこれらを使用するかは以下の例を見てください。
      </p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-wrkdir"></a>16.4. <code class="varname">WRKDIR</code></h2></div></div></div><p><code class="varname">WRKDIR</code>
	の外に存在するファイルには何も書き込んではいけません。
	port のビルド中に書き込み可能なことが保証されているのは
	<code class="varname">WRKDIR</code> の中だけです
	(書き込み不可のツリー上での port ビルドの例については、
	<a class="link" href="../handbook/ports-using.html#PORTS-CD" target="_top">CDROM からの
	ports のインストール</a> を参照のこと)。
	<code class="filename">pkg-*</code>
	ファイルを変更する必要があるときには、
	ファイルを上書きするのではなく
	<a class="link" href="#porting-pkgfiles">変数の再定義</a>により
	行なうようにしてください。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-wrkdirprefix"></a>16.5. <code class="varname">WRKDIRPREFIX</code></h2></div></div></div><p><code class="varname">WRKDIRPREFIX</code>
	を尊重していることを確認してください。特に、別の port の
	<code class="varname">WRKDIR</code> を参照しているときには気を付けてください。
	正しい場所は、
	<code class="filename">WRKDIRPREFIXPORTSDIR/subdir/name/work</code>
	です。
	<code class="filename">PORTSDIR/subdir/name/work</code>
	や
	<code class="filename">.CURDIR/../../subdir/name/work</code>
	ではありません。</p><p>また、
	自分で <code class="varname">WRKDIR</code> 定義するときには先頭に
	<code class="literal">${WRKDIRPREFIX}${.CURDIR}</code>
	が付いていることを確認してください。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-versions"></a>16.6. OS の種類やバージョンの識別</h2></div></div></div><p>どのバージョンの Unix で動かすかによって、
	変更や条件つきコンパイルが必要なコードに出くわすこともあるでしょう。
	そのような変更を行なう場合には、
	古い FreeBSD システムへのバックポートや、
	CSRG の 4.4BSD, BSD/386, 386BSD, NetBSD, OpenBSD 等、
	他の BSD システムへの移植が可能なように、
	できるだけ汎用的な変更を行なうことを心がけてください。</p><p>4.3BSD/Reno (1990) と、それより新しいバージョンの
	BSD コードを区別するには、
	<code class="filename">&lt;sys/param.h&gt;</code> で定義されている
	<code class="literal">BSD</code> マクロを利用するのがよいでしょう。
	このファイルがすでにインクルードされていれば良いのですが、
	そうでない場合には、その <code class="filename">.c</code> ファイルの
	適当な場所に以下のコードを追加してください。</p><pre class="programlisting">#if (defined(__unix__) || defined(unix)) &amp;&amp; !defined(USG)
#include &lt;sys/param.h&gt;
#endif</pre><p>これらの二つのシンボルが定義されているシステムには必ず
	<code class="filename">sys/param.h</code> があるはずです。
	もしそうでないシステムを発見したら、
	<a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">FreeBSD ports メーリングリスト</a> までメールを送ってわたしたちに伝えてください。</p><p>あるいは、GNU Autoconf のスタイルを使用することもできます。</p><pre class="programlisting">#ifdef HAVE_SYS_PARAM_H
#include &lt;sys/param.h&gt;
#endif</pre><p>この方法を使用するときには、
	<code class="filename">Makefile</code> 中の
	<code class="varname">CFLAGS</code>に
	<code class="literal">-DHAVE_SYS_PARAM_H</code>
	を加えることを忘れないようにしてください。</p><p>いったん <code class="filename">sys/param.h</code>
	がインクルードされると、</p><pre class="programlisting">#if (defined(BSD) &amp;&amp; (BSD &gt;= 199103))</pre><p>このようにしてそのコードが 4.3 Net2 コードベース、
	またはそれより新しいもの
	(例: FreeBSD 1.x, 4.3/Reno, NetBSD 0.9, 386BSD, BSD/386 1.1 とそれ以前)
	の上でコンパイルされているかを検出できます。</p><pre class="programlisting">#if (defined(BSD) &amp;&amp; (BSD &gt;= 199306))</pre><p>これは、4.4コードベース、またはそれより新しいもの
	(例: FreeBSD 2.x, 4.4, NetBSD 1.0, BSD/386 2.0 とそれ以後)
	の上でコンパイルされているかどうかを検出するために使用します。</p><p>4.4BSD-Lite2 コードベースでは
	<code class="literal">BSD</code> マクロの値は
	<code class="literal">199506</code> になっています。
	これは参考程度の意味合いしかありません。
	4.4-Lite ベースの FreeBSD と 4.4-Lite2
	での変更がマージされたバージョンとを区別するのに使用するべきものではありません。
	この目的のためにはかわりに
	<code class="literal">__FreeBSD__</code>
	マクロを使用してください。</p><p>以下は控え目に使ってください。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">__FreeBSD__</code>
	    はFreeBSDのすべての版で定義されています。
	    変更が FreeBSD だけに適用されるとき以外は使用しないでください。
	    port でよくある
	    <code class="function">strerror()</code> ではなく
	    <code class="literal">sys_errlist[]</code> を使うなどは
	    FreeBSDでの変更ではなく BSD の流儀です。</p></li><li class="listitem"><p>FreeBSD 2.xでは <code class="literal">__FreeBSD__</code> が
	    <code class="literal">2</code> と定義されています。
	    それ以前の版では <code class="literal">1</code> になっています。
	    その後の版でもメジャー番号に合うように上げています。</p></li><li class="listitem"><p>もし FreeBSD 1.x システムと FreeBSD 2.x
	    以降のシステムを区別する必要があれば、
	    上で述べた <code class="literal">BSD</code>
	    マクロを使用するのが大抵の場合において正しい答です。
	    もし FreeBSD 特有の変更であれば
	    (<code class="command">ld</code> を使うときの共有ライブラリ用のオプションなど)、
	    
	    <code class="literal">__FreeBSD__</code>を使い
	    <code class="literal">#if __FreeBSD__ &gt; 1</code>
	    のようにFreeBSD 2.x および、
	    それ以降のシステムを検出するのはかまいません。
	    もし 2.0-RELEASE 以降の FreeBSD システムを細かく検出したければ、
	    以下を使用することができます。</p><pre class="programlisting">#if __FreeBSD__ &gt;= 2
#include &lt;osreldate.h&gt;
#    if __FreeBSD_version &gt;= 199504
         /* 2.0.5+ release specific code here */
#    endif
#endif</pre></li></ul></div><p>これまで、何百もの port が作られてきましたが、
	<code class="literal">__FreeBSD__</code>
	が正しく使われたのは一つか二つの場合だけでしょう。
	以前の port が間違ってふさわしくない場所で
	そのマクロを使っているからといって、
	それをまねする理由はありません。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="freebsd-versions"></a>16.7. __FreeBSD_version の値</h2></div></div></div><p>以下は、<code class="filename">sys/param.h</code>
	で定義されている <code class="literal">__FreeBSD_version</code>
	の便利な一覧です。</p><div class="table"><a id="idp79376592"></a><div class="table-title">表16.1 __FreeBSD_version values</div><div class="table-contents"><table summary="__FreeBSD_version values" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Release</th><th><code class="literal">__FreeBSD_version</code></th></tr></thead><tbody><tr><td>2.0-RELEASE</td><td>119411</td></tr><tr><td>2.1-CURRENT</td><td>199501, 199503</td></tr><tr><td>2.0.5-RELEASE</td><td>199504</td></tr><tr><td>2.1 以前の 2.2-CURRENT</td><td>199508</td></tr><tr><td>2.1.0-RELEASE</td><td>199511</td></tr><tr><td>2.1.5 以前の 2.2-CURRENT</td><td>199512</td></tr><tr><td>2.1.5-RELEASE</td><td>199607</td></tr><tr><td>2.1.6 以前の 2.2-CURRENT</td><td>199608</td></tr><tr><td>2.1.6-RELEASE</td><td>199612</td></tr><tr><td>2.1.7-RELEASE</td><td>199612</td></tr><tr><td>2.2-RELEASE</td><td>220000</td></tr><tr><td>2.2.1-RELEASE</td><td>220000 (変更なし)</td></tr><tr><td>2.2.1-RELEASE 以降の 2.2-STABLE</td><td>220000 (変更なし)</td></tr><tr><td>texinfo-3.9 以降の 2.2-STABLE</td><td>221001</td></tr><tr><td>top 導入以降の 2.2-STABLE</td><td>221002</td></tr><tr><td>2.2.2-RELEASE</td><td>222000</td></tr><tr><td>2.2.2-RELEASE 以降の 2.2-STABLE</td><td>222001</td></tr><tr><td>2.2.5-RELEASE</td><td>225000</td></tr><tr><td>2.2.5-RELEASE 以降の 2.2-STABLE</td><td>225001</td></tr><tr><td>ldconfig -R マージ以降の 2.2-STABLE</td><td>225002</td></tr><tr><td>2.2.6-RELEASE</td><td>226000</td></tr><tr><td>2.2.7-RELEASE</td><td>227000</td></tr><tr><td>2.2.7-RELEASE 以降の 2.2-STABLE</td><td>227001</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=semctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">semctl</span>(2)</span></a> 変更以降の 2.2-STABLE</td><td>227002</td></tr><tr><td>2.2.8-RELEASE</td><td>228000</td></tr><tr><td>2.2.8-RELEASE 以降の 2.2-STABLE</td><td>228001</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">mount</span>(2)</span></a> 変更以前の 3.0-CURRENT</td><td>300000</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">mount</span>(2)</span></a> 変更以降の 3.0-CURRENT</td><td>300001</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=semctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">semctl</span>(2)</span></a> 変更以降の 3.0-CURRENT</td><td>300002</td></tr><tr><td>ioctl 引数変更以降の 3.0-CURRENT</td><td>300003</td></tr><tr><td>ELF 化以降の 3.0-CURRENT</td><td>300004</td></tr><tr><td>3.0-RELEASE</td><td>300005</td></tr><tr><td>3.0-RELEASE 以降の 3.0-CURRENT</td><td>300006</td></tr><tr><td>3/4 の分岐以降の 3.0-STABLE</td><td>300007</td></tr><tr><td>3.1-RELEASE</td><td>310000</td></tr><tr><td>3.1-RELEASE 以降の 3.1-STABLE</td><td>310001</td></tr><tr><td>C++ コンストラクタ/デストラクタ順序変更の後の
		3.1-STABLE</td><td>310002</td></tr><tr><td>3.2-RELEASE</td><td>320000</td></tr><tr><td>3.2-STABLE</td><td>320001</td></tr><tr><td>バイナリ互換性のない IPFW とソケットの変更後の
		3.2-STABLE</td><td>320002</td></tr><tr><td>3.3-RELEASE</td><td>330000</td></tr><tr><td>3.3-STABLE</td><td>330001</td></tr><tr><td>libc に <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mkstemp&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">mkstemp</span>(3)</span></a> が追加された後の 3.3-STABLE</td><td>330002</td></tr><tr><td>3.4-RELEASE</td><td>340000</td></tr><tr><td>3.4-STABLE</td><td>340001</td></tr><tr><td>3.5-RELEASE</td><td>350000</td></tr><tr><td>3.5-STABLE</td><td>350001</td></tr><tr><td>3.4 が分岐した後の 4.0-CURRENT</td><td>400000</td></tr><tr><td>dynamic linker の変更後の 4.0-CURRENT</td><td>400001</td></tr><tr><td>C++ コンストラクタ/デストラクタ順序変更の後の
		4.0-CURRENT</td><td>400002</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dladdr&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">dladdr</span>(3)</span></a> 機能追加後の 4.0-CURRENT</td><td>400003</td></tr><tr><td>__deregister_frame_info dynamic linker のバグ修正、
		EGCS 1.1.2 導入後の 4.0-CURRENT</td><td>400004</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=suser&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">suser</span>(9)</span></a> の API 変更、newbus 化
		以降の 4.0-CURRENT</td><td>400005</td></tr><tr><td>cdevsw 登録方法の変更後の 4.0-CURRENT</td><td>400006</td></tr><tr><td>ソケットレベルの証明書 (credential) のために
		so_cred が追加された後の 4.0-CURRENT</td><td>400007</td></tr><tr><td>libc_r への poll syscall ラッパー追加後の
		4.0-CURRENT</td><td>400008</td></tr><tr><td>kernel の <code class="literal">dev_t</code> 型から
		<code class="literal">struct spacinfo</code> ポインタへの
		変更後の 4.0-CURRENT</td><td>400009</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">jail</span>(2)</span></a> のセキュリティホール
		修正後の 4.0-CURRENT </td><td>400010</td></tr><tr><td><code class="literal">sigset_t</code> の
		データ型変更後の 4.0-CURRENT</td><td>400011</td></tr><tr><td>システムコンパイラを gcc 2.95.2 にアップグレードした
		後の 4.0-CURRENT</td><td>400012</td></tr><tr><td>動的組み込み可能な Linux モードの ioctl ハンドラが
		追加された後の 4.0-CURRENT</td><td>400013</td></tr><tr><td>OpenSSL 導入後の 4.0-CURRENT</td><td>400014</td></tr><tr><td>GCC 2.95.2 の C++ ABI 変更で、
		デフォルトを -fvtable-thunks から -fno-vtable-thunks に
		変更した後の 4.0-CURRENT</td><td>400015</td></tr><tr><td>OpenSSH 導入後の 4.0-CURRENT</td><td>400016</td></tr><tr><td>4.0-RELEASE</td><td>400017</td></tr><tr><td>4.0-RELEASE 以降の 4.0-STABLE</td><td>400018</td></tr><tr><td>チェックサム計算タイミングの変更後の 4.0-STABLE</td><td>400019</td></tr><tr><td>libxpg4 が libc にマージされた後の
		4.0-STABLE</td><td>400020</td></tr><tr><td>Binutils を 2.10.0 にアップグレードし、
		ELF バイナリのマーク付け (branding) 方法を変更し、
		tcsh をベースシステムに導入した後の
		4.0-STABLE</td><td>400021</td></tr><tr><td>4.1-RELEASE</td><td>410000</td></tr><tr><td>4.1-RELEASE 以降の 4.1-STABLE</td><td>410001</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=setproctitle&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">setproctitle</span>(3)</span></a> が libutil から libc に
		移動した後の 4.1-STABLE</td><td>410002</td></tr><tr><td>4.1.1-RELEASE</td><td>411000</td></tr><tr><td>4.1.1-RELEASE 以降の 4.1.1-STABLE</td><td>411001</td></tr><tr><td>4.2-RELEASE</td><td>420000</td></tr><tr><td>libgcc.a と libgcc_r.a の結合および、関連する
		GCC linkage 変更が行なわれた後の 4.2-STABLE</td><td>420001</td></tr><tr><td>4.3-RELEASE</td><td>430000</td></tr><tr><td>wint_t 導入後の 4.3-STABLE</td><td>430001</td></tr><tr><td>PCI パワーステート API マージ後の 4.3-STABLE</td><td>430002</td></tr><tr><td>4.4-RELEASE</td><td>440000</td></tr><tr><td>d_thread_t 導入後の 4.4-STABLE</td><td>440001</td></tr><tr><td>マウント構造変更 (ファイルシステム kld に影響あり)
		後の 4.4-STABLE</td><td>440002</td></tr><tr><td>smbfs のユーザランド部が取り込まれた後の
		4.4-STABLE</td><td>440003</td></tr><tr><td>4.5-RELEASE</td><td>450000</td></tr><tr><td>usb の構成要素の名称が変更された後の 4.5-STABLE</td><td>450001</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> の
		<code class="literal">sendmail_enable</code> 変数が
		<code class="literal">NONE</code> という値をとれるようになった後の
		4.5-STABLE</td><td>450004</td></tr><tr><td>package 作成のデフォルトを XFree86 4
		に移行した後の 4.5-STABLE</td><td>450005</td></tr><tr><td>accept filter が修正され、
		簡単なサービス妨害攻撃には影響を受けなくなった後の
		4.5-STABLE</td><td>450006</td></tr><tr><td>4.6-RELEASE</td><td>460000</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendfile&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">sendfile</span>(2)</span></a>
		をドキュメントに適合するよう修正して、
		送信されたいかなるヘッダも、
		ファイルから送信されたデータの総量に合計しないようにした
		4.6-STABLE</td><td>460001</td></tr><tr><td>4.6.2-RELEASE</td><td>460002</td></tr><tr><td>4.6-STABLE</td><td>460100</td></tr><tr><td>`sed -i' を MFC した後の 4.6-STABLE</td><td>460101</td></tr><tr><td>多くの新たな pkg_install の機能を HEAD から MFC
		した後の 4.6-STABLE</td><td>460102</td></tr><tr><td>4.7-RELEASE</td><td>470000</td></tr><tr><td>4.7-STABLE</td><td>470100</td></tr><tr><td>__sF の代わりに __std{in,out,err}p 参照生成を開始。
		これは、std{in,out,err} をコンパイル時の定数から、
		ランタイムに変更します。</td><td>470101</td></tr><tr><td>m_aux mbuf を m_tag で置き換える mbuf
		の変更を MFC した後の 4.7-STABLE</td><td>470102</td></tr><tr><td>OpenSSL 0.9.7 導入後の 4.7-STABLE</td><td>470103</td></tr><tr><td>4.8-RELEASE</td><td>480000</td></tr><tr><td>4.8-STABLE</td><td>480100</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=realpath&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">realpath</span>(3)</span></a> がスレッドセーフになった後の
		4.8-STABLE</td><td>480101</td></tr><tr><td>4.8-STABLE における twe の 3ware API の変更</td><td>480102</td></tr><tr><td>4.9-RELEASE</td><td>490000</td></tr><tr><td>4.9-STABLE</td><td>490100</td></tr><tr><td>構造体 kinfo_eproc に e_sid が追加された後の
		4.9-STABLE</td><td>490101</td></tr><tr><td>rtld に libmap 機能を MFC した後の
		4.9-STABLE</td><td>490102</td></tr><tr><td>4.10-RELEASE</td><td>491000</td></tr><tr><td>5.0-CURRENT</td><td>500000</td></tr><tr><td>ELF ヘッダフィールドの追加と ELF バイナリのマーク付け
		(branding) 方法の変更後の 5.0-CURRENT</td><td>500001</td></tr><tr><td>kld メタデータ変更後の 5.0-CURRENT</td><td>500002</td></tr><tr><td>buf/bio 変更後の 5.0-CURRENT</td><td>500003</td></tr><tr><td>binutils アップグレード後の 5.0-CURRENT</td><td>500004</td></tr><tr><td>libxpg4 コードの libc へのマージと、
		TASKQ インターフェイスの導入後の 5.0-CURRENT</td><td>500005</td></tr><tr><td>AGP インターフェイス追加後の 5.0-CURRENT</td><td>500006</td></tr><tr><td>Perl を 5.6.0 にアップグレードした後の
		5.0-CURRENT</td><td>500007</td></tr><tr><td>KAME コードを 2000/07 版のソースに更新した後の
		5.0-CURRENT</td><td>500008</td></tr><tr><td>ether_ifattach() および
		ether_ifdetach() 変更後の 5.0-CURRENT</td><td>500009</td></tr><tr><td>mtree のデフォルトをオリジナルの変種に戻し、
		シンボリックリンクをたどる -L オプションを追加した後の
		5.0-CURRENT</td><td>500010</td></tr><tr><td>kqueue API 変更後の 5.0-CURRENT</td><td>500011</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=setproctitle&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">setproctitle</span>(3)</span></a> が libutil から libc
		へ移動した後の 5.0-CURRENT</td><td>500012</td></tr><tr><td>最初の SMPng がコミットされた後の
		5.0-CURRENT</td><td>500013</td></tr><tr><td>&lt;sys/select.h&gt; が &lt;sys/selinfo.h&gt; に
		移動した後の 5.0-CURRENT</td><td>500014</td></tr><tr><td>libgcc.a と libgcc_r.a の結合および関連する
		GCC linkage 変更が行なわれた後の 5.0-CURRENT</td><td>500015</td></tr><tr><td>libc と libc_r の混合リンクを許し、
		-pthread オプションを deprecate する
		変更後の 5.0-CURRENT</td><td>500016</td></tr><tr><td>mountd 等が使用する kernel-exported API の
		安定化のため、ucred 構造体から xucred 構造体へ
		移行した後の 5.0-CURRENT</td><td>500017</td></tr><tr><td>CPU 依存の最適化を制御するための make 変数
		CPUTYPE が追加された後の 5.0-CURRENT</td><td>500018</td></tr><tr><td>&lt;machine/ioctl_fd.h&gt; が
		&lt;sys/fdcio.h&gt; に移動した後の 5.0-CURRENT</td><td>500019</td></tr><tr><td>ロケール名変更の後の 5.0-CURRENT</td><td>500020</td></tr><tr><td>Bzip2 導入後の 5.0-CURRENT。
		また、S/Key が削除されていることも示す。</td><td>500021</td></tr><tr><td>SSE サポート後の 5.0-CURRENT</td><td>500022</td></tr><tr><td>KSE マイルストーン 2 以降の 5.0-CURRENT</td><td>500023</td></tr><tr><td>d_thread_t 導入、および UUCP を ports
		に移動した後の 5.0-CURRENT</td><td>500024</td></tr><tr><td>64 ビットプラットホーム上のデスクリプタおよび
		cred 受け渡し ABI 変更後の 5.0-CURRENT</td><td>500025</td></tr><tr><td>package 作成のデフォルトを XFree86 4
		に移行し、libc に新たに strnstr() 関数を追加した後の
		5.0-CURRENT</td><td>500026</td></tr><tr><td>libc に新たに strcasestr() 関数を追加した後の
		5.0-CURRENT</td><td>500027</td></tr><tr><td>smbfs のユーザランド部が取り込まれた後の
		5.0-CURRENT</td><td>500028</td></tr><tr><td>C99 の新しい特定サイズの整数型追加後の
		5.0-CURRENT</td><td>500028 (変更なし)</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sendfile&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">sendfile</span>(2)</span></a> の戻り値が変更された後の
		5.0-CURRENT</td><td>500029</td></tr><tr><td>ファイルフラグにふさわしいサイズの
		<code class="literal">fflags_t</code> が導入された後の
		5.0-CURRENT</td><td>500030</td></tr><tr><td>usb の構成要素の名称が変更された後の 5.0-CURRENT</td><td>500031</td></tr><tr><td>Perl 5.6.1 導入後の 5.0-CURRENT</td><td>500032</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> の
		<code class="literal">sendmail_enable</code> 変数が
		<code class="literal">NONE</code> という値をとれるようになった後の
		5.0-CURRENT</td><td>500033</td></tr><tr><td>mtx_init() に 3 番目の引数が加わった後の
		5.0-CURRENT</td><td>500034</td></tr><tr><td>GCC 3.1 が取り込まれた 5.0-CURRENT</td><td>500035</td></tr><tr><td>/usr/src に Perl がなくなった 5.0-CURRENT</td><td>500036</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dlfunc&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">dlfunc</span>(3)</span></a> 追加後の 5.0-CURRENT</td><td>500037</td></tr><tr><td>構造体 sockbuf
		のメンバの型が一部変更され、順序が変更された後の
		5.0-CURRENT</td><td>500038</td></tr><tr><td>ヘッダで _BSD_FOO_T_ の使用をやめ、
		_FOO_T_DECLARED を使うようになった後の 5.0-CURRENT。
		また、この変数は <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bzip2&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">bzip2</span>(1)</span></a>
		パッケージに対応したことが確実な目安としても使えます。</td><td>500039</td></tr><tr><td>ディスクラベルの内部構造の依存性を除く名目で行われた、
		ディスク関連の機能へのさまざまな変更を加えた後の
		5.0-CURRENT</td><td>500040</td></tr><tr><td>libc に <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=getopt_long&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">getopt_long</span>(3)</span></a> を加えた後の
		5.0-CURRENT</td><td>500041</td></tr><tr><td>Binutils 2.13 にアップグレードした後の
		5.0-CURRENT。このアップグレードには、新たな FreeBSD
		の emulation, vec および出力形式が含まれている。
	      </td><td>500042</td></tr><tr><td>libc に pthread_XXX への弱いスタブを追加し、
		libXThrStub.so が obsolete になった後の 5.0-CURRENT。
		5.0-RELEASE</td><td>500043</td></tr><tr><td>RELENG_5_0 が分岐した後の 5.0-CURRENT</td><td>500100</td></tr><tr><td>&lt;sys/dkstat.h&gt; は空なので include
		すべきではない</td><td>500101</td></tr><tr><td>d_mmap_t インターフェイス変更後の
		5.0-CURRENT</td><td>500102</td></tr><tr><td>taskqueue_swi が Giant ロック無しで実行され、
		Giant ロックされて実行される taskqueue_swi_giant
		が追加された後の 5.0-CURRENT</td><td>500103</td></tr><tr><td>cdevsw_add() と cdevsw_remove()
		はもう存在しません。
		MAJOR_AUTO 割り当て機能が登場しました</td><td>500104</td></tr><tr><td>cdevsw の新たな初期化方法が導入された後の
		5.0-CURRENT</td><td>500105</td></tr><tr><td>devstat_add_entry() が devstat_new_entry()
		に置き換えられました</td><td>500106</td></tr><tr><td>Devstat のインターフェイス変更。
		sys/sys/param.h 1.149 を参照のこと</td><td>500107</td></tr><tr><td>トークンリングインターフェイスの変更</td><td>500108</td></tr><tr><td>vm_paddr_t の追加</td><td>500109</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=realpath&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">realpath</span>(3)</span></a> がスレッドセーフになった後の
		5.0-CURRENT</td><td>500110</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=usbhid&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">usbhid</span>(3)</span></a> が NetBSD と同期した後の
		5.0-CURRENT</td><td>500111</td></tr><tr><td>新たな NSS 実装と
		POSIX.1 準拠の getpw*_r, getgr*_r
		関数が導入後の 5.0-CURRENT</td><td>500112</td></tr><tr><td>古い rc システムを削除した後の 5.0-CURRENT</td><td>500113</td></tr><tr><td>5.1-RELEASE</td><td>501000</td></tr><tr><td>RELENG_5_1 が分岐した後の 5.1-CURRENT</td><td>501100</td></tr><tr><td>sigtimedwait(2) と sigwaitinfo(2)
		の動作を修正した後の 5.1-CURRENT</td><td>501101</td></tr><tr><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bus_dma_tag_create&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">bus_dma_tag_create</span>(9)</span></a> に
		lockfunc と lockfuncarg フィールドを追加した後の
		5.1-CURRENT</td><td>501102</td></tr><tr><td>GCC 3.3.1-pre 20030711 snapshot
		導入後の 5.1-CURRENT</td><td>501103</td></tr><tr><td>5.1-CURRENT における twe の 3ware API の変更</td><td>501104</td></tr><tr><td>/bin と /sbin がダイナミックリンクされ、
		ライブラリを /lib に移動した 5.1-CURRENT</td><td>501105</td></tr><tr><td>Coda 6.x のカーネルサポートを追加した後の
		5.1-CURRENT</td><td>501106</td></tr><tr><td>16550 UART 定数を
		<code class="filename">&lt;dev/sio/sioreg.h&gt;</code> から
		<code class="filename">&lt;dev/ic/ns16550.h&gt;</code>
		に移動した後の 5.1-CURRENT。
		また、rtld が 無条件で libmap 機能をサポートした時点。</td><td>501107</td></tr><tr><td>PFIL_HOOKS API を更新した後の 5.1-CURRENT</td><td>501108</td></tr><tr><td>kiconv(3) を追加した後の 5.1-CURRENT</td><td>501109</td></tr><tr><td>cdevsw の open および close
		のデフォルトの操作を変更した後の 5.1-CURRENT</td><td>501110</td></tr><tr><td>cdevsw のレイアウトを変更した後の 5.1-CURRENT</td><td>501111</td></tr><tr><td>kobj の多重継承を追加した後の 5.1-CURRENT</td><td>501112</td></tr><tr><td>構造体 ifnet の if_xname が変更された後の
		5.1-CURRENT</td><td>501113</td></tr><tr><td>/bin と /sbin をダイナミックリンクに変更した後の
		5.1-CURRENT</td><td>501114</td></tr><tr><td>5.2-RELEASE</td><td>502000</td></tr><tr><td>5.2.1-RELEASE</td><td>502010</td></tr><tr><td>RELENG_5_2 が分岐した後の 5.2-CURRENT</td><td>502100</td></tr><tr><td>__cxa_atexit/__cxa_finalize 関数が libc
		に追加された後の 5.2-CURRENT</td><td>502101</td></tr><tr><td>デフォルトの pthread ライブラリを
		libc_r から libpthread に変更した後の
		5.2-CURRENT</td><td>502102</td></tr><tr><td>デバイスドライバ API の大規模パッチをあてた後の
		5.2-CURRENT</td><td>502103</td></tr><tr><td>getopt_long_only() が追加された後の
		5.2-CURRENT</td><td>502104</td></tr><tr><td>C に対して NULL が ((void *)0)
		になり、warning をより多く出すようになった
		5.2-CURRENT</td><td>502105</td></tr><tr><td>pf がビルドおよびインストールされるようになった後の
		5.2-CURRENT</td><td>502106</td></tr><tr><td>sparc64 で time_t を 64 ビットの値に変更した後の
		5.2-CURRENT</td><td>502107</td></tr><tr><td>一部のヘッダで Intel C/C++ に対応し、
		execve(2) をより厳密に POSIX に適合させた後の
		5.2-CURRENT</td><td>502108</td></tr><tr><td>bus_alloc_resource_any API 導入後の
		5.2-CURRENT</td><td>502109</td></tr><tr><td>UTF-8 ロケール追加後の 5.2-CURRENT</td><td>502110</td></tr><tr><td>getvfsent(3) API を削除した後の 5.2-CURRENT</td><td>502111</td></tr><tr><td>make に .warning 命令を追加した後の
		5.2-CURRENT</td><td>502112</td></tr></tbody></table></div></div><br class="table-break" /><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">(2.2-STABLE は 2.2.5-RELESE 以後、
	  <span class="quote">「<span class="quote">2.2.5-STABLE</span>」</span> と呼ばれることがあります。)
	  見てのとおりこれは年・月というフォーマットになっていましたが、
	  バージョン 2.2 からより直接的にメジャー/マイナー番号を使うように変更になりました。
	  並行していくつかのブランチ (枝分かれしたバージョン)
	  を開発する場合には、
	  リリースされた日付でそれらのリリースを分類することが不可能だからです
	  (あなたが今 port
	  を作成するときに、古い -CURRENT 達について心配する必要はありません。
	  これは参考のために挙げられているに過ぎないからです)。</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-after-port-mk"></a>16.8. <code class="filename">bsd.port.mk</code> の後に書くこと</h2></div></div></div><p><code class="literal">.include &lt;bsd.port.mk&gt;</code>
	の行の後には何も書かないようにしてください。
	大抵の場合は
	<code class="filename">Makefile</code> の中程のどこかで
	<code class="filename">bsd.port.pre.mk</code> をインクルードして、
	最後に <code class="filename">bsd.port.pre.mk</code>
	をインクルードすることによって避けることができます。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="filename">bsd.port.pre.mk</code>/<code class="filename">bsd.port.post.mk</code>
	  のペアか <code class="filename">bsd.port.mk</code>
	  だけのどちらかだけをインクルードし、二つを混ぜないでください。</p></div><p>前者はいくつかの変数の定義だけをして
	<code class="filename">Makefile</code>
	でのテストに使用し、後者は残りを定義します。</p><p>以下は <code class="filename">bsd.port.pre.mk</code>
	で定義される重要な変数です
	(これは、すべてではありません。
	完全なリストは <code class="filename">bsd.port.mk</code> を参照してください)。
      </p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><thead><tr><th>変数名</th><th>解説</th></tr></thead><tbody><tr><td><code class="varname">ARCH</code></td><td><code class="command">uname -m</code>
		で返されるアーキテクチャ。(例、<code class="literal">i386</code>)。
	      </td></tr><tr><td><code class="varname">OPSYS</code></td><td><code class="command">uname -s</code>
		で返されるオペレーティングシステム
		(例、<code class="literal">FreeBSD</code>)。</td></tr><tr><td><code class="varname">OSREL</code></td><td>オペレーティングシステムのリリースバージョン
		(例、<code class="literal">2.1.5</code>,
		<code class="literal">2.2.7</code>)。</td></tr><tr><td><code class="varname">OSVERSION</code></td><td>数字形式のオペレーティングシステムのバージョン、
		上記の <a class="link" href="#freebsd-versions" title="16.7. __FreeBSD_version の値"><code class="literal">__FreeBSD_version</code></a>
		と同じです。</td></tr><tr><td><code class="varname">PORTOBJFORMAT</code></td><td>システムのオブジェクトフォーマット
		(<code class="literal">elf</code> あるいは <code class="literal">aout</code>
		ただし、<span class="quote">「<span class="quote">最近の</span>」</span> FreeBSD
		のバージョンでは <code class="literal">aout</code>
		は廃止予定になっています)。</td></tr><tr><td><code class="varname">LOCALBASE</code></td><td><span class="quote">「<span class="quote">local</span>」</span> ツリーのベース。
		(例、<code class="literal">/usr/local/</code>)。
	      </td></tr><tr><td><code class="varname">X11BASE</code></td><td><span class="quote">「<span class="quote">X11</span>」</span> ツリーのベース。
		(例、<code class="literal">/usr/X11R6/</code>)。
	      </td></tr><tr><td><code class="varname">PREFIX</code></td><td>ports のインストール先
		(<a class="link" href="#porting-prefix" title="14.2. PREFIX">
		  <code class="varname">PREFIX</code>について</a>を参照)。
	      </td></tr></tbody></table></div><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">USE_IMAKE</code>,
	  <code class="varname">USE_X_PREFIX</code> あるいは
	  <code class="varname">MASTERDIR</code>
	  などの変数を定義する必要がある場合には、
	  <code class="filename">bsd.port.pre.mk</code>
	  をインクルード前に定義してください。
	  他のものは <code class="filename">bsd.port.pre.mk</code>
	  の前でも後でもかまいません。</p></div><p>以下は <code class="filename">bsd.port.pre.mk</code>
	の後に書けるものの例です。</p><pre class="programlisting"># no need to compile lang/perl5 if perl5 is already in system
.if ${OSVERSION} &gt; 300003
BROKEN= perl is in system
.endif

# only one shlib version number for ELF
.if ${PORTOBJFORMAT} == "elf"
TCL_LIB_FILE=  ${TCL_LIB}.${SHLIB_MAJOR}
.else
TCL_LIB_FILE=  ${TCL_LIB}.${SHLIB_MAJOR}.${SHLIB_MINOR}
.endif

# software already makes link for ELF, but not for a.out
post-install:
.if ${PORTOBJFORMAT} == "aout"
       ${LN} -sf liblinpack.so.1.0 ${PREFIX}/lib/liblinpack.so
.endif</pre><p><code class="literal">BROKEN=</code> と
	<code class="literal">TCL_LIB_FILE=</code>
	の後にスペースではなくタブを使うことを覚えていましたか?
	:-)</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-documentation"></a>16.9. 付加的な文書のインストール</h2></div></div></div><p>普通のマニュアルや info
	ファイルの他にユーザにとって有用だと思えるような文書がある場合には、
	<code class="filename"> PREFIX/share/doc</code>
	の下にインストールしてください。
	これは前記と同様 <code class="buildtarget">post-install</code>
	ターゲットの中から行なうと良いでしょう。</p><p>まず、あなたの port のために新しいディレクトリを作ります。
	どの port の文書か簡単にわかるような名前にする必要がありますので、
	普通は <code class="varname">PORTNAME</code> を使うと良いでしょう。
	もちろん、ユーザが異なるバージョンのものを同時に使うことが予想される
	port の場合には
	<code class="varname">PKGNAME</code> をそのまま使っても構いません。</p><p>ユーザが <code class="filename">/etc/make.conf</code>
	でこの部分を禁止するために
	<code class="varname">NOPORTDOCS</code>
	という変数をセットしている場合には、
	これらの文書がインストールされないようにしてください。
	こんな具合です。</p><pre class="programlisting">post-install:
.if !defined(NOPORTDOCS)
        ${MKDIR} ${DOCSDIR}
        ${INSTALL_MAN} ${WRKSRC}/docs/xvdocs.ps ${DOCSDIR}
.endif</pre><p>ここでは、変数をいくつかと、それを
	  <code class="filename">Makefile</code>
	  で利用した時にどう展開されるかを説明します。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">${DATADIR}</code> は
	      <code class="filename">${PREFIX}/share/${PORTNAME}</code>
	      に展開されます。</p></li><li class="listitem"><p><code class="literal">${DOCSDIR}</code> は
	      <code class="filename">${PREFIX}/share/doc/${PORTNAME}</code>
	      に展開されます。</p></li><li class="listitem"><p><code class="literal">${EXAMPLESDIR}</code> は
	      <code class="filename">${PREFIX}/share/examples/${PORTNAME}</code>
	      に展開されます。</p></li></ul></div><p>文書ファイルおよびディレクトリはすべて
	  <code class="filename">pkg-plist</code> の中に
	  <code class="literal">%%PORTDOCS%%</code> を頭につけて書く必要があります。
	  たとえば、次のようにしてください。</p><pre class="programlisting">%%PORTDOCS%%%%DOCSDIR%%/AUTHORS
%%PORTDOCS%%%%DOCSDIR%%/CONTACT
%%PORTDOCS%%@dirrm %%DOCSDIR%%</pre><p>インストール時に <code class="filename">pkg-message</code>
	ファイルを利用してメッセージを表示することができます。詳細は
	<a class="link" href="#porting-message" title="13.1. pkg-message">pkg-message を使う</a>
	のセクションを参照してください。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="filename">pkg-message</code>
	  ファイルを <code class="filename">pkg-plist</code>
	  に加える必要はありません。</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-subdirs"></a>16.10. ディレクトリ構成</h2></div></div></div><p>インストール時には <code class="varname">PREFIX</code>
	の正しいサブディレクトリにファイルを置くように心がけてください。
	ソフトウェアによっては新しいディレクトリを一つ作って、
	ファイルを全部それに入れてしまうものがありますが、
	それは良くありません。
	また、バイナリ、ヘッダファイルとマニュアル以外のすべてを
	<code class="filename">lib</code> というディレクトリに入れてしまう
	port もありますが、これも
	BSD 的なファイルシステム構成とはうまく合いません。
	これは以下のように分散すべきです。
	<code class="filename">etc</code>
	にセットアップ/コンフィグレーションファイル、
	<code class="filename">libexec</code> に内部で使用されるプログラム
	(コマンドラインから呼ばれることのないコマンド)、
	<code class="filename">sbin</code> に管理者用のコマンド、
	<code class="filename">info</code> に GNU Info 用の文書、
	そして <code class="filename">share</code>
	にアーキテクチャに依存しないファイルが入ります。
	詳細については <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hier&amp;sektion=7"><span class="citerefentry"><span class="refentrytitle">hier</span>(7)</span></a> を参照してください。
	<code class="filename">/usr</code> の構成方針はほとんどそのまま
	<code class="filename">/usr/local</code> にもあてはまります。
	USENET <span class="quote">「<span class="quote">ニュース</span>」</span>を扱う ports は例外です。
	これらはファイルのインストール先として
	<code class="filename">PREFIX/news</code>
	を使用します。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="porting-cleaning"></a>16.11. 空のディレクトリの削除</h2></div></div></div><p>ports は削除の際に、
	自分自身を消去したあとに
	(ディレクトリの)
	削除をするようにしてください。
	これは大抵の場合 <code class="literal">@dirrm</code> の行を
	ports が作成するすべてのディレクトリについて加えることによって実現できます。
	親ディレクトリは子ディレクトリを先に消さないと消せないことに注意してください。</p><pre class="programlisting"> :
lib/X11/oneko/pixmaps/cat.xpm
lib/X11/oneko/sounds/cat.au
 :
@dirrm lib/X11/oneko/pixmaps
@dirrm lib/X11/oneko/sounds
@dirrm lib/X11/oneko</pre><p>といった感じです。</p><p>しかし時として、
	他の port とディレクトリを共有しているために
	<code class="literal">@dirrm</code> がエラーを返すことがあります。
	<code class="command">rmdir</code> を
	<code class="literal">@unexec</code>
	から呼びだすことによって、
	警告(warning)なしで空のディレクトリのみを削除することができます。
      </p><pre class="programlisting">@unexec rmdir %D/share/doc/gimp 2&gt;/dev/null || true</pre><p>これを使えば、たとえ他の
	port がファイルをインストールしていて
	<code class="filename">PREFIX/share/doc/gimp</code>
	が空でない場合でもエラーメッセージは表示されませんし、
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_delete</span>(1)</span></a>
	が異常終了することもありません。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-uid"></a>16.12. UID</h2></div></div></div><p>あなたの port が、
	インストールされるシステム上に特定のユーザを必要とする場合は
	<code class="filename">pkg-install</code> スクリプトから
	<code class="command">pw</code>
	コマンドを実行して自動的にそのユーザを追加するようにしてください。
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/cvsup-mirror/pkg-descr">net/cvsup-mirror</a>
	の port が参考になるでしょう。</p><p>あなたの port がバイナリの
	package としてインストールされる場合とコンパイルされる場合の両方で、
	同じユーザー/グループ ID を使わなければならないのなら、50 から
	999 の間で空いている UID を選んで登録してください。
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/japanese/Wnn6/pkg-descr">japanese/Wnn6</a> の port
	が参考になるでしょう。</p><p>既にシステムや他の port で利用されている
 	UID を使わないように十分注意してください。</p><p>現在の 50 から 999 までの間の UID は以下のとおりです。</p><pre class="programlisting">bind:*:53:53:Bind Sandbox:/:/sbin/nologin
majordom:*:54:54:Majordomo Pseudo User:/usr/local/majordomo:/nonexistent
cyrus:*:60:60:the cyrus mail server:/nonexistent:/nonexistent
gnats:*:61:1:GNATS database owner:/usr/local/share/gnats/gnats-db:/bin/sh
proxy:*:62:62:Packet Filter pseudo-user:/nonexistent:/nonexistent
uucp:*:66:66:UUCP pseudo-user:/var/spool/uucppublic:/usr/libexec/uucp/uucico
xten:*:67:67:X-10 daemon:/usr/local/xten:/nonexistent
pop:*:68:6:Post Office Owner (popper):/nonexistent:/sbin/nologin
wnn:*:69:7:Wnn:/nonexistent:/nonexistent
pgsql:*:70:70:PostgreSQL pseudo-user:/usr/local/pgsql:/bin/sh
oracle:*:71:71::0:0:Oracle:/usr/local/oracle7:/sbin/nologin
ircd:*:72:72:IRC daemon:/nonexistent:/nonexistent
ircservices:*:73:73:IRC services:/nonexistent:/nonexistent
ifmail:*:75:66:Ifmail user:/nonexistent:/nonexistent
www:*:80:80:World Wide Web Owner:/nonexistent:/sbin/nologin
alias:*:81:81:QMail user:/var/qmail/alias:/nonexistent
qmaild:*:82:81:QMail user:/var/qmail:/nonexistent
qmaill:*:83:81:QMail user:/var/qmail:/nonexistent
qmailp:*:84:81:QMail user:/var/qmail:/nonexistent
qmailq:*:85:82:QMail user:/var/qmail:/nonexistent
qmailr:*:86:82:QMail user:/var/qmail:/nonexistent
qmails:*:87:82:QMail user:/var/qmail:/nonexistent
mysql:*:88:88:MySQL Daemon:/var/db/mysql:/sbin/nologin
vpopmail:*:89:89:VPop Mail User:/usr/local/vpopmail:/nonexistent
firebird:*:90:90:Firebird Database Administrator:/usr/local/firebird:/bin/sh
mailman:*:91:91:Mailman User:/usr/local/mailman:/sbin/nologin
gdm:*:92:92:GDM Sandbox:/:/sbin/nologin
jabber:*:93:93:Jabber Daemon:/nonexistent:/nonexistent
p4admin:*:94:94:Perforce admin:/usr/local/perforce:/sbin/nologin
interch:*:95:95:Interchange user:/usr/local/interchange:/sbin/nologin
squeuer:*:96:96:SQueuer Owner:/nonexistent:/bin/sh
mud:*:97:97:MUD Owner:/usr/local/share/dgd:/bin/sh
msql:*:98:98:mSQL-2 pseudo-user:/var/db/msqldb:/bin/sh
rscsi:*:99:99:Remote SCSI:/usr/local/rscsi:/usr/local/sbin/rscsi
squid:*:100:100:squid caching-proxy pseudo user:/usr/local/squid:/sbin/nologin
quagga:*:101:101:Quagga route daemon pseudo user:/usr/local/etc/quagga:/sbin/nologin
ganglia:*:102:102:Ganglia User:/nonexistent:/sbin/nologin
sgeadmin:*:103:103:Sun Grid Engine Admin:/nonexistent:/sbin/nologin
slimserv:*:104:104:Slim Devices SlimServer pseudo-user:/nonexistent:/sbin/nologin
fido:*:111:111:Fido System:/usr/local/fido:/bin/sh
postfix:*:125:125:Postfix Mail System:/var/spool/postfix:/sbin/nologin
rbldns:*:153:153:rbldnsd pseudo-user:/nonexistent:/sbin/nologin
sfs:*:171:171:Self-Certifying File System:/nonexistent:/sbin/nologin
agk:*:172:172:AquaGateKeeper:/nonexistent:/nonexistent
ldap:*:389:389:OpenLDAP Server:/nonexistent:/sbin/nologin
drweb:*:426:426:Dr.Web Mail Scanner:/nonexistent:/sbin/nologin
qtss:*:554:554:Darwin Streaming Server:/nonexistent:/sbin/nologin
ircdru:*:555:555:Russian hybrid IRC server:/nonexistent:/bin/sh
bacula:*:910:910:Bacula Daemon:/var/db/bacula:/sbin/nologin</pre><p>以下は、現在予約されている GID の一覧です。</p><pre class="programlisting">bind:*:53:
cyrus:*:60:
proxy:*:62:
authpf:*:63:
uucp:*:66:
dialer:*:68:
network:*:69:
pgsql:*:70:
www:*:80:
qnofiles:*:81:
qmail:*:82:
mailman:*:91:
postfix:*:125:
maildrop:*:126:
rbldns:*:153:
qtss:*:554:
ircdru:*:555:</pre><p>このリストを最新の状態に保つためにも、
	この範囲の UID や GID を予約するような port を作ったり、
	既存の port にそのような改変を行なってわたしたちに送るときには
	UID の予約に関する注意書きをつけてください。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-rational"></a>16.13. 合理的な port</h2></div></div></div><p><code class="filename">Makefile</code>
	は単純かつ適切であるべきです。もし、
	<code class="filename">Makefile</code> を数行短かくできたり、
	もっと読みやすくできるのであればそうしてください。
	たとえば、
	シェルの <code class="literal">if</code> 構文を使うかわりに
	make の <code class="literal">.if</code> 構文を使う、
	<code class="varname">EXTRACT*</code> の再定義で代用できるのであれば
	<code class="buildtarget">do-extract</code> を再定義しない、
	<code class="literal">CONFIGURE_ARGS += --prefix=${PREFIX}</code>
	とするかわりに
	<code class="varname">GNU_CONFIGURE</code> とする、などです。</p><p>何かをするのに自分で新しくコードをたくさん書かなければならなくなった場合は、
	戻って <code class="filename">bsd.port.mk</code>
	であなたがやろうとしていることが既に実装されていないか見直してください。
	読むのは大変ですが、難しく見える問題で
	<code class="filename">bsd.port.mk</code>
	が簡単な解決法を提供しているものが数多くあります。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-cc"></a>16.14. <code class="varname">CC</code> および <code class="varname">CXX</code>
	  の尊重</h2></div></div></div><p>Port は <code class="varname">CC</code> および <code class="varname">CXX</code>
	  変数を尊重すべきです。ここで言いたいのは、port
	  は、既存の値を上書きしてこれらの変数をまるごと設定しなおすべきではなく、
	  その代わり必要な値を既存の値に追加してゆくべきだということです。
	  そうすれば、すべての ports
	  に影響するビルドオプションをグローバルに設定できます。</p><p>Port がこれらの変数を尊重しない場合は、
	  <code class="filename">Makefile</code>
	  に <code class="literal">NO_PACKAGE=ignores either cc or cxx</code>
	  を追加してください。</p><p><code class="varname">CC</code> と <code class="varname">CXX</code>
	  変数を尊重している <code class="filename">Makefile</code>
	  の例を次に示します。<code class="varname">?=</code> に注意してください。</p><pre class="programlisting">CC ?= gcc</pre><pre class="programlisting">CXX ?= g++</pre><p>こちらは、<code class="varname">CC</code> 変数も <code class="varname">CXX</code>
	  変数も尊重していない例です。</p><pre class="programlisting">CC = gcc</pre><pre class="programlisting">CXX = g++</pre><p>FreeBSD システム上では、<code class="varname">CC</code> および
	  <code class="varname">CFLAGS</code>
	  変数は、どちらも <code class="filename">/etc/make.conf</code>
	  で定義できます。最初の例では、システム全体の定義を保存している
	  <code class="filename">/etc/make.conf</code>
	  で値がすでに設定されてない場合に限って、値を設定します。
	  2 番目の例では、すでに設定されていた内容を上書きしてしまいます。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-cflags"></a>16.15. <code class="varname">CFLAGS</code> の尊重</h2></div></div></div><p><code class="varname">CFLAGS</code> 変数は尊重すべきです。
	ここでいいたいのは、port は、
	既存の値を上書きしてこの変数をまるごと設定しなおすべきではなく、
	その代わり必要な値を既存の値に追加してゆくべきだということです。
	そうすれば、すべてての ports
	に影響するビルドオプションをグローバルに設定できます。</p><p>port がこれを尊重しない場合は、
	<code class="literal">NO_PACKAGE=ignores cflags</code> を
	<code class="filename">Makefile</code> に加えてください。</p><p><code class="varname">CFLAGS</code> 変数をきちんと考慮した
	<code class="filename">Makefile</code> の例を以下に示します。
	<code class="varname">+=</code> の部分に注目してください。</p><pre class="programlisting">CFLAGS += -Wall -Werror</pre><p>次は <code class="varname">CFLAGS</code>
	変数を考慮しない <code class="filename">Makefile</code> の例です。</p><pre class="programlisting">CFLAGS = -Wall -Werror</pre><p><code class="varname">CFLAGS</code> 変数は、FreeBSD システムの
	<code class="filename">/etc/make.conf</code> で定義されています。
	最初の例では既存の定義を保存しつつ <code class="varname">CFLAGS</code>
	変数にオプションフラグを追加しているのに対し、
	二番目の例では既存の定義をすべて無効にしてしまっています。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-config"></a>16.16. コンフィグレーション (設定) ファイル</h2></div></div></div><p>もしあなたの port が設定ファイルを
	<code class="filename">PREFIX/etc</code>
	に置く必要がある場合には、それを単純にインストールしたり、
	<code class="filename">pkg-plist</code>
	に加えては<span class="emphasis"><em>いけません</em></span>。
	こうしてしまうと <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_delete</span>(1)</span></a>
	によってユーザが苦労して作ったファイルが消えてしまったり、
	新しくインストールする時に上書きされてしまったりします。</p><p>かわりに見本となるファイルをサフィックス
	(<code class="filename">filename.sample</code>
	が良いでしょう)
	を付けてインストールして<a class="link" href="#porting-message" title="13.1. pkg-message">メッセージ</a>を表示し、
	ソフトウェアを動かす前にユーザがそのファイルをコピーして編集をしなければならないことを知らせましょう。
      </p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-freedback"></a>16.17. フィードバック</h2></div></div></div><p>port を作るためにソフトウェアに変更を加えたら、
	なるべく原作者にその旨を伝えてパッチ等を送ってください。
	これらが次のリリースに取り入れられればアップグレードが楽になります。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-readme"></a>16.18. <code class="filename">README.html</code></h2></div></div></div><p><code class="filename">README.html</code>
	というファイルを含めてはいけません。
	このファイルは、cvs コレクションの一部ではなく、
	<code class="command">make readme</code>
	コマンドで生成されるファイルです。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-broken"></a>16.19. Port に <code class="varname">BROKEN</code>, <code class="varname">FORBIDDEN</code>
	などの印をつける</h2></div></div></div><p>ある port にセキュリティ脆弱性があることが判明したり、
	根本的に壊れてしまい修正に何時間もの注意深い作業が必要になったり、
	基本的には廃れてしまったものの、
	何らかの理由で ports ツリーには残される
	(もちろんあとで修正しますよね?)
	という日が来るのは避けられません。
	ある port が壊れていることを示すために、port の
	<code class="filename">Makefile</code> では 3 つの
	<code class="command">make</code> 変数が使えます。以下の
	<code class="command">make</code> 変数の値は、
	その port が壊れている理由を説明するためにユーザに示されます。
	それぞれの make 変数は、ユーザと <code class="filename">Makefile</code>
	を処理する自動化システムに対して根本的に異なる意味を伝えますので、
	正しい <code class="command">make</code> 変数をお使いください。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">BROKEN</code>
	      は、動作しないためインストールすべきでない port
	      用のものです。これは、ユーザがその port
	      をインストールしないようにしますが、
	      <code class="varname">BROKEN</code> とされた port
	      は <a class="link" href="http://bento.FreeBSD.org/" target="_top">Bento
	      クラスタ</a>で引き続きビルドされます。
	      ユーザには port をインストールしてほしくないけれども
	      Bento ではビルドしてほしい場合は、port
	      を <code class="varname">BROKEN</code> にしてください。</p></li><li class="listitem"><p><code class="varname">FORBIDDEN</code>
	      は、セキュリティ脆弱性があったり、その port
	      をインストールすると
	      FreeBSD システムの安全性に重大な懸念を生じる
	      (たとえば、セキュアでないという評判があるプログラムや、
	      容易に悪用できるサービスを提供するプログラムなど)
	      port 用のものです。
	      あるソフトウェアの一部に脆弱性があることが判明し、
	      修正がリリースされていない場合は
	      <code class="varname">FORBIDDEN</code> にすべきです。
	      理想的には、セキュリティ脆弱性が発見された時は、
	      脆弱性を抱えた FreeBSD ホストの数を減らすために、
	      ただちに ports を更新すべきです
	      (我々は、セキュアであるという評判を得たいのです)。
	      しかし、脆弱性が公表されてから、
	      脆弱性を抱えたソフトウェアの新しい版がリリースされるまでに無視できない時間があくことがままあります。
	      セキュリティ以外の理由で port を
	      <code class="varname">FORBIDDEN</code> にしないでください。</p></li><li class="listitem"><p><code class="varname">IGNORE</code>
	      は、どんな理由であれビルドすべきではない port 用です。
	      ユーザも <a class="link" href="http://bento.FreeBSD.org/" target="_top">Bento
	      クラスタ</a> も、どんな状況であれ
	      <code class="varname">IGNORE</code> とされた port はビルドしません。
	      嘘だと思うなら、port のビルドを妨げるのに
	      <code class="varname">IGNORE</code> を使ってみてください。</p></li></ul></div><p>この変数を使うのは、port
	  が更新できない場合の最後の手段にしてください。
	  ずっと壊れたままの port は、ports
	  ツリーから完全に削除すべきです。</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-workarounds"></a>16.20. 必要な回避策</h2></div></div></div><p>古いバージョンの FreeBSD
	のソフトウェアにあるバグを回避する必要があることがあります。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> は、少なくとも 4.8 と 5.0
	    を含むいくつかのバージョンで、<code class="varname">OSVERSION</code>
	    に基づく比較に関してバグがあります。
	    これは、<code class="command">make describe</code>
	    の最中にエラーを起こすことになりやすく
	    (したがって <code class="command">make index</code> 全体も失敗することに)
	    なります。回避策は、条件比較を括弧にいれることで、たとえば
	    </p><pre class="programlisting">if ( ${OSVERSION} &gt; 500023 )</pre><p>
	    となります。4.9 と 5.2 で port のインストールテストを行っても、
	    この問題は<span class="emphasis"><em>見つかりません</em></span>。</p></li></ul></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-misc"></a>16.21. その他諸々</h2></div></div></div><p>ファイル <code class="filename">pkg-descr</code> と
	<code class="filename">pkg-plist</code>
	はそれぞれ二重にチェックしてください。
	再検討してもっと良い記述があればそれに置きかえてください。</p><p>GNU General Public License
	(GNU一般公有使用許諾)
	のコピーは
	(すでにあるので)
	コピーしないでください。
	お願いします。</p><p>法律に関することには十分注意をはらってください。
	わたしたちに法律に反するような形でソフトウェアの配布をさせないでください!</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="dads-stuck"></a>16.22. 困ったら…</h2></div></div></div><p>わたしたちに質問を送る前に、
	既存の port の例と
	<code class="filename">bsd.port.mk</code> をちゃんと読んでください!
	<span class="emphasis"><em>;)</em></span></p><p>それでもわからないことがあったら一人で悩まないでどんどん質問してください!
	<span class="emphasis"><em>:-)</em></span></p></div></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-samplem"></a>第17章 <code class="filename">Makefile</code> のサンプル</h1></div></div></div><p>これは port の
      <code class="filename">Makefile</code> を作る際のお手本です。
      かぎかっこ ([]) 内のコメントは忘れずに取ってください。</p><p>変数の順番、段落の間の空行など、
      <code class="filename">Makefile</code>
      を作るときはなるべくこの形式に従ってください。
      この形式は重要な情報が簡単に見つけられるように設計されています。
      <a class="link" href="#porting-portlint" title="3.5. portlint によるチェック">portlint</a> を使って
      <code class="filename">Makefile</code> をチェックすることが推奨されています。</p><pre class="programlisting">[ヘッダ ... どのような port の Makefile かすぐにわかるようになっています]
# New ports collection makefile for:    xdvi
["version required" 行は、PORTVERSION 変数では port のバージョンを
十分に表現できない場合にのみ必要です。]
# Date created: 26 May 1995
[このソフトウェアを最初に FreeBSD に port した人の名前、つまり、
 この Makefile の最初の版を書いた人です。この port をアップグレー
 ドするとき、この行も変えないでください。]
# Whom:         Satoshi Asami &lt;asami@FreeBSD.org&gt;
#
# $FreeBSD$
[ ^^^^^^^^^ この部分は、CVS ツリーに入れる時に自動的に RCS の ID 文字列に
 置き換えられます。]
#

[port 自体、およびオリジナルのソースを取ってくるところを記述する部分。
 最初は必ず PORTNAME と PORTVERSION, そして必要なら PKGNAME,
 CATEGORIES, 続いて MASTER_SITES が置かれ、さらに MASTER_SITE_SUBDIR が
 置かれることもあります。必要なら PKGNAMEPREFIX と PKGNAMESUFFIX が
 それに続き、そして DISTNAME, EXTRACT_SUFX, DISTFILES が、
 また、その後に必要に応じて EXTRACT_ONLY が置かれます。]
PORTNAME=       xdvi
PORTVERSION=    18.2
CATEGORIES=     print
[MASTER_SITE_* マクロを使用しない場合は、
最後のスラッシュを忘れないように ("/")!]
MASTER_SITES= ${MASTER_SITE_XCONTRIB}
MASTER_SITE_SUBDIR= applications
DISTNAME=       xdvi-pl18
[ソースファイルが標準の ".tar.gz" 形式でない時にこれを使いましょう]
EXTRACT_SUFX=   .tar.Z

[配布パッチセクション -- ない場合もあります]
PATCH_SITES=    ftp://ftp.sra.co.jp/pub/X11/japanese/
PATCHFILES=     xdvi-18.patch1.gz xdvi-18.patch2.gz

[保守責任者 -- これは *必ず* 必要です。担当者 (あなた) 自身、あるいは
 担当者に素早く連絡をとれる人のアドレスを書いてください。どうしてもこ
 こに自分のアドレスを書くのがいやな人は "ports@FreeBSD.org" と書いて
 もいいです]
MAINTAINER=     asami@FreeBSD.org
COMMENT=       A DVI Previewer for the X Window System

[依存するport -- ない場合もあります]
RUN_DEPENDS=    gs:${PORTSDIR}/print/ghostscript
LIB_DEPENDS=    Xpm.5:${PORTSDIR}/graphics/xpm

[ここには標準の bsd.port.mk の変数で、上のどれにもあてはまらないものを
 書きます]
[コンフィグレーション、コンパイル、インストールなどの時に質問をする
 なら…]
IS_INTERACTIVE=yes
[${DISTNAME} 以外のディレクトリにソースが展開されるなら…]
WRKSRC= ${WRKDIR}/xdvi-new
[配布されているパッチが ${WRKSRC} に対する相対パスで作られてい
 い場合にこの変数の指定が必要かも…]
PATCH_DIST_STRIP=       -p1
[GNU autoconf によって生成された "configure" スクリプトを走らせたいなら…]
GNU_CONFIGURE=  yes
[/usr/bin/makeでなく、GNU make を使わないといけないなら…]
USE_GMAKE=      yes
[これが X のアプリケーションで、"xmkmf -a" を走らせたいなら…]
USE_IMAKE=      yes
[などなど]

[下の方のルールで使う非標準の変数]
MY_FAVORITE_RESPONSE=   "yeah, right"

[そして、特別なターゲット、使用順に]
pre-fetch:
        i go fetch something, yeah

post-patch:
        i need to do something after patch, great

pre-install:
        and then some more stuff before installing, wow

[最後には必ず]
.include &lt;bsd.port.mk&gt;</pre></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-autoplist"></a>第18章 パッキングリストの自動生成</h1></div></div></div><p>まず、あなたの port に
      <code class="filename">pkg-plist</code>
      がないことを除けば完成していることを確認してください。</p><p>次に、あなたの port
      をインストールする一時ディレクトリを作成して、
      依存するものをすべてインストールしてください。
      <em class="replaceable"><code>port-type</code></em> は
      X アプリケーションではない port については <code class="literal">local</code>、
      XFree86 4 またはそれより前の XFree86
      のディレクトリ階層にインストールする ports については、それぞれ
      <code class="literal">x11-4</code> または <code class="literal">x11</code>
      にすべきです。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/tmp/port-name</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mtree -U -f /etc/mtree/BSD.port-type.dist -d -e -p /var/tmp/port-name</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make depends PREFIX=/var/tmp/port-name</code></strong></pre><p>このディレクトリ構造を新しいファイルに保存してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>(cd /var/tmp/port-name &amp;&amp; find -d * -type d) | sort &gt; OLD-DIRS</code></strong></pre><p>空の <code class="filename">pkg-plist</code>
      ファイルを作成してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>touch pkg-plist</code></strong></pre><p>もしあなたの port が <code class="varname">PREFIX</code> にちゃんと従うなら、
      ここで port をインストールしてパッキングリストを作ることができます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make install PREFIX=/var/tmp</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>(cd /var/tmp/port-name &amp;&amp; find -d * \! -type d) | sort &gt; pkg-plist</code></strong></pre><p>新しく生成されたディレクトリはすべてパッキングリストに追加する必要があります。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>(cd /var/tmp/port-name &amp;&amp; find -d * -type d) | sort | comm -13 OLD-DIRS - | sort -r | sed -e 's#^#@dirrm #' &gt;&gt; pkg-plist</code></strong></pre><p>最後にパッキングリストを手で整える必要があります;
      <span class="emphasis"><em>すべて</em></span>が自動化されているわけではありません。
      マニュアルはパッキングリストに記述するのではなく、
      port の <code class="filename">Makefile</code> 中の
      <code class="varname">MAN<em class="replaceable"><code>n</code></em></code> に
      記述しなければなりません。
      ユーザ設定ファイルは削除するか
      <code class="filename">filename.sample</code>
      としてインストールされなければなりません。
      また <code class="filename">info/dir</code>
      ファイルはリストに含めず、
      <a class="link" href="#porting-info" title="第12章 Info ファイル">info ファイル</a>に記述されているように、
      適切な <code class="filename">install-info</code> 行に追加しなければなりません。
      port によってインストールされるライブラリは、
      <a class="link" href="#porting-shlibs" title="6.1. 共有ライブラリ">共有ライブラリ</a>
      のセクションで示したように記載されるべきです。</p><p>または、<code class="filename">/usr/ports/Tools/scripts/</code>
      にある <code class="command">plist</code>
      スクリプトを使ってパッキングリストを自動的に生成してください。</p></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="changes"></a>第19章 この文書と ports システムの変更</h1></div></div></div><p>もしあなたが、たくさんの ports の保守をしているのであれば、
      <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-ports" target="_top">FreeBSD ports メーリングリスト</a> の内容を読むことを考えてください。
      ports のしくみについての重要な変更点はここに アナウンスされます。
      最新の変更点については、いつでも、
      <a class="link" href="http://www.FreeBSD.org/cgi/cvsweb.cgi/ports/Mk/bsd.port.mk" target="_top">bsd.port.mk
      の CVS ログ</a>で詳細な情報を得ることができます。</p><p>port メンテナを補助するほかのリソースとして、
      <code class="literal">bento クラスタ</code>に置かれている
      <a class="link" href="http://bento.FreeBSD.org/" target="_top">
      パッケージビルド記録とエラー</a>一覧、また <a class="link" href="http://people.FreeBSD.org/~fenner/portsurvey/" target="_top">FreeBSD
      Ports distfiles 調査</a>があります。</p></div></div></body></html>