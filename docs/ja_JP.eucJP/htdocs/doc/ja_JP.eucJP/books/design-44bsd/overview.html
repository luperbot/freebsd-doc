<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>第2章 4.4BSD の設計の概要</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="4.4BSD オペレーティングシステムの設計と実装" /><link rel="up" href="index.html" title="4.4BSD オペレーティングシステムの設計と実装" /><link rel="prev" href="index.html" title="4.4BSD オペレーティングシステムの設計と実装" /><link rel="next" href="overview-kernel-organization.html" title="2.2. カーネルの構成" /><link rel="copyright" href="legalnotice.html" title="法律上の通知" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第2章 4.4BSD の設計の概要</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="index.html">戻る</a>〓</td><th width="60%" align="center">〓</th><td width="20%" align="right">〓<a accesskey="n" href="overview-kernel-organization.html">次へ</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="overview"></a>第2章 4.4BSD の設計の概要</h1></div></div></div><div class="toc"><div class="toc-title">目次</div><dl class="toc"><dt><span class="sect1"><a href="overview.html#overview-facilities">2.1. 4.4BSD の機能とカーネル</a></span></dt><dt><span class="sect1"><a href="overview-kernel-organization.html">2.2. カーネルの構成</a></span></dt><dt><span class="sect1"><a href="overview-kernel-service.html">2.3. カーネル サービス</a></span></dt><dt><span class="sect1"><a href="overview-process-management.html">2.4. プロセス管理</a></span></dt><dt><span class="sect1"><a href="overview-memory-management.html">2.5. メモリ管理</a></span></dt><dt><span class="sect1"><a href="overview-io-system.html">2.6. I/O システム</a></span></dt><dt><span class="sect1"><a href="overview-filesystem.html">2.7. ファイルシステム</a></span></dt><dt><span class="sect1"><a href="overview-filestore.html">2.8. ファイル記録機構</a></span></dt><dt><span class="sect1"><a href="overview-nfs.html">2.9. ネットワークファイルシステム</a></span></dt><dt><span class="sect1"><a href="overview-terminal.html">2.10. 端末</a></span></dt><dt><span class="sect1"><a href="overview-ipc.html">2.11. プロセス間通信 (IPC)</a></span></dt><dt><span class="sect1"><a href="overview-network-communication.html">2.12. ネットワーク通信</a></span></dt><dt><span class="sect1"><a href="overview-network-implementation.html">2.13. ネットワーク実装</a></span></dt><dt><span class="sect1"><a href="overview-operation.html">2.14. システム運用</a></span></dt><dt><span class="bibliography"><a href="overview.html#references">参考文献</a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="overview-facilities"></a>2.1. 4.4BSD の機能とカーネル</h2></div></div></div><p>4.4BSD カーネルは 4 つの基本機能を提供します。
	それはプロセス、ファイルシステム、コミュニケーション、そしてシステムの起動です。
	この節ではその 4 つの基本サービスのそれぞれについて
	この本で書かれていることを紹介します。</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>プロセスはアドレス空間上でのコントロールの流れを構成します。
	    生成や終了やその他のプロセスをコントロールするための仕組みは
	    4 章に述べます。システムは各プロセスの個別の仮想アドレス空間を
	    多重化します。このメモリ管理については 5 章で議論します。</p></li><li class="listitem"><p>ファイルシステムとデバイスへのユーザインタフェースは似ているため、
	    6 章ではそれらに共通する特徴について議論します。
	    7 章で説明するファイルシステムは、
            ディレクトリが木構造になった階層で組織された名前付きのファイルと、
            それらを扱うための操作からなります。
	    ファイルはディスクのような物理的なメディア上に存在します。
	    4.4BSD はディスク上のデータ配置法をいくつかサポートしており、
	    それは 8 章の中で述べます。
	    遠隔マシン上のファイルへのアクセスについては 9 章、
	    システムにアクセスするために使われている端末とその動作については
            10 章で扱います。</p></li><li class="listitem"><p>UNIX で古くから提供されている通信機構には、
	    関連するプロセス間における単純で信頼性の高いバイトストリーム
            (11.1 節パイプを参照)および、
            例外イベントの通知 (4.7 節シグナルを参照)があります。
	    また、4.4BSD は汎用のプロセス間通信機構も備えています。
	    11 章に述べるこの通信機構は、
            ファイルシステムのものとは異なるアクセス機構を使用していますが、
            一度接続が確立されれば、
            プロセスからはパイプと同じようにアクセスすることができます。
	    12 章では汎用のネットワーク通信フレームワークについて扱っています。
	    これは通常、IPC 機構の下位レイヤとして使われているものです。
	    13 章では、ある特定のネットワークの実装について詳細に述べます。</p></li><li class="listitem"><p>いかなる実際のオペレーティングシステムにも、
	    どのように起動するかというような運用上の話題があります。
	    14 章では起動時や運用上の話題について述べます。</p></li></ol></div><p>2.3 節から 2.14 節は 3 章から 14 章の内容を紹介するものです。
	わたしたちは用語を定義し、基本的なシステムコールについて扱い、
	開発の歴史について解説していきます。
	そして最後に、中心となっている数多くの設計が、
        どうやって選ばれたのかという理由を示します。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp76243152"></a>2.1.1. カーネル</h3></div></div></div><p><span class="emphasis"><em>カーネル</em></span> はプロテクトモードで動作し、
	  すべてのユーザプログラムが基本的なハードウェア
	  (たとえば CPU、ディスク、端末、ネットワーク接続機器) および
	  ソフトウェアを構成するもの (たとえばファイルシステム、
	  ネットワークプロトコル) へのアクセスを解決します。
	  カーネルは基礎的なシステムの機能を提供します。
	  それはプロセスを生成して管理を行い、ファイルシステムへのアクセス機能や
	  コミュニケーション機能を提供します。
	  <span class="emphasis"><em>システムコール</em></span> と呼ばれるこれらの機能は
	  ライブラリのサブルーチンとしてユーザプロセスに現れます。
	  これらのシステムコールはプロセスがこれらの機能に対して持っている
	  唯一のインタフェースです。
	  システムコール機構の詳細は、
          システムコールを実行することで実現されているもの以外の、
          いくつかのカーネル内機構を説明した 3 章で扱います。</p><p>従来のオペレーティングシステムの用語における
	  <span class="emphasis"><em>カーネル</em></span> とは、
	  オペレーティングシステムにサービスを追加する実装を行うために必要な
	  最小限の仕組みだけを提供する、
          ソフトウェアの小さな核となる部分のことです。
	  同時代のオペレーティングシステムの研究、たとえば
	  Chorus
	  <a class="xref" href="overview.html#biblio-rozier">[<abbr class="abbrev">Rozier et al, 1988</abbr>]</a>,
	  Mach
	  <a class="xref" href="overview.html#biblio-accetta">[<abbr class="abbrev">Accetta et al, 1986</abbr>]</a>,
	  Tunis
	  <a class="xref" href="overview.html#biblio-ewens">[<abbr class="abbrev">Ewens et al, 1985</abbr>]</a>,
	  V Kernel
	  <a class="xref" href="overview.html#biblio-cheriton">[<abbr class="abbrev">Cheriton, 1988</abbr>]</a> では、
	  このカーネルという機能による区分が、さらに論理的に複数に分けられています。
	  ファイルシステムやネットワークプロトコルといったサービスは、
	  その核もしくはカーネルに対するクライアントアプリケーションプロセスとして
	  実装されています。</p><p>4.4BSD カーネルは複数のプロセスには分割されていません。
	  この基本設計の決定は UNIX の最初のバージョンで行われました。
	  Ken Thompson によって行われた初めの 2 つの実装では
	  メモリマッピングがなく、
	  ユーザおよびカーネル空間はハードウェアによる分離が行なわれていませんでした
	  <a class="xref" href="overview.html#biblio-ritchie">[<abbr class="abbrev">Ritchie, 1988</abbr>]</a>。
	  メッセージ伝達システムは、
          実際に実装されたカーネルとユーザプロセスのモデルと
          同じくらい容易に実装することが可能でした。
	  単純化と性能のためにモノリシックカーネルが選ばれました。
	  また、初期のカーネルは非常に小さいものでしたが、
	  ネットワークのような機能が追加されることで
	  次第に大きくなっていきました。
	  現在のオペレーティングシステムの研究の最先端では
	  そのようなサービスをユーザ空間に置くことで
	  カーネルの大きさを減らそうとする傾向にあります。</p><p>ユーザは通常、
          <span class="emphasis"><em>シェル</em></span>と呼ばれる
	  コマンド言語インタプリタや、
	  追加されたユーザアプリケーションプログラムを通してシステムと対話します。
	  そのようなプログラムやシェルは、プロセスを使って実装されています。
	  それらのプログラムの詳細についてはこの本の範囲を超えますので、
	  ここではカーネルについてのみ、考えることにします。</p><p>2.3 節、2.4 節では
	  4.4BSD カーネルによって提供されるサービスや最近の設計の概要について扱います。
	  そして後の章では、
          4.4BSD に現れるそれらのサービスの設計と実装の詳細を説明します。</p></div></div><div class="bibliography"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="references"></a>参考文献</h2></div></div></div><div class="biblioentry"><a id="biblio-accetta"></a><p>[<abbr class="abbrev">Accetta et al, 1986</abbr>] <span class="biblioset">「Mach: A New Kernel Foundation for UNIX Development"」. <span class="authorgroup"><span class="surname">Accetta</span> <span class="firstname">M.</span> [FAMILY Given], <span class="surname">Baron</span> <span class="firstname">R.</span> [FAMILY Given], <span class="surname">Bolosky</span> <span class="firstname">W.</span> [FAMILY Given], <span class="surname">Golub</span> <span class="firstname">D.</span> [FAMILY Given], <span class="surname">Rashid</span> <span class="firstname">R.</span> [FAMILY Given], <span class="surname">Tevanian</span> <span class="firstname">A.</span> [FAMILY Given], 、 <span class="surname">Young</span> <span class="firstname">M.</span> [FAMILY Given]. </span><span class="pagenums">93-113. </span></span><span class="biblioset"><em>USENIX Association Conference Proceedings</em>. <span class="publishername">USENIX Association. </span><span class="pubdate">June 1986. </span></span></p></div><div class="biblioentry"><a id="biblio-cheriton"></a><p>[<abbr class="abbrev">Cheriton, 1988</abbr>] <span class="biblioset">「The V Distributed System」. <span class="author"><span class="surname">Cheriton</span> <span class="firstname">D. R.</span> [FAMILY Given]. </span><span class="pagenums">314-333. </span></span><span class="biblioset"><em>Comm ACM, 31, 3</em>. <span class="pubdate">March 1988. </span></span></p></div><div class="biblioentry"><a id="biblio-ewens"></a><p>[<abbr class="abbrev">Ewens et al, 1985</abbr>] <span class="biblioset">「Tunis: A Distributed Multiprocessor Operating System」. <span class="authorgroup"><span class="surname">Ewens</span> <span class="firstname">P.</span> [FAMILY Given], <span class="surname">Blythe</span> <span class="firstname">D. R.</span> [FAMILY Given], <span class="surname">Funkenhauser</span> <span class="firstname">M.</span> [FAMILY Given], 、 <span class="surname">Holt</span> <span class="firstname">R. C.</span> [FAMILY Given]. </span><span class="pagenums">247-254. </span></span><span class="biblioset"><em>USENIX Assocation Conference Proceedings</em>. <span class="publishername">USENIX Association. </span><span class="pubdate">June 1985. </span></span></p></div><div class="biblioentry"><a id="biblio-gingell"></a><p>[<abbr class="abbrev">Gingell et al, 1987</abbr>] <span class="biblioset">「Virtual Memory Architecture in SunOS」. <span class="authorgroup"><span class="surname">Gingell</span> <span class="firstname">R.</span> [FAMILY Given], <span class="surname">Moran</span> <span class="firstname">J.</span> [FAMILY Given], 、 <span class="surname">Shannon</span> <span class="firstname">W.</span> [FAMILY Given]. </span><span class="pagenums">81-94. </span></span><span class="biblioset"><em>USENIX Association Conference Proceedings</em>. <span class="publishername">USENIX Association. </span><span class="pubdate">June 1987. </span></span></p></div><div class="biblioentry"><a id="biblio-kernighan"></a><p>[<abbr class="abbrev">Kernighan &amp; Pike, 1984</abbr>] <span class="citetitle"><em class="citetitle">The UNIX Programming Environment</em>. </span><span class="authorgroup"><span class="surname">Kernighan</span> <span class="firstname">B. W.</span> [FAMILY Given] 、 <span class="surname">Pike</span> <span class="firstname">R.</span> [FAMILY Given]. </span><span class="publisher"><span class="publishername">Prentice-Hall. </span><span class="address">
            <span class="city">Englewood Cliffs</span>
            <span class="state">NJ</span>
          . </span></span><span class="pubdate">1984. </span></p></div><div class="biblioentry"><a id="biblio-macklem"></a><p>[<abbr class="abbrev">Macklem, 1994</abbr>] <span class="biblioset"><em>The 4.4BSD NFS Implementation</em>. <span class="author"><span class="surname">Macklem</span> <span class="firstname">R.</span> [FAMILY Given]. </span><span class="pagenums">6:1-14. </span></span><span class="biblioset"><em>4.4BSD System Manager's Manual</em>. <span class="publisher"><span class="publishername">O'Reilly &amp; Associates, Inc.. </span><span class="address">
              <span class="city">Sebastopol</span>
              <span class="state">CA</span>
            . </span></span><span class="pubdate">1994. </span></span></p></div><div class="biblioentry"><a id="biblio-mckusick-2"></a><p>[<abbr class="abbrev">McKusick &amp; Karels, 1988</abbr>] <span class="biblioset">「Design of a General Purpose Memory Allocator for the 4.3BSD
            UNIX Kernel」. <span class="authorgroup"><span class="surname">McKusick</span> <span class="firstname">M. K.</span> [FAMILY Given] 、 <span class="surname">Karels</span> <span class="firstname">M. J.</span> [FAMILY Given]. </span><span class="pagenums">295-304. </span></span><span class="biblioset"><em>USENIX Assocation Conference Proceedings</em>. <span class="publishername">USENIX Assocation. </span><span class="pubdate">June 1998. </span></span></p></div><div class="biblioentry"><a id="biblio-mckusick-1"></a><p>[<abbr class="abbrev">McKusick et al, 1994</abbr>] <span class="biblioset"><em>Berkeley Software Architecture Manual, 4.4BSD Edition</em>. <span class="authorgroup"><span class="surname">McKusick</span> <span class="firstname">M. K.</span> [FAMILY Given], <span class="surname">Karels</span> <span class="firstname">M. J.</span> [FAMILY Given], <span class="surname">Leffler</span> <span class="firstname">S. J.</span> [FAMILY Given], <span class="surname">Joy</span> <span class="firstname">W. N.</span> [FAMILY Given], 、 <span class="surname">Faber</span> <span class="firstname">R. S.</span> [FAMILY Given]. </span><span class="pagenums">5:1-42. </span></span><span class="biblioset"><em>4.4BSD Programmer's Supplementary Documents</em>. <span class="publisher"><span class="publishername">O'Reilly &amp; Associates, Inc.. </span><span class="address">
              <span class="city">Sebastopol</span>
              <span class="state">CA</span>
            . </span></span><span class="pubdate">1994. </span></span></p></div><div class="biblioentry"><a id="biblio-ritchie"></a><p>[<abbr class="abbrev">Ritchie, 1988</abbr>] <span class="citetitle"><em class="citetitle">Early Kernel Design</em>. </span><span class="subtitle">private communication. </span><span class="author"><span class="surname">Ritchie</span> <span class="firstname">D. M.</span> [FAMILY Given]. </span><span class="pubdate">March 1988. </span></p></div><div class="biblioentry"><a id="biblio-rosenblum"></a><p>[<abbr class="abbrev">Rosenblum &amp; Ousterhout, 1992</abbr>] <span class="biblioset">「The Design and Implementation of a Log-Structured File
            System」. <span class="authorgroup"><span class="surname">Rosenblum</span> <span class="firstname">M.</span> [FAMILY Given] 、 <span class="surname">Ousterhout</span> <span class="firstname">K.</span> [FAMILY Given]. </span><span class="pagenums">26-52. </span></span><span class="biblioset"><em>ACM Transactions on Computer Systems, 10, 1</em>. <span class="publishername">Association for Computing Machinery. </span><span class="pubdate">February 1992. </span></span></p></div><div class="biblioentry"><a id="biblio-rozier"></a><p>[<abbr class="abbrev">Rozier et al, 1988</abbr>] <span class="biblioset">「Chorus Distributed Operating Systems」. <span class="authorgroup"><span class="surname">Rozier</span> <span class="firstname">M.</span> [FAMILY Given], <span class="surname">Abrossimov</span> <span class="firstname">V.</span> [FAMILY Given], <span class="surname">Armand</span> <span class="firstname">F.</span> [FAMILY Given], <span class="surname">Boule</span> <span class="firstname">I.</span> [FAMILY Given], <span class="surname">Gien</span> <span class="firstname">M.</span> [FAMILY Given], <span class="surname">Guillemont</span> <span class="firstname">M.</span> [FAMILY Given], <span class="surname">Herrmann</span> <span class="firstname">F.</span> [FAMILY Given], <span class="surname">Kaiser</span> <span class="firstname">C.</span> [FAMILY Given], <span class="surname">Langlois</span> <span class="firstname">S.</span> [FAMILY Given], <span class="surname">Leonard</span> <span class="firstname">P.</span> [FAMILY Given], 、 <span class="surname">Neuhauser</span> <span class="firstname">W.</span> [FAMILY Given]. </span><span class="pagenums">305-370. </span></span><span class="biblioset"><em>USENIX Computing Systems, 1, 4</em>. <span class="pubdate">Fall 1988. </span></span></p></div><div class="biblioentry"><a id="biblio-tevanian"></a><p>[<abbr class="abbrev">Tevanian, 1987</abbr>] <span class="citetitle"><em class="citetitle">Architecture-Independent Virtual Memory Management for Parallel
          and Distributed Environments: The Mach Approach</em>. </span><span class="subtitle">Technical Report CMU-CS-88-106,. </span><span class="author"><span class="surname">Tevanian</span> <span class="firstname">A.</span> [FAMILY Given]. </span><span class="publisher"><span class="publishername">Department of Computer Science, Carnegie-Mellon
            University. </span><span class="address">
            <span class="city">Pittsburgh</span>
            <span class="state">PA</span>
          . </span></span><span class="pubdate">December 1987. </span></p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="index.html">戻る</a>〓</td><td width="20%" align="center">〓</td><td width="40%" align="right">〓<a accesskey="n" href="overview-kernel-organization.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">4.4BSD オペレーティングシステムの設計と実装〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓2.2. カーネルの構成</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>