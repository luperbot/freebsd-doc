<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>2.2. カーネルの構成</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="4.4BSD オペレーティングシステムの設計と実装" /><link rel="up" href="overview.html" title="第2章 4.4BSD の設計の概要" /><link rel="prev" href="overview.html" title="第2章 4.4BSD の設計の概要" /><link rel="next" href="overview-kernel-service.html" title="2.3. カーネル サービス" /><link rel="copyright" href="legalnotice.html" title="法律上の通知" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2.2. カーネルの構成</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="overview.html">戻る</a>〓</td><th width="60%" align="center">第2章 4.4BSD の設計の概要</th><td width="20%" align="right">〓<a accesskey="n" href="overview-kernel-service.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="overview-kernel-organization"></a>2.2. カーネルの構成</h2></div></div></div><p>この節では、2 つの側面から 4.4BSD
        カーネルの構成を見ていきます。</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>ソフトウェアの静的側面、つまりカーネルを構築するためのモジュール
	    によって提供された機能性による分類</p></li><li class="listitem"><p>その動的な機能、つまりユーザに提供されるサービスによる分類</p></li></ol></div><p>カーネルの大部分は、システムコールを通してアプリケーションが
        アクセスするためのシステムサービスを実装しています。
	4.4BSD では、このソフトウェアは次のような構成になっています。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>基礎的なカーネル機能:
	    タイマーおよびシステム時計の取り扱い、
	    記述子管理、そしてプロセス管理</p></li><li class="listitem"><p>メモリ管理のサポート:
	    ページングとスワッピング</p></li><li class="listitem"><p>汎用のシステムインタフェース:
	    I/O、コントロール、
            記述子によって実現される多重化操作</p></li><li class="listitem"><p>ファイルシステム:
	    ファイル、ディレクトリ、パス名の解釈、ファイルロック、
	    I/O バッファ管理</p></li><li class="listitem"><p>端末の取り扱いのサポート:
	    端末のインタフェースドライバと
            ラインディシプリン</p></li><li class="listitem"><p>プロセス間通信機能:
            ソケット</p></li><li class="listitem"><p>ネットワーク通信への対応:
	    経路制御等の通信プロトコル、一般的なネットワーク機能</p></li></ul></div><div class="table"><a id="table-mach-indep"></a><div class="table-title">表2.1 4.4BSD カーネルにおける機種非依存なソフトウェア</div><div class="table-contents"><table summary="4.4BSD カーネルにおける機種非依存なソフトウェア" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>分類</th><th>コード行数</th><th>カーネル内での割合</th></tr></thead><tfoot><tr><th>機種非依存部分の総計</th><th>162,617</th><th>80.4</th></tr></tfoot><tbody><tr><td>ヘッダ</td><td>9,393</td><td>4.6</td></tr><tr><td>初期化部分</td><td>1,107</td><td>0.6</td></tr><tr><td>カーネルの機能</td><td>8,793</td><td>4.4</td></tr><tr><td>汎用のインタフェース</td><td>4,782</td><td>2.4</td></tr><tr><td>プロセス間通信</td><td>4,540</td><td>2.2</td></tr><tr><td>端末の取り扱い</td><td>3,911</td><td>1.9</td></tr><tr><td>仮想メモリ</td><td>11,813</td><td>5.8</td></tr><tr><td>vnode 管理</td><td>7,954</td><td>3.9</td></tr><tr><td>ファイルシステムネーミング</td><td>6,550</td><td>3.2</td></tr><tr><td>FFS</td><td>4,365</td><td>2.2</td></tr><tr><td>ログ構造化ファイルシステム</td><td>4,337</td><td>2.1</td></tr><tr><td>メモリベースのファイルシステム</td><td>645</td><td>0.3</td></tr><tr><td>cd9660 ファイルシステム</td><td>4,177</td><td>2.1</td></tr><tr><td>その他のファイルシステム (10)</td><td>12,695</td><td>6.3</td></tr><tr><td>ネットワークファイルシステム</td><td>17,199</td><td>8.5</td></tr><tr><td>ネットワーク通信</td><td>8,630</td><td>4.3</td></tr><tr><td>インターネットプロトコル</td><td>11,984</td><td>5.9</td></tr><tr><td>ISO プロトコル</td><td>23,924</td><td>11.8</td></tr><tr><td>X.25 プロトコル</td><td>10,626</td><td>5.3</td></tr><tr><td>XNS プロトコル</td><td>5,192</td><td>2.6</td></tr></tbody></table></div></div><br class="table-break" /><p>これらのカテゴリのソフトウェアのほとんどは機種非依存であり、しかも
	異なるハードウェアアーキテクチャに移植できるものです。</p><p>カーネルの機種依存部分は本流のコードから分離されています。
	特に、機種依存しているコードのどれを取っても、
	特定のアーキテクチャのためのコードを含んでいません。
	機種に依存する機能が必要なときには、機種に依存しないコードは
	機種依存のコード内にあるアーキテクチャ依存の関数を呼び出します。
	機種依存であるソフトウェアは次のものを含んでいます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>低レベルなシステム起動のための動作</p></li><li class="listitem"><p>トラップおよびフォールトの扱い</p></li><li class="listitem"><p>プロセスの動作状態に関する低レベルな操作</p></li><li class="listitem"><p>ハードウェアデバイスの設定と初期化</p></li><li class="listitem"><p>I/O デバイスのランタイムサポート</p></li></ul></div><div class="table"><a id="table-mach-dep"></a><div class="table-title">表2.2 4.4BSD カーネル内にある HP300 用の機種依存部分</div><div class="table-contents"><table summary="4.4BSD カーネル内にある HP300 用の機種依存部分" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>分類</th><th>コード行数</th><th>カーネル内での割合</th></tr></thead><tfoot><tr><th>機種依存部分の総計</th><th>39,634</th><th>19.6</th></tr></tfoot><tbody><tr><td>機種依存部分のヘッダ</td><td>1,562</td><td>0.8</td></tr><tr><td>デバイスドライバのヘッダ</td><td>3,495</td><td>1.7</td></tr><tr><td>デバイスドライバのソースコード</td><td>17,506</td><td>8.7</td></tr><tr><td>仮想メモリ</td><td>3,087</td><td>1.5</td></tr><tr><td>他の機種依存部分</td><td>6,287</td><td>3.1</td></tr><tr><td>アセンブリ言語で書かれたルーチン</td><td>3,014</td><td>1.5</td></tr><tr><td>HP/UX 互換機能</td><td>4,683</td><td>2.3</td></tr></tbody></table></div></div><br class="table-break" /><p><a class="xref" href="overview-kernel-organization.html#table-mach-indep" title="表2.1 4.4BSD カーネルにおける機種非依存なソフトウェア">表2.1「4.4BSD カーネルにおける機種非依存なソフトウェア」</a> は
        HP300 用 4.4BSD カーネルを構成するソフトウェアのうち、
        機種非依存の部分をまとめたものです。
        2 列目の数値は C 言語のソースコード、ヘッダファイル、そして
	アセンブリ言語のものを表しており、
        アセンブリ言語のものは 2% 以下しかありません。
	また、<a class="xref" href="overview-kernel-organization.html#table-mach-dep" title="表2.2 4.4BSD カーネル内にある HP300 用の機種依存部分">表2.2「4.4BSD カーネル内にある HP300 用の機種依存部分」</a> の統計が示しているように、
	機種依存のソフトウェアは、HP/UX やデバイスサポートを除いて、
	カーネルのうちわずかに 6.9% しかありません。</p><p>カーネルのごく小さな部分だけがシステムの初期化に専念します。
	このコードはシステムが <span class="emphasis"><em>起動する</em></span> ときに用いられ、
	カーネルがハードウェアやソフトウェアの環境構築をするための基本部分と
	なります (14 章参照)。
	(制限された物理メモリを持つものには特に) オペレーティングシステムの中には
	これらの機能が実行された後にそのソフトウェアを廃棄してしまうか、
	<span class="emphasis"><em>上から覆ってしまう</em></span> ものもあります。
	4.4BSD カーネルは、起動するために要したコードのためのメモリを再利用しません。
	それは通常の機種ではカーネルのリソースのうち 0.5% に過ぎないからです。
	そして、起動のためのコードはカーネルの中の一部分に固まってはいません。
	それは全体にわたって散在しており、初期化されたときに論理的に関連していた
	場所に存在します。</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="overview.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="overview.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="overview-kernel-service.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第2章 4.4BSD の設計の概要〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓2.3. カーネル サービス</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>