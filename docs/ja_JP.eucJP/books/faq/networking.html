<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>第9章 ネットワーキング</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 2.X、3.X、4.X についての FAQ (よくある質問とその答え)" /><link rel="up" href="index.html" title="FreeBSD 2.X、3.X、4.X についての FAQ (よくある質問とその答え)" /><link rel="prev" href="x.html" title="第8章 X Window System と仮想コンソール" /><link rel="next" href="ppp.html" title="第10章 PPP" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第9章 ネットワーキング</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="x.html">戻る</a>〓</td><th width="60%" align="center">〓</th><td width="20%" align="right">〓<a accesskey="n" href="ppp.html">次へ</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="networking"></a>第9章 ネットワーキング</h1></div></div></div><p>
      <span class="emphasis"><em>訳:
        有村 光晴 <code class="email">&lt;<a xmlns="" class="email" href="mailto:arimura@jp.FreeBSD.org">arimura@jp.FreeBSD.org</a>&gt;</code>、
        広瀬 昌一 <code class="email">&lt;<a xmlns="" class="email" href="mailto:shou@kt.rim.or.jp">shou@kt.rim.or.jp</a>&gt;</code>、
        にしか <code class="email">&lt;<a xmlns="" class="email" href="mailto:nishika@cheerful.com">nishika@cheerful.com</a>&gt;</code>、
        はらだ きろう <code class="email">&lt;<a xmlns="" class="email" href="mailto:kiroh@jp.FreeBSD.org">kiroh@jp.FreeBSD.org</a>&gt;</code>、
        1998 年 10 月 4 日</em></span>
    </p><div class="qandaset"><a id="idp82079440"></a><dl><dt>9.1. <a href="networking.html#idp82079696">「ディスクレスブート (diskless boot)」
            に関する情報はどこで得られますか?</a></dt><dt>9.2. <a href="networking.html#idp82083024">
            FreeBSD をネットワークのルータ (router) として使用することはできますか?
          </a></dt><dt>9.3. <a href="networking.html#idp82091344">Win95 の走っているマシンを、FreeBSD 経由でインターネットに接続できますか?</a></dt><dt>9.4. <a href="networking.html#idp82106960">ISC からリリースされている BIND の最新版はコンパイルできないんでしょうか?</a></dt><dt>9.5. <a href="networking.html#idp82109776">FreeBSD で SLIP と
            PPP は使えますか?</a></dt><dt>9.6. <a href="networking.html#idp82143056">FreeBSD は NAT か
            IP マスカレードをサポートしていますか?
          </a></dt><dt>9.7. <a href="networking.html#idp82150608">/dev/ed0
            デバイスを作成することができません。</a></dt><dt>9.8. <a href="networking.html#idp82153296">Ethernet アドレスのエイリアス (alias) はどのようにして設定できますか?</a></dt><dt>9.9. <a href="networking.html#idp82157392">3C503 で他のネットワークポートを使用するにはどのようにすればよいですか?</a></dt><dt>9.10. <a href="networking.html#idp82166352">FreeBSD との間で NFS がうまくできません。</a></dt><dt>9.11. <a href="networking.html#idp82169296">何故 Linux のディスクを NFS
            マウントできないのでしょうか?</a></dt><dt>9.12. <a href="networking.html#idp82176464">何故 Sun のディスクを NFS
            マウントできないのでしょうか?</a></dt><dt>9.13. <a href="networking.html#idp82179408">mountd から
            「can't change attributes」
            というメッセージがずっと出続けていて、
            FreeBSD の NFS サーバでは
            「bad exports list」
            と表示されます。これは何が原因なのでしょう?</a></dt><dt>9.14. <a href="networking.html#idp82238416">PPP で NeXTStep
            に接続する際に問題があるのですが。
          </a></dt><dt>9.15. <a href="networking.html#idp82242512">IP
            マルチキャスト (multicast) を有効にするには?</a></dt><dt>9.16. <a href="networking.html#idp82265552">
            DEC
            の PCI チップセットを用いているネットワークカードには、
            どのような物がありますか?</a></dt><dt>9.17. <a href="networking.html#idp82268496">
            何故自分のサイトのホストに対して FQDN
            を使用する必要があるのですか?</a></dt><dt>9.18. <a href="networking.html#idp82283088">すべてのネットワークの操作に対して
            Permission denied
            というメッセージが表示されるのですが。</a></dt><dt>9.19. <a href="networking.html#idp82290000">IPFW のオーバヘッドはどのくらいでしょうか?</a></dt><dt>9.20. <a href="networking.html#idp82305744">ipfw(8) 「fwd」
            ルールを使って他のマシンにサービスをリダイレクトしたのですが、
            うまく動いてくれないようです。どうしてなんでしょう?</a></dt><dt>9.21. <a href="networking.html#idp82315344">サービス要求を他のマシンにリダイレクトするには?</a></dt><dt>9.22. <a href="networking.html#idp82320976">バンド幅の管理を行なえるツールはどこで手に入れられますか?</a></dt><dt>9.23. <a href="networking.html#idp82328272">BIND (named) が、53 番ポートのほかに
	    大きな番号のポートで受け付けています。私のホストは
	    乗っ取られたのでしょうか。</a></dt><dt>9.24. <a href="networking.html#idp82333136">なぜ 「/dev/bpf0: device not configured」
            が出るのでしょうか?</a></dt><dt>9.25. <a href="networking.html#idp82343632">Linux の smbmount のように、
            ネットワーク上の Windows
            マシンのディスクをマウントするにはどうしたら良いのでしょう?</a></dt><dt>9.26. <a href="networking.html#idp82346320">「icmp-response bandwidth limit 300/200 pps」
            というメッセージがログファイルに現れるのですが、
            どういうことでしょう?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp82079696"></a><a id="diskless-booting"></a><p><strong>9.1.</strong></p></td><td align="left" valign="top"><p><span class="quote">「<span class="quote">ディスクレスブート (diskless boot)</span>」</span>
            に関する情報はどこで得られますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p><span class="quote">「<span class="quote">ディスクレスブート (diskless boot)</span>」</span>
            というのは、FreeBSD がネットワーク上で起動し、
            必要なファイルを自分のハードディスクではなくてサーバから読み込むものです。
            詳細については
            <a class="link" href="../handbook/diskless.html" target="_top">FreeBSD
              ハンドブックの「ディスクレスブート」</a>を読んでください。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82083024"></a><a id="router"></a><p><strong>9.2.</strong></p></td><td align="left" valign="top"><p>
            FreeBSD をネットワークのルータ (router) として使用することはできますか?
          </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            インターネット標準やこれまでのよい経験によって指摘されている通り、
            FreeBSD は標準ではパケットを転送 (forward) するように設定されていません。
            しかし、
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>
            の中で次の変数の値を
            <code class="literal">YES</code>
            とする事によってこの機能を有効にすることができます。
          </p><pre class="programlisting">gateway_enable=YES          # Set to YES if this host will be a gateway</pre><p>
            このオプションによって
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span></a>
            の変数
            <code class="varname">net.inet.ip.forwarding</code> が
            <code class="literal">1</code> になります。
          </p><p>
            ほとんどの場合、
            ルータについての情報を同じネットワークの他の計算機等に知らせるために、
            経路制御のためのプロセスを走らせる必要があるでしょう。
            FreeBSD には BSD の標準経路制御デーモンである
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=routed&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">routed</span>(8)</span></a>
            が付属していますが、より複雑な状況に対処するためには
            <span class="application">GaTeD</span>(<a class="link" href="http://www.gated.org/" target="_top">http://www.gated.org/</a>
            から入手可能) を使用することもできます。
            3_5Alpha7 において FreeBSD がサポートされています。
          </p><p>
            注意してほしいのは、FreeBSD をこのようにして使用している場合でも、
            ルータに関するインターネット標準の必要条件を完全には満たしていない
            ということです。しかし、普通に使用する場合にはほとんど問題ありません。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82091344"></a><a id="win95-connection"></a><p><strong>9.3.</strong></p></td><td align="left" valign="top"><p>Win95 の走っているマシンを、FreeBSD 経由でインターネットに接続できますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            通常、この質問が出てくる状況は自宅に二台の PC があり、一台では
            FreeBSD が、もう一台では Win95 が走っているような場合です。
            ここでやろうとしていう事は FreeBSD の走っている計算機をインターネット
            に接続し、Win95 の走っているマシンからは FreeBSD
            の走っているマシンを経由して接続を行なう事です。
            これは二つ前の質問の特別な場合に相当します。
          </p><p>…で、答えは「はい」です。
            FreeBSD 3.x のユーザモード ppp には <code class="option">-nat</code>
            オプションがあります。
            <span class="application">ppp</span> を <code class="option">-nat</code>
            オプション付きで起動し、
            <code class="filename">/etc/rc.conf</code> にある
            <code class="literal">gateway_enable</code> を
            <span class="emphasis"><em>YES</em></span> に設定します。
            そして Windows マシンを正しく設定すれば、
            きちんと動作するでしょう。</p><p>
            設定に関するさらに詳しい情報は、
            Steve Sims 氏による
            <a class="link" href="http://www.FreeBSD.org/tutorials/ppp/index.html" target="_top">Pedantic
              PPP Primer</a> にあります。</p><p>カーネルモード ppp を利用する場合や、
            インターネットとのイーサネット接続が利用できる場合は、
            <code class="command">natd</code> を利用する必要があります。
            この FAQ の <a class="link" href="networking.html#natd" title="9.6.">natd</a>
            のセクションを参照してください。</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82106960"></a><a id="latest-bind"></a><p><strong>9.4.</strong></p></td><td align="left" valign="top"><p>ISC からリリースされている BIND の最新版はコンパイルできないんでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            BIND の配布物と FreeBSD とでは
            <code class="filename">cdefs.h</code>
            というファイルの中でデータ型の矛盾があります。
            <code class="filename">compat/include/sys/cdefs.h</code>
            を削除してください。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82109776"></a><a id="slip-ppp-support"></a><p><strong>9.5.</strong></p></td><td align="left" valign="top"><p>FreeBSD で <acronym class="acronym">SLIP</acronym> と
            <acronym class="acronym">PPP</acronym> は使えますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            使えます。FreeBSD を用いて他のサイトに接続する場合には、
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=slattach&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">slattach</span>(8)</span></a>、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sliplogin&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sliplogin</span>(8)</span></a>、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppp&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ppp</span>(8)</span></a> そして
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pppd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pppd</span>(8)</span></a> のマニュアルページをご覧ください。
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppp&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ppp</span>(8)</span></a> と <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pppd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pppd</span>(8)</span></a> は、
            <acronym class="acronym">PPP</acronym> のサーバ、クライアント両方の機能を持っています。
            その一方で、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sliplogin&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sliplogin</span>(8)</span></a> は
            <acronym class="acronym">SLIP</acronym> のサーバ専用で、
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=slattach&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">slattach</span>(8)</span></a> は
            <acronym class="acronym">SLIP</acronym> のクライアント専用です。
          </p><p>これらを使うためのさらなる情報については、<a class="link" href="../handbook/ppp-and-slip.html" target="_top">ハンドブックの PPP と
            SLIP の章</a>をご覧ください。</p><p>
            「シェルアカウント」を通じてのみインターネットへアクセス可能な場合、
            <span class="application">slirp</span>
            package みたいなものが欲しくなるかもしれませんね。
            これを使えば、ローカルマシンから直接 <acronym class="acronym">ftp</acronym>
            や <acronym class="acronym">http</acronym>
            のようなサービスに (限定的ではありますが) アクセスすることができます。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82143056"></a><a id="natd"></a><p><strong>9.6.</strong></p></td><td align="left" valign="top"><p>FreeBSD は <acronym class="acronym">NAT</acronym> か
            <acronym class="acronym">IP</acronym> マスカレードをサポートしていますか?
          </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            ローカルなサブネット (一台以上のローカルマシン) を持っているが、
            インターネットプロバイダから 1 つしか <acronym class="acronym">IP</acronym>
            アドレスの割り当てを受けていない場合 (または <acronym class="acronym">IP</acronym>
            アドレスを動的に割り当てられている場合でも)、
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=natd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">natd</span>(8)</span></a>
            プログラムを使いたくなるかもしれませんね。
            <code class="literal">natd</code> を使えば、
            1 つしか <acronym class="acronym">IP</acronym> アドレスを持っていない場合でも、
            サブネット全体をインターネットに接続させることができます。
          </p><p>
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppp&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ppp</span>(8)</span></a>
            も同様の機能を持っており、<code class="option">-nat</code>
            スイッチで有効にすることができます。
            どちらの場合も
            alias ライブラリ (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=libalias&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">libalias</span>(3)</span></a>) が使われます。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82150608"></a><a id="create-dev-net"></a><p><strong>9.7.</strong></p></td><td align="left" valign="top"><p><code class="filename">/dev/ed0</code>
            デバイスを作成することができません。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Berkeley UNIX におけるネットワークの構成において、
            ネットワークのインタフェースはカーネルコードからのみ、
            直接あつかうことができます。
            より詳しく知りたい場合は、
            <code class="filename">/etc/rc.network</code>
            というファイルや、
            このファイルの中に書いてある、
            さまざまなプログラムについてのマニュアルページを見てください。
            それでもまだ分からない場合には、
            他の BSD 系の OS のネットワーク管理についての本を読むべきでしょう。
            ごく少しの例外をのぞいては、FreeBSD のネットワーク管理は SunOS 4.0
            や Ultrix と基本的に同じです。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82153296"></a><a id="ethernet-aliases"></a><p><strong>9.8.</strong></p></td><td align="left" valign="top"><p>Ethernet アドレスのエイリアス (alias) はどのようにして設定できますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ifconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ifconfig</span>(8)</span></a>
            のコマンドラインに
            <code class="literal">netmask 0xffffffff</code>
            を追加して、次のように書いてください。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig ed0 alias 204.141.95.2 netmask 0xffffffff</code></strong></pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82157392"></a><a id="port-3c503"></a><p><strong>9.9.</strong></p></td><td align="left" valign="top"><p>3C503 で他のネットワークポートを使用するにはどのようにすればよいですか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            他のポートを使用したい場合には、
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ifconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ifconfig</span>(8)</span></a>
            のコマンドラインにパラメータを追加しなければなりません。
            デフォルトでは
            <code class="literal">link0</code>
            が用いられるようになっています。
            BNC のかわりに
            AUI ポートを使用したい場合には、
            <code class="literal">link2</code>
            というパラメータを追加してください。
            これらのフラグは、
            <code class="filename">/etc/rc.conf</code> (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> 参照)
            にある ifconfig_*
            の変数を使って指定されるはずです。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82166352"></a><a id="nfs"></a><p><strong>9.10.</strong></p></td><td align="left" valign="top"><p>FreeBSD との間で NFS がうまくできません。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            PC 用のネットワークカードによっては、
            NFS のような、
            ネットワークを酷使するアプリケーションにおいて問題を起こすものがあります。
          </p><p>
            この点に関しては
            <a class="link" href="../handbook/nfs.html" target="_top">FreeBSD
              ハンドブックの「NFS」</a>を参照してください。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82169296"></a><a id="nfs-linux"></a><p><strong>9.11.</strong></p></td><td align="left" valign="top"><p>何故 Linux のディスクを NFS
            マウントできないのでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            Linux の NFS
            のコードには、
            許可されたポートからのリクエストしか受けつけないものがあります。
            以下を試してみてください。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -o -P linuxbox:/blah /mnt</code></strong></pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82176464"></a><a id="nfs-sun"></a><p><strong>9.12.</strong></p></td><td align="left" valign="top"><p>何故 Sun のディスクを NFS
            マウントできないのでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            SunOS 4.X が走っている Sun Workstation は、
            許可されたポートからのマウント要求しか受けつけません。
            以下を試してみてください。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -o -P sunbox:/blah /mnt</code></strong></pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82179408"></a><a id="exports-errors"></a><p><strong>9.13.</strong></p></td><td align="left" valign="top"><p><code class="command">mountd</code> から
            <span class="quote">「<span class="quote">can't change attributes</span>」</span>
            というメッセージがずっと出続けていて、
            FreeBSD の NFS サーバでは
            <span class="quote">「<span class="quote">bad exports list</span>」</span>
            と表示されます。これは何が原因なのでしょう?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>最も良くある問題は、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exports&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">exports</span>(5)</span></a>
            のマニュアルページの以下の部分を正しく理解していないことです。</p><div class="blockquote"><blockquote class="blockquote"><p>このファイルの各行 (# ではじまるコメント行を除く) は、
              NFS サーバのローカルファイルシステムに存在する、
              他のホストにエクスポートされるマウントポイント (複数可) と、
              それに対するエクスポートフラグを指定します。
              特定のエクスポート先ホストおよび、
              すべてのホストに適用されるデフォルトエントリは両方とも、
              サーバの各ローカルファイルシステムに対して一回だけしか指定できません。</p></blockquote></div><p>さて、ありがちな間違いをご覧になればはっきりするでしょう。
            もし <code class="filename">/usr</code>
            以下が単一のファイルシステムである (つまり
            <code class="filename">/usr</code> に何もマウントされない) 場合、
            次の exports リストは正しくありません。</p><pre class="programlisting">/usr/src   client
/usr/ports client</pre><p>一つのファイルシステムに対して属性の指定が二行になっています。
            <code class="filename">/usr</code> は同じホスト
            <code class="systemitem">client</code> にエクスポートされますから、
            正しい書き方は次のようになります。</p><pre class="programlisting">/usr/src /usr/ports  client</pre><p>もう一度マニュアルページの文章を確認すると、
            あるホストにエクスポートされる各ファイルシステムの属性は
            すべて一行に書かれていなければならない、となっています
            (ここでは、「アクセス可能なすべてのホスト」
            も一つの独立したホストとして扱われることに注意してください)。
            このことは、ファイルシステムをエクスポートするために
            奇妙な書式を使わなければならない原因にもなっているのですが、
            ほとんどの人にとって、これは問題にはならないでしょう。</p><p>次に示すのは、有効な exports リストの例です。
            ここでは、<code class="filename">/usr</code> と
            <code class="filename">/exports</code>
            がローカルファイルシステムです。</p><pre class="programlisting"># Export src and ports to client01 and client02, but only
# client01 has root privileges on it
/usr/src /usr/ports -maproot=0    client01
/usr/src /usr/ports               client02
# The "client" machines have root and can mount anywhere
# up /exports. The world can mount /exports/obj read-only
/exports -alldirs -maproot=0      client01 client02
/exports/obj -ro</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82238416"></a><a id="ppp-nextstep"></a><p><strong>9.14.</strong></p></td><td align="left" valign="top"><p>PPP で NeXTStep
            に接続する際に問題があるのですが。
          </p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            <code class="filename">/etc/rc.conf</code> (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> 参照)
            の中で次の変数を NO にして、
            TCP extension を無効にしてみてください。
          </p><pre class="programlisting">tcp_extensions=NO</pre><p>
            Xylogic の Annex も同様の問題がありますので、
            Annex 経由で PPP
            を行なう場合にもこの変更を行ってください。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82242512"></a><a id="ip-multicast"></a><p><strong>9.15.</strong></p></td><td align="left" valign="top"><p>IP
            マルチキャスト (multicast) を有効にするには?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            FreeBSD 2.0 かそれ以降では、
            標準の状態で完全にマルチキャストに対応しています。
            現在使用している計算機をマルチキャストのルータ (router) として使用するには、
            <code class="literal">MROUTING</code>
            というオプションを定義したカーネルを作ったうえで、
            <code class="command">mrouted</code>
            を走らせる必要があります。2.2 かそれ以降の FreeBSD ならば、
            <code class="filename">/etc/rc.conf</code>
            でフラグ
            <code class="literal">mrouted_enable</code> を
            <code class="literal">YES</code> にセットしておくことで、
            起動時に <code class="command">mrouted</code>
            を起動できます。
          </p><p>
            MBONE
            用のツールは ports 内の専用のカテゴリー mbone
            にあります。
            <code class="command">vic</code> や
            <code class="command">vat</code>
            といった会議用のツールを探している場合は、
            この場所を見てください。
          </p><p>
            詳しい情報は
            <a class="link" href="http://www.mbone.com/" target="_top">Mbone Information Web</a>
            にあります。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82265552"></a><a id="dec-pci-chipset"></a><p><strong>9.16.</strong></p></td><td align="left" valign="top"><p>
            DEC
            の PCI チップセットを用いているネットワークカードには、
            どのような物がありますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            <a class="link" href="mailto:gfoster@driver.nsta.org" target="_top">Glen Foster
              氏</a>による一覧に、
            最近の製品を追加したものを以下に示します。
          </p><pre class="programlisting">Vendor          Model
----------------------------------------------
ASUS            PCI-L101-TB
Accton          ENI1203
Cogent          EM960PCI
Compex          ENET32-PCI
D-Link          DE-530
Dayna           DP1203, DP2100
DEC             DE435, DE450
Danpex          EN-9400P3
JCIS            Condor JC1260
Linksys         EtherPCI
Mylex           LNP101
SMC             EtherPower 10/100 (Model 9332)
SMC             EtherPower (Model 8432)
TopWare         TE-3500P
Znyx            (2.2.X) ZX312, ZX314, ZX342, ZX345, ZX346, ZX348
                (3.X) ZX345Q, ZX346Q, ZX348Q, ZX412Q, ZX414, ZX442,
                      ZX444, ZX474, ZX478, ZX212, ZX214 (10mbps/hd)</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82268496"></a><a id="fqdn-hosts"></a><p><strong>9.17.</strong></p></td><td align="left" valign="top"><p>
            何故自分のサイトのホストに対して FQDN
            を使用する必要があるのですか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            実際にはそのホストは別のドメインにあるのではないですか。
            たとえば、foo.bar.edu
            というドメインの中から、
            <code class="systemitem">bar.edu</code> ドメインにある
            <code class="systemitem">mumble</code>
            というホストを指定したい場合には、
            <code class="systemitem">mumble</code>
            だけではダメで、
            <code class="systemitem">mumble.bar.edu</code>
            という FQDN (fully-qualified domain name)
            で指定しなければなりません。
          </p><p>
            伝統的に、BSD の
            BIND のリゾルバ (resolver) ではこのような事は可能でしたが、
            FreeBSD に入っている
            <span class="application">bind</span> (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=named&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">named</span>(8)</span></a> 参照)
            の現在のバージョンでは、
            自分以外のドメインに対して FQDN
            でない別名を自動的につけてくれるような事はありません。
            したがって <code class="systemitem">mumble</code> というホスト名は、
            <code class="systemitem">mumble.foo.bar.edu</code>
            という名前か、もしくは root
            ドメイン内にある場合にしか適用されません。
          </p><p>
            これは、
            <code class="systemitem">mumble.bar.edu</code> と
            <code class="systemitem">mumble.edu</code>
            ということなったドメイン名に対してホスト名のサーチが行なわれていた
            以前の振る舞いとは異なったものです。このような事が悪い例もしくは
            セキュリティホールとみなされる理由については
            RFC 1535 を見てください。
          </p><p>
            <code class="filename">/etc/resolv.conf</code> ファイル
            (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=resolv.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">resolv.conf</span>(5)</span></a> 参照)
            の中で
          </p><pre class="programlisting">domain foo.bar.edu</pre><p>
            と書いてある行を、

            <code class="systemitem">search foo.bar.edu bar.edu</code>

            のように書きかえることで、上のような事ができます。しかし、
            RFC 1535 にあるように、
            検索順序が「内部 (local) と外部 (public) の管理の境界」をまたがないようにしてください。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82283088"></a><a id="network-permission-denied"></a><p><strong>9.18.</strong></p></td><td align="left" valign="top"><p>すべてのネットワークの操作に対して
            <code class="literal">Permission denied</code>
            というメッセージが表示されるのですが。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            <code class="literal">IPFIREWALL</code>
            オプションを付けてカーネルをコンパイルした場合には、
            2.1-STABLE の開発の途中から変更になった 2.1.7R の標準的な方針として、
            明示的に許可されていないすべてのパケットは落とされる設定
            になっている事を覚えておいてください。
          </p><p>
            もしファイアウォールの設定を間違えた場合にネットワークの操作が再びできる
            ようにするには、<code class="systemitem">root</code>
            でログインして次のコマンドを実行してください。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ipfw add 65534 allow all from any to any</code></strong></pre><p>
            <code class="filename">/etc/rc.conf</code> に
            <code class="literal">firewall_type='open'</code>
            を追加してもよいでしょう。
          </p><p>
            FreeBSD のファイアウォールの設定についての情報は
            <a class="link" href="../handbook/firewalls.html" target="_top">FreeBSD
              ハンドブックの「ファイアウォール」</a>にあります。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82290000"></a><a id="ipfw-overhead"></a><p><strong>9.19.</strong></p></td><td align="left" valign="top"><p>IPFW のオーバヘッドはどのくらいでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            この答えは、
            使っているルールセットとプロセッサのスピードによってほとんど決まります。
            イーサネットに対して少しのルールセットだけを使っている場合には、
            ほとんどその影響は無視できる程度です。
            実際の測定値を見ないと満足できない方々のために、
            実際の測定結果をお見せしましょう。
          </p><p>
            次の測定は 486-66 (訳注: Intel 社製 CPU i486、66MHz のこと) 上で
            2.2.5-STABLE を使用して行なわれました。
            IPFW は変更が加えられて、<code class="literal">ip_fw_chk</code>
            ルーチン内でかかる時間を
            測定して 1000
            パケット毎に結果をコンソールに表示するようになっています。
          </p><p>
            それぞれ 1000 ずつのルールが入っている 2
            つのルールセットでテストが行なわれました。
            ひとつ目のルールセットは最悪のケースを見るために
          </p><pre class="programlisting">ipfw add deny tcp from any to any 55555</pre><p>
            というルールを繰り返したものです。
          </p><p>
            IPFW のパケットチェックルーチンは、
            パケットが (ポート番号のせいで) このルールにマッチしないことがわかるまでに、
            何度も実行されます。そのため、これは最悪のケースを示します。
            このルールを 999 個繰り返し並べた後に
          </p><pre class="programlisting">allow ip from any to any</pre><p>
            が書かれています。
          </p><p>
            2つ目のルールセットは、なるべく早くチェックが終了するように書かれたものです。
          </p><pre class="programlisting">ipfw add deny ip from 1.2.3.4 to 1.2.3.4</pre><p>
            このルールでは、発信元の IP アドレスがマッチしないので、
            チェックはすぐに終了します。上のルールセットとおなじように、
            1000 個目のルールは
          </p><pre class="programlisting">allow ip from any to any</pre><p>
            です。
          </p><p>
            1 つ目のルールセットの場合、
            パケットあたりのオーバヘッドはおよそ
            2.703ms/packet、
            これはだいたい 1 つのルールあたり 2.7
            マイクロ秒かかっていることになります。
            したがって、
            このルールにおけるパケット処理時間の理論的な限界は、
            毎秒約 370 パケットです。
            10Mbps のイーサネットで 1500 バイト以下のパケットサイズを仮定すると、
            バンド幅の利用効率は 55.5% が限界となることになります。
          </p><p>
            2 つ目のルールセットでは、それぞれのパケットがおよそ
            1.172msで処理されていますので、
            だいたい 1 つのルールあたり 1.2
            マイクロ秒かかっていることになります。
            パケット処理時間の理論的な限界は、
            毎秒約 853 パケットとなりますので、
            10Mbps Ethernet のバンド幅を使い切ることができます。
          </p><p>
            このテストでのルール数は多過ぎるため、
            実際に使用する際の結果を反映している訳ではありません。
            これらは上に示した数値を出すためだけに用いられたものです。
            効率の良いルールセットを作るためには、
            次のような事を考えておけばよいでしょう。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                  「確定している」ルールは先頭の方に持ってきてください。
                  これは、多数の TCP のトラフィックがこのルールで処理されるためです。
                  そしてこのルールの前には
                  <code class="literal">allow tcp</code>
                  という記述を置かないでください。
                </p></li><li class="listitem"><p>
                  良く使われるルールを、あまり良く使われないルールよりも
                  前の方に (もちろん<span class="emphasis"><em>ファイアウォールの許可設定を変えない範囲で</em></span>)
                  持ってきてください。
                  <code class="command">ipfw -a l</code> のようしてパケット数の統計を取ることで、
                  どのルールが最もよく使われているかを調べることができます。
                </p></li></ul></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82305744"></a><a id="ipfw-fwd"></a><p><strong>9.20.</strong></p></td><td align="left" valign="top"><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ipfw</span>(8)</span></a> <span class="quote">「<span class="quote">fwd</span>」</span>
            ルールを使って他のマシンにサービスをリダイレクトしたのですが、
            うまく動いてくれないようです。どうしてなんでしょう?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>おそらく、あなたが期待している動作とは、
            単なるパケット転送ではなくネットワークアドレス変換 (NAT)
            と呼ばれるものだからでしょう。
            <span class="quote">「<span class="quote">fwd</span>」</span> ルールは文字どおり、本当に転送しか行ないません。
            パケットの中身については一切手を加えないのです。
            そのため、次のようなルールを設定したとすると、
          </p><pre class="screen">01000 fwd <em class="replaceable"><code>10.0.0.1</code></em> from any to <em class="replaceable"><code>foo 21</code></em></pre><p>宛先アドレスに <em class="replaceable"><code>foo</code></em> と書かれたパケットが
            このルールを設定したマシンに到着した場合、そのパケットは
            <em class="replaceable"><code>10.0.0.1</code></em> に転送されますが、宛先アドレスは
            <em class="replaceable"><code>foo</code></em> のままになります。
            つまり、パケットに宛先アドレスが <em class="replaceable"><code>10.0.0.1</code></em>
            に書き換えられるということは<span class="emphasis"><em>ありません</em></span>。
            自分宛でないパケットを受けとったマシンは、
            おそらくほとんどの場合、そのパケットを破棄すると思います。
            そのため <span class="quote">「<span class="quote">fwd</span>」</span> ルールは、
            そのルールを書いたユーザが意図したようには動かないことが良くあります。
            この動作はバグではなく、仕様なのです。</p><p>サービスの転送をきちんと動作させる方法については、
            <a class="link" href="networking.html#service-redirect" title="9.21.">サービスのリダイレクトに関する
              FAQ</a> や <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=natd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">natd</span>(8)</span></a> のマニュアルページ、
            <a class="link" href="../ports/" target="_top">Ports Collection</a>
            にいくつか含まれているポート転送ユーティリティなどをご覧になると良いでしょう。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82315344"></a><a id="service-redirect"></a><p><strong>9.21.</strong></p></td><td align="left" valign="top"><p>サービス要求を他のマシンにリダイレクトするには?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            FTP などのサービスのリクエストは、<span class="quote">「<span class="quote">socket</span>」</span>
            パッケージを利用してリダイレクトできます。
            <span class="quote">「<span class="quote">socket</span>」</span>
            パッケージは ports の
            <code class="filename">sysutils</code>
            カテゴリに含まれています。
            (<code class="filename">/etc/inet.conf</code>に書かれている)
            コマンド行を、次のように <span class="quote">「<span class="quote">socket</span>」</span> を呼ぶように変更してください。
        </p><pre class="programlisting">ftp stream tcp nowait nobody /usr/local/bin/socket socket ftp.foo.com ftp</pre><p>
            ここで
            <em class="replaceable"><code>ftp.foo.com</code></em>
            はリダイレクト先のホスト名、
            行の最後の
            <em class="replaceable"><code>ftp</code></em> はポート名です。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82320976"></a><a id="bandwidth-mgr-tool"></a><p><strong>9.22.</strong></p></td><td align="left" valign="top"><p>バンド幅の管理を行なえるツールはどこで手に入れられますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            FreeBSD 用のバンド幅管理ツールには、無料で手に入れられる
            <a class="link" href="http://www.csl.sony.co.jp/person/kjc/programs.html" target="_top">ALTQ</a> と、
            <a class="link" href="http://www.etinc.com/" target="_top">Emerging Technologies</a>
            から入手できる Bandwidth Manager
            という市販のものの 2 種類があります。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82328272"></a><a id="extra-named-port"></a><p><strong>9.23.</strong></p></td><td align="left" valign="top"><p>BIND (<code class="command">named</code>) が、53 番ポートのほかに
	    大きな番号のポートで受け付けています。私のホストは
	    乗っ取られたのでしょうか。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>おそらく違います。FreeBSD 3.0 以降では、外向けの問合せに
	    ランダムな大きな番号のポートを用いるバージョンの BIND を
	    用いています。ファイアウォールを通すため、またはあなたの
	    気分で、外向きの問合せを 53 番ポートから行いたいならば、
	    <code class="filename">/etc/namedb/named.conf</code> に次のように
	    設定してみてください。</p><pre class="programlisting">options {
        query-source address * port 53;
};</pre><p>更に限定したければ、<code class="literal">*</code> を単一の IP
	    アドレスに置き換えることもできます。</p><p>それはともかく、おめでとうごさいます。
	    <code class="command">sockstat</code> の出力を見て、おかしな現象に
	    注目するのはよい習慣です。</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82333136"></a><a id="bpf-not-configured"></a><p><strong>9.24.</strong></p></td><td align="left" valign="top"><p>なぜ <span class="quote">「<span class="quote"><code class="computeroutput">/dev/bpf0: device not configured</code></span>」</span>
            が出るのでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
            バークレーパケットフィルタ (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bpf&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bpf</span>(4)</span></a>)
            ドライバは、それを利用するプログラムを実行する前に有効にしておく必要があります。
            カーネルコンフィグファイルに、次のように追加してカーネルの再構築をしてください。
          </p><pre class="programlisting">pseudo-device bpfilter		# Berkeley Packet Filter</pre><p>
            そして再起動してから、次にデバイスノードを作成する必要があります。
            これは、次のように入力し、<code class="filename">/dev</code> を変更することで行ないます。
          </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sh MAKEDEV bpf0</code></strong></pre><p>
            デバイスノードの作成の詳細は、
            <a class="link" href="../handbook/kernelconfig-nodes.html" target="_top">FreeBSD
              ハンドブックの「デバイスノード」</a>を参照してください。
          </p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82343632"></a><a id="mount-smb-share"></a><p><strong>9.25.</strong></p></td><td align="left" valign="top"><p>Linux の smbmount のように、
            ネットワーク上の Windows
            マシンのディスクをマウントするにはどうしたら良いのでしょう?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Ports Collection に含まれる
            <span class="application">sharity light</span> パッケージを使ってください、</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp82346320"></a><a id="icmp-response-bw-limit"></a><p><strong>9.26.</strong></p></td><td align="left" valign="top"><p><span class="quote">「<span class="quote">icmp-response bandwidth limit 300/200 pps</span>」</span>
            というメッセージがログファイルに現れるのですが、
            どういうことでしょう?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>これは、カーネル自身から「ICMP や TCP のリセット (RST)
            応答を、妥当な数よりも多く送っている」ということを、
            あなたに伝えるメッセージです。
            ICMP 応答は良く、使われていない UDP
            ポートに接続しようとした結果として生成されます。
            また、TCP リセットはオープンされていない TCP
            ポートに接続しようとした結果として生成されます。
            その他、これらのメッセージが表示される原因となる状況として、
            以下のようなものがあります。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>(特定のセキュリティ上の弱点を悪用しようとする攻撃ではなく)
                膨大な数のパケットを使った強引なサービス妨害 (DoS) 攻撃。</p></li><li class="listitem"><p>(一部のウェルノウンポートを狙ったものではなく)
                非常に広い範囲のポートに接続を試みるポートスキャン。</p></li></ul></div><p>メッセージ中の最初の数字は、
            上限を設定しなかった場合にカーネルが送っていたであろうパケットの数を示し、
            二番目の数字は、パケット数の上限値を示します。
            この上限値は
            <code class="varname">net.inet.icmp.icmplim</code> という
            sysctl 変数を使うことで、以下のように変更可能です。
            ここでは上限を 1 秒あたりのパケット数で
            <code class="literal">300</code> にしています。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl -w net.inet.icmp.icmplim=300</code></strong></pre><p>カーネルの応答制限を無効にせず、
            ログファイル中のメッセージだけを抑制したい場合、
            <code class="varname">net.inet.icmp.icmplim_output</code> sysctl
            変数を次のようにすることで出力を止めることができます。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl -w net.inet.icmp.icmplim_output=0</code></strong></pre><p>最後に、もし応答制限を無効にしたい場合は、
            <code class="varname">net.inet.icmp.icmplim</code> sysctl 変数に
            (上の例のようにして) <code class="literal">0</code>
            を設定することで実現できます。
            ただし応答制限を無効化するのは、上記の理由からおすすめしません。</p></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="x.html">戻る</a>〓</td><td width="20%" align="center">〓</td><td width="40%" align="right">〓<a accesskey="n" href="ppp.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第8章 X Window System と仮想コンソール〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓第10章 PPP</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>