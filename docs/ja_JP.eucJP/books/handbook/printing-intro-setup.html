<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>10.3. 基本的な設定</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD ハンドブック" /><link rel="up" href="printing.html" title="第10章 プリンタの利用" /><link rel="prev" href="printing-intro-spooler.html" title="10.2. はじめに" /><link rel="next" href="printing-advanced.html" title="10.4. プリンタ設定上級編" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">10.3. 基本的な設定</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="printing-intro-spooler.html">戻る</a>〓</td><th width="60%" align="center">第10章 プリンタの利用</th><td width="20%" align="right">〓<a accesskey="n" href="printing-advanced.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="printing-intro-setup"></a>10.3. 基本的な設定</h2></div></div></div><p><span class="application">LPD</span>
      スプーリングシステムを用いてプリンタを使用するためには、
      プリンタ機器と <span class="application">LPD</span>
      用ソフトウェアの両方を準備する必要があります。
      本文書では次の二段階のレベルに分けて説明をします。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>プリンタを接続する方法、
	  プリンタにどのように通信するかを
	  <span class="application">LPD</span> に指示する方法や、
          プレインテキストをプリンタで印字する方法については、
          <a class="link" href="printing-intro-setup.html#printing-simple" title="10.3.1. プリンタ設定導入編">プリンタの簡単な設定</a>をご覧ください。</p></li><li class="listitem"><p>様々な形式のファイルを印字する方法、
          ヘッダページを印字する方法、
          ネットワーク経由でプリンタに印字する方法、
          プリンタを制御する方法、
          プリンタの使用に対する課金を行なう方法については<a class="link" href="printing-advanced.html" title="10.4. プリンタ設定上級編">プリンタ設定上級編</a>をご覧ください。</p></li></ul></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-simple"></a>10.3.1. プリンタ設定導入編</h3></div></div></div><p>この節では、プリンタ機器やプリンタを使用するための
        <span class="application">LPD</span>
	用ソフトウェアを設定する方法について述べます。
        この節の概要は次のとおりです。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="printing-intro-setup.html#printing-hardware" title="10.3.1.1. プリンタ機器の設定">プリンタ機器の設定</a>では、
            プリンタをコンピュータに接続するためのヒントがいくつか書かれています。</p></li><li class="listitem"><p><a class="link" href="printing-intro-setup.html#printing-software" title="10.3.1.2. ソフトウェアの設定">ソフトウェアの設定</a>では、
            <span class="application">LPD</span> のスプーラ設定ファイル
            (<code class="filename">/etc/printcap</code>)
            の設定方法について書かれています。</p></li></ul></div><p>データをプリンタに送るのにコンピュータのローカルインタフェースではなく、
        ネットワークプロトコルを使用する場合は、
        <a class="link" href="printing-advanced.html#printing-advanced-network-net-if" title="10.4.3.2. ネットワークにおけるデータストリームの インタフェースを持つプリンタ">
        ネットワークにおけるデータストリームインタフェースを持つプリンタ</a>をご覧ください。</p><p>この節のタイトルは <span class="quote">「<span class="quote">プリンタ設定導入編</span>」</span> ですが、
        実際の設定はかなり複雑です。
        プリンタをコンピュータに接続し、
	<span class="application">LPD</span>
	スプーラを起動させることは一番困難な作業です。
        ヘッダページを出力させたり課金したりするオプションの設定は、
        一度プリンタがうまく動くようになればとても簡単です。</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-hardware"></a>10.3.1.1. プリンタ機器の設定</h4></div></div></div><p>この節では、プリンタに PC
          を接続するための様々な方法について説明しています。
          ここでは、ポートやケーブルの種類、
          FreeBSD がプリンタとの通信に必要なカーネルコンフィグレーションについても言及しています。</p><p>もしプリンタが既に接続されていて、
          他のオペレーティングシステム上でプリンタからの印字に成功している場合は、
          <a class="link" href="printing-intro-setup.html#printing-software" title="10.3.1.2. ソフトウェアの設定">ソフトウェアの設定</a>まで読み飛ばすことが多分できるでしょう。</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-ports"></a>10.3.1.1.1. ポートとケーブル</h5></div></div></div><p>今日 PC 用に売られているプリンタには通常、
	    次の 3 つのインタフェースのうち、どれか
	    1 つ以上がついてきます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="emphasis"><em>シリアル</em></span><a id="idp86066128" class="indexterm"></a>インタフェース
		(RS-232 または COM ポートとも呼ばれます) は、
		コンピュータにあるシリアルポートを使ってプリンタにデータを送信します。
                シリアルインタフェースはコンピュータ業界で共通して使用されています。
                そのケーブルは容易に手に入りますし、簡単に自作することもできます。
                シリアルインタフェースの場合は時々、
		特別なケーブルや何か複雑な通信方式選択の設定が必要になることがあります。
		ほとんどの PC のシリアルポートは通信速度が最大で
		115200 bps であり、
		大きな画像を印刷するのには実用的ではありません。</p></li><li class="listitem"><p><span class="emphasis"><em>パラレル</em></span><a id="idp86067792" class="indexterm"></a>インタフェースではプリンタにデータを送信するために、
                コンピュータにあるパラレルポートを使用します。
		パラレルインタフェースは PC 業界ではよく使われており、
		RS-232 シリアルよりも速いです。
                ケーブルの入手は容易ですが、
                自作するのはシリアルよりも困難です。
                パラレルインタフェースには通常、通信方式の選択はなく、
                設定は極めて単純です。</p><p>パラレルインタフェースは
	      <span class="quote">「<span class="quote">セントロニクス</span>」</span><a id="idp86069200" class="indexterm"></a>
		インタフェースとして知られています。
                これは、プリンタ用のコネクタタイプとして採用された後に名付けられました。</p></li><li class="listitem"><p>USB<a id="idp86070736" class="indexterm"></a>
		インタフェースは、Universal Serial Bus
		(汎用シリアルバス) の略で、パラレルや RS-232
		シリアルよりさらに速く動作します。
		ケーブルは単純で安価です。USB は、印刷目的には RS-232
		シリアルやパラレルよりも向いていますが、<span class="trademark">UNIX</span>®
		システムでは十分対応されていません。
		この問題を回避する手としては、多くのプリンタがそうですが、
		USB とパラレルの両方のインタフェースを備えたプリンタを購入することが挙げられます。</p></li></ul></div><p>パラレルインタフェースでは、普通は
	    (コンピュータからプリンタへの)
	    単方向通信のみを行なうのに対して、
	    シリアルおよび USB インタフェースは双方向通信を行ないます。
	    FreeBSD でも IEEE1284 準拠のケーブルを使えば、
	    最近のパラレルポート (EPP や ECP)
	    とプリンタの多くで双方向通信を行なうことができます。</p><a id="idp86072784" class="indexterm"></a><p>パラレルポート経由のプリンタとの双方向通信には、
	    通常 2 つの方法のどちらかが使われます。一つ目の方法は、
	    プリンタが使用しているプロプライエタリな言語を話す
	    FreeBSD 用に作成されたプリンタドライバを使うものです。
	    これはインクジェットプリンタではよく使われる方法で、
	    インクの残量やその他の状態の情報を知らせるのに使えます。
	    二つ目の方法は、プリンタが <span class="trademark">PostScript</span>®
	    に対応している時に使われます。</p><p><span class="trademark">PostScript</span>®
	    ジョブは、実際にはプリンタに送信されるプログラムです。
	    印字作業を行う必要は必ずしありませんし、
	    プログラムの結果を直接コンピュータに返してもよいのです。
            <span class="trademark">PostScript</span>® プリンタでは双方向通信を使って
            <span class="trademark">PostScript</span>® プログラムのエラーや紙づまりといった問題をコンピュータに報告します。
            ユーザはそれらの情報を知りたいと思うかも知れません。
            また、<span class="trademark">PostScript</span>® プリンタで課金作業をもっとも効率よく行なうためには、
            双方向通信が必要となります。
            この方法ではまず、プリンタの現在のページカウント
            (起動してから今まで何枚の紙を印字したか) の情報を得ます。
            次に、ユーザのジョブを実行し、終了後、再びページカウントを得ます。
            この二つの数を差によって、
            課金対象となる紙の枚数を知ることができるのです。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-parallel"></a>10.3.1.1.2. パラレルポート</h5></div></div></div><p>プリンタをパラレルインタフェースを使って接続する場合は、
            セントロニクスケーブルでプリンタとコンピュータを接続してください。
            詳しい説明はプリンタやコンピュータに付属する説明書に書かれているはずです。</p><p>その際、
            どのパラレルポートを使用したかを覚えておいてください。
	    FreeBSD では最初のポートは <code class="filename">ppc0</code>、
	    二番目が <code class="filename">ppc1</code> であり、
            三番目以降も同様に続きます。
	    プリンタのデバイス名にも同じ形式が使われており、
	    最初のパラレルポートに接続されたプリンタは
	    <code class="filename">/dev/lpt0</code> などとなります。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-serial"></a>10.3.1.1.3. シリアルポート</h5></div></div></div><p>シリアルインタフェースを使ってプリンタを使う場合は、
            適切なシリアルケーブルでプリンタとコンピュータを接続してください。
            詳しい説明はプリンタ、コンピュータ、あるいは両方に付属する説
            明書に書かれているはずです。</p><p><span class="quote">「<span class="quote">適切なシリアルケーブル</span>」</span> が良くわからないときは、
            次のどれかを試してみてください。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="emphasis"><em>モデム</em></span>用ケーブルでは、
                それぞれのピンは他方のコネクタの対応するピンと線でつながっています。
                このタイプのケーブルは <span class="quote">「<span class="quote">DTE-DCE</span>」</span>
                間ケーブルとしても知られています
                (訳注:
                日本ではストレートケーブルという名前で売られています)。</p></li><li class="listitem"><p><span class="emphasis"><em>ヌルモデム</em></span>用ケーブル<a id="idp86084048" class="indexterm"></a>では、
                あるピンは対応するピンとを接続していますが、
                あるピン
                (たとえば、データ送信用とデータ受信用のピン)
                が交差して接続したり、
                いくつかのピンは内部で短絡していたりします。
                このタイプのケーブルは、
                <span class="quote">「<span class="quote">DTE-DTE</span>」</span> 間ケーブルと呼ばれています
                (訳注: 日本ではクロスケーブルという名前で売られています)。</p></li><li class="listitem"><p>A <span class="emphasis"><em>シリアルプリンタ</em></span>用ケーブルは、
                ある特定のプリンタで必要とされるものです。
                ヌルモデムケーブルと似ていますが、
                内部で短絡させる代わりに、
                ある信号を他方側に送るために使用しています。</p></li></ul></div><a id="idp86086480" class="indexterm"></a><a id="idp86086992" class="indexterm"></a><a id="idp86087504" class="indexterm"></a><p>この他に、
            プリンタ用の通信パラメータを設定する必要があります。
            通常、プリンタのフロントパネルや DIP スイッチによって制御します。
            コンピュータとプリンタの双方で設定できる最高の通信速度
            [bps] (ビット/秒、
            <span class="emphasis"><em>ボーレート</em></span>と示されているときもある)
            を選んでください。そして、データビット (7 または 8)、
            パリティ (偶/奇/なし)、ストップビット (1 または 2)
            を選んでください。
            そして、フローコントロールの有無
            (制御なし、または XON/XOFF (<span class="quote">「<span class="quote">イン・バンド</span>」</span>
            または
            <span class="quote">「<span class="quote">ソフトウェア</span>」</span> フローコントロールとも呼ばれる))
            を選びます。
            以下に続くソフトウェアの設定のために、
            ここでの設定を覚えておいてください。</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-software"></a>10.3.1.2. ソフトウェアの設定</h4></div></div></div><p>本節では FreeBSD の <span class="application">LPD</span>
	スプーリングシステムで印字をおこなうために
	必要となるソフトウェアの設定について説明しています。</p><p>本節の概要は次のようになります。</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>プリンタで使用するポートのために、必要があれば、
	    カーネルの書き変えをおこないます。「<a class="link" href="printing-intro-setup.html#printing-kernel" title="10.3.1.2.1. カーネルの変更">カーネルの変更</a>」で、
	    このためにしなくてはならないことを説明しています。</p></li><li class="step"><p>パラレルポートを使用している場合は、
	    パラレルポートのための通信モードを設定します。
	    詳細は、
	    「<a class="link" href="printing-intro-setup.html#printing-parallel-port-mode" title="10.3.1.3. パラレルポートの通信モードを設定する">
	      パラレルポートの通信モードを設定する</a>」
	    で説明しています。</p></li><li class="step"><p>オペレーティングシステムからプリンタにデータが送ら
	    れているかをテストします。「<a class="link" href="printing-intro-setup.html#printing-testing" title="10.3.1.4. プリンタとの通信状況を調べる">プリンタとの通信状況を調べる</a>」で、
	    どのようにテストするかの提案をいくつかおこなっています。</p></li><li class="step"><p>ファイル<code class="filename">/etc/printcap</code>を変更し、
	    <span class="application">LPD</span> の設定をおこないます。
	    この節で、どのように変更するかを説明しています。</p></li></ol></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-kernel"></a>10.3.1.2.1. カーネルの変更</h5></div></div></div><p>オペレーティングシステムのカーネルの
	  コンパイルをおこなうことによって、
	  指定されたデバイスが機能するようになります。シリアル、
	  または、パラレルインタフェースをプリンタで使用する場合、
	  必要なデバイスがこの指定の中に含まれていなくてはなりません。
	  したがって、
	  必要なデバイスがカーネルに組み込まれていない場合、
	  追加のシリアル、または、パラレルポートをサポートするために、
	  カーネルの再コンパイルが必要となるかもしれません。</p><p>シリアルポートが現在使用しているカーネルで
	  サポートされているかどうかを調べるためには、
	  次のように入力します。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>grep sioN /var/run/dmesg.boot</code></strong></pre><p>ここで、<em class="replaceable"><code>N</code></em>
	  はシリアルポートの番号を示し、この番号は 0 から始まります。
	  次のような出力があった場合、
	  カーネルはそのポートをサポートしています。</p><pre class="screen">sio2 at port 0x3e8-0x3ef irq 5 on isa
 sio2: type 16550A</pre><p>パラレルポートが現在使用しているカーネルで
	  サポートされているかどうかを調べるためには、
	  次のように入力します。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>grep ppcN /var/run/dmesg.boot</code></strong></pre><p>ここで、<em class="replaceable"><code>N</code></em>
	  はパラレルポートの番号を示し、この番号は 0 から始まります。
	  次のような出力があった場合、
	  カーネルはそのポートをサポートしています。</p><pre class="screen">ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
ppc0: SMC-like chipset (ECP/EPP/PS2/NIBBLE) in COMPATIBLE mode
ppc0: FIFO with 16/16/8 bytes threshold</pre><p>上記の出力が得られない場合、プリンタを使うため、
	  オペレーティングシステムにパラレル、または、
	  シリアルポートを認識し、使用できるようにするためには
	  カーネルを変更する必要があります。</p><p>シリアルポートをサポートさせるには、「<a class="link" href="kernelconfig.html" title="第9章 FreeBSD カーネルのコンフィグレーション">
	    FreeBSD カーネルのコンフィグレーション</a>」の節をご覧く
	  ださい。パラレルポートをサポートさせる場合も、その節と、
	  <span class="emphasis"><em>あわせて</em></span>、
	  この節に続く節もご覧ください。</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-parallel-port-mode"></a>10.3.1.3. パラレルポートの通信モードを設定する</h4></div></div></div><p>パラレルインタフェースを使用している場合、FreeBSD では、
	    割り込み駆動型にするか、
	    プリンタとの通信の状況をカーネルに監視させるかのいずれかを選択できます。
	    FreeBSD の汎用プリンタデバイスドライバ
	    (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpt&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">lpt</span>(4)</span></a>) は <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppbus&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ppbus</span>(4)</span></a> システムを利用しています。
	    これは <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ppc</span>(4)</span></a>
	    ドライバを使ってパラレルポートのチップセットを制御します。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>GENERIC
		カーネルでは<span class="emphasis"><em>割り込み駆動</em></span>方式がデフォルトになっています。
		この方式では、
		オペレーティングシステムはプリンタがデータを受け付けられるかどうかを調べるために、
		IRQ ラインを一つ使用します。</p></li><li class="listitem"><p><span class="emphasis"><em>監視</em></span>方式では、
		オペレーティングシステムにプリンタがもっとデータを受け付けられるかどうかを繰り返し尋ねるように指示します。
		そして、受け付けるという応答を受けたとき、
		カーネルはさらなるデータを送信します。</p></li></ul></div><p>割り込み駆動方式は一般的にいくらか高速になりますが、貴重な
	    IRQ ラインを一つ消費します。
	    HP の新しいプリンタの一部には、明らかに何かしらのタイミングの問題
	    (まだ正確にはわかっていません)
	    で割り込みモードでは正常に動作しないものがあると言われています。
	    これらのプリンタにはポーリングモードが必要になります。
	    どちらかうまく機能する方を使ってください。
	    一部のプリンタはどちらの方式でも動作しますが、
	    割り込みモードでは苦痛を感じるほど低速です。</p><p>通信モードを設定するためには 2 つの方法があります。
	    1 つはカーネルを変更することで、もう一つは
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lptcontrol</span>(8)</span></a> プログラムを使用する方法です。</p><p><span class="emphasis"><em> カーネルを設定することによって、
	      通信モードを変更する。</em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>カーネルコンフィグレーションファイルを変更します。
		<code class="literal">ppc0</code> のエントリを探してください。
		2 番目のパラレルポートを設定するときは、代わりに
		<code class="literal">ppc1</code> を使います。
		以下、3 番目のポートは <code class="literal">ppc2</code> となっていきます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>割り込み駆動方式にする場合は、
		    <code class="filename">/boot/device.hints</code>
		    ファイルの以下の行を編集して、
		    <em class="replaceable"><code>N</code></em> を適切な
		    IRQ 番号に置き換えてください。</p><pre class="programlisting">hint.ppc.0.irq="<em class="replaceable"><code>N</code></em>"</pre><p>カーネルの設定ファイルには <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ppc</span>(4)</span></a>
		    ドライバも入れなければなりません。</p><pre class="screen">device ppc</pre></li><li class="listitem"><p>ポーリングモードを使用する場合は、
		    <code class="filename">/boot/device.hints</code>
		    ファイルの以下の行を削除してください。</p><pre class="programlisting">hint.ppc.0.irq="<em class="replaceable"><code>N</code></em>"</pre><p>場合によっては、これだけでは FreeBSD
		    でポートをポーリングモードにするには十分ではないことがあります。
		    多くの場合これは <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">acpi</span>(4)</span></a> ドライバと併せて動作します。
		    これはデバイスのプローブとアタッチを行うので、
		    プリンタポートへのアクセスモードを制御できます。
		    問題を修正するために <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">acpi</span>(4)</span></a>
		    の設定を確認してください。</p></li></ul></div></li><li class="step"><p>ファイルをセーブし、config プログラムを起動し、
		カーネルの構築、インストールをおこないます。そして、
		リブートしてください。詳細は、「<a class="link" href="kernelconfig.html" title="第9章 FreeBSD カーネルのコンフィグレーション">
		  FreeBSDカーネルのコンフィグレーション</a>」を参照
		してください。</p></li></ol></div><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lptcontrol</span>(8)</span></a> <span class="emphasis"><em>
	      で通信モードを設定する場合</em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p><code class="literal">lptN</code>
		をイベント駆動方式に設定する場合は、
		次のように入力します。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptcontrol -i -d /dev/lptN</code></strong></pre></li><li class="step"><p><code class="literal">lptN</code>
		を監視方式に設定する場合は、次のように入力します。
	      </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptcontrol -p -d /dev/lptN</code></strong></pre></li></ol></div><p>これらのコマンドを <code class="filename">/etc/rc.local</code>
	    ファイルに追加
	    しておくと、システムをブートする度に通信モードを設定する
	    ことができます。詳細については、
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lptcontrol</span>(8)</span></a> をご覧ください。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-testing"></a>10.3.1.4. プリンタとの通信状況を調べる</h4></div></div></div><p>スプーリングシステムの設定に進む前に、オペレーティング
	    システムがプリンタにデータを送ることに成功しているかどうか
	    を確かめるべきでしょう。これにより、印字がうまくいかないと
	    き、プリンタとの通信が問題なのか、スプーリングシステムが問
	    題なのかを分けて調べることがかなり容易になります。</p><p>プリンタをテストするためには、
	    プリンタに何かのテキストを送
	    信してみます。送信した文字をすぐに印字してくれるプリンタに
	    は、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a> コマンドを使うと有用です。このコマンドは印
	    字可能な 96 文字の ASCII 文字すべてを 96 行生成します。</p><a id="idp86157008" class="indexterm"></a><p><span class="trademark">PostScript</span>® (または他の言語に対応した) プリンタの場合
	    は、もっと巧妙なテストが必要になります。次のような、簡単な
	    <span class="trademark">PostScript</span>® プログラムを使えば十分でしょう。</p><pre class="programlisting">%!PS
100 100 moveto 300 300 lineto stroke
310 310 moveto
/Helvetica findfont 12 scalefont setfont
(Is this thing working?) show
showpage</pre><p>上の <span class="trademark">PostScript</span>® コードはファイルに保存し、
            以降の節で例として示されているように利用することができます。</p><a id="idp86160208" class="indexterm"></a><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">このドキュメントでプリンタ用言語を参照するときは、
	      <span class="trademark">PostScript</span>® のような言語を仮定しており、Hewlett Packard
	      の PCL は考慮していません。PCL は非常に機能的なの
	      ですが、
	      プレインテキストにエスケープシーケンスを混ぜること
	      ができます。<span class="trademark">PostScript</span>® ではプレインテキストを直接印字
	      することはできません。
	      このような種類のプリンタ言語に対しては、
	      特別な対応をおこなわなければなりません。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-checking-parallel"></a>10.3.1.4.1. パラレルポートのプリンタとの接続を調べる</h5></div></div></div><p>この節では、FreeBSD がパラレル<a id="idp86163536" class="indexterm"></a>ポートに接続されたプリ
	      ンタと通信できているかどうかを調べる方法について説明し
	      ています。</p><p><span class="emphasis"><em>
		パラレルポートのプリンタをテストするために
	      </em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=su&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">su</span>(1)</span></a> コマンドで <code class="systemitem">root</code> になります。</p></li><li class="step"><p>プリンタにデータを送ります。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>プリンタがプレインテキストを印字できる場合、
		      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a> コマンドを使います。
		      次のように入力してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptest &gt; /dev/lptN</code></strong></pre><p>ここで、<em class="replaceable"><code>N</code></em>
		      はパラレルポートの番号で、番号は
		      0 から始まります。</p></li><li class="listitem"><p>プリンタが <span class="trademark">PostScript</span>® か他のプリンタ
		      言語を使用している場合、そのプリンタに簡単なプロ
		      グラムを送信してください。次のように入力します。
		    </p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cat &gt; /dev/lptN</code></strong></pre><p>そして、一行一行、
		      プログラムを<span class="emphasis"><em>慎重に</em></span>入力して
		      下さい。RETUREN または ENTER キーを入力してしま
		      うと、その行は編集できなくなります。プログラムの
		      入力が終わったら、CONTROL+D か、あなたが設定して
		      いるファイル終了のキーを押してください。</p><p>もしくは、プログラムを入力したファイルがある
		      場合は、次のように入力してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cat file &gt; /dev/lptN</code></strong></pre><p>ここで、<em class="replaceable"><code>file</code></em>
		      はプログラムが格納されていて、
		      プリンタに送信するファイルの名前です。</p></li></ul></div></li></ol></div><p>これで何かが印刷されるはずです。
	      印字されたテキストがおかしくても心配は無用です。
	      それについては、後で修正します。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-checking-serial"></a>10.3.1.4.2. シリアルポートのプリンタとの接続を調べる</h5></div></div></div><a id="idp86186320" class="indexterm"></a><p>この節では、FreeBSD がシリアルポートに接続されたプリ
	      ンタと通信できているかどうかを調べる方法について述べられ
	      ています。</p><p><span class="emphasis"><em>
		シリアルポートのプリンタをテストするために
	      </em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=su&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">su</span>(1)</span></a> コマンドで <code class="systemitem">root</code> になります。</p></li><li class="step"><p><code class="filename">/etc/remote</code>
		  ファイルを編集します。次のエントリを加えてください。
		</p><pre class="programlisting">printer:dv=<code class="filename">/dev/port</code>:br#<em class="replaceable"><code>bps-rate</code></em>:pa=<em class="replaceable"><code>parity</code></em></pre><a id="idp86197072" class="indexterm"></a><a id="idp86197584" class="indexterm"></a><a id="idp86198096" class="indexterm"></a><p>ここで、<em class="replaceable"><code>port</code></em>
		  シリアルポート (<code class="literal">ttyu0</code>、
		  <code class="literal">ttyu1</code> など) のデバイスエントリで、
		  <em class="replaceable"><code>bps-rate</code></em>は
		  プリンタとの通信の転送速度[bit/秒]、
		  <em class="replaceable"><code>parity</code></em>はプリ
		  ンタとの通信で必要とされるパリティ
		  (<code class="literal">even</code>、<code class="literal">odd</code>、
		  <code class="literal">none</code>、
		  <code class="literal">zero</code>のいずれか) を表わしていま
		  す。</p><p>次の例は、
		  プリンタをシリアルケーブルでパリティなし、転送速度
		  19200 bps で第 3 番目のシリアルポートに接続した場
		  合です。</p><pre class="programlisting">printer:dv=<code class="filename">/dev/ttyu2</code>:br#19200:pa=none</pre></li><li class="step"><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a> コマンドでプリンタと接続します。
		  次のように入力してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>tip printer</code></strong></pre><p>これがうまくいかなかった場合は、
		  <code class="filename">/etc/remote</code>を編集して、
		<code class="filename">/dev/ttyuN</code>
		  の代わりに
		  <code class="filename">/dev/cuaaN</code>
		  を試してみてください。</p></li><li class="step"><p>プリンタにデータを送ります。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>プリンタがプレインテキストを印字できる場合、
		      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a> コマンドを使います。
		      次のように入力してください。</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>$lptest</code></strong></pre></li><li class="listitem"><p>プリンタが <span class="trademark">PostScript</span>® か他のプリンタ言語を使用している場合、
		      そのプリンタに簡単なプログラムを入力します。
		      一行一行、プログラムを<span class="emphasis"><em>慎重に</em></span>入力してください。
		      バックスペースキーや他の編集用のキーは、
		      プリンタの制御コードに割り当てられているかもしれません。
		      プログラムが終了したことをプリンタに伝えるための特別なファイル終了キーを
		      入力する必要があるかもしれません。
		      <span class="trademark">PostScript</span>® プリンタの場合、
		      <code class="literal">CONTROL+D</code> を入力します。</p><p>もしくは、プログラムを入力したファイルがある場合は、
		      次のように入力してください。</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>&gt;file</code></strong></pre><p>ここで、<em class="replaceable"><code>file</code></em>
		      はプログラムが格納されているファイル名です。
		      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a> コマンドでファイルを送信した後は、
		      ファイル終了を表わすキーを入力する必要があります。</p></li></ul></div></li></ol></div><p>これで何かがプリントされることでしょう。
	      印字されたテキ
	      ストがおかしくても心配しなくても構いません。
	      それについては、後で修正します。</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-printcap"></a>10.3.1.5. スプーラに許可を与える:
	  <code class="filename">/etc/printcap</code> ファイル</h4></div></div></div><p>ここまでで、プリンタはコンピュータに接続され、(必要なら)
	  プリンタと通信できるようにカーネルを変更し、
	  簡単なデータをプリンタに送信することができているはずです。
	  これで、<span class="application">LPD</span> にプリンタへのアクセスを
	  制御させる設定をおこなう準備が整いました。</p><p><span class="application">LPD</span> の設定は
	  <code class="filename">/etc/printcap</code> を編集することでおこないます。
	  <span class="application">LPD</span> スプーリングシステムは
	  スプーラが使われる毎にこのファイルを参照します。
	  そのため、ファイルを更新するとすぐにその変更が反映されます。</p><a id="idp86220880" class="indexterm"></a><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=printcap&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">printcap</span>(5)</span></a> ファイルの書式は簡単です。
	  <code class="filename">/etc/printcap</code>
	  の編集はお好みのテキストエディタをお
	  使いください。このファイルの書式は、
	  <code class="filename">/usr/share/misc/termcap</code> や
	  <code class="filename">/etc/remote</code>
	  といった他のケイパビリティファイルと一致しています。
	  この書式
	  についての詳細な情報については
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cgetent&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">cgetent</span>(3)</span></a> をご覧ください。</p><p>スプーラの単純な設定法は、
	  次のステップでおこないます。</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>プリンタに名前 (と簡単な別名 2 〜 3 個) を付け、それを
	      <code class="filename">/etc/printcap</code> ファイルに記述します。
	      これについては、「<a class="link" href="printing-intro-setup.html#printing-naming" title="10.3.1.5.1. プリンタに名前を付ける">
		プリンタに名前を付ける</a>」
	      を参照してください。</p></li><li class="step"><p><code class="literal">sh</code> の項目を追加することで、
	      ヘッダページ<a id="idp86236496" class="indexterm"></a>の出力を禁止します (デフォルトは許可)。
	      これについては、「<a class="link" href="printing-intro-setup.html#printing-no-header-pages" title="10.3.1.5.2. ヘッダページの印字を禁止する">
		ヘッダページの印字を禁止する</a>」
	      を参照してください。</p></li><li class="step"><p>スプール用のディレクトリを作成し、その位置を
	      <code class="literal">sd</code> 項目で指定します。これについては、
	      「<a class="link" href="printing-intro-setup.html#printing-spooldir" title="10.3.1.5.3. スプーリングディレクトリの作成">
		スプーリングディレクトリの作成</a>」
	      を参照してください。</p></li><li class="step"><p>プリンタを使用するために <code class="filename">/dev</code>
	      エントリを設定し、<code class="filename">/etc/printcap</code> の
	      <code class="literal">lp</code> 項目でそのエントリを指定します。
	      これについては、「<a class="link" href="printing-intro-setup.html#printing-device" title="10.3.1.5.4. プリンタデバイスの特定">
		プリンタデバイスの特定</a>」 を参照してください。
	      プリンタをシリアルポートに接続した場合は、
	      <code class="literal">ms#</code>
	      の項目を設定する必要があります。こちらについては、
	      「<a class="link" href="printing-intro-setup.html#printing-commparam" title="10.3.1.5.5. スプーラのための通信パラメータの設定">
		スプーラのための通信パラメータの設定</a>」
	      を参照してください。</p></li><li class="step"><p>プレインテキスト用の入力フィルタのインストールをおこないます。
	    「<a class="link" href="printing-intro-setup.html#printing-textfilter" title="10.3.1.5.6. テキストフィルタのインストール">テキストフィルタのインストール</a>」
	      を参照してください。</p></li><li class="step"><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a>
	      コマンドで何かを印字することで設定のテストをおこないます。
	    <a class="link" href="printing-intro-setup.html#printing-trying" title="10.3.1.5.8. 印字してみよう">印字してみよう</a> と
	    <a class="link" href="printing-troubleshooting.html" title="10.7. トラブルシューティング">トラブルシューティング</a>
	    を参照してください。</p></li></ol></div><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><span class="trademark">PostScript</span>® プリンタのような、
	    プリンタ言語を使用しているプリンタには、
	    プレインテキストを直接印字させることができません。
	    上にアウトラインを示し、
	    以下の節で説明する簡単な設定方法の説明では、
	    そのようなプリンタを設置している場合は、
	    プリンタが認識できるファイルだけを印字の対象としているという
	    仮定をしています。</p></div><p>多くの場合、
	  利用者はシステムに設置されているプリンタすべてで
	  プレインテキストが印字できることを期待しています。
	  印字作業をおこなうために <span class="application">LPD</span>
	  のインタフェースを利用するプログラムでも、
	  通常、そのような仮定を置きます。
	  プリンタ言語を使用するプリンタを設置しており、
	  そのプリンタ言語で記述されたジョブと、
	  <span class="emphasis"><em>これに加えて</em></span>、
	  プレインテキストのジョブも印字できるようにしたいならば、
	  上で示した簡単な設定方法に加えて、
	  さらなる設定をおこなうことを強くお勧めします。すなわち、
	  自動的にプレインテキストから <span class="trademark">PostScript</span>® (もしくは、
	  他のプリンタ言語)
	  に変換するプログラムをインストールしてください。「<a class="link" href="printing-advanced.html#printing-advanced-if-conversion" title="10.4.1.2. プレインテキストのジョブを PostScript® プリンタで印字する">
	    プレインテキストのジョブを <span class="trademark">PostScript</span>®
	    プリンタで印字する</a>」
	  で、それをどのようにおこなえばよいのかが説明されています。</p><div xmlns="" class="note"><h3 class="admontitle">訳注: </h3><p xmlns="http://www.w3.org/1999/xhtml">
	    日本語を印字したい場合は、プリンタ言語を使用し
	    ていない「日本語プリンタ」についても、
	    プリンタ固有のエスケープシーケンスを送る必要があります。
	    また、漢字コードをプリン
	    タが設定しているものに変換したりする必要があり、
	    各プリンタ毎に、日本語用のフィルタが必要になります。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-naming"></a>10.3.1.5.1. プリンタに名前を付ける</h5></div></div></div><p>最初の (簡単な) ステップで、プリンタの名前を考えます。
	    プリンタには別名をいくつか付けることもできるので、
	    機能的な名前
	    でも風変わりな名前でもどちらを選んでもまったく
	    問題はありません。</p><p>少なくとも1つのプリンタには、
	    <code class="filename">/etc/printcap</code> の中で、
	    <code class="literal">lp</code> という別名を持たせるべきでしょう。
	    この名前はデフォルトのプリンタ名になっています。
	    ユーザが環境変数 <code class="envar">PRINTER</code> を設定しておらず、
	    かつ、<span class="application">LPD</span> コマンドのコマンドラインで
	    プリンタの名前が指定されていない場合、<code class="literal">lp</code>
	    がデフォルトのプリンタ名となり、
	    そのプリンタに出力されます。</p><p>それから、これは共通の慣習ですが、
	    プリンタの最後の別名には、
	    メーカーやモデル名を含むプリンタの完全な名称をつけることに
	    なっています。</p><p>名前と別名のいくつかを決めたら、
	    <code class="filename">/etc/printcap</code> ファイルに設定します。
	    プリンタ名は一番左のカラムから書き始めます。
	    別名はそれぞれ縦棒によって区切られ、
	    最後の別名の後ろにコロンを置きます。</p><p>次の例では、2 台のプリンタ (Diablo 630 ラインプリンタと
	    Panasonic KX-P4455 <span class="trademark">PostScript</span>® レーザライタプリンタ) が定義
	    されている <code class="filename">/etc/printcap</code>
	    のスケルトンを記しています。</p><pre class="programlisting">#
#  /etc/printcap for host rose
#
rattan|line|diablo|lp|Diablo 630 Line Printer:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:</pre><p>この例では、最初のプリンタに <code class="literal">rattan</code>
	    という名前と別名として、<code class="literal">line</code>、
	    <code class="literal">diablo</code>、<code class="literal">lp</code> そして
	    <code class="literal">Diablo 630 Line Printer</code>
	    が付けられています。別名とし て <code class="literal">lp</code>
	    があるので、このプリンタはデフォルトのプリンタとなっ
	    ています。2 番目は <code class="literal">bamboo</code> と名付けられ、
	    別名として、<code class="literal">ps</code> と
	    <code class="literal">PS</code>、<code class="literal">S</code>、
	    <code class="literal">panasonic</code>、<code class="literal">Panasonic KX-P4455
	      PostScript v51.4</code> が付けられています。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-no-header-pages"></a>10.3.1.5.2. ヘッダページの印字を禁止する</h5></div></div></div><a id="idp86268752" class="indexterm"></a><p><span class="application">LPD</span> スプーリングシステムでは、
	    デフォルトでジョブ毎に
	    <span class="emphasis"><em>ヘッダページ</em></span>を印字します。
	    ヘッダページにはジョブを要求したユーザ名、
	    ジョブが送られたホスト名、そして、ジョブの名前が素晴
	    らしい大きな文字で印字されています。
	    残念なことに、この余分なテキストすべてが、
	    簡単なプリンタ設定法のデバッグの際に紛れ込んできてしまいます。
	    このため、ヘッダページの出力を禁止しておきます。</p><p>ヘッダページの出力を禁止するには、
	    <code class="filename">/etc/printcap</code>
	    にあるプリンタのエントリに <code class="literal">sh</code>
	    の項目を追加します。次に、<code class="literal">sh</code> を加えた
	    <code class="filename">/etc/printcap</code> の例を示します。</p><pre class="programlisting">#
#  /etc/printcap for host rose - no header pages anywhere
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:</pre><p>この書式を正しく使うための注意をしておきます。
	    最初の行は左端のカラムから始めます。
	    それに続く行は字下げします。最後の行以外のすべての行は、
	    行末にバックスラッシュを記述します。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-spooldir"></a>10.3.1.5.3. スプーリングディレクトリの作成</h5></div></div></div><a id="idp86286928" class="indexterm"></a><a id="idp86287440" class="indexterm"></a><p>スプーラの簡単な設定の次のステップでは、
	    <span class="emphasis"><em>スプーリングディレクトリ</em></span>を作成します。
	    プリンタに送られるジョブは、
	    その印字が終了するまでこのディレクトリに置かれます。また、
	    他のたくさんのスプーラもこのディレクトリにファイルを置きます。</p><p>様々な事情によりスプーリングディレクトリは、通常、慣例
	    として <code class="filename">/var/spool</code> の下に置きます。
	    また、スプーリングディレクトリの内容は
	    バックアップをする必要はありません。
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mkdir&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">mkdir</span>(1)</span></a> によってディレクトリを
	    作るだけでスプーリングディレクトリの復旧は完了します。
	  </p><p>スプーリングディレクトリの名前は、これも慣例ですが、
	    次のようにプリンタの名前と同じにします。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/printer-name</code></strong></pre><p>しかしながら、ネットワーク上に使用可能なプリンタがたく
	    さんあるならば、<span class="application">LPD</span>
	    で印字するための専用のディレクトリにスプーリングディレクトリを置きたくなるかもしれません。
	    例に出てきたプリンタ <code class="literal">rattan</code> と
	    <code class="literal">bamboo</code> について、この方式を採用すると、
	    次のようになります。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/lpd</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/lpd/rattan</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/lpd/bamboo</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">各ユーザが印字するジョブのプライバシを守りた
	      いと考えているならば、スプーリングディレクトリを保護し
	      て、これを誰からでもアクセスできないようにしたいと思う
	      かもしれません。スプーリングディレクトリは、
	      <code class="systemitem">daemon</code> ユーザと
	      <code class="systemitem">daemon</code> グループに所有され、
	      読み込み、書き込み、検
	      索可能であり、他からはアクセスできないようにするべきで
	      す。例題のプリンタに対して、次のようにすることにしましょ
	      う。</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chown daemon:daemon /var/spool/lpd/rattan</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chown daemon:daemon /var/spool/lpd/bamboo</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chmod 770 /var/spool/lpd/rattan</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chmod 770 /var/spool/lpd/bamboo</code></strong></pre></div><p>最後に、<code class="filename">/etc/printcap</code> ファイルで、
	    これらのディレクトリの位置を
	    <span class="application">LPD</span> に伝える必要があります。
	    スプーリングディレクトリのパス名は <code class="literal">sd</code>
	    項目で指定します。</p><pre class="programlisting">#
#  /etc/printcap for host rose - added spooling directories
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<code class="filename">/var/spool/lpd/rattan</code>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<code class="filename">/var/spool/lpd/bamboo</code>:</pre><p>プリンタ名が最初のカラムから始まっており、
	    そのプリンタに関して記述される他の項目は字下げされていること、
	    各行がバックスラッシュで終わっていることに注意してください。</p><p><code class="literal">sd</code>
	    によりスプーリングディレクトリが指定されていない場合、
	    スプーリングシステムは
	    <code class="filename">/var/spool/lpd</code>
	    をデフォルト値として使用します。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-device"></a>10.3.1.5.4. プリンタデバイスの特定</h5></div></div></div><p><a class="link" href="printing-intro-setup.html#printing-hardware" title="10.3.1.1. プリンタ機器の設定">プリンタ機器の設定</a>
	    の節では、FreeBSD でプリンタとの通信に使用されるポートおよび
	    <code class="filename">/dev</code>
	    ディレクトリ内のエントリを特定します。
	    そして、<span class="application">LPD</span> にその情報を伝えます。
	    印字するジョブを受け取ると、スプーリングシステムは、
	    (プリンタにデータを渡す義務がある)
	    フィルタプログラムに代わって指定されたデバイスをオープンします。</p><p><code class="filename">/etc/printcap</code> ファイルで
	    <code class="literal">lp</code> 項目を使って
	    <code class="filename">/dev</code> エントリを記入します。</p><p>ここでの例では、<code class="literal">rattan</code>
	    は 1 番目のパラレルポートに、<code class="literal">bamboo</code>
	    は 6 番目のシリアルポートに接続されていることにしましょう。
	    このとき、<code class="filename">/etc/printcap</code> には
	    次のようになります。</p><pre class="programlisting">#
#  /etc/printcap for host rose - identified what devices to use
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<code class="filename">/var/spool/lpd/rattan</code>:\
        :lp=<code class="filename">/dev/lpt0</code>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<code class="filename">/var/spool/lpd/bamboo</code>:\
        :lp=<code class="filename">/dev/ttyu5</code>:</pre><p><code class="filename">/etc/printcap</code> でプリンタの
	    <code class="literal">lp</code> 項目が指定されていない場合は、
	    <span class="application">LPD</span>
	    はデフォルトとして <code class="filename">/dev/lp</code>
	    を使用します。<code class="filename">/dev/lp</code> は、現在の
	    FreeBSD には存在していません。</p><p>設置したプリンタがパラレルポートに
	    接続されている場合は、
	    「<a class="link" href="printing-intro-setup.html#printing-textfilter" title="10.3.1.5.6. テキストフィルタのインストール">
	      テキストフィルタのインストール</a>」
	    まで読み飛ばしてください。
	    そうでない場合は、次節の説明に続いてください。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-commparam"></a>10.3.1.5.5. スプーラのための通信パラメータの設定</h5></div></div></div><a id="idp86320720" class="indexterm"></a><p>シリアルポートにプリンタを接続した場合、
	    <span class="application">LPD</span>
	    は、プリンタにデータを送信するフィルタプログラムに代わり、
	    通信速度やパリティ、
	    その他のシリアル通信パラメータを設定することができます。
	    このことによる利点は、</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">/etc/printcap</code>
		を編集するだけで、
		様々な通信パラメータを試してみることができます。
		フィルタプログラムを再コンパイルする必要はありません。</p></li><li class="listitem"><p>スプーリングシステムで、
		シリアル通信の設定が異なっているかもしれない複数のプリンタに
		同じフィルタプログラムを使うことが可能になります。</p></li></ul></div><p>次の <code class="filename">/etc/printcap</code> の項目で、
	    <code class="literal">lp</code> で指定された
	    デバイスのシリアル通信パラメータを制御できます。</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">
		  br#bps-rate</code></span></dt><dd><p>デバイスの通信速度を
		  <em class="replaceable"><code>bps-rate</code></em> に設定します。
		  ここで、<em class="replaceable"><code>bps-rate</code></em> は 50,
		  75, 110, 134, 150, 200, 300, 600, 1200, 1800, 2400,
		  4800, 9600, 19200, 38400, 57600, 115200 [bit/秒]
		  のいずれかです。</p></dd><dt><span class="term"><code class="literal">ms#stty-mode</code></span></dt><dd><p>デバイスをオープンした後にターミナルデバイスのオプションを設定します。
		  利用できるオプションについては <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stty&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stty</span>(1)</span></a> を参照してください。</p></dd></dl></div><p><code class="literal">lp</code> で指定されたデバイスをオープンするとき、
	    <span class="application">LPD</span> は <code class="literal">ms#</code>
	    で指定されたデバイスの特性を設定します。
	    特に関係があるのは、<code class="literal">parenb</code>,
	    <code class="literal">parodd</code>, <code class="literal">cs5</code>,
	    <code class="literal">cs6</code>, <code class="literal">cs7</code>,
	    <code class="literal">cs8</code>, <code class="literal">cstopb</code>,
	    <code class="literal">crtscts</code>, <code class="literal">ixon</code>
	    モードです。
	    これらは <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stty&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stty</span>(1)</span></a> のマニュアルページで説明されています。</p><p>例題のプリンタで6番目のシリアルポートに接続された
	    プリンタの設定を追加してみましょう。
	    通信速度は 38400bps に設定します。
	    モードとして、<code class="literal">-parenb</code> でパリティ無し、
	    <code class="literal">cs8</code> で 8 ビットキャラクタ、
	    <code class="literal">clocal</code> でモデム制御無し、
	    そして <code class="literal">crtscts</code>
	    でハードウェアフロー制御を設定します。</p><pre class="programlisting">bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<code class="filename">/var/spool/lpd/bamboo</code>:\
        :lp=<code class="filename">/dev/ttyu5</code>:ms#-parenb cs8 clocal crtscts:</pre></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-textfilter"></a>10.3.1.5.6. テキストフィルタのインストール</h5></div></div></div><a id="idp86353616" class="indexterm"></a><p>ここまでで、
	    プリンタにジョブを送るために使うテキストフィルタを
	    <span class="application">LPD</span> に設定する準備が整いました。
	    <span class="emphasis"><em>テキストフィルタ</em></span>とは、
	    <span class="emphasis"><em>入力フィルタ</em></span>としても知られていますが、
	    印字するジョブがあるときに
	    <span class="application">LPD</span> が起動するプログラムです。
	    <span class="application">LPD</span>
	    がプリンタのためにテキストフィルタを起動するとき、
	    <span class="application">LPD</span>
	    はフィルタの標準入力からプリントするジョブを入力し、
	    フィルタの標準出力に項目 <code class="literal">lp</code>
	    で指定されたプリンタデバイスを接続します。フィルタは、
	    標準入力からジョブを読み込み、
	    プリンタのための必要な変換をおこなった後、
	    その結果を標準出力に出力する、
	    これにより印字がなされることを期待されています。
	    テキストフィルタについての更に詳しい情報については、「<a class="link" href="printing-advanced.html#printing-advanced-filters" title="10.4.1.1. フィルタはどのように機能しているか">
	      フィルタはどのように機能しているか</a>」
	    をご覧ください。</p><p>ここでの簡単なプリンタ設定では、
	    プリンタにジョブを送るため、<code class="command">/bin/cat</code>
	    を実行するだけの簡単なシェルスクリプトで間に合います。
	    FreeBSD に標準で付属している <code class="command">lpf</code>
	    というフィルタでは、バックスペース文字を使った
	    下線引きの動作をおこなう文字ストリームをうまく扱うことができない
	    プリンタのための代替処理をおこなってくれます。
	    もちろん、
	    他のどんなフィルタプログラムを使っても構いません。
	    フィルタ <code class="filename">lpf</code> については、「<a class="link" href="printing-advanced.html#printing-advanced-lpf" title="10.4.1.6. テキストフィルタ lpf">テキストフィルタ
	      lpf</a>」で詳しく説明します。</p><p>最初に、簡単なテキストフィルタであるシェルスクリプト
	    <code class="filename">/usr/local/libexec/if-simple</code>
	    を作ってみましょう。
	    次のテキストをお好みのテキストエディタでファイルに
	    書き込んでください。</p><pre class="programlisting">#!/bin/sh
#
# if-simple - Simple text input filter for lpd
# Installed in /usr/local/libexec/if-simple
#
# Simply copies stdin to stdout.  Ignores all filter arguments.

/bin/cat &amp;&amp; exit 0
exit 2</pre><p>そして、このファイルを実行可能にします。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chmod 555 /usr/local/libexec/if-simple</code></strong></pre><p>LPD
	    にこのテキストフィルタを使うことを設定するためには、
	    <code class="filename">/etc/printcap</code> に
	    <code class="literal">if</code> 項目を使って指定します。これまでの
	    <code class="filename">/etc/printcap</code> の例のプリンタ 2 台に、
	    このフィルタを加えてみましょう。</p><pre class="programlisting">#
#  /etc/printcap for host rose - added text filter
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<code class="filename">/var/spool/lpd/rattan</code>:\ :lp=<code class="filename">/dev/lpt0</code>:\
        :if=<code class="filename">/usr/local/libexec/if-simple</code>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<code class="filename">/var/spool/lpd/bamboo</code>:\
        :lp=<code class="filename">/dev/ttyu5</code>:ms#-parenb cs8 clocal crtscts:\
        :if=<code class="filename">/usr/local/libexec/if-simple</code>:</pre><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="filename">if-simple</code>
	      スクリプトのコピーが <code class="filename">/usr/share/examples/printing</code>
	      ディレクトリにあります。</p></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86373328"></a>10.3.1.5.7. <span class="application">LPD</span> の起動</h5></div></div></div><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lpd</span>(8)</span></a> は <code class="literal">lpd_enable</code> 変数に従って
	    <code class="filename">/etc/rc</code> から実行されます。この変数の
	    デフォルト値は <code class="literal">NO</code> です。まだ
	    そうしていなかったならば</p><pre class="programlisting">lpd_enable="YES"</pre><p>の行を <code class="filename">/etc/rc.conf</code> に追加して
	    計算機を再起動するか、そのまま <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lpd</span>(8)</span></a> を
	    起動してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lpd</code></strong></pre></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-trying"></a>10.3.1.5.8. 印字してみよう</h5></div></div></div><p>簡単な <span class="application">LPD</span>
	    設定も終わりにたどり着きました。
	    残念ながら、設定はこれでおしまいというわけではありません。
	    なぜなら、さらに、設定をテストし、
	    すべての問題点を解決しなくてはならないからです。
	    設定をテストするために、
	    何かを印字してみましょう。
	    <span class="application">LPD</span> システムで印字をするためには、
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> コマンドを使います。このコマンドは、
	    印字するためのジョブを投入する働きをします。</p><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> コマンドを
	    「<a class="link" href="printing-intro-setup.html#printing-testing" title="10.3.1.4. プリンタとの通信状況を調べる">
	      プリンタとの通信状況を調べる</a>」で紹介した、
	    あるテスト用のテキストを生成してくれる
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a> プログラムと一緒に使うこともできます。</p><p><span class="emphasis"><em>簡単な <span class="application">LPD</span>
	      設定のテスト</em></span></p><p>次のように入力してください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptest 20 5 | lpr -Pprinter-name</code></strong></pre><p>ここで、<em class="replaceable"><code>printer-name</code></em>
	    は <code class="filename">/etc/printcap</code>
	    で指定したプリンタ名 (もしくはその別名) です。デフォルト
	    のプリンタを使用する場合は、
	    <code class="option">-P</code> 引数を付けないで
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> を打ち込んでください。もう一度述べますが、
	    <span class="trademark">PostScript</span>® を期待しているプリンタをテストするならば、
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a> を使う代わりに <span class="trademark">PostScript</span>® で書かれた
	    プログラムをプリンタに送ってください。
	    プログラムを送るためには、プログラムをファイルに格納して、
	    <code class="command">lpr file</code>
	    と打ち込みます。</p><p><span class="trademark">PostScript</span>® プリンタの場合、
	    送信したプログラムによる結果が得られるでしょう。
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a> を使った場合は、
	    以下のような結果が見られるでしょう。</p><pre class="screen">!"#$%&amp;'()*+,-./01234
"#$%&amp;'()*+,-./012345
#$%&amp;'()*+,-./0123456
$%&amp;'()*+,-./01234567
%&amp;'()*+,-./012345678</pre><p>更にプリンタをテストしたい場合は、
	    (言語ベースのプリンタのための) もっと大きなプログラムを送信するか、
	    引数を変えて
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a> を実行します。たとえば、<code class="command">lptest
	      80 60</code> で、それぞれ 80 文字の行を 60
	    行生成します。</p><p>プリンタがうまく動かなかった場合は、次の節、「<a class="link" href="printing-troubleshooting.html" title="10.7. トラブルシューティング">
	      トラブルシューティング</a>」をご覧ください。</p></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="printing-intro-spooler.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="printing.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="printing-advanced.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">10.2. はじめに〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓10.4. プリンタ設定上級編</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>