<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>22.7. ディスクレス稼働</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD ハンドブック" /><link rel="up" href="advanced-networking.html" title="第22章 高度なネットワーク" /><link rel="prev" href="network-nfs.html" title="22.6. NFS" /><link rel="next" href="network-isdn.html" title="22.8. ISDN" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">22.7. ディスクレス稼働</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-nfs.html">戻る</a>〓</td><th width="60%" align="center">第22章 高度なネットワーク</th><td width="20%" align="right">〓<a accesskey="n" href="network-isdn.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-diskless"></a>22.7. ディスクレス稼働</h2></div><div><span class="authorgroup">更新: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Dockès</span> <span class="firstname">Jean-François</span> [FAMILY Given]</span>. </span></div></div></div><p><span class="emphasis"><em>訳: 鈴木 康修 <code class="email">&lt;<a xmlns="" class="email" href="mailto:yasu@hike.te.chiba-u.ac.jp">yasu@hike.te.chiba-u.ac.jp</a>&gt;</code></em></span></p><a id="idp96103248" class="indexterm"></a><a id="idp96103760" class="indexterm"></a><p>FreeBSD マシンはネットワークを通じて起動でき、
      そして NFS サーバからマウントしたファイルシステムを使用して、
      ローカルディスクなしで動作することができます。
      標準の設定ファイルを変更する以上の、システムの修正は必要ありません。
      必要な要素のすべてが用意されているので、
      このようなシステムを設定するのは簡単です。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>ネットワークを通じてカーネルを読み込む方法は、
	  少なくとも二つあります。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><acronym class="acronym">PXE</acronym>: <span class="trademark">Intel</span>® の
	      Preboot Execution Environment システムは、
	      一部のネットワークカードまたはマザーボードに組み込まれた、
	      スマートなブート ROM の一形態です。
	      詳細については <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pxeboot&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pxeboot</span>(8)</span></a> を参照してください。</p></li><li class="listitem"><p>port の <span class="application">etherboot</span>
	      (<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/etherboot/pkg-descr">net/etherboot</a>) は、
	      ネットワークを通じてカーネルを起動する ROM
	      化可能なコードを提供します。
	      コードはネットワークカード上のブート PROM に焼き付けるか、
	      あるいはローカルフロッピー (ハード) ディスクドライブ、
	      または動作している <span class="trademark">MS-DOS</span>® システムから読み込むことができます。
	      多くのネットワークカードに対応しています。</p></li></ul></div></li><li class="listitem"><p>サンプルスクリプト
	  (<code class="filename">/usr/share/examples/diskless/clone_root</code>)
	  はサーバ上で、
	  ワークステーションのルートファイルシステムの作成と維持をやり易くします。
	  このスクリプトは少し書き換えないといけないでしょうが、
	  早く取り掛かれるようにします。</p></li><li class="listitem"><p>ディスクレスシステム起動を検知しサポートする標準のシステム起動ファイルが
	  <code class="filename">/etc</code> 内にあります。</p></li><li class="listitem"><p>必要なら、NFS
	  ファイルまたはローカルディスクのどちらかにスワップできます。</p></li></ul></div><p>ディスクレスワークステーションを設定する方法はいろいろあります。
      多くの要素が関わっており、
      その多くはローカルの状況に合わせてカスタマイズできます。下記は、
      単純さと標準の FreeBSD
      起動スクリプトとの互換性を強調した完全なシステムの設定を説明します。
      記述されているシステムの特徴は次のとおりです。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>ディスクレスワークステーションは、
	  共有された読み取り専用の
	  <code class="filename">ルート</code>ファイルシステムと、
	  共有された読み取り専用の
	  <code class="filename">/usr</code> を使用します。</p><p><code class="filename">ルート</code> ファイルシステムは、
	  標準的な FreeBSD (典型的にはサーバの) のルートのコピーで、
	  一部の設定ファイルが、ディスクレス稼働、
	  また場合によってはそのワークステーションに特有のもので上書きされています。</p><p>書き込み可能でなければならない <code class="filename">ルート</code>
	  の部分は <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mfs</span>(8)</span></a> ファイルシステムで覆われます。
	  システムが再起動するときにはすべての変更が失われるでしょう。</p></li><li class="listitem"><p>カーネルは DHCP (または BOOTP) および TFTP を用いて
	  <span class="application">etherboot</span> によって読み込まれます。</p></li></ul></div><div xmlns="" class="caution"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">記述されているとおり、
	このシステムは安全ではありません。
	ネットワークの保護された範囲で使用されるべきであり、
	他のホストから信頼されてはいけません。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96124496"></a>22.7.1. セットアップの手順</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96125136"></a>22.7.1.1. DHCP/BOOTP の設定</h4></div></div></div><a id="idp96125904" class="indexterm"></a><p>ネットワークを通じて設定を取得し、
	  ワークステーションを起動するために一般的に使用されるプロトコルには、
	  BOOTP と DHCP の 2 つがあります。
	  それらはワークステーションのブートストラップ時に何ヵ所かで使用されます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="application">etherboot</span>
	      はカーネルを見つけるために DHCP (デフォルト) または
	      BOOTP (設定オプションが必要) を使用します
	      (PXE は DHCP を使用します) 。</p></li><li class="listitem"><p>NFS ルートの場所を定めるためにカーネルは
	      BOOTP を使用します。</p></li></ul></div><p>BOOTP だけを使用するようにシステムを設定することもできます。
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bootpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">bootpd</span>(8)</span></a> サーバプログラムは
	  FreeBSD のベースシステムに含まれています。</p><p>しかしながら、DHCP には BOOTP に勝る点が多々あります。
	  (よりよい設定ファイル、PXE が使えること、
	  そしてディスクレス稼働には直接関係しない多くの長所)
	  ここでは BOOTP だけ利用する場合と、
	  BOOTP と DHCP を組み合わせた設定を扱います。特に ISC DHCP
	  ソフトウェアパッケージを利用する後者の方法に重点をおきます。</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96130896"></a>22.7.1.1.1. ISC DHCP を使用する設定</h5></div></div></div><a id="idp96131536" class="indexterm"></a><p><span class="application">isc-dhcp</span> サーバは、
	    BOOTP および DHCP リクエストの両方に答えることができます。</p><p>4.4-RELEASE の時点で <span class="application">isc-dhcp 3.0</span>
	    はベースシステムの一部では無くなりました。
	    まずはじめに
	    <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/isc-dhcp3-server/pkg-descr">net/isc-dhcp3-server</a> port
	    または対応する package をインストールする必要があるでしょう。
	    ports および package に関する一般的な情報については
	    <a class="xref" href="ports.html" title="第5章 アプリケーションのインストール - packages と ports">5章<em>アプリケーションのインストール - packages と ports</em></a> を参照してください。</p><p><span class="application">isc-dhcp</span> がインストールされると、
	    動作するために設定ファイルを必要とします
	    (通常 <code class="filename">/usr/local/etc/dhcpd.conf</code>
	    が指定されます) 。
	    下記にコメントを含めた例を示します。</p><pre class="programlisting">
          default-lease-time 600;
          max-lease-time 7200;
          authoritative;

          option domain-name "example.com";
          option domain-name-servers 192.168.4.1;
          option routers 192.168.4.1;

          subnet 192.168.4.0 netmask 255.255.255.0 {
            use-host-decl-names on; <a id="co-dhcp-host-name"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
            option subnet-mask 255.255.255.0;
            option broadcast-address 192.168.4.255;

            host margaux {
              hardware ethernet 01:23:45:67:89:ab;
              fixed-address margaux.example.com;
              next-server 192.168.4.4;<a id="co-dhcp-next-server"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>
              filename "/tftpboot/kernel.diskless";<a id="co-dhcp-filename"></a><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span>
              option root-path "192.168.4.4:/data/misc/diskless";<a id="co-dhcp-root-path"></a><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span>
            }
          }</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co-dhcp-host-name"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>このオプションは
		<code class="literal">host</code> 宣言の値を、
		ディスクレスホストへのホスト名として送るように
		<code class="command">dhcpd</code> に指示します。
		別の方法として、ホスト宣言内に
		<code class="literal">option host-name margaux</code>
		を加えるものがあります。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-dhcp-next-server"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>TFTP サーバを
		<code class="literal">next-server</code> ディレクティブに指定します
		(デフォルトは DHCP サーバと同じホストを使います)。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-dhcp-filename"><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span></a> </p></td><td valign="top" align="left"><p>カーネルとして
		<span class="application">etherboot</span> が読み込むファイルを
		<code class="literal">filename</code> ディレクティブに指定します。
		</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">PXE は相対的なファイル名を好むようです。
		    また、カーネルではなく <code class="command">pxeboot</code>
		    を読み込みます
		    (<code class="literal">option filename "pxeboot"</code>)。</p></div><p>
	      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-dhcp-root-path"><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span></a> </p></td><td valign="top" align="left"><p>ルートファイルシステムへのパスを、
		通常の NFS 書式で <code class="literal">root-path</code>
		オプションに指定します。</p></td></tr></table></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96158160"></a>22.7.1.1.2. BOOTP を使用する設定</h5></div></div></div><a id="idp96158800" class="indexterm"></a><p>続けて、<code class="command">bootpd</code>
	    で同等のことをする設定です。
	    これは <code class="filename">/etc/bootptab</code> におきます。</p><p>BOOTP を使用するために、デフォルトではない
	    <code class="literal">NO_DHCP_SUPPORT</code> オプション付きで
	    <span class="application">etherboot</span>
	    をコンパイルしなければならないことと、PXE は DHCP
	    を <span class="emphasis"><em>必要</em></span> とすることに注意してください。
	    <span class="application">bootpd</span> の唯一明白な利点は、
	    これがベースシステムに存在するということです。</p><pre class="programlisting">
          .def100:\
            :hn:ht=1:sa=192.168.4.4:vm=rfc1048:\
            :sm=255.255.255.0:\
            :ds=192.168.4.1:\
            :gw=192.168.4.1:\
            :hd="/tftpboot":\
            :bf="/kernel.diskless":\
            :rp="192.168.4.4:/data/misc/diskless":

          margaux:ha=0123456789ab:tc=.def100</pre></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96163792"></a>22.7.1.2. <span class="application">Etherboot</span>
	  を用いるブートプログラムの準備</h4></div></div></div><a id="idp96164688" class="indexterm"></a><p><a class="link" href="http://etherboot.sourceforge.net" target="_top">Etherboot
	  のウェブサイト</a> には主に Linux システムについて述べた<a class="link" href="http://etherboot.sourceforge.net/doc/html/userman/t1.html" target="_top">
	    広範囲の文書</a>
	  が含まれています。
	  しかし、それにもかかわらず有用な情報を含んでいます。
	  下記は FreeBSD システム上での <span class="application">etherboot</span>
	  の使用法についての概観を示します。</p><p>まずはじめに <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/etherboot/pkg-descr">net/etherboot</a>
	  の package または port をインストールしなければなりません。
	  <span class="application">etherboot</span> port は通常
	  <code class="filename">/usr/ports/net/etherboot</code> にあります。
	  ports ツリーがシステムにインストールされている場合、
	  このディレクトリ内で <code class="literal">make</code>
	  を実行すれば、よきに計らってくれます。
	  ports および packages に関する情報は <a class="xref" href="ports.html" title="第5章 アプリケーションのインストール - packages と ports">5章<em>アプリケーションのインストール - packages と ports</em></a>
	  を参照してください。</p><p>ここで説明している方法では、ブートフロッピーを使用します。
	  他の方法 (PROM または DOS プログラム) については
	  <span class="application">etherboot</span>
	  の文書を参照してください。</p><p>ブートフロッピーを作成するためには、
	  <span class="application">etherboot</span>
	  をインストールしたマシンのドライブにフロッピーディスクを挿入します。
	  それからカレントディレクトリを <span class="application">etherboot</span>
	  ツリー内の <code class="filename">src</code>
	  ディレクトリにして次のように入力します。</p><pre class="screen">
	  <code class="prompt">#</code> <strong class="userinput"><code>gmake bin32/devicetype.fd0</code></strong>
	</pre><p><em class="replaceable"><code>devicetype</code></em> は
	  ディスクレスワークステーションのイーサネットカードタイプに依存します。
	  正しい <em class="replaceable"><code>devicetype</code></em> を決定するために、
	  同じディレクトリ内の <code class="filename">NIC</code>
	  ファイルを参照してください。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96174672"></a>22.7.1.3. TFTP および NFS サーバの設定</h4></div></div></div><a id="idp96175312" class="indexterm"></a><a id="idp96176464" class="indexterm"></a><p>TFTP サーバ上で <code class="command">tftpd</code>
	  を有効にする必要があります。</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p><code class="command">tftpd</code> が提供するファイルを置くディレクトリ
	      (たとえば <code class="filename">/tftpboot</code>)
	      を作成してください。</p></li><li class="step"><p><code class="filename">/etc/inetd.conf</code>
	      ファイルに以下の行を追加してください。</p><pre class="programlisting">tftp    dgram   udp     wait    root  /usr/libexec/tftpd    tftpd -s /tftpboot</pre><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">少なくとも PXE のいくつかのバージョンが TCP 版の
		TFTP を要求するようです。その場合
		<code class="literal">dgram udp</code> を <code class="literal">stream tcp</code>
		に置き換えた 2 番目の行を追加してください。</p></div></li><li class="step"><p><code class="command">inetd</code>
	      に設定ファイルを再読み込みさせてください。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kill -HUP `cat /var/run/inetd.pid`</code></strong></pre></li></ol></div><p><code class="filename">tftpboot</code>
	  ディレクトリはサーバ上のどこにでも置けます。
	  その場所が <code class="filename">inetd.conf</code> および
	  <code class="filename">dhcpd.conf</code>
	  の両方に設定されていることを確かめてください。</p><p>さらに NFS を有効にして
	  NFS サーバの適切なファイルシステムをエクスポートする必要があります。</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>この行を <code class="filename">/etc/rc.conf</code>
	      に追加してください。</p><pre class="programlisting">nfs_server_enable="YES"</pre></li><li class="step"><p>下記を <code class="filename">/etc/exports</code> に加えることで、
	      ディスクレスマシンのルートディレクトリが位置するファイルシステムをエクスポートしてください
	      (ボリュームのマウントポイントを適当に調節し、
	      <em class="replaceable"><code>margaux</code></em>
	      をディスクレスワークステーションの名前に置き換えてください)。</p><pre class="programlisting"><em class="replaceable"><code>/data/misc</code></em> -alldirs -ro <em class="replaceable"><code>margaux</code></em></pre></li><li class="step"><p><code class="command">mountd</code>
	      に設定ファイルを再読み込みさせてください。
	      <code class="filename">/etc/rc.conf</code> 内で NFS
	      をはじめて有効にする必要があったのなら、
	      代わりに再起動した方がよいかもしれません。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kill -HUP `cat /var/run/mountd.pid`</code></strong></pre></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96202064"></a>22.7.1.4. ディスクレス用のカーネル構築</h4></div></div></div><a id="idp96202704" class="indexterm"></a><p>次のオプションを (通常のものに) 追加した、
	  ディスクレスクライアント用のカーネルコンフィグレーションファイルを作成してください。</p><pre class="programlisting">
          options     BOOTP          # Use BOOTP to obtain IP address/hostname
          options     BOOTP_NFSROOT  # NFS mount root filesystem using BOOTP info
          options     BOOTP_COMPAT   # Workaround for broken bootp daemons.</pre><p><code class="literal">BOOTP_NFSV3</code> および
	  <code class="literal">BOOTP_WIRED_TO</code> を利用してもよいかもしれません
	  (<code class="filename">LINT</code> を参照してください)。</p><p>カーネルを構築して (<a class="xref" href="kernelconfig.html" title="第9章 FreeBSD カーネルのコンフィグレーション">9章<em>FreeBSD カーネルのコンフィグレーション</em></a> を参照)、
	  <code class="filename">dhcpd.conf</code> に記述した名称で
	  tftp ディレクトリにコピーしてください。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96207440"></a>22.7.1.5. ルートファイルシステムの準備</h4></div></div></div><a id="idp96208080" class="indexterm"></a><p><code class="filename">dhcpd.conf</code> に
	  <code class="literal">root-path</code> として記載された
	  ディスクレスワークステーションのためのルートファイルシステムを作成する必要があります。</p><p>これを行う最も簡単な方法は
	  <code class="filename">/usr/share/examples/diskless/clone_root</code>
	  シェルスクリプトを使用することです。
	  このスクリプトは、少なくともファイルシステムが作成される場所
	  (<code class="literal">DEST</code> 変数)
	  を調節するために変更する必要があります。</p><p>説明についてはスクリプトの一番上にあるコメントを参照してください。
	  ベースシステムをどのように構築するか、
	  またファイルがどのようにディスクレス稼働、サブネット、
	  または個々のワークステーションに固有のバージョンによって、
	  選択的にオーバライドできるかを説明します。
	  また、ディスクレスな場合の
	  <code class="filename">/etc/fstab</code> ファイルおよび
	  <code class="filename">/etc/rc.conf</code> ファイルの例を示します。</p><p><code class="filename">/usr/share/examples/diskless</code>
	  内の <code class="filename">README</code>
	  ファイルには、多くの興味深い背景情報が書かれています。
	  しかし <code class="filename">diskless</code> ディレクトリ内の他の例と同じく、
	  <code class="filename">clone_root</code> と
	  <code class="filename">/etc/rc.diskless[12]</code>
	  で実際に使われているものとは異なる設定方法が説明されています。
	  ここに書かれている方法は
	  <code class="filename">rc</code> スクリプトの変更が必要になりますが、
	  こちらの方が気に入ったというのでなければ、
	  参照にとどめてください。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96219472"></a>22.7.1.6. スワップの設定</h4></div></div></div><p>必要なら、サーバに置かれたスワップファイルに
	  NFS 経由でアクセスできます。
	  <code class="filename">bootptab</code> または
	  <code class="filename">dhcpd.conf</code> の正確なオプションは、
	  現時点では明確には文書化されていません。
	  下記の設定例は isc-dhcp 3.0rc11
	  を使用して動作したと報告されているものです。</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p><code class="filename">dhcpd.conf</code>
	    に下記の行を追加してください。</p><pre class="programlisting">
              # Global section
              option swap-path code 128 = string;
              option swap-size code 129 = integer 32;

              host margaux {
                ... # Standard lines, see above
                option swap-path <em class="replaceable"><code>"192.168.4.4:/netswapvolume/netswap"</code></em>;
                option swap-size <em class="replaceable"><code>64000</code></em>;
              }</pre><p>これは、少なくとも FreeBSD クライアントにおいては、
	      DHCP/BOOTP オプションコードの 128 は
	      NFS スワップファイルへのパスで、オプションコード 129
	      は KB 単位のスワップサイズだということです。
	      もっと古いバージョンの <code class="command">dhcpd</code> では
	      <code class="literal">option option-128 "...</code>
	      という書式が受け付けられましたが、
	      もはや対応していません。</p><p>代わりに、<code class="filename">/etc/bootptab</code>
	      では次の書式を使います。</p><p><code class="literal">T128="192.168.4.4:/netswapvolume/netswap":T129=0000fa00
	      </code></p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="filename">/etc/bootptab</code>
	      では、スワップの大きさは
	      16 進数で表さなければなりません。</p></div></li><li class="step"><p>NFS スワップファイルサーバ側でスワップファイルを作成します。</p><pre class="screen">
              <code class="prompt">#</code> <strong class="userinput"><code>mkdir /netswapvolume/netswap</code></strong>
              <code class="prompt">#</code> <strong class="userinput"><code>cd /netswapvolume/netswap</code></strong>
              <code class="prompt">#</code> <strong class="userinput"><code>dd if=/dev/zero bs=1024 count=64000 of=swap.192.168.4.6</code></strong>
              <code class="prompt">#</code> <strong class="userinput"><code>chmod 0600 swap.192.168.4.6</code></strong></pre><p><em class="replaceable"><code>192.168.4.6</code></em>
	      はディスクレスクライアントの IP アドレスです。</p></li><li class="step"><p>NFS スワップファイルサーバ上で
	      <code class="filename">/etc/exports</code>
	      に下記の行を追加してください。</p><pre class="programlisting">
	      <em class="replaceable"><code>/netswapvolume</code></em>  -maproot=0:10 -alldirs <em class="replaceable"><code>margaux</code></em></pre><p>それから、上述したように <span class="application">mountd</span>
	      にエクスポートファイルを再読み込みさせてください。</p></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96259664"></a>22.7.1.7. 雑多な問題</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96260304"></a>22.7.1.7.1. 読み取り専用の <code class="filename">/usr</code>
	    で動作させる</h5></div></div></div><a id="idp96261328" class="indexterm"></a><p>ディスクレスワークステーションが X
	    を起動するように設定されている場合、
	    xdm 設定ファイルを調整しなければならないでしょう。
	    これはデフォルトでエラーファイルを
	    <code class="filename">/usr</code> に置きます。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp96263376"></a>22.7.1.7.2. FreeBSD ではないサーバを使用する</h5></div></div></div><p>ルートファイルシステムを提供するサーバが FreeBSD
	    で動作していない場合、
	    FreeBSD マシン上でルートファイルシステムを作成し、
	    <code class="command">tar</code> または <code class="command">cpio</code>
	    を利用して置きたい場所にコピーしなければならないでしょう。</p><p>この状況では、major/minor 整数サイズが異なっていることにより
	    <code class="filename">/dev</code>
	    内のスペシャルファイルに関する問題が時々おこります。
	    この問題を解決するには、非 FreeBSD
	    サーバからディレクトリをエクスポートして、
	    そのディレクトリを FreeBSD マシンでマウントし、
	    FreeBSD マシン上で <code class="command">MAKEDEV</code>
	    を実行して正しいデバイスエントリを作成します
	    (FreeBSD 5.0 およびそれ以降では、<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">devfs</span>(5)</span></a>
	    を使用してユーザに意識させずにデバイスノードを割り当てるので、
	    これらのバージョンでは
	    <code class="command">MAKEDEV</code> は必要ありません)。</p></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-nfs.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="advanced-networking.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="network-isdn.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">22.6. NFS〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓22.8. ISDN</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>