<?xml version="1.0" encoding="euc-jp" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=euc-jp" /><title>22.16. IPv6</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD ハンドブック" /><link rel="up" href="advanced-networking.html" title="第22章 高度なネットワーク" /><link rel="prev" href="network-plip.html" title="22.15. パラレルライン IP (PLIP)" /><link rel="next" href="appendices.html" title="パート〓V.〓付録" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">22.16. IPv6</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-plip.html">戻る</a>〓</td><th width="60%" align="center">第22章 高度なネットワーク</th><td width="20%" align="right">〓<a accesskey="n" href="appendices.html">次へ</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-ipv6"></a>22.16. IPv6</h2></div><div><span class="authorgroup">原作: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Kaplan</span> <span class="firstname">Aaron</span> [FAMILY Given]</span>. </span></div><div><span class="authorgroup">再構成と追記: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Rhodes</span> <span class="firstname">Tom</span> [FAMILY Given]</span>. </span></div></div></div><p>IPv6 (IPng <span class="quote">「<span class="quote">IP next generation</span>」</span> とも呼ばれます)
      は、著名な IP プロトコル
      (<acronym class="acronym">IPv4</acronym> とも呼ばれます) の新しいバージョンです。
      他の最新の *BSD システムと同様に FreeBSD は <acronym class="acronym">KAME</acronym>
      IPv6 リファレンス実装を含んでいます。したがって、あなたの
      FreeBSD システムには IPv6を試すために必要なものすべてが備わっています。
      この節では IPv6 の設定と実行に関して説明します。</p><p>1990 年代のはじめには、人々は IPv4
      アドレス空間が急速に縮小していることに気づくようになりました。
      インターネットの成長率が増大するにしたがって、
      2 つの心配ごとがでてきました。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>アドレスの枯渇。
	  今日では、プライベートアドレス空間
	  (<code class="systemitem">10.0.0.0/8</code>,
	  <code class="systemitem">192.168.0.0/24</code> など)
	  およびネットワークアドレス変換 (<acronym class="acronym">NAT</acronym>)
	  が使用されているので、それほど心配されていません。</p></li><li class="listitem"><p>ルーティングテーブルのエントリが大きくなりすぎていました。
	  これは今でも心配な事柄です。</p></li></ul></div><p>IPv6 は以下の、そしてその他多くの問題を扱います。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>128 bit アドレス空間。言い換えると、理論上
	  340,282,366,920,938,463,463,374,607,431,768,211,456
	  個のアドレスが利用可能です。これは地球上の一平方メータあたり、
	  およそ 6.67 * 10^27 個の IPv6 アドレスがあることを意味します。</p></li><li class="listitem"><p>ルータは、
	  ルーティングテーブル内にネットワーク集約アドレスだけを格納することで、
	  ルーティングテーブルの平均を 8192 項目程度に減らします。</p></li></ul></div><p>他にも以下のように IPv6 の便利な機能がたくさんあります。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>アドレス自動設定 (RFC2462)</p></li><li class="listitem"><p>エニーキャスト (anycast) アドレス
	  (<span class="quote">「<span class="quote">one-out-of many</span>」</span>
	  訳注: 複数の異なるノードが応答する 1 つのアドレス。
	  RFC2526 を参照してください)。</p></li><li class="listitem"><p>強制マルチキャストアドレス</p></li><li class="listitem"><p>IPsec (IP セキュリティ)</p></li><li class="listitem"><p>シンプルなヘッダ構造</p></li><li class="listitem"><p>モバイル <acronym class="acronym">IP</acronym></p></li><li class="listitem"><p>IPv4 から IPv6 への移行手段</p></li></ul></div><p>詳細については下記を参照してください。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="http://www.sun.com" target="_top">Sun.com</a>
	  の IPv6 概観</p></li><li class="listitem"><p><a class="link" href="http://www.ipv6.org" target="_top">IPv6.org</a></p></li><li class="listitem"><p><a class="link" href="http://www.kame.net" target="_top">KAME.net</a></p></li><li class="listitem"><p><a class="link" href="http://www.6bone.net" target="_top">6bone.net</a></p></li></ul></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97640656"></a>22.16.1. IPv6 アドレスの背景</h3></div></div></div><p>いくつか違うタイプの IPv6 アドレスがあります。
	ユニキャスト (Unicast)、エニーキャスト (Anycast)
	およびマルチキャスト (Multicast) です。</p><p>ユニキャストアドレスは周知のアドレスです。
	ユニキャストアドレスへ送られたパケットは、
	まさにそのアドレスに属するインターフェースに到着します。</p><p>エニーキャストアドレスはユニキャストアドレスと構文上判別不可能ですが、
	インタフェース群に宛てられています。
	エニーキャストアドレスに送られたパケットは (ルータメトリック的に)
	最も近いインタフェースに到着します。
	エニーキャストアドレスはルータでしか使ってはいけません。</p><p>マルチキャストアドレスはインタフェース群を識別します。
	マルチキャストアドレスに送られたパケットは、
	マルチキャスト群に属するすべてのインタフェースに到着します。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml">IPv4 のブロードキャストアドレス
	  (通常 <code class="systemitem">xxx.xxx.xxx.255</code>)
	  は、IPv6 ではマルチキャストアドレスで表現されます。</p></div><div class="table"><a id="idp97644240"></a><div class="table-title">表22.2 予約された IPv6 アドレス</div><div class="table-contents"><table summary="予約された IPv6 アドレス" border="0"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>IPv6 アドレス</th><th>プレフィックス長 (ビット)</th><th>説明</th><th>備考</th></tr></thead><tbody><tr><td><code class="systemitem">::</code></td><td>128 ビット</td><td>不特定</td><td>IPv4 の
		<code class="systemitem">0.0.0.0</code> 参照</td></tr><tr><td><code class="systemitem">::1</code></td><td>128 ビット</td><td>ループバックアドレス</td><td>IPv4 の
		<code class="systemitem">127.0.0.1</code> 参照</td></tr><tr><td><code class="systemitem">::00:xx:xx:xx:xx</code></td><td>96 ビット</td><td>IPv4 埋め込みアドレス</td><td>下位の 32 ビットは IPv4 アドレスです。
		<span class="quote">「<span class="quote">IPv4 互換 IPv6 アドレス</span>」</span> とも呼ばれます。</td></tr><tr><td><code class="systemitem">::ff:xx:xx:xx:xx</code></td><td>96 ビット</td><td>IPv4 射影 IPv6 アドレス</td><td>下位の 32 ビットは IPv4 アドレスです。
		IPv6 に対応していないホストに対するアドレスです。</td></tr><tr><td><code class="systemitem">fe80::</code>
		- <code class="systemitem">feb::</code></td><td>10 ビット</td><td>リンクローカル</td><td>IPv4 のループバックアドレス参照</td></tr><tr><td><code class="systemitem">fec0::</code>
		- <code class="systemitem">fef::</code></td><td>10 ビット</td><td>サイトローカル</td><td> </td></tr><tr><td><code class="systemitem">ff::</code></td><td>8 ビット</td><td>マルチキャスト</td><td> </td></tr><tr><td><code class="systemitem">001</code> (基数 2)</td><td>3 ビット</td><td>グローバルユニキャスト</td><td>すべてのグローバルユニキャストアドレスはこのプールから割り当てられます。
		はじめの 3 ビットは <span class="quote">「<span class="quote">001</span>」</span> です。</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97680336"></a>22.16.2. IPv6 アドレスを読む</h3></div></div></div><p>正規の書式では
	<code class="systemitem">x:x:x:x:x:x:x:x</code>
	と表されます。それぞれの
	<span class="quote">「<span class="quote">x</span>」</span> は 16 ビットの 16 進数です。たとえば
	<code class="systemitem">FEBC:A574:382B:23C1:AA49:4592:4EFE:9982</code>
	となります。</p><p>すべてゼロの長い部分文字列がアドレス内によく現れます。
	そのため、そのような部分文字列は <span class="quote">「<span class="quote">::</span>」</span>
	に短縮することができます。
	たとえば、<code class="systemitem">fe80::1</code> は正規形の
	<code class="systemitem">fe80:0000:0000:0000:0000:0000:0000:0001</code>
	に対応します。</p><p>3 番目の形式は、最後の 32 ビットの部分を
	<span class="quote">「<span class="quote">.</span>」</span> を分割文字として使う、
	なじみ深い IPv4 (10 進) 形式で書くことです。
	たとえば <code class="systemitem">2002::10.0.0.1</code>
	は (16 進) 正規形の
	<code class="systemitem">2002:0000:0000:0000:0000:0000:0a00:0001</code>
	に対応し、同時に <code class="systemitem">2002::a00:1</code>
	と書くこととも等価です。</p><p>ここまで来れば、下記を理解することができるでしょう。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig</code></strong></pre><pre class="programlisting">rl0: flags=8943&lt;UP,BROADCAST,RUNNING,PROMISC,SIMPLEX,MULTICAST&gt; mtu 1500
         inet 10.0.0.10 netmask 0xffffff00 broadcast 10.0.0.255
         inet6 fe80::200:21ff:fe03:8e1%rl0 prefixlen 64 scopeid 0x1
         ether 00:00:21:03:08:e1
         media: Ethernet autoselect (100baseTX )
         status: active</pre><p><code class="systemitem">fe80::200:21ff:fe03:8e1%rl0</code>
	は自動的に設定されたリンクローカルアドレスです。
	これは自動設定の一環として、
	イーサネット MAC アドレスを変換したものを含んでいます。</p><p>IPv6 アドレス構造についての詳細は RFC3513 をご覧ください。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97689168"></a>22.16.3. 接続</h3></div></div></div><p>現在、他の IPv6 ホストおよびネットワークに接続するためには
	4 つの方法があります。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>6bone 実験ネットワークに参加する。</p></li><li class="listitem"><p>上流のプロバイダから IPv6 ネットワークの割り当てを受ける。
	    手順については、インターネットプロバイダに問い合わせてください。</p></li><li class="listitem"><p>IPv6 over IPv4 によるトンネル。</p></li><li class="listitem"><p>ダイアルアップ接続の場合 freenet6 port を使用する。</p></li></ul></div><p>ここでは、現在もっともよく使われている方法と思われる
	6bone へ接続する方法を説明します。</p><p>はじめに 6bone サイトをみて、
	あなたに最も近い 6bone 接続先を見つけてください。
	責任者に連絡すると、少しばかり運がよければ、
	接続を設定する方法についての指示を受けられるでしょう。
	多くのばあい、これには
	GRE (gif) トンネルの設定が含まれます。</p><div xmlns="" class="note"><h3 class="admontitle">訳注: </h3><p xmlns="http://www.w3.org/1999/xhtml">6bone は <code class="systemitem">3ffe::</code> (16 ビット)
	  という IPv6 アドレスを割り振られた実験目的のネットワークでしたが、
	  2006 年 6 月に運用を停止することになっています。
	  他の商用や試験的な IPv6 接続サービスを探してください。</p></div><p>ここに <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gif&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">gif</span>(4)</span></a> トンネルを設定する典型的な例を示します。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig gif0 create</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ifconfig gif0</code></strong>
gif0: flags=8010&lt;POINTOPOINT,MULTICAST&gt; mtu 1280
<code class="prompt">#</code> <strong class="userinput"><code>ifconfig gif0 tunnel MY_IPv4_ADDR  HIS_IPv4_ADDR</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ifconfig gif0 inet6 alias MY_ASSIGNED_IPv6_TUNNEL_ENDPOINT_ADDR</code></strong></pre><p>大文字になっている単語を、
	上流の 6bone ノードから受け取った情報に置き換えてください。</p><p>これでトンネルが確立されます。<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ping6&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ping6</span>(8)</span></a> を
	<code class="systemitem">ff02::1%gif0</code>
	に送ることによって、トンネルが動作しているか確かめてください。
	ping の応答を 2 つ受け取るはずです。</p><div xmlns="" class="note"><h3 class="admontitle">注記: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="systemitem">ff02:1%gif0</code>
	  というアドレスに興味をそそられている場合のために説明すると、
	  これはマルチキャストアドレスです。
	  <code class="literal">%gif0</code> は、ネットワークインタフェース
	  <code class="filename">gif0</code>
	  上のマルチキャストアドレスが使用されるということを示しています。
	  マルチキャストアドレスに対して <code class="command">ping</code>
	  を送ったので、トンネルのもう一方の端も応答します。</p></div><p>ここまで来ると 6bone
	アップリンクに経路設定することは比較的簡単でしょう。</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>route add -inet6 default -interface gif0</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ping6 -n MY_UPLINK</code></strong></pre><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>traceroute6 www.jp.FreeBSD.org</code></strong>
(3ffe:505:2008:1:2a0:24ff:fe57:e561) from 3ffe:8060:100::40:2, 30 hops max, 12 byte packets
     1  atnet-meta6  14.147 ms  15.499 ms  24.319 ms
     2  6bone-gw2-ATNET-NT.ipv6.tilab.com  103.408 ms  95.072 ms *
     3  3ffe:1831:0:ffff::4  138.645 ms  134.437 ms  144.257 ms
     4  3ffe:1810:0:6:290:27ff:fe79:7677  282.975 ms  278.666 ms  292.811 ms
     5  3ffe:1800:0:ff00::4  400.131 ms  396.324 ms  394.769 ms
     6  3ffe:1800:0:3:290:27ff:fe14:cdee  394.712 ms  397.19 ms  394.102 ms</pre><p>この出力はマシンによって異なります。
	これで、あなたが <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/mozilla/pkg-descr">www/mozilla</a>
	のような IPv6 が利用可能なブラウザを持っていれば、
	IPv6 サイト
	<a class="link" href="http://www.kame.net" target="_top">www.kame.net</a>
	にいって踊るカメを見ることができるでしょう。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp97717712"></a>22.16.4. IPv6 世界の DNS</h3></div></div></div><p>IPv6 のための新しい DNS レコードが 2 種類あります。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>AAAA レコード</p></li><li class="listitem"><p>A6 レコード</p></li></ul></div><p>AAAA レコードは簡単に使えます。</p><pre class="programlisting">MYHOSTNAME           AAAA    MYIPv6ADDR</pre><p>上記をプライマリゾーン DNS ファイルに加えて、
	もらったばかりの IPv6 アドレスにホスト名を割り当ててください。
	あなた自身で <acronym class="acronym">DNS</acronym> ゾーンを管理していない場合は、
	<acronym class="acronym">DNS</acronym> プロバイダに頼んでください。
	<span class="application">bind</span> の最新バージョン
	(バージョン 8.3 および 9) は AAAA レコードに対応しています。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-plip.html">戻る</a>〓</td><td width="20%" align="center"><a accesskey="u" href="advanced-networking.html">上に戻る</a></td><td width="40%" align="right">〓<a accesskey="n" href="appendices.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">22.15. パラレルライン IP (PLIP)〓</td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top">〓パート〓V.〓付録</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文書、および他の文書は
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>
    からダウンロードできます。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>FreeBSD に関する質問がある場合には、
    <a href="http://www.FreeBSD.org/ja/docs.html">ドキュメント</a> を読んだ上で
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt; まで (英語で) 連絡してください。<br></br>
    本文書に関する質問については、
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt; まで電子メールを (英語で) 送ってください。</small></p></body></html>