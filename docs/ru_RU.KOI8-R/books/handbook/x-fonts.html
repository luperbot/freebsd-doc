<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>6.5. Использование шрифтов в X11</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD" /><link rel="up" href="x11.html" title="Глава 6. X Window System" /><link rel="prev" href="x-config.html" title="6.4. Конфигурация X11" /><link rel="next" href="x-xdm.html" title="6.6. Менеджеры экранов (Display Managers) X" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.5. Использование шрифтов в X11</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="x-config.html">Пред.</a> </td><th width="60%" align="center">Глава 6. X Window System</th><td width="20%" align="right"> <a accesskey="n" href="x-xdm.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="x-fonts"></a>6.5. Использование шрифтов в X11</h2></div><div><span class="authorgroup">Текст предоставил <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Murray</span> <span class="surname">Stokely</span></span>. </span></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="type1"></a>6.5.1. Шрифты Type1</h3></div></div></div><p>Шрифты, используемые по умолчанию и распространяемые вместе с
	X11, вряд ли можно назвать идеально
	подходящими для применения в обычных издательских приложениях.  Большие
	презентационные шрифты выглядят рвано и непрофессионально, а мелкие
	шрифты в <span class="application"><span class="trademark">Netscape</span>(R)</span> вообще невозможно
	разобрать.  Однако есть некоторое количество свободно распространяемых
	высококачественных шрифтов Type1 (<span class="trademark">PostScript</span>(R)), которые можно без
	изменений использовать с X11.  К примеру, в наборе шрифтов URW
	(<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-fonts/urwfonts/pkg-descr">x11-fonts/urwfonts</a>) имеются
	высококачественные версии стандартных шрифтов type1 (<span class="trademark">Times Roman</span>(R), <span class="trademark">Helvetica</span>(R), <span class="trademark">Palatino</span>(R) и другие).  В набор Freefonts
	(<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-fonts/freefonts/pkg-descr">x11-fonts/freefonts</a>) включено ещё
	больше шрифтов, однако большинство из них предназначено для
	использования в программном обеспечении для работы с графикой,
	например, <span class="application">Gimp</span>, и они не вполне пригодны
	для использования в качестве
	экранных шрифтов.  Кроме того, X11 с
	минимальными усилиями может быть настроена на использование шрифтов
	<span class="trademark">TrueType</span>(R). Более детальная информация находится на странице
	справочной системы <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=X&amp;sektion=7"><span class="citerefentry"><span class="refentrytitle">X</span>(7)</span></a> и в <a class="link" href="x-fonts.html#truetype" title="6.5.2. Шрифты TrueType(R)">разделе о
	шрифтах <span class="trademark">TrueType</span>(R)</a> ниже.</p><p>Для установки вышеупомянутых коллекций шрифтов Type1 из коллекции
	портов выполните следующие команды:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/ports/x11-fonts/urwfonts</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make install clean</code></strong></pre><p>То же самое нужно будет сделать для коллекции freefont и других.
	Чтобы X-сервер обнаруживал
	этих шрифты, добавьте соответствующую строку в
	файл настройки X сервера (<code class="filename">/etc/X11/xorg.conf</code>),
	которая должна выглядеть так:</p><pre class="programlisting">FontPath "/usr/local/lib/X11/fonts/URW/"</pre><p>Либо из командной строки при работе с X выполните:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>xset fp+ /usr/local/lib/X11/fonts/URW</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>xset fp rehash</code></strong></pre><p>Это сработает, но будет потеряно, когда сеанс работы с X будет
	закрыт, если эта команда не будет добавлена в начальный файл
	(<code class="filename">~/.xinitrc</code> в случае обычного сеанса через
	<code class="command">startx</code>
	или <code class="filename">~/.xsession</code> при входе через графический
	менеджер типа <span class="application">XDM</span>).  Третий способ
	заключается в использовании нового файла
	<code class="filename">/usr/local/etc/fonts/local.conf</code>: посмотрите
	раздел об <a class="link" href="x-fonts.html#antialias" title="6.5.3. Антиалиасинг шрифтов">антиалиасинге</a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="truetype"></a>6.5.2. Шрифты <span class="trademark">TrueType</span>(R)</h3></div></div></div><a id="idp80917072" class="indexterm"></a><a id="idp80917584" class="indexterm"></a><p>В <span class="application">Xorg</span> имеется встроенная
	поддержка шрифтов <span class="trademark">TrueType</span>(R).  Имеются два модуля, которые могут
	обеспечить эту функциональность.  В нашем примере используется модуль
	freetype, потому что он в большей степени похож на другие механизмы
	для работы с шрифтами.  Для включения модуля freetype достаточно в
	раздел <code class="literal">"Module"</code> файла
	<code class="filename">/etc/X11/xorg.conf</code> добавить следующую
	строчку.</p><pre class="programlisting">Load  "freetype"</pre><p>Теперь создайте каталог для шрифтов <span class="trademark">TrueType</span>(R)
	(к примеру, <code class="filename">/usr/local/lib/X11/fonts/TrueType</code>) и
	скопируйте все шрифты <span class="trademark">TrueType</span>(R) в этот каталог.  Имейте в виду,
	что напрямую использовать шрифты <span class="trademark">TrueType</span>(R) с <span class="trademark">Macintosh</span>(R) нельзя;
	для использования с X11 они должны
	быть в формате <span class="trademark">UNIX</span>(R)/<span class="trademark">MS-DOS</span>(R)/<span class="trademark">Windows</span>(R).  После того, как файлы будут
	скопированы в этот каталог, воспользуйтесь утилитой
	<span class="application">ttmkfdir</span> для создания файла
	<code class="filename">fonts.dir</code>, который укажет подсистеме вывода
	шрифтов X на местоположение этих новых файлов.
	<code class="command">ttmkfdir</code> имеется в Коллекции Портов FreeBSD:
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-fonts/ttmkfdir/pkg-descr">x11-fonts/ttmkfdir</a>.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/local/lib/X11/fonts/TrueType</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ttmkfdir -o fonts.dir</code></strong></pre><p>После этого добавьте каталог со шрифтами <span class="trademark">TrueType</span>(R)
	к маршруту поиска шрифтов.  Это делается точно также, как описано выше
	для шрифтов <a class="link" href="x-fonts.html#type1" title="6.5.1. Шрифты Type1">Type1</a>, то есть
	выполните</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>xset fp+ /usr/local/lib/X11/fonts/TrueType</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>xset fp rehash</code></strong></pre><p>или добавьте строку <code class="option">FontPath</code> в файл
	<code class="filename">xorg.conf</code>.</p><p>Это всё.  Теперь <span class="application"><span class="trademark">Netscape</span>(R)</span>,
	<span class="application">Gimp</span>,
	<span class="application"><span class="trademark">StarOffice</span>TM</span> и все остальные X-приложения
	должны увидеть установленные шрифты <span class="trademark">TrueType</span>(R).  Очень маленькие (как
	текст веб-страницы на дисплее с высоким разрешением) и очень большие (в
	<span class="application"><span class="trademark">StarOffice</span>TM</span>) шрифты будут теперь выглядеть
	гораздо лучше.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="antialias"></a>6.5.3. Антиалиасинг шрифтов</h3></div><div><span class="authorgroup">Обновление выполнил <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Joe Marcus</span> <span class="surname">Clarke</span></span>. </span></div></div></div><a id="idp80943056" class="indexterm"></a><a id="idp80943824" class="indexterm"></a><p>Антиалиасинг присутствует в X11 начиная с
	<span class="application"><span class="trademark">XFree86</span>TM</span>,
	версии 4.0.2.  Однако настройка шрифтов была довольно
	громоздка вплоть до появления <span class="application"><span class="trademark">XFree86</span>TM</span>
	4.3.0.  Начиная с версии <span class="application"><span class="trademark">XFree86</span>TM</span> 4.3.0,
	все шрифты, расположенные в каталогах
	<code class="filename">/usr/local/lib/X11/fonts/</code> и
	<code class="filename">~/.fonts/</code>, автоматически становятся доступными для
	применения антиалиасинга в приложениях, использующих Xft.  Не все
	приложения могут использовать Xft, но во многих его поддержка
	присутствует.  Примерами приложений, использующих Xft, является Qt
	версий 2.3 и более поздних (это инструментальный пакет для оболочки
	<span class="application">KDE</span>), GTK+ версий 2.0 и более поздних (это
	инструментальный пакет для оболочки <span class="application">GNOME</span>),
	а также <span class="application">Mozilla</span> версий 1.2 и более
	поздних.</p><p>Для применения к шрифтам антиалиасинга, а также
	для настройки параметров антиалиасинга, создайте (или отредактируйте,
	если он уже существует) файл
	<code class="filename">/usr/local/etc/fonts/local.conf</code>.  Некоторые мощные
	возможности системы шрифтов Xft могут быть настроены при помощи этого
	файла; в этом разделе описаны лишь некоторые простые возможности.  Для
	выяснения всех деталей, пожалуйста, обратитесь к
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fonts-conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">fonts-conf</span>(5)</span></a>.</p><a id="idp80954704" class="indexterm"></a><p>Этот файл должен быть сформирован в формате XML.  Обратите особое
	внимание на регистр символов, и удостоверьтесь, что все тэги корректно
	закрыты.  Файл начинается обычным заголовком XML, за которым следуют
	DOCTYPE и
	тэг <code class="literal">&lt;fontconfig&gt;</code>:</p><pre class="programlisting">
        &lt;?xml version="1.0"?&gt;
        &lt;!DOCTYPE fontconfig SYSTEM "fonts.dtd"&gt;
        &lt;fontconfig&gt;
      </pre><p>Как и говорилось ранее, все шрифты из каталога
	<code class="filename">/usr/local/lib/X11/fonts/</code>, а также
	<code class="filename">~/.fonts/</code> уже доступны для приложений,
	использующих Xft.  Если вы хотите добавить каталог, отличный от этих
	двух, добавьте строчку, подобную следующей, в файл
	<code class="filename">/usr/local/etc/fonts/local.conf</code>:</p><pre class="programlisting">&lt;dir&gt;/path/to/my/fonts&lt;/dir&gt;</pre><p>После добавления новых шрифтов, и особенно новых каталогов со
	шрифтами, вы должны выполнить следующую команду для перестроения
	кэшей шрифтов:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>fc-cache -f</code></strong></pre><p>Антиалиасинг делает границы несколько размытыми, что делает очень
	мелкий текст более читабельным и удаляет <span class="quote"><<<span class="quote">лесенки</span>>></span> из
	текста большого размера, но может вызвать нечёткость при применении к
	тексту обычного размера.  Для исключения размеров шрифтов, меньших 14, из
	антиалиасинга, добавьте такие строки:</p><pre class="programlisting">        &lt;match target="font"&gt;
            &lt;test name="size" compare="less"&gt;
                &lt;double&gt;14&lt;/double&gt;
            &lt;/test&gt;
            &lt;edit name="antialias" mode="assign"&gt;
                &lt;bool&gt;false&lt;/bool&gt;
            &lt;/edit&gt;
        &lt;/match&gt;
        &lt;match target="font"&gt;
            &lt;test name="pixelsize" compare="less" qual="any"&gt;
                &lt;double&gt;14&lt;/double&gt;
            &lt;/test&gt;
            &lt;edit mode="assign" name="antialias"&gt;
                &lt;bool&gt;false&lt;/bool&gt;
            &lt;/edit&gt;
        &lt;/match&gt;</pre><a id="idp80997712" class="indexterm"></a><p>Для некоторых моноширинных шрифтов антиалиасинг может также
	оказаться неприменимым при определении межсимвольного интервала.  В
	частности, эта проблема возникает с <span class="application">KDE</span>.
	Одним из возможных решений для этого
	является жесткое задание межсимвольного интервала в 100.  Добавьте
	следующие строки:</p><pre class="programlisting">       &lt;match target="pattern" name="family"&gt;
           &lt;test qual="any" name="family"&gt;
               &lt;string&gt;fixed&lt;/string&gt;
           &lt;/test&gt;
           &lt;edit name="family" mode="assign"&gt;
               &lt;string&gt;mono&lt;/string&gt;
           &lt;/edit&gt;
        &lt;/match&gt;
        &lt;match target="pattern" name="family"&gt;
            &lt;test qual="any" name="family"&gt;
                &lt;string&gt;console&lt;/string&gt;
            &lt;/test&gt;
            &lt;edit name="family" mode="assign"&gt;
                &lt;string&gt;mono&lt;/string&gt;
            &lt;/edit&gt;
        &lt;/match&gt;</pre><p>(это создаст алиасы <code class="literal">"mono"</code> для других
	общеупотребительных имён шрифтов фиксированного размера), а затем
	добавьте:</p><pre class="programlisting">         &lt;match target="pattern" name="family"&gt;
             &lt;test qual="any" name="family"&gt;
                 &lt;string&gt;mono&lt;/string&gt;
             &lt;/test&gt;
             &lt;edit name="spacing" mode="assign"&gt;
                 &lt;int&gt;100&lt;/int&gt;
             &lt;/edit&gt;
         &lt;/match&gt;      </pre><p>С некоторыми шрифтами, такими, как Helvetica, при антиалиасинге
	могут возникнуть проблемы .  Обычно это проявляется в виде шрифта,
	который наполовину вертикально обрезан.  Хуже того, это может
	привести к сбоям таких приложений, как
	<span class="application">Mozilla</span>.  Во избежание этого следует
	добавить следующее в файл <code class="filename">local.conf</code>:</p><pre class="programlisting">         &lt;match target="pattern" name="family"&gt;
             &lt;test qual="any" name="family"&gt;
                 &lt;string&gt;Helvetica&lt;/string&gt;
             &lt;/test&gt;
             &lt;edit name="family" mode="assign"&gt;
                 &lt;string&gt;sans-serif&lt;/string&gt;
             &lt;/edit&gt;
         &lt;/match&gt;        </pre><p>После того, как вы закончите редактирование
	<code class="filename">local.conf</code>, удостоверьтесь, что файл завершен
	тэгом <code class="literal">&lt;/fontconfig&gt;</code>.  Если этого не сделать,
	ваши изменения будут проигнорированы.</p><p>Набор шрифтов по умолчанию, поставляемый с
	X11, не очень подходит, если
	включается антиалиасинг.  Гораздо лучший набор шрифтов, используемых
	по умолчанию, можно найти в порте
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-fonts/bitstream-vera/pkg-descr">x11-fonts/bitstream-vera</a>.  Этот
	порт установит файл
	<code class="filename">/usr/local/etc/fonts/local.conf</code>, если такого ещё
	не существует.  Если файл существует, то порт создаст файл
	<code class="filename">/usr/local/etc/fonts/local.conf-vera</code>.  Перенесите
	содержимое этого файла в
	<code class="filename">/usr/local/etc/fonts/local.conf</code>, и шрифты
	Bitstream автоматически заменят используемые по умолчанию в
	X11 шрифты Serif, Sans Serif и
	Monospaced.</p><p>Наконец, пользователи могут добавлять собственные наборы
	посредством персональных файлов <code class="filename">.fonts.conf</code>.
	Для этого каждый пользователь должен просто создать файл
	<code class="filename">~/.fonts.conf</code>.  Этот файл также должен быть в
	формате XML.</p><a id="idp81027536" class="indexterm"></a><a id="idp81028048" class="indexterm"></a><p>И последнее замечание: при использовании дисплея LCD может
	понадобиться включение разбиения точек.  При этом компоненты красного,
	зелёного и голубого цветов (разделяемые по горизонтали),
	рассматриваются как отдельные точки для улучшения разрешения экрана
	по горизонтали; результат может оказаться потрясающим.  Для включения
	этого механизма добавьте такую строчку где-нибудь в файле
	<code class="filename">local.conf</code>:</p><pre class="programlisting">
        &lt;match target="font"&gt;
            &lt;test qual="all" name="rgba"&gt;
                &lt;const&gt;unknown&lt;/const&gt;
            &lt;/test&gt;
            &lt;edit name="rgba" mode="assign"&gt;
                &lt;const&gt;rgb&lt;/const&gt;
            &lt;/edit&gt;
        &lt;/match&gt;
      </pre><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">В зависимости от типа дисплея, <code class="literal">rgb</code> может
	  потребоваться заменить на <code class="literal">bgr</code>,
	  <code class="literal">vrgb</code> или <code class="literal">vbgr</code>: пробуйте и
	  смотрите, что работает лучше.</p></div><a id="idp81032528" class="indexterm"></a><p>Антиалиасинг должен быть включен при следующем запуске X-сервера.
	Однако программы должны знать, как использовать его преимущества.
	В настоящее время инструментальный пакет Qt умеет ими пользоваться,
	так что вся оболочка <span class="application">KDE</span> может
	использовать шрифты с антиалиасингом.
	GTK+ и <span class="application">GNOME</span>
	также можно заставить использовать антиалиасинг посредством капплета
	<span class="quote"><<<span class="quote">Font</span>>></span> (обратитесь к <a class="xref" href="x11-wm.html#x11-wm-gnome-antialias" title="6.7.1.3. Шрифты с антиалиасингом и GNOME">Раздел 6.7.1.3, <<Шрифты с антиалиасингом и GNOME>></a> для выяснения всех подробностей).
	По умолчанию <span class="application">Mozilla</span> версий 1.2 и выше
	будет автоматически использовать антиалиасинг.  Для отмены
	использования антиалиасинга
	перестройте <span class="application">Mozilla</span> с флагом
	<code class="varname">-DWITHOUT_XFT</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="x-config.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="x11.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="x-xdm.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">6.4. Конфигурация X11 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 6.6. Менеджеры экранов (Display Managers) X</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>