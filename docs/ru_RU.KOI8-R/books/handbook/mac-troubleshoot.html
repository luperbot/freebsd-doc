<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>15.16. Решение проблем с инфраструктурой MAC</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD" /><link rel="up" href="mac.html" title="Глава 15. Принудительный контроль доступа (MAC)" /><link rel="prev" href="MAC-examplehttpd.html" title="15.15. Другой пример: Использование MAC для защиты веб сервера" /><link rel="next" href="audit.html" title="Глава 16. Аудит событий безопасности" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.16. Решение проблем с инфраструктурой MAC</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="MAC-examplehttpd.html">Пред.</a> </td><th width="60%" align="center">Глава 15. Принудительный контроль доступа (MAC)</th><td width="20%" align="right"> <a accesskey="n" href="audit.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mac-troubleshoot"></a>15.16. Решение проблем с инфраструктурой MAC</h2></div></div></div><a id="idp90401872" class="indexterm"></a><p>На стадии разработки несколько пользователей сообщали
      о проблемах при обычных настройках.  Некоторые из этих
      проблем приведены ниже:</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90403024"></a>15.16.1. Параметр <code class="option">multilabel</code> не может быть включен на
	<code class="filename">/</code></h3></div></div></div><p>Параметр <code class="option">multilabel</code> не включается на
	моем корневом (<code class="filename">/</code>) разделе!</p><p>Похоже, что каждый пятидесятый пользователь сталкивается
	с этой проблемой; на самом деле, и у нас была эта проблема
	в первых настройках.  Дальнейшие наблюдения за этой так
	называемой <span class="quote"><<<span class="quote">ошибкой</span>>></span> привели меня к мнению,
	что это результат или некорректной документации, или
	неправильной интерпретации этой документации.
	Независимо от того, почему это случилось, для решения этой
	проблемы могут быть предприняты следующие шаги:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Отредактируйте <code class="filename">/etc/fstab</code> и установите
	    для корневого раздела параметр только для чтения
	    (<code class="option">ro</code>).</p></li><li class="step"><p>Перегрузитесь в однопользовательский режим.</p></li><li class="step"><p>Запустите команду <code class="command">tunefs</code>
	    <code class="option">-l enable</code> на <code class="filename">/</code>.</p></li><li class="step"><p>Перегрузите систему в нормальный режим.</p></li><li class="step"><p>Запустите <code class="command">mount</code> <code class="option">-urw</code>
	  <code class="filename">/</code> и измените параметр <code class="option">ro</code>
	  обратно на <code class="option">rw</code> в <code class="filename">/etc/fstab</code>;
	  перегрузите систему опять.</p></li><li class="step"><p>Дважды проверьте вывод
	  <code class="command">mount</code>, чтобы убедиться, что параметр
	  <code class="option">multilabel</code> был установлен на корневой
	  файловой системе.</p></li></ol></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90433232"></a>15.16.2. Не могу запустить <span class="trademark">XFree86</span>TM после <acronym class="acronym">MAC</acronym></h3></div></div></div><p>После настройки системы безопасности
	<acronym class="acronym">MAC</acronym>, я больше не могу запускать
	<span class="trademark">XFree86</span>TM!</p><p>Это может быть вызвано политикой <acronym class="acronym">MAC</acronym>
	<code class="literal">partition</code> или путем неправильной установки
	меток одной из политик <acronym class="acronym">MAC</acronym>.  Для отладки
	попробуйте следующее:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Просмотрите сообщение об ошибке; если пользователь
	    находится в классе <code class="literal">insecure</code>, проблема
	    может быть в политике <code class="literal">partition</code>.
	    Попробуйте установить класс пользователя обратно в
	    <code class="literal">default</code> и пересобрать базу данных
	    командой <code class="command">cap_mkdb</code>.  Если это не
	    решит проблемы, попробуйте шаг два.</p></li><li class="step"><p>Дважды проверьте политики с метками.  Убедитесь, что
	    политики настроены правильно для рассматриваемого пользователя,
	    приложения <span class="trademark">XFree86</span>TM, и устройств в <code class="filename">/dev</code>.</p></li><li class="step"><p>Если проблема не решена, отправьте сообщение об ошибке и
	    описание вашей системы в список рассылки TrustedBSD,
	    находящийся на веб сайте
	    <a class="link" href="http://www.TrustedBSD.org" target="_top">TrustedBSD</a>
	    или в <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-questions" target="_top">Список рассылки, посвящённый вопросам и ответам пользователей FreeBSD</a>.</p></li></ol></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90443600"></a>15.16.3. Error: <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=_secure_path&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">_secure_path</span>(3)</span></a> cannot stat <code class="filename">.login_conf</code></h3></div></div></div><p>При попытке переключения от <code class="systemitem">root</code> на другого
	пользователя системы, появляется сообщение об ошибке
	<span class="errorname">_secure_path: unable to state .login_conf</span>.</p><p>Это сообщение обычно показывается, когда у пользователя более
	высокая метка, чем у пользователя, которым он пытается стать.
	Например, у пользователя системы <code class="systemitem">joe</code> метка по
	умолчанию <code class="option">biba/low</code>.  Пользователь
	<code class="systemitem">root</code>, метка которого <code class="option">biba/high</code>,
	не может просматривать домашний каталог пользователя
	<code class="systemitem">joe</code>.  Это не зависит от того, использует ли
	пользователь <code class="systemitem">root</code> команду <code class="command">su</code>
	<code class="systemitem">joe</code> или нет.  В этом сценарии модель
	целостности Biba не позволит <code class="systemitem">root</code> просматривать
	объекты с низким уровнем целостности.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90455504"></a>15.16.4. Пользователя <code class="systemitem">root</code> нет!</h3></div></div></div><p>В нормальном или даже однопользовательском режиме
	<code class="systemitem">root</code> не обнаруживается.  Команда
	<code class="command">whoami</code> возвращает 0 (нуль) и
	<code class="command">su</code> возвращает <span class="errorname">who are you?</span>.
	Что можно сделать?</p><p>Это может произойти, если политика с метками была отключена,
	или через <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span></a>, или путем выгрузки модуля политики.
	Если политика была постоянно или временно отключена, базу данных
	login необходимо перенастроить.  Дважды проверьте
	<code class="filename">login.conf</code>, чтобы убедиться, что
	все параметры <code class="option">label</code> были удалены и пересоберите
	базу данных командой <code class="command">cap_mkdb</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="MAC-examplehttpd.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="mac.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="audit.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">15.15. Другой пример: Использование MAC для защиты веб сервера </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> Глава 16. Аудит событий безопасности</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>