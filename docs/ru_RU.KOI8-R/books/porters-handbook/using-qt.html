<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>6.10. Использование Qt</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD по созданию портов" /><link rel="up" href="special.html" title="Глава 6. Особые соглашения" /><link rel="prev" href="using-gnome.html" title="6.9. Использование GNOME" /><link rel="next" href="using-kde.html" title="6.11. Использование KDE" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.10. Использование Qt</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="using-gnome.html">Пред.</a> </td><th width="60%" align="center">Глава 6. Особые соглашения</th><td width="20%" align="right"> <a accesskey="n" href="using-kde.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-qt"></a>6.10. Использование Qt</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="qt-common"></a>6.10.1. Порты, для которых требуется Qt</h3></div></div></div><div class="table"><a id="idp77445072"></a><div class="table-title">Таблица 6.8. Переменные для портов, использующих Qt</div><div class="table-contents"><table summary="Переменные для портов, использующих Qt" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USE_QT4</code></td><td>Указывает инструменты и библиотеки в качестве
		зависимостей для портов, которые используют Qt 4.
		Для получения подробностей смотрите <a class="link" href="using-qt.html#qt4-components" title="6.10.2. Выбор компонентов">выбор компонентов Qt
		  4</a>.</td></tr><tr><td><code class="varname">QT_PREFIX</code></td><td>Устанавливается в значение, содержащее путь к
		установленному Qt (переменная только для
		чтения).</td></tr><tr><td><code class="varname">MOC</code></td><td>Устанавливается в значение, содержащее путь к
		<code class="command">moc</code> (переменная только для
		чтения).  По умолчанию устанавливается в соответствии
		со значением <code class="varname">USE_QT_VER</code>.</td></tr><tr><td><code class="varname">QTCPPFLAGS</code></td><td>Дополнительные флаги компилятора для
		инструментального пакета Qt, передаваемые через
		переменную <code class="varname">CONFIGURE_ENV</code>.  По
		умолчанию устанавливается в соответствии со значением
		<code class="varname">USE_QT_VER</code>.</td></tr><tr><td><code class="varname">QTCFGLIBS</code></td><td>Дополнительные флаги компоновки для
		инструментального пакета Qt, передаваемые через
		переменную <code class="varname">CONFIGURE_ENV</code>.  По
		умолчанию устанавливается в соответствии со значением
		<code class="varname">USE_QT_VER</code>.</td></tr><tr><td><code class="varname">QTNONSTANDARD</code></td><td>Подавляет изменение
		<code class="varname">CONFIGURE_ENV</code>,
		<code class="varname">CONFIGURE_ARGS</code>,
		<code class="varname">CPPFLAGS</code> и
		<code class="varname">MAKE_ENV</code>.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idp77459024"></a><div class="table-title">Таблица 6.9. Дополнительные переменные для портов, использующих Qt
	  4.x</div><div class="table-contents"><table summary="Дополнительные переменные для портов, использующих Qt&#10;&#9;  4.x" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">UIC</code></td><td>Устанавливает путь к <code class="command">uic</code>
		(переменная только для чтения).</td></tr><tr><td><code class="varname">QMAKE</code></td><td>Устанавливает путь к <code class="command">qmake</code>
		(переменная только для чтения).</td></tr><tr><td><code class="varname">QMAKESPEC</code></td><td>Устанавливает путь к конфигурационному файлу для
		<code class="command">qmake</code> (переменная только для
		чтения).</td></tr><tr><td><code class="varname">QMAKEFLAGS</code></td><td>Дополнительные флаги для
		<code class="command">qmake</code>.</td></tr><tr><td><code class="varname">QT_INCDIR</code></td><td>Устанавливает каталоги для заголовков Qt 4
		(переменная только для чтения).</td></tr><tr><td><code class="varname">QT_LIBDIR</code></td><td>Устанавливает путь к библиотекам Qt 4
		(переменная только для чтения).</td></tr><tr><td><code class="varname">QT_PLUGINDIRC</code></td><td>Устанавливает путь к плагинам Qt 4 (переменная
		только для чтения).</td></tr></tbody></table></div></div><br class="table-break" /><p>При заданной переменной <code class="varname">USE_QT4</code>
	применяются следующие настройки:</p><pre class="programlisting">CONFIGURE_ARGS+=	--with-qt-includes=${QT_INCDIR} \
			--with-qt-libraries=${QT_LIBDIR} \
			--with-extra-libs=${LOCALBASE}/lib \
			--with-extra-includes=${LOCALBASE}/include
CONFIGURE_ENV+=	MOC="${MOC}" UIC="${UIC}" LIBS="${QTCFGLIBS}" \
		QMAKE="${QMAKE}" QMAKESPEC="${QMAKESPEC}" QTDIR="${QT_PREFIX}"
MAKE_ENV+=	QMAKESPEC="${QMAKESPEC}"

PLIST_SUB+=	QT_INCDIR_REL=${QT_INCDIR_REL} \
		QT_LIBDIR_REL=${QT_LIBDIR_REL} \
		QT_PLUGINDIR_REL=${QT_PLUGINDIR_REL}</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="qt4-components"></a>6.10.2. Выбор компонентов</h3></div></div></div><p>В переменной <code class="varname">USE_QT4</code> должны
	указываться зависимости от отдельных инструментов и библиотек
	Qt 4.  К каждому компоненту можно добавить суффикс,
	<code class="literal">_build</code> или <code class="literal">_run</code>,
	отражающий, когда должна быть применена зависимость, во время
	сборки или выполнения, соответственно.  Если суффикс
	отсутствует, зависимость от компонента будет и для времени
	сборки, и для времени выполнения.  Обычно, компоненты
	библиотек должны указываться без суффиксов, компоненты
	инструментов - с суффиксом <code class="literal">_build</code>, а
	компоненты плагинов - с суффиксом <code class="literal">_run</code>.
	Наиболее общие используемые компоненты перечислены ниже (все
	доступные компоненты перечислены в
	<code class="varname">_USE_QT4_ALL</code> в файле
	<code class="filename">/usr/ports/Mk/bsd.qt.mk</code>):</p><div class="table"><a id="idp77498064"></a><div class="table-title">Таблица 6.10. Доступные библиотечные компоненты Qt 4</div><div class="table-contents"><table summary="Доступные библиотечные компоненты Qt 4" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">corelib</code></td><td>основная библиотека (можно опустить, если порт
		не использует ничего, кроме
		<code class="literal">corelib</code>)</td></tr><tr><td><code class="literal">gui</code></td><td>библиотека графического пользовательского
		интерфейса</td></tr><tr><td><code class="literal">network</code></td><td>сетевая библиотека</td></tr><tr><td><code class="literal">opengl</code></td><td>библиотека OpenGL</td></tr><tr><td><code class="literal">qt3support</code></td><td>библиотека совместимости с Qt 3</td></tr><tr><td><code class="literal">qtestlib</code></td><td>библиотека модульного тестирования</td></tr><tr><td><code class="literal">script</code></td><td>библиотека сценариев</td></tr><tr><td><code class="literal">sql</code></td><td>библиотека SQL</td></tr><tr><td><code class="literal">xml</code></td><td>библиотека XML</td></tr></tbody></table></div></div><br class="table-break" /><p>Вы можете определить, от каких библиотек зависит
	приложение, запустив <code class="command">ldd</code> на основной
	исполняемый файл после успешной компиляции.</p><div class="table"><a id="idp77514320"></a><div class="table-title">Таблица 6.11. Доступные компоненты инструментов Qt 4</div><div class="table-contents"><table summary="Доступные компоненты инструментов Qt 4" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">moc</code></td><td>мета-объектный компилятор (нужен при построении
		почти для каждого приложения Qt)</td></tr><tr><td><code class="literal">qmake</code></td><td>генератор Makefile / утилита построения</td></tr><tr><td><code class="literal">rcc</code></td><td>компилятор ресурсов (нужен, если приложение идет
		вместе с файлами <code class="filename">*.rc</code> или
		<code class="filename">*.qrc</code>)</td></tr><tr><td><code class="literal">uic</code></td><td>компилятор пользовательского интерфейса (нужен,
		если приложение идет вместе с файлами
		<code class="filename">*.ui</code>, созданными при помощи Qt
		Designer, - на практике каждое приложение Qt с
		GUI)</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idp77536464"></a><div class="table-title">Таблица 6.12. Доступные компоненты плагинов Qt 4</div><div class="table-contents"><table summary="Доступные компоненты плагинов Qt 4" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">iconengines</code></td><td>плагин для движка иконок SVG (если приложение
		поставляется с иконками SVG)</td></tr><tr><td><code class="literal">imageformats</code></td><td>плагины для графических форматов GIF, JPEG, MNG
		и SVG (если приложение поставляется с графическими
		файлами)</td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="qt4-components-example"></a><div class="example-title">Пример 6.5. Выбор компонентов Qt 4</div><div class="example-contents"><p>В этом примере портированное приложение использует
	  библиотеку графического пользовательского интерфейса Qt 4,
	  основную библиотеку Qt 4, все инструменты генерации кода
	  Qt 4 и генератор Makefile Qt 4.  Поскольку библиотека
	  <code class="literal">gui</code> подразумевает зависимость от
	  основной библиотеки, указывать <code class="literal">corelib</code>
	  нет необходимости.  Инструменты генерации кода Qt 4
	  <code class="literal">moc</code>, <code class="literal">uic</code> и
	  <code class="literal">rcc</code>, а также генератор Makefile
	  <code class="literal">qmake</code> нужны только для времени
	  построения, поэтому они указаны с суффиксом
	  <code class="literal">_build</code>:</p><pre class="programlisting">USE_QT4=	gui moc_build qmake_build rcc_build uic_build</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-qmake"></a>6.10.3. Использование <code class="command">qmake</code></h3></div></div></div><div class="table"><a id="idp77547984"></a><div class="table-title">Таблица 6.13. Переменные для портов, использующих
	  <code class="command">qmake</code></div><div class="table-contents"><table summary="Переменные для портов, использующих&#10;&#9;  qmake" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Название</th><th>Описание</th></tr></thead><tbody><tr><td><code class="varname">QMAKE_ARGS</code></td><td>Спефицичные для порта флаги
		<span class="application">QMake</span> для передачи
		программе <code class="command">qmake</code>.</td></tr><tr><td><code class="varname">QMAKE_ENV</code></td><td>Переменные окружения, устанавливаемые для
		программы <code class="command">qmake</code>.  По умолчанию
		соответствует значению
		<code class="literal">${CONFIGURE_ENV}</code>.</td></tr><tr><td><code class="varname">QMAKE_PRO</code></td><td>Название файла проекта
		<code class="filename">.pro</code>.  По умолчанию имеет пустое
		значение (с использованием автоопределения).</td></tr></tbody></table></div></div><br class="table-break" /><p>Если вместе с приложением вместо
	<code class="filename">configure</code> поставляется файл
	<code class="filename">.pro</code>, вы можете использовать
	следующее:</p><pre class="programlisting">USES=	qmake
USE_QT4=	qmake_build</pre><p><code class="literal">USES=qmake</code> указывает порту на
	использование <code class="command">qmake</code> в процессе
	конфигурации.  Обратите внимание, что
	<code class="literal">USES=qmake</code> не подразумевает зависимость от
	Qt 4 <code class="command">qmake</code>.  Для этого в значении
	<code class="literal">USE_QT4</code> должен присутствовать компонент
	<code class="literal">qmake_build</code>.</p><p>Приложения Qt часто пишутся в кроссплатформенной манере,
	и X11/Unix часто не является для них платформой разработки,
	что в свою очередь часто приводит к соответствующим упущенным
	моментам:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="emphasis"><em>Отсутствующие дополнительные пути для
	      заголовочных файлов.</em></span>  Многие приложения идут
	    с поддержкой иконки в системном трее, но пренебрегают
	    смотреть на наличие заголовочных файлов и/или
	    библиотеками в каталогах X11.  Вы можете сообщить
	    <code class="command">qmake</code>, чтобы она добавила каталоги в
	    пути поиска заголовочных файлов и библиотек через
	    командную строку.  К примеру:</p><pre class="programlisting">QMAKE_ARGS+= INCLUDEPATH+=${LOCALBASE}/include \
	LIBS+=-L${LOCALBASE}/lib</pre></li><li class="listitem"><p><span class="emphasis"><em>Фиктивные пути установки.</em></span>
	    Иногда данные, такие как иконки и файлы .desktop,
	    устанавливаются по умолчанию в каталоги, которые не
	    просматриваются XDG-совместимыми приложениями.  Примером
	    является <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/editors/texmaker/pkg-descr">editors/texmaker</a>
	    - взгляните на <code class="filename">patch-texmaker.pro</code> из
	    каталога <code class="filename">files</code> этого порта, который
	    можно взять в качестве шаблона исправления этого
	    непосредственно в файле проекта
	    <code class="command">qmake</code>.</p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="using-gnome.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="special.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="using-kde.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">6.9. Использование GNOME </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 6.11. Использование KDE</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>