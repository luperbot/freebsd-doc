<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>6.14. Использование Python</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD по созданию портов" /><link rel="up" href="special.html" title="Глава 6. Особые соглашения" /><link rel="prev" href="using-php.html" title="6.13. Веб-приложения, Apache и PHP" /><link rel="next" href="using-tcl.html" title="6.15. Использование Tcl/Tk" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.14. Использование Python</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="using-php.html">Пред.</a> </td><th width="60%" align="center">Глава 6. Особые соглашения</th><td width="20%" align="right"> <a accesskey="n" href="using-tcl.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-python"></a>6.14. Использование Python</h2></div></div></div><p>Коллекция Портов поддерживает параллельную установку
      множества версий Python.  Следует убедиться, что в портах
      используется правильный интерпретатор <code class="command">python</code>
      в соответствии с переменной <code class="varname">PYTHON_VERSION</code>,
      установленной пользователем.  По большей части это означает
      замену пути к исполняемому файлу <code class="command">python</code> в
      сценариях на значение переменной
      <code class="varname">PYTHON_CMD</code>.</p><p>Порты, устанавливающие файлы под каталог
      <code class="varname">PYTHON_SITELIBDIR</code>, должны использовать
      префикс вида <code class="literal">pyXY-</code>, таким образом названия
      пакетов будут включать в себя версию Python, с которой они
      установлены.</p><pre class="programlisting">PKGNAMEPREFIX=	${PYTHON_PKGNAMEPREFIX}</pre><div class="table"><a id="idp77854160"></a><div class="table-title">Таблица 6.21. Переменные для портов, которые используют Python</div><div class="table-contents"><table summary="Переменные для портов, которые используют Python" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USE_PYTHON</code></td><td>Для этого порта нужен Python.  Минимальная
	      требуемая версия может быть указана с таким значением
	      как <code class="literal">2.6+</code>.  Также можно указан
	      диапазон версий с разделением двух версий через -,
	      например: <code class="literal">2.6-2.7</code></td></tr><tr><td><code class="varname">USE_PYDISTUTILS</code></td><td>Использовать дистрибутивные утилиты (distutils)
	      Python для конфигурации, компиляции и установки.
	      Необходимо, если порт использует
	      <code class="filename">setup.py</code>.  Переопределяет цели
	      <code class="buildtarget">do-build</code> и
	      <code class="buildtarget">do-install</code> и также может
	      переопределять <code class="buildtarget">do-configure</code>,
	      если не определена
	      <code class="varname">GNU_CONFIGURE</code>.</td></tr><tr><td><code class="varname">PYTHON_PKGNAMEPREFIX</code></td><td>Используется как <code class="varname">PKGNAMEPREFIX</code>
	      для отличия пакетов, использующих разные версии Python.
	      Пример: <code class="literal">py24-</code></td></tr><tr><td><code class="varname">PYTHON_SITELIBDIR</code></td><td>Местонахождение дерева site-packages, которое
	      содержит путь установки Python (обычно,
	      <code class="varname">LOCALBASE</code>).  Переменная
	      <code class="varname">PYTHON_SITELIBDIR</code> может быть очень
	      полезной при установке модулей Python.</td></tr><tr><td><code class="varname">PYTHONPREFIX_SITELIBDIR</code></td><td>Вариант PYTHON_SITELIBDIR без PREFIX.  По
	      возможности всегда используйте
	      <code class="literal">%%PYTHON_SITELIBDIR%%</code> в
	      <code class="filename">pkg-plist</code>.  Значением по умолчанию
	      для <code class="literal">%%PYTHON_SITELIBDIR%%</code> является
	      <code class="literal">lib/python%%PYTHON_VERSION%%/site-packages</code>.</td></tr><tr><td><code class="varname">PYTHON_CMD</code></td><td>Командная строка интерпретатора Python, включая
	      номер версии.</td></tr><tr><td><code class="varname">PYNUMERIC</code></td><td>Строка зависимости для расширения numeric.</td></tr><tr><td><code class="varname">PYNUMPY</code></td><td>Строка зависимости для нового расширения numeric,
	      numpy (PYNUMERIC объявлен устаревшим вышестоящим
	      производителем).</td></tr><tr><td><code class="varname">PYXML</code></td><td>Строка зависимости для расширения XML (не нужно
	      для Python 2.0 и выше, т.к. включено в основной
	      дистрибутив).</td></tr></tbody></table></div></div><br class="table-break" /><p>Полный перечень доступных переменных можно найти в
      <code class="filename">/usr/ports/Mk/bsd.python.mk</code>.</p><p>Некоторые приложения на Python заявляют о поддержке
      <code class="varname">DESTDIR</code> (требуется для staging), которая не
      работает (в частности, у Mailman до версии 2.1.16).
      Ограничение можно обойти путём перекомпиляции сценариев.
      Например, это можно выполнить в цели
      <code class="buildtarget">post-build</code>.  С учётом того, что
      после установки предполагаемое место размещения сценариев
      Python будет находиться в
      <code class="varname">PYTHONPREFIX_SITELIBDIR</code>, можно применить
      следующее решение:</p><pre class="programlisting">(cd ${STAGEDIR}${PREFIX} \
  &amp;&amp; ${PYTHON_CMD} ${PYTHON_LIBDIR}/compileall.py \
   -d ${PREFIX} -f ${PYTHONPREFIX_SITELIBDIR:S;${PREFIX}/;;})</pre><p>Эта команда перекомпилирует исходный текст с заменой путей
      на относительные к каталогу сборки, а также дописывает значение
      <code class="varname">PREFIX</code> перед именем файла, записанного в
      выходном файле с промежуточным представлением, с использованием
      <code class="literal">-d</code>.  <code class="literal">-f</code> требуется для
      безусловной перекомпиляции, <code class="literal">:S;${PREFIX}/;;</code>
      удаляет префиксы из значения переменной
      <code class="varname">PYTHONPREFIX_SITELIBDIR</code>, чтобы сделать его
      относительным к <code class="varname">PREFIX</code>.</p><p>Для этого требуется Python 2.7 или выше.  Это не
      работает с Python 2.6.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="using-php.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="special.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="using-tcl.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">6.13. Веб-приложения, Apache и PHP </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 6.15. Использование <span class="application">Tcl/Tk</span></td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>