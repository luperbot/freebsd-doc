<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>Глава 5. Устранение некоторых проблем</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Часто задаваемые вопросы по FreeBSD 8.X, 9.X и 10.X" /><link rel="up" href="index.html" title="Часто задаваемые вопросы по FreeBSD 8.X, 9.X и 10.X" /><link rel="prev" href="compatibility-other.html" title="4.5. Другое оборудование" /><link rel="next" href="applications.html" title="Глава 6. Прикладные программы" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Глава 5. Устранение некоторых проблем</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="compatibility-other.html">Пред.</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="applications.html">След.</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="troubleshoot"></a>Глава 5. Устранение некоторых проблем</h1></div></div></div><div class="qandaset"><a id="idp73156432"></a><dl><dt>5.1. <a href="troubleshoot.html#idp73157328">Почему FreeBSD определяет неправильное количество памяти
	    на аппаратуре i386TM?</a></dt><dt>5.2. <a href="troubleshoot.html#idp73180112">Программы аварийно завершают работу с ошибкой Signal
	    11.</a></dt><dt>5.3. <a href="troubleshoot.html#idp73227472">Моя система аварийно завершает работу с сообщениями
	    Fatal trap 12: page fault in kernel mode
	    либо panic:, и выдаёт много дополнительной
	    информации.  Что мне делать?</a></dt><dt>5.4. <a href="troubleshoot.html#idp73236304">Что означает сообщение об ошибке maxproc
	    limit exceeded by uid %i, please see tuning(7) and
	    login.conf(5)?</a></dt><dt>5.5. <a href="troubleshoot.html#idp73266640">Полноэкранные приложения на удалённой машине работают
	    неправильно!</a></dt><dt>5.6. <a href="troubleshoot.html#idp73287120">Почему подключение через ssh или
	    telnet к моему компьютеру занимает так
	    долго времени?</a></dt><dt>5.7. <a href="troubleshoot.html#idp75817808">Почему в dmesg(8) регулярно выводятся сообщения
	    file: table is full?</a></dt><dt>5.8. <a href="troubleshoot.html#idp75846992">Почему часы на моем компьютере показывают неправильное
	    время?</a></dt><dt>5.9. <a href="troubleshoot.html#idp75860432">Что означает сообщение swap_pager: indefinite
	    wait buffer:?</a></dt><dt>5.10. <a href="troubleshoot.html#idp75867856">Что означают сообщения lock order
	    reversal?</a></dt><dt>5.11. <a href="troubleshoot.html#idp75912784">Что означают сообщения Called ... with
	    the following non-sleepable locks held?</a></dt><dt>5.12. <a href="troubleshoot.html#idp75919440">Почему процесс
	    buildworld/installworld
	    завершается с сообщением
	    touch: not found?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp73157328"></a><a id="pae"></a><p><strong>5.1.</strong></p></td><td align="left" valign="top"><p>Почему FreeBSD определяет неправильное количество памяти
	    на аппаратуре <span class="trademark">i386</span>TM?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Наиболее вероятная причина заключается в различии между
	    адресами физической и виртуальной памяти.</p><p>Существующее соглашение для большинства оборудования ПК
	    заключается в использовании пространства памяти, лежащей в
	    диапазоне между 3.5 ГБ и 4 ГБ для специальных нужд
	    (обычно для нужд PCI).  Это пространство адресов используется
	    для доступа к PCI оборудованию.  Как результат, реальная
	    физическая память не может быть получена в данном адресном
	    пространстве.</p><p>Какие действия выполняются с памятью в данном регионе,
	    зависит от оборудования.  К сожалению, некоторое
	    оборудование ничего не выполняет и возможность использовать
	    эти 500 МБ ОЗУ полностью потеряна.</p><p>К счастью, большинство оборудования перераспределяет
	    память к более верхней позиции, так что она всё ещё может
	    использоваться.  Тем не менее, это может вызвать некоторое
	    замешательство при просмотре сообщений, выдаваемых при
	    загрузке.</p><p>На 32-битной версии FreeBSD кажется, что эта память
	    потерялась, поскольку она переназначится в диапазон выше
	    4 ГБ, который не доступен для 32 битного ядра.
	    В данном случае, решение заключается в сборке ядра с PAE.
	    За дополнительной информацией обращайтесь к статье об
	    ограничениях памяти.</p><p>На 64nbsp;битной версии FreeBSD или в случае использования ядра с
	    включённым PAE FreeBSD корректно определит и перераспределит память,
	    так, что она станет годной к использованию.  Тем не менее, во
	    время загрузки может показаться, что FreeBSD определяет больше
	    памяти, чем реально имеется в системе из-за описанного
	    перераспределения.  Это нормально, и информация
	    о доступной памяти будет скорректирована по окончанию процесса
	    загрузки.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp73180112"></a><a id="signal11"></a><p><strong>5.2.</strong></p></td><td align="left" valign="top"><p>Программы аварийно завершают работу с ошибкой <span class="errorname">Signal
	    11</span>.</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Ошибки выполнения, связанные с сигналом 11, происходят,
	    когда процесс пытается обратиться к области памяти, доступ к
	    которой ему не был дан операционной системой.  Если что-то подобное
	    происходит в случайные, казалось бы, промежутки времени,
	    следует начать поиск причины.</p><p>Эти проблемы могут быть классифицированы следующим
	    образом:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Если проблема возникает только в определённом
		самостоятельно разработанном приложении, то скорее
		всего это ошибка в коде.</p></li><li class="listitem"><p>Если это проблема в части базового комплекта системы
		FreeBSD, то это тоже может быть ошибка в программном коде, хотя
		в большинстве случаев такие проблемы обнаруживаются и ошибки
		исправляются задолго до того, как обычным читателям
		<acronym class="acronym">FAQ</acronym>
		доводится использовать этот код (именно для этого предназначена
		версия -CURRENT).</p></li></ol></div><p>Вероятно, это не связано с ошибкой во FreeBSD,
	    если проблема проявляется при компиляции программы, и при
	    этом ошибка компилятора каждый раз разная.</p><p>Например, если запуск <code class="command">make
	      buildworld</code> завершился неудачей при попытке
	    компиляции <code class="filename">ls.c</code> в
	    <code class="filename">ls.o</code> и при повторном запуске
	    компиляция снова прервалась на том же месте, то это ошибка
	    процесса построения.  Обновите исходные тексты и попробуйте
	    снова.  Если же компиляция прерывается в каком-то другом
	    месте, то причина наиболее вероятно кроется в
	    оборудовании.</p><p>В первом случае воспользуйтесь отладчиком, к примеру,
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gdb&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">gdb</span>(1)</span></a>, для нахождения точки программы, в которой
	    делается попытка доступа к неверному адресу, и исправьте
	    эту ошибку.</p><p>Во втором случае проверьте, какой компонент вашего
	    оборудования неисправен.</p><p>Среди часто приводящих к этому причин:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Диски могут перегреваться.  Проверьте работу
		вентиляторов.</p></li><li class="listitem"><p>Процессор перегревается.  Это может произойти
		при разгоне процессора или при поломке процессорного
		вентилятора.  В любом из вариантов убедитесь, что
		ваше оборудование работает так, как ему положено по
		крайней мере на момент поиска причин неисправности.
		В противном случае сбросьте частоту на настройки по
		умолчанию.</p><p>Что касается разгона, дешевле обходится медленная
		система, чем сгоревшая система, требующая замены!
		Также общественность не симпатизирует проблемам на
		таких системах.</p></li><li class="listitem"><p>Хитроумная память.  Если установлены различные
		микросхемы SIMM/DIMM, вытащите их все и попробуйте
		по одной до локализации проблемы в проблематичной
		микросхеме DIMM/SIMM, либо их комбинации.</p></li><li class="listitem"><p>Чересчур оптимистичные настройки материнской платы.
		Настройки BIOS и перемычки на материнской плате
		предоставляют возможность задавать различные частоты и
		задержки.  Часто бывает достаточно настроек по
		умолчанию, но иногда установка слишком малых периодов
		ожидания для ОЗУ или установка параметра <span class="quote"><<<span class="quote">RAM
		  Speed: Turbo</span>>></span> вызывает странное поведение.
		Возможным решением может стать установка параметров
		BIOS по умолчанию с предварительной записью текущих
		значений.</p></li><li class="listitem"><p>Неустойчивое или недостаточное электропитание
		материнской платы.  Уберите неиспользуемые адаптеры
		ввода/вывода, винчестеры и приводы компакт-дисков или
		отключите их от кабеля электропитания для проверки,
		что блок питания может работать с меньшей нагрузкой.
		Или попробуйте воспользоваться другим блоком
		питания, желательно большей мощности.  Например, если
		имеющийся блок питания рассчитан на 250 Ватт,
		попробуйте другой мощностью 300 Ватт).</p></li></ol></div><p>Прочитайте раздел про <a class="link" href="troubleshoot.html#signal11" title="5.2.">Signal 11</a> для дальнейшего
	    объяснения и обсуждения, как аппаратура или программное
	    обеспечение для тестирования памяти могут пропускать
	    сбойную память.  Подробная информация по этому вопросу
	    содержится в <a class="link" href="http://www.bitwizard.nl/sig11/" target="_top"><acronym class="acronym">FAQ</acronym>
	      по проблеме SIG11</a>.</p><p>Наконец, если ничего не помогает, то, возможно, это
	    из-за ошибки во FreeBSD.  Следуйте <a class="link" href="introduction.html#access-pr" title="1.13.">этим
	      инструкциям</a> для отправки сообщения о проблеме.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp73227472"></a><a id="trap-12-panic"></a><p><strong>5.3.</strong></p></td><td align="left" valign="top"><p>Моя система аварийно завершает работу с сообщениями
	    <span class="errorname">Fatal trap 12: page fault in kernel mode</span>
	    либо <span class="errorname">panic:</span>, и выдаёт много дополнительной
	    информации.  Что мне делать?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Разработчики FreeBSD интересуются такими ошибками, но
	    им нужно больше информации, чем просто текст ошибки.
	    Скопируйте весь текст сообщения.
	    Затем обратитесь к разделу <acronym class="acronym">FAQ</acronym> об
	    <a class="link" href="advanced.html#kernel-panic-troubleshooting" title="18.6.">аварийных завершениях
	    работы ядра</a>, постройте отладочное ядро и получите
	    трассу вызовов.  Это может звучать трудной задачей, зато не
	    требует навыков программирования.  Просто следуйте
	    указаниям.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp73236304"></a><a id="proc-table-full"></a><p><strong>5.4.</strong></p></td><td align="left" valign="top"><p>Что означает сообщение об ошибке <span class="errorname">maxproc
	    limit exceeded by uid %i, please see tuning(7) and
	    login.conf(5)</span>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Ядро FreeBSD позволяет одновременно существовать
	    ограниченному числу процессов.  Это зависит от значения
	    переменной <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span></a> <code class="varname">kern.maxusers</code>.
	    <code class="varname">kern.maxusers</code> также влияет на другие
	    ограничения ядра, такие как буферы работы с сетью.
	    Если система сильно загружена, поднимите
	    <code class="varname">kern.maxusers</code>.  Кроме максимального
	    числа процессов это также увеличит значения других
	    параметров, ограничивающих систему.</p><p>Для корректировки значения
	    <code class="varname">kern.maxusers</code> обратитесь к разделу <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/configtuning-kernel-limits.html#kern-maxfiles" target="_top">
	    Ограничения файлов/процессов</a> Руководства.  В нём
	    говорится об открытых файлах, но те же ограничения касаются
	    процессов.</p><p>Если система загружена слабо, но в ней запущено
	    слишком много процессов, поправьте параметр
	    <code class="varname">kern.maxproc</code>,  определив его значение в
	    <code class="filename">/boot/loader.conf</code>.  Изменение не вступит
	    в силу до перезагрузки системы.  За дополнительной информацией,
	    касающейся настройки параметров, обращайтесь к странице
	    Справочника <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=loader.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">loader.conf</span>(5)</span></a>.  Если эти процессы запущены
	    одним и тем же пользователем, поправьте
	    значение <code class="varname">kern.maxprocperuid</code>, чтобы оно
	    было на единицу меньше, чем новое значение
	    <code class="varname">kern.maxproc</code>.  Оно должно быть меньше по
	    крайней мере на единицу, потому что системная программа
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=init&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">init</span>(8)</span></a> должна работать всегда.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp73266640"></a><a id="remote-fullscreen"></a><p><strong>5.5.</strong></p></td><td align="left" valign="top"><p>Полноэкранные приложения на удалённой машине работают
	    неправильно!</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>На удалённой машине тип терминала может отличаться
	    от <code class="literal">xterm</code>, который требуется для
	    использования консоли FreeBSD.  Либо же ядро может иметь
	    неправильные значения ширины и высоты терминала.</p><p>Проверьте, чтобы переменная окружения
	    <code class="envar">TERM</code> имела значение
	    <code class="literal">xterm</code>.  Если удалённая машина его не
	    поддерживает, попробуйте <code class="literal">vt100</code>.</p><p>Запустите <code class="command">stty -a</code>, чтобы узнать,
	    какие размеры терминала заданы в ядре.  Если значения
	    неправильные, их можно поменять командой
	    <code class="command">stty rows <em class="replaceable"><code>RR</code></em> cols
	    <em class="replaceable"><code>CC</code></em></code>.</p><p>Либо же, если на клиентской машине установлен
	    <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11/xterm/pkg-descr">x11/xterm</a>, запуск
	    <code class="command">resize</code> позволит узнать у терминала
	    правильные размеры и применить эти значения.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp73287120"></a><a id="connection-delay"></a><p><strong>5.6.</strong></p></td><td align="left" valign="top"><p>Почему подключение через <code class="command">ssh</code> или
	    <code class="command">telnet</code> к моему компьютеру занимает так
	    долго времени?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Симптом: между моментом установления TCP-соединения и
	    выдачей клиентским программным обеспечением запроса на ввод
	    пароля (или, в случае использования <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=telnet&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">telnet</span>(1)</span></a>, выдачей
	    приглашения на вход) проходит большой промежуток времени.</p><p>Проблема: скорее всего, задержка вызвана программным
	    обеспечением на стороне сервера, которое пытается преобразовать
	    IP-адрес клиента в имя хоста.  Многие серверы, включая
	    <span class="application">Telnet</span> и <span class="application">SSH</span>,
	    поставляемые с FreeBSD, делают это для того, чтобы, кроме всего
	    прочего, записать имя хоста в файле журнала для справки
	    администратора.</p><p>Лечение: Если проблема возникает при подключении
	    клиента к любому серверу, то причина в клиенте.  Если
	    проблема возникает только при чьей-либо попытке
	    подключиться к серверу, то проблема в сервере.</p><p>Если проблема с клиентом, то единственным методом ее решения
	    является исправление DNS, чтобы сервер смог распознать вашу
	    машину.  Если это происходит в локальной сети, то предположите,
	    что это проблема с сервером, и продолжайте чтение.  Если
	    это происходит в сети Интернет, обратитесь к вашему
	    провайдеру.</p><p>Если проблема с сервером в локальной
	    сети, настройте сервер для разрешения запросов на
	    преобразование адреса в имя хоста в диапазоне локальных
	    адресов.  Обратитесь к страницам Справочника по <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hosts&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">hosts</span>(5)</span></a>
	    и <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=named&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">named</span>(8)</span></a> для получения более подробной информации.
	    Если это происходит в сети Интернет, то проблема
	    может заключаться в некорректной работе ресолвера локального сервера.
	    Для проверки попробуйте получить адрес другого хоста, такого как
	    <code class="systemitem">www.yahoo.com</code>.  Если это не работает, то
	    в этом и состоит проблема.</p><p>Из-за свежей установки FreeBSD, также возможно, что
	    информация о домене и сервере имён отсутствует в
	    <code class="filename">/etc/resolv.conf</code>.  Это часто будет
	    вызывать задержку в работе <span class="application">SSH</span>,
	    так как опция <code class="literal">UseDNS</code> по умолчанию
	    установлена в значение <code class="literal">yes</code> в
	    <code class="filename">/etc/ssh/sshd_config</code>.  Если именно это является
	    причиной проблемы, то добавьте недостающую
	    информацию в <code class="filename">/etc/resolv.conf</code>, либо в
	    качестве временной меры установите <code class="literal">UseDNS</code>
	    в <code class="literal">no</code> в файле
	    <code class="filename">sshd_config</code>.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp75817808"></a><a id="file-table-full"></a><p><strong>5.7.</strong></p></td><td align="left" valign="top"><p>Почему в <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dmesg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dmesg</span>(8)</span></a> регулярно выводятся сообщения
	    <span class="errorname">file: table is full</span>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Такое сообщение об ошибке сигнализирует о том, что в
	    системе закончились доступные файловые дескрипторы.
	    Обратитесь к разделу <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/configtuning-kernel-limits.html#kern-maxfiles" target="_top">
	    kern.maxfiles</a> главы о <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/handbook/configtuning-kernel-limits.html" target="_top">
	    Настройке ограничений ядра</a> Руководства для выяснения всех
	    подробностей и устранения этой проблемы.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp75846992"></a><a id="computer-clock-skew"></a><p><strong>5.8.</strong></p></td><td align="left" valign="top"><p>Почему часы на моем компьютере показывают неправильное
	    время?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>На компьютере установлено по меньшей мере два
	    таймера, и FreeBSD выбрала не тот.</p><p>Запустите <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dmesg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dmesg</span>(8)</span></a> и посмотрите строки, содержащие слово
	    <code class="literal">Timecounter</code>.  FreeBSD выбирает таймер с
	    наибольшим значением качества.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dmesg | grep Timecounter</code></strong>
Timecounter "i8254" frequency 1193182 Hz quality 0
Timecounter "ACPI-fast" frequency 3579545 Hz quality 1000
Timecounter "TSC" frequency 2998570050 Hz quality 800
Timecounters tick every 1.000 msec</pre><p>Удостоверьтесь в этом, проверив
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(3)</span></a>-переменную
	    <code class="varname">kern.timecounter.hardware</code>.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl kern.timecounter.hardware</code></strong>
kern.timecounter.hardware: ACPI-fast</pre><p>Это может быть неработающий таймер ACPI.  Самым простым
	    решением будет отключить таймер ACPI в
	    <code class="filename">/boot/loader.conf</code>:</p><pre class="programlisting">debug.acpi.disabled="timer"</pre><p>Либо же BIOS может изменить частоту TSC-может, для изменения
	    скорости работы процессора при работе от батареек или переводя в
	    режим пониженного электропитания, но FreeBSD не отслеживает это и
	    в результате часы начинают спешить или отставать.</p><p>В этом примере имеется также и таймер <code class="literal">i8254</code>,
	    и он может быть выбран записью его имени в
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(3)</span></a>-переменную
	    <code class="varname">kern.timecounter.hardware</code>.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl kern.timecounter.hardware=i8254</code></strong>
kern.timecounter.hardware: TSC -&gt; i8254</pre><p>Теперь компьютер должен аккуратнее следить за временем.</p><p>Чтобы это изменение вступало в силу во время загрузки системы,
	    добавьте в файл <code class="filename">/etc/sysctl.conf</code> такую
	    строчку:</p><pre class="programlisting">kern.timecounter.hardware=i8254</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp75860432"></a><a id="indefinite-wait-buffer"></a><p><strong>5.9.</strong></p></td><td align="left" valign="top"><p>Что означает сообщение <span class="errorname">swap_pager: indefinite
	    wait buffer:</span>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Это значит, что процесс пытается сбросить страницу памяти на
	    диск, и попытка сделать это оканчивается неудачно в течение
	    более 20 секунд.  Это может быть вызвано испорченными блоками
	    на диске, кабелями, подключением или другим оборудованием
	    ввода/вывода.  Если диск сам по себе испорчен, вы
	    также увидите ошибки работы с диском в
	    <code class="filename">/var/log/messages</code> и в выводе
	    <code class="command">dmesg</code>.  В противном случае проверьте кабели и
	    подключения.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp75867856"></a><a id="lock-order-reversal"></a><p><strong>5.10.</strong></p></td><td align="left" valign="top"><p>Что означают сообщения <span class="errorname">lock order
	    reversal</span>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Ядро FreeBSD использует несколько блокировок для арбитража
	    доступа к соответствующим ресурсам.  Когда несколько
	    потоков в ядре пытаются захватить несколько блокировок
	    подряд, всегда существует возможность появления мёртвой
	    блокировки (deadlock), где два потока захватили по одной
	    блокировке и заблокированы в ожидании освобождения другим
	    потоком второй блокировки.  Такой проблемы синхронизации
	    можно избежать, если все потоки захватывают блокировки в
	    одинаковом порядке.</p><p>Система диагностирования блокировок <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=witness&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">witness</span>(4)</span></a>,
	    которая по умолчанию включена во FreeBSD-CURRENT и выключена
	    для стабильных веток и релизов, определяет возможность
	    появления мёртвых блокировок из-за ошибок их использования,
	    включая захват нескольких блокировок в различном порядке
	    в разных частях ядра.  Инфраструктура <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=witness&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">witness</span>(4)</span></a>
	    пытается обнаруживать эту проблему по мере её появления
	    и сообщает о ней на системную консоль в сообщении
	    <span class="errorname">lock order reversal</span> (которое также
	    часто называют <acronym class="acronym">LOR</acronym>).</p><p>В силу консервативности <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=witness&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">witness</span>(4)</span></a> возможны ложные
	    срабатывания.  При правильном срабатывании такое сообщение
	    <span class="emphasis"><em>не</em></span> означает, что система находится в
	    состоянии мёртвой блокировки; его следует рассматривать
	    как предупреждение о том, что в этом месте могла бы
	    произойти мёртвая блокировка.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Плохие <acronym class="acronym">LOR</acronym> обычно быстро
	      исправляют, поэтому перед написанием сообщения в списки
	      рассылки следует проверить архивы http://lists.FreeBSD.org/mailman/listinfo/freebsd-current.</p></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp75912784"></a><a id="called-with-non-sleepable-locks-held"></a><p><strong>5.11.</strong></p></td><td align="left" valign="top"><p>Что означают сообщения <span class="errorname">Called ... with
	    the following non-sleepable locks held</span>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Это означает, что функция, которая может находиться в
	      <span class="quote"><<<span class="quote">спящем</span>>></span> состоянии была вызвана во время
	      использования мьютекс (или другого не <span class="quote"><<<span class="quote">засыпающего</span>>></span>)
	      блокирования.</p><p>Причина этого - ошибка, потому что мьютексы не предполагают
	      находиться в удерживаемом состоянии длительные промежутки
	      времени, а блокировать только на короткие периоды синхронизации.
	      Это правило позволяет драйверам устройств использовать мьютексы
	      для синхронизации с остальной частью ядра во время прерываний.
	      Прерывания (во FreeBSD) могут находиться не в <span class="quote"><<<span class="quote">спящем
	      состоянии</span>>></span>.  Следовательно необходимо, чтобы не было
	      подсистем в ядре, которые бы занимались блокировкой длительный
	      период, используя мьютекс.</p><p>Для нахождения таких ошибок в ядро могут быть добавлены
	      assertions, которые будут взаимодействовать с подсистемой
	      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=witness&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">witness</span>(4)</span></a>
	      для генерирования предупреждения или фатальной ошибки (в
	      зависимости от системной конфигурации) в случаях когда
	      производится потенциально блокирующий вызов с удержанием
	      мьютекса.</p><p>В общем, такие предупреждения не критичны, но тем не менее,
	      с неудачной синхронизацией (timing) они могут вызвать нежелательные
	      эффекты, начиная от незначительной задержки в ответной реакции системы
	      до полной блокировки системы.</p><p>Дополнительная информация о синхронизации во FreeBSD
	      находится на странице Справочника <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=locking&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">locking</span>(9)</span></a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp75919440"></a><a id="touch-not-found"></a><p><strong>5.12.</strong></p></td><td align="left" valign="top"><p>Почему процесс
	    <code class="buildtarget">buildworld</code>/<code class="buildtarget">installworld</code>
	    завершается с сообщением
	    <span class="errorname">touch: not found</span>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Эта ошибка не означает, что не найдена утилита <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=touch&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">touch</span>(1)</span></a>.
	    Ошибка наверняка появляется из-за того, что даты модификации файлов
	    установлены в будущем.  Если CMOS часы установлены на локальное
	    время, отрегулируйте часовой механизм ядра, запустив
	    команду <code class="command">adjkerntz -i</code> в
	    однопользовательском режиме.</p></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="compatibility-other.html">Пред.</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="applications.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">4.5. Другое оборудование </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> Глава 6. Прикладные программы</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>