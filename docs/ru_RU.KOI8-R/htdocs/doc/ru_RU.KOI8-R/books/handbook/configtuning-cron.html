<?xml version="1.0" encoding="koi8-r" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=koi8-r" /><title>12.6. Настройка утилиты cron</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Руководство FreeBSD" /><link rel="up" href="config-tuning.html" title="Глава 12. Настройка и оптимизация" /><link rel="prev" href="configtuning-starting-services.html" title="12.5. Запуск сервисов" /><link rel="next" href="configtuning-rcd.html" title="12.7. Использование rc во FreeBSD 5.X и последующих версиях" /><link rel="copyright" href="legalnotice.html" title="Юридическое уведомление" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">12.6. Настройка утилиты <code class="command">cron</code></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="configtuning-starting-services.html">Пред.</a> </td><th width="60%" align="center">Глава 12. Настройка и оптимизация</th><td width="20%" align="right"> <a accesskey="n" href="configtuning-rcd.html">След.</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="configtuning-cron"></a>12.6. Настройка утилиты <code class="command">cron</code></h2></div><div><span class="authorgroup">Предоставил <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><a id="idp86610640" class="indexterm"></a><p>Одна из наиболее полезных утилит FreeBSD это <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a>.  Утилита
      <code class="command">cron</code> работает в фоновом режиме и постоянно проверяет
      файл <code class="filename">/etc/crontab</code>.  Утилита <code class="command">cron</code>
      проверяет также каталог <code class="filename">/var/cron/tabs</code> в поиске
      новых файлов <code class="filename">crontab</code>.  Файлы
      <code class="filename">crontab</code> содержат информацию об определенных
      функциях, которые <code class="command">cron</code> выполняет в указанное
      время.</p><p>Утилита <code class="command">cron</code> использует два разных типа
      конфигурационных файлов, системный и пользовательский.
      Все различие между этими двумя форматами заключается в
      шестом поле.  В системном файле шестое поля это имя пользователя,
      с правами которого будет запущена команда.  Это позволяет запускать
      команды из системного crontab от любого пользователя.  В
      пользовательском файле шестое поле указывает запускаемую команду, и
      все команды запускаются от пользователя, который создал crontab;
      это важно для безопасности.</p><div xmlns="" class="note"><h3 class="admontitle">Примечание: </h3><p xmlns="http://www.w3.org/1999/xhtml">Пользовательские crontab позволяют индивидуальным пользователям
	планировать задачи без привилегий суперпользователя
	(<code class="systemitem">root</code>).  Команды из
	crontab пользователя запускаются с привилегиями этого
	пользователя.</p><p xmlns="http://www.w3.org/1999/xhtml">Пользователь <code class="systemitem">root</code> может использовать
	собственный crontab, как и любой другой пользователь.  Он будет
	отличаться от системного crontab <code class="filename">/etc/crontab</code>.
	Поскольку существует системный crontab, обычно не требуется
	создавать пользовательский crontab для
	<code class="systemitem">root</code>.</p></div><p>Давайте заглянем в файл <code class="filename">/etc/crontab</code>
      (системный crontab):</p><pre class="programlisting"># /etc/crontab - root's crontab for FreeBSD
#
# $FreeBSD: src/etc/crontab,v 1.32 2002/11/22 16:13:39 tom Exp $
# <a id="co-comments"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
#
SHELL=/bin/sh
PATH=/etc:/bin:/sbin:/usr/bin:/usr/sbin <a id="co-env"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>
HOME=/var/log
#
#
#minute	hour	mday	month	wday	who	command <a id="co-field-descr"></a><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span>
#
#
*/5	*	*	*	*	root	/usr/libexec/atrun <a id="co-main"></a><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span>
</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co-comments"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Как и в большинстве файлов настройки FreeBSD, символы <span class="quote"><<<span class="quote">#</span>>></span>
	  означают комментарии.  Комментарии нужны для напоминания о том,
	  что означает строка и зачем она добавлена.  Комментарии не могут
	  находиться на той же строке, что и команда, или они будут
	  восприняты как часть команды; располагайте их на новой строке.
	  Пустые строки игнорируются.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-env"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Сначала должны быть заданы переменные окружения.  Знак равно
	  (<code class="literal">=</code>) используется для задания переменных
	  окружения, в этом примере <code class="envar">SHELL</code>,  <code class="envar">PATH</code>,
	  и <code class="envar">HOME</code>.  Если переменная для оболочки не задана,
	  <code class="command">cron</code> использует оболочку по умолчанию,
	  <code class="command">sh</code>.  Если не задана переменная
	  <code class="envar">PATH</code>, значение по умолчанию не устанавливается и
	  пути к файлам должны быть полными.  Если не задана переменная
	  <code class="envar">HOME</code>, <code class="command">cron</code> будет использовать
	  домашний каталог соответствующего пользователя.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-field-descr"><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span></a> </p></td><td valign="top" align="left"><p>В строке всего семь полей.  Их значения
	  <code class="literal">minute</code>, <code class="literal">hour</code>,
	  <code class="literal">mday</code>, <code class="literal">month</code>,
	  <code class="literal">wday</code>, <code class="literal">who</code> (кто), и
	  <code class="literal">command</code>.  Значение полей почти очевидно.
	  <code class="literal">minute</code> это время в минутах, когда будет запущена
	  команда.  <code class="literal">hour</code> означает то же самое для часов.
	  <code class="literal">mday</code> означает день месяца.
	  <code class="literal">month</code>, это то же самое, что час и минута,
	  но для месяцев.  Параметр <code class="literal">wday</code> это день
	  недели.  Все эти поля должны быть в
	  числовом формате, время в двадцатичетырехчасовом исчислении.
	  Поле <code class="literal">who</code> имеет специальное значение, и
	  присутствует только в файле <code class="filename">/etc/crontab</code>.
	  Это поле определяет пользователя, с правами которого должна быть
	  запущена команда.  Когда пользователь устанавливает собственный
	  файл <code class="filename">crontab</code>, он не указывает этот параметр.
	  Последний параметр <code class="literal">command</code>.  Он указывает команду, которая должна
	  быть запущена.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-main"><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Последняя строка определяет параметры, описанные выше.  Здесь
	  задано значение <code class="literal">*/5</code>, и несколько символов
	  <code class="literal">*</code>.  Эти символы <code class="literal">*</code> означают
	  <span class="quote"><<<span class="quote">первый-последний</span>>></span>, и могут быть интерпретированы как
	  <span class="emphasis"><em>каждый</em></span>.  Таким образом, для этой строки
	  соответствующая команда <code class="command">atrun</code> вызывается
	  под пользователем <code class="systemitem">root</code> каждые пять минут
	  независимо от дня или месяца.  За дополнительной информацией по
	  команде <code class="command">atrun</code> обращайтесь к странице справочника
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=atrun&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">atrun</span>(8)</span></a>.</p><p>Команды могут принимать любое количество параметров; однако
	  команды, состоящие из нескольких строк, должны быть объединены
	  символом <span class="quote"><<<span class="quote">\</span>>></span>.</p></td></tr></table></div><p>Этот формат одинаков для каждого файла <code class="filename">crontab</code>,
      за исключением одной детали.  Шестое поле, где указано имя пользователя,
      присутствует только в файле <code class="filename">/etc/crontab</code>.  Это
      поле должно быть исключено из <code class="filename">crontab</code> файлов
      пользователей.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="configtuning-installcrontab"></a>12.6.1. Установка crontab</h3></div></div></div><div xmlns="" class="important"><h3 class="admontitle">Важно: </h3><p xmlns="http://www.w3.org/1999/xhtml">Вы не должны использовать процедуру, описанную здесь, для
	установки системного crontab.  Просто используйте свой
	любимый текстовый редактор: утилита <code class="command">cron</code>
	узнает о том, что файл изменился и сразу начнет использовать
	обновленную версию.  Обратитесь к <a class="link" href="../../../../doc/ru_RU.KOI8-R/books/faq/admin.html#ROOT-NOT-FOUND-CRON-ERRORS" target="_top">этой
	части FAQ</a> за дальнейшей информацией.</p></div><p>Для установки готового <code class="filename">crontab</code> пользователя,
	сначала создайте в вашем любимом редакторе файл соответствующего
	формата, а затем воспользуйтесь утилитой
	<code class="command">crontab</code>.  Обычно она запускается
	так:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>crontab crontab-file</code></strong></pre><p>В этом примере, <code class="filename">crontab-file</code> это имя файла
	crontab, который только что был создан.</p><p>Существует также параметр для просмотра установленных файлов
	<code class="filename">crontab</code>: задайте <code class="command">crontab</code>
	параметр <code class="option">-l</code>.</p><p>Для пользователей, составляющих crontab вручную, без временного
	файла, существует параметр <code class="command">crontab -e</code>.
	Она вызовет редактор с пустым файлом.  Когда файл будет сохранен,
	<code class="command">crontab</code> автоматически установит его.</p><p>Если позднее вы захотите полностью удалить свой
	<code class="filename">crontab</code>, используйте
	<code class="command">crontab</code> с параметром <code class="option">-r</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="configtuning-starting-services.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="config-tuning.html">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="configtuning-rcd.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">12.5. Запуск сервисов </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 12.7. Использование rc во FreeBSD 5.X и последующих версиях</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Этот, и другие документы, могут быть скачаны с
    <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>По вопросам, связанным с FreeBSD, прочитайте
    <a href="http://www.FreeBSD.org/ru/docs.html">документацию</a> прежде чем писать в
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    По вопросам, связанным с этой документацией, пишите в рассылку
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.<br></br></small></p></body></html>