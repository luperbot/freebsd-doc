<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>Chapter 4. PMake for Gods</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="PMake &#8212; A Tutorial" /><link rel="up" href="index.html" title="PMake &#8212; A Tutorial" /><link rel="prev" href="moreexercises.html" title="3.7. More Exercises" /><link rel="next" href="archivesandlibraries.html" title="4.2. Archives and Libraries" /><link rel="copyright" href="legalnotice.html" title="Legal Notice" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 4. PMake for Gods</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="moreexercises.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="archivesandlibraries.html">Next</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="gods"></a>Chapter 4. PMake for Gods</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="gods.html#searchpaths">4.1. Search Paths</a></span></dt><dt><span class="section"><a href="archivesandlibraries.html">4.2. Archives and Libraries</a></span></dt><dt><span class="section"><a href="condition.html">4.3. On the Condition...</a></span></dt><dt><span class="section"><a href="ashell.html">4.4. A Shell is a Shell is a Shell</a></span></dt><dt><span class="section"><a href="compatibility.html">4.5. Compatibility</a></span></dt><dt><span class="section"><a href="defcon3.html">4.6. DEFCON 3 &#8211; Variable Expansion</a></span></dt><dt><span class="section"><a href="defcon2.html">4.7. DEFCON 2 &#8211; The Number of the Beast</a></span></dt><dt><span class="section"><a href="defcon1.html">4.8. DEFCON 1 &#8211; Imitation is the Not the Highest Form of
      Flattery</a></span></dt><dt><span class="section"><a href="theway.html">4.9. The Way Things Work</a></span></dt></dl></div><p>This chapter is devoted to those facilities in
    <span class="application">PMake</span> that allow you to do a great deal
    in a makefile with very little work, as well as do some things you
    could not do in <span class="application">Make</span> without a great
    deal of work (and perhaps the use of other programs).  The problem
    with these features, is they must be handled with care, or you
    will end up with a mess.</p><p>Once more, I assume a greater familiarity with <span class="trademark">UNIX</span>® or Sprite
    than I did in the previous two chapters.</p><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="searchpaths"></a>4.1. Search Paths</h2></div></div></div><p><span class="application">PMake</span> supports the dispersal of
      files into multiple directories by allowing you to specify
      places to look for sources with <code class="buildtarget">.PATH</code>
      targets in the makefile.  The directories you give as sources
      for these targets make up a <span class="quote">&#8220;<span class="quote">search path</span>&#8221;</span>.  Only
      those files used exclusively as sources are actually sought on a
      search path, the assumption being that anything listed as a
      target in the makefile can be created by the makefile and thus
      should be in the current directory.</p><p>There are two types of search paths in
      <span class="application">PMake</span>: one is used for all types of
      files (including included makefiles) and is specified with a
      plain <code class="buildtarget">.PATH</code> target (e.g. <code class="literal">.PATH
      : RCS</code>), while the other is specific to a certain
      type of file, as indicated by the file's suffix.  A specific
      search path is indicated by immediately following the
      <code class="buildtarget">.PATH</code> with the suffix of the file.  For
      instance:</p><pre class="programlisting">.PATH.h         : /sprite/lib/include /sprite/att/lib/include</pre><p>would tell <span class="application">PMake</span> to look in the
      directories <code class="filename">/sprite/lib/include</code> and
      <code class="filename">/sprite/att/lib/include</code> for any
      files whose suffix is <code class="filename">.h</code>.</p><p>The current directory is always consulted first to see if a
      file exists.  Only if it cannot be found there are the
      directories in the specific search path, followed by those in
      the general search path, consulted.</p><p>A search path is also used when expanding wildcard
      characters.  If the pattern has a recognizable suffix on it,
      the path for that suffix will be used for the expansion.
      Otherwise the default search path is employed.</p><p>When a file is found in some directory other than the
      current one, all local variables that would have contained the
      target's name (<code class="varname">.ALLSRC</code>, and
      <code class="varname">.IMPSRC</code>) will instead contain
      the path to the file, as found by
      <span class="application">PMake</span>.
      Thus if you have a file <code class="filename">../lib/mumble.c</code>
      and a makefile like this:</p><pre class="programlisting">.PATH.c         : ../lib
mumble          : mumble.c
	$(CC) -o $(.TARGET) $(.ALLSRC)</pre><p>the command executed to create mumble would be
      <code class="command">cc -o mumble ../lib/mumble.c.</code>
      (as an aside, the command in this case is not strictly
      necessary, since it will be found using transformation rules
      if it is not given.  This is because <code class="filename">.out</code>
      is the null suffix by default and a transformation exists
      from <code class="filename">.c</code> to
      <code class="filename">.out</code>.  Just thought I would throw that in).
      If a file exists in two directories on the same search path,
      the file in the first directory on the path will be the one
      <span class="application">PMake</span> uses.  So if you have
      a large system spread over many directories, it would
      behoove you to follow a naming convention that avoids such
      conflicts.</p><p>Something you should know about the way search paths are
      implemented is that each directory is read, and its contents
      cached, exactly once &#8211; when it is first encountered
      &#8211; so any changes to the directories while
      <span class="application">PMake</span> is running will not be noted
      when searching for implicit sources, nor will they be found when
      <span class="application">PMake</span> attempts to discover when the
      file was last modified, unless the file was created in the
      current directory.  While people have suggested that
      <span class="application">PMake</span> should read the directories
      each time, my experience suggests that the caching seldom causes
      problems.  In addition, not caching the directories slows things
      down enormously because of <span class="application">PMake</span>'s attempts
      to apply transformation rules through non-existent files &#8211; the
      number of extra file-system searches is truly staggering,
      especially if many files without suffixes are used and the null
      suffix is not changed from <code class="filename">.out</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="moreexercises.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="archivesandlibraries.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">3.7. More Exercises </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 4.2. Archives and Libraries</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>