<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>5.4. The Distribution Files</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD Porter's Handbook" /><link rel="up" href="makefiles.html" title="Chapter 5. Configuring the Makefile" /><link rel="prev" href="makefile-categories.html" title="5.3. Categorization" /><link rel="next" href="makefile-maintainer.html" title="5.5. MAINTAINER" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.4. The Distribution Files</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="makefile-categories.html">Prev</a> </td><th width="60%" align="center">Chapter 5. Configuring the Makefile</th><td width="20%" align="right"> <a accesskey="n" href="makefile-maintainer.html">Next</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-distfiles"></a>5.4. The Distribution Files</h2></div></div></div><p>The second part of the <code class="filename">Makefile</code>
      describes the files that must be downloaded to build
      the port, and where they can be downloaded.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-distversion"></a>5.4.1. <code class="varname">DISTVERSION/DISTNAME</code></h3></div></div></div><p><code class="varname">DISTNAME</code> is the name of the port as
	called by the authors of the software.
	<code class="varname">DISTNAME</code> defaults to
	<code class="literal">${PORTNAME}-${DISTVERSIONPREFIX}${DISTVERSION}${DISTVERSIONSUFFIX}</code>,
	and <code class="varname">DISTVERSION</code> defaults to
	<code class="literal">${PORTVERSION}</code> so override it
	only if necessary.  <code class="varname">DISTNAME</code> is only used
	in two places.  First, the distribution file list
	(<code class="varname">DISTFILES</code>) defaults to
	<code class="literal">${DISTNAME}</code><code class="literal">${EXTRACT_SUFX}</code>.
	Second, the distribution file is expected to extract into a
	subdirectory named <code class="varname">WRKSRC</code>, which defaults
	to <code class="filename">work/${DISTNAME}</code>.</p><p>Some vendor's distribution names which do not fit into the
	<code class="literal">${PORTNAME}-${PORTVERSION}</code>-scheme can be
	handled automatically by setting
	<code class="varname">DISTVERSION</code>.
	<code class="varname">PORTVERSION</code> will be derived from it
	automatically.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Only one of <code class="varname">PORTVERSION</code> and
	  <code class="varname">DISTVERSION</code> can be set at a time.  If
	  <code class="varname">DISTVERSION</code> does not derive a correct
	  <code class="varname">PORTVERSION</code>, do not use
	  <code class="varname">DISTVERSION</code>, set
	  <code class="varname">PORTVERSION</code> to the right value and set
	  <code class="varname">DISTNAME</code> with <code class="varname">PORTNAME</code>
	  with either some computation of
	  <code class="varname">PORTVERSION</code> or the verbatim upstream
	  version.</p></div><div class="table"><a id="idp67343696"></a><div class="table-title">Table 5.2. Examples of <code class="varname">DISTVERSION</code> and the
	  Derived <code class="varname">PORTVERSION</code></div><div class="table-contents"><table summary="Examples of DISTVERSION and the&#10;&#9;  Derived PORTVERSION" border="0"><colgroup><col /><col /></colgroup><thead><tr><th><code class="varname">DISTVERSION</code></th><th><code class="varname">PORTVERSION</code></th></tr></thead><tbody><tr><td>0.7.1d</td><td>0.7.1.d</td></tr><tr><td>10Alpha3</td><td>10.a3</td></tr><tr><td>3Beta7-pre2</td><td>3.b7.p2</td></tr><tr><td>8:f_17</td><td>8f.17</td></tr></tbody></table></div></div><br class="table-break" /><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">PKGNAMEPREFIX</code> and
	  <code class="varname">PKGNAMESUFFIX</code> do not affect
	  <code class="varname">DISTNAME</code>.  Also note that if
	  <code class="varname">WRKSRC</code> is equal to
	  <code class="filename">${WRKDIR}/${DISTNAME}</code> while
	  the original source archive is named something other than
	  <code class="literal">${PORTNAME}-${PORTVERSION}${EXTRACT_SUFX}</code>,
	  leave <code class="varname">DISTNAME</code>
	  alone&#8212; defining only
	  <code class="varname">DISTFILES</code> is easier than both
	  <code class="varname">DISTNAME</code> and <code class="varname">WRKSRC</code>
	  (and possibly <code class="varname">EXTRACT_SUFX</code>).</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-master_sites"></a>5.4.2. <code class="varname">MASTER_SITES</code></h3></div></div></div><p>Record the directory part of the FTP/HTTP-URL pointing at
	the original tarball in <code class="varname">MASTER_SITES</code>.  Do
	not forget the trailing slash (<code class="filename">/</code>)!</p><p>The <code class="command">make</code> macros will try to use this
	specification for grabbing the distribution file with
	<code class="varname">FETCH</code> if they cannot find it already on the
	system.</p><p>It is recommended that multiple sites are included on this
	list, preferably from different continents.  This will
	safeguard against wide-area network problems.  We are even
	planning to add support for automatically determining the
	closest master site and fetching from there; having multiple
	sites will go a long way towards helping this effort.</p><div xmlns="" class="important"><h3 class="admontitle">Important: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">MASTER_SITES</code> must not be blank.  It
	  must point to the actual site hosting the distribution
	  files.  It cannot point to web archives, or the FreeBSD
	  distribution files cache sites.  The only exception to this
	  rule is ports that do not have any distribution files.  For
	  example, meta-ports do not have any distribution files, so
	  <code class="varname">MASTER_SITES</code> does not need to be
	  set.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-master_sites-shorthand"></a>5.4.2.1. Using
	  <code class="varname">MASTER_SITE_<em class="replaceable"><code>*</code></em></code>
	  Variables</h4></div></div></div><p>Shortcut abbreviations are available for popular
	  archives like SourceForge (<code class="literal">SOURCEFORGE</code>),
	  GNU (<code class="literal">GNU</code>), or Perl CPAN
	  (<code class="literal">PERL_CPAN</code>).
	  <code class="varname">MASTER_SITES</code> can use them
	  directly:</p><pre class="programlisting">MASTER_SITES=	GNU/make</pre><p>The older expanded format still works, but all ports
	  have been converted to the compact format.  The expanded
	  format looks like this:</p><pre class="programlisting">MASTER_SITES=		${MASTER_SITE_GNU}
MASTER_SITE_SUBDIR=	make</pre><p>These values and variables are defined in <a class="link" href="https://svnweb.freebsd.org/ports/head/Mk/bsd.sites.mk?view=markup" target="_top"><code class="filename">Mk/bsd.sites.mk</code></a>.
	  New entries are added often, so make sure to check the
	  latest version of this file before submitting a port.</p><div xmlns="" class="tip"><h3 class="admontitle">Tip: </h3><p xmlns="http://www.w3.org/1999/xhtml">For any
	    <code class="varname">MASTER_SITE_<em class="replaceable"><code>FOO</code></em></code>
	    variable, the shorthand
	    <code class="literal"><em class="replaceable"><code>FOO</code></em></code> can be
	    used.  For example, use:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">MASTER_SITES=	<em class="replaceable"><code>FOO</code></em></pre><p xmlns="http://www.w3.org/1999/xhtml">If <code class="varname">MASTER_SITE_SUBDIR</code> is needed,
	    use this:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">MASTER_SITES=	<em class="replaceable"><code>FOO</code></em>/<em class="replaceable"><code>bar</code></em></pre></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Some
	    <code class="varname">MASTER_SITE_<em class="replaceable"><code>*</code></em></code>
	    names are quite long, and for ease of use, shortcuts have
	    been defined:</p><div xmlns="http://www.w3.org/1999/xhtml" class="table"><a id="makefile-master_sites-shortcut"></a><div class="table-title">Table 5.3. Shortcuts for
	      <code class="varname">MASTER_SITE_<em class="replaceable"><code>*</code></em></code>
	      Macros</div><div class="table-contents"><table summary="Shortcuts for&#10;&#9;      MASTER_SITE_*&#10;&#9;      Macros" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Macro</th><th>Shortcut</th></tr></thead><tbody><tr><td><code class="varname">PERL_CPAN</code></td><td><code class="varname">CPAN</code></td></tr><tr><td><code class="varname">GITHUB</code></td><td><code class="varname">GH</code></td></tr><tr><td><code class="varname">GITHUB_CLOUD</code></td><td><code class="varname">GHC</code></td></tr><tr><td><code class="varname">LIBREOFFICE_DEV</code></td><td><code class="varname">LODEV</code></td></tr><tr><td><code class="varname">NETLIB</code></td><td><code class="varname">NL</code></td></tr><tr><td><code class="varname">RUBYGEMS</code></td><td><code class="varname">RG</code></td></tr><tr><td><code class="varname">SOURCEFORGE</code></td><td><code class="varname">SF</code></td></tr><tr><td><code class="varname">SOURCEFORGE_JP</code></td><td><code class="varname">SFJP</code></td></tr></tbody></table></div></div><br xmlns="http://www.w3.org/1999/xhtml" class="table-break" /></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-master_sites-magic"></a>5.4.2.2. Magic MASTER_SITES Macros</h4></div></div></div><p>Several <span class="quote">&#8220;<span class="quote">magic</span>&#8221;</span> macros exist for
	  popular sites with a predictable directory structure.  For
	  these, just use the abbreviation and the system will choose
	  a subdirectory automatically.  For a port
	  named <code class="literal">Stardict</code>, of version
	  <code class="literal">1.2.3</code>, and hosted on SourceForge, adding
	  this line:</p><pre class="programlisting">MASTER_SITES=	SF</pre><p>infers a subdirectory named
	  <code class="literal">/project/stardict/stardict/1.2.3</code>.  If the
	  inferred directory is incorrect, it can be
	  overridden:</p><pre class="programlisting">MASTER_SITES=	SF/stardict/WyabdcRealPeopleTTS/${PORTVERSION}</pre><p>This can also be written as</p><pre class="programlisting">MASTER_SITES=	SF
MASTER_SITE_SUBDIR=	stardict/WyabdcRealPeopleTTS/${PORTVERSION}</pre><div class="table"><a id="makefile-master_sites-popular"></a><div class="table-title">Table 5.4. Magic <code class="varname">MASTER_SITES</code>
	    Macros</div><div class="table-contents"><table summary="Magic MASTER_SITES&#10;&#9;    Macros" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Macro</th><th>Assumed subdirectory</th></tr></thead><tbody><tr><td><code class="varname">APACHE_COMMONS_BINARIES</code></td><td><code class="literal">${PORTNAME:S,commons-,,}</code></td></tr><tr><td><code class="varname">APACHE_COMMONS_SOURCE</code></td><td><code class="literal">${PORTNAME:S,commons-,,}</code></td></tr><tr><td><code class="varname">APACHE_JAKARTA</code></td><td><code class="literal">${PORTNAME:S,-,/,}/source</code></td></tr><tr><td><code class="varname">BERLIOS</code></td><td><code class="literal">${PORTNAME:tl}.berlios</code></td></tr><tr><td><code class="varname">CHEESESHOP</code></td><td><code class="literal">source/${DISTNAME:C/(.).*/\1/}/${DISTNAME:C/(.*)-[0-9].*/\1/}</code></td></tr><tr><td><code class="varname">CPAN</code></td><td><code class="literal">${PORTNAME:C/-.*//}</code></td></tr><tr><td><code class="varname">DEBIAN</code></td><td><code class="literal">pool/main/${PORTNAME:C/^((lib)?.).*$/\1/}/${PORTNAME}</code></td></tr><tr><td><code class="varname">FARSIGHT</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">FESTIVAL</code></td><td><code class="literal">${PORTREVISION}</code></td></tr><tr><td><code class="varname">GCC</code></td><td><code class="literal">releases/${DISTNAME}</code></td></tr><tr><td><code class="varname">GENTOO</code></td><td><code class="literal">distfiles</code></td></tr><tr><td><code class="varname">GIMP</code></td><td><code class="literal">${PORTNAME}/${PORTVERSION:R}/</code></td></tr><tr><td><code class="varname">GH</code></td><td><code class="literal">${GH_ACCOUNT}/${GH_PROJECT}/tar.gz/${GH_TAGNAME}?dummy=/</code></td></tr><tr><td><code class="varname">GHC</code></td><td><code class="literal">${GH_ACCOUNT}/${GH_PROJECT}/</code></td></tr><tr><td><code class="varname">GNOME</code></td><td><code class="literal">sources/${PORTNAME}/${PORTVERSION:C/^([0-9]+\.[0-9]+).*/\1/}</code></td></tr><tr><td><code class="varname">GNU</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">GNUPG</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">GNU_ALPHA</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">HORDE</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">LODEV</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">MATE</code></td><td><code class="literal">${PORTVERSION:C/^([0-9]+\.[0-9]+).*/\1/}</code></td></tr><tr><td><code class="varname">MOZDEV</code></td><td><code class="literal">${PORTNAME:tl}</code></td></tr><tr><td><code class="varname">NL</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">QT</code></td><td><code class="literal">archive/qt/${PORTVERSION:R}</code></td></tr><tr><td><code class="varname">SAMBA</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">SAVANNAH</code></td><td><code class="literal">${PORTNAME:tl}</code></td></tr><tr><td><code class="varname">SF</code></td><td><code class="literal">${PORTNAME:tl}/${PORTNAME:tl}/${PORTVERSION}</code></td></tr></tbody></table></div></div><br class="table-break" /></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-master_sites-github"></a>5.4.3. <code class="varname">USE_GITHUB</code></h3></div></div></div><p>If the distribution file comes from a specific commit or
	tag on <a class="link" href="https://github.com" target="_top">GitHub</a>
	for which there is no officially released file, there is an
	easy way to set the right <code class="varname">DISTNAME</code> and
	<code class="varname">MASTER_SITES</code> automatically.  These
	variables are available:</p><div class="table"><a id="makefile-master_sites-github-description"></a><div class="table-title">Table 5.5. <code class="varname">USE_GITHUB</code> Description</div><div class="table-contents"><table summary="USE_GITHUB Description" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Variable</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code class="varname">GH_ACCOUNT</code></td><td>Account name of the GitHub user hosting the
		project</td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">GH_PROJECT</code></td><td>Name of the project on GitHub</td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">GH_TAGNAME</code></td><td>Name of the tag to download (2.0.1, hash, ...)
		Using the name of a branch here is incorrect.  It is
		also possible to use the hash of a commit id to do a
		snapshot.</td><td><code class="literal">${DISTVERSIONPREFIX}${DISTVERSION}${DISTVERSIONSUFFIX}</code></td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="makefile-master_sites-github-ex1"></a><div class="example-title">Example 5.1. Simple Use of <code class="varname">USE_GITHUB</code></div><div class="example-contents"><p>While trying to make a port for version
	  <code class="literal">1.2.7</code> of <span class="application">pkg</span>
	  from the FreeBSD user on github, at <a class="link" href="https://github.com/freebsd/pkg" target="_top">https://github.com/freebsd/pkg</a>, The
	  <code class="filename">Makefile</code> would end up looking like
	  this (slightly stripped for the example):</p><pre class="programlisting">PORTNAME=	pkg
PORTVERSION=	1.2.7

USE_GITHUB=	yes
GH_ACCOUNT=	freebsd</pre><p>It will automatically have
	  <code class="varname">MASTER_SITES</code> set to <code class="literal">GH
	    GHC</code> and <code class="varname">WRKSRC</code> to
	  <code class="literal">${WRKDIR}/pkg-1.2.7</code>.</p></div></div><br class="example-break" /><div class="example"><a id="makefile-master_sites-github-ex2"></a><div class="example-title">Example 5.2. More Complete Use of
	  <code class="varname">USE_GITHUB</code></div><div class="example-contents"><p>While trying to make a port for the bleeding edge
	  version of <span class="application">pkg</span> from the FreeBSD
	  user on github, at <a class="link" href="https://github.com/freebsd/pkg" target="_top">https://github.com/freebsd/pkg</a>, the
	  <code class="filename">Makefile</code> ends up looking like
	  this (slightly stripped for the example):</p><pre class="programlisting">PORTNAME=	pkg-devel
PORTVERSION=	1.3.0.a.20140411

USE_GITHUB=	yes
GH_ACCOUNT=	freebsd
GH_PROJECT=	pkg
GH_TAGNAME=	6dbb17b</pre><p>It will automatically have
	  <code class="varname">MASTER_SITES</code> set to <code class="literal">GH
	    GHC</code> and <code class="varname">WRKSRC</code> to
	  <code class="literal">${WRKDIR}/pkg-6dbb17b</code>.</p></div></div><br class="example-break" /><div class="example"><a id="makefile-master_sites-github-ex3"></a><div class="example-title">Example 5.3. Use of <code class="varname">USE_GITHUB</code> with
	  <code class="varname">DISTVERSIONPREFIX</code></div><div class="example-contents"><p>From time to time, <code class="varname">GH_TAGNAME</code> is a
	  slight variation from <code class="varname">DISTVERSION</code>.
	  For example, if the version is <code class="literal">1.0.2</code>,
	  the tag is <code class="literal">v1.0.2</code>.  In those cases, it
	  is possible to use <code class="varname">DISTVERSIONPREFIX</code> or
	  <code class="varname">DISTVERSIONSUFFIX</code>:</p><pre class="programlisting">PORTNAME=	foo
PORTVERSION=	1.0.2
DISTVERSIONPREFIX=	v

USE_GITHUB=	yes</pre><p>It will automatically set
	  <code class="varname">GH_TAGNAME</code> to
	  <code class="literal">v1.0.2</code>, while <code class="varname">WRKSRC</code>
	  will be kept to
	  <code class="varname">${WRKDIR}/foo-1.0.2</code>.</p></div></div><br class="example-break" /><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp67516240"></a>5.4.3.1. Fetching Multiple Files From GitHub</h4></div></div></div><p>The <code class="varname">USE_GITHUB</code> framework also
	  supports fetching multiple distribution files from
	  different places in GitHub.  It works in a way very
	  similar to <a class="xref" href="makefile-distfiles.html#porting-master-sites-n" title="5.4.8. Multiple Distribution or Patches Files from Multiple Locations">Section 5.4.8, &#8220;Multiple Distribution or Patches Files from Multiple
	Locations&#8221;</a>.</p><p>Multiple values are added to
	  <code class="varname">GH_ACCOUNT</code>,
	  <code class="varname">GH_PROJECT</code>, and
	  <code class="varname">GH_TAGNAME</code>.  Each different value is
	  assigned a tag.  The main value can either have no tag, or
	  the <code class="literal">:DEFAULT</code> tag.  A value can be
	  omitted if it is the same as the default as listed in
	  <a class="xref" href="makefile-distfiles.html#makefile-master_sites-github-description" title="Table 5.5. USE_GITHUB Description">Table 5.5, &#8220;<code class="varname">USE_GITHUB</code> Description&#8221;</a>.</p><p>For each tag, a
	  <code class="varname">${WRKSRC_<em class="replaceable"><code>tag</code></em>}</code>
	  helper variable is created, containing the directory into
	  which the file has been extracted.  The
	  <code class="varname">${WRKSRC_<em class="replaceable"><code>tag</code></em>}</code>
	  variables can be used to move directories around during
	  <code class="buildtarget">post-extract</code>, or add to
	  <code class="varname">CONFIGURE_ARGS</code>, or whatever is needed
	  so that the software builds correctly.</p><div class="example"><a id="makefile-master_sites-github-multi"></a><div class="example-title">Example 5.4. Use of <code class="varname">USE_GITHUB</code> with Multiple
	    Distribution Files</div><div class="example-contents"><p>From time to time, there is a need to fetch more
	    than one distribution file.  For example, when the
	    upstream git repository uses submodules.  This can be
	    done easily using tags in the
	    <code class="varname">GH_<em class="replaceable"><code>*</code></em></code>
	    variables:</p><pre class="programlisting">PORTNAME=	foo
PORTVERSION=	1.0.2

USE_GITHUB=	yes
GH_ACCOUNT=	bar:icons,contrib
GH_PROJECT=	foo-icons:icons foo-contrib:contrib
GH_TAGNAME=	1.0:icons fa579bc:contrib

CONFIGURE_ARGS=	--with-contrib=${WRKSRC_contrib}

post-extract:
      @${MV} ${WRKSRC_icons} ${WRKSRC}/icons</pre><p>This will fetch three distribution files from
	    github.  The default one comes from
	    <code class="filename">foo/foo</code> and is version
	    <code class="literal">1.0.2</code>.  The second one, tagged
	    <code class="literal">icons</code>, comes from
	    <code class="filename">bar/foo-icons</code> and is in version
	    <code class="literal">1.0</code>.  The third one comes from
	    <code class="filename">bar/foo-contrib</code> and uses the
	    <span class="application">Git</span> commit
	    <code class="literal">fa579bc</code>.  The distribution files are
	    named <code class="filename">foo-foo-1.0.2_GH0.tar.gz</code>,
	    <code class="filename">bar-foo-icons-1.0_GH0.tar.gz</code>, and
	    <code class="filename">bar-foo-contrib-fa579bc_GH0.tar.gz</code>.</p><p>All the distribution files are extracted in
	    <code class="varname">${WRKDIR}</code> in their respective
	    subdirectories.  The default file is still extracted in
	    <code class="varname">${WRKSRC}</code>, in this case,
	    <code class="filename">${WRKDIR}/foo-1.0.2</code>.  Each
	    additional distribution file is extracted in
	    <code class="varname">${WRKSRC_<em class="replaceable"><code>tag</code></em>}</code>.
	    Here, for the <code class="literal">icons</code> tag, it is called
	    <code class="varname">${WRKSRC_icons}</code> and it contains
	    <code class="filename">${WRKDIR}/foo-icons-1.0</code>.  The file
	    with the <code class="literal">contrib</code> tag is called
	    <code class="varname">${WRKSRC_contrib}</code> and contains
	    <code class="literal">${WRKDIR}/foo-contrib-fa579bc</code>.</p></div></div><br class="example-break" /></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-extract_sufx"></a>5.4.4. <code class="varname">EXTRACT_SUFX</code></h3></div></div></div><p>If there is one distribution file, and it uses an odd
	suffix to indicate the compression mechanism, set
	<code class="varname">EXTRACT_SUFX</code>.</p><p>For example, if the distribution file was named
	<code class="filename">foo.tar.gzip</code> instead of the more normal
	<code class="filename">foo.tar.gz</code>, write:</p><pre class="programlisting">DISTNAME=	foo
EXTRACT_SUFX=	.tar.gzip</pre><p>The
	<code class="literal">USES=tar[:<em class="replaceable"><code>xxx</code></em>]</code>,
	<code class="literal">USES=lha</code> or <code class="literal">USES=zip</code>
	automatically set <code class="varname">EXTRACT_SUFX</code> to the most
	common archives extensions as necessary, see <a class="xref" href="uses.html#uses-values">Chapter 15, <em>Values of
    <code class="varname">USES</code></em></a> for more details.  If neither of
	these are set then <code class="varname">EXTRACT_SUFX</code> defaults to
	<code class="literal">.tar.gz</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">As <code class="varname">EXTRACT_SUFX</code> is only used in
	  <code class="varname">DISTFILES</code>, only set one of them..</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-distfiles-definition"></a>5.4.5. <code class="varname">DISTFILES</code></h3></div></div></div><p>Sometimes the names of the files to be downloaded have no
	resemblance to the name of the port.  For example, it might be
	called <code class="filename">source.tar.gz</code> or similar.  In
	other cases the application's source code might be in several
	different archives, all of which must be downloaded.</p><p>If this is the case, set <code class="varname">DISTFILES</code> to
	be a space separated list of all the files that must be
	downloaded.</p><pre class="programlisting">DISTFILES=	source1.tar.gz source2.tar.gz</pre><p>If not explicitly set, <code class="varname">DISTFILES</code>
	defaults to
	<code class="literal">${DISTNAME}${EXTRACT_SUFX}</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-extract_only"></a>5.4.6. <code class="varname">EXTRACT_ONLY</code></h3></div></div></div><p>If only some of the <code class="varname">DISTFILES</code> must be
	extracted&#8212;for example, one of them is the source code,
	while another is an uncompressed document&#8212;list the
	filenames that must be extracted in
	<code class="varname">EXTRACT_ONLY</code>.</p><pre class="programlisting">DISTFILES=	source.tar.gz manual.html
EXTRACT_ONLY=	source.tar.gz</pre><p>When none of the <code class="varname">DISTFILES</code> need to be
	uncompressed, set <code class="varname">EXTRACT_ONLY</code> to the empty
	string.</p><pre class="programlisting">EXTRACT_ONLY=</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-patchfiles"></a>5.4.7. <code class="varname">PATCHFILES</code></h3></div></div></div><p>If the port requires some additional patches that are
	available by <acronym class="acronym">FTP</acronym> or
	<acronym class="acronym">HTTP</acronym>, set <code class="varname">PATCHFILES</code> to
	the names of the files and <code class="varname">PATCH_SITES</code> to
	the URL of the directory that contains them (the format is the
	same as <code class="varname">MASTER_SITES</code>).</p><p>If the patch is not relative to the top of the source tree
	(that is, <code class="varname">WRKSRC</code>) because it contains some
	extra pathnames, set <code class="varname">PATCH_DIST_STRIP</code>
	accordingly.  For instance, if all the pathnames in the patch
	have an extra <code class="literal">foozolix-1.0/</code> in front of the
	filenames, then set
	<code class="literal">PATCH_DIST_STRIP=-p1</code>.</p><p>Do not worry if the patches are compressed; they will be
	decompressed automatically if the filenames end with
	<code class="filename">.Z</code>, <code class="filename">.gz</code>,
	<code class="filename">.bz2</code> or <code class="filename">.xz</code>.</p><p>If the patch is distributed with some other files, such as
	documentation, in a <code class="command">gzip</code>ped tarball, using
	<code class="varname">PATCHFILES</code> is not possible.  If that is the
	case, add the name and the location of the patch tarball to
	<code class="varname">DISTFILES</code> and
	<code class="varname">MASTER_SITES</code>.  Then, use
	<code class="varname">EXTRA_PATCHES</code> to point to those
	files and <code class="filename">bsd.port.mk</code> will automatically
	apply them.  In particular, do
	<span class="emphasis"><em>not</em></span> copy patch files into
	<code class="filename">${PATCHDIR}</code>.  That directory may
	not be writable.</p><div xmlns="" class="tip"><h3 class="admontitle">Tip: </h3><p xmlns="http://www.w3.org/1999/xhtml">If there are multiple patches and they need mixed values
	  for the strip parameter, it can be added alongside the patch
	  name in <code class="varname">PATCHFILES</code>, e.g:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">PATCHFILES=	patch1 patch2:-p1</pre><p xmlns="http://www.w3.org/1999/xhtml">This does not conflict with <a class="link" href="makefile-distfiles.html#porting-master-sites-n" title="5.4.8. Multiple Distribution or Patches Files from Multiple Locations">the master site grouping
	    feature</a>, adding a group also works:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">PATCHFILES=	patch2:-p1:source2</pre></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The tarball will have been extracted alongside the
	  regular source by then, so there is no need to explicitly
	  extract it if it is a regular <code class="command">gzip</code>ped or
	  <code class="command">compress</code>ed tarball.  Take extra care not
	  to overwrite something that already exists in that
	  directory if extracting it manually.  Also, do not forget to
	  add a command to remove the copied patch in the
	  <code class="buildtarget">pre-clean</code> target.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-master-sites-n"></a>5.4.8. Multiple Distribution or Patches Files from Multiple
	Locations</h3></div></div></div><p>(Consider this to be a somewhat
	<span class="quote">&#8220;<span class="quote">advanced topic</span>&#8221;</span>; those new to this document
	may wish to skip this section at first).</p><p>This section has information on the fetching mechanism
	known as both <code class="literal">MASTER_SITES:n</code> and
	<code class="literal">MASTER_SITES_NN</code>.  We will refer to this
	mechanism as <code class="literal">MASTER_SITES:n</code>.</p><p>A little background first.  OpenBSD has a neat feature
	inside <code class="varname">DISTFILES</code> and
	<code class="varname">PATCHFILES</code> which allows files and
	patches to be postfixed with <code class="literal">:n</code>
	identifiers.  Here, <code class="literal">n</code> can be both
	<code class="literal">[0-9]</code> and denote a group designation.  For
	example:</p><pre class="programlisting">DISTFILES=	alpha:0 beta:1</pre><p>In OpenBSD, distribution file <code class="filename">alpha</code>
	will be associated with variable
	<code class="varname">MASTER_SITES0</code> instead of our common
	<code class="varname">MASTER_SITES</code> and
	<code class="filename">beta</code> with
	<code class="varname">MASTER_SITES1</code>.</p><p>This is a very interesting feature which can decrease
	that endless search for the correct download site.</p><p>Just picture 2 files in <code class="varname">DISTFILES</code> and
	20 sites in <code class="varname">MASTER_SITES</code>, the sites slow as
	hell where <code class="filename">beta</code> is carried by all sites
	in <code class="varname">MASTER_SITES</code>, and
	<code class="filename">alpha</code> can only be found in the 20th site.
	It would be such a waste to check all of them if the
	maintainer knew this beforehand, would it not?  Not a good
	start for that lovely weekend!</p><p>Now that you have the idea, just imagine more
	<code class="varname">DISTFILES</code> and more
	<code class="varname">MASTER_SITES</code>.  Surely our
	<span class="quote">&#8220;<span class="quote">distfiles survey meister</span>&#8221;</span> would appreciate the
	relief to network strain that this would bring.</p><p>In the next sections, information will follow on the
	FreeBSD implementation of this idea.  We improved a bit on
	OpenBSD's concept.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-master-sites-n-simplified"></a>5.4.8.1. Simplified Information</h4></div></div></div><p>This section explains how to quickly prepare fine
	  grained fetching of multiple distribution files and patches
	  from different sites and subdirectories.  We describe here a
	  case of simplified <code class="literal">MASTER_SITES:n</code> usage.
	  This will be sufficient for most scenarios.  More detailed
	  information are available in <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-detailed" title="5.4.8.2. Detailed Information">Section 5.4.8.2, &#8220;Detailed Information&#8221;</a>.</p><p>Some applications consist of multiple distribution files
	  that must be downloaded from a number of different sites.
	  For example, <span class="application">Ghostscript</span> consists
	  of the core of the program, and then a large number of
	  driver files that are used depending on the user's printer.
	  Some of these driver files are supplied with the core, but
	  many others must be downloaded from a variety of different
	  sites.</p><p>To support this, each entry in
	  <code class="varname">DISTFILES</code> may be followed by a colon and
	  a <span class="quote">&#8220;<span class="quote">tag name</span>&#8221;</span>.  Each site listed in
	  <code class="varname">MASTER_SITES</code> is then followed by a colon,
	  and the tag that indicates which distribution files are
	  downloaded from this site.</p><p>For example, consider an application with the source
	  split in two parts, <code class="filename">source1.tar.gz</code> and
	  <code class="filename">source2.tar.gz</code>, which must be
	  downloaded from two different sites.  The port's
	  <code class="filename">Makefile</code> would include lines like <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-simple-use-one-file-per-site" title="Example 5.5. Simplified Use of MASTER_SITES:n with One File Per Site">Example 5.5, &#8220;Simplified Use of <code class="literal">MASTER_SITES:n</code>
	    with One File Per Site&#8221;</a>.</p><div class="example"><a id="ports-master-sites-n-example-simple-use-one-file-per-site"></a><div class="example-title">Example 5.5. Simplified Use of <code class="literal">MASTER_SITES:n</code>
	    with One File Per Site</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	ftp://ftp1.example.com/:source1 \
		http://www.example.com/:source2
DISTFILES=	source1.tar.gz:source1 \
		source2.tar.gz:source2</pre></div></div><br class="example-break" /><p>Multiple distribution files can have the same tag.
	  Continuing the previous example, suppose that there was a
	  third distfile, <code class="filename">source3.tar.gz</code>, that
	  is downloaded from
	  <code class="systemitem">ftp.example2.com</code>.  The
	  <code class="filename">Makefile</code> would then be written like
	  <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-simple-use-more-than-one-file-per-site" title="Example 5.6. Simplified Use of MASTER_SITES:n with More Than One File Per Site">Example 5.6, &#8220;Simplified Use of <code class="literal">MASTER_SITES:n</code>
	    with More Than One File Per Site&#8221;</a>.</p><div class="example"><a id="ports-master-sites-n-example-simple-use-more-than-one-file-per-site"></a><div class="example-title">Example 5.6. Simplified Use of <code class="literal">MASTER_SITES:n</code>
	    with More Than One File Per Site</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	ftp://ftp.example.com/:source1 \
		http://www.example.com/:source2
DISTFILES=	source1.tar.gz:source1 \
		source2.tar.gz:source2 \
		source3.tar.gz:source2</pre></div></div><br class="example-break" /></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ports-master-sites-n-detailed"></a>5.4.8.2. Detailed Information</h4></div></div></div><p>Okay, so the previous example did not reflect the new
	  port's needs?  In this section we will explain in detail how
	  the fine grained fetching mechanism
	  <code class="literal">MASTER_SITES:n</code> works and how it can
	  be used.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Elements can be postfixed with
	      <code class="literal">:<em class="replaceable"><code>n</code></em></code> where
	      <em class="replaceable"><code>n</code></em> is
	      <code class="literal">[^:,]+</code>, that is,
	      <em class="replaceable"><code>n</code></em> could conceptually be any
	      alphanumeric string but we will limit it to
	      <code class="literal">[a-zA-Z_][0-9a-zA-Z_]+</code> for
	      now.</p><p>Moreover, string matching is case sensitive; that
	      is, <code class="literal">n</code> is different from
	      <code class="literal">N</code>.</p><p>However, these words cannot be used for
	      postfixing purposes since they yield special meaning:
	      <code class="literal">default</code>, <code class="literal">all</code> and
	      <code class="literal">ALL</code> (they are used internally in
	      item <a class="xref" href="makefile-distfiles.html#porting-master-sites-n-what-changes-in-port-targets">ii</a>).
	      Furthermore, <code class="literal">DEFAULT</code> is a special
	      purpose word (check item <a class="xref" href="makefile-distfiles.html#porting-master-sites-n-DEFAULT-group">3</a>).</p></li><li class="listitem"><p>Elements postfixed with <code class="literal">:n</code>
	      belong to the group <code class="literal">n</code>,
	      <code class="literal">:m</code> belong to group
	      <code class="literal">m</code> and so forth.</p></li><li class="listitem"><p><a id="porting-master-sites-n-DEFAULT-group"></a>Elements without a postfix are groupless, they
	      all belong to the special group
	      <code class="literal">DEFAULT</code>.  Any elements postfixed
	      with <code class="literal">DEFAULT</code>, is just being
	      redundant unless an element belongs
	      to both <code class="literal">DEFAULT</code> and other groups at
	      the same time (check item <a class="xref" href="makefile-distfiles.html#porting-master-sites-n-comma-operator">5</a>).</p><p>These examples are equivalent but the first
	      one is preferred:</p><pre class="programlisting">MASTER_SITES=	alpha</pre><pre class="programlisting">MASTER_SITES=	alpha:DEFAULT</pre></li><li class="listitem"><p>Groups are not exclusive, an element may belong to
	      several different groups at the same time and a group
	      can either have either several different elements or
	      none at all.</p></li><li class="listitem"><p><a id="porting-master-sites-n-comma-operator"></a>When an element belongs to several groups
	      at the same time, use the comma operator
	      (<code class="literal">,</code>).</p><p>Instead of repeating it several times, each time
	      with a different postfix, we can list several groups at
	      once in a single postfix.  For instance,
	      <code class="literal">:m,n,o</code> marks an element that belongs
	      to group <code class="literal">m</code>, <code class="literal">n</code> and
	      <code class="literal">o</code>.</p><p>All these examples are equivalent but the
	      last one is preferred:</p><pre class="programlisting">MASTER_SITES=	alpha alpha:SOME_SITE</pre><pre class="programlisting">MASTER_SITES=	alpha:DEFAULT alpha:SOME_SITE</pre><pre class="programlisting">MASTER_SITES=	alpha:SOME_SITE,DEFAULT</pre><pre class="programlisting">MASTER_SITES=	alpha:DEFAULT,SOME_SITE</pre></li><li class="listitem"><p>All sites within a given group are sorted according
	      to <code class="varname">MASTER_SORT_AWK</code>.  All groups
	      within <code class="varname">MASTER_SITES</code> and
	      <code class="varname">PATCH_SITES</code> are sorted as
	      well.</p></li><li class="listitem"><p><a id="porting-master-sites-n-group-semantics"></a>Group semantics can be used in any of the
	      variables <code class="varname">MASTER_SITES</code>,
	      <code class="varname">PATCH_SITES</code>,
	      <code class="varname">MASTER_SITE_SUBDIR</code>,
	      <code class="varname">PATCH_SITE_SUBDIR</code>,
	      <code class="varname">DISTFILES</code>, and
	      <code class="varname">PATCHFILES</code> according to this
	      syntax:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>All <code class="varname">MASTER_SITES</code>,
		  <code class="varname">PATCH_SITES</code>,
		  <code class="varname">MASTER_SITE_SUBDIR</code> and
		  <code class="varname">PATCH_SITE_SUBDIR</code> elements must
		  be terminated with the forward slash
		  <code class="literal">/</code> character.  If any elements
		  belong to any groups, the group postfix
		  <code class="literal">:<em class="replaceable"><code>n</code></em></code>
		  must come right after the terminator
		  <code class="literal">/</code>.  The
		  <code class="literal">MASTER_SITES:n</code> mechanism relies
		  on the existence of the terminator
		  <code class="literal">/</code> to avoid confusing elements
		  where a <code class="literal">:n</code> is a valid part of the
		  element with occurrences where <code class="literal">:n</code>
		  denotes group <code class="literal">n</code>.  For
		  compatibility purposes, since the
		  <code class="literal">/</code> terminator was not required
		  before in both <code class="varname">MASTER_SITE_SUBDIR</code>
		  and <code class="varname">PATCH_SITE_SUBDIR</code> elements,
		  if the postfix immediate preceding character is not
		  a <code class="literal">/</code> then <code class="literal">:n</code>
		  will be considered a valid part of the element
		  instead of a group postfix even if an element is
		  postfixed with <code class="literal">:n</code>.  See both
		  <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-detailed-use-master-site-subdir" title="Example 5.7. Detailed Use of MASTER_SITES:n in MASTER_SITE_SUBDIR">Example 5.7, &#8220;Detailed Use of
		    <code class="literal">MASTER_SITES:n</code> in
		    <code class="varname">MASTER_SITE_SUBDIR</code>&#8221;</a>
		  and <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-detailed-use-complete-example-master-sites" title="Example 5.8. Detailed Use of MASTER_SITES:n with Comma Operator, Multiple Files, Multiple Sites and Multiple Subdirectories">Example 5.8, &#8220;Detailed Use of
		    <code class="literal">MASTER_SITES:n</code> with Comma
		    Operator, Multiple Files, Multiple Sites and
		    Multiple Subdirectories&#8221;</a>.</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-master-site-subdir"></a><div class="example-title">Example 5.7. Detailed Use of
		    <code class="literal">MASTER_SITES:n</code> in
		    <code class="varname">MASTER_SITE_SUBDIR</code></div><div class="example-contents"><pre class="programlisting">MASTER_SITE_SUBDIR=	old:n new/:NEW</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Directories within group
			<code class="literal">DEFAULT</code> -&gt;
			old:n</p></li><li class="listitem"><p>Directories within group
			<code class="literal">NEW</code> -&gt; new</p></li></ul></div></div></div><br class="example-break" /><div class="example"><a id="ports-master-sites-n-example-detailed-use-complete-example-master-sites"></a><div class="example-title">Example 5.8. Detailed Use of
		    <code class="literal">MASTER_SITES:n</code> with Comma
		    Operator, Multiple Files, Multiple Sites and
		    Multiple Subdirectories</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	http://site1/%SUBDIR%/ http://site2/:DEFAULT \
		http://site3/:group3 http://site4/:group4 \
		http://site5/:group5 http://site6/:group6 \
		http://site7/:DEFAULT,group6 \
		http://site8/%SUBDIR%/:group6,group7 \
		http://site9/:group8
DISTFILES=	file1 file2:DEFAULT file3:group3 \
		file4:group4,group5,group6 file5:grouping \
		file6:group7
MASTER_SITE_SUBDIR=	directory-trial:1 directory-n/:groupn \
		directory-one/:group6,DEFAULT \
		directory</pre><p>The previous example results in this
		    fine grained fetching.  Sites are listed in the
		    exact order they will be used.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">file1</code> will be
			fetched from</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site1/directory-trial:1/</p></li><li class="listitem"><p>http://site1/directory-one/</p></li><li class="listitem"><p>http://site1/directory/</p></li><li class="listitem"><p>http://site2/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file2</code> will be fetched
			exactly as <code class="filename">file1</code> since
			they both belong to the same group</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site1/directory-trial:1/</p></li><li class="listitem"><p>http://site1/directory-one/</p></li><li class="listitem"><p>http://site1/directory/</p></li><li class="listitem"><p>http://site2/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file3</code> will be fetched
			from</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site3/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file4</code> will be
			fetched from</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site4/</p></li><li class="listitem"><p>http://site5/</p></li><li class="listitem"><p>http://site6/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p>http://site8/directory-one/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file5</code> will be fetched
			from</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file6</code> will be fetched
			from</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site8/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li></ul></div></div></div><br class="example-break" /></li></ol></div></li><li class="listitem"><p>How do I group one of the special macros from
	      <code class="filename">bsd.sites.mk</code>, for example,
	      SourceForge (<code class="literal">SF</code>)?</p><p>This has been simplified as much as possible.  See
		<a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-detailed-use-master-site-sourceforge" title="Example 5.9. Detailed Use of MASTER_SITES:n with SourceForge (SF)">Example 5.9, &#8220;Detailed Use of <code class="literal">MASTER_SITES:n</code>
		with SourceForge (<code class="literal">SF</code>)&#8221;</a>.</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-master-site-sourceforge"></a><div class="example-title">Example 5.9. Detailed Use of <code class="literal">MASTER_SITES:n</code>
		with SourceForge (<code class="literal">SF</code>)</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	http://site1/ SF/something/1.0:sourceforge,TEST
DISTFILES=	something.tar.gz:sourceforge</pre><p><code class="filename">something.tar.gz</code> will be
	      fetched from all sites within SourceForge.</p></div></div><br class="example-break" /></li><li class="listitem"><p>How do I use this with
	      <code class="varname">PATCH<em class="replaceable"><code>*</code></em></code>?</p><p>All examples were done with
	      <code class="varname">MASTER<em class="replaceable"><code>*</code></em></code>
	      but they work exactly the same for
	      <code class="varname">PATCH<em class="replaceable"><code>*</code></em></code>
	      ones as can be seen in <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-detailed-use-patch-sites" title="Example 5.10. Simplified Use of MASTER_SITES:n with PATCH_SITES">Example 5.10, &#8220;Simplified Use of
		<code class="literal">MASTER_SITES:n</code> with
		<code class="varname">PATCH_SITES</code>&#8221;</a>.</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-patch-sites"></a><div class="example-title">Example 5.10. Simplified Use of
		<code class="literal">MASTER_SITES:n</code> with
		<code class="varname">PATCH_SITES</code></div><div class="example-contents"><pre class="programlisting">PATCH_SITES=	http://site1/ http://site2/:test
PATCHFILES=	patch1:test</pre></div></div><br class="example-break" /></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="port-master-sites-n-what-changed"></a>5.4.8.3. What Does Change for Ports?  What Does Not?</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem"><p>All current ports remain the same.  The
	      <code class="literal">MASTER_SITES:n</code> feature code is only
	      activated if there are elements postfixed with
	      <code class="literal">:<em class="replaceable"><code>n</code></em></code> like
	      elements according to the aforementioned syntax rules,
	      especially as shown in item <a class="xref" href="makefile-distfiles.html#porting-master-sites-n-group-semantics">7</a>.</p></li><li class="listitem"><p><a id="porting-master-sites-n-what-changes-in-port-targets"></a>The port targets remain the same:
	      <code class="buildtarget">checksum</code>,
	      <code class="buildtarget">makesum</code>,
	      <code class="buildtarget">patch</code>,
	      <code class="buildtarget">configure</code>,
	      <code class="buildtarget">build</code>, etc.  With the obvious
	      exceptions of <code class="buildtarget">do-fetch</code>,
	      <code class="buildtarget">fetch-list</code>,
	      <code class="buildtarget">master-sites</code> and
	      <code class="buildtarget">patch-sites</code>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="buildtarget">do-fetch</code>: deploys
		  the new grouping postfixed
		  <code class="varname">DISTFILES</code> and
		  <code class="varname">PATCHFILES</code> with their matching
		  group elements within both
		  <code class="varname">MASTER_SITES</code> and
		  <code class="varname">PATCH_SITES</code> which use matching
		  group elements within both
		  <code class="varname">MASTER_SITE_SUBDIR</code> and
		  <code class="varname">PATCH_SITE_SUBDIR</code>.  Check <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-detailed-use-complete-example-master-sites" title="Example 5.8. Detailed Use of MASTER_SITES:n with Comma Operator, Multiple Files, Multiple Sites and Multiple Subdirectories">Example 5.8, &#8220;Detailed Use of
		    <code class="literal">MASTER_SITES:n</code> with Comma
		    Operator, Multiple Files, Multiple Sites and
		    Multiple Subdirectories&#8221;</a>.</p></li><li class="listitem"><p><code class="buildtarget">fetch-list</code>: works
		  like old <code class="buildtarget">fetch-list</code> with
		  the exception that it groups just like
		  <code class="buildtarget">do-fetch</code>.</p></li><li class="listitem"><p><code class="buildtarget">master-sites</code> and
		  <code class="buildtarget">patch-sites</code>:
		  (incompatible with older versions) only return the
		  elements of group <code class="literal">DEFAULT</code>; in
		  fact, they execute targets
		  <code class="buildtarget">master-sites-default</code> and
		  <code class="buildtarget">patch-sites-default</code>
		  respectively.</p><p>Furthermore, using target either
		  <code class="buildtarget">master-sites-all</code> or
		  <code class="buildtarget">patch-sites-all</code> is
		  preferred to directly checking either
		  <code class="buildtarget">MASTER_SITES</code> or
		  <code class="buildtarget">PATCH_SITES</code>.  Also,
		  directly checking is not guaranteed to work in any
		  future versions.  Check item <a class="xref" href="makefile-distfiles.html#porting-master-sites-n-new-port-targets-master-sites-all">B</a>
		  for more information on these new port
		  targets.</p></li></ul></div></li><li class="listitem"><p>New port targets</p><div class="orderedlist"><ol class="orderedlist" type="A"><li class="listitem"><p>There are
		  <code class="buildtarget">master-sites-<em class="replaceable"><code>n</code></em></code>
		  and
		  <code class="buildtarget">patch-sites-<em class="replaceable"><code>n</code></em></code>
		  targets which will list the elements of the
		  respective group <em class="replaceable"><code>n</code></em>
		  within <code class="varname">MASTER_SITES</code> and
		  <code class="varname">PATCH_SITES</code> respectively.  For
		  instance, both
		  <code class="buildtarget">master-sites-DEFAULT</code>
		  and <code class="buildtarget">patch-sites-DEFAULT</code>
		  will return the elements of group
		  <code class="literal">DEFAULT</code>,
		  <code class="buildtarget">master-sites-test</code> and
		  <code class="buildtarget">patch-sites-test</code> of
		  group <code class="literal">test</code>, and thereon.</p></li><li class="listitem"><p><a id="porting-master-sites-n-new-port-targets-master-sites-all"></a>There are new targets
		  <code class="buildtarget">master-sites-all</code> and
		  <code class="buildtarget">patch-sites-all</code> which do
		  the work of the old
		  <code class="buildtarget">master-sites</code> and
		  <code class="buildtarget">patch-sites</code> ones.  They
		  return the elements of all groups as if they all
		  belonged to the same group with the caveat that it
		  lists as many <code class="varname">MASTER_SITE_BACKUP</code>
		  and <code class="varname">MASTER_SITE_OVERRIDE</code> as there
		  are groups defined within either
		  <code class="varname">DISTFILES</code> or
		  <code class="varname">PATCHFILES</code>; respectively for
		  <code class="buildtarget">master-sites-all</code> and
		  <code class="buildtarget">patch-sites-all</code>.</p></li></ol></div></li></ol></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-dist_subdir"></a>5.4.9. <code class="varname">DIST_SUBDIR</code></h3></div></div></div><p>Do not let the port clutter
	<code class="filename">/usr/ports/distfiles</code>.  If the port
	requires a lot of files to be fetched, or contains a file that
	has a name that might conflict with other ports (for example,
	<code class="filename">Makefile</code>), set
	<code class="varname">DIST_SUBDIR</code> to the name of the port
	(<code class="literal">${PORTNAME}</code> or
	<code class="literal">${PKGNAMEPREFIX}${PORTNAME}</code> are
	fine).  This will change <code class="varname">DISTDIR</code> from the
	default <code class="filename">/usr/ports/distfiles</code> to
	<code class="filename">/usr/ports/distfiles/${DIST_SUBDIR}</code>, and
	in effect puts everything that is required for the port into
	that subdirectory.</p><p>It will also look at the subdirectory with the same name
	on the backup master site at
	<code class="filename">ftp.FreeBSD.org</code>.  (Setting
	<code class="varname">DISTDIR</code> explicitly in
	<code class="filename">Makefile</code> will not accomplish this, so
	please use <code class="varname">DIST_SUBDIR</code>.)</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">This does not affect
	  <code class="varname">MASTER_SITES</code> defined in the
	  <code class="filename">Makefile</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-always_keep_distfiles"></a>5.4.10. <code class="varname">ALWAYS_KEEP_DISTFILES</code></h3></div></div></div><p>If the port uses binary distfiles and has a license that
	requires that the source code is provided with packages
	distributed in binary form, like <acronym class="acronym">GPL</acronym>,
	<code class="varname">ALWAYS_KEEP_DISTFILES</code> will instruct the
	FreeBSD build cluster to keep a copy of the files specified in
	<code class="varname">DISTFILES</code>.  Users of these ports will
	generally not need these files, so it is a good idea to only
	add the source distfiles to <code class="varname">DISTFILES</code> when
	<code class="varname">PACKAGE_BUILDING</code> is defined.</p><div class="example"><a id="ports-master-sites-n-example-always-keep-distfiles"></a><div class="example-title">Example 5.11. Use of
	  <code class="varname">ALWAYS_KEEP_DISTFILES</code></div><div class="example-contents"><pre class="programlisting">.if defined(PACKAGE_BUILDING)
DISTFILES+=		<em class="replaceable"><code>foo.tar.gz</code></em>
ALWAYS_KEEP_DISTFILES=	yes
.endif</pre></div></div><br class="example-break" /><p>When adding extra files to <code class="varname">DISTFILES</code>,
	make sure to also add them to <code class="filename">distinfo</code>.
	Also, the additional files will normally be extracted into
	<code class="varname">WRKDIR</code> as well, which for some ports may
	lead to undesirable side effects and require special
	handling.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="makefile-categories.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="makefiles.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="makefile-maintainer.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">5.3. Categorization </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 5.5. <code class="varname">MAINTAINER</code></td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>