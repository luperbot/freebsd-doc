<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>6.23. Starten und Anhalten von Diensten (rc Skripten)</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD Porter-Handbuch" /><link rel="up" href="special.html" title="Kapitel 6. Besonderheiten" /><link rel="prev" href="using-databases.html" title="6.22. Benutzung von Datenbanken" /><link rel="next" href="users-and-groups.html" title="6.24. Hinzufügen von Benutzern und Gruppen" /><link rel="copyright" href="trademarks.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.23. Starten und Anhalten von Diensten (rc Skripten)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="using-databases.html">Zurück</a> </td><th width="60%" align="center">Kapitel 6. Besonderheiten</th><td width="20%" align="right"> <a accesskey="n" href="users-and-groups.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="rc-scripts"></a>6.23. Starten und Anhalten von Diensten (rc Skripten)</h2></div></div></div><p><code class="filename">rc.d</code>-Skripten werden zum Starten
	von Diensten während des Systemstarts verwendet und um
	den Administratoren einen Standardweg zum Anhalten und Starten
	von Diensten zu bieten. Ports halten sich an dieses
	systemweite <code class="filename">rc.d</code>-Framework.  Details zu
	deren Benutzung können im <a class="link" href="../../../../doc/de_DE.ISO8859-1/books/handbook/configtuning-rcd.html" target="_top">rc.d Kapitel
	des Handbuchs</a> nachgelesen werden. Ausführliche
	Beschreibungen der verfügbaren Befehle stehen in
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a> und <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.subr&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc.subr</span>(8)</span></a>.  Desweiteren gibt es <a class="link" href="../../../../doc/en_US.ISO8859-1/articles/rc-scripting" target="_top">einen Artikel</a> zu
	praktischen Aspekten bezüglich
	<code class="filename">rc.d</code>-Skripten.</p><p>Ein oder mehrere <code class="filename">rc.d</code>-Skripten können installiert
	werden mittels:</p><pre class="programlisting">USE_RC_SUBR=    doormand</pre><p>Skripten müssen im Unterverzeichnis
	<code class="filename">files</code> abgelegt und jeder Skript-Datei
	muss ein <code class="literal">.in</code>-Suffix hinzugefügt
	werden. Standardmäßige
	<code class="varname">SUB_LIST</code>-Ersetzungen werden für diese
	Dateien unterstützt. Die Verwendung von
	<code class="literal">%%PREFIX%%</code> und
	<code class="literal">%%LOCALBASE%%</code> wird dringend empfohlen.
	Näheres zu <code class="varname">SUB_LIST</code> kann im <a class="link" href="using-sub-files.html" title="8.6. Nutzung von SUB_FILES und SUB_LIST">zugehörigen Kapitel</a>
	nachgelesen werden.</p><p>Für FreeBSD-Versionen, die älter als 6.1-RELEASE
	sind, ist die Integration mittels <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcorder&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rcorder</span>(8)</span></a>
	möglich, indem <code class="varname">USE_RCORDER</code> anstatt
	<code class="varname">USE_RC_SUBR</code> verwendet wird. Die Verwendung
	dieser Methode ist jedoch nur notwendig, wenn der Port in die
	Verzeichnisstruktur des Basissystems installiert werden kann
	oder der Dienst vor den
	<code class="filename">FILESYSTEMS</code>-Skripten in
	<code class="filename">rc.d</code> des Basissystems gestartet sein
	muss.</p><p>Seit FreeBSD 6.1-RELEASE sind lokale
	<code class="filename">rc.d</code>-Skripten (inklusive der durch Ports
	installierten) im allgemeinen <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcorder&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rcorder</span>(8)</span></a> des
	Basissystems.</p><p>Beispiel eines einfachen
	<code class="filename">rc.d</code>-Skripts:</p><pre class="programlisting">#!/bin/sh

# $FreeBSD$
#
# PROVIDE: doormand
# REQUIRE: LOGIN
# KEYWORD: shutdown
#
# Add the following lines to /etc/rc.conf.local or /etc/rc.conf
# to enable this service:
#
# doormand_enable (bool):    Set to NO by default.
#                Set it to YES to enable doormand.
# doormand_config (path):    Set to %%PREFIX%%/etc/doormand/doormand.cf
#                by default.
#

. /etc/rc.subr

name="doormand"
rcvar=${name}_enable

command=%%PREFIX%%/sbin/${name}
pidfile=/var/run/${name}.pid

load_rc_config $name

: ${doormand_enable="NO"}
: ${doormand_config="%%PREFIX%%/etc/doormand/doormand.cf"}

command_args="-p $pidfile -f $doormand_config"

run_rc_command "$1"</pre><p>Solange kein guter Grund dafür besteht, einen Dienst
	früher starten zu lassen, sollten alle Ports-Skripten
	</p><pre class="programlisting">REQUIRE: LOGIN</pre><p> verwenden.
	Falls der Port von einem bestimmten Benutzer (außer
	root) ausgeführt wird, ist dies zwingend.
	</p><pre class="programlisting">KEYWORD: shutdown</pre><p> ist im
	Skript oben deswegen vorhanden, weil der frei erfundene
	Beispiel-Port einen Dienst startet und dieser beim
	Herunterfahren des Systems sauber beendet werden sollte.
	Startete das Skript keinen persistenten Dienst, wäre dies
	nicht notwendig.</p><p>Für die Wertzuweisung von Variablen sollte
	"=" anstatt ":=" verwendet werden, da bei
	Ersterem nur auf einen Standardwert gesetzt wird, wenn die
	Variable vorher noch nicht gesetzt war, und bei Letzterem
	dieser gesetzt wird, auch wenn der Wert vorher Null gewesen
	ist. Ein Benutzer kann durchaus einen Ausdruck wie
	</p><pre class="programlisting">doormand_flags=""</pre><p> in seiner
	<code class="filename">rc.conf.local</code>-Datei stehen haben, und
	eine Variablenzuweisung mittels ":=" würde in
	diesem Fall die Benutzerdefinition überschreiben.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Es sollten keine weiteren Skripten mit der
	  <code class="filename">.sh</code>-Endung hinzugefügt werden.
	  Irgendwann wird es ein Massenumbenennen aller Skripten im
	  Repository geben, die immer noch diese Endung haben.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp69840336"></a>6.23.1. Anhalten und Deinstallieren von Diensten</h3></div></div></div><p>Es ist möglich, dass ein Dienst während der
	  Deinstallation automatisch angehalten wird. Es wird
	  empfohlen dieses Verhalten nur zu implementieren, wenn es
	  unbedingt erforderlich ist zuerst den Dienst anzuhalten und
	  dann die Dateien zu entfernen. Normalerweise sollte es dem
	  Administrator überlassen werden, ob ein Dienst durch
	  Deinstallieren angehalten werden soll. Dies betrifft auch
	  den Vorgang des Aktualisierens.</p><p>Der Datei <code class="filename">pkg-plist</code> sollte eine
	  Zeile wie folgt zugefügt werden:</p><pre class="programlisting">@stopdaemon doormand</pre><p>Das Argument muss dabei mit dem Inhalt der
	  <code class="varname">USE_RC_SUBR</code>-Variablen
	  übereinstimmen.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="using-databases.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="special.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="users-and-groups.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">6.22. Benutzung von Datenbanken </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 6.24. Hinzufügen von Benutzern und Gruppen</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>