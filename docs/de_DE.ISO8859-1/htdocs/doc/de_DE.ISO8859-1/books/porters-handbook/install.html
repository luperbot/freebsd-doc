<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>5.14. Installation von Dateien</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD Porter-Handbuch" /><link rel="up" href="makefile.html" title="Kapitel 5. Die Konfiguration des Makefile" /><link rel="prev" href="conflicts.html" title="5.13. Konfliktbehandlung" /><link rel="next" href="special.html" title="Kapitel 6. Besonderheiten" /><link rel="copyright" href="trademarks.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.14. Installation von Dateien</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="conflicts.html">Zurück</a> </td><th width="60%" align="center">Kapitel 5. Die Konfiguration des Makefile</th><td width="20%" align="right"> <a accesskey="n" href="special.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="install"></a>5.14. Installation von Dateien</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="install-macros"></a>5.14.1. INSTALL_* macros</h3></div></div></div><p>Nutzen Sie die Makros in
	  <code class="filename">bsd.port.mk</code>, um korrekte
	  Modi und Eigentümer von Dateien in Ihren
	  <code class="buildtarget">*-install</code>-Targets
	  sicherzustellen.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">INSTALL_PROGRAM</code> ist ein Befehl,
	      um binäre Binärdateien zu installieren.</p></li><li class="listitem"><p><code class="varname">INSTALL_SCRIPT</code> ist ein Befehl,
	      um ausführbare Skripte zu installieren.</p></li><li class="listitem"><p><code class="varname">INSTALL_LIB</code> ist ein Befehl
	      zur Installation Shared-Libraries.</p></li><li class="listitem"><p><code class="varname">INSTALL_KLD</code> ist ein Befehl, mit
	      dem Kernelmodule installiert werden können. Einige
	      Architekturen haben Probleme mit stripped-Modulen.
	      Daher sollten Sie diesen Befehl anstelle von
	      <code class="varname">INSTALL_PROGRAM</code> verwenden.</p></li><li class="listitem"><p><code class="varname">INSTALL_DATA</code> ist ein Befehl,
	      um gemeinsam nutzbare Daten zu installieren.</p></li><li class="listitem"><p><code class="varname">INSTALL_MAN</code> ist ein Befehl,
	      um Manualpages oder andere Dokumentation zu
	      installieren (es wird nichts komprimiert).</p></li></ul></div><p>Das sind grundsätzlich alle
	  <code class="command">install</code>-Befehle mit
	  ihren passenden Flags.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="install-strip"></a>5.14.2. Zerlegen von Binärdateien und
	  Shared-Libraries</h3></div></div></div><p>Zerlegen Sie keine Binärdateien manuell,
	  wenn Sie es nicht müssen.  Alle Binaries sollten
	  gestripped werden; allerdings vermag das
	  <code class="varname">INSTALL_PROGRAM</code>-Makro gleichzeitig
	  eine Binärdatei zu installieren und zu strippen
	  (beachten Sie den nächsten Abschnitt).  Das
	  Makro <code class="varname">INSTALL_LIB</code> erledigt das
	  gleiche für Shared-Libraries.</p><p>Wenn Sie eine Datei strippen müssen, aber weder
	  das <code class="varname">INSTALL_PROGRAM</code>- noch das
	  <code class="varname">INSTALL_LIB</code>-Makro nutzen wollen, dann
	  kann <code class="varname">${STRIP_CMD}</code> Ihr Programm strippen.
	  Dies wird typischerweise innerhalb des
	  <code class="literal">post-install</code>-Targets gemacht.
	  Zum Beispiel:</p><pre class="programlisting">post-install:
    ${STRIP_CMD} ${PREFIX}/bin/xdl</pre><p>Nutzen Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=file&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">file</span>(1)</span></a> für die installierte
	  Applikation, um zu überprüfen, ob eine
	  Binärdatei gestripped ist oder nicht.
	  Wenn es nicht meldet <code class="literal">not stripped</code>,
	  dann ist es bereits gestripped. Zudem wird <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=strip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">strip</span>(1)</span></a>
	  nicht ein bereits gestripptes Programm nochmals versuchen
	  zu strippen, sondern wird stattdessen einfach sauber
	  beenden.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="install-copytree"></a>5.14.3. Installation eines ganzen Verzeichnisbaums
	  inklusive Dateien</h3></div></div></div><p>Manchmal muss man eine große Zahl von Dateien
	  unter Erhalt ihrer hierarchischen Struktur installieren,
	  d.h. Kopieraktionen über einen ganzen Verzeichnisbaum
	  von <code class="varname">WRKSRC</code> zu einem Zielverzeichnis unter
	  <code class="varname">PREFIX</code>.</p><p>Für diesen Fall gibt es zwei Makros. Der Vorteil
	  der Nutzung dieser Makros anstatt <code class="command">cp</code> ist,
	  dass sie korrekte Besitzer und Berechtigungen auf den
	  Zieldateien garantieren.
	  Das erste Makro, <code class="varname">COPYTREE_BIN</code>, wird alle
	  installierten Dateien ausführbar markieren und damit
	  passend für die Installation in
	  <code class="filename">PREFIX/bin</code>
	  vorbereiten. Das zweite Makro,
	  <code class="varname">COPYTREE_SHARE</code>, setzt keine
	  Ausführungsberechtigungen auf Dateien und ist daher
	  geeignet für die Installation von Dateien im Target von
	  <code class="filename">PREFIX/share</code>.</p><pre class="programlisting">post-install:
    ${MKDIR} ${EXAMPLESDIR}
    (cd ${WRKSRC}/examples/ &amp;&amp; ${COPYTREE_SHARE} \* ${EXAMPLESDIR})</pre><p>Dieses Beispiel wird den Inhalt des
	  <code class="filename">examples</code>-Verzeichnisses im Distfile
	  des Drittanbieters in das Beispielverzeichnis Ihres Ports
	  kopieren.</p><pre class="programlisting">post-install:
    ${MKDIR} ${DATADIR}/summer
    (cd ${WRKSRC}/temperatures/ &amp;&amp; ${COPYTREE_SHARE} "June July August" ${DATADIR}/summer/)</pre><p>Und dieses Beispiel wird die Daten der Sommermonate in
	  das <code class="filename">summer</code>-Unterverzeichnis eines
	  <code class="filename">DATADIR</code>
	  installieren.</p><p>Zusätzliche <code class="command">find</code>-Argumente
	  können mit dem dritten Argument an die
	  <code class="varname">COPYTREE_*</code>-Makros übergeben werden.
	  Um zum Beispiel alle Dateien aus dem 1. Beispiel ohne die
	  Makefiles zu installieren, kann man folgenden Befehl
	  benutzen.</p><pre class="programlisting">post-install:
    ${MKDIR} ${EXAMPLESDIR}
    (cd ${WRKSRC}/examples/ &amp;&amp; \
	${COPYTREE_SHARE} \* ${EXAMPLESDIR} "! -name Makefile")</pre><p>Beachten Sie bitte, dass diese Makros die installierten
	  Dateien nicht zur <code class="filename">pkg-plist</code>
	  hinzufügen, Sie müssen sie immer noch selbst
	  auflisten.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="install-documentation"></a>5.14.4. Installation zusätzlicher Dokumentation</h3></div></div></div><p>Falls Ihre Software zusätzlich zu den üblichen
	  Manualpages und Info-Seiten weitere Dokumentation hat und
	  Sie diese für nützlich halten, dann installieren
	  Sie sie unter
	  <code class="filename">PREFIX/share/doc</code>.
	  Dies kann wie vorstehend im Target des
	  <code class="buildtarget">post-install</code> geschehen.</p><p>Legen Sie ein neues Verzeichnis für Ihren Port an.
	  Das Verzeichnis sollte wiederspiegeln, was der Port ist.
	  Das bedeutet normalerweise <code class="varname">PORTNAME</code>.
	  Wie auch immer, wenn Sie meinen, der Nutzer möchte
	  verschiedene Versionen des Ports zur gleichen Zeit
	  installiert haben, dann können Sie die gesamte Variable
	  <code class="varname">PKGNAME</code> nutzen.</p><p>Machen Sie die Installation von der Variablen
	  <code class="varname">NOPORTDOCS</code> abhängig, damit die
	  Nutzer sie in <code class="filename">/etc/make.conf</code> abschalten
	  können:</p><pre class="programlisting">post-install:
.if !defined(NOPORTDOCS)
    ${MKDIR} ${DOCSDIR}
    ${INSTALL_MAN} ${WRKSRC}/docs/xvdocs.ps ${DOCSDIR}
.endif</pre><p>Hier einige praktische Variablen und wie sie
	  standardmässig bei Verwendung im
	  <code class="filename">Makefile</code> expandiert werden:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">DATADIR</code> wird expandiert zu
	      <code class="filename">PREFIX/share/PORTNAME</code>.</p></li><li class="listitem"><p><code class="varname">DATADIR_REL</code> wird expandiert zu
	      <code class="filename">share/PORTNAME</code>.</p></li><li class="listitem"><p><code class="varname">DOCSDIR</code> wird expandiert zu
	      <code class="filename">PREFIX/share/doc/PORTNAME</code>.</p></li><li class="listitem"><p><code class="varname">DOCSDIR_REL</code> wird expandiert zu
	      <code class="filename">share/doc/PORTNAME</code>.</p></li><li class="listitem"><p><code class="varname">EXAMPLESDIR</code> wird expandiert zu
	      <code class="filename">PREFIX/share/examples/PORTNAME</code>.</p></li><li class="listitem"><p><code class="varname">EXAMPLESDIR_REL</code> wird expandiert zu
	      <code class="filename">share/examples/PORTNAME</code>.</p></li></ul></div><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">NOPORTDOCS</code> behandelt nur
	    zusätzliche Dokumentation, die in
	    <code class="varname">DOCSDIR</code> installiert ist.
	    Für normale Manualpages und Info-Seiten
	    wird die Variable benutzt.
	    Dinge, welche in <code class="varname">DATADIR</code>
	    und <code class="varname">EXAMPLESDIR</code> installiert werden,
	    legen die Variablen <code class="varname">NOPORTDATA</code> und
	    <code class="varname">NOPORTEXAMPLES</code> fest.</p></div><p>Die Variablen werden nach <code class="varname">PLIST_SUB</code>
	  exportiert. Ihre Werte erscheinen dort als Pfadnamen relativ
	  zu <code class="filename">PREFIX</code>,
	  falls möglich. Das bedeutet, dass
	  <code class="filename">share/doc/PORTNAME</code>
	  standardmässig ersetzt wird durch
	  <code class="literal">%%DOCSDIR%%</code> in der Packliste usw.
	  (mehr zur Ersetzung durch die
	  <code class="filename">pkg-plist</code> finden Sie
	  <a class="link" href="plist.html#plist-sub" title="7.1. Änderungen an pkg-plist mit Hilfe von make-Variablen">hier</a>).</p><p>Alle installierten Dokumentationsdateien
	  und &#8211;Verzeichnisse
	  sollten in der <code class="filename">pkg-plist</code> dem
	  <code class="literal">%%PORTDOCS%%</code>-Präfix
	  enthalten sein, zum Beispiel:</p><pre class="programlisting">%%PORTDOCS%%%%DOCSDIR%%/AUTHORS
%%PORTDOCS%%%%DOCSDIR%%/CONTACT
%%PORTDOCS%%@dirrm %%DOCSDIR%%</pre><p>Alternativ zur Auflistung der Dokumentationsdateien in
	  der <code class="filename">pkg-plist</code> kann in einem Port auch
	  die Variable <code class="varname">PORTDOCS</code> gesetzt werden
	  für eine Liste von Dateien und Shell-Globs, um diese
	  zur endgültigen Packliste hinzuzufügen. Die Namen
	  werden relativ zur Variable <code class="varname">DOCSDIR</code> sein.
	  Wenn Sie also einen Port haben, welcher
	  <code class="varname">PORTDOCS</code> benutzt, und Sie haben eine vom
	  Standard abweichenden Platz für seine Dokumentation,
	  dann müssen Sie die Variable <code class="varname">DOCSDIR</code>
	  entsprechend setzen. Wenn ein Verzeichnis in
	  <code class="varname">PORTDOCS</code> aufgeführt ist, oder von
	  einem Shell-Glob dieser Variable abgebildet wird, dann wird
	  der komplette Verzeichnisbaum inklusive Dateien und
	  Verzeichnissen in der endgültigen Packliste
	  aufgenommen. Wenn die Variable <code class="varname">NOPORTDOCS</code>
	  gesetzt ist, dann werden die Dateien und Verzeichnisse,
	  die in <code class="varname">PORTDOCS</code> aufgelistet sind,
	  nicht installiert und werden auch nicht zur Packliste des
	  Ports hinzugefügt. Wie oben gezeigt bleibt es dem Port
	  selbst überlassen, die Dokumentation in
	  <code class="varname">PORTDOCS</code> zu installieren. Ein typisches
	  Beispiel für den Gebrauch von
	  <code class="varname">PORTDOCS</code> sieht wie folgt aus:</p><pre class="programlisting">PORTDOCS=       README.* ChangeLog docs/*</pre><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Die Äquivalente zu <code class="varname">PORTDOCS</code>
	    für unter <code class="varname">DATADIR</code> und
	    <code class="varname">EXAMPLESDIR</code> installierte Dateien sind
	    <code class="varname">PORTDATA</code> beziehungsweise
	    <code class="varname">PORTEXAMPLES</code>.</p><p xmlns="http://www.w3.org/1999/xhtml">Sie können auch <code class="filename">pkg-message</code>
	    benutzen, um Meldungen während der Installation
	    anzuzeigen. Lesen Sie <a class="link" href="pkg-files.html#porting-message" title="8.1. pkg-message">diesen Abschnitt über den
	    Gebrauch von <code class="filename">pkg-message</code></a>
	    für weitere Details.
	    Die <code class="filename">pkg-message</code>-Datei muss nicht zur
	    <code class="filename">pkg-plist</code> hinzugefügt
	    werden.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="install-subdirs"></a>5.14.5. Unterverzeichnisse mit PREFIX</h3></div></div></div><p>Lassen Sie den Port die Dateien in die richtigen
	  Unterverzeichnisse von <code class="varname">PREFIX</code> verteilen.
	  Einige Ports werfen alles in einen Topf und legen es im
	  Unterverzeichnis mit dem Namen des Ports ab, was falsch ist.
	  Ausserdem legen viele Ports alles ausser Binaries,
	  Header-Dateien und Manualpages in ein Unterverzeichnis
	  von <code class="filename">lib</code>, was natürlich auch nicht
	  der BSD-Philosophie entspricht und nicht gut funktioniert.
	  Viele der Dateien sollten in eines der folgenden
	  Verzeichnisse geschoben werden: <code class="filename">etc</code>
	  (Konfigurationsdateien), <code class="filename">libexec</code>
	  (intern gestartete Binärdateien),
	  <code class="filename">sbin</code> (Binärdateien für
	  Superuser/Manager), <code class="filename">info</code>
	  (Dokumentation für Info-Browser) oder
	  <code class="filename">share</code> (Architektur-unabhängige
	  Dateien). Lesen Sie hierzu <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hier&amp;sektion=7"><span class="citerefentry"><span class="refentrytitle">hier</span>(7)</span></a>; weitestgehend
	  greifen die Regeln für <code class="filename">/usr</code> auch
	  für <code class="filename">/usr/local</code>. Die Ausnahme sind
	  Ports, welche mit <span class="quote">&#8222;<span class="quote">news</span>&#8220;</span> aus dem USENET
	  arbeiten. In diesem Falle sollte
	  <code class="filename">PREFIX/news</code>
	  als Zielort für die Dateien benutzt werden.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="conflicts.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="makefile.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="special.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">5.13. Konfliktbehandlung </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> Kapitel 6. Besonderheiten</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>