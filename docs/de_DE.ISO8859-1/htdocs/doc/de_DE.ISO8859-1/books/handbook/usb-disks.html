<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>19.5. USB Speichermedien</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="disks.html" title="Kapitel 19. Speichermedien" /><link rel="prev" href="raid.html" title="19.4. RAID" /><link rel="next" href="creating-cds.html" title="19.6. CDs benutzen" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">19.5. USB Speichermedien</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="raid.html">Zurück</a> </td><th width="60%" align="center">Kapitel 19. Speichermedien</th><td width="20%" align="right"> <a accesskey="n" href="creating-cds.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="usb-disks"></a>19.5. USB Speichermedien</h2></div><div><span class="authorgroup">Beigetragen von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Marc</span> <span class="surname">Fonvieille</span></span>. </span></div></div></div><a id="idp80918608" class="indexterm"></a><p>Der Universal Serial Bus (USB) wird heutzutage von
      vielen externen Speichern benutzt:  Festplatten,
      USB-Thumbdrives oder CD-Brennern, die alle von
      FreeBSD unterstützt werden.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80920144"></a>19.5.1. USB-Konfiguration</h3></div></div></div><p>USB-Massenspeicher werden vom Treiber <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=umass&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">umass</span>(4)</span></a>
	betrieben.  Wenn Sie den <code class="filename">GENERIC</code>-Kernel
	benutzen, brauchen Sie keine Anpassungen vorzunehmen.
	Benutzen Sie einen angepassten Kernel, müssen die
	nachstehenden Zeilen in der Kernelkonfigurationsdatei
	enthalten sein:</p><pre class="programlisting">device scbus
device da
device pass
device uhci
device ohci
device ehci
device usb
device umass</pre><p>Der Treiber <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=umass&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">umass</span>(4)</span></a> greift über das
        SCSI-Subsystem auf die USB-Geräte zu.  Ihre
	USB-Geräte werden daher vom System als SCSI-Geräte
	erkannt.  Abhängig vom Chipsatz Ihrer Systemplatine
	benötigen Sie in der Kernelkonfiguration entweder
	die Option <code class="literal">device uhci</code> oder die
	Option <code class="literal">device ohci</code> für die
	Unterstützung von USB 1.1.  Die
	Kernelkonfiguration kann allerdings auch beide Optionen
	enthalten.  Unterstützung für USB 2.0 Controller
	wird durch den <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ehci&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ehci</span>(4)</span></a>-Treiber geleistet (die
	<code class="literal">device ehci</code> Zeile).  Vergessen Sie bitte nicht,
	einen neuen Kernel zu bauen und zu installieren, wenn Sie die
	Kernelkonfiguration verändert haben.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Wenn es sich bei Ihrem USB-Gerät um einen
	  CD-R- oder DVD-Brenner handelt, müssen Sie den
	  Treiber <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cd&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">cd</span>(4)</span></a> für SCSI-CD-ROMs in die
	  Kernelkonfiguration aufnehmen:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">device cd</pre><p xmlns="http://www.w3.org/1999/xhtml">Da der Brenner als SCSI-Laufwerk erkannt wird,
	  sollten Sie den Treiber <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=atapicam&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">atapicam</span>(4)</span></a> nicht
	  benutzen.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80929232"></a>19.5.2. Die USB-Konfiguration testen</h3></div></div></div><p>Sie können das USB-Gerät nun testen.
	Schließen Sie das Gerät an und untersuchen
	Sie die Systemmeldungen (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dmesg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dmesg</span>(8)</span></a>), Sie sehen
	Ausgaben wie die folgende:</p><pre class="screen">umass0: USB Solid state disk, rev 1.10/1.00, addr 2
GEOM: create disk da0 dp=0xc2d74850
da0 at umass-sim0 bus 0 target 0 lun 0
da0: &lt;Generic Traveling Disk 1.11&gt; Removable Direct Access SCSI-2 device
da0: 1.000MB/s transfers
da0: 126MB (258048 512 byte sectors: 64H 32S/T 126C)</pre><p>Die Ausgaben, wie das erkannte Gerät oder
	der Gerätename (<code class="filename">da0</code>)
	hängen natürlich von Ihrer Konfiguration ab.</p><p>Da ein USB-Gerät als SCSI-Gerät erkannt
	wird, können Sie USB-Massenspeicher mit dem
	Befehl <code class="command">camcontrol</code> anzeigen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>camcontrol devlist</code></strong>
&lt;Generic Traveling Disk 1.11&gt;      at scbus0 target 0 lun 0 (da0,pass0)</pre><p>Wenn auf dem Laufwerk ein Dateisystem eingerichtet
	ist, sollten Sie das Dateisystem einhängen können.
	<a class="xref" href="disks-adding.html" title="19.3. Hinzufügen von Laufwerken">Abschnitt 19.3, &#8222;Hinzufügen von Laufwerken&#8220;</a> beschreibt, wie Sie
	USB-Laufwerke formatieren und Partitionen einrichten.</p><div xmlns="" class="warning"><h3 class="admontitle">Warnung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Aus Sicherheitsgründen sollten Sie Benutzern, denen Sie
          nicht vertrauen, das Einhängen (z.B. durch die unten
          beschriebene Aktivierung von <code class="literal">vfs.usermount</code>)
          beliebiger Medien  verbieten.  Die meisten Dateisysteme in FreeBSD
          wurden nicht entwickelt, um sich vor böswilligen Geräten
          zu schützen.</p></div><p>Damit auch normale Anwender (ohne
	<code class="systemitem">root</code>-Rechte) USB-Laufwerke einhängen
	können, müssen Sie Ihr System erst entsprechend
	konfigurieren.  Als erstes müssen Sie sicherstellen, dass
	diese Anwender auf die beim Einhängen eines USB-Laufwerks
	dynamisch erzeugten Gerätedateien zugreifen dürfen.
	Dazu können Sie beispielsweise mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pw&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pw</span>(8)</span></a> alle
	potentiellen Benutzer dieser Gerätedateien in die Gruppe
	<code class="systemitem">operator</code> aufnehmen.  Außerdem
	muss sichergestellt werden, dass Mitglieder der Gruppe
	<code class="systemitem">operator</code> Schreib- und Lesezugriff
	auf diese Gerätedateien haben.  Dazu fügen Sie die
	folgenden Zeilen in die Konfigurationsdatei
	<code class="filename">/etc/devfs.rules</code> ein:</p><pre class="programlisting">[localrules=5]
add path 'da*' mode 0660 group operator</pre><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Verfügt Ihr System auch über SCSI-Laufwerke,
	  gibt es eine Besonderheit.   Haben Sie beispielsweise
	  die SCSI-Laufwerke <code class="filename">da0</code> bis
	  <code class="filename">da2</code> installiert, so sieht die
	  zweite Zeile wie folgt aus:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">add path 'da[3-9]*' mode 0660 group operator</pre><p xmlns="http://www.w3.org/1999/xhtml">Dadurch werden die bereits vorhandenen
	  SCSI-Laufwerke nicht in die Gruppe
	  <code class="systemitem">operator</code> aufgenommen.</p></div><p>Vergessen Sie nicht, die <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs.rules&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">devfs.rules</span>(5)</span></a>-Regeln
	in der Datei <code class="filename">/etc/rc.conf</code> zu
	aktivieren:</p><pre class="programlisting">devfs_system_ruleset="localrules"</pre><p>Als nächstes müssen Sie Ihre Kernelkonfiguration
	anpassen, damit auch normale Benutzer Dateisysteme mounten
	dürfen.  Dazu fügen Sie am besten folgende Zeile
	in die Konfigurationsdatei
	<code class="filename">/etc/sysctl.conf</code> ein:</p><pre class="programlisting">vfs.usermount=1</pre><p>Damit diese Einstellung wirksam wird, müssen Sie Ihr
	System neu starten.  Alternativ können Sie diese Variable
	auch mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span></a> setzen.</p><p>Zuletzt müssen Sie noch ein Verzeichnis anlegen, in
	das das USB-Laufwerk eingehängt werden soll.   Dieses
	Verzeichnis muss dem Benutzer gehören, der das
	USB-Laufwerk in den Verzeichnisbaum einhängen will.
	Dazu legen Sie als <code class="systemitem">root</code> ein
	Unterverzeichnis
	<code class="filename">/mnt/username</code>
	an (wobei Sie <em class="replaceable"><code>username</code></em>
	durch den Login des jeweiligen Benutzers sowie
	<em class="replaceable"><code>usergroup</code></em> durch die primäre
	Gruppe des Benutzers ersetzen):</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /mnt/username</code></strong>
 <code class="prompt">#</code> <strong class="userinput"><code>chown username:usergroup /mnt/username</code></strong></pre><p>Wenn Sie nun beispielsweise einen USB-Stick
	anschließen, wird automatisch die Gerätedatei
	<code class="filename">/dev/da0s1</code> erzeugt.  Da derartige
	Geräte in der Regel mit dem FAT-Dateisystem
	formatiert sind, können Sie sie beispielsweise mit
	dem folgenden Befehl in den Verzeichnisbaum
	einhängen:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>mount -t msdosfs -o -m=644,-M=755 /dev/da0s1 /mnt/username</code></strong></pre><p>Wenn Sie das Gerät entfernen (das Dateisystem
	müssen Sie vorher abhängen),  sehen Sie
	in den Systemmeldungen Einträge wie die folgenden:</p><pre class="screen">umass0: at uhub0 port 1 (addr 2) disconnected
(da0:umass-sim0:0:0:0): lost device
(da0:umass-sim0:0:0:0): removing device entry
GEOM: destroy disk da0 dp=0xc2d74850
umass0: detached</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80969552"></a>19.5.3. Weiteres zu USB</h3></div></div></div><p>Neben den Abschnitten
	<a class="link" href="disks-adding.html" title="19.3. Hinzufügen von Laufwerken">Hinzufügen von Laufwerken</a>
	und <a class="link" href="mount-unmount.html" title="4.6. Anhängen und Abhängen von Dateisystemen">Anhängen und
	Abhängen von Dateisystemen</a> lesen Sie bitte
	die Hilfeseiten <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=umass&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">umass</span>(4)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=camcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">camcontrol</span>(8)</span></a> für
	FreeBSD 8.X oder <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=usbdevs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">usbdevs</span>(8)</span></a> bei vorherigen Versionen.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="raid.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="disks.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="creating-cds.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">19.4. RAID </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 19.6. CDs benutzen</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>