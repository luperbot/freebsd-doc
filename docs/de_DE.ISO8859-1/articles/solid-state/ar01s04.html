<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>4. Ein Dateisystem von Grund auf neu erstellen</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD und Solid State-Geräte" /><link rel="up" href="index.html" title="FreeBSD und Solid State-Geräte" /><link rel="prev" href="ro-fs.html" title="3. Die rc-Subsysteme und nur-Lese Dateisysteme" /><link rel="next" href="strategies.html" title="5. Systemstrategien für kleine und Nur-Lese-Umgebungen" /><link rel="copyright" href="trademarks.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4. Ein Dateisystem von Grund auf neu erstellen</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ro-fs.html">Zurück</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="strategies.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="idp63494992"></a>4. Ein Dateisystem von Grund auf neu erstellen</h2></div></div></div><p>Wenn ATA-kompatible Compact-Flash-Karten von FreeBSD als
      normale IDE-Festplatten erkannt werden, könnten Sie theoretisch
      FreeBSD aus dem Netzwerk mittels der Kern- und mfsroot-Floppies
      oder einer CD installieren.</p><p>Jedoch kann selbst eine kleine Installation von FreeBSD durch
      die normale Installationsprozedur ein System erzeugen, dass
      grösser als 200 MB ist.  Da die meisten Leute kleinere
      Flash-Speichermedien einsetzen (128 MB wird hier als gross
      angesehen - 32 oder sogar 16 MB sind gebräuchlich) ist eine
      gewöhnliche Installation mit normalen Methoden nicht möglich, da
      es einfach nicht genug freien Plattenplatz gibt, selbst für die
      kleinste Installationsart.</p><p>Der einfachste Weg, diese Speicherlimitierung zu umgehen,
      ist, FreeBSD auf konventionelle Weise auf eine normale Festplatte
      zu installieren.  Nachdem die Installation abgeschlossen wurde,
      kürzen Sie das Betriebssystem auf das nötigste, bis Sie eine
      Grösse erreicht hat, die auf das Flash-Medium passt und benutzen
      Sie dann tar auf dem gesamten Dateisystem.  Die folgenden
      Schritte werden Sie durch den Prozess der Vorbereitung eines
      Flash-Mediums für ihr getartes Dateisystem führen.  Beachten
      Sie, dass Operationen wie Partitionierung, Benennung, Erstellung
      von Dateisystemen, etc. von Hand durchgeführt werden müssen, da
      eine normale Installation nicht möglich ist.  Zusätzlich zu den
      Kern- und mfsroot-Disketten benötigen Sie auch die
      fixit-Floppy.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p class="title"><strong>Partitionierung Ihrer Flash-Medien</strong></p><p>Wählen Sie nach dem Starten der Kern- und
	  mfsroot-Disketten, <code class="literal">custom</code> aus dem
	  Installationsmenü.  In diesem Menü wählen Sie dann
	  <code class="literal">partition</code> aus.  Dort sollten Sie alle
	  bestehenden Partitionen mit Hilfe der Taste
	  <span class="keycap"><strong>d</strong></span> löschen.  Nachdem alle bestehenden
	  Partitionen gelöscht wurden, erstellen Sie mittels der Taste
	  <span class="keycap"><strong>c</strong></span> eine Partition und akzeptieren Sie den
	  Standardwert für die Grösse der Partition.  Wenn Sie nach
	  dem Typ der Partition gefragt werden, stellen Sie sicher,
	  dass der Wert auf <code class="literal">165</code> eingestellt ist.
	  Schreiben Sie jetzt diese Partitionstabelle auf die Platte
	  durch betätigen der Taste <span class="keycap"><strong>w</strong></span> (dies ist die
	  versteckte Option auf diesem Bildschirm).  Wenn Sie eine
	  ATA-kompatible Compact Flash-Karte verwenden, sollten Sie
	  den FreeBSD Bootmanager auswählen.  Drücken Sie nun die Taste
	  <span class="keycap"><strong>q</strong></span>, um das Partitionsmenü zu verlassen.  Sie
	  werden das Menü des Bootmanagers noch ein weiteres Mal
	  gezeigt bekommt.  In diesem Fall wiederholen Sie die Auswahl
	  von vorher.</p></li><li class="step"><p class="title"><strong>Anlegen von Dateisystemen auf Ihrem
	  Flashspeicher-Gerät</strong></p><p>Verlassen Sie das Installationsmenü und wählen Sie aus
	  dem Hauptinstallationsmenü die Option
	  <code class="literal">fixit</code>.  In der fixit-Umgebung angelangt,
	  geben Sie den folgenden Befehl ein:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>disklabel -e /dev/ad0c</code></strong></pre><p>Zu diesem Zeitpunkt sollten Sie sich im vi-Editor unter
	  der Herrschaft des disklabel-Kommandos befinden.  Als
	  nächstes müssen Sie die eine <code class="literal">a:</code>-Zeile an
	  das Ende der Datei hinzufügen.  Diese
	  <code class="literal">a:</code>-Zeile sollte wie folgt
	  aussehen:</p><pre class="programlisting">a:      <em class="replaceable"><code>123456</code></em>  0       4.2BSD  0       0</pre><p>Wobei <em class="replaceable"><code>123456</code></em> eine Zahl
	  darstellt, die exakt der gleichen Zahl in der bestehenden
	  Zeile mit dem <code class="literal">c:</code>-Eintrag entspricht.  Sie
	  kopieren quasi die bestehende Zeile <code class="literal">c:</code>
	  als eine neue Zeile <code class="literal">a:</code> und stellen
	  sicher, dass fstype <code class="literal">4.2BSD</code> entspricht.
	  Speichern Sie die Datei und verlassen Sie den Editor.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>disklabel -B -r /dev/ad0c</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>newfs /dev/ad0a</code></strong></pre></li><li class="step"><p class="title"><strong>Schreiben des Dateisystems auf Ihr Flash-Medium</strong></p><p>Hängen Sie das neu erstellte Flash-Medium ein:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /dev/ad0a /flash</code></strong></pre><p>Verbinden Sie diese Maschine mit dem Netzwerk, um die
	  tar-Datei zu übertragen und extrahieren Sie es auf das
	  Dateisystem des Flash-Mediums.  Ein Beispiel dazu wäre
	  folgendes:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig xl0 192.168.0.10 netmask 255.255.255.0</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>route add default 192.168.0.1</code></strong></pre><p>Jetzt da die Maschine ans Netzwerk angeschlossen ist,
	  kopieren Sie die tar-Datei.  An diesem Punkt werden Sie
	  möglicherweise mit einem Dilemma konfrontiert - sollte Ihr
	  Flash-Speicher beispielsweise 128 MB gross sein und
	  Ihre tar-Datei grösser als 64 MB, können Sie ihre
	  tar-Datei auf dem Flash-Speicher nicht entpacken - Ihnen
	  wird vorher der Speicherplatz ausgehen.  Eine Lösung für
	  dieses Problem, sofern Sie FTP verwenden, ist, dass Sie die
	  Datei entpacken können, während es von FTP übertragen wird.
	  Wenn Sie die Übertragung auf diese Weise durchführen, haben
	  Sie niemals die tar-Datei und deren Inhalt zur gleichen Zeit
	  auf Ihrem Medium:</p><pre class="screen"><code class="prompt">ftp&gt;</code> <strong class="userinput"><code>get tarfile.tar "| tar xvf -"</code></strong></pre><p>Sollte Ihre tar-Datei gezippt sein, können Sie dies
	  ebenso bewerkstelligen:</p><pre class="screen"><code class="prompt">ftp&gt;</code> <strong class="userinput"><code>get tarfile.tar "| zcat | tar xvf -"</code></strong></pre><p>Nachdem der Inhalt Ihrer tar-Datei auf dem Dateisystem
	  des Flash-Mediums abgelegt wurden, können Sie den
	  Flash-Speicher aushängen und neu starten:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>umount /flash</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>exit</code></strong></pre><p>In der Annahme, dass Sie Ihr Dateisystem richtig
	  konfiguriert haben, als es noch auf der gewöhnlichen
	  Festplatte gebaut wurde (mit Ihren Nur-Lese-Dateisystemen
	  und den nötigen Optionen im Kernel), sollten Sie nun
	  erfolgreich von Ihrem FreeBSD Embedded-System starten
	  können.</p></li></ol></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ro-fs.html">Zurück</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="strategies.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">3. Die <code class="literal">rc</code>-Subsysteme und nur-Lese
      Dateisysteme </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 5. Systemstrategien für kleine und Nur-Lese-Umgebungen</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>