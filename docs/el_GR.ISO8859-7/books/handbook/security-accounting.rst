=========================
15.15. Process Accounting
=========================

.. raw:: html

   <div class="navheader">

15.15. Process Accounting
`????? <security-advisories.html>`__?
???????? 15. ????????
?\ `??????? <jails.html>`__

--------------

.. raw:: html

   </div>

.. raw:: html

   <div class="sect1">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

15.15. Process Accounting
-------------------------

.. raw:: html

   </div>

.. raw:: html

   <div>

Contributed by Tom Rhodes.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

Process accounting is a security method in which an administrator may
keep track of system resources used, their allocation among users,
provide for system monitoring, and minimally track a user's commands.

This indeed has its own positive and negative points. One of the
positives is that an intrusion may be narrowed down to the point of
entry. A negative is the amount of logs generated by process accounting,
and the disk space they may require. This section will walk an
administrator through the basics of process accounting.

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

15.15.1. Enable and Utilizing Process Accounting
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

Before making use of process accounting, it must be enabled. To do this,
execute the following commands:

.. code:: screen

    # touch /var/account/acct

    # accton /var/account/acct

    # echo 'accounting_enable="YES"' >> /etc/rc.conf

Once enabled, accounting will begin to track CPU stats, commands, etc.
All accounting logs are in a non-human readable format and may be viewed
using the
`sa(8) <http://www.FreeBSD.org/cgi/man.cgi?query=sa&sektion=8>`__
utility. If issued without any options, ``sa`` will print information
relating to the number of per user calls, the total elapsed time in
minutes, total CPU and user time in minutes, average number of I/O
operations, etc.

To view information about commands being issued, one would use the
`lastcomm(1) <http://www.FreeBSD.org/cgi/man.cgi?query=lastcomm&sektion=1>`__
utility. The ``lastcomm`` may be used to print out commands issued by
users on specific
`ttys(5) <http://www.FreeBSD.org/cgi/man.cgi?query=ttys&sektion=5>`__,
for example:

.. code:: screen

    # lastcomm ls
        trhodes ttyp1

Would print out all known usage of the ``ls`` by ``trhodes`` on the
ttyp1 terminal.

Many other useful options exist and are explained in the
`lastcomm(1) <http://www.FreeBSD.org/cgi/man.cgi?query=lastcomm&sektion=1>`__,
`acct(5) <http://www.FreeBSD.org/cgi/man.cgi?query=acct&sektion=5>`__
and `sa(8) <http://www.FreeBSD.org/cgi/man.cgi?query=sa&sektion=8>`__
manual pages.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="navfooter">

--------------

+-----------------------------------------+----------------------------+-------------------------------+
| `????? <security-advisories.html>`__?   | `???? <security.html>`__   | ?\ `??????? <jails.html>`__   |
+-----------------------------------------+----------------------------+-------------------------------+
| 15.14. FreeBSD Security Advisories?     | `???? <index.html>`__      | ????????? 16. Jails           |
+-----------------------------------------+----------------------------+-------------------------------+

.. raw:: html

   </div>

???? ?? ???????, ??? ???? ???????, ?????? ?? ?????? ???
ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/

| ??? ????????? ??????? ?? ?? FreeBSD, ???????? ???
  `?????????? <http://www.FreeBSD.org/docs.html>`__ ???? ??
  ?????????????? ?? ??? <questions@FreeBSD.org\ >.
|  ??? ????????? ??????? ?? ???? ??? ??????????, ??????? e-mail ????
  <doc@FreeBSD.org\ >.
