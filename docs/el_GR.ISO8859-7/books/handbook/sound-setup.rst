============================
8.2. ??????? ??? ?????? ????
============================

.. raw:: html

   <div class="navheader">

8.2. ??????? ??? ?????? ????
`????? <multimedia.html>`__?
???????? 8. ????????
?\ `??????? <sound-mp3.html>`__

--------------

.. raw:: html

   </div>

.. raw:: html

   <div class="sect1">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

8.2. ??????? ??? ?????? ????
----------------------------

.. raw:: html

   </div>

.. raw:: html

   <div>

?????????? ??? ??? Moses Moore.

.. raw:: html

   </div>

.. raw:: html

   <div>

?????????? ??? ??? Marc Fonvieille.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

8.2.1. ??????????? ?? ???????
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

???? ??????????, ?? ?????? ?? ?????? ?? ??????? ??? ?????? ??? ?????, ??
???????????? ??????? ??? ????????????, ????? ??? ?? ????? PCI ? ISA. ??
FreeBSD ??????????? ?????? ???????? ?????? ????, ???? PCI ??? ??? ISA.
??????? ??? ??????????????? ???????? ???? ???? `??????????
?????? <http://www.FreeBSD.org/releases/10.1R/hardware.html>`__ ??? ??
????? ?? ? ????? ??? ?????????????. ???? ?????????? ?????? ??????????
?????? ???? ????????? ???????? ??????????? ??? ????? ???.

??? ?? ??????????????? ??? ??????? ???? ??? ?????????, ?? ?????? ??
????????? ??? ????????? ????? ????????. ???? ?????? ?? ?????????? ?? ???
???????. ? ??????????? ????? ????? ?? ????????? ??? module (???????) ???
??? ????? ???? ???? ??????, ??????????????? ??? ??????
`kldload(8) <http://www.FreeBSD.org/cgi/man.cgi?query=kldload&sektion=8>`__,
?? ?? ??????? ??? ??????? ???????:

.. code:: screen

    # kldload snd_emu10k1

? ???????????? ??? ????????? ?????? ??? ?????? ``/boot/loader.conf``
???? ????????:

.. code:: programlisting

    snd_emu10k1_load="YES"

?? ???????? ???????????? ????? ??? ??? ????? ???? Creative
SoundBlaster(R) Live!. ???????? ????????? ??? ???? modules ??? ??????
???? ??? ???????? ?? ?? ????? ??? ?????? ``/boot/defaults/loader.conf``.
?? ??? ????? ???????? ??? ?? ????????? ???????? ??? ?????? ??
???????????????, ???????? ?? ???????????? ?? ????????? ?? module
``snd_driver``:

.. code:: screen

    # kldload snd_driver

????????? ??? ??? ????-????????? ????????, ?? ????? ???????? ?? ???? ???
?? ????? ??????????? ???????? ??? ?????? ????. ?? ??? ????? ????
???????? ?? ??????????? ??? ????????? ??? ?? ????? ?????. ????????
?????? ?? ????????? ??? ?? ??????????? ???????? ???? ??? ???????
``/boot/loader.conf``.

?? ?????????? ?? ?????? ?? ?????????? ????????? ???????? ??? ?????? ???
???? ?? ??????? ??? ``snd_driver``, ???????? ?? ???????? ?? ??????
``/dev/sndstat`` ?? ??? ??????? ??? ??????? ``cat /dev/sndstat``.

??? ??????? ??????? ????? ?? ?????????????? ??? ?????????? ??? ??????
???? ???, ???????, ????????? ???? ??????. ?? ???????? ????? ??????? ???
??????????? ??? ?????????? ??? ?? ?????????? ?????????? ??? ?? ????? ???
?? ???? ??? ?????. ??? ???????????? ??????????? ??????? ?? ???
???????????? ??? ??????, ????? ?? `?????????9, *??????????? ??? ??????
??? FreeBSD* <kernelconfig.html>`__.

.. raw:: html

   <div class="sect3">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

8.2.1.1. ????????????? ????????????? ?????? ?? ?????????? ????
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

??????, ?????? ?? ?????????? ?? ?????? ????????? ???????? ???? (audio
framework driver)
`sound(4) <http://www.FreeBSD.org/cgi/man.cgi?query=sound&sektion=4>`__
???? ?????? ???. ?? ????????? ?? ?????????? ??? ???????? ?????? ???
?????? ????????? ??? ??????:

.. code:: programlisting

    device sound

??????, ?? ?????? ?? ?????????? ?????????? ??? ??? ????? ???? ???.
?????? ?? ????????? ??? ???? ???? ????????? ???????? ??? ???????????.
??????? ?? ????? ??? ??????????????? ?????? ???? `??????????
?????? <http://www.FreeBSD.org/releases/10.1R/hardware.html>`__, ??? ??
?????????? ?? ????? ????? ??? ??? ???? ???. ??? ??????????, ? Creative
SoundBlaster(R) Live!, ????????????? ??? ??? ?????
`snd\_emu10k1(4) <http://www.FreeBSD.org/cgi/man.cgi?query=snd_emu10k1&sektion=4>`__.
??? ?? ?????????? ?????????? ??? ???? ??? ?????, ?????????????? ???
???????? ??????:

.. code:: programlisting

    device snd_emu10k1

??????????? ??? ????????? ??? ?????? ??? manual ??? ?? ?????????
????????, ???? ?? ??????????????? ?? ????? ???????. ? ??????? ???????
??? ???? ?????????????? ????? ???? ??? ?????? ????????? ??????, ??????
?? ?????? ?????? ??? ?????? ``/usr/src/sys/conf/NOTES``.

??? ????? ???? ????? ISA ??? ??? ????? Plug'N'Play ?????? ?? ?????????
?? ?????? ???? ?????? ??????????? ??????? ?? ??? ????????? ??? (???? ??
IRQ, ???? I/O ???), ???? ??????? ?????? ?? ????? ??? ???????????. ????
?????? ?? ????? ???? ??? ??????? ``/boot/device.hints``. ???? ??
?????????? ??? ?????????, ?
`loader(8) <http://www.FreeBSD.org/cgi/man.cgi?query=loader&sektion=8>`__
?? ???????? ?? ?????? ??? ?? ??????????? ??? ????????? ???? ??????. ???
??????????, ??? ????? Creative SoundBlaster(R) 16 ISA ??-PnP ?????
???????????? ?? ????????? ????????
`snd\_sbc(4) <http://www.FreeBSD.org/cgi/man.cgi?query=snd_sbc&sektion=4>`__
?? ????????? ?? ?? ``snd_sb16``. ??? ??? ????? ???? ?????? ?? ??????????
?? ???????? ??????? ??? ?????? ????????? ??????:

.. code:: programlisting

    device snd_sbc
    device snd_sb16

??? ?? ???????? ??????? ??? ?????? ``/boot/device.hints``:

.. code:: programlisting

    hint.sbc.0.at="isa"
    hint.sbc.0.port="0x220"
    hint.sbc.0.irq="5"
    hint.sbc.0.drq="1"
    hint.sbc.0.flags="0x15"

???? ????????? ????, ? ????? ???????????? ?? ???? I/O ``0x220`` ??? ??
IRQ ``5``.

? ??????? ??? ??????????????? ??? ?????? ``/boot/device.hints``
????????? ??? ?????? manual ???
`sound(4) <http://www.FreeBSD.org/cgi/man.cgi?query=sound&sektion=4>`__
????? ??? ??? ?????? manual ??? ??????????? ???????????? ????????.

?? ????????? ??? ????????? ???????? ????? ?? ??????????????. ??
????????? ???????????, ?????? ?? ????????? ?? ???????? ?? IRQ ? ?????
????????? ???? ?? ?????????? ?? ??? ????????? ??? ?????? ???. ????? ??
?????? manual ???
`snd\_sbc(4) <http://www.FreeBSD.org/cgi/man.cgi?query=snd_sbc&sektion=4>`__
??? ???????????? ??????????? ??????? ?? ??? ????? ????.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

8.2.2. ???????????? ??? ????? ????
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

???? ?????? ???????????? ?? ??? ??? ?????? (? ???? ????????? ??
?????????? module), ?? ?????? ?? ????? ???????? ??????? ?? ??? ?????
???? ???? ????????? ????? (buffer) ?????????? ??? ??????????
(`dmesg(8) <http://www.FreeBSD.org/cgi/man.cgi?query=dmesg&sektion=8>`__)
?????????? ?? ?? ????????:

.. code:: screen

    pcm0: <Intel ICH3 (82801CA)> port 0xdc80-0xdcbf,0xd800-0xd8ff irq 5 at device 31.5 on pci0
    pcm0: [GIANT-LOCKED]
    pcm0: <Cirrus Logic CS4205 AC97 Codec>

? ????????? ??? ?????? ???? ?????? ?? ???????? ???? ??? ???????
``/dev/sndstat``:

.. code:: screen

    # cat /dev/sndstat
    FreeBSD Audio Driver (newpcm)
    Installed devices:
    pcm0: <Intel ICH3 (82801CA)> at io 0xd800, 0xdc80 irq 5 bufsz 16384
    kld snd_ich (1p/2r/0v channels duplex default)

?? ???????? ??? ??????? ??? ?????? ?? ????? ???????????. ?? ??? ?????
???????? ????? ``pcm``, ?????????? ??? ??????? ?? ?????? ??? ??????
????????????. ???????? ?? ?????? ????????? ?????? ??? ??????????? ???
????? ???????? ?? ????? ????????? ????????. ??? ?????? ?????????? ???
??? ???????????? ????, ????? ?? ????? `??????8.2.2.1, ????????????
??????????? <sound-setup.html#troubleshooting>`__.

?? ??? ???? ????, ? ????? ???? ??? ?? ??????????. ?? ? ?????? CD ? DVD
??? ????????? ????? ?????????? ?? ??? ????? ???? ???? ??? ?????????? ???
??????, ???????? ?? ?????? ??? ??????? CD ??? ?? ?? ??????????? ?? ??
?????????
`cdcontrol(1) <http://www.FreeBSD.org/cgi/man.cgi?query=cdcontrol&sektion=1>`__:

.. code:: screen

    % cdcontrol -f /dev/acd0 play 1

????? ?????????, ???? ??
`audio/workman <http://www.freebsd.org/cgi/url.cgi?ports/audio/workman/pkg-descr>`__
???????? ?????????? ?????????? ????????. ???? ?????? ?? ?????????????
??? ???????? ???? ??
`audio/mpg123 <http://www.freebsd.org/cgi/url.cgi?ports/audio/mpg123/pkg-descr>`__
??? ?? ??????????? ?????? ???? MP3.

???? ????? ???????? ?????? ??? ?? ???????? ??? ????? ???? ???, ????? ??
???????? ???????? ???? ??????? ``/dev/dsp``, ???? ????????:

.. code:: screen

    % cat filename > /dev/dsp

???? ?? ``filename`` ?????? ?? ????? ??????????? ??????. ? ????????
?????? ?? ?????? ?? ??????? ?????? ??? (??????) ??????????????? ?? ?????
?????????? ??? ?????? ????.

.. raw:: html

   <div class="note" xmlns="">

????????:
~~~~~~~~~

?? ?????? ???????? ``/dev/dsp*`` ?????????????? ???????? ????
??????????. ??? ???????? ?? ??? ???????????????? ??? ??? ?? ???????????
???? ????? ???
`ls(1) <http://www.FreeBSD.org/cgi/man.cgi?query=ls&sektion=1>`__

.. raw:: html

   </div>

? ?????? ???? ??? ?????? ?????? ?? ??????? ???? ??? ???????
`mixer(8) <http://www.FreeBSD.org/cgi/man.cgi?query=mixer&sektion=8>`__.
???????????? ??????????? ???????? ?? ?????? ???? ?????? ??? manual ???
`mixer(8) <http://www.FreeBSD.org/cgi/man.cgi?query=mixer&sektion=8>`__.

.. raw:: html

   <div class="sect3">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

8.2.2.1. ??????????? ??????????
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="informaltable">

+--------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ????????                                   | ????                                                                                                                                                                                                                       |
+============================================+============================================================================================================================================================================================================================+
| sb\_dspwr(XX) timed out                    | ??? ????? ????? ?????????? ? ???? I/O.                                                                                                                                                                                     |
+--------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| bad irq XX                                 | ?? IRQ ??? ????? ????? ??????????. ??????????? ??? ?? IRQ ??? ????? ??????? ????? ?? ???? ?? ???? ??? ???? ????????? ???? ?????.                                                                                           |
+--------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| xxx: gus pcm not attached, out of memory   | ??? ??????? ?????? ????????? ????? ??? ?? ????? ????? ??? ????????.                                                                                                                                                        |
+--------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| xxx: can't open /dev/dsp!                  | ??????? ?? ??? ??????? ??? ??????? ``fstat | grep dsp`` ?? ?????? ???? ???????? ????????? ?? ???????????? ???????. ???????? ??????? ????? ? ???????? esound ????? ??? ?? ??????? ??????????? ???? ??? ????????????? KDE.   |
+--------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. raw:: html

   </div>

??? ????? ???????? ????????????? ??? ????????? ????????? ?????? ????????
?? ?????? ????????? ??? ???? ???? ??????? ???? ??? ????? ???? ?????????
HDMI ? ???????????. ?? ????????? ???????????, ????? ??????? ???? ?
??????? ?? ?????????? ???? ??? ???????? ????? ???? ?? ?????????? ??
????? ?? ???? ??? ?????????????? ???????? ????. ??? ?? ???????? ??
????????? ????, ????????? ??? ?????? dmesg ??? ????? ??? ?? ????
``pcm``. ? ?????? ?? ??????? ?? ??? ????????:

.. code:: programlisting

    ...
    hdac0: HDA Driver Revision: 20100226_0142
    hdac1: HDA Driver Revision: 20100226_0142
    hdac0: HDA Codec #0: NVidia (Unknown)
    hdac0: HDA Codec #1: NVidia (Unknown)
    hdac0: HDA Codec #2: NVidia (Unknown)
    hdac0: HDA Codec #3: NVidia (Unknown)
    pcm0: <HDA NVidia (Unknown) PCM #0 DisplayPort> at cad 0 nid 1 on hdac0
    pcm1: <HDA NVidia (Unknown) PCM #0 DisplayPort> at cad 1 nid 1 on hdac0
    pcm2: <HDA NVidia (Unknown) PCM #0 DisplayPort> at cad 2 nid 1 on hdac0
    pcm3: <HDA NVidia (Unknown) PCM #0 DisplayPort> at cad 3 nid 1 on hdac0
    hdac1: HDA Codec #2: Realtek ALC889
    pcm4: <HDA Realtek ALC889 PCM #0 Analog> at cad 2 nid 1 on hdac1
    pcm5: <HDA Realtek ALC889 PCM #1 Analog> at cad 2 nid 1 on hdac1
    pcm6: <HDA Realtek ALC889 PCM #2 Digital> at cad 2 nid 1 on hdac1
    pcm7: <HDA Realtek ALC889 PCM #3 Digital> at cad 2 nid 1 on hdac1
    ...

??? ?????????? ???, ? ????? ???????? (``NVidia``) ??????????? ???? ???
???????? ????? ???? (``Realtek ALC889``). ??? ?? ??????????????? ???
?????????? ????? ???? ?? ??? ????????????? ??????? ????, ??????? ??
``hw.snd.default_unit`` ???? ???????? ????????:

.. code:: screen

    # sysctl hw.snd.default_unit=n

?? *``n``* ????? ? ??????? ??? ???????? ??? ?? ??????????????, ???
?????????? ??? ?? ``4``. ????????? ??? ???????? ?????? ???
``/etc/sysctl.conf`` ??? ?? ????? ?????? ???? ? ??????:

.. code:: programlisting

    hw.snd.default_unit=4

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

8.2.3. ??????????????? ????????? ????? ????
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   <div>

?????????? ??? ??? Munish Chopra.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

????? ?????? ????? ????????? ?? ?????? ????????? ????? ???? ??? ??
????????????? ??????????, ???? ???? ??? ?????????? ?? esound ? ?? artsd
??? ?????????? ????? ????? ??? ???????? ???? ?? ?????? ????????????
????????.

?? FreeBSD ????????? ???? ?? ?????????? ???? ??? *????????? ????????
???? (Virtual Sound Channels)*, ?? ????? ??????? ?? ?????????????? ????
??? ??????????? ??? ?????????? ??? ??
`sysctl(8) <http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&sektion=8>`__.
?? ???????? ??????? ??? ?????????? ?? ??????????? ???? ????? ???
?????????? ? ????? ???, ????????????? ??? ??? ???? ??????.

??? ?? ????????? ?? ?????? ??? ????????? ????????, ???????? ?????
????????? sysctl ??? ??????? ?? ?????? ?? ????? ? ??????? ``root``, ????
???????? ????????:

.. code:: screen

    # sysctl dev.pcm.0.play.vchans=4
    # sysctl dev.pcm.0.rec.vchans=4
    # sysctl hw.snd.maxautovchans=4

?? ???????? ?????????? ????????? ??????? ???????? ???????, ?? ?????
????? ???????? ??? ?????????? ?????. ?? ?????
``dev.pcm.0.play.vchans=4`` ??? ``dev.pcm.0.rec.vchans=4`` ???????????
???? ?????? ??? ????????? ???????? ??? ???????? ? ??????? ``pcm0`` ???
??????????? ??? ???????, ??? ??????? ?? ?????????? ???? ??? ??????????
??? ????????. ? ????????? ``hw.snd.maxautovchans`` ????? ? ??????? ???
????????? ???????? ??? ????????????? ?? ??? ??? ??????? ???? ???? ????
??????????? ???? ??? ???????
`kldload(8) <http://www.FreeBSD.org/cgi/man.cgi?query=kldload&sektion=8>`__.
????? ?? module ``pcm`` ?????? ?? ???????? ?????????? ??? ?? ???????????
???????? ??? ??????, ?? ``hw.snd.maxautovchans`` ?????? ?? ???????????
?? ??????? ?????? ??? ????????? ???????? ??? ?? ???????????? ?? ????
???????? ???? ???????????? ????????. ????? ?? ?????? manual
`pcm(4) <http://www.FreeBSD.org/cgi/man.cgi?query=pcm&sektion=4>`__ ???
???????????? ????????????.

.. raw:: html

   <div class="note" xmlns="">

????????:
~~~~~~~~~

??? ???????? ?? ???????? ??? ?????? ??? ????????? ???????? ???? ????????
??? ???? ????? ?? ?????. ????? ??????? ??? ??????????? ????????????? ??
???????, ???? ??????????? ???????????? ???????? ? ???????? ????.

.. raw:: html

   </div>

? ????? ??????? ``pcm`` ?????????? ???????? ??? ??????? ?? ????
????????? ??? ???? ?? ?????????????? ?? ``/dev/dsp0``.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

8.2.4. ??????????? ?????????????? ????? ??? ?? ??????? ??? ?????
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   <div>

?????????? ??? ??? Josef El-Rayes.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? ?????????????? ????? ??? ?? ??????? ??????? ??? ?????, ?????
????????????? ???? ?????? ?????? ??? ???????????? ????????
`pcm(4) <http://www.FreeBSD.org/cgi/man.cgi?query=pcm&sektion=4>`__.
???????? ?????? ???????????? ????????? ??? ???????? ??? ??? ??????????
?? ???????? ????? ??? ?????, ???????????????? ??? ?????? ??????????
???????, ???? ? ???? ???? ??? ????? ??? ? ????????. ????? ??????? ??
??????? ?????????????? ????? ????? ?? ??????? ???????????? ????????.
???? ?????? ?? ?????????? ?? ??? ??????? ?????????? ????? ??? ??????
``/boot/device.hints``, ?.?.:

.. code:: programlisting

    hint.pcm.0.vol="50"

?? ???????? ???????? ??? ?????? ??? ???? ???? ????????????? ???? 50,
???? ???????? ?? module
`pcm(4) <http://www.FreeBSD.org/cgi/man.cgi?query=pcm&sektion=4>`__.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="navfooter">

--------------

+--------------------------------+------------------------------+-----------------------------------+
| `????? <multimedia.html>`__?   | `???? <multimedia.html>`__   | ?\ `??????? <sound-mp3.html>`__   |
+--------------------------------+------------------------------+-----------------------------------+
| ???????? 8. ?????????          | `???? <index.html>`__        | ?8.3. ???? MP3                    |
+--------------------------------+------------------------------+-----------------------------------+

.. raw:: html

   </div>

???? ?? ???????, ??? ???? ???????, ?????? ?? ?????? ???
ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/

| ??? ????????? ??????? ?? ?? FreeBSD, ???????? ???
  `?????????? <http://www.FreeBSD.org/docs.html>`__ ???? ??
  ?????????????? ?? ??? <questions@FreeBSD.org\ >.
|  ??? ????????? ??????? ?? ???? ??? ??????????, ??????? e-mail ????
  <doc@FreeBSD.org\ >.
