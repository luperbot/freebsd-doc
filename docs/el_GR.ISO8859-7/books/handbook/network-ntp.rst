==============================================
29.10. ???????????? ???????? ?????????? ?? NTP
==============================================

.. raw:: html

   <div class="navheader">

29.10. ???????????? ???????? ?????????? ?? NTP
`????? <network-samba.html>`__?
???????? 29. ???????????? ???????
?\ `??????? <firewalls.html>`__

--------------

.. raw:: html

   </div>

.. raw:: html

   <div class="sect1">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.10. ???????????? ???????? ?????????? ?? NTP
----------------------------------------------

.. raw:: html

   </div>

.. raw:: html

   <div>

?????????? ??? Tom Hukins.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.10.1. ??????
~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? ?? ??????? ??? ??????, ?? ????? ?????????? ???? ?????????? ???? ???
???? ?? ????????????????. ?? ????????? ????????? ??????? (Network Time
Protocol ? NTP) ??????? ??? ????? ??? ?? ???????????? ??? ???????? ???
clock ???.

?????? ???????????? ????????? ?????????? ? ?????????? ?? ?????? ?????
??? ??? ???????? ??? ???????? ?????????? ???? ??????????. ???
??????????, ???? ???????????? web ?????? ?? ?????? ???????? ??? ????????
???? ??????? ???? ?? ?????? ???? ???? ???????????? ????? ??????
???????????? ???. ?? ??? ?????????? ??????? ???????, ????? ??????????
???? ?? ??????????? ??? ?? ????????????? ?????? ??? ??? ???? ??????????
??????? ?? ????? ????????????? ???????, ???? ???? ?? ???????
?????????????? ??? ??????? ?? ?????????. ?????? ?????????? ???? ?
`cron(8) <http://www.FreeBSD.org/cgi/man.cgi?query=cron&sektion=8>`__
?????????? ?? ??? ??????? ????? ???? ?? ??????? ?? ??????? ??????? ?????
???????????????? ???????.

?? FreeBSD ?????????? ?? ??? ??????????? NTP
`ntpd(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&sektion=8>`__, ?
?????? ?????? ?? ?????????????? ??? ?? ??????????? ?? ????? ??????????
??? ?????????? ???, ??????????? ?????? ???????????? NTP ? ?? ??????? ?
????? ????????? ???????????? ?? ???? ??????????.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.10.2. ??????? ??? ?????????? ???????????? NTP
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

??? ?? ???????????? ?? ????? ?????????? ??? ?????????? ??? ?? ?????? ??
?????? ???? ? ????????????? ??????????? NTP ???????????? ??? ??
???????????????. ? ???????????? ??????? ? ? ISP ??? ?????? ?? ?????
???????????? ??????? ??????????? NTP ??? ???? ?? ??????- ??????? ???
?????????? ???? ?? ????? ?? ??????? ?????? ?????????. ????????, ???????
??? `online ????? ???????????? ????????
????????? <http://ntp.isc.org/bin/view/Servers/WebHome>`__, ??? ????????
?? ??????????????? ??? ?? ?????? ???? ??????? ??????????? NTP. ??????
??????????? ?? ?? ?????????, ???????????? ??? ??? ???????? ?????? ???
??? ??????? ????? ?? ??? ??????????????? ?? ?????????? ?????? ?????.

????? ???? ???? ?? ????????? ??????? ???????????? NTP, ?? ?????? ?? ???
?????????? ?????? ????, ???? ????????? ??? ??????? ??? ???? ????????????
??? ?????????????? ????? ????????? ? ?? ????? ??? ????? ?????????. ?
????????????
`ntpd(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&sektion=8>`__
??? FreeBSD ?????????? ?????? ??? ?????????? ??? ???????? ??? ????
?????????? ?????????????- ?????? ???? ??? ??????????? ??? ???????
????????? ????????? ????? ???????? ??????????? ????????????.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.10.3. ???????? ?? ???????? ???
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="sect3">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.10.3.1. ??????? ?????????
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? ?????????? ?? ????????????? ?? clock ??? ???? ???? ??? ????????
??????????? ??? ???????????, ???? ???????? ?? ??????????????? ??
`ntpdate(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&sektion=8>`__.
????? ? ?????? ???????????? ????? ?????????? ??? ?????????? desktop ??
????? ?????? ???????????? ??? ????? ??????? ?????????? ??? ???? ??
??????? ??????????? ????? ?????? ????????????. ?????????, ?? ????????
?????????? ?? ?????? ?? ??????? ??? ?????????
`ntpd(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&sektion=8>`__.

????? ???? ???????? ?? ?????????? ??? ???????
`ntpd(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&sektion=8>`__ ??
????????????? ??? ??
`ntpdate(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&sektion=8>`__
???? ?? ???????? ????????? ????. ??
`ntpd(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&sektion=8>`__
?????????? ?? clock ????????, ??? ??
`ntpdate(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&sektion=8>`__
???????? ????? ?? clock ?????????? ??? ?? ???? ?????? ????? ? ???????
??????? ?????? ??????????? ??? ????????? ???? ??? clock ??? ???????????.

??? ?? ?????????????? ??
`ntpdate(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&sektion=8>`__
???? ??? ????????, ????????? ``ntpdate_enable="YES"`` ???
``/etc/rc.conf``. ?? ?????? ?? ????????????? ??? ``ntpdate_flags`` ?????
???? ??????????? ?? ???? ??????? ?????????? ?? ????????????? ??? ??? ??
flag ??? ?????? ?? ??????????
??\ `ntpdate(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&sektion=8>`__.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect3">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.10.3.2. ??????? ?????????
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? ????????? ??? NTP ?????????? ??? ?????? ``/etc/ntp.conf`` ??? ?????
??? ????? ??? ???????????? ???
`ntp.conf(5) <http://www.FreeBSD.org/cgi/man.cgi?query=ntp.conf&sektion=5>`__.
????????? ??? ???? ??????????:

.. code:: programlisting

    server ntplocal.example.com prefer
    server timeserver.example.org
    server ntp2a.example.net

    driftfile /var/db/ntp.drift

? ??????? ``server`` ???????????? ????? ???????????? ?? ???????????????,
???????????? ???? ?? ???? ??????. ?? ???? ???????????? ????? ?? ???????
``prefer``, ???? ????????? ?? ??? ``ntplocal.example.com``, ???? ????? ?
???????????? ????? ? ????????????. ?? ?????????? ? ???????? ??? ???
??????????? ??????????? ?? ????????? ??? ???????? ????????? ??? ?????
???? ?????? ????????????, ?? ????????? ??? ??? ??????? ?????? ????????
?? ?????????????? ????? ?? ??????? ?????? ?? ????? ??????????. ??
??????? ``prefer`` ??????? ??????????????? ?? ???????????? NTP
?????????, ???? ????? ??? ?????? ???????? ??????????? ??????????????
?????????.

? ??????? ``driftfile`` ???????????? ???? ?????? ??????????????? ??? ??
???????? ?? ????????? ????????? ??? clock ??? ??????????. ?? ?????????
`ntpd(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&sektion=8>`__
???????????? ???????? ???? ?? ???? ??? ?? ????????????? ??? ???????
?????????? ??? clock, ???????????? ??? ?? ???????? ??? ?????? ???????,
????? ?? ?? ??? ??????????? ??? ?????? ??????? ???????? ? ???????? ????
???? ??? ?????????? ????? ????????????.

? ??????? ``driftfile`` ???????????? ???? ?????? ??????????????? ??? ??
?????????? ??????????? ??????? ?? ??? ???????????? ?????????? ??? ????
???????????? NTP. ???? ?? ?????? ???????? ?????????? ??????????? ???
NTP. ??? ?? ?????? ?? ???????????? ??? ?????? ???? ?????????.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect3">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.10.3.3. ??????? ????????? ???? ??????????? ???
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?????????????, ? ???????????? ??? NTP ?? ????? ??????????? ??? ?????
???? ??????? ??? ?????????. ? ??????? ``restrict`` ??? ``/etc/ntp.conf``
??? ????????? ?? ???????? ???? ?????????? ?? ??????? ?? ????? ????????
???? ????????? ???.

?? ?????????? ?? ?????????? ??? ???????? ???? ??? ??????????? ??? NTP
??? ??? ?? ??????????, ????????? ??? ???????? ?????? ???
``/etc/ntp.conf``:

.. code:: programlisting

    restrict default ignore

?? ?????? ???? ?? ?????????? ??? ??????????? ??? ??????????? ??? ??
?????????? ????? ??? ??????? ???, ???? ????? ?????????? ???????? ???
??????????? ? ?? ?????? ?????????? ?? ????? ????????????, ???? ?????????
?????????:

.. code:: programlisting

    restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap

???? ``192.168.1.0`` ????? ? ????????? IP ??? ??????? ???
``255.255.255.0`` ????? ? ????? ??? ??????? ???.

?? ``/etc/ntp.conf`` ?????? ?? ???????? ????????? ???????? ``restrict``.
??? ???????????? ???????????, ????? ??? ??????????
``?????????? ???????       ????????? (Access Control Support)``,
?????????? ???
`ntp.conf(5) <http://www.FreeBSD.org/cgi/man.cgi?query=ntp.conf&sektion=5>`__.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.10.4. ???????? ??? NTP ??????????? ???
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

??? ?? ??????????? ??? ? ???????????? NTP ?? ???????? ???? ??? ????????
????????? ??? ??????????, ????????? ?? ??????
``ntpd_enable="YES"``???\ ``/etc/rc.conf``. ??? ?? ?????????? ???
??????????? ????? ?? ?????????????? ?? ???????? ???, ??????
`ntpd(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&sektion=8>`__
??????????????? ???? ??????????? ????????? ??? ?? ``ntpd_flags`` ???
``/etc/rc.conf``. ??? ??????????:

.. code:: screen

    # ntpd -p /var/run/ntpd.pid

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.10.5. ????? ??? ntpd ?? ????????? ??????? ??? ????????
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? ?????????
`ntpd(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&sektion=8>`__
??? ?????????? ??? ?????? ??????? ??? ???????? ??? ?? ???????? ?????. ??
????? ??? ????????? ??????? ??? ????? ?????????? ?? ????? ??????? ????
????????? (dial out on demand), ????? ???? ?? ??? ????? ? ??????
????????? ??? NTP ?? ????? ??? ?????? ? ???? ??? ?? ??????? ?????? ???
???????. ?? ?????????????? PPP ??????, ???????? ?? ???????????????
``??????`` ????? ??????? ?????????? ??? ``/etc/ppp/ppp.conf``, ???? ???
??????????:

.. code:: programlisting

     set filter dial 0 deny udp src eq 123
     # Prevent NTP traffic from initiating dial out
     set filter dial 1 permit 0 0
     set filter alive 0 deny udp src eq 123
     # Prevent incoming NTP traffic from keeping the connection open
     set filter alive 1 deny udp dst eq 123
     # Prevent outgoing NTP traffic from keeping the connection open
     set filter alive 2 permit 0/0 0/0

??? ???????????? ???????????? ????? ?? ``PACKET     FILTERING`` ????
???????
`ppp(8) <http://www.FreeBSD.org/cgi/man.cgi?query=ppp&sektion=8>`__ ???
?? ???????????? ??? ``/usr/share/examples/ppp/``.

.. raw:: html

   <div class="note" xmlns="">

????????:
~~~~~~~~~

????????: ??????? ISP ?????????? ??? ????? ????? ?? ?????? ??????,
???????????? ??? NTP ?? ???????? ???? ?? ?????????? ??? ??????? ???? ???
???????? ???.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.10.6. ????????? ???????????
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

? ?????????? ??? ???? ???????????? NTP ?????????? ??? ?? ????? HTML ???
``/usr/share/doc/ntp/``.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="navfooter">

--------------

+------------------------------------------------------------------------------+-----------------------------------+-----------------------------------+
| `????? <network-samba.html>`__?                                              | `???? <network-servers.html>`__   | ?\ `??????? <firewalls.html>`__   |
+------------------------------------------------------------------------------+-----------------------------------+-----------------------------------+
| 29.9. File and Print Services for Microsoft(R)?Windows(R) clients (Samba)?   | `???? <index.html>`__             | ????????? 30. Firewalls           |
+------------------------------------------------------------------------------+-----------------------------------+-----------------------------------+

.. raw:: html

   </div>

???? ?? ???????, ??? ???? ???????, ?????? ?? ?????? ???
ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/

| ??? ????????? ??????? ?? ?? FreeBSD, ???????? ???
  `?????????? <http://www.FreeBSD.org/docs.html>`__ ???? ??
  ?????????????? ?? ??? <questions@FreeBSD.org\ >.
|  ??? ????????? ??????? ?? ???? ??? ??????????, ??????? e-mail ????
  <doc@FreeBSD.org\ >.
