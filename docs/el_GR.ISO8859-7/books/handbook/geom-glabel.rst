==========================================================
20.7. ????????????? ???????? (Labels) ???? ???????? ??????
==========================================================

.. raw:: html

   <div class="navheader">

20.7. ????????????? ???????? (Labels) ???? ???????? ??????
`????? <geom-ggate.html>`__?
???????? 20. GEOM: ?????????? ?????????? ??????
?\ `??????? <geom-gjournal.html>`__

--------------

.. raw:: html

   </div>

.. raw:: html

   <div class="sect1">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

20.7. ????????????? ???????? (Labels) ???? ???????? ??????
----------------------------------------------------------

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

???? ?? ???????? ??? ?????????????, ???? ???????? ??? ??????????, ?
??????? ??? FreeBSD ?? ???????????? ?? ?????????? ?????? ??? ????
??????? ??? ?????????. ???? ? ??????? ?????????? ????????, ?????? ??
???????????? ??????????. ??? ??????????, ?? ?? ????? ?? ??????????? ???
??? ????? USB; ????? ?????? ?????? ??? ??????? ?????? flash ?? ????? ??
????? ``da0`` ??? ? ?????? ``da0`` ?? ??????????? ??? ``da1``. ???? ??
?????????? ?????????? ???? ?????????? ??? ?????????? ???????, ??
???????? ?? ??????????? ???????????? ???? ??? ``/etc/fstab``, ??? ??????
????? ??? ?? ???????????? ??? ???????? ???????? ??? ??????????.

??? ???? ????? ?? ????????? ??? ???????? SCSI ?? ?????? ?????, ???? ?
???????? ???? ?? ????? ??????????. ????, ???? ???? ??? ?????????? ???
??? ??????? ???? ??????? SCSI ?? ????? ???????? ??? ?? ????? ?????? ???
??? ???? ??????????????. ???? ?? ??????? ?? ??? ???????? USB ??? ??????
?? ??????????????? ??? ????? SCSI ?????; ???? ?????? ???????? ?? ??????,
????? ?? ???????? USB ???????????? ???? ???? ???? ??? ??? ??????? SCSI.
??? ???? ????? ?? ?????? ??? ???????? ????? ???? ???? ??? ???????? ???
??????????. ??? ???? ??????? ????? ?? ?????????????? ???? ??? ???????
????? ATA ??? ?? ??? ??????????? ???? ???? ??????? SCSI ???
``/etc/fstab``.

??????? ?????? ???????? ????. ??????????????? ?? ????????? ?????????
``glabel``, ???? ???????????? ? ???????, ?????? ?? ???????? ????????
???? ???????? ?????? ??? ?? ??? ?????????????? ??? ``/etc/fstab``, ????
??? ?? ????????? ??????? ????????. ?????? ? ``glabel`` ?????????? ???
??????? ???? ????????? ????? ??? ???? ??????? (???????? ??????), ?
??????? ??????????? ??? ???? ??? ??? ???????????? ??? ??????????.
??????????????? ???? ??? ??????? ?? ????? ????????, ?? ???????? ??
???????????? ????? ?? ??????? ???????, ?????? ?? ?? ?????????? ?????
???????? ??? ???? ???????? ??? ?????.

.. raw:: html

   <div class="note" xmlns="">

????????:
~~~~~~~~~

??? ?????????? ?????? ?? ????????? ??? ???? ? ??????? ?? ?????? ?? ?????
??????. ?? ????????? ????????? ``glabel`` ?????? ?? ???????????? ????
??????? ??? ??? ?????????? ????????. ???? ?? ??????? ????????
???????????? ???????? ???? ??? ??? ????????????. ????? ?? ?????? manual
???
`glabel(8) <http://www.FreeBSD.org/cgi/man.cgi?query=glabel&sektion=8>`__
??? ???????????? ??????????? ??????? ?? ?? ???? ??? ????????.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

20.7.1. ???? ???????? ??? ????????????
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

???????? ??? ????? ????????, ? ?????? ??????? ??? ? ??????? ??????????
???????. ?? ???????? ?????? ?? ????? ?????????? ? ???????. ?? ???????
???????? ??????? ?? ????????????? ?? ??? ???????
`tunefs(8) <http://www.FreeBSD.org/cgi/man.cgi?query=tunefs&sektion=8>`__
?
`newfs(8) <http://www.FreeBSD.org/cgi/man.cgi?query=newfs&sektion=8>`__.
???? ????????? ????, ?? ????????????? ?? ??? ??????????? ??? ``/dev``.
??? ??????????, ?? ???????? ???????? ?? ??????? ??????? UFS2, ??
????????????? ???? ???????? ``/dev/ufs``. ??????? ???????? ???????
?????? ?? ????????????? ?? ????? ??? ??????? ``glabel label``. ??
???????? ????? ??? ?????????? ??? ?? ??????? ???????, ??? ??????????????
???? ???????? ``/dev/label``.

?? ???????? ?????????? ?????, ???????? ?? ???? ???????????? ???
??????????. ?? ???????? ????? ?????????????? ???? ????????
``/dev/label`` ??? ????? ??????? ??? ??????????????. ???????? ??
????????????? ?????????? ???????? ?? ??? ?????? ``glabel create``. ???
???????????? ???????????, ???????? ?? ?????? manual ???
`glabel(8) <http://www.FreeBSD.org/cgi/man.cgi?query=glabel&sektion=8>`__.

??? ?? ????????????? ??? ?????? ??????? ??? ??? ??????? ??????? UFS2,
????? ?? ???????????? ?? ???????? ??? ????????, ?????????????? ???
???????? ??????:

.. code:: screen

    # tunefs -L home /dev/da3

.. raw:: html

   <div class="warning" xmlns="">

?????????????:
~~~~~~~~~~~~~~

?? ?? ??????? ??????? ????? ??????, ? ???????? ?????? ?????? ??
?????????? ?????????? ?????????. ??????, ?? ?? ??????? ??????? ?????
??????, ?????? ??? ?? ?????? ?? ????? ?? ?????????? ?? ?????? ??? ???
????????????????, ??? ??? ?? ?????????? ????????.

.. raw:: html

   </div>

?? ?????? ???? ?? ??????? ??? ??????? ???? ???????? ``/dev/ufs`` ? ?????
?????? ?? ????????? ??? ``/etc/fstab``:

.. code:: programlisting

    /dev/ufs/home        /home            ufs     rw              2      2

.. raw:: html

   <div class="note" xmlns="">

????????:
~~~~~~~~~

?? ??????? ??????? ??? ?????? ?? ????? ???????????? ????? ????????? ???
?????? ``tunefs``.

.. raw:: html

   </div>

???????? ???? ?? ???????????? ?? ??????? ??????? ?? ?? ?????? ?????:

.. code:: screen

    # mount /home

??? ??? ??? ????, ??? ??? ?? ??????? ``geom_label.ko`` ?????????? ????
?????? ???? ??? ``/boot/loader.conf`` ? ?????? ????? ????? ??? ???????
``GEOM_LABEL`` ???? ?????? ???, ????? ??? ?? ?? ????? ??? ????????
???????, ??? ?? ???? ????? ??????? ???????? ??? ??????? ???.

???????? ?????? ?? ????????????? ????????? ??????? ?? ?????????????
???????, ??????????????? ??? ??????? ``-L`` ???? ?????? ``newfs``. ?????
??? ?????? manual ???
`newfs(8) <http://www.FreeBSD.org/cgi/man.cgi?query=newfs&sektion=8>`__
??? ???????????? ???????????.

???????? ?? ??????????????? ??? ???????? ?????? ??? ?? ???????????? ???
???????:

.. code:: screen

    # glabel destroy home

?? ??????? ?????????? ??????? ??? ??????? ?? ?????? ???????? ????
??????????? ??? ?????? ?????????.

.. raw:: html

   <div class="example">

.. raw:: html

   <div class="example-title">

?????????? 20.1. ?????????? ???????? ???? ??????????? ??? ??????
?????????

.. raw:: html

   </div>

.. raw:: html

   <div class="example-contents">

????????????? ??????? ???????? ???? ??????????? ??? ?????? ?????????, ??
??????? ??? ?? ????????? ?? ??????? ???????? ????? ??? ?? ?????????? ??
????? ?? ???? ??????? ? ????? ??? ?? ??????????? ???????. ??? ??????????
???, ???????? ??? ??????????????? ???? ?????? ATA, ? ??????
????????????? ??? ?? ??????? ?? ``ad0``. ???????? ?????? ???
??????????????? ? ??????????? ??????? ??????????? ??? FreeBSD, ???
???????????? ??? ??????????? ``/``, ``/var``, ``/usr`` ??? ``/tmp`` ????
?????? ??? ??? ????????? swap.

????????????? ?? ???????, ??? ???? ?????????? ? ???????? ???
`loader(8) <http://www.FreeBSD.org/cgi/man.cgi?query=loader&sektion=8>`__,
?????? ?? **4** ??? ?? ??????????????? ???????? ?? ????????? ????
??????. ??????, ????? ??? ????????? ???????:

.. code:: screen

    # glabel label rootfs /dev/ad0s1a
    GEOM_LABEL: Label for provider /dev/ad0s1a is label/rootfs
    # glabel label var /dev/ad0s1d
    GEOM_LABEL: Label for provider /dev/ad0s1d is label/var
    # glabel label usr /dev/ad0s1f
    GEOM_LABEL: Label for provider /dev/ad0s1f is label/usr
    # glabel label tmp /dev/ad0s1e
    GEOM_LABEL: Label for provider /dev/ad0s1e is label/tmp
    # glabel label swap /dev/ad0s1b
    GEOM_LABEL: Label for provider /dev/ad0s1b is label/swap
    # exit

? ???????? ?? ?????????? ???????? ??? ?? ??????? ?? ????? ?? ?????????
????????? ??????? (multi-user). ???? ?? ????? ??? ?????????,
?????????????? ?? ?????? ``/etc/fstab`` ??? ??????? ?? ????????? ???????
???????? ?? ??? ??????????? ????????. ?? ?????? ?????? ``/etc/fstab`` ??
??????? ?? ?? ????????:

.. code:: programlisting

    # Device                Mountpoint      FStype  Options         Dump    Pass#
    /dev/label/swap         none            swap    sw              0       0
    /dev/label/rootfs       /               ufs     rw              1       1
    /dev/label/tmp          /tmp            ufs     rw              2       2
    /dev/label/usr          /usr            ufs     rw              2       2
    /dev/label/var          /var            ufs     rw              2       2

???????? ???? ?? ?????????????? ?? ???????. ?? ??? ????? ????, ?
???????? ?? ????? ????????, ??? ? ?????? ``mount`` ?? ??????:

.. code:: screen

    # mount
    /dev/label/rootfs on / (ufs, local)
    devfs on /dev (devfs, local)
    /dev/label/tmp on /tmp (ufs, local, soft-updates)
    /dev/label/usr on /usr (ufs, local, soft-updates)
    /dev/label/var on /var (ufs, local, soft-updates)

.. raw:: html

   </div>

.. raw:: html

   </div>

?????????? ??? ?? FreeBSD?7.2, ??
`glabel(8) <http://www.FreeBSD.org/cgi/man.cgi?query=glabel&sektion=8>`__
??????????? ??? ??? ????? ???????? ??? ????????? ??????? UFS, ???
????????? ?? ??? ????????? ????????????? ????, ?? ``ufsid``. ?? ????????
????? ?????????? ???? ???????? ``/dev/ufsid``, ?????????????? ????????
???? ??? ???????? ??? ?????????? ??? ????? ??????? ?? ???????????????
??? ??? ?????????? ??????????? ???? ??? ``/etc/fstab``. ???????? ??
??????????????? ??? ?????? ``glabel status`` ??? ?? ?????? ??? ????? ???
?????????? ??????? ?? ??? ??????????? ``ufsid`` ???????? ????:

.. code:: screen

    % glabel status
                      Name  Status  Components
    ufsid/486b6fc38d330916     N/A  ad4s1d
    ufsid/486b6fc16926168e     N/A  ad4s1f

??? ???????? ??????????, ?? ``ad4s1d`` ?????????????? ?? ??????? ???????
``/var``, ??? ?? ``ad4s1f`` ?????????????? ?? ??????? ??????? ``/usr``.
??????????????? ??? ????? ``ufsid`` ??? ?????????, ? ?????????? ?????
??? ??????????? ?????? ?? ????? ?? ??? ???????? ???????????? ???
``/etc/fstab``:

.. code:: programlisting

    /dev/ufsid/486b6fc38d330916        /var        ufs        rw        2      2
    /dev/ufsid/486b6fc16926168e        /usr        ufs        rw        2      2

??????????? ????????? ???????? ????????????? ``ufsid`` ?????? ??
??????????? ?? ??? ???? ?????, ????? ?? ??????? ????? ?????? ??
???????????? ?????? ??????? ???????????. ? ?????????? ???? ????????
``ufsid``, ??????? ?? ??????????? ??? ???????????? ??? ?? ?????
????????, ?? ????? ???????? ??? ?? ??????? ????????.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="navfooter">

--------------

+--------------------------------------------+-------------------------+---------------------------------------+
| `????? <geom-ggate.html>`__?               | `???? <GEOM.html>`__    | ?\ `??????? <geom-gjournal.html>`__   |
+--------------------------------------------+-------------------------+---------------------------------------+
| 20.6. ????????? ???????? ???? GEOM Gate?   | `???? <index.html>`__   | ?20.8. UFS Journaling ???? GEOM       |
+--------------------------------------------+-------------------------+---------------------------------------+

.. raw:: html

   </div>

???? ?? ???????, ??? ???? ???????, ?????? ?? ?????? ???
ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/

| ??? ????????? ??????? ?? ?? FreeBSD, ???????? ???
  `?????????? <http://www.FreeBSD.org/docs.html>`__ ???? ??
  ?????????????? ?? ??? <questions@FreeBSD.org\ >.
|  ??? ????????? ??????? ?? ???? ??? ??????????, ??????? e-mail ????
  <doc@FreeBSD.org\ >.
