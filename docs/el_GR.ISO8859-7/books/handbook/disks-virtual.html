<?xml version="1.0" encoding="iso-8859-7" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-7" /><title>19.11. Network, Memory, and File-Backed File Systems</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Εγχειρίδιο του FreeBSD" /><link rel="up" href="disks.html" title="Κεφάλαιο 19. Αποθηκευτικά Μέσα" /><link rel="prev" href="backup-basics.html" title="19.10. Backup Basics" /><link rel="next" href="snapshots.html" title="19.12. File System Snapshots" /><link rel="copyright" href="legalnotice.html" title="Νομική Σημείωση" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">19.11. Network, Memory, and File-Backed File Systems</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="backup-basics.html">Προηγ</a> </td><th width="60%" align="center">Κεφάλαιο 19. Αποθηκευτικά Μέσα</th><td width="20%" align="right"> <a accesskey="n" href="snapshots.html">Επόμενο</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="disks-virtual"></a>19.11. Network, Memory, and File-Backed File Systems</h2></div><div><span class="authorgroup">Reorganized and enhanced by <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Marc</span> <span class="surname">Fonvieille</span></span>. </span></div></div></div><a id="idp90795472" class="indexterm"></a><a id="idp90795984" class="indexterm"></a><p>In addition to physical disks such as floppies, CDs, and
      hard drives, FreeBSD also supports
      <em class="firstterm">virtual disks</em>.</p><a id="idp90802128" class="indexterm"></a><a id="idp90802640" class="indexterm"></a><a id="idp90803152" class="indexterm"></a><p>These include network file systems such as the
      <a class="link" href="network-nfs.html" title="29.3. Network File System (NFS)">Network File System</a> and Coda,
      memory-based file systems, and file-backed file systems.</p><p>According to the FreeBSD version, the tools used for the
      creation and use of file-backed and memory-based file systems
      differ.</p><div xmlns="" class="note"><h3 class="admontitle">Σημείωση: </h3><p xmlns="http://www.w3.org/1999/xhtml">Use <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">devfs</span>(5)</span></a> to allocate device nodes transparently
	for the user.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="disks-mdconfig"></a>19.11.1. File-Backed File System</h3></div></div></div><a id="idp90808016" class="indexterm"></a><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a> is used to configure and enable memory
	disks, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a>, under FreeBSD.  To use <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a>,
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a> must be first loaded.  When using a custom kernel
	configuration file, ensure it includes this line:</p><pre class="programlisting">device md</pre><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a> supports several types of memory backed
	virtual disks: memory disks allocated with <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> and
	memory disks using a file or swap space as backing.  One
	possible use is the mounting of CD images.</p><p>To mount an existing file system image:</p><div class="example"><a id="idp90815184"></a><div class="example-title">Παράδειγμα 19.3. Using <code class="command">mdconfig</code> to Mount an Existing
	  File System Image</div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t vnode -f diskimage -u 0</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/md0 /mnt</code></strong></pre></div></div><br class="example-break" /><p>To create a new file system image with
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a>:</p><div class="example"><a id="idp90827472"></a><div class="example-title">Παράδειγμα 19.4. Creating a New File-Backed Disk with
	  <code class="command">mdconfig</code></div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/dev/zero of=newimage bs=1k count=5k</code></strong>
5120+0 records in
5120+0 records out
<code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t vnode -f newimage -u 0</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>bsdlabel -w md0 auto</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>newfs md0a</code></strong>
/dev/md0a: 5.0MB (10224 sectors) block size 16384, fragment size 2048
        using 4 cylinder groups of 1.25MB, 80 blks, 192 inodes.
super-block backups (for fsck -b #) at:
 160, 2720, 5280, 7840
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/md0a /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>df /mnt</code></strong>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0a       4710    4  4330     0%    /mnt</pre></div></div><br class="example-break" /><p>If unit number is not specified with
	<code class="option">-u</code>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a> uses the
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a> automatic allocation to select an unused device.
	The name of the allocated unit will be output to stdout, such
	as <code class="filename">md4</code>.  Refer to <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a>
	for more details about.</p><p>While <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a> is useful, it takes several
	command lines to create a file-backed file system.  FreeBSD also
	comes with <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdmfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdmfs</span>(8)</span></a> which automatically configures a
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a> disk using <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a>, puts a UFS file system
	on it using <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a>, and mounts it using <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a>.
	For example, to create and mount the same file system image as
	above, type the following:</p><div class="example"><a id="idp90846288"></a><div class="example-title">Παράδειγμα 19.5. Configure and Mount a File-Backed Disk with
	  <code class="command">mdmfs</code></div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/dev/zero of=newimage bs=1k count=5k</code></strong>
5120+0 records in
5120+0 records out
<code class="prompt">#</code> <strong class="userinput"><code>mdmfs -F newimage -s 5m md0 /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>df /mnt</code></strong>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0        4718    4  4338     0%    /mnt</pre></div></div><br class="example-break" /><p>When <code class="option">md</code> is used without a unit number,
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdmfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdmfs</span>(8)</span></a> uses the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a> auto-unit feature to
	automatically select an unused device.  For more details
	about <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdmfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdmfs</span>(8)</span></a>, refer to its manual page.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="disks-md-freebsd5"></a>19.11.2. Memory-Based File System</h3></div></div></div><a id="idp90853968" class="indexterm"></a><p>For a memory-based file system, <span class="quote">«<span class="quote">swap
	  backing</span>»</span> should normally be used.  This does not mean
	that the memory disk will be swapped out to disk by default,
	but rather that the memory disk will be allocated from a
	memory pool which can be swapped out to disk if needed.  It is
	also possible to create memory-based disks which are
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> backed, but using large malloc backed memory
	disks can result in a system panic if the kernel runs out of
	memory.</p><div class="example"><a id="idp90856784"></a><div class="example-title">Παράδειγμα 19.6. Creating a New Memory-Based Disk with
	  <code class="command">mdconfig</code></div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t swap -s 5m -u 1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>newfs -U md1</code></strong>
/dev/md1: 5.0MB (10240 sectors) block size 16384, fragment size 2048
        using 4 cylinder groups of 1.27MB, 81 blks, 192 inodes.
        with soft updates
super-block backups (for fsck -b #) at:
 160, 2752, 5344, 7936
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/md1 /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>df /mnt</code></strong>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md1        4718    4  4338     0%    /mnt</pre></div></div><br class="example-break" /><div class="example"><a id="idp90861136"></a><div class="example-title">Παράδειγμα 19.7. Creating a New Memory-Based Disk with
	  <code class="command">mdmfs</code></div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdmfs -s 5m md2 /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>df /mnt</code></strong>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md2        4846    2  4458     0%    /mnt</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90876496"></a>19.11.3. Detaching a Memory Disk from the System</h3></div></div></div><a id="idp90877136" class="indexterm"></a><p>When a memory-based or file-based file system is no
	longer in use, its resources should be released back to
	the system.  First, unmount the file system, then use
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a> to detach the disk from the system and
	release the resources.</p><p>For example, to detach and free all resources used by
	<code class="filename">/dev/md4</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -d -u 4</code></strong></pre><p>It is possible to list information about configured
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a> devices by running
	<code class="command">mdconfig -l</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="backup-basics.html">Προηγ</a> </td><td width="20%" align="center"><a accesskey="u" href="disks.html">Πάνω</a></td><td width="40%" align="right"> <a accesskey="n" href="snapshots.html">Επόμενο</a></td></tr><tr><td width="40%" align="left" valign="top">19.10. Backup Basics </td><td width="20%" align="center"><a accesskey="h" href="index.html">Αρχή</a></td><td width="40%" align="right" valign="top"> 19.12. File System Snapshots</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Αυτό το κείμενο, και άλλα κείμενα, μπορεί να βρεθεί στο
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Για ερωτήσεις σχετικά με το FreeBSD, διαβάστε την
    <a href="http://www.FreeBSD.org/docs.html">τεκμηρίωση</a> πριν να επικοινωνήσετε με την
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Για ερωτήσεις σχετικά με αυτή την τεκμηρίωση, στείλτε e-mail στην
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>