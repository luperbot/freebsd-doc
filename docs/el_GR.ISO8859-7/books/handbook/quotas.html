<?xml version="1.0" encoding="iso-8859-7" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-7" /><title>19.13. File System Quotas</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Εγχειρίδιο του FreeBSD" /><link rel="up" href="disks.html" title="Κεφάλαιο 19. Αποθηκευτικά Μέσα" /><link rel="prev" href="snapshots.html" title="19.12. File System Snapshots" /><link rel="next" href="disks-encrypting.html" title="19.14. Encrypting Disk Partitions" /><link rel="copyright" href="legalnotice.html" title="Νομική Σημείωση" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">19.13. File System Quotas</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="snapshots.html">Προηγ</a> </td><th width="60%" align="center">Κεφάλαιο 19. Αποθηκευτικά Μέσα</th><td width="20%" align="right"> <a accesskey="n" href="disks-encrypting.html">Επόμενο</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="quotas"></a>19.13. File System Quotas</h2></div></div></div><a id="idp90876112" class="indexterm"></a><a id="idp90877264" class="indexterm"></a><p>Quotas are an optional feature of the operating system that
      can be used to limit the amount of disk space or the number of
      files a user or members of a group may allocate on a per-file
      system basis.  This is used most often on timesharing systems
      where it is desirable to limit the amount of resources any one
      user or group of users may allocate.  This prevents one user or
      group of users from consuming all of the available disk
      space.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90878160"></a>19.13.1. Configuring the System to Enable Disk Quotas</h3></div></div></div><p>Before using disk quotas, quota support must be added to
	the kernel by adding the following line to the kernel
	configuration file:</p><pre class="programlisting">options QUOTA</pre><p>Before FreeBSD 9.2, the <code class="filename">GENERIC</code>
	kernel usually did not include this option.
	<code class="command">sysctl kern.features.ufs_quota</code> can be used
	to test whether the current kernel supports quotas.  If the
	option is not present, a custom kernel must be compiled.
	Refer to <a class="xref" href="kernelconfig.html" title="Κεφάλαιο 9. Ρυθμίζοντας τον Πυρήνα του FreeBSD">Κεφάλαιο 9, <em>Ρυθμίζοντας τον Πυρήνα του FreeBSD</em></a> for more information
	on kernel configuration.</p><p>Next, enable disk quotas in
	<code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">quota_enable="YES"</pre><a id="idp90882256" class="indexterm"></a><p>For finer control over quota startup, an additional
	configuration variable is available.  Normally on bootup, the
	quota integrity of each file system is checked by
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotacheck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotacheck</span>(8)</span></a>.  This program insures that the data in the
	quota database properly reflects the data on the file system.
	This is a time consuming process that will significantly
	affect the time the system takes to boot.  To skip this step,
	add this variable to <code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">check_quotas="NO"</pre><p>Finally, edit <code class="filename">/etc/fstab</code> to enable
	disk quotas on a per-file system basis.  This is when user or
	group quotas can be enabled on the file systems.</p><p>To enable per-user quotas on a file system, add
	<code class="option">userquota</code> to the options field in the
	<code class="filename">/etc/fstab</code> entry for the file system to
	enable quotas on.  For example:</p><pre class="programlisting">/dev/da1s2g   /home    ufs rw,userquota 1 2</pre><p>To enable group quotas, instead use
	<code class="option">groupquota</code>.  To enable both user and group
	quotas, change the entry as follows:</p><pre class="programlisting">/dev/da1s2g    /home    ufs rw,userquota,groupquota 1 2</pre><p>By default, the quota files are stored in the root
	directory of the file system as
	<code class="filename">quota.user</code> and
	<code class="filename">quota.group</code>.  Refer to <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fstab&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">fstab</span>(5)</span></a> for
	more information.  Even though an alternate location for the
	quota files can be specified, this is not recommended because
	the various quota utilities do not seem to handle this
	properly.</p><p>Once the configuration is complete, reboot the system
	with the new kernel.  <code class="filename">/etc/rc</code> will
	automatically run the appropriate commands to create the
	initial quota files for all of the quotas enabled in
	<code class="filename">/etc/fstab</code>.  There is no need to
	manually create any zero length quota files.</p><p>In the normal course of operations, there should be no
	need to manually run <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotacheck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotacheck</span>(8)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotaon&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotaon</span>(8)</span></a>, or
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotaoff&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotaoff</span>(8)</span></a>.  However, one should read their manual pages
	to be familiar with their operation.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90903376"></a>19.13.2. Setting Quota Limits</h3></div></div></div><a id="idp90904016" class="indexterm"></a><p>Once the system has been configured to enable quotas,
	verify they really are enabled by running:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>quota -v</code></strong></pre><p>There should be a one line summary of disk usage and
	current quota limits for each file system that quotas are
	enabled on.</p><p>The system is now ready to be assigned quota limits with
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a>.</p><p>Several options are available to enforce limits on the
	amount of disk space a user or group may allocate, and how
	many files they may create.  Allocations can be limited based
	on disk space (block quotas), number of files (inode quotas),
	or a combination of both.  Each limits is further broken down
	into two categories: hard and soft limits.</p><a id="idp90912720" class="indexterm"></a><p>A hard limit may not be exceeded.  Once a user reaches a
	hard limit, no further allocations can be made on that file
	system by that user.  For example, if the user has a hard
	limit of 500 kbytes on a file system and is currently using
	490 kbytes, the user can only allocate an additional 10
	kbytes.  Attempting to allocate an additional 11 kbytes will
	fail.</p><a id="idp90913616" class="indexterm"></a><p>Soft limits can be exceeded for a limited amount of time,
	known as the grace period, which is one week by default.  If a
	user stays over their limit longer than the grace period, the
	soft limit turns into a hard limit and no further allocations
	are allowed.  When the user drops back below the soft limit,
	the grace period is reset.</p><p>The following is an example output from <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a>.
	When <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a> is invoked, the editor specified by
	<code class="envar">EDITOR</code> is opened in order to edit the quota
	limits.  The default editor is set to
	<span class="application">vi</span>.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>edquota -u test</code></strong></pre><pre class="programlisting">Quotas for user test:
/usr: kbytes in use: 65, limits (soft = 50, hard = 75)
        inodes in use: 7, limits (soft = 50, hard = 60)
/usr/var: kbytes in use: 0, limits (soft = 50, hard = 75)
        inodes in use: 0, limits (soft = 50, hard = 60)</pre><p>There are normally two lines for each file system that
	has quotas enabled.  One line represents the block limits and
	the other represents the inode limits.  Change the value to
	modify the quota limit.  For example, to raise this
	user's block limit from a soft limit of 50 and a hard limit of
	75 to a soft limit of 500 and a hard limit of 600,
	change:</p><pre class="programlisting">/usr: kbytes in use: 65, limits (soft = 50, hard = 75)</pre><p>to:</p><pre class="programlisting">/usr: kbytes in use: 65, limits (soft = 500, hard = 600)</pre><p>The new quota limits take affect upon exiting the
	editor.</p><p>Sometimes it is desirable to set quota limits on a range
	of UIDs.  This can be done by passing <code class="option">-p</code> to
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a>.  First, assign the desired quota limit to a
	user, then run
	<code class="command">edquota -p protouser startuid-enduid</code>.  For
	example, if <code class="systemitem">test</code> has
	the desired quota limits, the following command will duplicate
	those quota limits for UIDs 10,000 through 19,999:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>edquota -p test 10000-19999</code></strong></pre><p>For more information, refer to <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90929360"></a>19.13.3. Checking Quota Limits and Disk Usage</h3></div></div></div><a id="idp90930000" class="indexterm"></a><p>Either <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a> or <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=repquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">repquota</span>(8)</span></a> can be used to
	check quota limits and disk usage.  To check individual user
	or group quotas and disk usage, use <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a>.  A user
	may only examine their own quota and the quota of a group they
	are a member of.  Only the superuser may view all user and
	group quotas.  To get a summary of all quotas and disk usage
	for file systems with quotas enabled, use
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=repquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">repquota</span>(8)</span></a>.</p><p>The following is sample output from
	<code class="command">quota -v</code> for a user that has quota limits
	on two file systems.</p><pre class="programlisting">Disk quotas for user test (uid 1002):
     Filesystem  usage    quota   limit   grace   files   quota   limit   grace
           /usr      65*     50      75   5days       7      50      60
       /usr/var       0      50      75               0      50      60</pre><a id="idp90936016" class="indexterm"></a><p>In this example, the user is currently 15 kbytes over the
	soft limit of 50 kbytes on <code class="filename">/usr</code> and has 5
	days of grace period left.  The asterisk <code class="literal">*</code>
	indicates that the user is currently over the quota
	limit.</p><p>Normally, file systems that the user is not using any disk
	space on will not show in the output of <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a>, even if
	the user has a quota limit assigned for that file system.  Use
	<code class="option">-v</code> to display those file systems, such as
	<code class="filename">/usr/var</code> in the above
	example.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90939728"></a>19.13.4. Quotas over NFS</h3></div></div></div><a id="idp90944592" class="indexterm"></a><p>Quotas are enforced by the quota subsystem on the NFS
	server.  The <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rpc.rquotad&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rpc.rquotad</span>(8)</span></a> daemon makes quota
	information available to <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a> on NFS clients,
	allowing users on those machines to see their quota
	statistics.</p><p>Enable <code class="command">rpc.rquotad</code> in
	<code class="filename">/etc/inetd.conf</code> like so:</p><pre class="programlisting">rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad</pre><p>Now restart <code class="command">inetd</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service inetd restart</code></strong></pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="snapshots.html">Προηγ</a> </td><td width="20%" align="center"><a accesskey="u" href="disks.html">Πάνω</a></td><td width="40%" align="right"> <a accesskey="n" href="disks-encrypting.html">Επόμενο</a></td></tr><tr><td width="40%" align="left" valign="top">19.12. File System Snapshots </td><td width="20%" align="center"><a accesskey="h" href="index.html">Αρχή</a></td><td width="40%" align="right" valign="top"> 19.14. Encrypting Disk Partitions</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Αυτό το κείμενο, και άλλα κείμενα, μπορεί να βρεθεί στο
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Για ερωτήσεις σχετικά με το FreeBSD, διαβάστε την
    <a href="http://www.FreeBSD.org/docs.html">τεκμηρίωση</a> πριν να επικοινωνήσετε με την
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Για ερωτήσεις σχετικά με αυτή την τεκμηρίωση, στείλτε e-mail στην
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>