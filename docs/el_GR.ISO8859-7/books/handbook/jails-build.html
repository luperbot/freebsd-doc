<?xml version="1.0" encoding="iso-8859-7" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-7" /><title>16.4. Δημιουργώντας και Ελέγχοντας Jails</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Εγχειρίδιο του FreeBSD" /><link rel="up" href="jails.html" title="Κεφάλαιο 16. Jails" /><link rel="prev" href="jails-intro.html" title="16.3. Εισαγωγή" /><link rel="next" href="jails-tuning.html" title="16.5. Λεπτομερής Ρύθμιση και Διαχείριση" /><link rel="copyright" href="legalnotice.html" title="Νομική Σημείωση" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">16.4. Δημιουργώντας και Ελέγχοντας Jails</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="jails-intro.html">Προηγ</a> </td><th width="60%" align="center">Κεφάλαιο 16. Jails</th><td width="20%" align="right"> <a accesskey="n" href="jails-tuning.html">Επόμενο</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="jails-build"></a>16.4. Δημιουργώντας και Ελέγχοντας Jails</h2></div></div></div><p>Μερικοί διαχειριστές συστημάτων κατηγοριοποιούν τα jails σε δύο
      ενότητες: τα <span class="quote">«<span class="quote">complete (πλήρη)</span>»</span> jails, τα οποία μιμούνται
      ένα πραγματικό σύστημα FreeBSD, και τα <span class="quote">«<span class="quote">service</span>»</span> jails, τα
      οποία χρησιμοποιούνται για μια εφαρμογή ή υπηρεσία, που πιθανόν
      εκτελείται με ειδικά προνόμια.  Αυτός είναι ένας νοητικός διαχωρισμός
      και δεν επιδρά στη διαδικασία δημιουργίας ενός jail.  Η σελίδα manual
      του <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jail</span>(8)</span></a> περιέχει κατατοπιστικές πληροφορίες για τη διαδικασία
      δημιουργίας ενός jail:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>setenv D /here/is/the/jail</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir -p $D</code></strong> <a id="jailpath"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make buildworld</code></strong> <a id="jailbuildworld"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>
<code class="prompt">#</code> <strong class="userinput"><code>make installworld DESTDIR=$D</code></strong> <a id="jailinstallworld"></a><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span>
<code class="prompt">#</code> <strong class="userinput"><code>make distribution DESTDIR=$D</code></strong> <a id="jaildistrib"></a><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span>
<code class="prompt">#</code> <strong class="userinput"><code>mount -t devfs devfs $D/dev</code></strong> <a id="jaildevfs"></a><span><img src="./imagelib/callouts/5.png" alt="5" border="0" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#jailpath"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Ο καλύτερος τρόπος για να ξεκινήσετε είναι με την επιλογή μιας
	  θέσης (διαδρομής) για το jail σας.  Εκεί θα βρίσκονται αποθηκευμένα
	  τα αρχεία του jail όσο αφορά το σύστημα σας.  Μια καλή ιδέα είναι
	  το <code class="filename">/usr/jail/jailname</code>,
	  όπου <em class="replaceable"><code>jailname</code></em> το hostname με το οποίο θα
	  αναγνωρίζεται το jail.  Το σύστημα αρχείων
	  <code class="filename">/usr/</code> έχει συνήθως αρκετό
	  χώρο για το σύστημα αρχείων του jail, το οποίο, για ένα
	  <span class="quote">«<span class="quote">complete</span>»</span> jail είναι ουσιαστικά
	  ένας κλώνος κάθε αρχείου του βασικού συστήματος μια προεπιλεγμένης
	  εγκατάστασης του FreeBSD.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#jailbuildworld"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Το βήμα αυτό δεν απαιτείται αν έχετε μεταγλωττίσει στο παρελθόν
	  το βασικό σύστημα χρησιμοποιώντας την εντολή
	  <code class="command">make world</code> ή
	  <code class="command">make buildworld</code>.  Μπορείτε απλώς να
	  εγκαταστήσετε το υπάρχον σύστημα σας στο νέο jail.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#jailinstallworld"><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Η εντολή αυτή θα εμπλουτίσει τον κατάλογο που επιλέξατε για το
	  jail με όλα τα απαραίτητα αρχεία, βιβλιοθήκες, σελίδες βοήθειας
	  κλπ.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#jaildistrib"><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Το <code class="buildtarget">distribution</code> target του
	  <span class="application">make</span> εγκαθιστά όλα τα αρχεία ρυθμίσεων
	  που απαιτούνται.  Με απλά λόγια, εγκαθιστά κάθε αρχείο από το
	  <code class="filename">/usr/src/etc/</code> στον κατάλογο
	  <code class="filename">/etc</code> του περιβάλλοντος
	  jail: <code class="filename">$D/etc/</code>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#jaildevfs"><span><img src="./imagelib/callouts/5.png" alt="5" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Δε χρειάζεται να προσαρτήσετε το <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">devfs</span>(8)</span></a> στο περιβάλλον
	  του jail.  Από την άλλη όμως, όλες, ή σχεδόν όλες οι εφαρμογές
	  χρειάζονται πρόσβαση σε τουλάχιστον μία συσκευή, αναλόγως με τον
	  σκοπό της εφαρμογής.  Είναι πολύ σημαντικό να ελέγχεται η πρόσβαση
	  στις συσκευές μέσα σε ένα jail, καθώς λανθασμένες ρυθμίσεις
	  μπορεί να επιτρέψουν σε κάποιον εισβολέα να κάνει
	  <span class="quote">«<span class="quote">άσχημα παιχνίδια</span>»</span> μέσα στο jail.
	  Ο έλεγχος του <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">devfs</span>(8)</span></a> γίνεται μέσω ενός συνόλου κανόνων οι
	  οποίοι περιγράφονται στις σελίδες manual του <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">devfs</span>(8)</span></a> και του
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">devfs.conf</span>(5)</span></a>.</p></td></tr></table></div><p>Από την στιγμή που έχει εγκατασταθεί ένα jail, μπορεί να εκκινηθεί
      με τη χρήση της εντολής <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jail</span>(8)</span></a>.  Η <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jail</span>(8)</span></a> δέχεται τέσσερις
      υποχρεωτικές παραμέτρους οι οποίες περιγράφονται στο
      <a class="xref" href="jails-intro.html#jails-what" title="16.3.1. Τι Είναι Ένα Jail">Τμήμα 16.3.1, «Τι Είναι Ένα Jail»</a>.  Μπορείτε να δώσετε και άλλες παραμέτρους,
      π.χ., για να εκτελέσετε μια διεργασία στο περιβάλλον του jail με τις
      άδειες ενός συγκεκριμένου χρήστη.
      Η παράμετρος <code class="option"><em class="replaceable"><code>command</code></em></code>
      εξαρτάται από τον τύπο του jail.  Για ένα
      <span class="emphasis"><em>εικονικό σύστημα</em></span>, το <code class="filename">/etc/rc</code>
      είναι μια καλή επιλογή, μια και στην ουσία θα κλωνοποιήσει
      την διαδικασία εκκίνησης ενός πραγματικού συστήματος FreeBSD.  Για ένα
      <span class="emphasis"><em>service</em></span> jail, η παράμετρος εξαρτάται από την
      υπηρεσία ή την εφαρμογή που θα τρέχει μέσα στο jail.</p><p>Τα jails συνήθως ξεκινούν κατά την εκκίνηση και ο μηχανισμός
      <code class="filename">rc</code> του FreeBSD παρέχει έναν εύκολο τρόπο για να γίνει
      κάτι τέτοιο.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Η λίστα με τα jails που θέλετε να ξεκινάνε κατά την εκκίνηση θα
	  πρέπει να προστεθούν στο αρχείο <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>:</p><pre class="programlisting">jail_enable="YES"   # Set to NO to disable starting of any jails
jail_list="<em class="replaceable"><code>www</code></em>"     # Space separated list of names of jails</pre><div xmlns="" class="note"><h3 class="admontitle">Σημείωση: </h3><p xmlns="http://www.w3.org/1999/xhtml">Το όνομα που έχει κάθε jail στη
	    λίστα <code class="varname">jail_list</code> επιτρέπεται να περιέχει μόνο
	    αλφαριθμητικούς χαρακτήρες.</p></div></li><li class="step"><p>Για κάθε jail που υπάρχει στο <code class="varname">jail_list</code>, θα
	  πρέπει να προστεθεί μια ομάδα από ρυθμίσεις στο <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>, οι
	  οποίες θα το περιγράφουν:</p><pre class="programlisting">jail_<em class="replaceable"><code>www</code></em>_rootdir="/usr/jail/www"     # jail's root directory
jail_<em class="replaceable"><code>www</code></em>_hostname="<em class="replaceable"><code>www</code></em>.example.org"  # jail's hostname
jail_<em class="replaceable"><code>www</code></em>_ip="192.168.0.10"           # jail's IP address
jail_<em class="replaceable"><code>www</code></em>_devfs_enable="YES"          # mount devfs in the jail
jail_<em class="replaceable"><code>www</code></em>_devfs_ruleset="<em class="replaceable"><code>www_ruleset</code></em>" # devfs ruleset to apply to jail</pre><p>Η προεπιλεγμένη εκκίνηση του jail μέσω του
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>, θα ξεκινήσει το script του jail
	  <code class="filename">/etc/rc</code>, το οποίο υποθέτει ότι το jail είναι
	  ένα ολοκληρωμένο εικονικό σύστημα.  Για service jails, η
	  προεπιλεγμένη εκκίνηση πρέπει να αλλάξει, ορίζοντας κατάλληλα την
	  επιλογή <code class="varname">jail_<em class="replaceable"><code>jailname</code></em>_exec_start</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Σημείωση: </h3><p xmlns="http://www.w3.org/1999/xhtml">Για πλήρη λίστα των διαθέσιμων επιλογών, δείτε το
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>.</p></div></li></ol></div><p>Το script <code class="filename">/etc/rc.d/jail</code> μπορεί να
      χρησιμοποιηθεί για να ξεκινήσει ή να σταματήσει κάποιο jail
      χειροκίνητα.  Πρέπει όμως να υπάρχει η αντίστοιχη καταχώρηση στο
      <code class="filename">rc.conf</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/jail start www</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/jail stop www</code></strong></pre><p>Για την ώρα δεν υπάρχει κάποιος απόλυτα σωστός τρόπος για να
      τερματίσετε κάποιο <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jail</span>(8)</span></a>.  Αυτό συμβαίνει, διότι οι εντολές
      που χρησιμοποιούνται συνήθως για να τερματίσουν με ασφάλεια ένα
      σύστημα, δεν μπορούν να χρησιμοποιηθούν μέσα στο περιβάλλον ενός jail.
      Ο καλύτερος τρόπος για να τερματίσετε ένα jail είναι με την εκτέλεση
      της ακόλουθης εντολής μέσα από το ίδιο το jail ή με χρήση του
      βοηθητικού προγράμματος <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jexec&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jexec</span>(8)</span></a> έξω από αυτό:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sh /etc/rc.shutdown</code></strong></pre><p>Περισσότερες πληροφορίες σχετικά με αυτή τη διαδικασία μπορείτε να
      βρείτε στη σελίδα βοηθείας του <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">jail</span>(8)</span></a></p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="jails-intro.html">Προηγ</a> </td><td width="20%" align="center"><a accesskey="u" href="jails.html">Πάνω</a></td><td width="40%" align="right"> <a accesskey="n" href="jails-tuning.html">Επόμενο</a></td></tr><tr><td width="40%" align="left" valign="top">16.3. Εισαγωγή </td><td width="20%" align="center"><a accesskey="h" href="index.html">Αρχή</a></td><td width="40%" align="right" valign="top"> 16.5. Λεπτομερής Ρύθμιση και Διαχείριση</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Αυτό το κείμενο, και άλλα κείμενα, μπορεί να βρεθεί στο
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Για ερωτήσεις σχετικά με το FreeBSD, διαβάστε την
    <a href="http://www.FreeBSD.org/docs.html">τεκμηρίωση</a> πριν να επικοινωνήσετε με την
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Για ερωτήσεις σχετικά με αυτή την τεκμηρίωση, στείλτε e-mail στην
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>