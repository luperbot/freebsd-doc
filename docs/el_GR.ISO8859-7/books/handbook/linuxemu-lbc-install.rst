=================
11.2. ???????????
=================

.. raw:: html

   <div class="navheader">

11.2. ???????????
`????? <linuxemu.html>`__?
???????? 11. ??????????? ?? ?????????? ??? Linux
?\ `??????? <linuxemu-mathematica.html>`__

--------------

.. raw:: html

   </div>

.. raw:: html

   <div class="sect1">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

11.2. ???????????
-----------------

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

? ??????????? ?? ?????????? ??? Linux ??? ????? ?????? ??' ?????. ?
??????????? ?????? ??? ?? ?????????????? ???? ?? ?????????? ????? ??
????????? ?? KLD (???????) ``linux`` (?Kernel LoaDable object?).
???????? ?? ????????? ???? ?? ??????? ???? ?????? ???????? ?? ????????
?????? ?? ``root``:

.. code:: screen

    # kldload linux

?? ?????? ?? ????? ????? ?????????????? ?? ??????????? ?? Linux, ???? ??
????????? ?? ?????????? ?? ???????? ?????? ??? ``/etc/rc.conf``:

.. code:: programlisting

    linux_enable="YES"

? ??????
`kldstat(8) <http://www.FreeBSD.org/cgi/man.cgi?query=kldstat&sektion=8>`__
?????? ?? ?????????????? ??? ?? ???????? ?? ?? KLD ????? ?????????:

.. code:: screen

    % kldstat
    Id Refs Address    Size     Name
     1    2 0xc0100000 16bdb8   kernel
     7    1 0xc24db000 d000     linux.ko

?? ??? ?????? ???? ??? ?????? ? ?? ???????? ?? ????????? ?? KLD, ????
???????? ?? ????????? ??????? ??? ?????????? ??????????? ??? Linux ????
?????? ?? ?? ?? ?????????? ??? ??????? ``options       COMPAT_LINUX``
??? ??????? ????????? ??? ??????. ??? ???????? ???????? ?? ?????????????
??? ??? ?????? ???? ???????????? ??? `?????????9, *??????????? ???
?????? ??? FreeBSD* <kernelconfig.html>`__.

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

11.2.1. ??????????? ??? Linux Runtime Libraries
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

???? ?????? ?? ????? ?? ??? ???????. ???? ?? ?? ????? ???
`linux\_base-fc4 <linuxemu-lbc-install.html#linuxemu-libs-port>`__ port,
? ?? `??????????? <linuxemu-lbc-install.html#linuxemu-libs-manually>`__
??????????? ????.

.. raw:: html

   <div class="sect3">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

11.2.1.1. ??????????? ???? ??? linux\_base Port
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

????? ????? ???? ?????? ???????? ? ??????????? ?????? ??? ???
??????????? ??? runtime libraries. ????? ? ???? ?????????? ????????????
??? ???????????? ??? ??? ??????????? ???? port ??? ?? `??????? ???
Ports <ports.html>`__. ???? ????? ?? ????????:

.. code:: screen

    # cd /usr/ports/emulators/linux_base-f10
    # make install distclean

.. raw:: html

   <div class="note" xmlns="">

????????:
~~~~~~~~~

?? ?????????????? ?????? ?????? ??? FreeBSD ???? ??? 8.0, ?? ?????? ??
????????????? ?? port
`emulators/linux\_base-fc4 <http://www.freebsd.org/cgi/url.cgi?ports/emulators/linux_base-fc4/pkg-descr>`__
???? ??? ??
`emulators/linux\_base-f10 <http://www.freebsd.org/cgi/url.cgi?ports/emulators/linux_base-f10/pkg-descr>`__.

.. raw:: html

   </div>

?? ?????? ???? ?? ????? ???????? ??????????? ?? ?????????? ??? Linux.
?????? ??????????? ?????????????? ??? ?? ??????????? ?????????? (system
libraries) ??? ????? ??? ????????? ???? ??????. ?????? ????, ???? ???
???????? ?????? ????????.

.. raw:: html

   <div class="note" xmlns="">

????????:
~~~~~~~~~

??????? ?? ???????? ????????? ???????? ???
`emulators/linux\_base <http://www.freebsd.org/cgi/url.cgi?ports/emulators/linux_base/pkg-descr>`__,
??? ?? ???????????? ???? ???????????? ???????? ??? ???????? Linux. ??
?????? ?? ?????? ??????????? ??? ports ??? ?????????????? ??? ???
????????? Linux ??? ?????? ?????? ?? ?????????????.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="sect3">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

11.2.1.2. ??????????? ??????????? ??? Libraries
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? ??? ????? ???????????? ??? ??????? ??? ?ports?, ???????? ??
????????????? ??? ??????????? ???????????. ?? ??????????? ?? Linux
shared libraries ?? ????? ??????? ?? ?????????. ??????, ?? ????????? ??
????????????? ??? ???? ???????? ?shadow root?, ``/compat/linux``, ???
??? ??????????? Linux ??? ?? ???????? ??? FreeBSD. ??????????? ??????
??????????? (shared libraries) ?? ?????? ???????????????? ??? ?????????
Linux ??? ??????????? ??? FreeBSD ?? ????????? ????? ?? ????? ???
????????. ????????, ?? ??? ???????? Linux ???????? ??? ?????????? ??
``/lib/libc.so``, ?? FreeBSD ?? ??????????? ?? ???????? ????? ??
``/compat/linux/lib/libc.so``, ??? ?? ???? ??? ???????, ???? ??
??????????? ?? ???????? ?? ``/lib/libc.so``. ?? shared libraries ??
?????? ?? ????????????? ??? shadow tree ``/compat/linux/lib`` ???? ???
??? ?????????? ??? ???????? ?? ``ld.so`` ??? Linux.

??????, ??????????? ???? ?????? ??? ????????????? ????????? Linux, ??
????????? ?? ?????? ??? ??? ?????? ??????????? ??? ?? ??????????
??????????. ???? ??? ?????? ???????? ?? ????? ??? ????????????? ??????
Linux shared libraries ??? ??????? ??? ??? ????? ?? ?? ??????????
???????? ??????? ???? ??? ??? ??????????? ??? ?????????.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect3">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

11.2.1.3. ??????????? ????????? Shared Libraries
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

??? ?? ??????? ??? ????????? ??? ????? ???????????? ?? ``linux_base``
port ??? ?? ????????? ??? ????? ?????????????? ??? shared libraries ???
???????; ??? ???????? ?? ?????? ???? shared libraries ?????????? ??????
????????, ??? ??? ???????? ?? ?? ??????; ??????, ???????? 2 ????????
(??? ?? ???????????? ??? ???????? ??????? ?? ?????? ?? ????? ``root``
??? ??????? ???).

?? ????? ???????? ?? ?????? ???????? Linux, ????? ??? ????? ??? shared
libraries ??? ?????????? ??? ????????, ??? ?????????? ?? ??? FreeBSD.
????? ?? ???????? ??????????:

.. raw:: html

   <div class="informalexample">

?? ?????????? ??? ?????????? ???? FTP ?? ?????????? ??? Doom ??? ??
Linux, ??? ?? ?????? ??? Linux ??????? ??? ????? ????? ????????.
???????? ??? ???????? ?? ???????? ???? shared libraries ?????????? ?
???????? ?? ??? ?????? ``ldd linuxdoom``, ????:

.. code:: screen

    % ldd linuxdoom
    libXt.so.3 (DLL Jump 3.1) => /usr/X11/lib/libXt.so.3.1.0
    libX11.so.3 (DLL Jump 3.1) => /usr/X11/lib/libX11.so.3.1.0
    libc.so.4 (DLL Jump 4.5pl26) => /lib/libc.so.4.6.29

?? ????????? ?? ?????? ??? ?? ?????? ??? ?? ????????? ?????, ??? ?? ??
??????????? ???? ???????? ``/compat/linux``, ??? ?? ????????????? ????
???? ???? ???????????? ??????????? ??????? (symbolic links) ?? ??
??????? ??? ?????? ??????. ???? ???????? ??? ????????, ?? ????? ???? ??
?????? ??? ??????? ???:

.. code:: screen

    /compat/linux/usr/X11/lib/libXt.so.3.1.0
    /compat/linux/usr/X11/lib/libXt.so.3 -> libXt.so.3.1.0
    /compat/linux/usr/X11/lib/libX11.so.3.1.0
    /compat/linux/usr/X11/lib/libX11.so.3 -> libX11.so.3.1.0
    /compat/linux/lib/libc.so.4.6.29
    /compat/linux/lib/libc.so.4 -> libc.so.4.6.29

.. raw:: html

   <div class="blockquote">

    .. raw:: html

       <div class="note" xmlns="">

    ????????:
    ~~~~~~~~~

    ????????? ??? ?? ????? ??? ?????? Linux shared library ??? ? ???????
    ??????? ????? ? ????? ?? ????? ??? ?????? ?????? ??? ``ldd``, ?? ??
    ????????? ?? ??????????? ?? ?????? ???? ???? ?????????? ???
    ????????? ?????, ?? ????????? ?????? ?? ?????? ?? ?????? ?? ???????
    ????. ??? ????????????? ???? ?? ??????????? ?? shared library ??
    ????? ?????? ??????? ??????. ???????? ?? ?????????? ?? ????? ??????,
    ????? ???? ?? ?????????? ???? ??????????? ??????? ???? ?? ???????
    ??? ??? ??????. ????????, ?? ????? ??? ???????? ??????????? ???
    ??????? ???:

    .. code:: screen

        /compat/linux/lib/libc.so.4.6.27
        /compat/linux/lib/libc.so.4 -> libc.so.4.6.27

    ??? ?????? ??? ???????? ? ????? ?????? ??? ??????? ?????? ???? ???
    ``ldd``:

    .. code:: screen

        libc.so.4 (DLL Jump 4.5pl26) -> libc.so.4.6.29

    ?? ? ??????? ??? ??????? ??? ????????? ????? ????? ???? ???? ? ???
    ????????, ???? ??? ??? ????????? ? ????????? ???
    ``/lib/libc.so.4.6.29``, ????? ?? ????????? ?? ?????? ?? ??????
    ???????? ??? ?? ?? ???? ?????????? ??????. ???' ??? ????, ?? ??????,
    ???????? ?? ??????????????? ?? ``libc.so`` ??? ???? ?? ????? ??
    ????????:

    .. code:: screen

        /compat/linux/lib/libc.so.4.6.29
        /compat/linux/lib/libc.so.4 -> libc.so.4.6.29

    .. raw:: html

       </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="blockquote">

    .. raw:: html

       <div class="note" xmlns="">

    ????????:
    ~~~~~~~~~

    ? ?????????? ??? ?????????? ????????? ?????????? *????* ??? ???
    ????????? ??? Linux. ? runtime linker ??? FreeBSD ??????? ????? ???
    ??? ??? ??? ????????? ???????? ??? ??????????? ??? ???? ??
    ?????????? ?? ??? ?????????.

    .. raw:: html

       </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

11.2.2. ??????????? ??? Linux ELF Binaries
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? ELF binaries ??????????? ??????? ????? ??? ????? ????, ?? ?branding?.
?? ???????????? ?? ??????? ??? ?????????? ELF ????? branding, ???? ??
??? ?????????? ?? ???????? ??????:

.. code:: screen

    % ./my-linux-elf-binary
    ELF binary type not known
    Abort

??? ?? ????????? ??? ?????? ??? FreeBSD ?? ????????? ??? ELF ??? FreeBSD
??? ??? ??? Linux, ?????????????? ??? ??????
`brandelf(1) <http://www.FreeBSD.org/cgi/man.cgi?query=brandelf&sektion=1>`__.

.. code:: screen

    % brandelf -t Linux my-linux-elf-binary

To GNU toolchain, ????? ????????? GNU, ????????? ????? ???????? ??
????????? ?????????????? ??? ?????????? ELF, ???????? ?? ???????? ????
?? ?????????? ??? ??? ???????? ??? ??????.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

11.2.3. ??????????? ???? ??????? Linux RPM ?????????
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? FreeBSD ???????? ??? ???? ??? ???? ????????? ??? ?? ??????, ? ?????
??????????????? ??? ??? ?? ports (??? ??? ???? ??? ??????????? ??? ??
Linux(R)). ??? ?? ???? ????, ? ???? ????????? Linux(R) RPM ???
??????????????? (??? ?????????????).

?? ?????? ?????????? ?? ????????????? ??? ??????????? ???????? ???
Linux(R) ??? ????????? ?? ?????? RPM, ???????? ?? ?? ????????? ?? ???
???????? ?????:

.. code:: screen

    # cd /compat/linux
    # rpm2cpio -q < /path/to/linux.archive.rpm | cpio -id

?????????????? ???
`brandelf(1) <http://www.FreeBSD.org/cgi/man.cgi?query=brandelf&sektion=1>`__
??? ?? ???????????? ????????? ?? ?????????? (??? ??? ???????????!) ??
????????? Linux(R). ??? ?? ???????? ?? ??????????????? ??? ????????? ??
?????? ?????, ???? ?? ????????? ?? ?????? ??? ??????? ??? ??????????.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

11.2.4. ??????? ??? Hostname Resolver
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? ?? DNS ?? ???????? ? ?? ??? ??????????? ?? ???????? ??????:

.. code:: screen

    resolv+: "bind" is an invalid keyword resolv+:
    "hosts" is an invalid keyword

?? ????????? ?? ????????? ?? ``/compat/linux/etc/host.conf`` ???? ??
????????:

.. code:: programlisting

    order hosts, bind
    multi on

? ????? ??? ??????? ??? ?????? ????????? ?? ?????? ``/etc/hosts`` ???
??? ???????? ? DNS server. ???? ?? ``/compat/linux/etc/host.conf`` ???
????? ?????????, ?? ????????? Linux ????????????? ?? ``/etc/host.conf``
??? FreeBSD ??? ?????????????? ??? ? ??????? ??? ??????? ??? ?????
?????. ?? ?????? ?? ?????????? ??? ??????? ??? ``bind`` ?? ??? ?????
???????? ??? name server ???? ??? ``/etc/resolv.conf``.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="navfooter">

--------------

+-----------------------------------------------------+----------------------------+----------------------------------------------+
| `????? <linuxemu.html>`__?                          | `???? <linuxemu.html>`__   | ?\ `??????? <linuxemu-mathematica.html>`__   |
+-----------------------------------------------------+----------------------------+----------------------------------------------+
| ???????? 11. ??????????? ?? ?????????? ??? Linux?   | `???? <index.html>`__      | ?11.3. ????????????? ?? Mathematica(R)       |
+-----------------------------------------------------+----------------------------+----------------------------------------------+

.. raw:: html

   </div>

???? ?? ???????, ??? ???? ???????, ?????? ?? ?????? ???
ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/

| ??? ????????? ??????? ?? ?? FreeBSD, ???????? ???
  `?????????? <http://www.FreeBSD.org/docs.html>`__ ???? ??
  ?????????????? ?? ??? <questions@FreeBSD.org\ >.
|  ??? ????????? ??????? ?? ???? ??? ??????????, ??????? e-mail ????
  <doc@FreeBSD.org\ >.
