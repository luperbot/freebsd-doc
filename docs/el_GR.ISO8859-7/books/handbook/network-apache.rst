================================
29.7. ? ???????????? HTTP Apache
================================

.. raw:: html

   <div class="navheader">

29.7. ? ???????????? HTTP Apache
`????? <network-dns.html>`__?
???????? 29. ???????????? ???????
?\ `??????? <network-ftp.html>`__

--------------

.. raw:: html

   </div>

.. raw:: html

   <div class="sect1">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.7. ? ???????????? HTTP Apache
--------------------------------

.. raw:: html

   </div>

.. raw:: html

   <div>

?????????? ??? Murray Stokely ??? ???????? ????????.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.7.1. ??????
~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? FreeBSD ??????????????? ??? ?? ????????? ?????????? ???????????
??????? ???????????????. ?? ???????????? ??????????? web ??? ?????????
????????????? ??? ??????????? HTTP Apache. ?? ?????? ?????????? ???
Apache ?? ?????? ?? ??????????? ??? ???? ?????????????? ??? FreeBSD ???
??????????????. ?? ??? ????????????? ??? Apache ???? ??? ???????? ???
???????????? ??? FreeBSD, ???? ???????? ?? ??? ????????????? ??? ??
??????
`www/apache13 <http://www.freebsd.org/cgi/url.cgi?ports/www/apache13/pkg-descr>`__
? ??? ?? ??????
`www/apache20 <http://www.freebsd.org/cgi/url.cgi?ports/www/apache20/pkg-descr>`__.

???? ???????????? ???????? ??? ??????????? ??? Apache, ?? ?????? ??
?????? ??? ??????????? ?????????.

.. raw:: html

   <div class="note" xmlns="">

????????:
~~~~~~~~~

???? ? ??????? ???????? ??? ?????? ???????????? Apache HTTP 1.3.X, ????
??? ???? ? ?????? ????? ? ??? ??????????? ??? ?? FreeBSD. ? Apache?2.X
??????????? ?????? ???? ??????????? ???? ????? ??? ????????????? ?? ????
??? ???????. ???????????? ??????????? ??? ??? Apache?2.X, ???????? ??
????? ???? ?????? ``http://httpd.apache.org/``.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.7.2. ?????????
~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

??? FreeBSD ?? ????????????? ?????? ????????? ??? ??????????? HTTP
Apache ????? ?? ``/usr/local/etc/apache/httpd.conf``. ????? ??? ??????
UNIX(R) ?????????? ?????? ????????, ?? ??????? ??????? ??? ???????? ??
??? ????????? ``#``. ?????? ??? ??? ??? ????? ??? ???????????? ?????????
???? ??? ??????? ????????, ???????? ?? ???????????? ???? ??? ???
?????????? ???????? ????????? (configuration directives).

.. raw:: html

   <div class="variablelist">

``ServerRoot "/usr/local"``
    ??? ???????????? ? ?????????????? ????????? ????????? ????????????
    ??? ??? Apache. ?? ?????????? ?????? ????? ???????????? ?????
    ????????????? ``bin`` ??? ``sbin`` ??? ????????? ?ServerRoot? ??? ??
    ?????? ????????? ????????????? ???? ???????? ``etc/apache``.

``ServerAdmin you@your.address``
    ? ??????????? ????????? ???? ????? ?? ?????? ?? ?????????????
    ???????? ??????????? ??????? ?? ??? ???????????. ???? ? ?????????
    ??????????? ?? ??????? ??????? ??? ?????????????? ??? ???
    ???????????, ???? ?? ??????? ?????????.

``ServerName www.example.com``
    ?? ``ServerName`` ??? ????????? ?? ?????? ??? ????? ??????
    (hostname) ??? ??? ??????????? ???, ?? ????? ???????????? ???? ?????
    clients ?? ????? ??????????? ??? ?????? ??? ????? ??? ???????? ????
    ????? ??? (??? ????????, ??? ??????????, ?? ??????????????? ``www``
    ???? ??? ??????????? ???????? ??? ??????).

``DocumentRoot "/usr/local/www/data"``
    ``DocumentRoot``: ????? ? ????????? ??? ??? ????? ?? ???????????? ??
    ??????? ???. ?????????????, ??? ?? ???????? ?? ?????????????? ???
    ???? ??? ????????, ???? ??????? ?????? ?? ??????????????? ??????????
    ?????? (symbolic link) ? ????????? (aliases) ??? ?? ????????? ??
    ????? ??????????.

.. raw:: html

   </div>

???? ?????? ??????????? ??????, ????? ???? ?? ???????????? ?????????
????????? (backup) ??? ??????? ????????? ??? Apache. ????? ??????? ???
????? ?????????????? ?? ??? ??????? ????????? ???????? ?? ?????????? ??
??? ???????? ??? Apache.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.7.3. ???????? ??? Apache
~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

O Apache ??? ?????? ???????? ??? ????-?????????? inetd ???? ??????
?????? ????? ????????? ????????????. ????? ??????????? ?? ??????
???????? ??? ?? ?????????? ???????? ??? ???????? HTTP ??? ??????? ???,
?????? ??? ???????????? ????????? (browsers). ? ??????????? ??? Apache
??? ?? FreeBSD Ports ???????? ??? ????????? shell script ??? ???
????????, ?? ????????? ??? ??? ???????????? ??? ???????????. ??? ??
?????????? ??? Apache ??? ????? ????, ???? ??????:

.. code:: screen

    # /usr/local/sbin/apachectl start

???????? ??????????? ?????? ?? ??????????? ??? ???????????,
???????????????:

.. code:: screen

    # /usr/local/sbin/apachectl stop

???? ??? ??????? ??? ??????? ?? ?????? ??? ???????????? ???? ??? ??????
?????????, ?? ????????? ?? ?????????????? ??? ???????????:

.. code:: screen

    # /usr/local/sbin/apachectl restart

??? ?? ?????????????? ??? Apache ????? ?? ????????? ??? ?????????
?????????, ??????:

.. code:: screen

    # /usr/local/sbin/apachectl graceful

???????????? ??????????? ?? ?????? ??? ?????? ???????? ???
`apachectl(8) <http://www.FreeBSD.org/cgi/man.cgi?query=apachectl&sektion=8>`__.

??? ?? ???????? ? Apache ???????? ???? ?? ???????? ????????? ???
??????????, ????????? ??? ???????? ?????? ??? ``/etc/rc.conf``:

.. code:: programlisting

    apache_enable="YES"

?? ?????????? ?? ?????????? ???? ??? ???????? ??? ?????????? ?????????
???????? ???? ?????? ??????? ??? ?? ????????? Apache ``httpd`` ????????
?? ??? ???????? ?? ??? ???????? ?????? ??? ``rc.conf``:

.. code:: programlisting

    apache_flags=""

???? ??? ???? ????????? ? ?????????? web, ???????? ?? ????? ???
?????????? ??? ??????????? ?? ????????? ????????? ???
``http://localhost/``. ? ?????????????? ?????? ??? ??????????? ????? ?
``/usr/local/www/data/index.html``.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.7.4. Virtual Hosting
~~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

? Apache ??????????? ??? ????????????? ?????? Virtual Hosting. ??
?????????? virtual hosting ???????????? ???? HTTP/1.1 headers ??? ??
????????? ??? ?????. ???? ????????? ??? ????? ????? ??? ????? IP ???
????? ??? ??????????? domains.

??? ?? ????????? ??? Apache ?? ???????????? ?? ?????????? Virtual
Hosting ???????? ??? ?????????? ??? ``httpd.conf`` ??? ??? ????????:

.. code:: programlisting

    NameVirtualHost *

?? ? ??????????? web ?????????? ``www.domain.tld`` ??? ?????????? ??
????????????? ??? virtual domain ??? ?? ``www.someotherdomain.tld`` ????
?? ?????? ?? ?????????? ??? ????????? ???????????? ???\ ``httpd.conf``:

.. code:: screen

    <VirtualHost *>
    ServerName www.domain.tld
    DocumentRoot /www/domain.tld
    </VirtualHost>

    <VirtualHost *>
    ServerName www.someotherdomain.tld
    DocumentRoot /www/someotherdomain.tld
    </VirtualHost>

?????????????? ??? ???????? ??????????? ?? ??????? ??? ?????????? ??
??????????????? ??? ??? ????????? ???????? ???? ?? ??????? ???.

??? ???????????? ??????????? ??????? ?? ??? ????????? ??? ?? virtual
host, ??? ??????????? ?? ?????????????? ??? ??????? ?????????? ???
Apache ??? ``http://httpd.apache.org/docs/vhosts/``.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect2">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.7.5. Apache Modules
~~~~~~~~~~~~~~~~~~~~~~

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

???????? ?????? ??? ???????? ?????????? ????? ?????????? (modules) ???
??? Apache, ?? ????? ??????????? ?? ???????????? ??? ??????????? ???
??????? ???????????. ? ??????? ??? Ports ??? FreeBSD ??????? ???? ??????
????? ??? ?? ????????????? ??? Apache ??? ?????? ??? ?? ??? ????????
?????????.

.. raw:: html

   <div class="sect3">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.7.5.1. mod\_ssl
^^^^^^^^^^^^^^^^^^

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? ??????? mod\_ssl ???????????? ??? ?????????? OpenSSL ??? ?? ???????
?????? ????????????? ???????? ??? ?????????? Secure Sockets Layer (SSL
v2/v3) ??? Transport Layer Security (TLS v1). ?? ??????? ??????? ??? ??
?????????? ????????? ??? ?? ?????? ?? ???????? ??????????????
????????????? ??? ????????? ????????????????? ?????? ???????????? ????
???? ?? ???????? ?? ??????? ???? ?????? ??????????? web ??? FreeBSD.

??? ??? ????? ???????????? ????? ??? Apache, ???????? ?? ?????????????
??? ?????? ??? Apache 1.3.X ??? ???????????? ?? mod\_ssl ??? ??? port
`www/apache13-modssl <http://www.freebsd.org/cgi/url.cgi?ports/www/apache13-modssl/pkg-descr>`__
. ?? SSL ????? ?????? ????????? ??? ??? Apache?2.X ???? port
`www/apache20 <http://www.freebsd.org/cgi/url.cgi?ports/www/apache20/pkg-descr>`__,
???? ?? SSL ????? ?????????????? ??? ??????????.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect3">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.7.5.2. ????????? ??????????? ?? Perl & PHP
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

??? ????????? ????????, ?????? ???????????? ???????? ??? ??????????????
???? ???? ?? ???????? ?? ????? ?? ?????????? ?? ????? ???? ??? ???
?????????? ???????. ???? ?? ?? ????? ??? ??????????? ??? ?????? ???
??????????? ??????????? ???????????. ??? ??????? ?????????, ???? ?
Microsoft(R), ??????????? ?????? ????????????? ??? ????????? ????????
????, ? ????????? ???????? ?????????? ????? ?? ??????. ???? ?????????
???????? ??? ???????????? ??????? ????????? ???????????? ???????????????
?? Django, Ruby on Rails, mod\_perl ??? mod\_php. mod\_perl & mod\_php.

.. raw:: html

   <div class="sect4">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.7.5.2.1. mod\_perl
'''''''''''''''''''''

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? ??????? ?????????? Apache/Perl ?????? ????? ?? ?????? ?????? ???
??????? ??????????????? Perl ??? ??? ??????????? HTTP Apache. ?? ??
??????? mod\_perl ????? ?? ?????????? ?? ??????? ?????????? ??? ???
Apache ??' ????????? ?? Perl. ????????, ? ???????????? ??????????????
??? ????? ????????????? ???? ??????????? ??? ????????? ?? ????????? ???
????? ???? ?????????? ????????????? Perl ??? ?? ????????????? ??? ??
????? ????????? ???.

?? mod\_perl ?????????? ?? ????????? ???????. ??? ?? ??????????????? ??
mod\_perl ?? ??????? ??? ?? mod\_perl 1.0 mod\_perl 1.0 ???????? ???? ??
??? Apache 1.3 ??? ?? mod\_perl 2.0 ???????? ???? ?? ??? Apache 2. ??
mod\_perl 1.0 ????? ????????? ??? port
`www/mod\_perl <http://www.freebsd.org/cgi/url.cgi?ports/www/mod_perl/pkg-descr>`__
??? ??? ??????? ??????????????? ?????? ????? ????????? ???
`www/apache13-modperl <http://www.freebsd.org/cgi/url.cgi?ports/www/apache13-modperl/pkg-descr>`__.
?? mod\_perl 2.0 ?????????? ??? port
`www/mod\_perl2 <http://www.freebsd.org/cgi/url.cgi?ports/www/mod_perl2/pkg-descr>`__.

.. raw:: html

   </div>

.. raw:: html

   <div class="sect4">

.. raw:: html

   <div class="titlepage" xmlns="">

.. raw:: html

   <div>

.. raw:: html

   <div>

29.7.5.2.2. mod\_php
''''''''''''''''''''

.. raw:: html

   </div>

.. raw:: html

   <div>

???????? ??? ??? Tom Rhodes.

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

?? PHP, ?????? ??? ?? ?PHP: Hypertext Preprocessor? ????? ??? script
?????? ??????????????? ??????? ?????? ???? ????????? ????????? ???
???????? ?????????? Web. ? ??????? ??? ?????????? ??? ??? C, JavaTM ???
Perl ??? ???? ??? ?????????? ?? ????????????? ?? ?????? HTML, ?? ?????
?? ????????? ????? ??????????????? web ?? ??????? ??????? ?????????
???????????.

? Apache ??????????? ?? PHP5. ???????? ?? ?????????? ????????????? ??
??????
`lang/php5 <http://www.freebsd.org/cgi/url.cgi?ports/lang/php5/pkg-descr>`__.

?? ?? ??????
`lang/php5 <http://www.freebsd.org/cgi/url.cgi?ports/lang/php5/pkg-descr>`__
???????????? ??? ????? ????, ???????? ?? ??? ??????????? ???? ?? ???????
???????? ``OPTIONS``. ?? ?????? ????? ??? ???????????, ?.?. ?????? ??
??????
`lang/php5 <http://www.freebsd.org/cgi/url.cgi?ports/lang/php5/pkg-descr>`__
???? ???????????? ??? ????????, ???????? ????? ?? ????????? ??? ??? ????
?? ??????, ????????? ???? ???????? ??? port:

.. code:: screen

    # make config

???? ???????? ????????????, ???????? ??? ??????? ``APACHE`` ???? ??
????????????? ??? ?? ??????? mod\_php ??? ??? ??????????? Apache.

.. raw:: html

   <div class="note" xmlns="">

????????:
~~~~~~~~~

??????? ?????????? ????????????? ????? ?? PHP4 ??? ????????? ??????
(?.?. ?????? ???????????? ? ?????? ????? ??? ?????????????? ?????????
??? ?? ????????). ?? ????? ?????? ?? ??????????????? ?? mod\_php4 ????
??? mod\_php5, ???? ??????????????? ?? port
`lang/php4 <http://www.freebsd.org/cgi/url.cgi?ports/lang/php4/pkg-descr>`__.
?? port
`lang/php4 <http://www.freebsd.org/cgi/url.cgi?ports/lang/php4/pkg-descr>`__
??????????? ?????? ??? ??? ????????? ??? ??? ???????? ???????????? ???
port
`lang/php5 <http://www.freebsd.org/cgi/url.cgi?ports/lang/php5/pkg-descr>`__.

.. raw:: html

   </div>

?? ???? ??? ????? ?? ????????????? ??? ?? ?????????? ?? ???????????
????????? ???? ?? ???????????? ????????? ????????? PHP. ??? ???????????
??????? ??? ????? ????????? ???? ??????????? ???????? ???
``/usr/local/etc/apache/httpd.conf`` ?? ????????::

.. code:: programlisting

    LoadModule php5_module        libexec/apache/libphp5.so

.. code:: programlisting

    AddModule mod_php5.c
        <IfModule mod_php5.c>
            DirectoryIndex index.php index.html
        </IfModule>
        <IfModule mod_php5.c>
            AddType application/x-httpd-php .php
            AddType application/x-httpd-php-source .phps
        </IfModule>

???? ???????????? ??? ??????, ??? ?? ???????? ?? ??????? PHP ??????????
??? ???? ????? ?? ??? ?????? ``apachectl`` ??? ??? ???????? (graceful)
????????????:

.. code:: screen

    # apachectl graceful

??? ??????????? ???????????? ??? PHP, ??? ?????????? ? ??????
``make config``. ?? ??????????? ``OPTIONS`` ????????????? ???????? ???
?? ????????? ???????????? ??? Ports ??? FreeBSD.

? ??????? ??? PHP ??? FreeBSD, ????? ?????????? ??????????, ??? ?
??????? ?????? ??? ???? ???????????? ????? ???? ?????????????. ?????
???? ?????? ???? ?? ??????????? ?????????? ??????????????? ?? port
`lang/php5-extensions <http://www.freebsd.org/cgi/url.cgi?ports/lang/php5-extensions/pkg-descr>`__.
???? ?? port ??????? ????? ???????? ??? ??? ??????????? ??? ???????????
?????????? ??? PHP. ???????????, ???????? ?? ????????????? ???????
???????? ????????? ??????????????? ?? ????????? port.

??? ??????????, ??? ?? ?????????? ??? PHP5, ?? ?????????? ???????????
??? ?????? ?????????MySQL ???? ???????????? ?? port
`databases/php5-mysql <http://www.freebsd.org/cgi/url.cgi?ports/databases/php5-mysql/pkg-descr>`__.

???? ??? ??????????? ???? ???? ?????????? ? ??????? ????? ?????????, ?
???????????? Apache ?? ?????? ?? ????????????? ??? ?? ?????????????? ??
???? ?????????:

.. code:: screen

    # apachectl graceful

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="navfooter">

--------------

+-----------------------------------+-----------------------------------+--------------------------------------------+
| `????? <network-dns.html>`__?     | `???? <network-servers.html>`__   | ?\ `??????? <network-ftp.html>`__          |
+-----------------------------------+-----------------------------------+--------------------------------------------+
| 29.6. Domain Name System (DNS)?   | `???? <index.html>`__             | ?29.8. ????????? ????????? ??????? (FTP)   |
+-----------------------------------+-----------------------------------+--------------------------------------------+

.. raw:: html

   </div>

???? ?? ???????, ??? ???? ???????, ?????? ?? ?????? ???
ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/

| ??? ????????? ??????? ?? ?? FreeBSD, ???????? ???
  `?????????? <http://www.FreeBSD.org/docs.html>`__ ???? ??
  ?????????????? ?? ??? <questions@FreeBSD.org\ >.
|  ??? ????????? ??????? ?? ???? ??? ??????????, ??????? e-mail ????
  <doc@FreeBSD.org\ >.
