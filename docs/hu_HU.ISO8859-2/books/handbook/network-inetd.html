<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>29.2. Az inetd "szuperszerver"</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="network-servers.html" title="29. fejezet - Hálózati szerverek" /><link rel="prev" href="network-servers.html" title="29. fejezet - Hálózati szerverek" /><link rel="next" href="network-nfs.html" title="29.3. A hálózati állományrendszer (NFS)" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">29.2. Az <span class="application">inetd</span>
      <span class="quote">"<span class="quote">szuperszerver</span>"</span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-servers.html">Vissza</a> </td><th width="60%" align="center">29. fejezet - Hálózati szerverek</th><td width="20%" align="right"> <a accesskey="n" href="network-nfs.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-inetd"></a>29.2. Az <span class="application">inetd</span>
      <span class="quote">"<span class="quote">szuperszerver</span>"</span></h2></div><div><span class="authorgroup">Készítette: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Lee</span>, <span class="firstname">Chern</span></span>. </span></div><div><span class="authorgroup">A FreeBSD 6.1-RELEASE változatához
	    igazította: <span xmlns="http://www.w3.org/1999/xhtml" class="author"></span>. </span></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-overview"></a>29.2.1. Áttekintés</h3></div></div></div><p>Az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> démont gyakran csak <span class="quote">"<span class="quote">internet
	szuperszerverként</span>"</span> nevezik, mivel a helyi
	szolgáltatások kapcsolatainak
	kezeléséért felelõs.  Amikor az
	<span class="application">inetd</span> fogad egy csatlakozási
	kérelmet, akkor eldönti róla, hogy ez melyik
	programhoz tartozik és elindít egy
	példányt belõle, majd átadja neki a
	socketet (az így meghívott program a
	szabvány bemenetéhez, kimenetéhez és
	hibajelzési csatornájához kapja meg a
	socket leíróit).  Az
	<span class="application">inetd</span> használatával
	úgy tudjuk csökkenteni a rendszerünk
	terhelését, hogy a csak alkalmanként
	meghívott szolgáltatásokat nem futtatjuk
	teljesen független önálló
	módban.</p><p>Az <span class="application">inetd</span> démont
	elsõsorban más démonok
	elindítására használjuk, de
	néhány triviális protokollt
	közvetlenül is képes kezelni, mint
	például a <span class="application">chargen</span>,
	<span class="application">auth</span> és a
	<span class="application">daytime</span>.</p><p>Ebben a fejezetben az <span class="application">inetd</span>
	beállításának alapjait foglaljuk
	össze mind parancssoros módban, mind pedig az
	<code class="filename">/etc/inetd.conf</code> konfigurációs
	állományon keresztül.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-settings"></a>29.2.2. Beállítások</h3></div></div></div><p>Az <span class="application">inetd</span>
	mûködése az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a> rendszeren
	keresztül inicializálható.  Az
	<code class="literal">inetd_enable</code> ugyan alapból a
	<code class="literal">NO</code> értéket veszi fel, vagyis
	tiltott, de a <span class="application">sysinstall</span>
	használatával már akár a
	telepítés során bekapcsolható
	attól függõen, hogy a felhasználó
	milyen konfigurációt választott.  Ha
	tehát a:</p><pre class="programlisting">inetd_enable="YES"</pre><p>vagy</p><pre class="programlisting">inetd_enable="NO"</pre><p>sort tesszük az <code class="filename">/etc/rc.conf</code>
	állományba, akkor azzal az
	<span class="application">inetd</span> démont
	indíthatjuk el vagy tilthatjuk le a rendszer
	indítása során.  Az</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/inetd rcvar</code></strong></pre><p>paranccsal lekérdezhetjük a pillanatnyilag
	érvényes beállítást.</p><p>Emellett még az <span class="application">inetd</span>
	démonnak az <code class="literal">inetd_flags</code>
	változón keresztül
	különbözõ parancssori paramétereket
	is át tudunk adni.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-cmdline"></a>29.2.3. Parancssori paraméterek</h3></div></div></div><p>Hasonlóan a legtöbb szerverhez, az
	<span class="application">inetd</span> viselkedését is
	befolyásolni tudjuk a parancssorban
	átadható különbözõ
	paraméterekkel.  Ezek teljes listája a
	következõ:</p><p><code class="command">inetd</code> <code class="option">[-d] [-l] [-w] [-W] [-c
	maximum] [-C arány] [-a cím | név] [-p
	állomány] [-R arány] [-s maximum]
	[konfigurációs
	állomány]</code></p><p>Ezek a paraméterek az
	<code class="filename">/etc/rc.conf</code> állományban az
	<code class="literal">inetd_flags</code> segítségével
	adhatóak meg az <span class="application">inetd</span>
	részére.  Alapértelmezés szerint az
	<code class="literal">inetd_flags</code> értéke <code class="literal">-wW
	-C 60</code>, ami az <span class="application">inetd</span>
	által biztosított szolgáltatások TCP
	protokollon keresztüli wrappelését kapcsolja
	be, illetve egy IP-címrõl nem engedi a
	felkínált szolgáltatások
	elérését percenként hatvannál
	többször.</p><p>A kezdõ felhasználók örömmel
	nyugtázhatják, hogy ezeket az
	alapbeállításokat nem szükséges
	módosítaniuk.  A késõbbiekben majd
	fény derül arra, hogy a kiszolgálás
	gyakoriságának szabályozása remek
	védekezést nyújthat túlzottan nagy
	mennyiségû kapcsolódási kérelem
	ellen.  A megadható paraméterek teljes
	listája az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> man oldalán
	olvasható.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">-c <em class="replaceable"><code>maximum</code></em></span></dt><dd><p>Az egyes szolgáltatásokhoz egyszerre
	      felépíthetõ kapcsolatok
	      alapértelmezett maximális
	      számát adja meg.  Alapból ezt a
	      démont nem korlátozza.  A
	      <code class="option">max-child</code>
	      beállítással ez akár
	      szolgáltatásonként külön is
	      megadható.</p></dd><dt><span class="term">-C <em class="replaceable"><code>arány</code></em></span></dt><dd><p>Korlátozza, hogy egyetlen IP-címrõl
	      alapból hányszor hívhatóak meg
	      az egyes szolgáltatások egy percen
	      belül.  Ez az érték alapból
	      korlátlan.  A
	      <code class="option">max-connections-per-ip-per-minute</code>
	      beállítással ez
	      szolgáltatásonként is
	      definiálható.</p></dd><dt><span class="term">-R <em class="replaceable"><code>arány</code></em></span></dt><dd><p>Megadja, hogy egy szolgáltatást egy perc
	      alatt mennyiszer lehet meghívni.  Ez az
	      érték alapértelmezés szerint
	      256.  A 0 megadásával
	      eltöröljük ezt a típusú
	      korlátozást.</p></dd><dt><span class="term">-s <em class="replaceable"><code>maximum</code></em></span></dt><dd><p>Annak maximumát adja meg, hogy egyetlen
	      IP-címrõl egyszerre az egyes
	      szolgáltatásokat mennyiszer tudjuk
	      elérni.  Alapból ez korlátlan.
	      Szolgáltatásonként ezt a
	      <code class="option">max-child-per-ip</code> paraméterrel
	      tudjuk felülbírálni.</p></dd></dl></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-conf"></a>29.2.4. Az <code class="filename">inetd.conf</code>
	állomány</h3></div></div></div><p>Az <span class="application">inetd</span>
	beállítását az
	<code class="filename">/etc/inetd.conf</code> konfigurációs
	állományon keresztül végezhetjük
	el.</p><p>Amikor az <code class="filename">/etc/inetd.conf</code>
	állományban módosítunk valamit, az
	<span class="application">inetd</span> démont a
	következõ paranccsal meg kell kérnünk,
	hogy olvassa újra:</p><div class="example"><a id="network-inetd-reread"></a><div class="example-title">29.1. példa - Az <span class="application">inetd</span>
	  konfigurációs állományának
	  újraolvasása</div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/inetd reload</code></strong></pre></div></div><br class="example-break" /><p>A konfigurációs állomány minden
	egyes sora egy-egy démont ír le.  A
	megjegyzéseket egy <span class="quote">"<span class="quote">#</span>"</span> jel vezeti be.  Az
	<code class="filename">/etc/inetd.conf</code> állomány
	bejegyzéseinek formátuma az alábbi:</p><pre class="programlisting"><em class="replaceable"><code>szolgáltatás-neve</code></em>
<em class="replaceable"><code>socket-típusa</code></em>
<em class="replaceable"><code>protokoll</code></em>
{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]
<em class="replaceable"><code>felhasználó</code></em>[:<em class="replaceable"><code>csoport</code></em>][/<em class="replaceable"><code>bejelentkezési-osztály</code></em>]
<em class="replaceable"><code>szerver-program</code></em>
<em class="replaceable"><code>szerver-program-paraméterei</code></em></pre><p>Az IPv4 protokollt használó <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ftpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ftpd</span>(8)</span></a>
	démon bejegyzése például így
	néz ki:</p><pre class="programlisting">ftp     stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -l</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term">szolgáltatás-neve</span></dt><dd><p>Ez az adott démon által képviselt
	      szolgáltatást nevezi meg, amelynek
	      szerepelnie kell az <code class="filename">/etc/services</code>
	      állományban.  Ez határozza meg, hogy
	      az <span class="application">inetd</span> milyen porton figyelje
	      a beérkezõ kapcsolatokat.  Ha egy új
	      szolgáltatást hozunk létre, akkor azt
	      elõször az <code class="filename">/etc/services</code>
	      állományba kell felvennünk.</p></dd><dt><span class="term">csatlakozás-típusa</span></dt><dd><p>Ennek az értéke
	      <code class="literal">stream</code>, <code class="literal">dgram</code>,
	      <code class="literal">raw</code>, vagy <code class="literal">seqpacket</code>
	      lehet.  A <code class="literal">stream</code> típust
	      használja a legtöbb kapcsolat-orientált
	      TCP démon, miközben a <code class="literal">dgram</code>
	      típus az <acronym class="acronym">UDP</acronym>
	      szállítási protokollt
	      alkalmazó démonok esetében
	      használatos.</p></dd><dt><span class="term">protokoll</span></dt><dd><p>Valamelyik a következõk
	      közül:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Protokoll</th><th>Magyarázat</th></tr></thead><tbody><tr><td>tcp, tcp4</td><td>TCP IPv4</td></tr><tr><td>udp, udp4</td><td>UDP IPv4</td></tr><tr><td>tcp6</td><td>TCP IPv6</td></tr><tr><td>udp6</td><td>UDP IPv6</td></tr><tr><td>tcp46</td><td>TCP IPv4 és v6</td></tr><tr><td>udp46</td><td>UDP IPv4 és v6</td></tr></tbody></table></div></dd><dt><span class="term">{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]</span></dt><dd><p>A <code class="option">wait|nowait</code>
	      beállítás mondja meg, hogy az
	      <span class="application">inetd</span> démonból
	      meghívott démon saját maga
	      képes-e kezelni kapcsolatokat.  A
	      <code class="option">dgram</code> típusú kapcsolatok
	      esetében egyértelmûen a
	      <code class="option">wait</code> beállítást kell
	      használni, miközben a <code class="option">stream</code>
	      esetén, ahol általában több
	      szálon dolgozunk, a <code class="option">nowait</code>
	      megadása javasolt.  A <code class="option">wait</code>
	      hatására általában egyetlen
	      démonnak adunk át több socketet,
	      míg a <code class="option">nowait</code> minden sockethez egy
	      újabb példányt indít
	      el.</p><p>Az <span class="application">inetd</span> által
	      indítható példányokat a
	      <code class="option">max-child</code> megadásával
	      korlátozhatjuk.  Ha tehát
	      például az adott démon
	      számára legfeljebb példány
	      létrehozását
	      engedélyezzük, akkor a <code class="option">nowait</code>
	      után <code class="literal">/10</code>
	      beállítást kell megadnunk.  A
	      <code class="literal">/0</code> használatával
	      korlátlan mennyiségû
	      példányt
	      engedélyezhetünk.</p><p>A <code class="option">max-child</code> mellett még
	      további két másik
	      beállítás jöhet
	      számításba az egyes démonok
	      által kezelhetõ kapcsolatok maximális
	      számának
	      korlátozásában.  A
	      <code class="option">max-connections-per-ip-per-minute</code> az
	      egyes IP-címekrõl befutó
	      lekezelhetõ kapcsolatok percenkénti
	      számát szabályozza, így
	      például ha itt a tizes értéket
	      adjuk meg, akkor az adott szolgáltatáshoz
	      egy IP-címrõl percenként csak
	      tízszer férhetünk hozzá.  A
	      <code class="option">max-child-per-ip</code> az egyes
	      IP-címekhez egyszerre elindítható
	      példányok számára ír
	      elõ egy korlátot.  Ezek a paraméterek
	      segítenek megóvni rendszerünket az
	      erõforrások akaratos vagy akaratlan
	      kimerítésétõl és a DoS
	      (Denial of Service) típusú
	      támadásoktól.</p><p>Ebben a mezõben a <code class="option">wait</code> vagy
	      <code class="option">nowait</code> valamelyikét
	      kötelezõ megadni.  A <code class="option">max-child</code>,
	      <code class="option">max-connections-per-ip-per-minute</code>
	      és <code class="option">max-child-per-ip</code>
	      paraméterek ellenben elhagyhatóak.</p><p>A <code class="option">stream</code> típusú
	      több szálon futó démonok a
	      <code class="option">max-child</code>,
	      <code class="option">max-connections-per-ip-per-minute</code> vagy
	      <code class="option">max-child-per-ip</code>
	      korlátozása nélkül
	      egyszerûen csak így adhatóak meg:
	      <code class="literal">nowait</code>.</p><p>Ha ugyanezt a démont tíz kapcsolatra
	      lekorlátozzuk, akkor a következõt kell
	      megadnunk: <code class="literal">nowait/10</code>.</p><p>Amikor pedig IP-címenként 20 kapcsolatot
	      engedélyezünk percenként és
	      mindössze 10 példányt, akkor:
	      <code class="literal">nowait/10/20</code>.</p><p>Az iménti beállítások a
	      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fingerd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fingerd</span>(8)</span></a> démon alapértelmezett
	      paramétereinél is
	      megtalálhatóak:</p><pre class="programlisting">finger stream  tcp     nowait/3/10 nobody /usr/libexec/fingerd fingerd -s</pre><p>Végezetül engedélyezzük 100
	      példányt, melyek közül
	      IP-címenként 5 használható:
	      <code class="literal">nowait/100/0/5</code>.</p></dd><dt><span class="term">felhasználó</span></dt><dd><p>Ezzel azt a felhasználót adjuk meg,
	      akinek a nevében az adott démon futni fog.
	      Az esetek túlnyomó részében a
	      démonokat a <code class="systemitem">root</code>
	      felhasználó futtatja.  Láthatjuk
	      azonban, hogy biztonsági okokból bizonyos
	      démonok a <code class="systemitem">daemon</code> vagy a
	      legkevesebb joggal rendelkezõ
	      <code class="systemitem">nobody</code> felhasználóval
	      futnak.</p></dd><dt><span class="term">szerver-program</span></dt><dd><p>A kapcsolat felépülésekor az itt
	      teljes elérési úttal megadott
	      démon indul el.  Ha ezt a
	      szolgáltatást maga az
	      <span class="application">inetd</span> belsõleg
	      valósítja meg, akkor ebben a mezõben az
	      <code class="option">internal</code> értéket adjuk
	      meg.</p></dd><dt><span class="term">szerver-program-paraméterei</span></dt><dd><p>Ez a <code class="option">szerver-program</code>
	      beállítással együtt
	      mûködik, és ebben a mezõben a
	      démon meghívásakor
	      alkalmazandó paramétereket tudjuk
	      rögzíteni, amelyet a démon
	      nevével kezdünk.  Ha a démont a
	      parancssorból a
	      <code class="command">sajátdémon
	      -d</code> paranccsal hívnánk meg, akkor a
	      <code class="literal">sajátdémon
	      -d</code> lesz
	      <code class="option">szerver-program-paraméterei</code>
	      beállítás helyes értéke
	      is.  Természetesen, ha a démon egy
	      belsõleg megvalósított
	      szolgáltatás, akkor ebben a mezõben is
	      az <code class="option">internal</code> fog megjelenni.</p></dd></dl></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-security"></a>29.2.5. Védelem</h3></div></div></div><p>Attól függõen, hogy a
	telepítés során mit választottunk,
	az <span class="application">inetd</span> által
	támogatott szolgáltatások egyes
	része talán alapból engedélyezett
	is.  Amennyiben egy adott démont konkrétan nem
	használunk, akkor érdemes megfontolni a
	letiltását.  A kérdéses démon
	sorába tegyünk egy <span class="quote">"<span class="quote">#</span>"</span> jelet az
	<code class="filename">/etc/inetd.conf</code> állományba,
	majd <a class="link" href="network-inetd.html#network-inetd-reread" title="29.1. példa - Az inetd konfigurációs állományának újraolvasása">olvastassuk
	újra az inetd beállításait</a>.
	Egyes démonok, mint például az
	<span class="application">fingerd</span> használata
	egyáltalán nem ajánlott, mivel a
	támadók számára hasznos
	információkat tudnak
	kiszivárogtatni.</p><p>Más démonok nem ügyelnek a
	védelemre, és a kapcsolatokhoz rendelt
	lejárati idejük túlságosan
	hosszú vagy éppen nincs is.  Ezzel a
	támadónak lehetõsége van lassú
	kapcsolatokkal leterhelni az adott démont, ezáltal
	kimeríteni a rendszer erõforrásait.  Ha
	úgy találjuk, hogy túlságosan sok az
	ilyen kapcsolat, akkor jó ötletnek bizonyulhat a
	démonok számára a
	<code class="option">max-connections-per-ip-per-minute</code>,
	<code class="option">max-child</code> vagy
	<code class="option">max-child-per-ip</code> korlátozások
	elrendelése.</p><p>Alapértelmezés szerint a TCP kapcsolatok
	wrappelése engedélyezett.  A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hosts_access&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">hosts_access</span>(5)</span></a>
	man oldalon találhatjuk meg az
	<span class="application">inetd</span> által
	meghívható különféle
	démonok TCP-alapú korlátozásainak
	lehetõségeit.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-misc"></a>29.2.6. Egyéb lehetõségek</h3></div></div></div><p>A <span class="application">daytime</span>,
	<span class="application">time</span>,
	<span class="application">echo</span>,
	<span class="application">discard</span>,
	<span class="application">chargen</span> és
	<span class="application">auth</span> szolgáltatások
	feladatainak mindegyikét maga az
	<span class="application">inetd</span> is képes
	ellátni.</p><p>Az <span class="application">auth</span>
	szolgáltatás a hálózati
	keresztül azonosítást teszi
	lehetõvé és bizonyos mértékig
	beállítható.  A többit egyszerûen
	csak kapcsoljuk ki vagy be.</p><p>A témában az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> man oldalán
	tudunk még jobban elmerülni.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-servers.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="network-servers.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="network-nfs.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">29. fejezet - Hálózati szerverek </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 29.3. A hálózati állományrendszer
      (NFS)</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>