<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>18.15. Az állományrendszerek kvótái</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="disks.html" title="18. fejezet - Háttértárak" /><link rel="prev" href="snapshots.html" title="18.14. Az állományrendszerek pillanatképei" /><link rel="next" href="disks-encrypting.html" title="18.16. A lemezpartíciók titkosítása" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">18.15. Az állományrendszerek
      kvótái</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="snapshots.html">Vissza</a> </td><th width="60%" align="center">18. fejezet - Háttértárak</th><td width="20%" align="right"> <a accesskey="n" href="disks-encrypting.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="quotas"></a>18.15. Az állományrendszerek
      kvótái</h2></div></div></div><a id="idp90747856" class="indexterm"></a><a id="idp90749008" class="indexterm"></a><p>A kvóták használata az
      operációs rendszerben egy olyan
      választható lehetõség, aminek
      segítségével
      állományrendszerenként korlátozni
      tudjuk az egyes felhasználók vagy csoporttagok
      által elhasznált lemezterület és/vagy
      állományok mennyiségét.  Ezt
      leggyakrabban olyan idõosztásos rendszerekben
      használják ki, ahol szükség lehet az
      egyes felhasználókra vagy csoportokra esõ
      erõforrások mennyiségének
      szabályozására.  Ezzel tudjuk
      megakadályozni, hogy a felhasználók vagy
      csoportok elfogyasszák az összes rendelkezésre
      álló lemezterületet.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90749904"></a>18.15.1. A kvóták használatának
	beállítása</h3></div></div></div><p>Mielõtt nekilátnánk a
	kvóták használatának, meg kell
	gyõzõdnünk róla, hogy a rendszermagunkban
	megvan hozzá a szükséges
	támogatás.  A kvótákat a
	következõ sorral lehet engedélyezni a
	rendszermag beállításait tartalmazó
	állományban:</p><pre class="programlisting">options QUOTA</pre><p>A gyári <code class="filename">GENERIC</code> rendszermag ezt
	alapból nem engedélyezi, ezért ehhez
	mindenképpen be kell állítani, le kell
	fordítani és telepíteni egy kell
	saját rendszermagot.  A saját rendszermag
	létrehozásához kövessük a <a class="xref" href="kernelconfig.html" title="8. fejezet - A FreeBSD rendszermag testreszabása">8. fejezet - <em>A FreeBSD rendszermag testreszabása</em></a> utasításait.</p><p>Ha ezzel megvagyunk, akkor a következõ sorral
	bõvítsük ki az
	<code class="filename">/etc/rc.conf</code>
	állományt:</p><pre class="programlisting">enable_quotas="YES"</pre><a id="idp90757840" class="indexterm"></a><p>A kvótákat kezelõ rendszer
	indításának finomabb
	szabályozására létezik még
	egy további beállítási
	lehetõség is.  A rendszer indítása
	során általában az egyes
	állományrendszerek kvótáját a
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotacheck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotacheck</span>(8)</span></a> program ellenõrzi.  A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotacheck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotacheck</span>(8)</span></a>
	gondoskodik róla, hogy a kvótákat
	tároló adatbázis ténylegesen az
	állományrendszeren található
	adatokat tükrözi.  Ez egy nagyon
	idõigényes folyamat, ami rányomja
	bélyegét a rendszer elindulásához
	szükséges idõ mennyiségére is.
	Amennyiben szeretnénk megtakarítani ezt a
	lépést, tegyük bele az
	<code class="filename">/etc/rc.conf</code> állományba a
	direkt erre a célra kialakított
	beállítást:</p><pre class="programlisting">check_quotas="NO"</pre><p>Végezetül az állományrendszereken
	az <code class="filename">/etc/fstab</code> megfelelõ
	módosításával tudjuk
	egyenként engedélyezni a lemezkvóták
	használatát.  Itt lehet bekapcsolni az
	állományrendszerek felhasználókra
	vagy csoportokra, esetleg mind a kettõjükre
	vonatkozó kvótáikat.</p><p>Ha felhasználói szintû
	kvótákat akarunk engedélyezni egy
	állományrendszeren, akkor az
	<code class="filename">/etc/fstab</code> állományban az
	állományrendszer beállításai
	közé vegyük fel a <code class="option">userquota</code>
	opciót.  Például így:</p><pre class="programlisting">/dev/da1s2g   /home    ufs rw,userquota 1 2</pre><p>Ehhez hasonlóan tudjuk engedélyezni a
	<code class="option">userquota</code> helyett a <code class="option">groupquota</code>
	opció használatával a csoportszintû
	kvótákat is.  A felhasználói-
	és csoportszintû kvóták együttes
	engedélyezéséhez így kell
	átírni az állományrendszer
	bejegyzését:</p><pre class="programlisting">/dev/da1s2g    /home    ufs rw,userquota,groupquota 1 2</pre><p>Alapértelmezés szerint az
	állományrendszerekhez tartozó
	kvóták a gyökerükben
	található <code class="filename">quota.user</code> valamint
	<code class="filename">quota.group</code> állományokban
	tárolódnak.  Errõl részletesebben az
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fstab&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">fstab</span>(5)</span></a> man oldalon olvashatunk.  Noha még az
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fstab&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">fstab</span>(5)</span></a> man oldala szerint is megadható más
	elérési út a kvótákat
	tároló állományokhoz,
	semmiképpen sem javasoljuk ezt, mert úgy
	tûnik, hogy a kvótákat kezelõ
	különbözõ segédprogramok ezzel nem
	képesek rendesen megbirkózni.</p><p>Most kell újraindítani a rendszerünket az
	új rendszermaggal.  Az <code class="filename">/etc/rc</code>
	magától le fogja futtatni a kezdeti
	kvótaállományok
	létrehozásához szükséges
	parancsokat az <code class="filename">/etc/fstab</code>
	állományban megadott
	állományrendszereken.  Ennek megfelelõen
	tehát nem nekünk kell kézzel
	létrehoznunk ezeket az állományokat.</p><p>Hétköznapi esetben egyáltalán nem
	kell manuális futtatnunk a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotacheck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotacheck</span>(8)</span></a>,
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotaon&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotaon</span>(8)</span></a> vagy <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotaoff&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotaoff</span>(8)</span></a> parancsokat.  Habár
	ha tisztában szeretnénk lenni a pontos
	mûködésükkel, akkor mindenképpen
	lapozzuk fel a hozzájuk tartozó man
	oldalakat.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90776656"></a>18.15.2. A kvóták
	beállítása</h3></div></div></div><a id="idp90777296" class="indexterm"></a><p>Ahogy sikerült beállítani a
	kvóták használatát, egybõl
	ellenõrizzük is a
	mûködõképességüket.  Ezt
	legegyszerûbben a következõ paranccsal
	tehetjük meg:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>quota -v</code></strong></pre><p>Itt egy sorban összefoglalva láthatjuk a
	jelenlegi lemezhasználatot és az egyes
	állományrendszereken engedélyezett
	kvóták korlátait.</p><p>Most már készenállunk arra, hogy az
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a> paranccsal végre korlátokat is
	beállítsunk a kvótákhoz.</p><p>Számos beállítás áll
	rendelkezésünkre a felhasználók vagy
	csoportok által lefoglalható lemezterület
	vagy a létrehozható állományok
	számának korlátozását
	illetõen.  A helyfoglalást szabályozhatjuk
	lemezterület alapján (blokk kvóta) vagy az
	állományok száma szerint
	(állományleíró kvóta),
	esetleg a kettõ kombinációjával.  A
	korlátok további két
	kategóriára bonthatóak: erõsre
	és gyengére.</p><a id="idp90781776" class="indexterm"></a><p>Az erõs korlátot (hard limit) nem lehet
	túllépni.  Ahogy a felhasználó
	eléri a számára kiszabott erõs
	korlátot, semmilyen további területet nem
	használhat fel a kérdéses
	állományrendszeren.  Például, ha a
	felhasználónak az állományrendszeren
	500 kilobyte-os erõs korlátot
	állítottunk be, és éppen 490
	kilobyte-nál tart, akkor a felhasználó
	innen már csak 10 kilobyte-nyi helyet foglalhat le.  11
	kilobyte lefoglalása már nem fog sikerrel
	járni.</p><a id="idp90782672" class="indexterm"></a><p>Ezzel szemben a gyenge korlátok (soft limit) egy
	adott ideig átléphetõek.  Ezt az idõt
	türelmi idõnek (grace period) nevezik, ami
	alapértelmezés szerint egy hét.  Ha a
	felhasználó a gyenge korláton felül
	marad a türelmi idõ után is, akkor ezt a gyenge
	korlát erõssé válik és
	semmilyen további helyfoglalásra nem lesz
	lehetõsége.  Amikor a felhasználók
	újra a gyenge korlát alá kerül, a
	türelmi idõ is visszaáll a
	beállított értékére.</p><p>A most következõ példában az
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a> parancsot mutatjuk be.  Amikor meghívjuk
	az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a> parancsot, akkor elindul az
	<code class="envar">EDITOR</code> környezeti változónak
	megfelelõ szövegszerkesztõ, illetve ennek
	hiányában a <span class="application">vi</span>,
	és lehetõségünk nyílik a
	kvóta korlátainak
	módosítására.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>edquota -u teszt</code></strong></pre><pre class="programlisting">Quotas for user <em class="replaceable"><code>teszt</code></em>:
/usr: kbytes in use: 65, limits (soft = 50, hard = 75)
        inodes in use: 7, limits (soft = 50, hard = 60)
/usr/var: kbytes in use: 0, limits (soft = 50, hard = 75)
        inodes in use: 0, limits (soft = 50, hard = 60)</pre><p>Normális esetben minden kvótával
	rendelkezõ állományrendszerhez két
	sort kapunk.  Közülük az egyik sorban szerepelnek
	a blokkok korlátai, a másikban az
	állományleírók korlátai.  Ha
	valamelyiküket meg akarjuk változtatni, akkor
	egyszerûen csak át kell írnunk az adott
	korlát értékét.
	Például növeljük meg a
	felhasználók 50-es gyenge és 75-ös
	erõs blokk korlátját 500-as gyenge és
	600-as erõs korlátra.  Ehhez szerkesszük
	át a</p><pre class="programlisting">/usr: kbytes in use: 65, limits (soft = 50, hard = 75)</pre><p>sort erre:</p><pre class="programlisting">/usr: kbytes in use: 65, limits (soft = 500, hard = 600)</pre><p>Az új korlátok akkor fognak
	érvénybe lépni, miután
	kiléptünk a
	szövegszerkesztõbõl.</p><p>Néha hasznos lehet a korlátokat adott
	felhasználói azonosítókhoz
	beállítani.  Ezt az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a> parancs
	<code class="option">-p</code> paraméterével tudjuk
	elvégezni.  Elõször is állítsuk
	be egy felhasználónak a beállítani
	kívánt korlátokat, majd futtassuk le az
	<code class="command">edquota -p teszt
	kezdõuid-véguid</code>
	parancsot.  Például ha a
	<code class="systemitem">teszt</code> nevû
	felhasználónak állítottuk be a
	számunkra megfelelõ korlátokat, akkor a
	következõ paranccsal lehet a rá
	vonatkozó korlátokat kiterjeszteni a 10 000
	és 19 999 közötti
	azonosítójú
	felhasználókra:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>edquota -p teszt 10000-19999</code></strong></pre><p>Errõl bõvebben az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a> man
	oldalán kaphatunk
	felvilágosítást.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90798800"></a>18.15.3. A kvóták korlátainak és a
	lemezhasználat ellenõrzése</h3></div></div></div><a id="idp90799568" class="indexterm"></a><p>A kvóták korlátait és a lemez
	jelenlegi kihasználtságát a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a>
	vagy <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=repquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">repquota</span>(8)</span></a> parancsokkal is ellenõrizhetjük.
	A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a> parancs segítségével
	ellenõrizhetõ az egyes felhasználók vagy
	csoportok kvótája és
	lemezhasználata.  A felhasználók csak a
	saját adataikhoz férhetnek hozzá, illetve
	mindazon csoportokéhoz, aminek tagjai.  Egyedül a
	rendszeradminisztrátor képes látni az
	összes felhasználó és csoport
	kvótáját.  A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=repquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">repquota</span>(8)</span></a> paranccsal
	kérdezhetõ le az összes kvóta és
	lemezhasználat rövid kimutatása minden olyan
	állományrendszeren, ahol azok
	engedélyezettek.</p><p>A következõ kimenet a <code class="command">quota -v</code>
	parancstól származik, ahol a
	felhasználónak két
	állományrendszeren is vannak
	kvótái:</p><pre class="programlisting">Disk quotas for user <em class="replaceable"><code>teszt</code></em> (uid 1002):
     Filesystem  usage    quota   limit   grace   files   quota   limit   grace
           /usr      65*     50      75   5days       7      50      60
       /usr/var       0      50      75               0      50      60</pre><a id="idp90834512" class="indexterm"></a><p>A fenti példában látható, hogy a
	felhasználó a <code class="filename">/usr</code>
	állományrendszeren pillanatnyilag 15 kilobyte-tal
	van az 50 kilobyte-os gyenge korlátja felett
	és 5 napja van hátra a türelmi
	idõbõl.  Vegyük észre a szám
	mellett levõ csillagot (<code class="literal">*</code>), amivel a
	rendszer jelzi, hogy a felhasználó
	túllépte a korlátját.</p><p>A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a> parancs kimenetében
	általában nem jelennek meg azok az
	állományrendszerek, amelyeken a
	felhasználónak ugyan vannak kvótái,
	de nem foglal rajtuk lemezterületet.  A <code class="option">-v</code>
	beállítás megadásával ezek az
	állományrendszerek is
	láthatóvá válnak, mint ahogy azt a
	fenti példában is megfigyelhettük a
	<code class="filename">/usr/var</code> esetében.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90838224"></a>18.15.4. Kvóták NFS-en keresztül</h3></div></div></div><a id="idp90838864" class="indexterm"></a><p>A kvóták az NFS szerver
	kvótákért felelõs
	alrendszerében is engedélyezhetõek.  Az
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rpc.rquotad&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rpc.rquotad</span>(8)</span></a> démon teszi az NFS klienseken
	futtatott <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a> parancsok számára
	elérhetõvé a kvótákkal
	kapcsolatos információkat, aminek
	köszönhetõen a felhasználók
	távolról is képesek lekérdezni a
	kvótáikat.</p><p>Az <code class="command">rpc.rquotad</code>
	aktivilásához a következõt kell
	beállítani az <code class="filename">/etc/inetd.conf</code>
	állományban:</p><pre class="programlisting">rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad</pre><p>Majd ne felejtsük el újraindítani az
	<code class="command">inetd</code> démont sem:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/inetd restart</code></strong></pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="snapshots.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="disks.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="disks-encrypting.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">18.14. Az állományrendszerek
      pillanatképei </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 18.16. A lemezpartíciók
      titkosítása</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>