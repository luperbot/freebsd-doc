<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>3.8. Démonok, jelzések és a futó programok leállítása</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="basics.html" title="3. fejezet - A UNIX alapjai" /><link rel="prev" href="basics-processes.html" title="3.7. Folyamatok" /><link rel="next" href="shells.html" title="3.9. Parancsértelmezõk" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3.8. Démonok, jelzések és a futó
      programok leállítása</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="basics-processes.html">Vissza</a> </td><th width="60%" align="center">3. fejezet - A UNIX alapjai</th><td width="20%" align="right"> <a accesskey="n" href="shells.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="basics-daemons"></a>3.8. Démonok, jelzések és a futó
      programok leállítása</h2></div></div></div><p>Amikor elindítunk egy szövegszerkesztõt, nem
      sok gondunk akad az irányításával,
      könnyen utasíthatjuk az állományok
      betöltésére és így tovább.
      Mindezt azért tehetjük meg, mert a
      szövegszerkesztõ erre lehetõséget
      biztosít és mivel a szövegszerkesztõ egy
      <em class="firstterm">terminál</em>hoz kapcsolódik.
      Egyes programok azonban nem úgy lettek kialakítva,
      hogy állandóan a felhasználó
      utasításaira támaszkodjanak, ezért az
      elsõ adandó alkalommal lekapcsolódnak a
      terminálról.  Például egy webszerver
      egész nap csak webes kéréseket
      válaszol meg, és általában semmi
      szüksége nincs a felhasználók
      utasításaira.  A szerverek között
      leveleket közvetítõ programok is ugyanezen
      osztályba tartoznak.</p><p>Ezeket a programokat
      <em class="firstterm">démon</em>onoknak hívjuk.  A
      démonok a görög mitológiában
      jelentek meg: sem a jót, sem pedig a gonoszt nem
      képviselték, egyszerû apró
      szellemecskék voltak, akik az emberiség javát
      szolgálták, pontosan úgy, ahogy ma teszik azt
      a különféle web- és levelezõ
      szerverek.  Ezért is ábrázolták
      sokáig a BSD kabalafiguráját is egy
      tornacipõs, vasvillás vidám
      démonként.</p><p>A démonként futó programok nevéhez
      a hagyományok szerint hozzá szokták
      fûzni a <span class="quote">"<span class="quote">d</span>"</span> betût.  A
      <span class="application">BIND</span> a Berkeley Internet Name Domain
      (névfeloldó) szolgáltatása, azonban a
      hozzá tartozó program neve <code class="command">named</code>,
      az <span class="application">Apache</span> webszerver programját
      <code class="command">httpd</code>-nek nevezik, a sornyomtató
      kezeléséért felelõs démon pedig
      az <code class="command">lpd</code> és így tovább.  Ez
      csupán egy hagyomány, megszokás, nem pedig
      egy kõbe vésett szabály: például
      a <span class="application">Sendmail</span> levelezõ
      démonának neve <code class="command">sendmail</code> és
      nem pedig <code class="command">maild</code>.</p><p>Néha azért szükségünk lehet
      arra, hogy felvegyük valahogy a kapcsolatot a
      démonként futó programokkal is.  Ennek egyik
      lehetséges módja a
      <em class="firstterm">jelzés</em>ek (signal)
      küldése (de alapvetõen bármilyen
      futó programnak küldhetünk).  Több
      különféle jelzés küldhetõ
      - egyeseknek közülük
      megkülönböztetett jelentése van,
      másokat magukat az alkalmazások értelmeznek,
      amelyrõl a dokumentációjukban
      tájékozódhatunk.  A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> vagy
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">kill</span>(2)</span></a> paranccsal más tulajdonában levõ
      futó programoknak nem tudunk jelzéseket
      küldeni, ami alól egyedüli kivétel a
      <code class="systemitem">root</code> felhasználó.</p><p>Bizonyos esetekben a FreeBSD maga is küld néha
      jelzéseket.  Amikor egy alkalmazást rosszul
      programoznak le és megpróbál egy
      számára tiltott memóriaterülethez
      hozzáférni, a FreeBSD küld neki egy
      <em class="firstterm">Segmentation Violation</em>
      (<code class="literal">SIGSEGV</code>, szegmentálási hiba)
      jelzést.  Ha egy alkalmazás az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=alarm&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">alarm</span>(3)</span></a>
      rendszerhíváson keresztül kér egy adott
      idõ utáni bekövetkezõ
      értesítést, akkor kap errõl egy Alarm
      (<code class="literal">SIGALRM</code>) jelzést és így
      tovább.</p><p>A folyamatok leállítására
      két jelzés használható: a
      <code class="literal">SIGTERM</code> (befejeztetés) és a
      <code class="literal">SIGKILL</code> (leállítás).  A
      <code class="literal">SIGTERM</code> a folyamatok
      leállításának illedelmes módja,
      mivel ekkor a futó program képes
      <span class="emphasis"><em>elkapni</em></span> ezt a jelzést és
      észrevenni, hogy le akarjuk állítani.
      Ilyenkor a leállítás elõtt
      lehetõsége van szabályosan lezárni a
      naplóit és általánosságban
      véve befejezni mindent, amit éppen csinál.
      Elõfordulhat azonban, hogy a folyamatok figyelmen
      kívül hagyják a <code class="literal">SIGTERM</code>
      jelzést, ha például éppen egy
      félbeszakíthatatlan feladat közepén
      tartanak.</p><p>A <code class="literal">SIGKILL</code> jelzést azonban egyetlen
      futó program sem hagyhatja figyelmen kívül.  Ez
      lenne a <span class="quote">"<span class="quote">Nem érdekel, mivel foglalkozol, azonnal
      hagyd abba!</span>"</span> jelzés.  Amikor
      <code class="literal">SIGKILL</code> jelzést küldünk egy
      folyamatnak, a FreeBSD leállítja a folyamatot ott
      és ahol tart
      <a href="#ftn.idp78237904" class="footnote" id="idp78237904"><sup class="footnote">[4]</sup></a>.</p><p>További használható jelzések:
      <code class="literal">SIGHUP</code>, <code class="literal">SIGUSR1</code> és
      <code class="literal">SIGUSR2</code>.  Ezek általános
      célú jelzések, amelyeket az
      alkalmazások eltérõ módokon
      kezelnek.</p><p>Tegyük fel, hogy megváltoztattuk a
      webszerverünk beállításait
      tartalmazó állományt - valamilyen
      módon szeretnénk tudatni a szerverrel, hogy olvassa
      be újra a beállításait.  Ezt
      megtehetjük úgy, hogy leállítjuk
      és újraindítjuk a <code class="command">httpd</code>
      démont, de ezzel kiesést okozhatunk a szerver
      mûködésében, amit viszont nem
      engedhetünk meg.  A legtöbb démont úgy
      készítették el, hogy a
      <code class="literal">SIGHUP</code> jelzés hatására
      olvassa be újra a beállításait
      tartalmazó állományt.  Így a
      <code class="command">httpd</code> leállítása és
      újraindítása helyett egyszerûen
      elegendõ egy <code class="literal">SIGHUP</code> jelzés
      küldése.  Mivel azonban ez nem
      szabványosított, a különbözõ
      démonok ezt a jelzést
      többféleképpen is értelmezhetik.
      Ezért a használata elõtt ennek
      mindenképpen járjunk utána a
      kérdéses démon
      dokumentációjában.</p><p>A jelzéseket a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> paranccsal tudjuk
      elküldeni, ahogy ezt a következõ
      példában is láthatjuk.</p><div class="procedure"><a id="idp78256208"></a><div class="procedure-title">Eljárás 3.1. Jelzés küldése egy futó
	programnak</div><p>Ebben a példában megmutatjuk, hogyan lehet
	jelzést küldeni az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> démonnak.
	Az <code class="command">inetd</code> a beállításait
	az <code class="filename">/etc/inetd.conf</code>
	állományban tárolja, és az
	<code class="command">inetd</code> a <code class="literal">SIGHUP</code>
	jelzés hatására képes
	újraolvasni ezt.</p><ol class="procedure" type="1"><li class="step"><p>Keressük meg annak a folyamatnak az
	  azonosítóját, amelynek a jelzést
	  kívánjuk küldeni.  Ezt a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ps&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ps</span>(1)</span></a>
	  és a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=grep&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">grep</span>(1)</span></a> használatával
	  tehetjük meg.  A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=grep&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">grep</span>(1)</span></a> parancs
	  segítségével más parancsok
	  kimenetében tudunk megkeresni egy általunk
	  megadott szöveget.  Ezt a parancsot átlagos
	  felhasználóként futtatjuk, azonban az
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> démont a <code class="systemitem">root</code>
	  birtokolja, ezért az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ps&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ps</span>(1)</span></a> használata
	  során meg kell adnunk az <code class="option">ax</code>
	  kapcsolókat is.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ps -ax | grep inetd</code></strong>
  198  ??  IWs    0:00.00 inetd -wW</pre><p>Innen kiderül, hogy az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a>
	  azonosítója 198.  Elõfordulhat, hogy az
	  eredményben maga a <code class="literal">grep inetd</code>
	  parancs is megjelenik.  Ez a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ps&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ps</span>(1)</span></a>
	  listázási módszere miatt következhet
	  be.</p></li><li class="step"><p>A jelzés elküldésére
	  használjuk a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> parancsot.  Mivel az
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> démont a <code class="systemitem">root</code>
	  felhasználó futtatja, ehhez elõször a
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=su&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">su</span>(1)</span></a> parancs kiadásával nekünk is
	  <code class="systemitem">root</code> felhasználóvá
	  (rendszeradminisztrátorrá) kell
	  válnunk.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>su</code></strong>
<code class="prompt">Password:</code>
<code class="prompt">#</code> <strong class="userinput"><code>/bin/kill -s HUP 198</code></strong></pre><p>Ahogy az a legtöbb <span class="trademark">UNIX</span>(R) esetén elfogadott, a
	  sikeres végrehajtás esetén a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a>
	  sem válaszol semmit.  Amikor viszont nem egy
	  saját programunknak akarunk jelzést
	  küldeni, akkor a <span class="errorname">kill:
	  <em class="replaceable"><code>PID</code></em>: Operation not
	  permitted</span> (a mûvelet nem
	  engedélyezett) hibaüzenetet látunk.  Ha
	  véletlenül elgépeltük volna a
	  futó program azonosítóját, akkor a
	  küldendõ jelzés nem a megfelelõ
	  folyamatnál fog kikötni (ami nem éppen
	  jó), vagy ha szerencsénk van, akkor a
	  jelzést egy éppen használaton
	  kívüli azonosítóra
	  küldtük.  Az utóbbi esetben a
	  következõ láthatjuk: <span class="errorname">kill:
	  <em class="replaceable"><code>PID</code></em>: No such process</span>
	  (nincs ilyen folyamat).</p><div xmlns="" class="note"><h3 class="admontitle">Miért <code xmlns="http://www.w3.org/1999/xhtml" class="command">/bin/kill</code>?: </h3><p xmlns="http://www.w3.org/1999/xhtml">A legtöbb parancsértelmezõ
	    beépítetten tartalmazza a saját
	    <code class="command">kill</code> parancsát, tehát
	    ilyenkor közvetlenül maga a
	    parancsértelmezõ küldi a jelzést,
	    nem pedig a <code class="filename">/bin/kill</code> programon
	    keresztül.  Ez gyakran a javunkra válhat,
	    azonban a küldhetõ jelzések megadása
	    parancsértelmezõnként eltérhet.
	    Így, ahelyett, hogy egyenként ismernünk
	    kellene mindegyiket, sokkal egyszerûbb
	    közvetlenül a <code class="command">/bin/kill
	    ...</code> parancsot
	    használni.</p></div></li></ol></div><p>A többi jelzés küldése is nagyon
      hasonló módon történik, hiszen
      elegendõ csupán a <code class="literal">TERM</code> vagy a
      <code class="literal">KILL</code> behelyettesítése a parancs
      megfelelõ helyére.</p><div xmlns="" class="important"><h3 class="admontitle">Fontos: </h3><p xmlns="http://www.w3.org/1999/xhtml">A rendszerünkben óvatosan bánjunk a
	futó programok
	leállítgatásával, és
	legyünk különös tekintettel az 1-es
	azonosítóval rendelkezõ, speciális
	feladattal bíró <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=init&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">init</span>(8)</span></a> folyamatra.  A
	<code class="command">/bin/kill -s KILL 1</code> parancs
	kiadásával ugyanis gyorsan le tudjuk
	állítani a rendszerünket.
	<span class="emphasis"><em>Mielõtt</em></span> egy <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> parancsot
	lezárnánk az <span class="keycap"><strong>Enter</strong></span>
	billentyûvel, <span class="emphasis"><em>mindig</em></span>
	gyõzõdjünk meg róla, hogy valóban
	tényleg a jó paramétereket adtuk
	meg.</p></div><div class="footnotes"><br /><hr class="footnote-hr" /><div id="ftn.idp78237904" class="footnote"><p><a href="#idp78237904" class="para"><sup class="para">[4] </sup></a>Ez azért nem teljesen igaz.  Van
	  néhány olyan tevékenység, ami nem
	  szakítható meg.  Ilyen például az,
	  amikor a program egy másik
	  számítógépen
	  található állományt
	  próbál olvasni, miközben valamilyen ok
	  (kikapcsolás, hálózati hiba)
	  folytán elveszti vele a kapcsolatot.  Ekkor a program
	  futása <span class="quote">"<span class="quote">megszakíthatatlan</span>"</span>.  Majd
	  amikor a program feladja a próbálkozást
	  (általában két perc után), akkor
	  következik be a tényleges
	  leállítása.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="basics-processes.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="basics.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="shells.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">3.7. Folyamatok </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 3.9. Parancsértelmezõk</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>