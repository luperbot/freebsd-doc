<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>19.6. A lemezes eszközök címkézése</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="GEOM.html" title="19. fejezet - GEOM: A moduláris lemezszervezõ rendszer" /><link rel="prev" href="geom-ggate.html" title="19.5. Eszközök hálózati illesztése a GEOM-ban" /><link rel="next" href="geom-gjournal.html" title="19.7. Naplózó UFS GEOM-on keresztül" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">19.6. A lemezes eszközök
      címkézése</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="geom-ggate.html">Vissza</a> </td><th width="60%" align="center">19. fejezet - GEOM: A moduláris lemezszervezõ rendszer</th><td width="20%" align="right"> <a accesskey="n" href="geom-gjournal.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="geom-glabel"></a>19.6. A lemezes eszközök
      címkézése</h2></div></div></div><a id="idp91255376" class="indexterm"></a><a id="idp91255888" class="indexterm"></a><p>A rendszer indítása közben a FreeBSD
      rendszermagja a talált eszközöknek
      megfelelõen mindegyiknek létrehoz egy-egy
      eszközleírót.  Ezzel a
      próbálgatásos módszerrel együtt
      jár néhány gond, például mi
      történik akkor, ha az új lemezes eszközt
      <acronym class="acronym">USB</acronym>-n keresztül adjuk a rendszerhez?
      Nagyon valószínû, hogy ez az eszköz
      megkapja a <code class="filename">da0</code> nevet és ezzel az
      eredeti <code class="filename">da0</code> eszköz eltolódik
      a <code class="filename">da1</code> névhez.  Ennek
      köszönhetõen az <code class="filename">/etc/fstab</code>
      állományban felsorolt
      állományrendszerek csatolása veszélybe
      kerül, aminek következtében akár
      meghiúsulhat a rendszerindulás is.</p><p>Az egyik lehetséges megoldása a
      problémának, ha sorbafûzzük a
      <acronym class="acronym">SCSI</acronym> eszközeinket, és így a
      <acronym class="acronym">SCSI</acronym>-kártyához kapcsolt
      újabb eszköz egy addig nem használt
      számot fog birtokba venni.  Mi helyzet azonban az
      <acronym class="acronym">USB</acronym>-s eszközökkel, amelyek
      kiüthetik az elsõdleges
      <acronym class="acronym">SCSI</acronym>-lemezeinket?  Ez egyébként
      azért történhet meg, mert az
      <acronym class="acronym">USB</acronym>-s eszközöket
      általában hamarabb keresi a rendszer, mint a
      <acronym class="acronym">SCSI</acronym> kártyán levõ
      eszközöket.  Megoldhatjuk úgy ezt a gondot, hogy
      csak azután csatlakoztatjuk az említett
      eszközöket, miután a rendszer elindult.
      Megoldhatjuk viszont úgy is, hogy csak egyetlen
      <acronym class="acronym">ATA</acronym>-meghajtót használunk
      és soha nem soroljuk fel a <acronym class="acronym">SCSI</acronym>
      eszközöket az <code class="filename">/etc/fstab</code>
      állományban.</p><p>Ezeknél kínálkozik azonban egy jobb
      megoldás!  A <code class="command">glabel</code> nevû
      segédprogrammal a rendszergazda vagy a
      felhasználó úgy tudja címkézni
      a lemezmeghajtókat, hogy azok a
      <code class="filename">/etc/fstab</code> állományban
      szereplõ címkéket használják.
      Mivel a <code class="command">glabel</code> a címkét az adott
      szolgáltató utolsó szektorában
      tárolja el, ez a címke megmarad az
      újraindítás után is.  Ha ezt a
      címkét eszközként használjuk, az
      állományrendszerek mindig ugyanarról a
      meghajtóról fognak csatolódni,
      függetlenül attól, hogy milyen
      eszközleírón keresztül érjük
      el ezeket.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Egyáltalán nem állítottuk, hogy
	egy címke csak állandó lehet.  A
	<code class="command">glabel</code> segítségével
	egyaránt létre lehet hozni állandó
	és átmeneti címkéket, de csak az
	állandó címke képes az
	újraindítás után is megmaradni.  A
	két címketípus közti
	különbségeket a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=glabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">glabel</span>(8)</span></a> man oldal
	tárgyalja részletesebben.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91270480"></a>19.6.1. Címketípusok és
	példák</h3></div></div></div><p>A címkéknek két típusa
	létezik, az általános címke
	és az állományrendszer-címke.  A
	címkék lehetnek állandóak vagy
	ideiglenesek.  Az állandó címkék a
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tunefs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">tunefs</span>(8)</span></a> vagy <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> parancsokkal hozhatóak
	létre.  Ezek a címkék az adott
	állományrendszer típusa alapján
	elnevezett alkönyvtárakban jönnek létre
	a <code class="filename">/dev</code>
	könyvtáron belül.  Például az
	<acronym class="acronym">UFS</acronym>2
	állományrendszer-címkék a <code class="filename">/dev/ufs</code> könyvtárban
	keletkeznek.  Állandó címkék a
	<code class="command">glabel label</code> paranccsal hozhatóak
	létre.  Az ilyen címkék nem függenek
	az állományrendszerek
	típusától, a <code class="filename">/dev/label</code> könyvtárban
	jönnek létre.</p><p>Az ideiglenes címkék a következõ
	induláskor elvesznek.  Ezek a címkék a
	<code class="filename">/dev/label</code>
	könyvtárban keletkeznek, és ideálisak
	a kísérletezgetésre.  Ideiglenes
	címkéket a <code class="command">glabel create</code>
	paranccsal hozhatunk létre.  Ezzel kapcsolatosan
	részletesebb felvilágosítást a
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=glabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">glabel</span>(8)</span></a> man oldalon találhatunk.</p><p>Ha egy <acronym class="acronym">UFS</acronym>2
	állományrendszerre szeretnénk tenni egy
	állandó címkét az adataink
	megsemmisítése nélkül, adjuk ki a
	következõ parancsot:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>tunefs -L home /dev/da3</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Figyelem: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ha az érintett állományrendszeren
	  nincs üres hely, ennek a parancsnak a használata
	  adatvesztéshez vezethet.  Ilyen esetben inkább a
	  felesleges állományok
	  eltávolításával kellene
	  törõdnünk, nem pedig címkék
	  hozzáadásával.</p></div><p>Ezután egy címkének kell megjelennie a
	<code class="filename">/dev/ufs</code>
	könyvtárban, amelyet vegyünk is fel az
	<code class="filename">/etc/fstab</code> állományba:</p><pre class="programlisting">/dev/ufs/home		/home            ufs     rw              2      2</pre><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Az állományrendszert tilos csatolni a
	  <code class="command">tunefs</code> futtatása alatt!</p></div><p>Most már a megszokott módon csatolhatjuk az
	állományrendszert:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /home</code></strong></pre><p>Ettõl a ponttól kezdve, amíg a
	<code class="filename">geom_label.ko</code> modul betöltõdik a
	rendszerindítás során a
	<code class="filename">/boot/loader.conf</code> állományon
	keresztül, vagy a <code class="literal">GEOM_LABEL</code>
	opció megtalálható a rendszermag
	konfigurációs állományában,
	az eszközleíró a rendszerre nézve
	minden komolyabb következmény nélkül
	megváltozhat.</p><p>Állományrendszereket létrehozhatunk
	alapértelmezett címkével is a
	<code class="command">newfs</code> <code class="option">-L</code>
	paraméterével.  Errõl részletesebben a
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> man oldalon olvashatunk.</p><p>Az alábbi paranccsal tudjuk törölni a
	címkét:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>glabel destroy home</code></strong></pre><p>A következõ példában azt
	láthatjuk, hogyan címkézzük fel a
	rendszerindító lemezünk
	partícióit.</p><div class="example"><a id="idp91321424"></a><div class="example-title">19.1. példa - Partíciók címkézése a
	  rendszerindító lemezen</div><div class="example-contents"><p>A rendszerindításra használt lemezen
	  levõ partíciók
	  felcímkézésével a rendszer
	  képes lesz akkor is minden probléma
	  nélkül elindulni, amikor áthelyezzük
	  egy másik vezérlõre vagy átrakjuk
	  egy másik számítógépbe.
	  Például most tegyük fel, hogy van egy
	  <acronym class="acronym">ATA</acronym> csatolós lemezünk, amelyet
	  a rendszer <code class="filename">ad0</code> néven ismert
	  fel.  Továbbá azt is feltételezzük,
	  hogy a FreeBSD telepítése esetén megszokott
	  partícionálási sémát
	  választottuk, ahol <code class="filename">/</code>, <code class="filename">/var</code>, <code class="filename">/usr</code> és <code class="filename">/tmp</code>
	  állományrendszereink, valamint egy
	  lapozóterületünk van.</p><p>Indítsuk újra a rendszerünket és
	  a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=loader&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">loader</span>(8)</span></a> menüjében a <span class="keycap"><strong>4</strong></span>
	  billentyû lenyomásával válasszuk az
	  egyfelhasználós módot.  Ezt
	  követõen adjuk ki a következõ
	  parancsokat:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>glabel label rootfs /dev/ad0s1a</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1a is label/rootfs
<code class="prompt">#</code> <strong class="userinput"><code>glabel label var /dev/ad0s1d</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1d is label/var
<code class="prompt">#</code> <strong class="userinput"><code>glabel label usr /dev/ad0s1f</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1f is label/usr
<code class="prompt">#</code> <strong class="userinput"><code>glabel label tmp /dev/ad0s1e</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1e is label/tmp
<code class="prompt">#</code> <strong class="userinput"><code>glabel label swap /dev/ad0s1b</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1b is label/swap
<code class="prompt">#</code> <strong class="userinput"><code>exit</code></strong></pre><p>A rendszer indítása ezután
	  többfelhasználós módban
	  folytatódik.  A rendszerindítás
	  befejezõdése után nyissuk meg az
	  <code class="filename">/etc/fstab</code> állományt
	  és írjuk át a hagyományos
	  eszközneveket a hozzájuk tartozó
	  címkékre.  Az <code class="filename">/etc/fstab</code>
	  végleges változata ennek megfelelõen
	  körülbelül így fog
	  kinézni:</p><pre class="programlisting"># Eszköz                 Csatlakozási pont  Típus   Beállítások     Dump    Menet
/dev/label/swap          none               swap    sw              0        0
/dev/label/rootfs        /                  ufs     rw              1        1
/dev/label/tmp           /tmp               ufs     rw              2        2
/dev/label/usr           /usr               ufs     rw              2        2
/dev/label/var           /var               ufs     rw              2        2</pre><p>A rendszer most már
	  újraindítható.  Ha mindent jól
	  csináltunk, akkor a rendszer indítása
	  problémáktól mentesen fog zajlani
	  és a <code class="command">mount</code> parancs eredménye
	  a következõ lesz:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount</code></strong>
/dev/label/rootfs on / (ufs, local)
devfs on /dev (devfs, local)
/dev/label/tmp on /tmp (ufs, local, soft-updates)
/dev/label/usr on /usr (ufs, local, soft-updates)
/dev/label/var on /var (ufs, local, soft-updates)</pre></div></div><br class="example-break" /><p>A FreeBSD 7.2 kiadásától
	kezdõdõen a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=glabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">glabel</span>(8)</span></a> osztály az
	<acronym class="acronym">UFS</acronym> esetén támogatja az
	<code class="literal">ufsid</code>, az állományrendszer
	egyedi rendszerszintû
	azonosítójából származtatott
	új címketípus használatát.
	Ezek a címkék a rendszer indítása
	során a <code class="filename">/dev/ufsid</code>
	könyvtárban jönnek automatikusan létre.
	Az <code class="literal">ufsid</code> címkéken
	keresztül tudunk az <code class="filename">/etc/fstab</code>
	állományban állományrendszereket
	csatlakoztatni.  A jelenleg aktív
	állományrendszereket és azok
	<code class="literal">ufsid</code> azonosítóit a
	<code class="command">glabel status</code> paranccsal tudjuk
	lekérdezni:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>glabel status</code></strong>
                  Name  Status  Components
ufsid/486b6fc38d330916     N/A  ad4s1d
ufsid/486b6fc16926168e     N/A  ad4s1f</pre><p>Ebben a példában az
	<code class="filename">ad4s1d</code> képviseli a <code class="filename">/var</code>
	állományrendszert, míg a
	<code class="filename">ad4s1f</code> a <code class="filename">/usr</code>
	állományrendszert.  Az adott
	<code class="literal">ufsid</code> értékek
	megadásával az <code class="filename">/etc/fstab</code>
	állományban a következõképpen
	tudjuk csatlakoztatni ezeket az
	állományrendszereket:</p><pre class="programlisting">/dev/ufsid/486b6fc38d330916        /var        ufs        rw        2      2
/dev/ufsid/486b6fc16926168e        /usr        ufs        rw        2      2</pre><p>Minden <code class="literal">ufsid</code> címkével
	rendelkezõ partíció csatlakoztatható
	ezen a módon.  Ekkor nem kell manuálisan
	létrehoznunk a számunkra állandó
	címkéket, így automatikusan
	élvethezhetjük az eszköznévtõl
	független csatlakoztatás elõnyeit.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="geom-ggate.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="GEOM.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="geom-gjournal.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">19.5. Eszközök hálózati illesztése a
      GEOM-ban </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 19.7. Naplózó UFS GEOM-on keresztül</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>