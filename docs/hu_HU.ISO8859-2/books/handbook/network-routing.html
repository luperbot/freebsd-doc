<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>31.2. Átjárók és az útválasztás</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="advanced-networking.html" title="31. fejezet - Egyéb haladó hálózati témák" /><link rel="prev" href="advanced-networking.html" title="31. fejezet - Egyéb haladó hálózati témák" /><link rel="next" href="network-wireless.html" title="31.3. Vezeték nélküli hálózatok" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">31.2. Átjárók és az
      útválasztás</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="advanced-networking.html">Vissza</a> </td><th width="60%" align="center">31. fejezet - Egyéb haladó hálózati
    témák</th><td width="20%" align="right"> <a accesskey="n" href="network-wireless.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-routing"></a>31.2. Átjárók és az
      útválasztás</h2></div><div><span class="authorgroup">Készítette: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Gryphon</span>, <span class="firstname">Coranth</span></span>. </span></div></div></div><a id="idp99437392" class="indexterm"></a><a id="idp99437904" class="indexterm"></a><a id="idp99438416" class="indexterm"></a><p>Egy gép egy másikat úgy tud
      megtalálni a hálózaton, ha erre
      létezik egy olyan mechanizmus, amely leírja, hogyan
      tudunk eljutni az egyiktõl a másikig.  Ezt
      hívjuk
      <em class="firstterm">útválasztásnak</em>
      (routing).  Az <span class="quote">"<span class="quote">útvonal</span>"</span> (route) címek
      egy párjaként adható meg, egy
      <span class="quote">"<span class="quote">céllal</span>"</span> (destination) és egy
      <span class="quote">"<span class="quote">átjáróval</span>"</span> (gateway).  Ez a
      páros mondja meg, hogy ha el akarjuk érni ezt a
      <span class="emphasis"><em>célt</em></span>, akkor ezen az
      <span class="emphasis"><em>átjárón</em></span> keresztül
      kell továbbhaladnunk.  A céloknak három
      típusa lehet: egyéni gépek,
      alhálózatok és az
      <span class="quote">"<span class="quote">alapértelmezett</span>"</span>.  Az
      <span class="quote">"<span class="quote">alapértelmezett útvonalat</span>"</span> (default
      route) abban az esetben alkalmazzuk, ha semelyik más
      útvonal nem megfelelõ.  Az alapértelmezett
      útvonalakról a késõbbiekben még
      beszélni fogunk.  Három típusa van az
      átjáróknak: egyéni gépek,
      felületek (avagy <span class="quote">"<span class="quote">linkek</span>"</span>) és a hardveres
      Ethernet címek (MAC-címek).</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99451216"></a>31.2.1. Példa</h3></div></div></div><p>Az útválasztás
	különbözõ területeit a
	következõ <code class="command">netstat</code> parancs
	alapján fogjuk bemutatni:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>netstat -r</code></strong>
Routing tables

Destination      Gateway            Flags     Refs     Use     Netif Expire

default          outside-gw         UGSc       37      418      ppp0
localhost        localhost          UH          0      181       lo0
test0            0:e0:b5:36:cf:4f   UHLW        5    63288       ed0     77
10.20.30.255     link#1             UHLW        1     2421
example.com      link#1             UC          0        0
host1            0:e0:a8:37:8:1e    UHLW        3     4601       lo0
host2            0:e0:a8:37:8:1e    UHLW        0        5       lo0 =&gt;
host2.example.com link#1             UC          0        0
224              link#1             UC          0        0</pre><a id="idp99453776" class="indexterm"></a><p>Az elsõ két sorban az alapértelmezett
	útvonalat (melyrõl részleteiben majd a <a class="link" href="network-routing.html#network-routing-default" title="31.2.2. Alapértelmezett útvonalak">következõ
	szakaszban</a> fogunk szólni) és a
	<code class="systemitem">localhost</code> útvonalát
	láthatjuk.</p><a id="idp99459792" class="indexterm"></a><p>A <code class="systemitem">localhost</code> címhez az
	útválasztási táblázatban a
	<code class="filename">lo0</code> eszköz tartozik (a
	<code class="literal">Netif</code> oszlopban), amelyet loopback
	eszköznek is neveznek.  Ez arra utasítja a
	rendszert, hogy az ide küldött csomagokat ne a helyi
	hálózaton küldje keresztül, hanem csak
	ezen a belsõ felületen, mivel úgyis oda
	jutnának vissza, ahonnan indultak.</p><a id="idp99461840" class="indexterm"></a><p>A táblázatban a következõ sor egy
	<code class="systemitem">0:e0</code> kezdetû címet
	tartalmaz.  Ez egy hardveres Ethernet cím, más
	néven MAC-cím.  A FreeBSD magától
	képes beazonosítani tetszõleges gépet
	(ebben a példában a <code class="systemitem">test0</code>
	gépet) a helyi Ethernetes hálózaton
	és felvenni hozzá egy útvonalat,
	közvetlenül az <code class="filename">ed0</code> Ethernetes
	csatolófelületen keresztül.  Ehhez a
	típusú útvonalhoz tartozik még egy
	lejárati idõ is (a <code class="literal">Expire</code>
	oszlop), amely akkor kap szerepet, ha ennyi idõ
	elteltével nem kapunk semmilyen hírt a
	géprõl.  Amikor ilyen történik, az
	géphez eddig nyilvántartott útvonal
	automatikusan törlõdik.  Ezek a gépek a RIP
	(útvonal-információs protokoll, Routing
	Information Protocol) nevû mechanizmuson keresztül
	azonosítódnak, mely a legrövidebb út
	kiszámítása alapján határozza
	meg a helyi gépekhez vezetõ útvonalat.</p><a id="idp99465040" class="indexterm"></a><p>A FreeBSD a helyi alhálózat (<code class="systemitem">10.20.30.255</code> és <code class="systemitem">example.com</code>, az
	alhálózathoz tartozó név)
	esetében is felvesz útvonalakat.  A
	<code class="literal">link#1</code> megnevezés a gépben
	található elsõ Ethernet-kártyát
	jelöli.  Megfigyelhetjük, hogy rajta kívül
	nincs is több felülete.</p><p>Mindegyik csoport (a helyi hálózati
	gépek és a helyi alhálózatokatok)
	útvonalait a <span class="application">routed</span> nevû
	démon tartja automatikusan karban.  Ha ez nem fut, akkor
	csak a statikusan definiált (vagyis az elõre
	megadott) útvonalak fognak létezni.</p><p>A <code class="literal">host1</code> sor a saját
	gépünkre vonatkozik, amelyet az Ethernet címe
	szerint ismerünk.  Mivel mi vagyunk küldõ
	gép, a FreeBSD tudni fogja, hogy ilyenkor az Ethernetes
	felület helyett a loopback eszközt
	(<code class="filename">lo0</code>) kell használnia.</p><p>A két <code class="literal">host2</code> sor arra mutat
	példát, amikor az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ifconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ifconfig</span>(8)</span></a> paranccsal
	álneveket hozunk létre (ennek konkrét okait
	lásd az Ethernetrõl szóló
	részben).  A <code class="filename">lo0</code> felület
	neve után szereplõ <code class="literal">=&gt;</code>
	szimbólum azt jelzi, hogy ez nem csak egy loopback
	felület (mivel a címe szintén a helyi
	gépre mutat), hanem a felület egy másik neve.
	Ilyen útvonalak csak az álneveket ismerõ
	gépeknél jelennek meg.  A helyi
	hálózaton minden más gépnél
	egyszerûen csak a <code class="literal">link#1</code> jelenik meg az
	ilyen útvonalak esetében.</p><p>Az utolsó sor (a <code class="systemitem">224</code>
	céllal rendelkezõ alhálózat) a
	multicastre (többesküldésre) szolgál,
	amellyel majd egy másik szakaszban foglalkozunk.</p><p>Végezetül az útvonalakhoz tartozó
	különféle tulajdonságok a
	<code class="literal">Flags</code> oszlopban láthatóak.  Az
	alábbi rövid táblázatban
	összefoglaltunk közülük
	néhányat:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td>U</td><td>Up: az útvonal aktív</td></tr><tr><td>H</td><td>Host: az útvonal egyetlen gépre
		mutat</td></tr><tr><td>G</td><td>Gateway: az adott cél felé ezen a
		gépen keresztül küldjünk, amely
		majd kitalálja, hogy merre küldje
		tovább</td></tr><tr><td>S</td><td>Static: ez az útvonal statikus, nem a
		rendszer hozta létre automatikusan</td></tr><tr><td>C</td><td>Clone: ebbõl az útvonalból
		származtatunk új útvonalat azokhoz
		a gépekhez, amelyekhez csatlakozunk.  Ilyen
		útvonalakat általában a helyi
		hálózatokban találhatunk</td></tr><tr><td>W</td><td>WasCloned: azt jelzi, hogy ezt az útvonalat
		egy helyi hálózatra mutató
		(klón, avagy Clone típusú)
		útvonal alapján hoztuk létre
		automatikusan</td></tr><tr><td>L</td><td>Link: az útvonal Ethernetes hardverhez
		kapcsolódik</td></tr></tbody></table></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-routing-default"></a>31.2.2. Alapértelmezett útvonalak</h3></div></div></div><a id="idp99505744" class="indexterm"></a><p>Amikor a helyi rendszernek fel kell vennie a kapcsolatot egy
	távoli géppel, ellenõrzi az
	útválasztási táblázatban,
	hogy létezik-e már hozzá valamilyen
	útvonal.  Ha a távoli gép egy olyan
	alhálózatba esik, amelyet már el tudunk
	érni (klónozott útvonalak), akkor a
	rendszer megnézi, hogy a hozzá tartozó
	felületen képes-e kapcsolatot
	létesíteni.</p><p>Ha minden ismert útvonal csõdöt mond, akkor
	a rendszerünknek marad még egy utolsó
	esélye: az <span class="quote">"<span class="quote">alapértelmezett</span>"</span>
	útvonal használata.  Ez az útvonal egy
	speciális átjáró útvonal
	(ebbõl általában csak egyetlen egy
	létezik a rendszerben) és tulajdonságai
	között mindig szerepel a <code class="literal">c</code>.  A
	helyi hálózat gépei közül ez az
	átjáró az legyen, amelyik
	közvetlenül kapcsolódik a külsõ
	világhoz (PPP összeköttetéssel, DSL,
	kábelmodem, T1 vagy bármilyen más
	hálózati felületen keresztül).</p><p>Amikor pedig magát a külsõ világ
	felé átjáróként
	szolgáló gépet állítjuk be,
	az alapértelmezett útvonal az
	internet-szolgáltatónk által megadott
	gép címe lesz.</p><p>Vegyünk egy példát az
	alapértelmezett útvonalakra.  Egy tipikus
	konfiguráció:</p><div class="mediaobject"><img src="advanced-networking/net-routing.png" /></div><p>A <code class="systemitem">Helyi1</code> és <code class="systemitem">Helyi2</code>
	gépek a hálózatunk tagjai.  A
	<code class="systemitem">Helyi1</code> az internet-szolgáltatót
	éri el egy betárcsázós PPP
	kapcsolaton keresztül.  A PPP szerver a külsõ
	felületén keresztül a helyi
	hálózaton pedig egy másik
	átjáróhoz csatlakozik.</p><p>Az egyes gépek alapértelmezett
	útvonalai így alakulnak:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Gép</th><th>Alapértelmezett
		átjáró</th><th>Felület</th></tr></thead><tbody><tr><td>Helyi2</td><td>Helyi1</td><td>Ethernet</td></tr><tr><td>Helyi1</td><td>T1-ÁJ</td><td>PPP</td></tr></tbody></table></div><p>Gyakran felmerül a kérdés, hogy
	<span class="quote">"<span class="quote">Miért (és hogy-hogy) a
	<code class="systemitem">T1-ÁJ</code> a <code class="systemitem">Helyi1</code>
	gép számára az alapértelmezett
	átjáró és nem a
	szolgáltató azon szervere, amelyhez
	csatlakozott?</span>"</span></p><p>Ne felejtsük el, hogy a PPP felület a
	szolgáltató helyi hálózatában
	a mi részünkre kap címet, és a itt az
	összes többi géphez tartozó
	útvonal automatikusan létrejön.  Emiatt
	már eleve el tudjuk érni a
	<code class="systemitem">T1-ÁJ</code> gépet, ezért amikor
	a szolgáltatón keresztül küldünk,
	nincs szükségünk egy további
	lépcsõre.</p><p>Általában a <code class="systemitem">X.X.X.1</code> címet szokták a
	helyi hálózat
	átjárójának kiosztani.  Ezért
	(az elõbbi példát
	újrahasznosítva) ha a helyi
	hálózatunkon a C osztályú <code class="systemitem">10.20.30</code> címtartományt
	használjuk, és a szolgáltatónkhoz a
	<code class="systemitem">10.9.9</code> címtartomány
	tartozik, akkor az alapértelmezett útvonalak a
	következõk lesznek:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Gép</th><th>Alapértelmezett útvonal</th></tr></thead><tbody><tr><td>Helyi2 (10.20.30.2)</td><td>Helyi1 (10.20.30.1)</td></tr><tr><td>Helyi1 (10.20.30.1, 10.9.9.30)</td><td>T1-ÁJ (10.9.9.1)</td></tr></tbody></table></div><p>Az <code class="filename">/etc/rc.conf</code>
	állományon keresztül könnyen meg tudjuk
	adni az alapértelmezett útvonalat.  A
	példánkban a <code class="systemitem">Helyi2</code> gép
	<code class="filename">/etc/rc.conf</code>
	állományába kell felvennünk a
	következõ sort:</p><pre class="programlisting">defaultrouter="10.20.30.1"</pre><p>A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=route&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">route</span>(8)</span></a> parancs használatával viszont
	akár közvetlenül is megtehetjük
	mindezt:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>route add default 10.20.30.1</code></strong></pre><p>A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=route&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">route</span>(8)</span></a> man oldalon olvashatunk arról
	bõvebben, hogy a hálózati
	útválasztási táblázatokat
	kézzel hogyan tudjuk módosítani.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-dual-homed-hosts"></a>31.2.3. Kettõs hálózatú
	gépek</h3></div></div></div><a id="idp99555664" class="indexterm"></a><p>Egy másik típusú
	konfigurációról is szót kell
	ejtenünk, ahol a gép egyszerre két
	hálózatnak is tagja.  Gyakorlatilag az
	átjáróként üzemelõ
	számítógépek (mint
	például az, amelyik a fenti példában
	PPP kapcsolattal csatlakozott) ilyen kettõs
	hálózatú gépnek tekinthetõek.
	Ez a kifejezés azonban igazából csak azokra
	az esetekre illik, ahol a gép egyszerre két helyi
	hálózatban is megjelenik.</p><p>Az egyik esetben a gépben két Ethernet
	kártya található, melyek mindegyike
	birtokol egy-egy hálózati címet az egyes
	alhálózatokon.  De elõfordulhat az is, hogy a
	gépünkben csupán egyetlen Ethernet
	kártya van és az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ifconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ifconfig</span>(8)</span></a>
	segítségével álneveket hoztunk
	létre hozzá.  Az elõbbi
	általában két fizikailag
	elkülönölõ Ethernet alapú
	hálózat esetében történik,
	míg az utóbbinál csak egyetlen fizikai
	hálózati szegmensrõl van szó, amely
	viszont logikailag két külön
	alhálózatot tartalmaz.</p><p>Akármelyiket is vesszük, az
	útválasztási táblázatok
	úgy jönnek létre, hogy bennük a
	gép a másik alhálózat felé
	átjáróként (bejövõ
	útvonalként) lesz nyilvántartva.  Ebben a
	konfigurációban a gép a két
	alhálózat között
	útválasztóként fog
	tevékenykedni, és gyakran valamelyik vagy
	éppen mind a két irányba be kell
	állítanunk valamilyen csomagszûrést
	vagy tûzfalazást.</p><p>Ha azt szeretnénk, hogy ez a gép a két
	felület között továbbítson
	csomagokat, akkor a FreeBSD-ben külön engedélyezni
	kell ezt a lehetõséget.  A következõ
	szakaszban ennek részleteit tárjuk fel.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-dedicated-router"></a>31.2.4. Az útválasztók
	beállítása</h3></div></div></div><a id="idp99567696" class="indexterm"></a><p>A hálózati útválasztó nem
	csinál mást, csak továbbküldi az egyik
	felületén beérkezõ csomagokat egy
	másik felületére.  Az internetes
	szabványok és a sokéves mérnöki
	tapasztalat azonban nem engedik, hogy a FreeBSD Projekt
	alapértelmezés szerint is
	elérhetõvé tegye ezt a FreeBSD rendszerekben.
	Ezt a lehetõséget az alábbi
	változó <code class="literal">YES</code>
	értékûre
	állításával lehet
	engedélyezni az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>
	állományban:</p><pre class="programlisting">gateway_enable="YES"          # Ez legyen YES, ha átjáróként akarunk üzemelni</pre><p>Ezzel lényegében a
	<code class="varname">net.inet.ip.forwarding</code> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span></a>
	változó értékét
	állítjuk <code class="literal">1</code>-re.  Ha
	valamiért egy idõre szüneteltetni akarjuk a
	csomagok továbbküldését, akkor
	állítsuk a változó
	értékét <code class="literal">0</code>-ra.</p><a id="idp99572432" class="indexterm"></a><a id="idp99572944" class="indexterm"></a><a id="idp99573456" class="indexterm"></a><p>Az új útválasztónak nem
	árt arról sem tudnia, hogy merre
	továbbítsa a forgalmat.  Ha elég
	egyszerû a hálózatunk, akkor akár
	statikus útvonalakat is használhatunk.  A FreeBSD
	alapból tartalmazza a BSD-k esetén
	szabványos <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=routed&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">routed</span>(8)</span></a> útválasztó
	démont, amely a RIP (v1 és v2) valamint az IRDP
	megoldásokat ismeri.  A BGP v4, OSPF v2 és a
	többi fejlettebb útválasztási
	protokoll a <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/zebra/pkg-descr">net/zebra</a>
	csomagban érhetõ el.  Az ettõl bonyolultabb
	hálózati útválasztási
	feladatokhoz olyan kereskedelmi termékek is
	elérhetõek, mint például a
	<span class="application"><span class="trademark">GateD</span>(R)</span>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-static-routes"></a>31.2.5. Statikus útvonalak
	beállítása</h3></div><div><span class="authorgroup">Írta: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Hoang</span>, <span class="firstname">Al</span></span>. </span></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99583056"></a>31.2.5.1. Manuális konfiguráció</h4></div></div></div><p>Tegyük fel, hogy hálózatunk a
	  következõ:</p><div class="mediaobject"><img src="advanced-networking/static-routes.png" /></div><p>Ebben a forgatókönyvben az
	  <code class="systemitem">A-utvalaszto</code> a mi FreeBSD-s gépünk,
	  amely az internet felé vezetõ
	  útválasztó szerepét
	  játssza.  Számára az
	  alapértelmezett útvonal a <code class="systemitem">10.0.0.1</code>, amelyen keresztül a
	  külsõ világot tudja elérni.
	  Feltételezzük, hogy a
	  <code class="systemitem">B-utvalaszto</code> nevû gépet
	  már eleve jól állítottuk be,
	  ezért tudja merre kell mennie.  (A kép
	  alapján egyszerû: csak vegyünk fel egy
	  alapértelmezett útvonalat a
	  <code class="systemitem">B-utvalaszto</code> géphez, ahol így a
	  <code class="systemitem">192.168.1.1</code> lesz az
	  átjáró.)</p><p>Ha megnézzük most az
	  <code class="systemitem">A-utvalaszto</code>
	  útválasztási
	  táblázatát, akkor nagyjából
	  a következõket fogjuk látni:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>netstat -nr</code></strong>
Routing tables

Internet:
Destination        Gateway            Flags    Refs      Use  Netif  Expire
default            10.0.0.1           UGS         0    49378    xl0
127.0.0.1          127.0.0.1          UH          0        6    lo0
10.0.0/24          link#1             UC          0        0    xl0
192.168.1/24       link#2             UC          0        0    xl1</pre><p>Az <code class="systemitem">A-utvalaszto</code>
	  útválasztási táblázata
	  alapján jelen helyzetben nem lehet elérni a 2.
	  belsõ hálózatot.  Nincs ugyanis olyan
	  útvonal, amely a <code class="systemitem">192.168.2.0/24</code> alhálózat
	  felé vezetne.  Ezt például úgy
	  tudjuk megoldani, ha manuálisan felvesszük ezt az
	  útvonalat.  Az alábbi paranccsal
	  hozzáadjuk a 2.  belsõ hálózat
	  elérését az <code class="systemitem">A-utvalaszto</code>
	  útválasztási
	  táblázatához, ahol a <code class="systemitem">192.168.1.2</code> lesz a következõ
	  ugrási pont (next hop):</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>route add -net 192.168.2.0/24 192.168.1.2</code></strong></pre><p>Most már az <code class="systemitem">A-utvalaszto</code>
	  bármelyik gépet képes elérni a
	  <code class="systemitem">192.168.2.0/24</code>
	  hálózaton.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp99595216"></a>31.2.5.2. Rögzített konfiguráció</h4></div></div></div><p>A fenti példa tökéletesen
	  szemlélti a statikus útvonalak
	  felvételét egy mûködõ rendszeren.
	  Azonban ezzel az a gond, hogy az így megadott
	  útválasztási információ nem
	  marad meg a gép újraindítása
	  után.  Ezért az elõbbihez hasonló
	  statikus útvonalakat inkább az
	  <code class="filename">/etc/rc.conf</code> állományban
	  rögzítsük:</p><pre class="programlisting"># A 2. belsõ hálózat elérését felvesszük statikus útvonalként
static_routes="belsohalo2"
route_belsohalo2="-net 192.168.2.0/24 192.168.1.2"</pre><p>A <code class="literal">static_routes</code>
	  konfigurációs változó
	  karakterláncok szóközzel tagolt
	  felsorolását tartalmazza.  Mindegyik
	  karakterlánc egy útvonal neve.  Az iménti
	  példában csak egyetlen ilyen név
	  szerepelt a <code class="literal">static_routes</code>
	  értékében, amely a
	  <em class="replaceable"><code>belsohalo2</code></em> volt.  Utána
	  beírtunk még egy konfigurációs
	  változót is, amelynek a neve
	  <code class="literal">route_belsohalo2</code>.
	  Ide helyeztük a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=route&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">route</span>(8)</span></a> parancsnak
	  átadandó beállítás
	  összes paraméterét.  Ez pontosan olyan,
	  mintha a következõ parancsot adtuk volna ki:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>route add -net 192.168.2.0/24 192.168.1.2</code></strong></pre><p>Ezért kellett a <code class="literal">"-net 192.168.2.0/24
	  192.168.1.2"</code>.</p><p>Ahogy már korábban is
	  említettük, a <code class="literal">static_routes</code>
	  értékében több karakterláncot
	  is megadhatunk, aminek segítségével
	  egyszerre több statikus útvonalat is
	  létrehozhatunk.  A következõ sorok arra
	  mutatnak példát, hogy a <code class="systemitem">192.168.0.0/24</code> és <code class="systemitem">192.168.1.0/24</code> hálózatok
	  számára miként állítsunk be
	  statikus útvonalakat a képzeletbeli
	  útválasztónkon:</p><pre class="programlisting">static_routes="net1 net2"
route_net1="-net 192.168.0.0/24 192.168.0.1"
route_net2="-net 192.168.1.0/24 192.168.1.1"</pre></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-routing-propagation"></a>31.2.6. Az útvonalak terjedése</h3></div></div></div><a id="idp99613008" class="indexterm"></a><p>Azt már tudjuk, hogyan adjuk meg a
	külvilág felé vezetõ útvonalakat,
	azonban arról még nem beszéltünk, hogy
	kívülrõl miként találnak meg
	bennünket.</p><p>Annyit már megismertünk, hogy az
	útválasztási táblázatokban
	megadhatjuk a hálózaton azt a gépet,
	amelyen keresztül az adott címtartomány (a
	példában egy C osztályú
	alhálózat) felé küldhetünk, amely
	pedig továbbküldi a hozzá érkezõ
	csomagokat.</p><p>Amikor a csatlakozunk az
	internet-szolgáltatónkhoz, a nála levõ
	útválasztási táblázatok
	úgy állítódnak be, hogy az
	alhálózatunk felé igyekvõ adatok a
	korábban létrejött PPP
	összeköttetésen keresztül jutnak el
	hozzánk.  A világ többi részén
	levõ rendszerek viszont honnan fogják tudni, hogy a
	mi internet-szolgáltatónknak
	küldjenek?</p><p>Van egy rendszer (ez leginkább a névszerverek
	elosztott információs adatbázisához
	hasonlít), ami nyilvántartja a pillanatnyilag
	kiosztott címtartományokat és megadja a
	csatlakozási pontjukat az internet
	gerinchálózatán.  Ez a
	<span class="quote">"<span class="quote">gerinc</span>"</span> tulajdonképpen olyan
	fõvonalakból áll, amelyen keresztül a
	világban az országok között mozog az
	internet forgalma.  A gerinchálózat mindegyik
	gépe tárolja a központi
	útválasztási táblázatok egy
	másolatát, ami a forgalmat egy adott
	hálózatról a megadott gerincbeli
	hordozóra irányítja át, végig
	az internet-szolgáltatók láncán
	egészen addig, amíg az el nem éri a
	hálózatunkat.</p><p>A szolgáltatónk feladata, hogy a
	gépünk felé leágazásként
	(és így a felénk vezetõ
	útként) beregisztálja magát a
	gerinchálózat gépein.  Ezt nevezik az
	útvonal terjedésének.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-routing-troubleshooting"></a>31.2.7. Hibaelhárítás</h3></div></div></div><a id="idp99616720" class="indexterm"></a><p>Néha gondok lehetnek az útvonal
	terjedésével, és egyes gépek nem
	képesek elérni minket.  A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=traceroute&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">traceroute</span>(8)</span></a>
	parancs mind közül talán az egyik leghasznosabb
	ilyen helyzetekben, mivel ezzel fel tudjuk deríteni, hogy
	az útválasztás hol akad meg.  Ugyanilyen
	jól hasznosítható azokban az esetekben,
	amikor látszólag nem tudunk elérni egy
	távoli gépet (tehát a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ping&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ping</span>(8)</span></a>
	csõdöt mond).</p><p>A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=traceroute&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">traceroute</span>(8)</span></a> parancsnak annak a távoli
	gépnek a nevét kell megadnunk, amelyhez
	csatlakozni akarunk.  Futása közben
	megjeleníti azokat az átjárókat,
	amelyeken keresztül csatlakozni próbál,
	akár sikerült elérni a
	célgépet, akár a kapcsolat hiánya
	miatt kudarcot vall.</p><p>A parancs használatáról és
	mûködésérõl részletesebb
	információkat a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=traceroute&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">traceroute</span>(8)</span></a> man
	oldalán találunk.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-routing-multicast"></a>31.2.8. Útválasztás multicast
	esetén</h3></div></div></div><a id="idp99626704" class="indexterm"></a><a id="idp99627472" class="indexterm"></a><p>A FreeBSD alapból támogatja mind a multicastet
	használó alkalmazásokat, mind pedig a
	multicasthez tartozó útválasztást.
	Multicast esetében semmilyen speciális
	beállítás nem szükségeltetik,
	az ilyen alkalmazások egybõl el tudják
	érni ezt a lehetõséget.  A multicast
	kérések
	útválasztásához azonban be kell
	építenünk némi
	támogatást a rendszermagba:</p><pre class="programlisting">options MROUTING</pre><p>Emellett még el kell indítanunk az
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mrouted&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mrouted</span>(8)</span></a> démont is, amelyhez az
	<code class="filename">/etc/mrouted.conf</code> állományban
	még be kell állítanunk tunneleket és
	a <acronym class="acronym">DVMRP</acronym> használatát.  A
	multicasthez tartozó további
	beállításokat az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mrouted&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mrouted</span>(8)</span></a> man
	oldalán találhatjuk.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">A FreeBSD 7.0 megjelenésével a
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mrouted&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mrouted</span>(8)</span></a> démont kivették az
	  alaprendszerbõl.  Azt a <acronym class="acronym">DVMRP</acronym>
	  többesküldési protokollt
	  valósítja meg, amelyet a legtöbb
	  alkalmazásban mostanság már a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pim&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pim</span>(4)</span></a>
	  segítségével oldanak meg.  Ennek
	  megfelelõen a hozzá tartozó
	  multicast protokollt valósítja meg, amelyet a
	  legtöbb alkalmazásban mostanság már
	  a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pim&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">pim</span>(4)</span></a> segítségével oldanak meg.
	  Ennek megfelelõen a hozzá tartozó
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=map-mbone&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">map-mbone</span>(8)</span></a> és <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mrinfo&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mrinfo</span>(8)</span></a>
	  segédprogramok is eltávolításra
	  kerültek.  Ezek a programok attól a
	  kiadástól kezdõdõen a
	  Portgyûjtemény részeként
	  érhetõek el a <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/mrouted/pkg-descr">net/mrouted</a> portban.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="advanced-networking.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="advanced-networking.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="network-wireless.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">31. fejezet - Egyéb haladó hálózati
    témák </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 31.3. Vezeték nélküli
      hálózatok</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>