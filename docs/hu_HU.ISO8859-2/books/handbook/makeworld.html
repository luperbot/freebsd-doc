<?xml version="1.0" encoding="iso-8859-2" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" /><title>24.7. Az alaprendszer újrafordítása</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD kézikönyv" /><link rel="up" href="updating-upgrading.html" title="24. fejezet - A FreeBSD frissítése és frissen tartása" /><link rel="prev" href="synching.html" title="24.6. A forrás szinkronizálása" /><link rel="next" href="small-lan.html" title="24.8. A források követése több géppel" /><link rel="copyright" href="legalnotice.html" title="Jogi közlemény" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">24.7. Az alaprendszer újrafordítása</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="synching.html">Vissza</a> </td><th width="60%" align="center">24. fejezet - A FreeBSD frissítése és frissen
    tartása</th><td width="20%" align="right"> <a accesskey="n" href="small-lan.html">Elõre</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makeworld"></a>24.7. Az alaprendszer újrafordítása</h2></div></div></div><a id="idp93288784" class="indexterm"></a><p>Miután sikerült a helyi forrásfánkat
      a FreeBSD egy nekünk szimpatikus (FreeBSD-STABLE, FreeBSD-CURRENT
      és így tovább) változatához
      igazítanunk, elérkezett az idõ, hogy a
      segítségével újrafordítsuk az
      egész rendszert.</p><div xmlns="" class="warning"><h3 class="admontitle">Készítsünk biztonsági
	mentést: </h3><p xmlns="http://www.w3.org/1999/xhtml">Nem tudjuk eléggé
	nyomatékosítani, hogy
	<span class="emphasis"><em>mielõtt</em></span> nekikezdenénk,
	készítsünk egy biztonsági
	mentést a rendszerünkrõl.  Míg az
	alaprendszer újrafordítása nem
	túlságosan bonyolult feladat (egészen
	addig, amíg a megadott utasításokat
	követjük), saját magunk vagy mások
	hibájából fakadóan kialakulhatnak
	olyan helyzetek, amikor a rendszer nem lesz képes
	elindulni.</p><p xmlns="http://www.w3.org/1999/xhtml">Mindenképpen gyõzödjünk meg
	róla, hogy tisztességesen elvégeztük a
	mentést és akad a kezünk ügyében
	egy javításra felhasználható
	rendszerindító floppy vagy CD.
	Valószínûleg soha nem lesz ténylegesen
	szükségünk rájuk, azonban jobb
	félni, mint megijedni!</p></div><div xmlns="" class="warning"><h3 class="admontitle">Iratkozzunk fel a megfelelõ levelezési
	listákra: </h3><a xmlns="http://www.w3.org/1999/xhtml" id="idp93292240" class="indexterm"></a><p xmlns="http://www.w3.org/1999/xhtml">A FreeBSD-STABLE és FreeBSD-CURRENT ágak
	természetüknél fogva
	<span class="emphasis"><em>fejlesztés alatt állnak</em></span>.  A
	FreeBSD fejlesztését is emberek végzik,
	ezért elõfordulhatnak benne
	tévedések.</p><p xmlns="http://www.w3.org/1999/xhtml">Ezek a tévedések gyakran csak
	ártalmatlan apróságok, amelyek
	hatására kapunk például egy
	ismeretlen diagnosztikai hibát.  De ezzel szemben
	létrejöhetnek pusztító erejû
	hibák is, amelyek hatására a
	rendszerünk nem lesz képes elindulni,
	károsodnak az állományrendszerek (vagy
	még rosszabb).</p><p xmlns="http://www.w3.org/1999/xhtml">Ha ilyen történik, akkor egy
	<span class="quote">"<span class="quote">felszólítást</span>"</span> (egy
	<span class="quote">"<span class="quote">heads up</span>"</span> témájú
	üzenetet) küldenek az érintett
	változatokhoz tartozó listákra, amelyben
	igyekeznek kifejteni a probléma természetét
	és a rendszerre mért hatását.
	Miután <span class="quote">"<span class="quote">minden rendbejött</span>"</span>, a
	probléma megoldásáról is
	küldenek egy értesítést.</p><p xmlns="http://www.w3.org/1999/xhtml">Ha a <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-stable" target="_top">FreeBSD-STABLE levelezési lista</a> vagy a <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-current" target="_top">FreeBSD-CURRENT levelezési lista</a> olvasása
	nélkül próbáljuk meg használni
	a FreeBSD-STABLE és FreeBSD-CURRENT verziókat, akkor
	csak magunknak keressük a bajt.</p></div><div xmlns="" class="warning"><h3 class="admontitle">Ne használjuk a <code xmlns="http://www.w3.org/1999/xhtml" class="command">make world</code>
	parancsot: </h3><p xmlns="http://www.w3.org/1999/xhtml">Rengeteg régebben készült
	dokumentáció erre a feladatra a <code class="command">make
	world</code> parancs kiadását javasolja.  Ennek
	használatával azonban átlépünk
	olyan fontos lépéseket, amelyek
	valójában csak akkor lennének
	kihagyhatóak, ha pontosan tudjuk mit csinálunk.
	Ezért az esetek döntõ
	többségében nem a <code class="command">make
	world</code> használatára van
	szükségünk, hanem a most bemutatandó
	eljárásra.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="canonical-build"></a>24.7.1. A rendszer frissítése
	dióhéjban</h3></div></div></div><p>A frissítés megkezdése elõtt
	érdemes elolvasnunk a
	<code class="filename">/usr/src/UPDATING</code> állományt,
	ahol a letöltött források
	használatához elvégzendõ elõzetes
	intézkedésekrõl kaphatunk hírt.
	Ezután kövessük az alábbiakban
	körvonalazott módszer egyes
	lépéseit.</p><p>Ezek a lépések feltételezik, hogy egy
	korábbi FreeBSD verziót használunk, tehát
	a fordító, a rendszermag, az alaprendszer
	és a konfigurációs állományok
	valamelyik régebbi változatát.
	Alaprendszer alatt, amelyet sokszor csak a <span class="quote">"<span class="quote">world</span>"</span>
	néven hivatkozunk, a rendszer számára
	alapvetõ fontosságú binárisokat,
	programkönyvtárakat és
	programfejlesztéshez szükséges egyéb
	állományokat értjük.  Maga a
	fordítóprogram is része ennek, azonban
	tartalmaz néhány speciális
	megszorítást.</p><p>Mindezek mellett továbbá
	feltételezzük, hogy elõzetesen már
	valamilyen módon letöltöttük a friss
	forrásokat.  Ha rendszerünkön ezt még
	nem tettük volna meg, akkor a <a class="xref" href="synching.html" title="24.6. A forrás szinkronizálása">24.6. szakasz - A forrás szinkronizálása</a>
	segítségével
	tájékozódhatunk részletesen
	arról, hogyan tölthetjük le a legfrissebb
	verziót.</p><p>A rendszer forráskódon keresztüli
	frissítése egy kicsivel
	körülményesebb, mint amennyire elsõre
	látszik.  A FreeBSD fejlesztõk az évek
	során fontosnak találták, hogy a
	folyamatosan felszínre bukkanó,
	elkerülhetetlen függõségek
	tükrében meglehetõsen drámai
	módon megváltoztassák az erre javasolt
	módszert.  Ezért a szakasz további
	részében a pillanatnyilag javasolt
	frissítési megoldás nyomán fogunk
	haladni.</p><p>A sikeres frissítések során az
	alábbi akadályokkal kell mindenképpen
	szembenéznünk:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A fordító régebbi változata
	    nem feltétlenül lesz képes
	    lefordítani az új rendszermagot.  (Illetve a
	    régebbi fordítóprogramok
	    tartalmazhatnak hibákat.) Ezért az új
	    rendszermagot már a fordító új
	    változatával kell
	    elõállítanunk.  Ebbõl
	    következik, hogy az új rendszermag
	    elkészítéséhez elõször
	    a fordítóprogram újabb
	    változatát kell lefordítanunk.  Ez
	    viszont nem feltétlenül jelenti azt, hogy az
	    új rendszermag fordítása elõtt az
	    új fordítóprogramot
	    <span class="emphasis"><em>telepítenünk</em></span> is
	    kellene.</p></li><li class="listitem"><p>Az új alaprendszer esetenként bizonyos
	    új funkciókat igényelhet a
	    rendszermagtól.  Ezért a frissebb alaprendszer
	    telepítése elõtt telepítenünk
	    kell a frissebb rendszermagot.</p></li><li class="listitem"><p>Ez az elõbb említett két
	    akadály képzi az okát a
	    következõ bekezdésekben bemutatott
	    <code class="buildtarget">buildworld</code>,
	    <code class="buildtarget">buildkernel</code>,
	    <code class="buildtarget">installkernel</code>,
	    <code class="buildtarget">installworld</code> sorozatnak.
	    Természetesen léteznek további
	    egyéb indokok is, amiért még
	    érdemes az itt leírtak szerint
	    frissíteni a rendszerünket.  Ezek
	    közül most vegyünk néhány
	    kevésbé nyilvánvalóbbat:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>A régebbi alaprendszer nem minden esetben fog
		problémamentesen együttmûködni az
		új rendszermaggal, ezért az alaprendszer
		újabb változatát szinte azonnal az
		új rendszermagot követõen kell
		telepítenünk.</p></li><li class="listitem"><p>Vannak olyan konfigurációs
		változtatások, amelyeket még az
		új alaprendszer telepítése
		elõtt el kell végeznünk, a többi
		viszont veszélyes lehet a korábbi
		alaprendszerre.  Ezért a
		konfigurációs állományokat
		általában két külön
		lépésben kell frissíteni.</p></li><li class="listitem"><p>A frissítés során
		nagyrészt csak állományok
		cserélõdnek el és újabbak
		érkeznek, a korábbiak nem
		törlõdnek.  Ez bizonyos esetekben azonban
		gondokat okozhat.  Ennek eredményeképpen a
		frissítés során
		idõnként elõfordulhat, hogy magunknak
		kell manuálisan némely megadott
		állományokat törölnünk.
		Elképzelhetõ, hogy ezt a jövõben
		még majd automatizálni
		fogják.</p></li></ul></div><p>Ezek a megfontolások vezettek tehát az
	    ismertetendõ eljárás
	    kialakításához.  Ettõl
	    függetlenül adódhatnak olyan helyzetek,
	    amikor további lépéseket is be kell
	    iktatnunk, viszont az itt bemutatott folyamat egy ideje
	    már viszonylag elfogadottnak tekinthetõ:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><code class="command">make buildworld</code></p><p>Elõször lefordítja az új
	      fordítóprogramot és
		néhány hozzá tartozó
		eszközt, majd ennek
		felhasználásával
		elkészíti az alaprendszer többi
		részét.  Az eredmény a <code class="filename">/usr/obj</code>
		könyvtárban keletkezik.</p></li><li class="listitem"><p><code class="command">make buildkernel</code></p><p>Eltérõen a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=config&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">config</span>(8)</span></a> és
		<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> programok korábban javasolt
		alkalmazásától, ezzel a paranccsal
		már a <code class="filename">/usr/obj</code>
		könyvtárban létrehozott
		<span class="emphasis"><em>új</em></span> fordítót
		használjuk.  Ez védelmet nyújt a
		fordító és rendszermag
		változatai közti
		eltérésekbõl fakadó
		problémák ellen.</p></li><li class="listitem"><p><code class="command">make installkernel</code></p><p>Telepíti a lemezre az új rendszermagot
		és a hozzá tartozó modulokat,
		ezáltal lehetõvé válik a
		frissített rendszermag
		betöltése.</p></li><li class="listitem"><p>Átváltás
		egyfelhasználós módba.</p><p>Egyfelhasználós módban a
		minimálisra csökkenthetjük a futó
		szoftverek frissítésébõl
		adódó bonyodalmakat.  Ezzel együtt
		minimálissá válik a régi
		alaprendszer és az új rendszermag
		eltéréseibõl eredõ
		problémák elõfordulása
		is.</p></li><li class="listitem"><p><code class="command">mergemaster -p</code></p><p>Az új alaprendszer
		telepítéséhez elvégzi a
		konfigurációs állományok
		részérõl szükséges
		frissítéseket.  Például
		felvesz még nem létezõ csoportokat
		vagy felhasználókat.  Ez gyakran
		elengedhetetlennek bizonyulhat, mivel ha a rendszer
		legutóbbi frissítése óta
		újabb csoportok vagy felhasználók
		kerültek be az alaprendszerbe, a
		<code class="buildtarget">installworld</code> csak akkor tud
		hibamentesen lefutni, ha ezek már a
		futásakor is elérhetõek.</p></li><li class="listitem"><p><code class="command">make installworld</code></p><p>Átmásolja a <code class="filename">/usr/obj</code>
		könyvtárból a korábban
		elkészített új alaprendszert.
		Lefutása után már mind az új
		rendszermag és az új alaprendszer a
		megfelelõ helyén
		található.</p></li><li class="listitem"><p><code class="command">mergemaster</code></p><p>Feldolgozzuk a korábbi fázisból
		fennmaradó konfigurációs
		állományok
		frissítését, mivel most már
		elérhetõ az új alaprendszer.</p></li><li class="listitem"><p>A rendszer újraindítása.</p><p>Az új rendszermag és az új
		konfigurációs állományokkal
		futó alaprendszer használatához
		teljesen újra kell indítanunk a
		számítógépünket.</p></li></ol></div><p>Ha a FreeBSD ugyanazon fejlesztési
	    ágán belül frissítjük a
	    rendszerünket, például a 7.0
	    kiadásról a 7.1 kiadásra, akkor
	    értelemszerûen nem kell az iménti
	    eljárás minden lépését
	    szorosan követni, hiszen nagyon
	    valószínûtlen, hogy komoly
	    eltérések lennének a
	    fordítóprogram, a rendszermag, az alaprendszer
	    és a konfigurációs
	    állományok között.  Ilyenkor
	    akár nyugodtan kiadhatjuk a <code class="command">make
	    world</code> parancsot, majd kérhetjük a
	    rendszermag fordítását és
	    telepítését.</p><p>A fejlesztési ágak közti
	    váltás során azonban könnyen
	    érhetnek minket meglepetések, ha nem a
	    megadottak szerint járunk el.</p><p>Egyes váltásokhoz (például
	    4.<em class="replaceable"><code>X</code></em> és 5.0
	    között) további lépések
	    megtétele is szükséges lehet
	    (például adott állományok
	    törlése vagy átnevezése még
	    az <code class="buildtarget">installworld</code> elõtt).
	    Ilyenkor mindig figyelmesen olvassuk át a
	    <code class="filename">/usr/src/UPDATING</code>
	    állományt, különös tekintettel
	    a végére, mivel gyakran ott adják meg a
	    konkrét verzióváltáshoz
	    szükséges teendõket.</p><p>A szakaszban összefoglalt lépések
	    egyfajta evolúciós folyamat eredményei,
	    melynek során a fejlesztõk felismerték,
	    hogy nem tökéletesen kivédeni az
	    összes frissítéssel járó
	    problémát.  A javasolt eljárás
	    remélhetõleg viszont még sokáig
	    érvényes marad.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">A FreeBSD 3.<em class="replaceable"><code>X</code></em> vagy
	      annál is korábbi változatok
	      frissítése még ennél is
	      több ügyességet kíván.  Ha
	      ilyen verziót akarunk frissíteni, akkor
	      feltétlenül olvassuk el az
	      <code class="filename">UPDATING</code>
	      állományt!</p></div><p>Röviden tehát a FreeBSD
	    forráskódon keresztüli
	    frissítését így foglalhatjuk
	    össze:</p></li></ul></div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make buildworld</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make buildkernel</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make installkernel</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>shutdown -r now</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Néhány ritka esetben a
	  <code class="buildtarget">buildworld</code> lépés
	  elõtt szükségünk lehet a
	  <code class="command">mergemaster -p</code> parancs
	  lefuttatására is.  Errõl az
	  <code class="filename">UPDATING</code> állományból
	  tudakozódhatunk.  Általában azonban
	  nyugodt szívvel kihagyhatjuk ezt a
	  lépést, kivéve, ha nem egy vagy több
	  fõbb FreeBSD változatot átívelõ
	  frissítést végzünk.</p></div><p>Miután az <code class="buildtarget">installkernel</code>
	sikeresen befejezte a munkáját, indítsuk
	újra a számítógépet
	egyfelhasználós módban (a betöltõ
	parancssorában adjuk ki <code class="command">boot -s</code>
	parancsot).  Itt futtassuk a következõket:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>adjkerntz -i</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount -a -t ufs</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mergemaster -p</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make installworld</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mergemaster</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>reboot</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Olvassuk el a magyarázatokat: </h3><p xmlns="http://www.w3.org/1999/xhtml">Az iménti leírt folyamat csupán
	  rövid összefoglalás, amivel némi
	  gyorstalpalást igyekeztünk adni.  Az egyes
	  lépések megértéséhez
	  azonban javasolt átolvasni a most következõ
	  szakaszokat is, különösen abban az esetben, ha
	  saját rendszermagot akarunk használni.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="src-updating"></a>24.7.2. Nézzük meg a
	<code class="filename">/usr/src/UPDATING</code>
	állományt</h3></div></div></div><p>Mielõtt bármihez is nekifognánk,
	keressük meg a <code class="filename">/usr/src/UPDATING</code> (vagy
	hasonló, a forráskód másolatunk
	tényleges helyétõl függõ)
	állományt.  Ebben adják hírül
	az esetlegesen felmerülõ problémákra
	vonatkozó fontosabb információkat, vagy
	határozzák meg az egyes lefuttatandó
	parancsok pontos sorrendjét.  Amennyiben az
	<code class="filename">UPDATING</code> ellentmondana az itt
	olvasottaknak, az <code class="filename">UPDATING</code> tartalma a
	mérvadó.</p><div xmlns="" class="important"><h3 class="admontitle">Fontos: </h3><p xmlns="http://www.w3.org/1999/xhtml">A korábban tárgyaltak szerint az
	  <code class="filename">UPDATING</code> elolvasása nem
	  helyettesíti a megfelelõ levelezési
	  listák figyelemmel
	  kísérését.  Ez a két
	  elvárás nem kizárja, hanem
	  kiegészíti egymást.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="make-conf"></a>24.7.3. Ellenõrizzük az
	<code class="filename">/etc/make.conf</code>
	állományt</h3></div></div></div><a id="idp93366224" class="indexterm"></a><p>Vizsgáljuk át a
	<code class="filename">/usr/share/examples/etc/make.conf</code> és
	az <code class="filename">/etc/make.conf</code>
	állományokat.  Az elõbbi tartalmaz
	néhány alapértelmezett
	beállítást - ezek
	javarészét megjegyzésbe rakták.  Ha
	használni akarjuk a rendszer lefordítása
	során, tegyük bele ezeket az
	<code class="filename">/etc/make.conf</code> állományba.
	Ne felejtsük el azonban, hogy minden, amit megadunk az
	<code class="filename">/etc/make.conf</code> állományba, a
	<code class="command">make</code> minden egyes elindításakor
	felhasználásra kerül.  Éppen
	ezért olyanokat érdemes itt
	beállítani, amik az egész
	rendszerünket érintik.</p><p>A legtöbb felhasználó
	számára az <code class="filename">/etc/make.conf</code>
	állományhoz a
	<code class="filename">/usr/share/examples/etc/make.conf</code>
	állományban található
	<code class="varname">CFLAGS</code> és
	<code class="varname">NO_PROFILE</code> sorokra lesz szüksége,
	melyeket kivehetünk a megjegyzésbõl.</p><p>A többi definíció
	(<code class="varname">COPTFLAGS</code>, <code class="varname">NOPORTDOCS</code>
	és így tovább)
	használatáról már mindenki maga
	dönt.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="updating-etc"></a>24.7.4. Frissítsük az <code class="filename">/etc</code>
	tartalmát</h3></div></div></div><p>Az <code class="filename">/etc</code> könyvtár
	tartalmazza a rendszer beállításaival
	kapcsolatos információk jelentõs
	részét, valamint a rendszer indítása
	során lefutó szkripteket.  Egyes szkriptek a FreeBSD
	verzióiról verzióira
	változnak.</p><p>Némely konfigurációs
	állományok a rendszer hétköznapi
	mûködésében is szerepet
	játszanak.  Ilyen például az
	<code class="filename">/etc/group</code>.</p><p>Alkalmanként a <code class="command">make installworld</code>
	parancs futása során igényt tart adott
	nevû felhasználókra és csoportokra.  A
	frissítéskor azonban ezek a
	felhasználók vagy csoportok nem
	feltétlenül állnak rendelkezésre, ami
	gondokat okozhat.  Ezért bizonyos esetekben a
	<code class="command">make buildworld</code> elõzetesen
	ellenõrzi az igényelt felhasználók
	és csoportok meglétét.</p><p>Erre például szolgálhat a
	<code class="systemitem">smmsp</code> felhasználó esete.
	Nélküle a felhasználók nem
	tudták telepíteni az új rendszert, mert
	hiányában az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mtree&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mtree</span>(8)</span></a> nem volt képes
	létrehozni a <code class="filename">/var/spool/clientmqueue</code>
	könyvtárat.</p><p>Ezt úgy lehetett megoldani, hogy még az
	alaprendszer lefordítása (a
	<code class="buildtarget">buildworld</code>) elõtt meg kellett
	hívni a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> parancsot a
	<code class="option">-p</code> paraméterrel.  Így csak azokat
	az állományokat fogja
	összehasonlítani, amelyek feltétlenül
	szükségesek a <code class="buildtarget">buildworld</code>
	vagy az <code class="buildtarget">installworld</code> sikeres
	mûködéséhez.  Amennyiben a
	<code class="command">mergemaster</code> egy olyan
	verziójával rendelkezünk, amely nem ismeri a
	<code class="option">-p</code> paramétert, akkor az elsõ
	indításakor használjuk a
	forrásfában található újabb
	verzióját:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/usr.sbin/mergemaster</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>./mergemaster.sh -p</code></strong></pre><div xmlns="" class="tip"><h3 class="admontitle">Tipp: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ha különösen paranoiásak vagyunk,
	  akkor a csoport törlése vagy
	  átnevezése elõtt az alábbi
	  paranccsal ellenõrizni tudjuk az általa birtokolt
	  állományokat:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>find / -group GID -print</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">Ez megmutatja <em class="replaceable"><code>GID</code></em> (mely
	  megadható numerikus vagy név
	  formájában is) jelzésû csoporthoz
	  tartozó összes állományt a
	  rendszerünkben.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makeworld-singleuser"></a>24.7.5. Váltsunk egyfelhasználós
	módba</h3></div></div></div><a id="idp93395408" class="indexterm"></a><p>A rendszert egyfelhasználós módban
	érdemes lefordítani.  A
	nyilvánvalóan érezhetõ
	gyorsaság elõnyei mellett azért is jobban
	járunk, mert az új rendszer
	telepítése során számos
	rendszerszintû állomány is
	módosításra kerül, beleértve a
	szabványos rendszerszintû binárisokat,
	függvénykönyvtárakat, include
	állományokat és így tovább.
	Ha üzemelõ rendszeren végezzük el mindezen
	változtatásokat (különösen amikor
	rajtunk kívül még további
	felhasználók is tartózkodnak a
	rendszerben), az csak a bajt hozza ránk.</p><a id="idp93396304" class="indexterm"></a><p>Másik lehetõség gyanánt a
	rendszert magát lefordíthatjuk
	többfelhasználós módban is, majd
	ezután csak a telepítést hajtjuk
	végre egyfelhasználós
	üzemmódban.  Ha eszerint cselekszünk,
	egyszerûen várjunk addig, amíg az összes
	fordítás be nem fejezõdik, és az
	egyfelhasználósra váltást halasszuk
	a <code class="buildtarget">installkernel</code> vagy
	<code class="buildtarget">installworld</code> idejére.</p><p>Egy mûködõ rendszerben
	rendszeradminisztrátorként az alábbi parancs
	kiadásával válthatunk át
	egyfelhasználós módba:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>shutdown now</code></strong></pre><p>Ezt elérhetjük úgy is, ha
	újraindítjuk a rendszert és a rendszer
	indításakor a <span class="quote">"<span class="quote">single user</span>"</span> pontot
	választjuk a menübõl.  Ekkor a rendszer
	egyfelhasználós módban indul el.
	Miután ez megtörtént, adjuk ki a
	következõ parancsokat:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>fsck -p</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount -u /</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount -a -t ufs</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>swapon -a</code></strong></pre><p>Ezekkel a parancsokkal elõször
	ellenõrizzük az állományrendszereket,
	ezután újracsatlakoztatjuk a
	<code class="filename">/</code> állományrendszert
	írható módban, csatlakoztatjuk az
	<code class="filename">/etc/fstab</code> állományban
	megadott összes többi UFS típusú
	állományrendszert, majd bekapcsoljuk a
	lapozóállomány
	használatát.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ha a gépünk óráját nem a
	  greenwich-i, hanem a helyi idõ szerint
	  állítottuk be (ez akkor áll fenn, ha a
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=date&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">date</span>(1)</span></a> parancs nem a helyes idõt és
	  idõzónát jelzi ki), akkor még erre
	  is szükségünk lehet:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>adjkerntz -i</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">Ezzel a helyi idõzóna
	  beállításait tudjuk jól
	  beállítani - nélküle
	  késõbb még gondjaink akadhatnak.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="cleaning-usr-obj"></a>24.7.6. Töröljük a <code class="filename">/usr/obj</code>
	könyvtárat</h3></div></div></div><p>A rendszer egyes részei fordításuk
	során a <code class="filename">/usr/obj</code>
	könyvtáron belülre kerülnek
	(alapértelmezés szerint).  Az itt
	található könyvtárak a
	<code class="filename">/usr/src</code>
	könyvtárszerkezetét követik.</p><p>Ha mindenestõl töröljük ezt a
	könyvtárat, akkor növeli tudjuk a <code class="command">make
	buildworld</code> folyamat sebességét és
	megmenekülünk néhány
	függõségekkel kapcsolatos
	fejfájástól is.</p><p>Egyes <code class="filename">/usr/obj</code> könyvtáron
	belüli állományoknál szerepelhet a
	<span class="quote">"<span class="quote">megváltoztathatatlan</span>"</span> (immutable)
	állományjelzõ (lásd <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chflags&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">chflags</span>(1)</span></a>),
	amelyet a mûvelet elvégzéséhez
	elõször el kell távolítanunk.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/obj</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chflags -R noschg *</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm -rf *</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="updating-upgrading-compilebase"></a>24.7.7. Fordítsuk újra az alaprendszert</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp93416016"></a>24.7.7.1. A kimenet elmentése</h4></div></div></div><p>Jól járunk azzal, ha a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a>
	  futásának kimenetét elmentjük egy
	  állományba, mivel így a hibák
	  esetén lesz egy másolatunk a
	  hibaüzenetrõl.  Ha konkrétan nekünk nem
	  is feltétlenül segít megtalálni a
	  hiba tényleges okát, mások viszont
	  többet tudnak róla mondani, ha beküldjük
	  ezt a FreeBSD egyik levelezési
	  listájára.</p><p>Ezt egyébként a legegyszerûbben a
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=script&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">script</span>(1)</span></a> parancs segítségével
	  oldhatjuk meg, amelynek paraméteréül azt az
	  állományt kell megadni, ahova menteni akarjuk a
	  kimenetet.  Ezt közvetlenül a rendszer
	  újrafordítása elõtt kell kiadnunk,
	  majd miután megállt, a
	  <strong class="userinput"><code>exit</code></strong> paranccsal kiléphetünk
	  belõle.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>script /var/tmp/mw.out</code></strong>
Script started, output file is /var/tmp/mw.out
<code class="prompt">#</code> <strong class="userinput"><code>make TARGET</code></strong>
<span class="emphasis"><em>... fordít, fordít, fordít ...</em></span>
<code class="prompt">#</code> <strong class="userinput"><code>exit</code></strong>
Script done, ...</pre><p>Ilyenkor <span class="emphasis"><em>soha ne</em></span> a
	  <code class="filename">/tmp</code> könyvtárba mentsük
	  a kimenetet, mert ennek a tartalma a következõ
	  indítás során magától
	  törlõdik.  Sokkal jobban tesszük, ha a
	  <code class="filename">/var/tmp</code> könyvtárba (ahogy
	  tettük azt az elõbbi példában is) vagy
	  a <code class="systemitem">root</code> felhasználó
	  könyvtárába mentünk.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="make-buildworld"></a>24.7.7.2. Az alaprendszer fordítása</h4></div></div></div><p>A <code class="filename">/usr/src</code> könyvtárban
	  kell állnunk:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong></pre><p>(kivéve természetesen, ha máshol van
	  a forráskód, akkor abba a könyvtárba
	  menjünk).</p><a id="idp93435728" class="indexterm"></a><p>Az alaprendszert a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> paranccsal
	  fordíthatjuk újra.  Ez a
	  <code class="filename">Makefile</code> nevû
	  állományból olvassa be a FreeBSD
	  programjainak újrafordítását
	  leíró utasításokat, a
	  fordításuk sorrendjét és
	  így tovább.</p><p>A begépelendõ paranccsor
	  általános alakja tehát a
	  következõképpen néz ki:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make -x -DVÁLTOZÓ target</code></strong></pre><p>A fenti példában a
	  <code class="option">-<em class="replaceable"><code>x</code></em></code> egy olyan a
	  paraméter, amelyet a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> programnak adunk
	  át.  A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> man oldalán
	  megtalálhatjuk az összes neki
	  átadható ilyen
	  beállítást.</p><p>A
	<code class="option">-D<em class="replaceable"><code>VÁLTOZÓ</code></em></code>
	  alakú paraméterek közvetlenül a
	  <code class="filename">Makefile</code> állománynak adnak
	  át olyan változókat, amelyek
	  segítségével vezérelhetõ a
	  viselkedése.  Ezek ugyanazok a változók,
	  mint amelyek az <code class="filename">/etc/make.conf</code>
	  állományban is szerepelnek, és itt a
	  beállításuk egy másik
	  módját kapjuk.  Így a</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make -DNO_PROFILE target</code></strong></pre><p>paranccsal is megadhatjuk, hogy ne profilozott
	  függkönyvtárak jöjjenek létre,
	  ami pontosan megfelel a</p><pre class="programlisting">NO_PROFILE=    true 	#    Avoid compiling profiled libraries</pre><p>sornak az <code class="filename">/etc/make.conf</code>
	  állományban.</p><p>A <em class="replaceable"><code>target</code></em> árulja el a
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> programnak, hogy mi a teendõje.  Minden
	  egyes <code class="filename">Makefile</code>
	  különbözõ <span class="quote">"<span class="quote">targeteket</span>"</span>
	  definiál, és a kiválasztott target mondja
	  meg, pontosan mi is fog történni.</p><p>Egyes targetek ugyan megjelennek a
	  <code class="filename">Makefile</code> állományban,
	  azonban nem feltétlenül hivatkozhatunk
	  rájuk közvetlenül.  Ehelyett csupán
	  arra valók, hogy a fordítás
	  folyamatának lépéseit felbontsák
	  még kisebb allépésekre.</p><p>A legtöbb esetben azonban semmilyen paramétert
	  nem kell átadnunk a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> parancsnak,
	  ezért a teljes formája így fog
	  kinézni:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make target</code></strong></pre><p>ahol a <em class="replaceable"><code>target</code></em> az egyik
	  fordítási lehetõséget
	  képviseli.  Az elsõ ilyen targetnek mindig a
	  <code class="buildtarget">buildworld</code>-nek kell lennie.</p><p>Ahogy a neve is mutatja, a
	  <code class="buildtarget">buildworld</code> lefordítja az
	  összes forrást a <code class="filename">/usr/obj</code>
	  könyvtárba, majd a
	  <code class="buildtarget">installworld</code> mint másik
	  target, telepíti az így létrehozott
	  elemeket a számítógépre.</p><p>A targetek szétválasztása két
	  okból is elõnyös.  Elõször is
	  lehetõvé teszi, hogy az új rendszert
	  biztonságban lefordíthassuk, miközben az a
	  jelenleg futó rendszert nem zavarja.  A rendszer
	  tehát képes <span class="quote">"<span class="quote">saját magát
	  újrafordítani</span>"</span>.  Emiatt a
	  <code class="buildtarget">buildworld</code> target akár
	  többfelhasználós módban is
	  mindenféle nem kívánatos hatás
	  nélkül használható.  Ennek
	  ellenére azonban továbbra is azt javasoljuk,
	  hogy a <code class="buildtarget">installworld</code> részt
	  egyfelhasználós módban futtassuk
	  le.</p><p>Másodrészt ezzel
	  lehetõségünk nyílik NFS
	  állományrendszer alkalmazásával
	  több számítógépre is
	  telepíteni hálózaton keresztül.  Ha
	  például három frissítendõ
	  számítógépünk van, az
	  <code class="systemitem">A</code>, <code class="systemitem">B</code> és
	  <code class="systemitem">C</code>, akkor az <code class="systemitem">A</code> gépen
	  elõször adjuk ki a <code class="command">make
	  buildworld</code>, majd a <code class="command">make
	  installworld</code> parancsot.  A <code class="systemitem">B</code>
	  és <code class="systemitem">C</code> gépek ezután NFS
	  segítségével csatlakoztatják az
	  <code class="systemitem">A</code> <code class="filename">/usr/src</code> és
	  <code class="filename">/usr/obj</code> könyvtárait, amelyet
	  követõen a <code class="command">make installworld</code>
	  paranccsal telepíteni tudjuk a fordítás
	  eredményét a <code class="systemitem">B</code> és
	  <code class="systemitem">C</code> gépekre.</p><p>Noha a <code class="buildtarget">world</code> mint target
	  még mindig létezik, használata
	  határozottan ellenjavalt.</p><p>A</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make buildworld</code></strong></pre><p>parancs kiadásakor a <code class="command">make</code>
	  parancsnak megadható egy <code class="option">-j</code>
	  paraméter is, amellyel párhuzamosíthatjuk
	  a folyamat egyes részeit.  Ez általában
	  többprocesszoros
	  számítógépeken nyer
	  értelmet, azonban mivel a fordítás
	  folyamatának haladását inkább az
	  állománymûveletek mintsem a processzor
	  sebessége korlátozza, ezért
	  alkalmazható akár egyprocesszoros gépeken
	  is.</p><p>Tehát egy átlagos egyprocesszoros
	  gépen így adható ki a parancs:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make -j4 buildworld</code></strong></pre><p>Ennek hatására <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> egyszerre 4
	  szálon igyekszik mûködni.  A
	  levelezési listákra beküldött
	  tapasztalati jellegû bizonyítékok azt
	  igazolják, hogy általában ez a
	  beállítás adja a legjobb
	  teljesítményt.</p><p>Ha többprocesszoros géppel rendelkezünk
	  és rajta SMP támogatású
	  rendszermagot indítottunk el, akkor érdemes 6
	  és 10 közötti értékekkel
	  kísérleteznünk.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp93480272"></a>24.7.7.3. Idõigény</h4></div></div></div><a id="idp93480912" class="indexterm"></a><p>Számos tényezõ befolyásolja a
	  fordítás tényleges idõbeli
	  hosszát, de a FreeBSD-STABLE fa lefordítása
	  mindenféle trükkök és
	  rövidítések nélkül a
	  legtöbb számítógépen olyan
	  egy vagy két órára
	  taksálható.  A FreeBSD-CURRENT fához
	  ennél valamivel több idõre lesz
	  szükségünk.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="new-kernel"></a>24.7.8. Fordítsunk és telepítsünk egy
	új rendszermagot</h3></div></div></div><a id="idp93483472" class="indexterm"></a><p>Az újdonsült rendszerünket csak akkor
	tudjuk igazán kihasználni, ha egy új
	rendszermagot is készítünk hozzá.  Ez
	gyakorlati szinten tulajdonképpen elvárás,
	mivel könnyen elõfordulhat, hogy bizonyos
	memóriabeli adatszerkezetek
	felépítése megváltozott,
	ezért némely programok, mint például
	a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ps&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ps</span>(1)</span></a> és <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=top&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">top</span>(1)</span></a>, egészen addig nem
	lesznek képesek normálisan mûködni,
	amíg a rendszer és a rendszermag
	forráskódja nem illeszkedik
	egymáshoz.</p><p>Ennek legegyszerûbb és egyben
	legbiztonságosabb módja, ha a
	<code class="filename">GENERIC</code> beállításai
	alapján gyártunk és telepítünk
	egy rendszermagot.  Még ha a <code class="filename">GENERIC</code>
	beállításai nem is tartalmazzák a
	rendszerünkben fellelhetõ összes eszközt,
	minden megtalálható bennük ahhoz, hogy a
	rendszert sikeresen elindíthassuk legalább
	egyfelhasználós módban.  Ez mellesleg remek
	próbája az új rendszer
	életképességének.  Miután
	elindítottuk a rendszert a <code class="filename">GENERIC</code>
	típusú rendszermaggal és
	meggyõzõdtünk róla, hogy a rendszer
	tényleg mûködõképes, a megszokott
	rendszermagunk konfigurációs
	állománya alapján nyugodtan
	elkészíthetjük ezután azt is.</p><p>FreeBSD alatt egy új rendszermag
	építése elõtt fontos <a class="link" href="makeworld.html#make-buildworld" title="24.7.7.2. Az alaprendszer fordítása">újrafordítani az
	alaprendszert</a>.</p><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ha saját beállításaink szerint
	  akarunk rendszermagot létrehozni és már
	  van is ehhez egy konfigurációs
	  állományunk, akkor erre használhatjuk a
	  <code class="literal">KERNCONF=SAJÁTMAG</code>
	  paramétert is, valahogy így:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make buildkernel KERNCONF=SAJÁTMAG</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make installkernel KERNCONF=SAJÁTMAG</code></strong></pre></div><p>Hozzátennénk, hogy ha a
	<code class="varname">kern.securelevel</code>
	rendszerváltozó értékét 1
	felé állítottuk
	<span class="emphasis"><em>és</em></span> a rendszermag
	állományának beállítottunk
	<code class="literal">noschg</code> vagy hozzá hasonló
	állományjelzõt, akkor az
	<code class="buildtarget">installkernel</code>
	lefuttatásához mindenképpen
	egyfelhasználós módba kell
	váltanunk.  Minden más esetben további
	bonyodalmak nélkül ki tudjuk adni az említett
	parancsokat.  A <code class="varname">kern.securelevel</code>
	részleteirõl az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=init&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">init</span>(8)</span></a> oldalán, a
	különbözõ
	állományjelzõkrõl pedig a
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chflags&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">chflags</span>(1)</span></a> oldalán olvashatunk.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="new-kernel-singleuser"></a>24.7.9. Indítsuk újra a rendszert
	egyfelhasználós módban</h3></div></div></div><a id="idp93522384" class="indexterm"></a><p>Az új rendszermag mûködésének
	leteszteléséhez indítsuk újra a
	rendszert egyfelhasználós módban.  Ennek
	pontos részleteit lásd <a class="xref" href="makeworld.html#makeworld-singleuser" title="24.7.5. Váltsunk egyfelhasználós módba">24.7.5. szakasz - Váltsunk egyfelhasználós
	módba</a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="make-installworld"></a>24.7.10. Telepítsük az új rendszer
	binárisait</h3></div></div></div><p>Ha a FreeBSD friss változatát nemrég
	fordítottuk le a <code class="command">make buildworld</code>
	paranccsal, akkor utána az
	<code class="buildtarget">installworld</code>
	segítségével tudjuk telepíteni a
	keletkezett programokat.</p><p>Tehát írjuk be ezeket:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make installworld</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Megjegyzés: </h3><p xmlns="http://www.w3.org/1999/xhtml">Amennyiben a paranccsorban a <code class="command">make
	  buildworld</code> használata során adtunk meg
	  változókat, akkor ne felejtsük el
	  ugyanazokat megadni a <code class="command">make installworld</code>
	  kiadása során sem.  Ez viszont a többi
	  paraméterre már nem feltétlenül
	  érvényes.  Például a
	  <code class="option">-j</code> beállítást
	  szigorúan tilos az
	  <code class="buildtarget">installworld</code> targettel együtt
	  használni.</p><p xmlns="http://www.w3.org/1999/xhtml">Ennek megfelelõen tehát ha korábban ezt
	  írtuk be:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make -DNO_PROFILE buildworld</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">akkor így telepítsünk:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make -DNO_PROFILE installworld</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">Máskülönben azokat a profilozott
	  függvénykönyvtárakat
	  próbáljuk meg telepíteni, amelyek a
	  <code class="command">make buildworld</code> futása során
	  nem jöttek létre.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="post-installworld-updates"></a>24.7.11. Frissítsük a <code class="command">make
	installworld</code> által kihagyott
	állományokat</h3></div></div></div><p>Az alaprendszer újrafordítása nem
	regisztrálja az új vagy megváltozott
	állományokat bizonyos könyvtárakban
	(különösen értendõ ez az
	<code class="filename">/etc</code>, <code class="filename">/var</code> és
	<code class="filename">/usr</code> esetén).</p><p>Az ilyen állományokat a legegyszerûbben a
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> használatával tarthatjuk
	karban, de igény szerint akár kézzel is
	elvégezhetjük a szükséges
	aktualizálásokat.  Függetlenül
	attól, hogy mit is választunk, mindenképpen
	készítsünk biztonsági mentést
	az <code class="filename">/etc</code> könyvtárról arra
	az esetre, ha bármilyen szörnyûség
	történne.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mergemaster"></a>24.7.11.1. A <code class="command">mergemaster</code></h4></div><div><span class="authorgroup">Írta: <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="surname">Rhodes</span>, <span class="firstname">Tom</span></span>. </span></div></div></div><a id="idp93553360" class="indexterm"></a><p>A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> segédprogram
	valójában egy Bourne szkript, amely segít
	az <code class="filename">/etc</code> könyvtárunkban
	és a forrásfában levõ
	<code class="filename">/usr/src/etc</code> könyvtárban
	elhelyezkedõ konfigurációs
	állományok közti eltérések
	megállapításában.  Ezt a
	módszert ajánljuk arra, hogy összevessük
	a konfigurációs állományainkat a
	forrásfában található
	változataikkal.</p><p>A használatának megkezdéséhez
	egyszerûen írjuk be, hogy
	<code class="command">mergemaster</code>, majd várjunk egy kicsit,
	amíg a <code class="command">mergemaster</code> létrehoz
	magának egy átmeneti környezetet a
	<code class="filename">/</code> könyvtárból elindulva
	és megtölti azt a különbözõ
	rendszerszintû beállításokat
	tartalmazó állományokkal.  Ezeket az
	állományokat aztán
	összehasonlítja a jelenleg érvényben
	levõ változataikkal.  Ilyenkor a köztük
	talált eltéréseket a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>
	formátumának megfelelõen módon mutatja
	meg, ahol a <code class="option">+</code> jelöli a hozzáadott
	vagy módosított sorokat, a <code class="option">-</code>
	pedig a teljesen eltávolítandó vagy
	cserélendõ sorokat.  Errõl a
	formátumról bõvebben a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> man
	oldalán találhatunk
	felvilágosítást.</p><p>A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> ezt követõen megmutatja az
	összes olyan állományt, ahol
	eltérést tapasztalt, és ezen a ponton van
	lehetõségünk letörölni (delete) az
	új állományokat (amelyekre itt most
	ideiglenes állományként hivatkozik),
	telepíteni (install) a módosítatlan
	ideiglenes (új) állományt, valamint
	összefésülni (merge) az ideiglenes (új)
	és a jelenlegi állományokat, vagy
	ismét átnézni (view) a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>
	által jelzett különbségeket.</p><p>Ha az ideiglenes állomány
	törlését választjuk, akkor a
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> ezt úgy értelmezi, hogy
	változatlanul meg akarjuk tartani a jelenlegi
	változatot és törölni az újat.
	Ezt alapvetõen nem javasoljuk, hacsak tényleg nem
	látunk valamilyen okot erre.  A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a>
	parancssorában a <span class="keycap"><strong>?</strong></span>
	begépelésével bármikor
	kérhetünk segítséget.  Ha az
	állomány kihagyását (skip)
	választjuk, akkor majd ismét felajánlja,
	amikor végeztünk az összes
	többivel.</p><p>A módosítatlan ideiglenes
	állomány telepítésének
	választásával lecseréljük a
	jelenleg verziót az újra.  Ha az aktuális
	verziót sem változtattuk meg, akkor
	számunkra ez a legjobb megoldás.</p><p>Az állományok
	összefésülésének
	kiválasztásakor kapunk egy
	szövegszerkesztõt, benne a két
	állomány tartalmával.  Ilyenkor tudjuk a
	képernyõn soronként egyeztetni a két
	állományt, majd a belõlük a
	megfelelõ részek
	összeválogatásával kialakítani
	az eredményt.  Ebben a feldolgozási módban
	az <span class="keycap"><strong>l</strong></span> (mint left, vagyis bal) billentyû
	lenyomására a bal oldalon látható
	részt, az <span class="keycap"><strong>r</strong></span> (mint right, vagyis jobb)
	lenyomására pedig a jobb oldalon
	látható részt választjuk ki.  Az
	így keletkezõ eredményt ezután egy
	állományba kerül, amelyet telepíteni
	tudunk.  Ez a megoldás olyan állományok
	esetében használható, amikor a
	felhasználó módosított az
	alapértelmezett
	beállításokat.</p><p>Ha a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> szerinti alakban akarjuk
	átnézni a különbségeket, akkor a
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> ugyanúgy megmutatja ezeket, mint a
	paranccsor megjelenítése elõtt.</p><p>Miután a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> végigment a
	rendszerszintû állományokon, további
	opciókat mutat.  Megkérdezheti, hogy újra
	létre akarjuk-e hozni a jelszavakat tároló
	állományt (rebuild), illetve a folyamat
	végén a megmaradt ideiglenes
	állományok törlésére (remove)
	vár választ.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp93573328"></a>24.7.11.2. Az állományok aktualizálása
	  kézzel</h4></div></div></div><p>Ha inkább manuálisan szeretnénk
	  frissíteni, akkor nem másolhatjuk csak
	  egyszerûen át az állományokat a
	  <code class="filename">/usr/src/etc</code>
	  könyvtárból a <code class="filename">/etc</code>
	  könyvtárba és nem hagyhatjuk ezeket
	  sorsukra.  Egyes állományokat elõször
	  <span class="quote">"<span class="quote">telepíteni</span>"</span> kell.  Ez azért van
	  így, mert a <code class="filename">/usr/src/etc</code>
	  könyvtár <span class="emphasis"><em>nem pusztán</em></span>
	  az <code class="filename">/etc</code> könyvtár
	  egyszerû másolata.  Ráadásul az
	  <code class="filename">/etc</code> könyvtárban vannak olyan
	  állományok, amelyek a
	  <code class="filename">/usr/src/etc</code> könyvtárban nem
	  is találhatóak meg.</p><p>Ha (az ajánlottak szerint) a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a>
	  segítségével dolgozunk, nyugodtan
	  átléphetünk a <a class="link" href="makeworld.html#updating-upgrading-rebooting" title="24.7.12. Újraindítás">következõ
	  szakaszra</a>.</p><p>Saját magunk a legegyszerûbben ezt úgy
	  tudjuk megoldani, ha telepítjük az
	  állományokat egy új
	  könyvtárba és ezután
	  nekiállunk változásokat keresni.</p><div xmlns="" class="warning"><h3 class="admontitle">Az <code xmlns="http://www.w3.org/1999/xhtml" class="filename">/etc</code> meglevõ
	    tartalmának mentése: </h3><p xmlns="http://www.w3.org/1999/xhtml">Habár elméletileg magától
	    semmi sem fogja bántani ezt a könyvtárat,
	    azért ettõl függetlenül mindig
	    érdemes biztosra menni.  Ezért másoljuk
	    az <code class="filename">/etc</code> könyvtár
	    tartalmát egy megbízható helyre.
	    Például:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cp -Rp /etc /etc.old</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">Az <code class="option">-R</code> itt a rekurzív
	    másolást jelenti, a <code class="option">-p</code> pedig
	    a dátumok, az állományok és
	    egyebek tulajdoni viszonyainak
	    megõrzését.</p></div><p>Az <code class="filename">/etc</code> új
	  változatának telepítéséhez
	  szükségünk lesz még további
	  könyvtárakra is.  Erre a feladatra a
	  <code class="filename">/var/tmp/root</code> tökéletesen
	  megfelel, ahol még létre kell hoznunk
	  néhány alkönyvtárat.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/tmp/root</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/etc</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make DESTDIR=/var/tmp/root distrib-dirs distribution</code></strong></pre><p>Ezzel létrejön a szükséges
	  könyvtárszerkezet és települnek az
	  állományok.  Sok üres
	  alkönyvtár is keletkezik a
	  <code class="filename">/var/tmp/root</code> könyvtáron
	  belül, ezeket töröljük.  Ezt a
	  legkönnyebben így tehetjük meg:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /var/tmp/root</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>find -d . -type d | xargs rmdir 2&gt;/dev/null</code></strong></pre><p>Ezzel törlõdnek az üres
	  könyvtárak.  (A szabvány hibakimenetet
	  átirányítottuk a
	  <code class="filename">/dev/null</code> eszközre, és ezzel
	  elnyomtuk a nem üres könyvtárak esetén
	  keletkezõ hibaüzeneteket.)</p><p>A <code class="filename">/var/tmp/root</code> most már
	  tartalmazza az összes olyan állományt,
	  amelyek normális esetben a <code class="filename">/</code>
	  könyvtáron belül foglalnak helyet.  Ezt
	  követõen nincs más dolgunk, csak
	  végigmenni az itt található
	  állományokon és
	  megállapítani, miben térnek a
	  meglévõektõl.</p><p>Vegyük észre, hogy a
	  <code class="filename">/var/tmp/root</code> könyvtárba
	  telepített állományok
	  némelyikének neve <span class="quote">"<span class="quote">.</span>"</span>-tal
	  kezdõdik.  Az írás pillanatában ezek
	  csak a <code class="filename">/var/tmp/root/</code> és
	  <code class="filename">/var/tmp/root/root/</code>
	  könyvtárakban található
	  parancsértelmezõhöz tartozó
	  indító állományok lehetnek,
	  habár adódhatnak még ilyenek
	  (attól függõen, mikor olvassuk ezt).
	  Ezért a feldolgozásukhoz ne felejtsük el a
	  <code class="command">ls -a</code> parancsot használni.</p><p>A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> alkalmazásával
	  legegyszerûbben így tudunk
	  összehasonlítani két
	  állományt:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>diff /etc/shells /var/tmp/root/etc/shells</code></strong></pre><p>Ennek hatására megjelennek az
	  <code class="filename">/etc/shells</code> és az új
	  <code class="filename">/var/tmp/root/etc/shells</code>
	  állományok közti
	  különbségek.  A
	  segítségével gyorsan el tudjuk
	  dönteni, hogy összefésüljük-e a
	  két állományt, vagy csak egyszerûen
	  írjuk felül a régebbi verziót az
	  újjal.</p><div xmlns="" class="tip"><h3 class="admontitle">Az új könyvtár
	    (<code xmlns="http://www.w3.org/1999/xhtml" class="filename">/var/tmp/root</code>) nevébe
	    írjuk bele a dátumot is, így
	    könnyedén össze tudunk hasonlítani
	    több verziót is: </h3><p xmlns="http://www.w3.org/1999/xhtml">A rendszer gyakori újrafordítása az
	    <code class="filename">/etc</code> szintén gyakori
	    aktualizálását is maga után
	    vonja, ami viszont fárasztó lehet.</p><p xmlns="http://www.w3.org/1999/xhtml">Az iménti folyamatot fel tudjuk
	    gyorsítani, hogy ha az <code class="filename">/etc</code>
	    legutoljára összefésült
	    változatát megtartjuk.  A most
	    következõ eljárás ennek
	    mikéntjét vázolja fel.</p><div xmlns="http://www.w3.org/1999/xhtml" class="procedure"><ol class="procedure" type="1"><li class="step"><p>A megszokottak szerint fordítsuk le a
		rendszert.  Majd amikor az <code class="filename">/etc</code>
		könyvtárat és a többit is
		frissíteni akarjuk, a célként
		megadott könyvtár nevében adjuk meg a
		dátumot.  Ha tehát például
		1998.  február 14.  van, akkor írjuk
		ezt:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/tmp/root-19980214</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/etc</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make DESTDIR=/var/tmp/root-19980214 \
    distrib-dirs distribution</code></strong></pre></li><li class="step"><p>Fésüljük össze a
		könyvtárban található az
		állományokat a fentiekben
		körvonalazottak szerint.</p><p>Befejezés után
		<span class="emphasis"><em>õrizzük meg</em></span> a
		<code class="filename">/var/tmp/root-19980214</code>
		könyvtárat.</p></li><li class="step"><p>Mikor újra letöltjük a legfrissebb
		forrásokat és megismételjük az
		elõbbi lépéseket, haladjunk megint az
		elsõ lépés szerint.  Ekkor
		tehát létrejön egy újabb
		könyvtár, amelynek a neve ezúttal
		már <code class="filename">/var/tmp/root-19980221</code>
		lesz (ha például hetente
		frissítünk).</p></li><li class="step"><p>Most már meg tudjuk vizsgálni a
		közbeesõ héten született
		eltéréseket, ha a két
		könyvtárra kiadunk egy rekurzív
		<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> hívást:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /var/tmp</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>diff -r root-19980214 root-19980221</code></strong></pre><p>Általában így kevesebb
		eltérést kapunk, mint amennyi
		például a
		<code class="filename">/var/tmp/root-19980221/etc/</code>
		és az <code class="filename">/etc</code>
		összehasonlítása során
		elkerült volna.  Mivel kisebb a keletkezett
		különbségek száma, ezért
		könnyebb lesz átvinnünk az
		<code class="filename">/etc</code> könyvtárunkba is a
		módosításokat.</p></li><li class="step"><p>Ezután törölhetjük a
		régebbi <code class="filename">/var/tmp/root-*</code>
		könyvtárat:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>rm -rf /var/tmp/root-19980214</code></strong></pre></li><li class="step"><p>Az <code class="filename">/etc</code>
		összefésülésekor mindig
		ismételjük meg ezeket a
		lépéseket.</p></li></ol></div><p xmlns="http://www.w3.org/1999/xhtml">A <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=date&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">date</span>(1)</span></a> meghívásával
	    akár automatikussá is tehetjük a
	    könyvtárak névadását:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/tmp/root-`date "+%Y%m%d"`</code></strong></pre></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="updating-upgrading-rebooting"></a>24.7.12. Újraindítás</h3></div></div></div><p>Ezzel készen is vagyunk.  Miután
	ellenõriztük, hogy minden a megfelelõ
	helyére került, indítsuk újra a
	rendszert.  Ehhez egy egyszerû <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=shutdown&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">shutdown</span>(8)</span></a> is
	elegendõ:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>shutdown -r now</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp93633360"></a>24.7.13. Befejeztük!</h3></div></div></div><p>Gratulálunk, sikerült frissítenünk a
	FreeBSD rendszerünket.</p><p>Ha mégis valami balul ütne ki, könnyen
	újra tudjuk fordítani a rendszer egyes
	részeit.  Például, ha
	véletlenül letöröltük az
	<code class="filename">/etc/magic</code> állományt az
	<code class="filename">/etc</code> frissítése vagy
	összefésülése során, a
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=file&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">file</span>(1)</span></a> parancs nem fog tudni rendesen mûködni.
	Ilyenkor a következõket kell tennünk a hiba
	kijavításához:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/usr.bin/file</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make all install</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="updating-questions"></a>24.7.14. Kérdések</h3></div></div></div><div class="qandaset"><a id="idp93638864"></a><dl><dt>24.7.14.1. <a href="makeworld.html#idp93647440">Minden egyes változtatásnál
	      újra kell fordítani a rendszert?</a></dt><dt>24.7.14.2. <a href="makeworld.html#idp93653712">A fordító rengeteg 11-es jelzést
	      (signal 11) (vagy másfajta jelzéseket) dob
	      hibával.  Mi történhetett?</a></dt><dt>24.7.14.3. <a href="makeworld.html#idp93657168">A fordítása befejezése
	      után törölhetem a
	      /usr/obj
	      könyvtárat?</a></dt><dt>24.7.14.4. <a href="makeworld.html#idp93662032">Lehetséges a megszakadt fordítás
	      folytatása?</a></dt><dt>24.7.14.5. <a href="makeworld.html#idp93681872">Hogyan tudjuk felgyorsítani a
	      fordítást?</a></dt><dt>24.7.14.6. <a href="makeworld.html#idp93749968">Mi tegyünk, ha valami nem megy rendesen?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp93647440"></a><a id="idp93647696"></a><p><strong>24.7.14.1.</strong></p></td><td align="left" valign="top"><p>Minden egyes változtatásnál
	      újra kell fordítani a rendszert?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Nem könnyû választ adni erre a
	      kérdésre, mivel ez alapvetõen a
	      változtatás jellegétõl
	      függ.  Például, ha elindítjuk a
	      <span class="application">CVSup</span> programot és csak
	      az alábbi állományok
	      frissülnek:</p><pre class="screen"><code class="filename">src/games/cribbage/instr.c</code>
<code class="filename">src/games/sail/pl_main.c</code>
<code class="filename">src/release/sysinstall/config.c</code>
<code class="filename">src/release/sysinstall/media.c</code>
<code class="filename">src/share/mk/bsd.port.mk</code></pre><p>Ekkor valószínûleg nem éri
	      meg újrafordítani a teljes rendszert.
	      Elegendõ csupán belépni az
	      érintett állományokat
	      tartalmazó alkönyvtárakba és ott
	      rendre kiadni a <code class="command">make all install</code>
	      parancsot.  Ha viszont már valami komolyabb,
	      például az
	      <code class="filename">src/lib/libc/stdlib</code> változott
	      meg, akkor vagy az egész rendszert, vagy
	      legalább azon részeit fordítsuk
	      újra, amely statikusan linkeltek (és minden
	      más idõközben még
	      hozzáadott statikusan linkelt dolgot).</p><p>Hogy melyik megoldást választjuk,
	      teljesen rajtunk áll.
	      Újrafordíthatjuk az egész rendszert
	      kéthetente, mondván, hadd gyüljenek fel
	      szépen a módosítások, vagy a
	      függõségek pontos
	      kielemzésével csak azokat az elemeket
	      fordítjuk újra, amelyek tényleg meg
	      is változtak.</p><p>Természetesen az egész attól
	      függ, hogy milyen gyakran és melyik rendszert,
	      a FreeBSD-STABLE-t vagy a FreeBSD-CURRENT-et
	      frissítjük.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp93653712"></a><a id="idp93653968"></a><p><strong>24.7.14.2.</strong></p></td><td align="left" valign="top"><p>A fordító rengeteg 11-es jelzést
	      (signal 11)<a id="idp93654480" class="indexterm"></a> (vagy másfajta jelzéseket) dob
	      hibával.  Mi történhetett?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Ez általában hardveres
	      meghibásodásra utal.  A rendszer
	      újrafordítása alapjaiban véve
	      egy remek módszer
	      számítógépünk
	      alkatrészeinek terhelésére,
	      ezért gyakorta elõhozza a memória
	      már meglevõ hibáit.  Ezek
	      többnyire abban fogalmazódnak meg, hogy a
	      fordító rejtélyes módon
	      leáll mindenféle furcsa jelzések
	      hatására.</p><p>Errõl biztosan úgy tudunk
	      meggyõzõdni, ha újraindítjuk a
	      make programot és az a folyamat egy teljesen
	      másik pontján vérzik el.</p><p>Ilyenkor nem tudunk mást tenni, mint
	      egymás után kicserélgetjük,
	      kivesszük az alkatrészeket és
	      így próbáljuk
	      megállapítani, pontosan melyikük is
	      okozza a gondokat.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp93657168"></a><a id="idp93657424"></a><p><strong>24.7.14.3.</strong></p></td><td align="left" valign="top"><p>A fordítása befejezése
	      után törölhetem a
	      <code class="filename">/usr/obj</code>
	      könyvtárat?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Röviden: Igen.</p><p>A <code class="filename">/usr/obj</code> tartalmazza a
	      fordítás folyamata során
	      keletkezõ összes tárgykódot.
	      Ennek törlése általában a
	      <code class="command">make buildworld</code> elsõ
	      lépései között szerepel.
	      Ezért tulajdonképpen a
	      <code class="filename">/usr/obj</code> megtartásának
	      nincs túlságosan sok értelme, viszont
	      elég sok (jelenleg úgy kb.  340 MB)
	      helyet fel tudunk így szabadítani.</p><p>Ha azonban értjük a dolgunkat, akkor
	      megadhatjuk a <code class="command">make buildworld</code>
	      parancsnak, hogy hagyja ki ezt a lépést.
	      Ennek hatására a fordítás
	      sokkal hamarabb véget ér, mivel a
	      legtöbb forrást így nem kell
	      újrafordítani.  Üröm az
	      örömben, hogy ha netalán aprócska
	      függõségi problémák
	      merülnének fel, akkor az egész
	      fordítás megfeneklik mindenfelé
	      különös módokon.  Emiatt gyakran
	      írnak feleslegesen leveleket a FreeBSD
	      levelezési listáira, melyek a rendszer
	      sikertelen
	      újrafordításáról
	      panaszkodnak, miközben kiderül, hogy az maguk az
	      érintettek akarták lerövidíteni
	      a folyamatot.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp93662032"></a><a id="idp93662288"></a><p><strong>24.7.14.4.</strong></p></td><td align="left" valign="top"><p>Lehetséges a megszakadt fordítás
	      folytatása?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Ez attól függ, hogy a probléma
	      bekövetkezése elõtt mennyire
	      sikerült eljutni a fordításban.</p><p><span class="emphasis"><em>Általában</em></span>
	      (tehát nem feltétlenül minden esetben)
	      a <code class="command">make buildworld</code> lefordítja a
	      fordításhoz szükséges
	      eszközök (például a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gcc&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">gcc</span>(1)</span></a>
	      és <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a>) újabb változatait
	      és a rendszer
	      függvénykönyvtárait, majd ezeket
	      telepíti.  Ezután ezekkel az új
	      eszközökkel lefordítattja saját
	      magukat és ismét telepíti.  Ezt
	      követõen fordítja újra az
	      új rendszerállományokkal az
	      egész rendszert (így ezúttal
	      már az olyan szokásos
	      felhasználói programokat is, mint
	      például az <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ls&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ls</span>(1)</span></a> és a
	      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=grep&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">grep</span>(1)</span></a>).</p><p>Ha tudjuk, hogy az utolsó fázisban
	      álltunk le (mivel megnéztük a
	      fordításhoz tartozó kimenetet), akkor
	      (minden további nélkül) elég
	      ennyi:</p><pre class="screen"><span class="emphasis"><em>... kijavítjuk a hibát ...</em></span>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make -DNO_CLEAN all</code></strong></pre><p>Ezzel megmarad a korábbi <code class="command">make
	      buildworld</code> munkájának
	      eredménye.</p><p>Ha ezt az üzenetet látjuk a <code class="command">make
	      buildworld</code> kimenetében:</p><pre class="screen">--------------------------------------------------------------
Building everything..
--------------------------------------------------------------</pre><p>akkor különösebb gond
	      nélkül megcsinálhatjuk.</p><p>Amennyiben viszont nem látunk ilyen
	      üzenetet, vagy nem vagyunk benne biztosak, akkor
	      még mindig jobb elõvigyázatosnak lenni,
	      ezért kénytelenek leszünk teljesen
	      elölrõl kezdeni a
	      fordítást.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp93681872"></a><a id="idp93682128"></a><p><strong>24.7.14.5.</strong></p></td><td align="left" valign="top"><p>Hogyan tudjuk felgyorsítani a
	      fordítást?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Futtassuk egyfelhasználós
		  módban.</p></li><li class="listitem"><p>Tegyük a <code class="filename">/usr/src</code>
		  és <code class="filename">/usr/obj</code>
		  könyvtárakat külön
		  állományrendszerekre, külön
		  lemezekre.  Sõt, ha lehetséges, akkor
		  ezeket a lemezeket tegyük külön
		  lemezvezérlõkre.</p></li><li class="listitem"><p>Még mindig jobb, ha ezeket az
		  állományrendszereket a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ccd&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ccd</span>(4)</span></a>
		  (lemezek összefûzését
		  vezérlõ meghajtó)
		  segítségével kiterjesztjük
		  több lemezes eszközre.</p></li><li class="listitem"><p>Kapcsoljuk ki a profilozást (az
		  <code class="filename">/etc/make.conf</code>
		  állományban a
		  <span class="quote">"<span class="quote">NO_PROFILE=true</span>"</span>
		  megadásával).  Többnyire úgy
		  sem lesz rá szükségünk.</p></li><li class="listitem"><p>Az <code class="filename">/etc/make.conf</code>
		  állományban a <code class="varname">CFLAGS</code>
		  változót állítsuk az
		  <code class="option">-O -pipe</code> értékre.  Az
		  <code class="option">-O2</code> gyakran sokkal lassabb, az
		  <code class="option">-O</code> és <code class="option">-O2</code>
		  alig tér el az optimalizálás
		  mértékében.  A
		  <code class="option">-pipe</code> paraméter
		  hatására pedig a
		  fordítóprogram átmeneti
		  állományok helyett csöveket
		  használ a kommunikációra,
		  és így megtakarít némi
		  lemezhasználatot (a
		  memóriahasználat terhére).</p></li><li class="listitem"><p>Ha a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> parancsnak átadjuk a
		  <code class="option">-j<em class="replaceable"><code>n</code></em></code>
		  paramétert, akkor képes több
		  mindent párhuzamosan futtatni.  Ez sok esetben
		  segít attól függetlenül, hogy
		  egy- vagy többprocesszoros gépünk
		  van.</p></li><li class="listitem"><p>A <code class="filename">/usr/src</code>
		  könyvtárat tartalmazó
		  állományrendszert csatlakoztathatjuk
		  (vagy újracsatlakoztathatjuk) a
		  <code class="option">noatime</code>
		  beállítással.  Ilyenkor az
		  állományrendszer nem rögzíti
		  a hozzáférés idejét.  Erre
		  az információra sincs
		  igazából
		  szükségünk.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -u -o noatime /usr/src</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Figyelem: </h3><p xmlns="http://www.w3.org/1999/xhtml">A fenti példa azt feltételezi,
		    hogy a <code class="filename">/usr/src</code>
		    könyvtárnak saját
		    állományrendszere van.  Ha ez nem
		    így lenne (tehát például
		    a <code class="filename">/usr</code> része), akkor itt
		    azt kell megadnunk, nem pedig a
		    <code class="filename">/usr/src</code> nevét.</p></div></li><li class="listitem"><p>A <code class="filename">/usr/obj</code>
		  könyvtárat tartalmazó
		  állományrendszert csatlakoztathatjuk
		  (vagy újracsatlakoztathatjuk) az
		  <code class="option">async</code>
		  beállítással.  Ennek
		  hatására a lemez írása
		  aszinkron módon történik.  Magyarul
		  az írási mûveletek azonnal
		  befejezõdnek, miközben az adat
		  ténylegesen csak pár másodperccel
		  késõbb kerül ki a lemezre.  Ezzel az
		  írási kérelmek
		  gyönyörûen
		  összegyûjthetõek, ami
		  nagymértékû növekedést
		  eredményez a
		  teljesítményben.</p><div xmlns="" class="warning"><h3 class="admontitle">Figyelem: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ne felejtsük el azonban, hogy ezzel
		    együtt az
		    állományrendszerünk is
		    sérülékenyebbé
		    válik.  Ezen beállítás
		    használatával megnõ annak az
		    esélye, hogy egy áramkimaradást
		    követõ indításnál az
		    állományrendszer
		    helyreállíthatatlan állapotba
		    kerül.</p><p xmlns="http://www.w3.org/1999/xhtml">Ha egyedül csak a
		    <code class="filename">/usr/obj</code>
		    található ezen az
		    állományrendszeren, akkor ez nem
		    jelent akkora veszélyt.  Amikor viszont rajta
		    kívül még értékes
		    adat is található az
		    állományrendszeren, a
		    beállítás
		    érvényesítése elõtt
		    mindenképpen készítsünk
		    róla friss mentéseket.</p></div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -u -o async /usr/obj</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Figyelem: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ahogy arról az elõbb is szó
		    esett, ha a <code class="filename">/usr/obj</code> nem egy
		    különálló
		    állományrendszeren
		    található, akkor a
		    példában szereplõ
		    csatlakozási pontot cseréljük ki
		    a megfelelõre.</p></div></li></ul></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp93749968"></a><a id="idp93750224"></a><p><strong>24.7.14.6.</strong></p></td><td align="left" valign="top"><p>Mi tegyünk, ha valami nem megy rendesen?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Egyértelmûen bizonyosodjunk meg
	      róla, hogy a korábbi
	      fordításokból nem maradtak vissza
	      semmiféle kóbor állományok.
	      Ennyi sokszor pontosan elég.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chflags -R noschg /usr/obj/usr</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm -rf /usr/obj/usr</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make cleandir</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make cleandir</code></strong></pre><p>Igen, a <code class="command">make cleandir</code> parancsot
	      tényleg kétszer kell kiadni.</p><p>Ezután a <code class="command">make buildworld</code>
	      parancstól indulva kezdjük újra a
	      fordítást.</p><p>Ha még ezek után is fennáll a
	      probléma, küldjük el a hibát
	      tartalmazó kimenetet és a <code class="command">uname
	      -a</code> parancs eredményét a
	      <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-questions" target="_top">FreeBSD general questions levelezési lista</a> címére.  Ne
	      lepõdjünk meg, ha a
	      beállításainkra vonatkozóan
	      még kapunk további kérdéseket
	      is!</p></td></tr></tbody></table></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="synching.html">Vissza</a> </td><td width="20%" align="center"><a accesskey="u" href="updating-upgrading.html">Fel</a></td><td width="40%" align="right"> <a accesskey="n" href="small-lan.html">Elõre</a></td></tr><tr><td width="40%" align="left" valign="top">24.6. A forrás szinkronizálása </td><td width="20%" align="center"><a accesskey="h" href="index.html">Fõoldal</a></td><td width="40%" align="right" valign="top"> 24.8. A források követése több
      géppel</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ha kérdése van a FreeBSD-vel kapcsolatban, a
    következõ címre írhat (angolul):
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Ha ezzel a dokumentummal kapcsolatban van kérdése, kérjük erre a címre írjon:
    &lt;<a href="mailto:gabor@FreeBSD.org">gabor@FreeBSD.org</a>&gt;.</small></p></body></html>