<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>6.7. MAC策略入口函数参考</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 系统结构手册" /><link rel="up" href="mac.html" title="第 6 章 TrustedBSD MAC 框架" /><link rel="prev" href="mac-policy-architecture.html" title="6.6. MAC策略模块体系结构" /><link rel="next" href="mac-userland-arch.html" title="6.8. 应用层体系结构" /><link rel="copyright" href="trademarks.html" title="法律声明" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.7. MAC策略入口函数参考</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mac-policy-architecture.html">上一页</a> </td><th width="60%" align="center">第 6 章 TrustedBSD MAC 框架</th><td width="20%" align="right"> <a accesskey="n" href="mac-userland-arch.html">下一页</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mac-entry-point-reference"></a>6.7. MAC策略入口函数参考</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-general"></a>6.7.1. 通用的模块入口函数</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init"></a>6.7.1.1. <code class="function">mpo_init</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init</strong>(</code></td><td><var class="pdparam">conf</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mac_policy_conf
              *<var class="pdparam">conf</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>conf</code></em></td><td>MAC 策略定义</td><td class="auto-generated"> </td></tr></tbody></table></div><p>策略加载事件。当前进程正持有策略链表上的互斥锁，因此是非睡眠的，对其他内核子系统的调用也须慎重。
         如果需要在策略初始化阶段进行可能造成睡眠阻塞的存储分配操作，可以将它们放在一个单独的模块 SYSINIT()
         过程中集中进行。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mpo-destroy"></a>6.7.1.2. <code class="function">mpo_destroy</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy</strong>(</code></td><td><var class="pdparam">conf</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mac_policy_conf
              *<var class="pdparam">conf</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>conf</code></em></td><td>MAC 策略定义</td><td class="auto-generated"> </td></tr></tbody></table></div><p>策略加载事件。必须持有策略链表互斥锁，因此需要慎重行事。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-syscall"></a>6.7.1.3. <code class="function">mpo_syscall</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_syscall</strong>(</code></td><td><var class="pdparam">td</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">call</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">arg</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct thread
              *<var class="pdparam">td</var></code>;<br /><code>int <var class="pdparam">call</var></code>;<br /><code>void *<var class="pdparam">arg</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>td</code></em></td><td>调用线程</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>call</code></em></td><td>策略特有的系统调用编号</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>arg</code></em></td><td>系统调用参数的指针</td><td class="auto-generated"> </td></tr></tbody></table></div><p>该入口函数提供策略复用的系统调用，这样策略模块不需要为其向用户进程提供的每一个额外服务而注册专用的系统调用。
          由应用程序提供的策略注册名字来确定提供其所申请服务的特定策略，所有参数将通过该入口函数传递给被调用的策略。
          当实现新服务时，安全模块必须在必要时通过 MAC 框架调用相应的访问控制检查机制。
          比方说，假如一个策略实现了某种额外的信号功能，那么它应该调用相关的信号访问控制检查，以接受 MAC 框架中注册的其他策略的检查。</p><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">不同的模块需要并发地手动进行<code class="function">copyin()</code>拷贝系统调用数据。</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-thread-userret"></a>6.7.1.4. <code class="function">mpo_thread_userret</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_thread_userret</strong>(</code></td><td><var class="pdparam">td</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct thread
              *<var class="pdparam">td</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>td</code></em></td><td>返回线程</td><td class="auto-generated"> </td></tr></tbody></table></div><p>使用该入口函数，策略模块能够在线程返回用户空间时（系统调用返回、异常返回等等）进行 MAC 相关的处理工作。
          使用动态进程标记的策略需要使用该入口函数，因为在处理系统调用的过程中，并不是在任意时刻都能申请到进程锁的；
          进程的标记可能表示传统的认证信息、进程历史记录或者其他数据。为使用该入口函数，对进程信任状所作的修改
	   可能被存放在 <code class="literal">p_label</code> ,该域受一个进程级自旋锁的保护；接下来，设置线程级的<code class="literal">TDF_ASTPENDING</code>
	   标志位和进程级的<code class="literal">PS_MACPENDM</code>标志位，表明将调度一个对 userret 入口函数的调用。通过该入口函数，
	   策略可以在相对简单的同步上下文中创建信任状的替代品。策略编程人员必须清楚，需要保证与调度一个 AST 相关的事件执行次序，
	   同时所执行的 AST 可能很复杂，而且在处理多线程应用程序时可能被重入。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-label-ops"></a>6.7.2. 操作标记</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-bpfdesc"></a>6.7.2.1. <code class="function">mpo_init_bpfdesc_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_bpfdesc_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被应用的新标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个新近实例化的 bpfdesc（BPF 描述子）初始化标记。可以睡眠。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-cred-label"></a>6.7.2.2. <code class="function">mpo_init_cred_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_cred_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被初始化的新标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个新近实例化的用户信任状初始化标记。可以睡眠。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-devfsdirent"></a>6.7.2.3. <code class="function">mpo_init_devfsdirent_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_devfsdirent_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被应用的新标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个新近实例化的 devfs　表项初始化标记。可以睡眠。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-ifnet"></a>6.7.2.4. <code class="function">mpo_init_ifnet_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_ifnet_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被应用的新标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个新近实例化的网络接口初始化标记。可以睡眠。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-ipq"></a>6.7.2.5. <code class="function">mpo_init_ipq_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_ipq_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">flag</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">flag</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被应用的新标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>flag</code></em></td><td>睡眠/不睡眠 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a>; 参见下文</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个新近实例化的 IP 分片重组队列初始化标记。其中的<em class="parameter"><code>flag</code></em>域可能取<span class="symbol">M_WAITOK</span>
         或<span class="symbol">M_NOWAIT</span>之一，用来避免在该初始化调用中因为 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> 而进入睡眠。IP 分片重组队列的分配操作通常是在
	  对性能有严格要求的环境下进行的，因此实现代码必须小心地避免睡眠和长时间的操作。IP 分片重组队列分配操作失败时上述入口函数将失败返回。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-mbuf"></a>6.7.2.6. <code class="function">mpo_init_mbuf_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_mbuf_label</strong>(</code></td><td><var class="pdparam">flag</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>int <var class="pdparam">flag</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>flag</code></em></td><td>睡眠/不睡眠 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a>; 参见下文</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>将被初始化的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个新近实例化的 mbuf 数据包头部（<em class="parameter"><code>mbuf</code></em>）初始化标记。
          其中的<em class="parameter"><code>flag</code></em>的值可能取<span class="symbol">M_WAITOK</span>和<span class="symbol">M_NOWAIT</span>之一，
          用来避免在该初始化调用中因为 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> 而进入睡眠。Mbuf 头部的分配操作常常在对性能有严格要求的环境下被频繁执行，
          因此实现代码必须小心地避免睡眠和长时间的操作。上述入口函数在 Mbuf 头部分配操作失败时将失败返回。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-mount"></a>6.7.2.7. <code class="function">mpo_init_mount_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_mount_label</strong>(</code></td><td><var class="pdparam">mntlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">mntlabel</var></code>;<br /><code>struct label
              *<var class="pdparam">fslabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>mntlabel</code></em></td><td>将被初始化的mount 结构策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>将被初始化的文件系统策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个新近实例化的 mount 点初始化标记。可以睡眠。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-mount-fs-label"></a>6.7.2.8. <code class="function">mpo_init_mount_fs_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_mount_fs_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被初始化的标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个新近加载的文件系统初始化标记。可以睡眠。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-pipe-label"></a>6.7.2.9. <code class="function">mpo_init_pipe_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_pipe_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct
              label*<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被填写的标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个刚刚实例化的管道初始化安全标记。可以睡眠。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-socket"></a>6.7.2.10. <code class="function">mpo_init_socket_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_socket_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">flag</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">flag</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被初始化的新标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>flag</code></em></td><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> flags</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个刚刚实例化的套接字初始化安全标记。其中的 <em class="parameter"><code>flag</code></em> 域的值必须被指定为
        <span class="symbol">M_WAITOK</span>和<span class="symbol">M_NOWAIT</span>之一，以避免在该初始化程中使用可能睡眠的<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> 。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-socket-peer-label"></a>6.7.2.11. <code class="function">mpo_init_socket_peer_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_socket_peer_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">flag</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">flag</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被初始化的新标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>flag</code></em></td><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> flags</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为刚刚实例化的套接字对等体进行标记的初始化。其中的 <em class="parameter"><code>flag</code></em> 域的值必须被指定为
          <span class="symbol">M_WAITOK</span> 和 <span class="symbol">M_NOWAIT</span> 之一，以避免在该初始化程中使用可能睡眠的
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a>。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-proc-label"></a>6.7.2.12. <code class="function">mpo_init_proc_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_proc_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被初始化的新标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个刚刚实例化的进程初始化安全标记。可以睡眠。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-vnode"></a>6.7.2.13. <code class="function">mpo_init_vnode_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_init_vnode_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被初始化的新标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为一个刚刚实例化的 vnode 初始化安全标记。可以睡眠。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-bpfdesc"></a>6.7.2.14. <code class="function">mpo_destroy_bpfdesc_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_bpfdesc_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>bpfdesc 标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁一个 BPF 描述子上的标记。在该入口函数中，策略应当释放所有在内部分配与 <em class="parameter"><code>label</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-cred"></a>6.7.2.15. <code class="function">mpo_destroy_cred_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_cred_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被销毁的标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁一个信任状上的标记。在该入口函数中，策略应当释放所有在内部分配的与 <em class="parameter"><code>label</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-devfsdirent"></a>6.7.2.16. <code class="function">mpo_destroy_devfsdirent_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_devfsdirent_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被销毁的标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁一个 devfs 表项上的标记。在该入口函数中，策略应当释放所有在内部分配的与 <em class="parameter"><code>label</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-ifnet-label"></a>6.7.2.17. <code class="function">mpo_destroy_ifnet_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_ifnet_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被销毁的标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁与一个已删除接口相关联的标记。在该入口函数中，策略应当释放所有在内部分配的与 <em class="parameter"><code>label</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-ipq-label"></a>6.7.2.18. <code class="function">mpo_destroy_ipq_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_ipq_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被销毁的标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁与一个 IP 分片队列相关联的标记。在该入口函数中，策略应当释放所有在内部分配的与 <em class="parameter"><code>label</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-mbuf-label"></a>6.7.2.19. <code class="function">mpo_destroy_mbuf_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_mbuf_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被销毁的标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁与一个 Mbuf 相关联的标记。在该入口函数中，策略应当释放所有在内部分配的与 <em class="parameter"><code>label</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-mount-label"></a>6.7.2.20. <code class="function">mpo_destroy_mount_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_mount_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被销毁的 Mount 点标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁与一个 mount 点相关联的标记。在该入口函数中，策略应当释放所有在内部分配的与 <em class="parameter"><code>mntlabel</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-mount"></a>6.7.2.21. <code class="function">mpo_destroy_mount_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_mount_label</strong>(</code></td><td><var class="pdparam">mntlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">mntlabel</var></code>;<br /><code>struct label
              *<var class="pdparam">fslabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>mntlabel</code></em></td><td>将被销毁的 Mount 点标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>File system label being destroyed&gt;</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁与一个 mount 点相关联的标记。在该入口函数中，策略应当释放所有在内部分配的，与 <em class="parameter"><code>mntlabel</code></em>
          和<em class="parameter"><code>fslabel</code></em> 相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-socket"></a>6.7.2.22. <code class="function">mpo_destroy_socket_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_socket_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被销毁的套接字标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁与一个套接字相关联的标记。在该入口函数中，策略应当释放所有在内部分配的，与 <em class="parameter"><code>label</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-socket-peer-label"></a>6.7.2.23. <code class="function">mpo_destroy_socket_peer_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_socket_peer_label</strong>(</code></td><td><var class="pdparam">peerlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">peerlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>peerlabel</code></em></td><td>将被销毁的套接字对等实体标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁与一个套接字相关联的对等实体标记。在该入口函数中，策略应当释放所有在内部分配的，与 <em class="parameter"><code>label</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-pipe-label"></a>6.7.2.24. <code class="function">mpo_destroy_pipe_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_pipe_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>管道标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁一个管道的标记。在该入口函数中，策略应当释放所有在内部分配的，与 <em class="parameter"><code>label</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-proc-label"></a>6.7.2.25. <code class="function">mpo_destroy_proc_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_proc_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>进程标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁一个进程的标记。在该入口函数中，策略应当释放所有在内部分配的，与 <em class="parameter"><code>label</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-vnode-label"></a>6.7.2.26. <code class="function">mpo_destroy_vnode_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_destroy_vnode_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>进程标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>销毁一个 vnode 的标记。在该入口函数中，策略应当释放所有在内部分配的，与 <em class="parameter"><code>label</code></em>
          相关联的存储空间，以便销毁该标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-copy-mbuf-label"></a>6.7.2.27. <code class="function">mpo_copy_mbuf_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_copy_mbuf_label</strong>(</code></td><td><var class="pdparam">src</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dest</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">src</var></code>;<br /><code>struct label
              *<var class="pdparam">dest</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>src</code></em></td><td>源标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dest</code></em></td><td>目标标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>将 <em class="parameter"><code>src</code></em> 中的标记信息拷贝到 <em class="parameter"><code>dest</code></em>中。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-copy-pipe-label"></a>6.7.2.28. <code class="function">mpo_copy_pipe_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_copy_pipe_label</strong>(</code></td><td><var class="pdparam">src</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dest</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">src</var></code>;<br /><code>struct label
              *<var class="pdparam">dest</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>src</code></em></td><td>源标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dest</code></em></td><td>目标标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>将 <em class="parameter"><code>src</code></em> 中的标记信息拷贝至 <em class="parameter"><code>dest</code></em>。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-copy-vnode-label"></a>6.7.2.29. <code class="function">mpo_copy_vnode_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_copy_vnode_label</strong>(</code></td><td><var class="pdparam">src</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dest</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
              *<var class="pdparam">src</var></code>;<br /><code>struct label
              *<var class="pdparam">dest</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>src</code></em></td><td>源标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dest</code></em></td><td>目标标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>将 <em class="parameter"><code>src</code></em> 中的标记信息拷贝至 <em class="parameter"><code>dest</code></em>。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-cred-label"></a>6.7.2.30. <code class="function">mpo_externalize_cred_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_externalize_cred_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将用外部形式表示的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>需要外部表示标记的策略的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>用来存放标记的文本表示形式的字符buffer</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>如果可以填充element_data 域，则其数值递增</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的标记结构，产生一个以外部形式表示的标记。
    一个外部形式标记，是标记内容的文本表示，它由用户级的应用程序使用，是用户可读的。
    目前的MAC实现方案将依次调用策略的相应入口函数，因此，
    具体策略的实现代码，需要在填写sb之前，先检查element_name中指定的名字。
    如果element_name中的内容与你的策略名字不相符，则直接返回0。
    仅当转换标记数据的过程中出现错误时，才返回非0值。
    一旦策略决定填写element_data，递增*claim的数值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-ifnet-label"></a>6.7.2.31. <code class="function">mpo_externalize_ifnet_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_externalize_ifnet_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将用外部形式表示的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>需要外部表示标记的策略的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>用来存放标记的文本表示形式的字符buffer</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>如果可以填充element_data 域，则其数值递增</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的标记结构，产生一个以外部形式表示的标记。
    一个外部形式标记，是标记内容的文本表示，它由用户级的应用程序使用，是用户可读的。
    目前的MAC实现方案将依次调用策略的相应入口函数，因此，
    具体策略的实现代码，需要在填写sb之前，先检查element_name中指定的名字。
    如果element_name中的内容与你的策略名字不相符，则直接返回0。
    仅当转换标记数据的过程中出现错误时，才返回非0值。
    一旦策略决定填写element_data，递增*claim的数值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-pipe-label"></a>6.7.2.32. <code class="function">mpo_externalize_pipe_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_externalize_pipe_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将用外部形式表示的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>需要外部表示标记的策略的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>用来存放标记的文本表示形式的字符buffer</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>如果可以填充element_data 域，则其数值递增</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的标记结构，产生一个以外部形式表示的标记。
    一个外部形式标记，是标记内容的文本表示，它由用户级的应用程序使用，是用户可读的。
    目前的MAC实现方案将依次调用策略的相应入口函数，因此，
    具体策略的实现代码，需要在填写sb之前，先检查element_name中指定的名字。
    如果element_name中的内容与你的策略名字不相符，则直接返回0。
    仅当转换标记数据的过程中出现错误时，才返回非0值。
    一旦策略决定填写element_data，递增*claim的数值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-socket-label"></a>6.7.2.33. <code class="function">mpo_externalize_socket_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_externalize_socket_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将用外部形式表示的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>需要外部表示标记的策略的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>用来存放标记的文本表示形式的字符buffer</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>如果可以填充element_data 域，则其数值递增</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的标记结构，产生一个以外部形式表示的标记。
    一个外部形式标记，是标记内容的文本表示，它由用户级的应用程序使用，是用户可读的。
    目前的MAC实现方案将依次调用策略的相应入口函数，因此，
    具体策略的实现代码，需要在填写sb之前，先检查element_name中指定的名字。
    如果element_name中的内容与你的策略名字不相符，则直接返回0。
    仅当转换标记数据的过程中出现错误时，才返回非0值。
    一旦策略决定填写element_data，递增*claim的数值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-socket-peer-label"></a>6.7.2.34. <code class="function">mpo_externalize_socket_peer_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_externalize_socket_peer_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将用外部形式表示的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>需要外部表示标记的策略的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>用来存放标记的文本表示形式的字符buffer</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>如果可以填充element_data 域，则其数值递增</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的标记结构，产生一个以外部形式表示的标记。
    一个外部形式标记，是标记内容的文本表示，它由用户级的应用程序使用，是用户可读的。
    目前的MAC实现方案将依次调用策略的相应入口函数，因此，
    具体策略的实现代码，需要在填写sb之前，先检查element_name中指定的名字。
    如果element_name中的内容与你的策略名字不相符，则直接返回0。
    仅当转换标记数据的过程中出现错误时，才返回非0值。
    一旦策略决定填写element_data，递增*claim的数值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-vnode-label"></a>6.7.2.35. <code class="function">mpo_externalize_vnode_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_externalize_vnode_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将用外部形式表示的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>需要外部表示标记的策略的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>用来存放标记的文本表示形式的字符buffer</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>如果可以填充element_data 域，则其数值递增</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的标记结构，产生一个以外部形式表示的标记。
    一个外部形式标记，是标记内容的文本表示，它由用户级的应用程序使用，是用户可读的。
    目前的MAC实现方案将依次调用策略的相应入口函数，因此，
    具体策略的实现代码，需要在填写sb之前，先检查element_name中指定的名字。
    如果element_name中的内容与你的策略名字不相符，则直接返回0。
    仅当转换标记数据的过程中出现错误时，才返回非0值。
    一旦策略决定填写element_data，递增*claim的数值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-internalize-cred-label"></a>6.7.2.36. <code class="function">mpo_internalize_cred_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_internalize_cred_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_data</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>char *<var class="pdparam">element_data</var></code>;<br /><code>int *<var class="pdparam">claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被填充的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>需要内部表示标记的策略的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_data</code></em></td><td>需要被转换的文本数据</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>如果数据被正确转换，则其数值递增</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据一个文本形式的外部表示标记数据，创建一个内部形式的标记结构。
    目前的MAC方案将依次调用所有策略的相关入口函数，来响应标记的内部转换请求，
    因此，实现代码必须首先通过比较element_name中的内容和自己的策略名字，
    来确定是否需要转换element_data中存放的数据。
    类似的，如果名字不匹配或者数据转换操作成功，该函数返回0，并递增*claimed的值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-internalize-ifnet-label"></a>6.7.2.37. <code class="function">mpo_internalize_ifnet_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_internalize_ifnet_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_data</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>char *<var class="pdparam">element_data</var></code>;<br /><code>int *<var class="pdparam">claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被填充的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>需要内部表示标记的策略的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_data</code></em></td><td>需要被转换的文本数据</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>如果数据被正确转换，则其数值递增</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据一个文本形式的外部表示标记数据，创建一个内部形式的标记结构。
    目前的MAC方案将依次调用所有策略的相关入口函数，来响应标记的内部转换请求，
    因此，实现代码必须首先通过比较element_name中的内容和自己的策略名字，
    来确定是否需要转换element_data中存放的数据。
    类似的，如果名字不匹配或者数据转换操作成功，该函数返回0，并递增*claimed的值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-internalize-pipe-label"></a>6.7.2.38. <code class="function">mpo_internalize_pipe_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_internalize_pipe_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_data</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>char *<var class="pdparam">element_data</var></code>;<br /><code>int *<var class="pdparam">claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被填充的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>需要内部表示标记的策略的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_data</code></em></td><td>需要被转换的文本数据</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>如果数据被正确转换，则其数值递增</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据一个文本形式的外部表示标记数据，创建一个内部形式的标记结构。
    目前的MAC方案将依次调用所有策略的相关入口函数，来响应标记的内部转换请求，
    因此，实现代码必须首先通过比较element_name中的内容和自己的策略名字，
    来确定是否需要转换element_data中存放的数据。
    类似的，如果名字不匹配或者数据转换操作成功，该函数返回0，并递增*claimed的值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-internalize-socket-label"></a>6.7.2.39. <code class="function">mpo_internalize_socket_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_internalize_socket_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_data</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>char *<var class="pdparam">element_data</var></code>;<br /><code>int *<var class="pdparam">claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被填充的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>需要内部表示标记的策略的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_data</code></em></td><td>需要被转换的文本数据</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>如果数据被正确转换，则其数值递增</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据一个文本形式的外部表示标记数据，创建一个内部形式的标记结构。
    目前的MAC方案将依次调用所有策略的相关入口函数，来响应标记的内部转换请求，
    因此，实现代码必须首先通过比较element_name中的内容和自己的策略名字，
    来确定是否需要转换element_data中存放的数据。
    类似的，如果名字不匹配或者数据转换操作成功，该函数返回0，并递增*claimed的值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-internalize-vnode-label"></a>6.7.2.40. <code class="function">mpo_internalize_vnode_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_internalize_vnode_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_data</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>char *<var class="pdparam">element_data</var></code>;<br /><code>int *<var class="pdparam">claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>将被填充的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>需要内部表示标记的策略的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_data</code></em></td><td>需要被转换的文本数据</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>如果数据被正确转换，则其数值递增</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据一个文本形式的外部表示标记数据，创建一个内部形式的标记结构。
    目前的MAC方案将依次调用所有策略的相关入口函数，来响应标记的内部转换请求，
    因此，实现代码必须首先通过比较element_name中的内容和自己的策略名字，
    来确定是否需要转换element_data中存放的数据。
    类似的，如果名字不匹配或者数据转换操作成功，该函数返回0，并递增*claimed的值。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-label-events"></a>6.7.3. 标记事件</h3></div></div></div><p>策略模块使用MAC 框架提供的“标记事件”类入口函数，对内核对象的标记进行操作。策略模块将感兴趣的被标记内核对象的相关生命周期事件
        注册在恰当的入口点上。对象的初始化、创建和销毁事件均提供了钩子点。在某些对象上还可以实现重新标记，即，允许用户进程改变对象上的标记值。
        对某些对象可以实现其特定的对象事件，比如与 IP 重组相关的标记事件。一个典型的被标记对象在其生命周期中将拥有下列入口函数：</p><pre class="programlisting">标记初始化                     o
（对象相关的等待）              \
标记创建                         o
                                  \
重新标记事件，                     o--&lt;--.
各种对象相关的，                   |     |
访问控制事件                       ~--&gt;--o
                                          \
标记销毁                                   o</pre><p>使用标记初始化入口函数，策略可以以一种统一的、与对象使用环境无关的方式设置标记的初始值。
        分配给一个策略的缺省 slot 值为0，这样不使用标记的策略可能并不需要执行专门的初始化操作。</p><p>标记的创建事件发生在将一个内核数据结构同一个真实的内核对象相关联（内核对象实例化）的时刻。
        例如，在真正被使用之前，在一个缓冲池内已分配的 mbuf 数据结构，将保持为“未使用”状态。
        因此，mbuf 的分配操作将导致针对该 mbuf 的标记初始化操作，而 mbuf 的创建操作则被推迟到该 mbuf 真正与一个数据报相关联的时刻。
        通常，调用者将会提供创建事件的上下文，包括创建环境、创建过程中涉及的其他对象的标记等。例如，当一个套接字创建一个 mbuf 时，
        除了新创建的 mbuf 及其标记之外，作为创建者的套接字与其标记也被提交给策略检查。
        不提倡在创建对象时就为其分配内存的原因有两个：创建操作可能发生在对性能有严格要求的内核接口上；
        而且，因为创建调用不允许失败，所以无法报告内存分配失败。</p><p>对象特有的事件一般不会引发其他的标记事件，但是在对象上下文发生改变时，策略使用它们可以对相关标记进行修改或更新操作。
        例如，在<span class="symbol">MAC_UPDATE_IPQ</span> 入口函数之内，某个 IP 分片重组队列的标记可能会因为队列中接收了新的 mbuf 而被更新。</p><p>访问控制事件将在后续章节中详细讨论。</p><p>策略通过执行标记销毁操作，释放为其分配的存储空间或维护的状态，之后内核才可以重用或者释放对象的内核数据结构。</p><p>除了与特定内核对象绑定的普通标记之外，还有一种额外的标记类型：临时标记。这些标记用于存放由用户进程提交的更新信息。
        它们的初始化和销毁操作与其他标记一样，只是创建事件，<span class="symbol">MAC_INTERNALIZE</span>，略有不同：
        该函数接受用户提交的标记，负责将其转化为内核表示形式。 </p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-fs-label-event-ops"></a>6.7.3.1. 文件系统对象标记事件操作</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-associate-vnode-devfs"></a>6.7.3.1.1. <code class="function">mpo_associate_vnode_devfs</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_associate_vnode_devfs</strong>(</code></td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">de</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">delabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mount
                *<var class="pdparam">mp</var></code>;<br /><code>struct label
                *<var class="pdparam">fslabel</var></code>;<br /><code>struct devfs_dirent
                *<var class="pdparam">de</var></code>;<br /><code>struct label
                *<var class="pdparam">delabel</var></code>;<br /><code>struct vnode
                *<var class="pdparam">vp</var></code>;<br /><code>struct label
                *<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>mp</code></em></td><td>Devfs 挂载点</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>Devfs 文件系统标记
                    (<code class="varname">mp-&gt;mnt_fslabel</code>)</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>de</code></em></td><td>Devfs 目录项</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>delabel</code></em></td><td>与 <em class="parameter"><code>de</code></em> 相关联的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>与 <em class="parameter"><code>de</code></em> 相关联的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>与 <em class="parameter"><code>vp</code></em> 相关联的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据参数 <em class="parameter"><code>de</code></em> 传入的 devfs 目录项及其标记信息，为一个新近创建的
             devfs vnode 填充标记（<em class="parameter"><code>vlabel</code></em>）。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-associate-vnode-extattr"></a>6.7.3.1.2. <code class="function">mpo_associate_vnode_extattr</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
                <strong class="fsfunc">mpo_associate_vnode_extattr</strong>(</code></td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mount
                *<var class="pdparam">mp</var></code>;<br /><code>struct label
                *<var class="pdparam">fslabel</var></code>;<br /><code>struct vnode
                *<var class="pdparam">vp</var></code>;<br /><code>struct label
                *<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>mp</code></em></td><td>文件系统挂载点</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>文件系统标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>将被标记的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>与 <em class="parameter"><code>vp</code></em> 相关联的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>从文件系统扩展属性中读取 <em class="parameter"><code>vp</code></em> 的标记。成功，返回 <code class="literal">0</code>。
            不成功，则在 <code class="varname">errno</code> 指定的相应的错误编码。
            如果文件系统不支持扩展属性的读取操作，则可以考虑将 <em class="parameter"><code>fslabel</code></em> 拷贝至 <em class="parameter"><code>vlabel</code></em>。
            </p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-associate-vnode-singlelabel"></a>6.7.3.1.3. <code class="function">mpo_associate_vnode_singlelabel</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_associate_vnode_singlelabel</strong>(</code></td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mount
                *<var class="pdparam">mp</var></code>;<br /><code>struct label
                *<var class="pdparam">fslabel</var></code>;<br /><code>struct vnode
                *<var class="pdparam">vp</var></code>;<br /><code>struct label
                *<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>mp</code></em></td><td>文件系统挂载点</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>文件系统标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>将被标记的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>与 <em class="parameter"><code>vp</code></em> 相关联的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>在非多重标记文件系统上，使用该入口函数，根据文件系统标记，<em class="parameter"><code>fslabel</code></em>，
            为 <em class="parameter"><code>vp</code></em> 设置策略标记。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-devfs-device"></a>6.7.3.1.4. <code class="function">mpo_create_devfs_device</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_devfs_device</strong>(</code></td><td><var class="pdparam">dev</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">devfs_dirent</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>dev_t <var class="pdparam">dev</var></code>;<br /><code>struct devfs_dirent
                *<var class="pdparam">devfs_dirent</var></code>;<br /><code>struct label
                *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>dev</code></em></td><td><em class="parameter"><code>devfs_dirent</code></em> 对应的设备</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>devfs_dirent</code></em></td><td>将被标记的 Devfs 目录项</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>将被填写的 <em class="parameter"><code>devfs_dirent</code></em> 标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为传入设备新建的 devfs_dirent 填写标记。该函数将在设备文件系统加载、重构或添加新设备时被调用。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-devfs-directory"></a>6.7.3.1.5. <code class="function">mpo_create_devfs_directory</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_devfs_directory</strong>(</code></td><td><var class="pdparam">dirname</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dirnamelen</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">devfs_dirent</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>char *<var class="pdparam">dirname</var></code>;<br /><code>int <var class="pdparam">dirnamelen</var></code>;<br /><code>struct devfs_dirent
                *<var class="pdparam">devfs_dirent</var></code>;<br /><code>struct label
                *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>dirname</code></em></td><td>新建目录的名字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>namelen</code></em></td><td>字符串 <em class="parameter"><code>dirname</code></em> 的长度</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>devfs_dirent</code></em></td><td>新建目录在 Devfs 中对应的目录项</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为传入目录参数的新建 devfs_dirent 填写标记。该函数将在加载、重构设备文件系统，或者添加一个需要指定目录结构的新设备时被调用。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-devfs-symlink"></a>6.7.3.1.6. <code class="function">mpo_create_devfs_symlink</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_devfs_symlink</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dd</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ddlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">de</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">delabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct mount
                *<var class="pdparam">mp</var></code>;<br /><code>struct devfs_dirent
                *<var class="pdparam">dd</var></code>;<br /><code>struct label
                *<var class="pdparam">ddlabel</var></code>;<br /><code>struct devfs_dirent
                *<var class="pdparam">de</var></code>;<br /><code>struct label
                *<var class="pdparam">delabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mp</code></em></td><td>devfs 挂载点</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dd</code></em></td><td>链接目标</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ddlabel</code></em></td><td>与 <em class="parameter"><code>dd</code></em> 相关联的标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>de</code></em></td><td>符号链接项</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>delabel</code></em></td><td>与 <em class="parameter"><code>de</code></em> 相关联的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为新近创建的 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">devfs</span>(5)</span></a> 符号链接项填写标记（<em class="parameter"><code>delabel</code></em>）。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-vnode-extattr"></a>6.7.3.1.7. <code class="function">mpo_create_vnode_extattr</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
                <strong class="fsfunc">mpo_create_vnode_extattr</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct mount
                *<var class="pdparam">mp</var></code>;<br /><code>struct label
                *<var class="pdparam">fslabel</var></code>;<br /><code>struct vnode
                *<var class="pdparam">dvp</var></code>;<br /><code>struct label
                *<var class="pdparam">dlabel</var></code>;<br /><code>struct vnode
                *<var class="pdparam">vp</var></code>;<br /><code>struct label
                *<var class="pdparam">vlabel</var></code>;<br /><code>struct componentname
                *<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mount</code></em></td><td>文件系统挂载点</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>文件系统标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>父目录 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>与 <em class="parameter"><code>dvp</code></em> 相关联的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>新创建的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>与 <em class="parameter"><code>vp</code></em> 相关联的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td><em class="parameter"><code>vp</code></em>中的子域名字</td><td class="auto-generated"> </td></tr></tbody></table></div><p>将 <em class="parameter"><code>vp</code></em> 的标记写入文件扩展属性。成功，将标记填入 <em class="parameter"><code>vlabel</code></em>，
            并返回 <span class="returnvalue">0</span>。否则，返回对应的错误编码。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mount"></a>6.7.3.1.8. <code class="function">mpo_create_mount</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_mount</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mnt</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct mount
                *<var class="pdparam">mp</var></code>;<br /><code>struct label
                *<var class="pdparam">mnt</var></code>;<br /><code>struct label
                *<var class="pdparam">fslabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mp</code></em></td><td>客体；将被挂载的文件系统</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mntlabel</code></em></td><td>将被填写的 <em class="parameter"><code>mp</code></em> 的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>将被挂载到 <em class="parameter"><code>mp</code></em> 的文件系统的策略标记。</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为传入的主体信任状所创建的挂载点填写标记。该函数将在文件系统挂载时被调用。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-root-mount"></a>6.7.3.1.9. <code class="function">mpo_create_root_mount</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_root_mount</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mntlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct mount
                *<var class="pdparam">mp</var></code>;<br /><code>struct label
                *<var class="pdparam">mntlabel</var></code>;<br /><code>struct label
                *<var class="pdparam">fslabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td colspan="3">见 <a class="xref" href="mac-entry-point-reference.html#mac-mpo-create-mount" title="6.7.3.1.8. mpo_create_mount">第 6.7.3.1.8 节 “<code class="function">mpo_create_mount</code>”</a>.</td></tr></tbody></table></div><p>为传入的主体信任状所创建的挂载点填写标记。该函数将在挂载根文件系统时，mpo_create_mount; 之后被调用。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-relabel-vnode"></a>6.7.3.1.10. <code class="function">mpo_relabel_vnode</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_relabel_vnode</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vnodelabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
                *<var class="pdparam">vp</var></code>;<br /><code>struct label
                *<var class="pdparam">vnodelabel</var></code>;<br /><code>struct label
                *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>将被重新标记的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vnodelabel</code></em></td><td><em class="parameter"><code>vp</code></em> 现有的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>将取代<em class="parameter"><code>vnodelabel</code></em>的新（可能只是部分）标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的新标记和主体信任状，更新参数 vnode 的标记。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-setlabel-vnode-extattr"></a>6.7.3.1.11. <code class="function">mpo_setlabel_vnode_extattr</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
                <strong class="fsfunc">mpo_setlabel_vnode_extattr</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">intlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
                *<var class="pdparam">vp</var></code>;<br /><code>struct label
                *<var class="pdparam">vlabel</var></code>;<br /><code>struct label
                *<var class="pdparam">intlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>写出标记所对应的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>intlabel</code></em></td><td>将被写入磁盘的标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>将参数 <em class="parameter"><code>intlabel</code></em> 给出的标记信息写入指定 vnode 的扩展属性。
             该函数被 <code class="function">vop_stdcreatevnode_ea</code> 所调用。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-update-devfsdirent"></a>6.7.3.1.12. <code class="function">mpo_update_devfsdirent</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_update_devfsdirent</strong>(</code></td><td><var class="pdparam">devfs_dirent</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">direntlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vnodelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct devfs_dirent
                *<var class="pdparam">devfs_dirent</var></code>;<br /><code>struct label
                *<var class="pdparam">direntlabel</var></code>;<br /><code>struct vnode
                *<var class="pdparam">vp</var></code>;<br /><code>struct label
                *<var class="pdparam">vnodelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>devfs_dirent</code></em></td><td>客体；devfs 目录项</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>direntlabel</code></em></td><td>将被更新的<em class="parameter"><code>devfs_dirent</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>父 vnode</td><td>已锁定</td></tr><tr><td><em class="parameter"><code>vnodelabel</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据所传入的 devfs vnode 标记，对 <em class="parameter"><code>devfs_dirent</code></em> 的标记进行更新。
            重新标记一个 devfs vnode 的操作成功之后，将调用该函数来确认标记的改变，如此，即使相应的 vnode 数据结构被内核回收重用，
            也不会丢失标记的新状态。另外，在 devfs 中新建一个符号链接时，紧接着<code class="function">mac_vnode_create_from_vnode</code>，
            也将调用该函数，对 vnode 标记进行初始化操作。</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-ipc-label-ops"></a>6.7.3.2. IPC 对象标记事件操作</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-from-socket"></a>6.7.3.2.1. <code class="function">mpo_create_mbuf_from_socket</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_mbuf_from_socket</strong>(</code></td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">m</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct socket
                *<var class="pdparam">so</var></code>;<br /><code>struct label
                *<var class="pdparam">socketlabel</var></code>;<br /><code>struct mbuf *<var class="pdparam">m</var></code>;<br /><code>struct label
                *<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>socket</code></em></td><td>套接字</td><td>套接字锁定 WIP</td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td><em class="parameter"><code>socket</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>m</code></em></td><td>客体；mbuf</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>将被填写的 <em class="parameter"><code>m</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的套接字标记为新创建的mbuf头部设置标记。
            每当套接字产生一个新的数据报或者消息，并将其存储在参数 mbuf 中时，将调用该函数。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-pipe"></a>6.7.3.2.2. <code class="function">mpo_create_pipe</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_pipe</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
                *<var class="pdparam">pipe</var></code>;<br /><code>struct label
                *<var class="pdparam">pipelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>管道</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td><em class="parameter"><code>pipe</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的主体信任状参数，设置新建管道的标记。每当一个新管道被创建，该函数将被调用。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-socket"></a>6.7.3.2.3. <code class="function">mpo_create_socket</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_socket</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct socket
                *<var class="pdparam">so</var></code>;<br /><code>struct label
                *<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td>不可改变</td></tr><tr><td><em class="parameter"><code>so</code></em></td><td>客体；将被标记的套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td>将被填写的 <em class="parameter"><code>so</code></em> 的标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的主体信任状参数，设置新建套接字的标记。每当新建一个套接字，该函数将被调用。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-socket-from-socket"></a>6.7.3.2.4. <code class="function">mpo_create_socket_from_socket</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_socket_from_socket</strong>(</code></td><td><var class="pdparam">oldsocket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldsocketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newsocket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newsocketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct socket
                *<var class="pdparam">oldsocket</var></code>;<br /><code>struct label
                *<var class="pdparam">oldsocketlabel</var></code>;<br /><code>struct socket
                *<var class="pdparam">newsocket</var></code>;<br /><code>struct label
                *<var class="pdparam">newsocketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>oldsocket</code></em></td><td>监听套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldsocketlabel</code></em></td><td><em class="parameter"><code>oldsocket</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newsocket</code></em></td><td>新建套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newsocketlabel</code></em></td><td><em class="parameter"><code>newsocket</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=listen&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">listen</span>(2)</span></a> 套接字 <em class="parameter"><code>oldsocket</code></em>，
            为新建 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=accept&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a> 的套接字 <em class="parameter"><code>newsocket</code></em>，设置标记。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-relabel-pipe"></a>6.7.3.2.5. <code class="function">mpo_relabel_pipe</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_relabel_pipe</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
                *<var class="pdparam">pipe</var></code>;<br /><code>struct label
                *<var class="pdparam">oldlabel</var></code>;<br /><code>struct label
                *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>管道</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldlabel</code></em></td><td><em class="parameter"><code>pipe</code></em> 的当前策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>将为<em class="parameter"><code>pipe</code></em> 设置的新的策略标记 </td><td class="auto-generated"> </td></tr></tbody></table></div><p>为<em class="parameter"><code>pipe</code></em>设置新标记<em class="parameter"><code>newlabel</code></em>。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-relabel-socket"></a>6.7.3.2.6. <code class="function">mpo_relabel_socket</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_relabel_socket</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct socket
                *<var class="pdparam">so</var></code>;<br /><code>struct label
                *<var class="pdparam">oldlabel</var></code>;<br /><code>struct label
                *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td>不可改变</td></tr><tr><td><em class="parameter"><code>so</code></em></td><td>客体；套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldlabel</code></em></td><td><em class="parameter"><code>so</code></em> 的当前标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>将为<em class="parameter"><code>socket</code></em> 设置的新标记 </td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的标记参数，对套接字的当前标记进行更新。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mpo-set-socket-peer-from-mbuf"></a>6.7.3.2.7. <code class="function">mpo_set_socket_peer_from_mbuf</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_set_socket_peer_from_mbuf</strong>(</code></td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
                *<var class="pdparam">mbuf</var></code>;<br /><code>struct label
                *<var class="pdparam">mbuflabel</var></code>;<br /><code>struct label
                *<var class="pdparam">oldlabel</var></code>;<br /><code>struct label
                *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>mbuf</code></em></td><td>从套接字接收到的第一个数据报</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td><em class="parameter"><code>mbuf</code></em> 的标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldlabel</code></em></td><td>套接字的当前标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>将为套接字填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的 mbuf 标记，设置某个 stream 套接字的对等标志。
            除Unix域的套接字之外，每当一个 stream 套接字接收到第一个数据报时，该函数将被调用。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-set-socket-peer-from-socket"></a>6.7.3.2.8. <code class="function">mpo_set_socket_peer_from_socket</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_set_socket_peer_from_socket</strong>(</code></td><td><var class="pdparam">oldsocket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldsocketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newsocket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newsocketpeerlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct socket
                *<var class="pdparam">oldsocket</var></code>;<br /><code>struct label
                *<var class="pdparam">oldsocketlabel</var></code>;<br /><code>struct socket
                *<var class="pdparam">newsocket</var></code>;<br /><code>struct label
                *<var class="pdparam">newsocketpeerlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>oldsocket</code></em></td><td>本地套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldsocketlabel</code></em></td><td><em class="parameter"><code>oldsocket</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newsocket</code></em></td><td>对等套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newsocketpeerlabel</code></em></td><td>将为<em class="parameter"><code>newsocket</code></em>填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的远程套接字端点，为一个 stream UNIX 与套接字设置对等标记。
            每当相应的套接字对之间进行连接时，该函数将在两端分别被调用。</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-net-labeling-event-ops"></a>6.7.3.3. Network Object Labeling Event Operations</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-bpfdesc"></a>6.7.3.3.1. <code class="function">mpo_create_bpfdesc</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_bpfdesc</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">bpf_d</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">bpflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct bpf_d
                *<var class="pdparam">bpf_d</var></code>;<br /><code>struct label
                *<var class="pdparam">bpflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td>不可改变</td></tr><tr><td><em class="parameter"><code>bpf_d</code></em></td><td>客体；bpf 描述子</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>bpf</code></em></td><td>将为<em class="parameter"><code>bpf_d</code></em>填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的主体信任状参数，为新建的 BPF 描述子设置标记。
            当进程打开 BPF 设备节点时，该函数将被调用。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-ifnet"></a>6.7.3.3.2. <code class="function">mpo_create_ifnet</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_ifnet</strong>(</code></td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ifnet
                *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
                *<var class="pdparam">ifnetlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>ifnet</code></em></td><td>网络接口</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td>将为<em class="parameter"><code>ifnet</code></em>填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为新建的网络接口设置标记。该函数在以下情况下被调用：
            当一个新的物理接口变为可用时，或者当一个伪接口在引导时或由于某个用户操作而实例化时。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-ipq"></a>6.7.3.3.3. <code class="function">mpo_create_ipq</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_ipq</strong>(</code></td><td><var class="pdparam">fragment</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fragmentlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipq</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipqlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
                *<var class="pdparam">fragment</var></code>;<br /><code>struct label
                *<var class="pdparam">fragmentlabel</var></code>;<br /><code>struct ipq
                *<var class="pdparam">ipq</var></code>;<br /><code>struct label
                *<var class="pdparam">ipqlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>fragment</code></em></td><td>第一个被接收的 IP 分片</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fragmentlabel</code></em></td><td><em class="parameter"><code>fragment</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipq</code></em></td><td>将被标记的 IP 重组队列</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipqlabel</code></em></td><td>将为<em class="parameter"><code>ipq</code></em>填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据第一个接收到的分片的 mbuf 头部信息，为新建的 IP 分片重组队列设置标记。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-datagram-from-ipq"></a>6.7.3.3.4. <code class="function">mpo_create_datagram_from_ipq</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_create_datagram_from_ipq</strong>(</code></td><td><var class="pdparam">ipq</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipqlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">datagram</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">datagramlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ipq
                *<var class="pdparam">ipq</var></code>;<br /><code>struct label
                *<var class="pdparam">ipqlabel</var></code>;<br /><code>struct mbuf
                *<var class="pdparam">datagram</var></code>;<br /><code>struct label
                *<var class="pdparam">datagramlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>ipq</code></em></td><td>IP 重组队列</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipqlabel</code></em></td><td><em class="parameter"><code>ipq</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>datagram</code></em></td><td>将被标记的数据报</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>datagramlabel</code></em></td><td>将为<em class="parameter"><code>datagramlabel</code></em>填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据 IP 分片重组队列，为刚刚重组完毕的 IP 数据报设置标记。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-fragment"></a>6.7.3.3.5. <code class="function">mpo_create_fragment</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_fragment</strong>(</code></td><td><var class="pdparam">datagram</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">datagramlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fragment</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fragmentlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
                *<var class="pdparam">datagram</var></code>;<br /><code>struct label
                *<var class="pdparam">datagramlabel</var></code>;<br /><code>struct mbuf
                *<var class="pdparam">fragment</var></code>;<br /><code>struct label
                *<var class="pdparam">fragmentlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>datagram</code></em></td><td>数据报</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>datagramlabel</code></em></td><td><em class="parameter"><code>datagram</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fragment</code></em></td><td>将被标记的分片</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fragmentlabel</code></em></td><td>将为<em class="parameter"><code>datagram</code></em>填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据数据报所对应的 mbuf 头部信息，为其新建的分片的 mbuf 头部设置标记。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-from-mbuf"></a>6.7.3.3.6. <code class="function">mpo_create_mbuf_from_mbuf</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_mbuf_from_mbuf</strong>(</code></td><td><var class="pdparam">oldmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldmbuflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
                *<var class="pdparam">oldmbuf</var></code>;<br /><code>struct label
                *<var class="pdparam">oldmbuflabel</var></code>;<br /><code>struct mbuf
                *<var class="pdparam">newmbuf</var></code>;<br /><code>struct label
                *<var class="pdparam">newmbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>oldmbuf</code></em></td><td>已有的（源）mbuf</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldmbuflabel</code></em></td><td><em class="parameter"><code>oldmbuf</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuf</code></em></td><td>将被标记的新建 mbuf</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuflabel</code></em></td><td>将为<em class="parameter"><code>newmbuf</code></em>填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据某个现有数据报的 mbuf 头部信息，为新建数据报的 mbuf 头部设置标记。在许多条件下将会调用该函数，
            比如，由于对齐要求而重新分配某个 mbuf 时。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-linklayer"></a>6.7.3.3.7. <code class="function">mpo_create_mbuf_linklayer</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_mbuf_linklayer</strong>(</code></td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ifnet
                *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
                *<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct mbuf
                *<var class="pdparam">mbuf</var></code>;<br /><code>struct label
                *<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>ifnet</code></em></td><td>网络接口</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td><em class="parameter"><code>ifnet</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuf</code></em></td><td>新建数据报的 mbuf 头部</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>将为<em class="parameter"><code>mbuf</code></em>填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为在给定接口上由于某个链路层响应而新建的数据报的mbuf头部设置标记。
            该函数将在若干条件下被调用，比如当IPv4和IPv6协议栈在响应ARP或者ND6时。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-from-bpfdesc"></a>6.7.3.3.8. <code class="function">mpo_create_mbuf_from_bpfdesc</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_mbuf_from_bpfdesc</strong>(</code></td><td><var class="pdparam">bpf_d</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">bpflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct bpf_d
                *<var class="pdparam">bpf_d</var></code>;<br /><code>struct label
                *<var class="pdparam">bpflabel</var></code>;<br /><code>struct mbuf
                *<var class="pdparam">mbuf</var></code>;<br /><code>struct label
                *<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>bpf_d</code></em></td><td>BPF 描述子</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>bpflabel</code></em></td><td><em class="parameter"><code>bpflabel</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuf</code></em></td><td>将被标记的新建 mbuf</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>将为<em class="parameter"><code>mbuf</code></em>填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为使用参数 BPF 描述子创建的新数据报的 mbuf 头部设置标记。
            当对参数 BPF 描述子所关联的 BPF 设备进行写操作时，该函数将被调用。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-from-ifnet"></a>6.7.3.3.9. <code class="function">mpo_create_mbuf_from_ifnet</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_mbuf_from_ifnet</strong>(</code></td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ifnet
                *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
                *<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct mbuf
                *<var class="pdparam">mbuf</var></code>;<br /><code>struct label
                *<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>ifnet</code></em></td><td>网络接口</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td><em class="parameter"><code>ifnetlabel</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuf</code></em></td><td>新建数据报的 mbuf 头部</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>将为<em class="parameter"><code>mbuf</code></em>填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为从网络接口参数创建的数据报的 mbuf 头部设置标记。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-multicast-encap"></a>6.7.3.3.10. <code class="function">mpo_create_mbuf_multicast_encap</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_mbuf_multicast_encap</strong>(</code></td><td><var class="pdparam">oldmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldmbuflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
                *<var class="pdparam">oldmbuf</var></code>;<br /><code>struct label
                *<var class="pdparam">oldmbuflabel</var></code>;<br /><code>struct ifnet
                *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
                *<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct mbuf
                *<var class="pdparam">newmbuf</var></code>;<br /><code>struct label
                *<var class="pdparam">newmbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>oldmbuf</code></em></td><td>现有数据报的 mbuf 头部</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldmbuflabel</code></em></td><td><em class="parameter"><code>oldmbuf</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>网络接口</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td><em class="parameter"><code>ifnet</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuf</code></em></td><td>将被标记的新建数据报 mbuf 头部</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuflabel</code></em></td><td>将为<em class="parameter"><code>newmbuf</code></em>填写的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>当传入的已有数据报被给定多播封装接口（multicast encapsulation interface）处理时被调用，
            为新创建的数据报所在 mbuf 头部设置标记。
            每当使用该虚拟接口传递一个mbuf时，将调用该函数。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-netlayer"></a>6.7.3.3.11. <code class="function">mpo_create_mbuf_netlayer</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_mbuf_netlayer</strong>(</code></td><td><var class="pdparam">oldmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldmbuflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
                *<var class="pdparam">oldmbuf</var></code>;<br /><code>struct label
                *<var class="pdparam">oldmbuflabel</var></code>;<br /><code>struct mbuf
                *<var class="pdparam">newmbuf</var></code>;<br /><code>struct label
                *<var class="pdparam">newmbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>oldmbuf</code></em></td><td>接收的数据报</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldmbuflabel</code></em></td><td><em class="parameter"><code>oldmbuf</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuf</code></em></td><td>新建数据报</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuflabel</code></em></td><td><em class="parameter"><code>newmbuf</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr></tbody></table></div><p>为由 IP 堆栈因为响应接收数据报（<em class="parameter"><code>oldmbuf</code></em>）而新建的数据报设置其 mbuf 头部的标记。
            许多情况下需要调用该函数，比如，响应 ICMP 请求数据报时。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-fragment-match"></a>6.7.3.3.12. <code class="function">mpo_fragment_match</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
                <strong class="fsfunc">mpo_fragment_match</strong>(</code></td><td><var class="pdparam">fragment</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fragmentlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipq</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipqlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
                *<var class="pdparam">fragment</var></code>;<br /><code>struct label
                *<var class="pdparam">fragmentlabel</var></code>;<br /><code>struct ipq
                *<var class="pdparam">ipq</var></code>;<br /><code>struct label
                *<var class="pdparam">ipqlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>fragment</code></em></td><td>IP 数据报分片</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fragmentlabel</code></em></td><td><em class="parameter"><code>fragment</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipq</code></em></td><td>IP 分片重组队列</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipqlabel</code></em></td><td><em class="parameter"><code>ipq</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据所传入的 IP 分片重组队列（<em class="parameter"><code>ipq</code></em>）的标记，
            检查包含一个 IP 数据报（<em class="parameter"><code>fragment</code></em>）的 mbuf 的头部是否符合其要求。
            符合，则返回<span class="returnvalue">1</span>。否则，返回<span class="returnvalue">0</span>。
            每当 IP 堆栈尝试将一个刚刚接收到的分片放入某个已有的分片重组队列中时，将调用该函数进行安全检查；
            如果失败，将为分片重新实例化一个新的分片重组队列。
            策略可以利用该入口函数，根据标记或者其他信息阻止不期望的 IP 分片重组。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-ifnet-relabel"></a>6.7.3.3.13. <code class="function">mpo_relabel_ifnet</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_relabel_ifnet</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct ifnet
                *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
                *<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct label
                *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>客体；网络接口</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td><em class="parameter"><code>ifnet</code></em> 的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>将为<em class="parameter"><code>ifnet</code></em>设置的新标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据所传入的新标记，<em class="parameter"><code>newlabel</code></em>，以及主体信任状，
            <em class="parameter"><code>cred</code></em>，对网络接口的标记进行更新。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-update-ipq"></a>6.7.3.3.14. <code class="function">mpo_update_ipq</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_update_ipq</strong>(</code></td><td><var class="pdparam">fragment</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fragmentlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipq</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipqlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
                *<var class="pdparam">fragment</var></code>;<br /><code>struct label
                *<var class="pdparam">fragmentlabel</var></code>;<br /><code>struct ipq
                *<var class="pdparam">ipq</var></code>;<br /><code>struct label
                *<var class="pdparam">ipqlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>mbuf</code></em></td><td>IP 分片</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td><em class="parameter"><code>mbuf</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipq</code></em></td><td>IP 分片重组队列</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipqlabel</code></em></td><td>将被更新的<em class="parameter"><code>ipq</code></em>的当前策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据所传入的 IP 分片 mbuf 头部（<em class="parameter"><code>mbuf</code></em>）为接收
            它的 IP 分片重组队列（<em class="parameter"><code>ipq</code></em>）的标记进行更新。</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-proc-labeling-event-ops"></a>6.7.3.4. 进程标记事件操作</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-cred"></a>6.7.3.4.1. <code class="function">mpo_create_cred</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_cred</strong>(</code></td><td><var class="pdparam">parent_cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">child_cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">parent_cred</var></code>;<br /><code>struct ucred
                *<var class="pdparam">child_cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>parent_cred</code></em></td><td>父主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>child_cred</code></em></td><td>子主体信任状</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据所传入的主体信任状，为新建的主体信任状设置标记。
            每当为一个新建的 <span class="type">struct ucred</span>调用 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=crcopy&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">crcopy</span>(9)</span></a> 时，将调用此函数。
            该函数不应与进程复制（forking）或者创建事件混为一谈。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-execve-transition"></a>6.7.3.4.2. <code class="function">mpo_execve_transition</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_execve_transition</strong>(</code></td><td><var class="pdparam">old</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">new</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vnodelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">old</var></code>;<br /><code>struct ucred
                *<var class="pdparam">new</var></code>;<br /><code>struct vnode
                *<var class="pdparam">vp</var></code>;<br /><code>struct label
                *<var class="pdparam">vnodelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>old</code></em></td><td>已有的主体信任状</td><td>不可改变</td></tr><tr><td><em class="parameter"><code>new</code></em></td><td>将被标记的新主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>将被执行的文件</td><td>已被锁定</td></tr><tr><td><em class="parameter"><code>vnodelabel</code></em></td><td><em class="parameter"><code>vp</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr></tbody></table></div><p>一个拥有信任状<em class="parameter"><code>old</code></em>的主体由于执行(<em class="parameter"><code>vp</code></em>文件而导致标记转换时，
            该函数根据vnode标记为该主体重新标记为<em class="parameter"><code>new</code></em>。 每当一个进程请求执行vnode文件，而通过
            入口函数<code class="function">mpo_execve_will_transition</code> 有成功返回的策略时，将调用该函数。
            策略模块可以通过传入两个主体信任状和简单地调用 <code class="function">mpo_create_cred</code> 来实现该入口函数，
            so as not to implement a
            transitioning event.  一旦策略实现了<code class="function">mpo_create_cred</code>函数，即使没有实现
            <code class="function">mpo_execve_will_transition</code>，也应该实现该函数。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-execve-will-transition"></a>6.7.3.4.3. <code class="function">mpo_execve_will_transition</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
                <strong class="fsfunc">mpo_execve_will_transition</strong>(</code></td><td><var class="pdparam">old</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vnodelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">old</var></code>;<br /><code>struct vnode
                *<var class="pdparam">vp</var></code>;<br /><code>struct label
                *<var class="pdparam">vnodelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>old</code></em></td><td>在执行<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=execve&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">execve</span>(2)</span></a>之前的主体信任状</td><td>不可改变</td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>将被执行的文件</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vnodelabel</code></em></td><td><em class="parameter"><code>vp</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr></tbody></table></div><p>由策略决定，当参数主体信任状执行参数 vnode 时，是否需要进行一个标记转换操作。如果需要，返回<span class="returnvalue">1</span>；
            否则，返回<span class="returnvalue">0</span>。即使一个策略返回<span class="returnvalue">0</span>，它也必须为自己不期望的对
            <code class="function">mpo_execve_transition</code>的调用作好准备，因为只要有其他任何一个策略要求转换，就将执行此函数。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-proc0"></a>6.7.3.4.4. <code class="function">mpo_create_proc0</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_proc0</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>将被填写的主体信任状</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为进程0，所有内核进程的祖先，创建主体信任状。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-proc1"></a>6.7.3.4.5. <code class="function">mpo_create_proc1</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_create_proc1</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>将被填写的主体信任状</td><td class="auto-generated"> </td></tr></tbody></table></div><p>为进程1，所有用户进程的祖先，创建主体信任状。</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-relabel-cred"></a>6.7.3.4.6. <code class="function">mpo_relabel_cred</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
                <strong class="fsfunc">mpo_relabel_cred</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
                *<var class="pdparam">cred</var></code>;<br /><code>struct label
                *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>将被应用到 <em class="parameter"><code>cred</code></em> 上的新标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据传入的新标记，对主体信任状上的标记进行更新。</p></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-access-control-checks"></a>6.7.4. 访问控制检查</h3></div></div></div><p>通过访问控制入口函数，策略模块能影响内核的访问控制决策。
        通常情况下，不是绝对，一个访问控制入口函数的参数有，一个或者若干个授权信任状，和相关操作涉及的其他任何对象的信息（其中可能包含标记）。
        访问控制入口函数返回0，表示允许该操作；否则，返回一个 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=errno&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">errno</span>(2)</span></a> 错误编码。调用该入口函数，将遍历所有系统注册的策略模块，逐一进行
        策略相关的检查和决策，之后按照下述方法组合不同策略的返回结果：只有当所有的模块均允许该操作时，才成功返回。
        否则，如果有一个或者若干模块失败返回，则整个检查不通过。如果有多个模块的检查出错返回，将由定义在<code class="filename">kern_mac.c</code> 中的
        <code class="function">error_select()</code> 函数从它们返回的错误编码中，选择一个合适的，返回给用户。</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td>最高优先级</td><td><span class="errorcode">EDEADLK</span></td></tr><tr><td> </td><td><span class="errorcode">EINVAL</span></td></tr><tr><td> </td><td><span class="errorcode">ESRCH</span></td></tr><tr><td> </td><td>EACCES</td></tr><tr><td>最低优先级</td><td>EPERM</td></tr></tbody></table></div><p>如果所有策略模块返回的错误编码均没有出现在上述优先级序列表中，则任意选择一个返回。
        选择错误编码的一般次序为：内核错误，无效的参数，对象不存在，访问被拒绝，和其他错误。</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-bpfdesc-check-receive-from-ifnet"></a>6.7.4.1. <code class="function">mpo_check_bpfdesc_receive</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_bpfdesc_receive</strong>(</code></td><td><var class="pdparam">bpf_d</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">bpflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct bpf_d
              *<var class="pdparam">bpf_d</var></code>;<br /><code>struct label
              *<var class="pdparam">bpflabel</var></code>;<br /><code>struct ifnet
              *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
              *<var class="pdparam">ifnetlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>bpf_d</code></em></td><td>主体；BPF 描述子</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>bpflabel</code></em></td><td><em class="parameter"><code>bpf_d</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>客体；网络接口</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td><em class="parameter"><code>ifnet</code></em> 的策略标记 </td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定 MAC 框架是否应该允许将由参数接口接收到的数据报传递给由 BPF 描述子所对应的缓冲区。成功，则返回<span class="returnvalue">0</span>；
          否则，返回错误编码信息<code class="varname">errno</code>。建议使用的错误编码有：<span class="errorcode">EACCES</span>，用于标记不符的情况；
          <span class="errorcode">EPERM</span>，用于缺少特权的情况。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kenv-dump"></a>6.7.4.2. <code class="function">mpo_check_kenv_dump</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_kenv_dump</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定相关主体是否应该被允许查询内核环境状态（参考 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kenv&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">kenv</span>(2)</span></a>）。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kenv-get"></a>6.7.4.3. <code class="function">mpo_check_kenv_get</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_kenv_get</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>char *<var class="pdparam">name</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td>内核的环境变量名字</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定相关主体是否可以查询内核中给定环境变量的状态。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kenv-set"></a>6.7.4.4. <code class="function">mpo_check_kenv_set</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_kenv_set</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>char *<var class="pdparam">name</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td>内核的环境变量名字</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定相关主体是否有权设置给定内核环境变量的值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kenv-unset"></a>6.7.4.5. <code class="function">mpo_check_kenv_unset</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_kenv_unset</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>char *<var class="pdparam">name</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td>内核的环境变量名字Kernel environment variable name</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定相关主体是否有权清除给定的内核环境变量的设置。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kld-load"></a>6.7.4.6. <code class="function">mpo_check_kld_load</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_kld_load</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>内核模块的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定相关主体是否有权加载给定的模块文件。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kld-stat"></a>6.7.4.7. <code class="function">mpo_check_kld_stat</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_kld_stat</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定相关主体是否有权访问内核的加载模块文件链表以及相关的统计数据。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kld-unload"></a>6.7.4.8. <code class="function">mpo_check_kld_unload</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_kld_unload</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定相关主体是否有权卸载一个内核模块。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-ioctl"></a>6.7.4.9. <code class="function">mpo_check_pipe_ioctl</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_pipe_ioctl</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cmd</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">data</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
              *<var class="pdparam">pipe</var></code>;<br /><code>struct label
              *<var class="pdparam">pipelabel</var></code>;<br /><code>unsigned long
              <var class="pdparam">cmd</var></code>;<br /><code>void *<var class="pdparam">data</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>管道</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td><em class="parameter"><code>pipe</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cmd</code></em></td><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ioctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a> 命令</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>data</code></em></td><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ioctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a> 数据</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定相关主体是否有权调用指定的 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ioctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a> 系统调用。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-poll"></a>6.7.4.10. <code class="function">mpo_check_pipe_poll</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_pipe_poll</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
              *<var class="pdparam">pipe</var></code>;<br /><code>struct label
              *<var class="pdparam">pipelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>管道</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td><em class="parameter"><code>pipe</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定相关主体是否有权对管道<em class="parameter"><code>pipe</code></em>执行poll操作。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-read"></a>6.7.4.11. <code class="function">mpo_check_pipe_read</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_pipe_read</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
              *<var class="pdparam">pipe</var></code>;<br /><code>struct label
              *<var class="pdparam">pipelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>管道</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td><em class="parameter"><code>pipe</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定该主体是否有权读取<em class="parameter"><code>pipe</code></em>。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-relabel"></a>6.7.4.12. <code class="function">mpo_check_pipe_relabel</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_pipe_relabel</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
              *<var class="pdparam">pipe</var></code>;<br /><code>struct label
              *<var class="pdparam">pipelabel</var></code>;<br /><code>struct label
              *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>管道</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td><em class="parameter"><code>pipe</code></em>的当前策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>将为<em class="parameter"><code>pipelabel</code></em>设置的新标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定该主体是否有权为<em class="parameter"><code>pipe</code></em>重新设置标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-stat"></a>6.7.4.13. <code class="function">mpo_check_pipe_stat</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_pipe_stat</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
              *<var class="pdparam">pipe</var></code>;<br /><code>struct label
              *<var class="pdparam">pipelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>管道</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td><em class="parameter"><code>pipe</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定该主体是否有权查询与<em class="parameter"><code>pipe</code></em>相关的统计信息。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-write"></a>6.7.4.14. <code class="function">mpo_check_pipe_write</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_pipe_write</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
              *<var class="pdparam">pipe</var></code>;<br /><code>struct label
              *<var class="pdparam">pipelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>管道</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td><em class="parameter"><code>pipe</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定该主体是否有权写<em class="parameter"><code>pipe</code></em>。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-bind"></a>6.7.4.15. <code class="function">mpo_check_socket_bind</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_socket_bind</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sockaddr</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct socket
              *<var class="pdparam">socket</var></code>;<br /><code>struct label
              *<var class="pdparam">socketlabel</var></code>;<br /><code>struct sockaddr
              *<var class="pdparam">sockaddr</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socket</code></em></td><td>将被绑定的套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td><em class="parameter"><code>socket</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sockaddr</code></em></td><td><em class="parameter"><code>socket</code></em>的地址</td><td class="auto-generated"> </td></tr></tbody></table></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-connect"></a>6.7.4.16. <code class="function">mpo_check_socket_connect</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_socket_connect</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sockaddr</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct socket
              *<var class="pdparam">socket</var></code>;<br /><code>struct label
              *<var class="pdparam">socketlabel</var></code>;<br /><code>struct sockaddr
              *<var class="pdparam">sockaddr</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socket</code></em></td><td>将被连接的套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td><em class="parameter"><code>socket</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sockaddr</code></em></td><td><em class="parameter"><code>socket</code></em>的地址</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定该主体（<em class="parameter"><code>cred</code></em>）是否有权将套接字（<em class="parameter"><code>socket</code></em>）绑定到地址
          <em class="parameter"><code>sockaddr</code></em>。成功，返回<span class="returnvalue">0</span>，否则返回一个错误编码<code class="varname">errno</code>。
          建议采用的错误编码有：<span class="errorcode">EACCES</span>，用于标记不符的情况；<span class="errorcode">EPERM</span>，用于特权不足的情况。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-socket-receive"></a>6.7.4.17. <code class="function">mpo_check_socket_receive</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_socket_receive</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct socket
              *<var class="pdparam">so</var></code>;<br /><code>struct label
              *<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>so</code></em></td><td>套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td><em class="parameter"><code>so</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定该主体是否有权查询套接字<em class="parameter"><code>so</code></em>的相关信息。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-socket-send"></a>6.7.4.18. <code class="function">mpo_check_socket_send</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_socket_send</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct socket
              *<var class="pdparam">so</var></code>;<br /><code>struct label
              *<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>so</code></em></td><td>套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td><em class="parameter"><code>so</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定该主体是否有权通过套接字<em class="parameter"><code>so</code></em>发送信息。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-cred-visible"></a>6.7.4.19. <code class="function">mpo_check_cred_visible</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_cred_visible</strong>(</code></td><td><var class="pdparam">u1</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">u2</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">u1</var></code>;<br /><code>struct ucred
              *<var class="pdparam">u2</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>u1</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>u2</code></em></td><td>对象信任状</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定该主体信任状<em class="parameter"><code>u1</code></em>是否有权 <span class="quote">“<span class="quote">see</span>”</span> 具有信任状<em class="parameter"><code>u2</code></em> 的其他主体。
          成功，返回<span class="returnvalue">0</span>；否则，返回错误编码<code class="varname">errno</code>。建议采用的错误编码有：
          <span class="errorcode">EACCES</span>，用于标记不符的情况；<span class="errorcode">EPERM</span>，用于特权不足的情况；<span class="errorcode">ESRCH</span>，
          用来提供不可见性。该函数可在许多环境下使用，包括命令<code class="command">ps</code>所使用的进程间的状态 sysctl，以及通过procfs 的状态查询操作。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-visible"></a>6.7.4.20. <code class="function">mpo_check_socket_visible</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_socket_visible</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct socket
              *<var class="pdparam">socket</var></code>;<br /><code>struct label
              *<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socket</code></em></td><td>客体；套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td><em class="parameter"><code>socket</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-ifnet-relabel"></a>6.7.4.21. <code class="function">mpo_check_ifnet_relabel</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_ifnet_relabel</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct ifnet
              *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
              *<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct label
              *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>客体；网络接口</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td><em class="parameter"><code>ifnet</code></em>现有的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>将被应用到<em class="parameter"><code>ifnet</code></em>上的新的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定该主体信任状是否有权使用传入的标记更新参数对给定的网络接口的标记进行重新设置。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-relabel"></a>6.7.4.22. <code class="function">mpo_check_socket_relabel</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_socket_relabel</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct socket
              *<var class="pdparam">socket</var></code>;<br /><code>struct label
              *<var class="pdparam">socketlabel</var></code>;<br /><code>struct label
              *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socket</code></em></td><td>客体；套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td><em class="parameter"><code>socket</code></em>现有的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>将被应用到<em class="parameter"><code>socketlabel</code></em>上的更新标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定该主体信任状是否有权采用传入的标记对套接字参数的标记进行重新设置。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-cred-relabel"></a>6.7.4.23. <code class="function">mpo_check_cred_relabel</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_cred_relabel</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct label
              *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>将被应用到<em class="parameter"><code>cred</code></em>上的更新标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定该主体信任状是否有权将自己的标记重新设置为给定的更新标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-relabel"></a>6.7.4.24. <code class="function">mpo_check_vnode_relabel</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_relabel</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vnodelabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">vnodelabel</var></code>;<br /><code>struct label
              *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td>不可改变</td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td>已被锁定</td></tr><tr><td><em class="parameter"><code>vnodelabel</code></em></td><td><em class="parameter"><code>vp</code></em>现有的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>将被应用到<em class="parameter"><code>vp</code></em>上的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>决定该主体信任状是否有权将参数 vnode 的标记重新设置为指定标记。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mpo-cred-check-mount-stat"></a>6.7.4.25. <code class="function">mpo_check_mount_stat</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <strong class="fsfunc">mpo_check_mount_stat</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mountlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct mount
              *<var class="pdparam">mp</var></code>;<br /><code>struct label
              *<var class="pdparam">mountlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mp</code></em></td><td>客体；文件系统挂载</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mountlabel</code></em></td><td><em class="parameter"><code>mp</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权查看在给定文件系统上执行 statfs 的结果。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。
          该函数可能在下列情况下被调用：
          在 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=statfs&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">statfs</span>(2)</span></a> 和其他相关调用期间，或者当需要从文件系统列表中选择排除哪个文件系统时，比如，
          调用 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=getfsstat&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">getfsstat</span>(2)</span></a>时。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-proc-debug"></a>6.7.4.26. <code class="function">mpo_check_proc_debug</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_proc_debug</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">proc</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct proc
              *<var class="pdparam">proc</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td>不可改变</td></tr><tr><td><em class="parameter"><code>proc</code></em></td><td>客体；进程</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权 debug 给定进程。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；<span class="errorcode">EPERM</span>，用于权限不够；
          <span class="errorcode">ESRCH</span>，用于隐瞒目标的存在。
          <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ptrace&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">ptrace</span>(2)</span></a> 和 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ktrace&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">ktrace</span>(2)</span></a> API，以及某些 procfs 操作将调用该函数。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-access"></a>6.7.4.27. <code class="function">mpo_check_vnode_access</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_access</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">flags</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">flags</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>flags</code></em></td><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=access&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">access</span>(2)</span></a> 标志</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据相关主体信任状决定其对给定 vnode 以给定访问标志执行的 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=access&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">access</span>(2)</span></a>
          和其他相关调用的返回值。一般，应采用与<code class="function">mpo_check_vnode_open</code>
          相同的语义来实现该函数。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-chdir"></a>6.7.4.28. <code class="function">mpo_check_vnode_chdir</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_chdir</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">dvp</var></code>;<br /><code>struct label
              *<var class="pdparam">dlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>客体；<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chdir&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">chdir</span>(2)</span></a> 的目的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td><em class="parameter"><code>dvp</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权将进程工作目录切换到给定 vnode。成功，则返回 <span class="returnvalue">0</span>；
          否则，返回一个 <code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-chroot"></a>6.7.4.29. <code class="function">mpo_check_vnode_chroot</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_chroot</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">dvp</var></code>;<br /><code>struct label
              *<var class="pdparam">dlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>目录 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>与<em class="parameter"><code>dvp</code></em>相关联的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否有权 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chroot&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">chroot</span>(2)</span></a> 到由
          (<em class="parameter"><code>dvp</code></em>)给定的目录。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-create"></a>6.7.4.30. <code class="function">mpo_check_vnode_create</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_create</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vap</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">dvp</var></code>;<br /><code>struct label
              *<var class="pdparam">dlabel</var></code>;<br /><code>struct componentname
              *<var class="pdparam">cnp</var></code>;<br /><code>struct vattr
              *<var class="pdparam">vap</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td><em class="parameter"><code>dvp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td><em class="parameter"><code>dvp</code></em>中的成员名</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vap</code></em></td><td><em class="parameter"><code>vap</code></em>的 vnode 属性</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权在给定父目录，以给定的名字和属性，
          常见一个 vnode。成功，则返回 <span class="returnvalue">0</span>；否则，
          返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span> 来表示用于标记不匹配， 而用
          <span class="errorcode">EPERM</span>，用于权限不足。
          以<span class="symbol">O_CREAT</span>为参数调用 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=open&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a>，或对 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mknod&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">mknod</span>(2)</span></a>，<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mkfifo&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">mkfifo</span>(2)</span></a>
          等的调用将导致该函数被调用。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-delete"></a>6.7.4.31. <code class="function">mpo_check_vnode_delete</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_delete</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">dvp</var></code>;<br /><code>struct label
              *<var class="pdparam">dlabel</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>void *<var class="pdparam">label</var></code>;<br /><code>struct componentname
              *<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>父目录 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td><em class="parameter"><code>dvp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；将被删除的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td><em class="parameter"><code>vp</code></em>中的成员名</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权从给定的父目录中，删除给定名字的 vnode。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。
          使用 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=unlink&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">unlink</span>(2)</span></a> 和 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rmdir&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">rmdir</span>(2)</span></a>，将导致该函数被调用。
          提供该入口函数的策略还必须实现一个
          <code class="function">mpo_check_rename_to</code>，
          用来授权由于重命名操作导致的目标文件的删除。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-deleteacl"></a>6.7.4.32. <code class="function">mpo_check_vnode_deleteacl</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_deleteacl</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">type</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred *<var class="pdparam">cred</var></code>;<br /><code>struct vnode *<var class="pdparam">vp</var></code>;<br /><code>struct label *<var class="pdparam">label</var></code>;<br /><code>acl_type_t <var class="pdparam">type</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td>不可改变</td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td>被锁定</td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>type</code></em></td><td>ACL 类型</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权删除给定 vnode 的给定类型的 ACL。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-exec"></a>6.7.4.33. <code class="function">mpo_check_vnode_exec</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_exec</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；将被执行的 vnode </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权执行给定 vnode。
          对于执行特权的决策与任何瞬时事件的决策是严格分开的。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mpo-cred-check-vnode-getacl"></a>6.7.4.34. <code class="function">mpo_check_vnode_getacl</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_getacl</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">type</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>acl_type_t
              <var class="pdparam">type</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>type</code></em></td><td>ACL 类型</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权查询给定 vnode 上的给定类型的 ACL。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-getextattr"></a>6.7.4.35. <code class="function">mpo_check_vnode_getextattr</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_getextattr</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">attrnamespace</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">uio</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>int
              <var class="pdparam">attrnamespace</var></code>;<br /><code>const char
              *<var class="pdparam">name</var></code>;<br /><code>struct uio
              *<var class="pdparam">uio</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>attrnamespace</code></em></td><td>扩展属性名字空间</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td>扩展属性名</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>uio</code></em></td><td>I/O 结构指针；参见 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=uio&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">uio</span>(9)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权查询给定 vnode 上给定名字空间和名字的扩展属性。
          使用扩展属性实现标记存储的策略模块可能会需要对这些扩展属性的操作进行特殊处理。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-link"></a>6.7.4.36. <code class="function">mpo_check_vnode_link</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_link</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">dvp</var></code>;<br /><code>struct label
              *<var class="pdparam">dlabel</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>struct componentname
              *<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>目录 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>与<em class="parameter"><code>dvp</code></em>相关联的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>链接目的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>与<em class="parameter"><code>vp</code></em>相关联的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td>将被创建的链接对应的成员名</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否有权为参数<em class="parameter"><code>vp</code></em>给定的 vnode
          创建一个由参数<em class="parameter"><code>cnp</code></em>给定名字的链接。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-mmap"></a>6.7.4.37. <code class="function">mpo_check_vnode_mmap</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_mmap</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">prot</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">prot</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>将被映射的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>与<em class="parameter"><code>vp</code></em>相关联的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>prot</code></em></td><td>mmap 保护 (参见 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mmap&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">mmap</span>(2)</span></a>)</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否有权将给定 vnode <em class="parameter"><code>vp</code></em> 以
          <em class="parameter"><code>prot</code></em>指定的保护方式进行映射.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-mmap-downgrade"></a>6.7.4.38. <code class="function">mpo_check_vnode_mmap_downgrade</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <strong class="fsfunc">mpo_check_vnode_mmap_downgrade</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">prot</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>int *<var class="pdparam">prot</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td rowspan="3">See
                  <a class="xref" href="mac-entry-point-reference.html#mac-mpo-check-vnode-mmap" title="6.7.4.37. mpo_check_vnode_mmap">第 6.7.4.37 节 “<code class="function">mpo_check_vnode_mmap</code>”</a>.</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>prot</code></em></td><td>将被降级的 mmap protections</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据主体和客体标记，降低 mmap protections。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-mprotect"></a>6.7.4.39. <code class="function">mpo_check_vnode_mprotect</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_mprotect</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">prot</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">prot</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>映射的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>prot</code></em></td><td>存储保护</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否有权将给定 vnode<em class="parameter"><code>vp</code></em> 映射内存空间的存储保护参数设置为指定值。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-poll"></a>6.7.4.40. <code class="function">mpo_check_vnode_poll</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_poll</strong>(</code></td><td><var class="pdparam">active_cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">file_cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">active_cred</var></code>;<br /><code>struct ucred
              *<var class="pdparam">file_cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>active_cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>file_cred</code></em></td><td>与<span class="type">struct file</span>相关联的信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>将被执行 poll 操作的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>与<em class="parameter"><code>vp</code></em>相关联的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否有权对给定 vnode <em class="parameter"><code>vp</code></em>执行 poll 操作。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-rename-from"></a>6.7.4.41. <code class="function">mpo_check_vnode_rename_from</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_vnode_rename_from</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">dvp</var></code>;<br /><code>struct label
              *<var class="pdparam">dlabel</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>struct componentname
              *<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>目录 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>与<em class="parameter"><code>dvp</code></em>相关联的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>将被重命名的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>与<em class="parameter"><code>vp</code></em>相关联的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td><em class="parameter"><code>vp</code></em>中的成员名</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否有权重命名给定vnode，<em class="parameter"><code>vp</code></em>。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-rename-to"></a>6.7.4.42. <code class="function">mpo_check_vnode_rename_to</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_rename_to</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">samedir</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">dvp</var></code>;<br /><code>struct label
              *<var class="pdparam">dlabel</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">samedir</var></code>;<br /><code>struct componentname
              *<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>目录 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>与<em class="parameter"><code>dvp</code></em>相关联的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>被覆盖的 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>与<em class="parameter"><code>vp</code></em>相关联的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>samedir</code></em></td><td>布尔型变量；如果源和目的目录是相同的，则被置为<code class="literal">1</code></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td>目标component名</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否有权重命名给定 vnode <em class="parameter"><code>vp</code></em>，至指定目录
          <em class="parameter"><code>dvp</code></em>，或更名为<em class="parameter"><code>cnp</code></em>。如果无需覆盖已有文件，
          则<em class="parameter"><code>vp</code></em> 和
          <em class="parameter"><code>label</code></em> 的值将为 NULL.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-listen"></a>6.7.4.43. <code class="function">mpo_check_socket_listen</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_socket_listen</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct socket
              *<var class="pdparam">socket</var></code>;<br /><code>struct label
              *<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socket</code></em></td><td>客体；套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td><em class="parameter"><code>socket</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否有权监听给定套接字。
          成功，则返回<span class="returnvalue">0</span>；否则，返回错误编码值<code class="varname">errno</code>。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-lookup"></a>6.7.4.44. <code class="function">mpo_check_vnode_lookup</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_lookup</strong>(</code></td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam"></var>cred</code>;<br /><code>struct vnode
              *<var class="pdparam"></var>dvp</code>;<br /><code>struct label
              *<var class="pdparam"></var>dlabel</code>;<br /><code>struct componentname
              *<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td><em class="parameter"><code>dvp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td>被检查的成员名</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权在给定的目录 vnode 中为查找给定名字执行lookup操作。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个 <code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-open"></a>6.7.4.45. <code class="function">mpo_check_vnode_open</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_open</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">acc_mode</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>int
              <var class="pdparam">acc_mode</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>acc_mode</code></em></td><td><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=open&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a> 访问模式</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权在给定 vnode 上以给定的访问模式执行 open 操作。
          如果成功，则返回 <span class="returnvalue">0</span>；否则，返回一个错误编码。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-readdir"></a>6.7.4.46. <code class="function">mpo_check_vnode_readdir</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_readdir</strong>(</code></td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam"></var>cred</code>;<br /><code>struct vnode
              *<var class="pdparam"></var>dvp</code>;<br /><code>struct label
              *<var class="pdparam"></var>dlabel</code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>客体；目录 vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td><em class="parameter"><code>dvp</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权在给定的目录 vnode 上执行
          <code class="function">readdir</code> 操作。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个错误编码 <code class="varname">errno</code>。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；<span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-readlink"></a>6.7.4.47. <code class="function">mpo_check_vnode_readlink</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_readlink</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权在给定符号链接 vnode 上执行
          <code class="function">readlink</code> 操作。成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；<span class="errorcode">EPERM</span>，用于权限不够。
          该函数可能在若干环境下被调用，包括由用户进程显式执行的 <code class="function">readlink</code> 调用，
          或者是在进程执行名字查询时隐式执行的 <code class="function">readlink</code> 。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-revoke"></a>6.7.4.48. <code class="function">mpo_check_vnode_revoke</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_revoke</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权撤销对给定 vnode 的访问。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；<span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setacl"></a>6.7.4.49. <code class="function">mpo_check_vnode_setacl</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_setacl</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">type</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">acl</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>acl_type_t
              <var class="pdparam">type</var></code>;<br /><code>struct acl
              *<var class="pdparam">acl</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>type</code></em></td><td>ACL 类型</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>acl</code></em></td><td>ACL</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权设置给定 vnode 的给定类型的 ACL。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；<span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setextattr"></a>6.7.4.50. <code class="function">mpo_check_vnode_setextattr</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_setextattr</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">attrnamespace</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">uio</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>int
              <var class="pdparam">attrnamespace</var></code>;<br /><code>const char
              *<var class="pdparam">name</var></code>;<br /><code>struct uio
              *<var class="pdparam">uio</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>attrnamespace</code></em></td><td>扩展属性名字空间</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td>扩展属性名</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>uio</code></em></td><td>I/O 结构指针；参见 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=uio&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">uio</span>(9)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权设置给定 vnode 上给定名字空间中给定名字的扩展属性的值。
          使用扩展属性备份安全标记的策略模块可能需要对其使用的属性实施额外的保护。另外，
          由于在检查和实际操作时间可能存在的竞争，
          策略模块应该避免根据来自<em class="parameter"><code>uio</code></em>中的数据做出决策。
          如果正在执行一个删除操作，则参数 <em class="parameter"><code>uio</code></em> 的值也可能为 <code class="literal">NULL</code>。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；<span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setflags"></a>6.7.4.51. <code class="function">mpo_check_vnode_setflags</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_setflags</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">flags</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>u_long <var class="pdparam">flags</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>flags</code></em></td><td>文件标志；参见 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chflags&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">chflags</span>(2)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权为给定的 vnode 设置给定的标志。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setmode"></a>6.7.4.52. <code class="function">mpo_check_vnode_setmode</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_setmode</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mode</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>mode_t <var class="pdparam">mode</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mode</code></em></td><td>文件模式；参见 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chmod&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">chmod</span>(2)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权将给定 vnode 的模式设置为给定值。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setowner"></a>6.7.4.53. <code class="function">mpo_check_vnode_setowner</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_setowner</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">uid</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">gid</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;<br /><code>uid_t <var class="pdparam">uid</var></code>;<br /><code>gid_t <var class="pdparam">gid</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>uid</code></em></td><td>用户ID</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>gid</code></em></td><td>组ID</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权将给定 vnode 的文件 uid 和文件 gid 设置为给定值。如果无需更新，
          相关参数值可能被设置为(<code class="literal">-1</code>)。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setutimes"></a>6.7.4.54. <code class="function">mpo_check_vnode_setutimes</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_setutimes</strong>(</code></td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam"></var>cred</code>;<br /><code>struct vnode
              *<var class="pdparam"></var>vp</code>;<br /><code>struct label
              *<var class="pdparam"></var>label</code>;<br /><code>struct timespec
              <var class="pdparam"></var>atime</code>;<br /><code>struct timespec
              <var class="pdparam"></var>mtime</code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vp</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>atime</code></em></td><td>访问时间；参见 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=utimes&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">utimes</span>(2)</span></a></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mtime</code></em></td><td>修改时间；参见 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=utimes&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">utimes</span>(2)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权将给定 vnode 的访问时间标签设置为给定值。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-proc-sched"></a>6.7.4.55. <code class="function">mpo_check_proc_sched</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_proc_sched</strong>(</code></td><td><var class="pdparam">ucred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">proc</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">ucred</var></code>;<br /><code>struct proc
              *<var class="pdparam">proc</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>proc</code></em></td><td>客体；进程</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权改变给定进程的调度参数。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够；
          <span class="errorcode">ESRCH</span>，用于提供不可见性质。</p><p>See <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=setpriority&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">setpriority</span>(2)</span></a> for more information.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-proc-signal"></a>6.7.4.56. <code class="function">mpo_check_proc_signal</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_proc_signal</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">proc</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">signal</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct proc
              *<var class="pdparam">proc</var></code>;<br /><code>int <var class="pdparam">signal</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>proc</code></em></td><td>客体；进程</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>signal</code></em></td><td>信号；参见 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">kill</span>(2)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权向给定进程发送给定信号。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，
          用于标记不匹配；<span class="errorcode">EPERM</span>，用于权限不够；
          <span class="errorcode">ESRCH</span>，用于提供不可见性质。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-stat"></a>6.7.4.57. <code class="function">mpo_check_vnode_stat</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_vnode_stat</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>客体；vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td><em class="parameter"><code>vp</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状是否有权在给定 vnode 上执行 <code class="function">stat</code> 操作。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p><p>See <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stat&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">stat</span>(2)</span></a> for more information.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-ifnet-transmit"></a>6.7.4.58. <code class="function">mpo_check_ifnet_transmit</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_ifnet_transmit</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct ifnet
              *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
              *<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct mbuf
              *<var class="pdparam">mbuf</var></code>;<br /><code>struct label
              *<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>网络接口</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td><em class="parameter"><code>ifnet</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuf</code></em></td><td>客体；将被发送的 mbuf </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td><em class="parameter"><code>mbuf</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关网络接口是否有权传送给定的 mbuf。成功，则返回 <span class="returnvalue">0</span>；
          否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-deliver"></a>6.7.4.59. <code class="function">mpo_check_socket_deliver</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_socket_deliver</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct ifnet
              *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
              *<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct mbuf
              *<var class="pdparam">mbuf</var></code>;<br /><code>struct label
              *<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>网络接口</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td><em class="parameter"><code>ifnet</code></em>的策略标记</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuf</code></em></td><td>客体；将被传送的 mbuf </td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td><em class="parameter"><code>mbuf</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关套接字是否有权从给定的 mbuf 中接收数据报。
          成功，则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-socket-visible"></a>6.7.4.60. <code class="function">mpo_check_socket_visible</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_socket_visible</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct socket
              *<var class="pdparam">so</var></code>;<br /><code>struct label
              *<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td>不可改变</td></tr><tr><td><em class="parameter"><code>so</code></em></td><td>客体；套接字</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td><em class="parameter"><code>so</code></em>的策略标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体信任状cred 是否有权使用系统监控函数，比如，
          由<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=netstat&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">netstat</span>(8)</span></a> 和 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sockstat&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">sockstat</span>(1)</span></a>使用的程序来观察
          给定的套接字(<em class="parameter"><code>socket</code></em>)。成功，
          则返回 <span class="returnvalue">0</span>；否则，返回一个<code class="varname">errno</code>值。
          建议使用的错误编码：<span class="errorcode">EACCES</span>，用于标记不匹配；
          <span class="errorcode">EPERM</span>，用于权限不够；
          <span class="errorcode">ESRCH</span>，用于提供不可见性质。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-acct"></a>6.7.4.61. <code class="function">mpo_check_system_acct</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_system_acct</strong>(</code></td><td><var class="pdparam">ucred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">ucred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>ucred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>审计文件；<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acct&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">acct</span>(5)</span></a></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>与<em class="parameter"><code>vp</code></em>相关联的标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>根据主体标记和审计日志文件的标记，确定该主体是否有权启动审计。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-nfsd"></a>6.7.4.62. <code class="function">mpo_check_system_nfsd</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_system_nfsd</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否有权调用
            <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=nfssvc&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">nfssvc</span>(2)</span></a>。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-reboot"></a>6.7.4.63. <code class="function">mpo_check_system_reboot</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_system_reboot</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">howto</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>int <var class="pdparam">howto</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>howto</code></em></td><td>来自 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=reboot&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">reboot</span>(2)</span></a>的<em class="parameter"><code>howto</code></em> 参数</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否有权以指定方式重启系统。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-settime"></a>6.7.4.64. <code class="function">mpo_check_system_settime</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_system_settime</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关用户是否有权设置系统时钟。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-swapon"></a>6.7.4.65. <code class="function">mpo_check_system_swapon</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_system_swapon</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
              *<var class="pdparam">vp</var></code>;<br /><code>struct label
              *<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>swap设备</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>与<em class="parameter"><code>vp</code></em>相关联的标记</td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否有权增加一个作为swap设备的 <em class="parameter"><code>vp</code></em> 。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-sysctl"></a>6.7.4.66. <code class="function">mpo_check_system_sysctl</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
              <strong class="fsfunc">mpo_check_system_sysctl</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">namelen</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">old</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldlenp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">inkernel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">new</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlen</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
              *<var class="pdparam">cred</var></code>;<br /><code>int *<var class="pdparam">name</var></code>;<br /><code>u_int *<var class="pdparam">namelen</var></code>;<br /><code>void *<var class="pdparam">old</var></code>;<br /><code>size_t
              *<var class="pdparam">oldlenp</var></code>;<br /><code>int <var class="pdparam">inkernel</var></code>;<br /><code>void *<var class="pdparam">new</var></code>;<br /><code>size_t <var class="pdparam">newlen</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>参数</th><th>说明</th><th>锁定</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>主体信任状</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td rowspan="4">参见 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(3)</span></a></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>namelen</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>old</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldlenp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>inkernel</code></em></td><td>布尔型变量；如果从内核被调用，其值被置为<code class="literal">1</code></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>new</code></em></td><td rowspan="2">参见 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(3)</span></a></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlen</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>确定相关主体是否应该被允许执行指定的 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(3)</span></a> 事务。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-label-management"></a>6.7.5. 标记管理调用</h3></div></div></div><p>当用户进程请求对某个对象的标记进行修改时，将引发重新标记事件。对应的更新操作分两步进行：
        首先，进行访问控制检查，确认此次更新操作是有效且被允许的；然后，调用另一个独立的入口函数对标记进行修改。
        重新标记入口函数通常接收由请求进程提交的对象、对象标记指针和请求新标记，作为输入参数。
        对象重新标记操作的失败将由先期的标记检查报告，所以，不允许在接下来的标记修改过程中报告失败，故而不提倡在此过程中新分配内存。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mac-policy-architecture.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="mac.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="mac-userland-arch.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">6.6. MAC策略模块体系结构 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 6.8. 应用层体系结构</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文档和其它文档可从这里下载：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>如果对于FreeBSD有问题，请先阅读
    <a href="http://www.FreeBSD.org/docs.html">文档</a>，如不能解决再联系
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    关于本文档的问题请发信联系
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>