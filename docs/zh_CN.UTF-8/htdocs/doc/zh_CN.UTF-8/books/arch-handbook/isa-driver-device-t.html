<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>10.3. Device_t指针</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 系统结构手册" /><link rel="up" href="isa-driver.html" title="第 10 章 ISA设备驱动程序" /><link rel="prev" href="isa-driver-basics.html" title="10.2. 基本信息" /><link rel="next" href="isa-driver-config.html" title="10.4. 配置文件与自动配置期间识别和探测的顺序" /><link rel="copyright" href="trademarks.html" title="法律声明" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">10.3. Device_t指针</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="isa-driver-basics.html">上一页</a> </td><th width="60%" align="center">第 10 章 ISA设备驱动程序</th><td width="20%" align="right"> <a accesskey="n" href="isa-driver-config.html">下一页</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="isa-driver-device-t"></a>10.3. Device_t指针</h2></div></div></div><p><code class="varname">Device_t</code>是为设备结构而定义的指针类型，
        这里我们只关心从设备驱动程序编写者的角度看感兴趣的方法。下面的方法
        用来操纵设备结构中的值：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="function">device_t
	  device_get_parent(dev)</code> 获取设备的父总线。
	  </p></li><li class="listitem"><p><code class="function">driver_t
	  device_get_driver(dev)</code> 获取指向其驱动程序结构的指针。
	  </p></li><li class="listitem"><p><code class="function">char
	  *device_get_name(dev)</code> 获取驱动程序的名字，在我们的
          例子中为<code class="literal">"xxx"</code>。</p></li><li class="listitem"><p><code class="function">int device_get_unit(dev)</code>
	  获取单元号（与每个驱动程序关联的设备从0开始编号）。
	  </p></li><li class="listitem"><p><code class="function">char
	  *device_get_nameunit(dev)</code> 获取设备名，包括单元号。
          例如<span class="quote">“<span class="quote">xxx0</span>”</span>，<span class="quote">“<span class="quote">xxx1</span>”</span>
          等。</p></li><li class="listitem"><p><code class="function">char
	  *device_get_desc(dev)</code> 获取设备描述。通常它以人可读的
          形式描述设备的确切型号。</p></li><li class="listitem"><p><code class="function">device_set_desc(dev,
	  desc)</code>设置描述信息。这使得设备描述指向desc字符串，
          此后这个字符串就不能被解除分配。</p></li><li class="listitem"><p><code class="function">device_set_desc_copy(dev,
	  desc)</code> 设置描述信息。描述被拷贝到内部动态分配的
          缓冲区，这样desc字符串在以后可以被改变而不会产生有害的结果。
	  </p></li><li class="listitem"><p><code class="function">void
	  *device_get_softc(dev)</code> 获取指向与设备关联的设备描述符
          （<code class="varname">xxx_softc</code>结构）的指针。
	  </p></li><li class="listitem"><p><code class="function">u_int32_t
	  device_get_flags(dev)</code> 获取配置文件中特定于设备的
          标志。</p></li></ul></div><p>可以使用一个很方便的函数<code class="function">device_printf(dev, fmt,
	...)</code>从设备驱动程序中打印讯息。它自动在讯息前添加
        单元名和冒号。</p><p>device_t的这些方法在文件<code class="filename">kern/bus_subr.c</code>
        中实现。</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="isa-driver-basics.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="isa-driver.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="isa-driver-config.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">10.2. 基本信息 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 10.4. 配置文件与自动配置期间识别和探测的顺序</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文档和其它文档可从这里下载：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>如果对于FreeBSD有问题，请先阅读
    <a href="http://www.FreeBSD.org/docs.html">文档</a>，如不能解决再联系
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    关于本文档的问题请发信联系
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>