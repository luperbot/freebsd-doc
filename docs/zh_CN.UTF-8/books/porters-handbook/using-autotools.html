<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>6.4. 利用 GNU autotools</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD Porter 手册" /><link rel="up" href="special.html" title="第 6 章 特殊情况" /><link rel="prev" href="building.html" title="6.3. 联编机制" /><link rel="next" href="using-gettext.html" title="6.5. 使用 GNU gettext" /><link rel="copyright" href="trademarks.html" title="法律声明" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.4. 利用 GNU autotools</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="building.html">上一页</a> </td><th width="60%" align="center">第 6 章 特殊情况</th><td width="20%" align="right"> <a accesskey="n" href="using-gettext.html">下一页</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-autotools"></a>6.4. 利用 GNU autotools</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-autotools-introduction"></a>6.4.1. 入门</h3></div></div></div><p>众多 GNU autotools 提供了一种在多重操作系统和机器架构之上联编软件的抽象机制。
	    在 Ports Collection 中， port 可以通过简单的方法来使用这些工具：</p><pre class="programlisting">USE_AUTOTOOLS= <em class="replaceable"><code>工具</code></em>:<em class="replaceable"><code>版本</code></em>[:<em class="replaceable"><code>操作</code></em>] ...</pre><p>撰写本书时， <em class="replaceable"><code>工具</code></em> 可以设置为
	    <code class="literal">libtool</code>、 <code class="literal">libltdl</code>、
	    <code class="literal">autoconf</code>、 <code class="literal">autoheader</code>、
	    <code class="literal">automake</code> 或 <code class="literal">aclocal</code> 之一。</p><p><em class="replaceable"><code>版本</code></em> 用来指定希望使用的工具的特定版本 (参见
	    <code class="literal">devel/{automake,autoconf,libtool}[0-9]+</code>
	    以了解有效的版本号)。</p><p><em class="replaceable"><code>操作</code></em> 是一个可选的扩展选项，
	    用于修改如何使用工具。</p><p>可以同时指定多个不同的工具， 可以在一行中指定， 也可以用
	    Makefile 的 <code class="literal">+=</code> 结构。</p><p>最后， 可以使用一个特殊的名为
	    <code class="literal">autotools</code> 的工具，
	    它会安装全部可用的 autotools 版本，
	    以适应跨平台开发的需要。 您可以通过安装 <code class="literal">devel/autotools</code> port 来达到这一目的。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-libtool"></a>6.4.2. <code class="command">libtool</code></h3></div></div></div><p>使用 GNU 联编框架的共享库通常会使用
	    <code class="command">libtool</code> 来调整共享库的编译和安装，
	    以便与所运行的操作系统相匹配。 通常的做法是使用应用程序所附带的
	    <code class="command">libtool</code> 副本。
	    如果需要使用外部的 <code class="command">libtool</code>，
	    则可以使用 Ports 套件提供的版本：</p><pre class="programlisting">USE_AUTOTOOLS= libtool:<em class="replaceable"><code>版本</code></em>[:env]</pre><p>如果不使用额外的操作符，
	    <code class="literal">libtool:版本</code>
	    表示希望联编框架使用 configure 脚本来对系统所安装的 <code class="command">libtool</code>
	    进行修补。 这会暗含地定义 <code class="varname">GNU_CONFIGURE</code>。
	    更进一步， 联编框架还会设置一系列 make 和 shell
	    变量用于 port 后续的操作。 请参见
	    <code class="filename">bsd.autotools.mk</code> 了解进一步的详情。</p><p>如果指定了 <code class="literal">:env</code> 操作符， 则表示只设置环境，
	    而跳过其他的操作。</p><p>最后， <code class="varname">LIBTOOLFLAGS</code> 和
	    <code class="varname">LIBTOOLFILES</code> 可以用来替换最常修改的参数， 以及将被
	    <code class="command">libtool</code> 修补的文件。 多数 port 不需要这样做。
	    请参见 <code class="filename">bsd.autotools.mk</code> 以了解进一步的细节。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-libltdl"></a>6.4.3. <code class="command">libltdl</code></h3></div></div></div><p>一些 ports 会使用 <code class="command">libltdl</code> 库，
	    后者是 <code class="command">libtool</code> 软件包的一部分。
	    使用这个库并不意味着必须使用
	    <code class="command">libtool</code> 本身， 因此提供了另一组结构。</p><pre class="programlisting">USE_AUTOTOOLS= libltdl:<em class="replaceable"><code>版本</code></em></pre><p>目前， 这一设置所做的全部工作是将
	    <code class="varname">LIB_DEPENDS</code> 设置为适当的
	    <code class="command">libltdl</code> port， 并作为一项方便的功能，
	    协助开发人员消除在 <code class="varname">USE_AUTOTOOLS</code> 框架以外的，
	    对于 autotools port 的依赖。 这个工具并不提供其它的操作符。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-autoconf"></a>6.4.4. <code class="command">autoconf</code> 和
	    <code class="command">autoheader</code></h3></div></div></div><p>某些 port 并没有直接提供 configure 脚本， 但包含了作为
	    autoconf 模板的 <code class="filename">configure.ac</code> 文件。
	    可以用下列设置来要求
	    <code class="command">autoconf</code> 创建 configure 脚本，
	    并使用 <code class="command">autoheader</code> 来为 configure
	    脚本创建模板头文件。</p><pre class="programlisting">USE_AUTOTOOLS=	autoconf:<em class="replaceable"><code>版本</code></em>[:env]</pre><p>以及</p><pre class="programlisting">USE_AUTOTOOLS=	autoheader:<em class="replaceable"><code>版本</code></em></pre><p>上述设置会暗含使用
	    <code class="literal">autoconf:版本</code>。</p><p>对于 <code class="command">libtool</code>， 设置与前面类似。
	    如果指定可选的 <code class="literal">:env</code> 操作符，
	    则表示只设置用于后续工作的环境。 如果不指定，
	    则会对 port 进行相应的修补和重新配置。</p><p>其它的可选变量， 如
	    <code class="varname">AUTOCONF_ARGS</code> 和
	    <code class="varname">AUTOHEADER_ARGS</code> 可以通过 port 的
	    <code class="filename">Makefile</code> 来显式地指定替换。
	    类似 <code class="command">libtool</code>， 多数 port 并不需要这样做。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-automake"></a>6.4.5. <code class="command">automake</code> 和
	    <code class="command">aclocal</code></h3></div></div></div><p>某些软件包只提供了 <code class="filename">Makefile.am</code>
	    文件。 这些文件必须首先用
	    <code class="command">automake</code> 转换为
	    <code class="filename">Makefile.in</code> 并使用
	    <code class="command">configure</code> 来生成实际的
	    <code class="filename">Makefile</code>。</p><p>类似地， 偶尔会有一些软件包不提供联编所需的
	    <code class="filename">aclocal.m4</code> 文件。
	    这些文件可以通过使用 <code class="command">aclocal</code>
	    来扫描 <code class="filename">configure.ac</code> 或
	    <code class="filename">configure.in</code> 自动生成。</p><p><code class="command">aclocal</code> 与
	    <code class="command">automake</code> 有和 <code class="command">autoheader</code>
	    与 <code class="command">autoconf</code> 在前面一节中所介绍的相类似的关系。
	    <code class="command">aclocal</code> 会暗含使用
	    <code class="command">automake</code>， 因此：</p><pre class="programlisting">USE_AUTOTOOLS=	automake:<em class="replaceable"><code>版本</code></em>[:<em class="replaceable"><code>env</code></em>]</pre><p>和</p><pre class="programlisting">USE_AUTOTOOLS=	aclocal:<em class="replaceable"><code>版本</code></em></pre><p>也自动暗含使用
	    <code class="literal">automake:版本</code>。</p><p>与 <code class="command">libtool</code> 类似，
	    <code class="command">autoconf</code> 如果使用了可选的
	    <code class="literal">:env</code> 操作符表示仅仅设置用于后续使用的环境，
	    如果不设置， 则会对 port 进行重新配置。</p><p>对于
	    <code class="command">autoconf</code> 和 <code class="command">autoheader</code> 而言，
	    <code class="command">automake</code> 和 <code class="command">aclocal</code>
	    提供了对应的可选参数变量 <code class="varname">AUTOMAKE_ARGS</code> 和
	    <code class="varname">ACLOCAL_ARGS</code>， 如果需要的话，
	    可以在 port 的 <code class="filename">Makefile</code> 中指定。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="building.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="special.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="using-gettext.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">6.3. 联编机制 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 6.5. 使用 GNU <code class="literal">gettext</code></td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文档和其它文档可从这里下载：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>如果对于FreeBSD有问题，请先阅读
    <a href="http://www.FreeBSD.org/docs.html">文档</a>，如不能解决再联系
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    关于本文档的问题请发信联系
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>