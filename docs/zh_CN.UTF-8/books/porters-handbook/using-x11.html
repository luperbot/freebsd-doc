<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>6.7. 使用 X11</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD Porter 手册" /><link rel="up" href="special.html" title="第 6 章 特殊情况" /><link rel="prev" href="using-perl.html" title="6.6. 使用 perl" /><link rel="next" href="using-gnome.html" title="6.8. 使用 GNOME" /><link rel="copyright" href="trademarks.html" title="法律声明" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.7. 使用 X11</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="using-perl.html">上一页</a> </td><th width="60%" align="center">第 6 章 特殊情况</th><td width="20%" align="right"> <a accesskey="n" href="using-gnome.html">下一页</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-x11"></a>6.7. 使用 X11</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="x11-variables"></a>6.7.1. X.Org 组件</h3></div></div></div><p>在 Ports 套件中提供的 X11 实现是 X.Org。
	  如果您的应用程序用到了 X 组件， 则应将
	  <code class="varname">USE_XORG</code> 设为所需要的那些组件。
	  目前可用的组件包括：</p><p><code class="literal">bigreqsproto compositeproto damageproto dmx dmxproto
	  evieproto fixesproto fontcacheproto fontenc fontsproto fontutil
	  glproto ice inputproto kbproto libfs oldx printproto randrproto
	  recordproto renderproto resourceproto scrnsaverproto sm trapproto
	  videoproto x11 xau xaw xaw6 xaw7 xaw8 xbitmaps xcmiscproto xcomposite
	  xcursor xdamage xdmcp xevie xext xextproto xf86bigfontproto
	  xf86dgaproto xf86driproto xf86miscproto xf86rushproto
	  xf86vidmodeproto xfixes xfont xfontcache xft xi xinerama
	  xineramaproto xkbfile xkbui xmu xmuu xorg-server xp xpm xprintapputil
	  xprintutil xpr oto xproxymngproto xrandr xrender xres xscrnsaver xt
	  xtrans xtrap xtst xv xvmc xxf86dga xxf86misc xxf86vm</code>.</p><p>最新的列表， 可以在
	  <code class="filename">/usr/ports/Mk/bsd.xorg.mk</code> 中找到。</p><p>The Mesa Project 是一个致力于自由的 OpenGL
	  实现的计划。 您可以使用 <code class="varname">USE_GL</code> 变量来让 port 依赖其不同的组件。
	  可用的选项包括： <code class="literal">glut, glu, glw, glew, gl</code> 和
	  <code class="literal">linux</code>。 为了实现向前兼容，
	  当使用 <code class="literal">yes</code> 时系统会自动将其映射为 <code class="literal">glu</code>。</p><div class="example"><a id="use-xorg-example"></a><div class="example-title">例 6.1. 使用 USE_XORG 的例子</div><div class="example-contents"><pre class="programlisting">USE_XORG=   xrender xft xkbfile xt xaw
USE_GL=     glu</pre></div></div><br class="example-break" /><p>许多 ports 会定义 <code class="varname">USE_XLIB</code>，
	  这会导致 port 依赖 50 多个动态连接库。 由于它出现于 X.org
	  模块化之前， 因此这个变量仅为向前兼容的原因提供，
	  新的 port 不应再使用它。</p><div class="table"><a id="idp68452432"></a><div class="table-title">表 6.5. 用到 X 的 port 可以使用的变量</div><div class="table-contents"><table summary="用到 X 的 port 可以使用的变量" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">USE_XLIB</code></td><td>此 port 用到了 X 库。 已过时 - 您应使用 <code class="varname">USE_XORG</code> 变量列出用到的
		X.Org 组件， 而不是使用这个变量。</td></tr><tr><td><code class="varname">USE_IMAKE</code></td><td>此 port 用到了 <code class="command">imake</code>。</td></tr><tr><td><code class="varname">USE_X_PREFIX</code></td><td>已过时。 目前其作用与
		<code class="varname">USE_XLIB</code> 相同， 并可以直接用后者替换。</td></tr><tr><td><code class="varname">XMKMF</code></td><td>设置为 <code class="command">xmkmf</code> 的完整路径名， 如果它不在
		<code class="envar">PATH</code> 中的话。 默认值是 <code class="literal">xmkmf
		  -a</code>。</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idp68466000"></a><div class="table-title">表 6.6. 用于表示对 X11 某些组件的依赖关系的变量</div><div class="table-contents"><table summary="用于表示对 X11 某些组件的依赖关系的变量" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="varname">X_IMAKE_PORT</code></td><td>用以提供 <code class="command">imake</code> 以及许多其它用于联编
		X11 的工具的 port。</td></tr><tr><td><code class="varname">X_LIBRARIES_PORT</code></td><td>用以提供 X11 库的 port。</td></tr><tr><td><code class="varname">X_CLIENTS_PORT</code></td><td>用以提供 X 客户的 port。</td></tr><tr><td><code class="varname">X_SERVER_PORT</code></td><td>用以提供 X 服务的 port。</td></tr><tr><td><code class="varname">X_FONTSERVER_PORT</code></td><td>用以提供字体服务的 port。</td></tr><tr><td><code class="varname">X_PRINTSERVER_PORT</code></td><td>用以提供打印服务的 port。</td></tr><tr><td><code class="varname">X_VFBSERVER_PORT</code></td><td>用以提供在虚拟帧缓存服务(virtual framebuffer server) 的 port。</td></tr><tr><td><code class="varname">X_NESTSERVER_PORT</code></td><td>用以提供嵌套 X 服务的 port。</td></tr><tr><td><code class="varname">X_FONTS_ENCODINGS_PORT</code></td><td>用以为字体提供编码的 port。</td></tr><tr><td><code class="varname">X_FONTS_MISC_PORT</code></td><td>用以提供多种位图字体的 port。</td></tr><tr><td><code class="varname">X_FONTS_100DPI_PORT</code></td><td>用以提供 100dpi 位图字体的 port。</td></tr><tr><td><code class="varname">X_FONTS_75DPI_PORT</code></td><td>用以提供 75dpi 位图字体的 port。</td></tr><tr><td><code class="varname">X_FONTS_CYRILLIC_PORT</code></td><td>用以提供西里尔位图字体的 port。</td></tr><tr><td><code class="varname">X_FONTS_TTF_PORT</code></td><td>用以提供 <span class="trademark">TrueType</span>® 字体的 port。</td></tr><tr><td><code class="varname">X_FONTS_TYPE1_PORT</code></td><td>用以提供 Type1 字体的 port。</td></tr><tr><td><code class="varname">X_MANUALS_PORT</code></td><td>用以提供面向开发人员的联机手册的 port。</td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="using-x11-vars"></a><div class="example-title">例 6.2. 在变量中使用与 X11 有关的变量</div><div class="example-contents"><pre class="programlisting"># 使用某些 X11 库并依赖字体服务和西里尔字体。
RUN_DEPENDS=   ${LOCALBASE}/bin/xfs:${X_FONTSERVER_PORT} \
               ${LOCALASE}/lib/X11/fonts/cyrillic/crox1c.pcf.gz:${X_FONTS_CYRILLIC_PORT}

USE_XORG=      x11 xpm</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="x11-motif"></a>6.7.2. 需要使用 Motif 的 port</h3></div></div></div><p>如果您的 port 需要 Motif 库， 则应在
	  <code class="filename">Makefile</code> 中定义 <code class="varname">USE_MOTIF</code>。
	  默认的 Motif 实现是
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/open-motif/pkg-descr">x11-toolkits/open-motif</a>。
	  用户可以通过设置 <code class="varname">WANT_LESSTIF</code> 变量来选择
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/x11-toolkits/lesstif/pkg-descr">x11-toolkits/lesstif</a> 代替它。</p><p><code class="filename">bsd.port.mk</code> 会将 <code class="varname">MOTIFLIB</code>
	  变量设置为到合适的 Motif 库的引用。 请使用补丁将您 port 中
	  <code class="filename">Makefile</code> 或
	  <code class="filename">Imakefile</code> 提到 Motif
	  库的地方改为 <code class="literal">${MOTIFLIB}</code>。</p><p>有两种比较常见的情况：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>如果 port 中将 Motif 在其 <code class="filename">Makefile</code> 或
	      <code class="filename">Imakefile</code> 表达为
	      <code class="literal">-lXm</code>， 则简单地将其替换为
	      <code class="literal">${MOTIFLIB}</code>。</p></li><li class="listitem"><p>如果 port 在其 <code class="filename">Imakefile</code>
	      中使用 <code class="literal">XmClientLibs</code>， 则将其改为
	      <code class="literal">${MOTIFLIB} ${XTOOLLIB}
		${XLIB}</code>.</p></li></ul></div><p>注意 <code class="varname">MOTIFLIB</code> (通常) 会展开为
	  <code class="literal">-L/usr/X11R6/lib -lXm</code> 或
	  <code class="literal">/usr/X11R6/lib/libXm.a</code>， 所以不需要在其前加入
	  <code class="literal">-L</code> 或 <code class="literal">-l</code>。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp68520272"></a>6.7.3. X11 字体</h3></div></div></div><p>如果 port 将为 X Window 系统安装字体， 将这些字体放到
	  <code class="filename">LOCALBASE/lib/X11/fonts/local</code>。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp68521808"></a>6.7.4. 通过 Xvfb 来获得虚拟的 <code class="envar">DISPLAY</code></h3></div></div></div><p>某些应用程序必须在有可用的 X11 显示的时候才能成功编译。
	  当编译的机器没有控制台时， 这会带来问题。 为了解决这个问题，
	  如果定义了适当的变量， 联编基础设施会启动采用虚拟帧缓存的
	  X server。 此时， 编译过程中将会传出可用的 <code class="envar">DISPLAY</code>。</p><pre class="programlisting">USE_DISPLAY=  yes</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="desktop-entries"></a>6.7.5. 桌面项</h3></div></div></div><p>通过利用
	  <code class="varname">DESKTOP_ENTRIES</code> 变量，
	  可以很容易地在您的 port 中创建桌面项 (<a class="link" href="http://standards.freedesktop.org/desktop-entry-spec/latest/" target="_top">Freedesktop
	  标准</a>)。 这些项会在类似 GNOME 或 KDE
	  这样的符合这一标准的桌面环境中显示在应用程序菜单中。
	  这样做会自动创建、 安装 <code class="filename">.desktop</code> 文件， 并将其加入
	  <code class="filename">pkg-plist</code>。 其语法为：</p><pre class="programlisting">DESKTOP_ENTRIES=  "NAME" "COMMENT" "ICON" "COMMAND" "CATEGORY" StartupNotify</pre><p>您可以在 <a class="link" href="http://standards.freedesktop.org/menu-spec/latest/apa.html" target="_top">
	  Freedesktop 网站上</a> 找到可用的分类名称。 <code class="varname">StartupNotify</code>
	  表示应用程序在支持启动通知的环境中清除状态信息。</p><p>例子：</p><pre class="programlisting">DESKTOP_ENTRIES=  "ToME" "Roguelike game based on JRR Tolkien's work" \
                  "${DATADIR}/xtra/graf/tome-128.png" \
                  "tome -v -g" "Application;Game;RolePlaying;" \
                  false</pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="using-perl.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="special.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="using-gnome.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">6.6. 使用 <code class="literal">perl</code> </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 6.8. 使用 GNOME</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文档和其它文档可从这里下载：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>如果对于FreeBSD有问题，请先阅读
    <a href="http://www.FreeBSD.org/docs.html">文档</a>，如不能解决再联系
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    关于本文档的问题请发信联系
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>