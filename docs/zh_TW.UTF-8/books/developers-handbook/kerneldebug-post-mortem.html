<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>9.4. Post-Mortem Analysis of a Dump</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD Developers' Handbook" /><link rel="up" href="kerneldebug.html" title="章 9. Kernel Debugging" /><link rel="prev" href="kerneldebug-ddd.html" title="9.3. Debugging a Crash Dump with DDD" /><link rel="next" href="kerneldebug-online-ddb.html" title="9.5. On-Line Kernel Debugging Using DDB" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">9.4. Post-Mortem Analysis of a Dump</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="kerneldebug-ddd.html">前一頁</a> </td><th width="60%" align="center">章 9. Kernel Debugging</th><td width="20%" align="right"> <a accesskey="n" href="kerneldebug-online-ddb.html">下一頁</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="kerneldebug-post-mortem"></a>9.4. Post-Mortem Analysis of a Dump</h2></div></div></div><p>What do you do if a kernel dumped core but you did not expect it,
      and it is therefore not compiled using <code class="command">config -g</code>? Not
      everything is lost here.  Do not panic!</p><p>Of course, you still need to enable crash dumps.  See above for the
      options you have to specify in order to do this.</p><p>Go to your kernel config directory
      (<code class="filename">/usr/src/sys/arch/conf</code>)
      and edit your configuration file.  Uncomment (or add, if it does not
      exist) the following line:</p><pre class="programlisting">makeoptions    DEBUG=-g                #Build kernel with gdb(1) debug symbols</pre><p>Rebuild the kernel.  Due to the time stamp change on the Makefile,
      some other object files will be rebuilt, for example
      <code class="filename">trap.o</code>.  With a bit of luck, the added
      <code class="option">-g</code> option will not change anything for the generated
      code, so you will finally get a new kernel with similar code to the
      faulting one but with some debugging symbols.  You should at least verify the
      old and new sizes with the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=size&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">size</span>(1)</span></a> command.  If there is a
      mismatch, you probably need to give up here.</p><p>Go and examine the dump as described above.  The debugging symbols
      might be incomplete for some places, as can be seen in the stack trace
      in the example above where some functions are displayed without line
      numbers and argument lists.  If you need more debugging symbols, remove
      the appropriate object files, recompile the kernel again and repeat the
      <code class="command">gdb -k</code>
      session until you know enough.</p><p>All this is not guaranteed to work, but it will do it fine in most
      cases.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="kerneldebug-ddd.html">前一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="kerneldebug.html">上一層</a></td><td width="40%" align="right"> <a accesskey="n" href="kerneldebug-online-ddb.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">9.3. Debugging a Crash Dump with DDD </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 9.5. On-Line Kernel Debugging Using DDB</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文及其他文件，可由此下載：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>若有 FreeBSD 方面疑問，請先閱讀
    <a href="http://www.FreeBSD.org/docs.html">FreeBSD 相關文件</a>，如不能解決的話，再洽詢
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;。<br></br>
    關於本文件的問題，請洽詢
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;。</small></p></body></html>