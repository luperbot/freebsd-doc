<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>31.5. Bridging</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 使用手冊" /><link rel="up" href="advanced-networking.html" title="章 31. 網路進階練功房" /><link rel="prev" href="network-bluetooth.html" title="31.4. Bluetooth" /><link rel="next" href="network-aggregation.html" title="31.6. Link Aggregation and Failover" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">31.5. Bridging</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-bluetooth.html">前一頁</a> </td><th width="60%" align="center">章 31. 網路進階練功房</th><td width="20%" align="right"> <a accesskey="n" href="network-aggregation.html">下一頁</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-bridging"></a>31.5. Bridging</h2></div><div><span class="authorgroup">Written by <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Andrew</span> <span class="surname">Thompson</span></span>. </span></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90613968"></a>31.5.1. Introduction</h3></div></div></div><a id="idp90614608" class="indexterm"></a><a id="idp90615120" class="indexterm"></a><p>It is sometimes useful to divide one physical network
	(such as an Ethernet segment) into two separate network
	segments without having to create IP subnets and use a router
	to connect the segments together.  A device that connects two
	networks together in this fashion is called a
	<span class="quote">“<span class="quote">bridge</span>”</span>.  A FreeBSD system with two network
	interface cards can act as a bridge.</p><p>The bridge works by learning the MAC layer addresses
	(Ethernet addresses) of the devices on each of its network interfaces.
	It forwards traffic between two networks only when its source and
	destination are on different networks.</p><p>In many respects, a bridge is like an Ethernet switch with very
	few ports.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90625616"></a>31.5.2. Situations Where Bridging Is Appropriate</h3></div></div></div><p>There are many common situations in which a bridge is used
	today.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90626640"></a>31.5.2.1. Connecting Networks</h4></div></div></div><p>The basic operation of a bridge is to join two or more
	  network segments together.  There are many reasons to use a
	  host based bridge over plain networking equipment such as
	  cabling constraints, firewalling or connecting pseudo
	  networks such as a Virtual Machine interface.  A bridge can
	  also connect a wireless interface running in hostap mode to
	  a wired network and act as an access point.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90627792"></a>31.5.2.2. Filtering/Traffic Shaping Firewall</h4></div></div></div><a id="idp90628432" class="indexterm"></a><a id="idp90628944" class="indexterm"></a><p>A common situation is where firewall functionality is
	  needed without routing or network address translation (NAT).</p><p>An example is a small company that is connected via DSL
	  or ISDN to their ISP.  They have a 13 globally-accessible IP
	  addresses from their ISP and have 10 PCs on their network.
	  In this situation, using a router-based firewall is
	  difficult because of subnetting issues.</p><a id="idp90630352" class="indexterm"></a><a id="idp90630864" class="indexterm"></a><a id="idp90631376" class="indexterm"></a><p>A bridge-based firewall can be configured and dropped into the
	  path just downstream of their DSL/ISDN router without any IP
	  numbering issues.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90632400"></a>31.5.2.3. Network Tap</h4></div></div></div><p>A bridge can join two network segments and be used to
	  inspect all Ethernet frames that pass between them.  This can
	  either be from using <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bpf&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bpf</span>(4)</span></a>/<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tcpdump&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tcpdump</span>(1)</span></a> on the
	  bridge interface or by sending a copy of all frames out an
	  additional interface (span port).</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90635216"></a>31.5.2.4. Layer 2 VPN</h4></div></div></div><p>Two Ethernet networks can be joined across an IP link by
	  bridging the networks to an EtherIP tunnel or a <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tap&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">tap</span>(4)</span></a>
	  based solution such as OpenVPN.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90637136"></a>31.5.2.5. Layer 2 Redundancy</h4></div></div></div><p>A network can be connected together with multiple links
	  and use the Spanning Tree Protocol to block redundant paths.
	  For an Ethernet network to function properly only one active
	  path can exist between two devices, Spanning Tree will
	  detect loops and put the redundant links into a blocked
	  state.  Should one of the active links fail then the
	  protocol will calculate a different tree and reenable one of
	  the blocked paths to restore connectivity to all points in
	  the network.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90638416"></a>31.5.3. Kernel Configuration</h3></div></div></div><p>This section covers <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=if_bridge&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">if_bridge</span>(4)</span></a> bridge
	implementation, a netgraph bridging driver is also available,
	for more information see <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ng_bridge&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ng_bridge</span>(4)</span></a> manual page.</p><p>The bridge driver is a kernel module and will be
	automatically loaded by <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ifconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ifconfig</span>(8)</span></a> when creating a
	bridge interface.  It is possible to compile the bridge in to
	the kernel by adding <code class="literal">device if_bridge</code> to
	your kernel configuration file.</p><p>Packet filtering can be used with any firewall package
	that hooks in via the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pfil&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">pfil</span>(9)</span></a> framework.  The firewall
	can be loaded as a module or compiled into the kernel.</p><p>The bridge can be used as a traffic shaper with
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=altq&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">altq</span>(4)</span></a> or <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dummynet&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">dummynet</span>(4)</span></a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90645840"></a>31.5.4. Enabling the Bridge</h3></div></div></div><p>The bridge is created using interface cloning.  To create
	a bridge use <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ifconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ifconfig</span>(8)</span></a>, if the bridge driver is not
	present in the kernel then it will be loaded
	automatically.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig bridge create</code></strong>
bridge0
<code class="prompt">#</code> <strong class="userinput"><code>ifconfig bridge0</code></strong>
bridge0: flags=8802&lt;BROADCAST,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether 96:3d:4b:f1:79:7a
        id 00:00:00:00:00:00 priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 timeout 1200
        root id 00:00:00:00:00:00 priority 0 ifcost 0 port 0</pre><p>A bridge interface is created and is automatically
	assigned a randomly generated Ethernet address.  The
	<code class="literal">maxaddr</code> and <code class="literal">timeout</code>
	parameters control how many MAC addresses the bridge will keep
	in its forwarding table and how many seconds before each entry
	is removed after it is last seen.  The other parameters
	control how Spanning Tree operates.</p><p>Add the member network interfaces to the bridge.  For the
	bridge to forward packets all member interfaces and the bridge
	need to be up:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig bridge0 addm fxp0 addm fxp1 up</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ifconfig fxp0 up</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ifconfig fxp1 up</code></strong></pre><p>The bridge is now forwarding Ethernet frames between
	<code class="filename">fxp0</code> and
	<code class="filename">fxp1</code>.  The equivalent configuration
	in <code class="filename">/etc/rc.conf</code> so the bridge is created
	at startup is:</p><pre class="programlisting">cloned_interfaces="bridge0"
ifconfig_bridge0="addm fxp0 addm fxp1 up"
ifconfig_fxp0="up"
ifconfig_fxp1="up"</pre><p>If the bridge host needs an IP address then the correct
	place to set this is on the bridge interface itself rather
	than one of the member interfaces.  This can be set statically
	or via DHCP:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig bridge0 inet 192.168.0.1/24</code></strong></pre><p>It is also possible to assign an IPv6 address to a bridge
	interface.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90673744"></a>31.5.5. Firewalling</h3></div></div></div><a id="idp90674384" class="indexterm"></a><p>When packet filtering is enabled, bridged packets will
	pass through the filter inbound on the originating interface,
	on the bridge interface and outbound on the appropriate
	interfaces.  Either stage can be disabled.  When direction of
	the packet flow is important it is best to firewall on the
	member interfaces rather than the bridge itself.</p><p>The bridge has several configurable settings for passing
	non-IP and ARP packets, and layer2 firewalling with IPFW.  See
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=if_bridge&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">if_bridge</span>(4)</span></a> for more information.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90676688"></a>31.5.6. Spanning Tree</h3></div></div></div><p>The bridge driver implements the Rapid Spanning Tree
	Protocol (RSTP or 802.1w) with backwards compatibility with
	the legacy Spanning Tree Protocol (STP).  Spanning Tree is
	used to detect and remove loops in a network topology.  RSTP
	provides faster Spanning Tree convergence than legacy STP, the
	protocol will exchange information with neighbouring switches
	to quickly transition to forwarding without creating
	loops.</p><p>The following table shows the supported operating
	modes:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /></colgroup><thead><tr><th>OS Version</th><th>STP Modes</th><th>Default Mode</th></tr></thead><tbody><tr><td>FreeBSD 5.4——FreeBSD 6.2</td><td>STP</td><td>STP</td></tr><tr><td>FreeBSD 6.3+</td><td>RSTP or STP</td><td>STP</td></tr><tr><td>FreeBSD 7.0+</td><td>RSTP or STP</td><td>RSTP</td></tr></tbody></table></div><p>Spanning Tree can be enabled on member interfaces using
	the <code class="literal">stp</code> command.  For a bridge with
	<code class="filename">fxp0</code> and
	<code class="filename">fxp1</code> as the current interfaces,
	enable STP with the following:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig bridge0 stp fxp0 stp fxp1</code></strong>
bridge0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether d6:cf:d5:a0:94:6d
        id 00:01:02:4b:d4:50 priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 timeout 1200
        root id 00:01:02:4b:d4:50 priority 32768 ifcost 0 port 0
        member: fxp0 flags=1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 3 priority 128 path cost 200000 proto rstp
                role designated state forwarding
        member: fxp1 flags=1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 4 priority 128 path cost 200000 proto rstp
                role designated state forwarding</pre><p>This bridge has a spanning tree ID of
	<code class="literal">00:01:02:4b:d4:50</code> and a priority of
	<code class="literal">32768</code>.  As the <code class="literal">root id</code>
	is the same it indicates that this is the root bridge for the
	tree.</p><p>Another bridge on the network also has spanning tree
	enabled:</p><pre class="screen">bridge0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether 96:3d:4b:f1:79:7a
        id 00:13:d4:9a:06:7a priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 timeout 1200
        root id 00:01:02:4b:d4:50 priority 32768 ifcost 400000 port 4
        member: fxp0 flags=1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 4 priority 128 path cost 200000 proto rstp
                role root state forwarding
        member: fxp1 flags=1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 5 priority 128 path cost 200000 proto rstp
                role designated state forwarding</pre><p>The line <code class="literal">root id 00:01:02:4b:d4:50 priority 32768
	ifcost 400000 port 4</code> shows that the root bridge is
	<code class="literal">00:01:02:4b:d4:50</code> as above and has a path
	cost of <code class="literal">400000</code> from this bridge, the path
	to the root bridge is via <code class="literal">port 4</code> which is
	<code class="filename">fxp0</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90701904"></a>31.5.7. Advanced Bridging</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90702544"></a>31.5.7.1. Reconstruct Traffic Flows</h4></div></div></div><p>The bridge supports monitor mode, where the packets are
	  discarded after <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bpf&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bpf</span>(4)</span></a> processing, and are not
	  processed or forwarded further.  This can be used to
	  multiplex the input of two or more interfaces into a single
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bpf&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bpf</span>(4)</span></a> stream.  This is useful for reconstructing the
	  traffic for network taps that transmit the RX/TX signals out
	  through two separate interfaces.</p><p>To read the input from four network interfaces as one
	  stream:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig bridge0 addm fxp0 addm fxp1 addm fxp2 addm fxp3 monitor up</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>tcpdump -i bridge0</code></strong></pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90711504"></a>31.5.7.2. Span Ports</h4></div></div></div><p>A copy of every Ethernet frame received by the bridge
	  will be transmitted out a designated span port.  The number
	  of span ports configured on a bridge is unlimited, if an
	  interface is designated as a span port then it may not also
	  be used as a regular bridge port.  This is most useful for
	  snooping a bridged network passively on another host
	  connected to one of the span ports of the bridge.</p><p>To send a copy of all frames out the interface named
	  <code class="filename">fxp4</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig bridge0 span fxp4</code></strong></pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90714320"></a>31.5.7.3. Private Interfaces</h4></div></div></div><p>A private interface does not forward any traffic to any
	  other port that is also a private interface.  The traffic is
	  blocked unconditionally so no Ethernet frames will be
	  forwarded, including ARP.  If traffic needs to be
	  selectively blocked then a firewall should be used
	  instead.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90715472"></a>31.5.7.4. Sticky Interfaces</h4></div></div></div><p>If a bridge member interface is marked as sticky then
	  dynamically learned address entries are treated at static once
	  entered into the forwarding cache.  Sticky entries are never
	  aged out of the cache or replaced, even if the address is seen
	  on a different interface.  This gives the benefit of static
	  address entries without the need to pre-populate the
	  forwarding table, clients learnt on a particular segment of
	  the bridge can not roam to another segment.</p><p>Another example of using sticky addresses would be to
	  combine the bridge with VLANs to create a router where
	  customer networks are isolated without wasting IP address
	  space.  Consider that <code class="systemitem">CustomerA</code> is on
	  <code class="literal">vlan100</code> and <code class="systemitem">CustomerB</code> is on
	  <code class="literal">vlan101</code>.  The bridge has the address
	  <code class="systemitem">192.168.0.1</code> and is also an
	  internet router.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig bridge0 addm vlan100 sticky vlan100 addm vlan101 sticky vlan101</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ifconfig bridge0 inet 192.168.0.1/24</code></strong></pre><p>Both clients see <code class="systemitem">192.168.0.1</code> as their default gateway
	  and since the bridge cache is sticky they can not spoof the
	  MAC address of the other customer to intercept their
	  traffic.</p><p>Any communication between the VLANs can be blocked using
	  private interfaces (or a firewall):</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig bridge0 private vlan100 private vlan101</code></strong></pre><p>The customers are completely isolated from each other,
	  the full <code class="systemitem">/24</code> address range
	  can be allocated without subnetting.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90728272"></a>31.5.7.5. SNMP Monitoring</h4></div></div></div><p>The bridge interface and STP parameters can be monitored
	  via the SNMP daemon which is included in the FreeBSD base
	  system.  The exported bridge MIBs conform to the IETF
	  standards so any SNMP client or monitoring package can be
	  used to retrieve the data.</p><p>On the bridge machine uncomment the
	  <code class="literal">begemotSnmpdModulePath."bridge" =
	  "/usr/lib/snmp_bridge.so"</code> line from
	  <code class="filename">/etc/snmp.config</code> and start the
	  <span class="application">bsnmpd</span> daemon. Other
	  configuration such as community names and access lists may
	  need to be modified.  See <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bsnmpd&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">bsnmpd</span>(1)</span></a> and
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=snmp_bridge&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">snmp_bridge</span>(3)</span></a> for more information.</p><p>The following examples use the
	  <span class="application">Net-SNMP</span> software (<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net-mgmt/net-snmp/pkg-descr">net-mgmt/net-snmp</a>) to query a
	  bridge, the <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net-mgmt/bsnmptools/pkg-descr">net-mgmt/bsnmptools</a> port can also
	  be used.  From the SNMP client host add to
	  <code class="filename">$HOME/.snmp/snmp.conf</code> the following
	  lines to import the bridge MIB definitions in to
	  <span class="application">Net-SNMP</span>:</p><pre class="programlisting">mibdirs +/usr/share/snmp/mibs
mibs +BRIDGE-MIB:RSTP-MIB:BEGEMOT-MIB:BEGEMOT-BRIDGE-MIB</pre><p>To monitor a single bridge via the IETF BRIDGE-MIB
	  (RFC4188) do</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>snmpwalk -v 2c -c public bridge1.example.com mib-2.dot1dBridge</code></strong>
BRIDGE-MIB::dot1dBaseBridgeAddress.0 = STRING: 66:fb:9b:6e:5c:44
BRIDGE-MIB::dot1dBaseNumPorts.0 = INTEGER: 1 ports
BRIDGE-MIB::dot1dStpTimeSinceTopologyChange.0 = Timeticks: (189959) 0:31:39.59 centi-seconds
BRIDGE-MIB::dot1dStpTopChanges.0 = Counter32: 2
BRIDGE-MIB::dot1dStpDesignatedRoot.0 = Hex-STRING: 80 00 00 01 02 4B D4 50
...
BRIDGE-MIB::dot1dStpPortState.3 = INTEGER: forwarding(5)
BRIDGE-MIB::dot1dStpPortEnable.3 = INTEGER: enabled(1)
BRIDGE-MIB::dot1dStpPortPathCost.3 = INTEGER: 200000
BRIDGE-MIB::dot1dStpPortDesignatedRoot.3 = Hex-STRING: 80 00 00 01 02 4B D4 50
BRIDGE-MIB::dot1dStpPortDesignatedCost.3 = INTEGER: 0
BRIDGE-MIB::dot1dStpPortDesignatedBridge.3 = Hex-STRING: 80 00 00 01 02 4B D4 50
BRIDGE-MIB::dot1dStpPortDesignatedPort.3 = Hex-STRING: 03 80
BRIDGE-MIB::dot1dStpPortForwardTransitions.3 = Counter32: 1
RSTP-MIB::dot1dStpVersion.0 = INTEGER: rstp(2)</pre><p>The <code class="literal">dot1dStpTopChanges.0</code> value is two
	  which means that the STP bridge topology has changed twice,
	  a topology change means that one or more links in the
	  network have changed or failed and a new tree has been
	  calculated.  The
	  <code class="literal">dot1dStpTimeSinceTopologyChange.0</code> value
	  will show when this happened.</p><p>To monitor multiple bridge interfaces one may use the
	  private BEGEMOT-BRIDGE-MIB:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>snmpwalk -v 2c -c public bridge1.example.com</code></strong>
enterprises.fokus.begemot.begemotBridge
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseName."bridge0" = STRING: bridge0
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseName."bridge2" = STRING: bridge2
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseAddress."bridge0" = STRING: e:ce:3b:5a:9e:13
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseAddress."bridge2" = STRING: 12:5e:4d:74:d:fc
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseNumPorts."bridge0" = INTEGER: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseNumPorts."bridge2" = INTEGER: 1
...
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTimeSinceTopologyChange."bridge0" = Timeticks: (116927) 0:19:29.27 centi-seconds
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTimeSinceTopologyChange."bridge2" = Timeticks: (82773) 0:13:47.73 centi-seconds
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTopChanges."bridge0" = Counter32: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTopChanges."bridge2" = Counter32: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeStpDesignatedRoot."bridge0" = Hex-STRING: 80 00 00 40 95 30 5E 31
BEGEMOT-BRIDGE-MIB::begemotBridgeStpDesignatedRoot."bridge2" = Hex-STRING: 80 00 00 50 8B B8 C6 A9</pre><p>To change the bridge interface being monitored via the
	  <code class="literal">mib-2.dot1dBridge</code> subtree do:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>snmpset -v 2c -c private bridge1.example.com</code></strong>
BEGEMOT-BRIDGE-MIB::begemotBridgeDefaultBridgeIf.0 s bridge2</pre></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-bluetooth.html">前一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="advanced-networking.html">上一層</a></td><td width="40%" align="right"> <a accesskey="n" href="network-aggregation.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">31.4. Bluetooth </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 31.6. Link Aggregation and Failover</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文及其他文件，可由此下載：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>若有 FreeBSD 方面疑問，請先閱讀
    <a href="http://www.FreeBSD.org/docs.html">FreeBSD 相關文件</a>，如不能解決的話，再洽詢
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;。<br></br>
    關於本文件的問題，請洽詢
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;。</small></p></body></html>