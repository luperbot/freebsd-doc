<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>12.6. 在 FreeBSD 使用 rc</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 使用手冊" /><link rel="up" href="config-tuning.html" title="章 12. 設定與效能調校(Tuning)" /><link rel="prev" href="configtuning-cron.html" title="12.5. 設定 cron" /><link rel="next" href="config-network-setup.html" title="12.7. 設定網路卡" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">12.6. 在 FreeBSD 使用 rc</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="configtuning-cron.html">前一頁</a> </td><th width="60%" align="center">章 12. 設定與效能調校(Tuning)</th><td width="20%" align="right"> <a accesskey="n" href="config-network-setup.html">下一頁</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="configtuning-rcd"></a>12.6. 在 FreeBSD 使用 rc</h2></div><div><span class="authorgroup">Contributed by <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><p>從 2002 年起，FreeBSD 整合了 NetBSD 的 <code class="filename">rc.d</code> 機制來作為系統服務啟動機制。
      可以到 <code class="filename">/etc/rc.d</code> 目錄下去看，很多檔案都是基本服務，可以用 <code class="option">start</code>, <code class="option">stop</code>
      及 <code class="option">restart</code> 作為使用時的選項。
      舉個例子，可以用下列指令來重新啟動 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sshd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sshd</span>(8)</span></a>：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/sshd restart</code></strong></pre><p>其他服務也是類似作法。當然，
      服務通常只要在 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a> 內有指定的話，都會在開機時就自動啟動。舉例來說，若要開機時啟動 NAT(Network Address
      Translation) daemon 的話，只要在 <code class="filename">/etc/rc.conf</code> 內加上下列這行即可：</p><pre class="programlisting">natd_enable="YES"</pre><p>若原本寫的是 <code class="option">natd_enable="NO"</code> 那麼只要把 <code class="option">NO</code> 改為
       <code class="option">YES</code> 就好了。rc scripts 會在下次重開機時，自動載入相關(有相依)的服務，以下我們會講到這部分。</p><p>Since the <code class="filename">rc.d</code> system is primarily
      intended to start/stop services at system startup/shutdown time,
      the standard <code class="option">start</code>,
      <code class="option">stop</code> and <code class="option">restart</code> options will only
      perform their action if the appropriate
      <code class="filename">/etc/rc.conf</code> variables are set.  For
      instance the above <code class="command">sshd restart</code> command will
      only work if <code class="varname">sshd_enable</code> is set to
      <code class="option">YES</code> in <code class="filename">/etc/rc.conf</code>.  To
      <code class="option">start</code>, <code class="option">stop</code> or
      <code class="option">restart</code> a service regardless of the settings in
      <code class="filename">/etc/rc.conf</code>, the commands should be
      prefixed with <span class="quote">“<span class="quote">force</span>”</span>.  For instance to restart
      <code class="command">sshd</code> regardless of the current
      <code class="filename">/etc/rc.conf</code> setting, execute the following
      command:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/sshd forcerestart</code></strong></pre><p>It is easy to check if a service is enabled in
      <code class="filename">/etc/rc.conf</code> by running the appropriate
      <code class="filename">rc.d</code> script with the option
      <code class="option">rcvar</code>.  Thus, an administrator can check that
      <code class="command">sshd</code> is in fact enabled in
      <code class="filename">/etc/rc.conf</code> by running:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/sshd rcvar</code></strong>
# sshd
$sshd_enable=YES</pre><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">The second line (<code class="literal"># sshd</code>) is the output
        from the <code class="command">sshd</code> command, not a <code class="systemitem">root</code>
        console.</p></div><p>若要檢查服務是否有在運作，可以用 <code class="option">status</code> 選項來查詢。比如：若要確認
    	<code class="command">sshd</code> 是否真的有啟動的話，那麼打：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/sshd status</code></strong>
sshd is running as pid 433.</pre><p>In some cases it is also possible to <code class="option">reload</code> a service.
      This will attempt to send a signal to an individual service, forcing the
      service to reload its configuration files.  In most cases this
      means sending the service a <code class="literal">SIGHUP</code>
      signal. Support for this feature is not included for every service.</p><p>The <code class="filename">rc.d</code> system is not only used for network services, it also
      contributes to most of the system initialization.  For
      instance, consider the <code class="filename">bgfsck</code> file.  When
      this script is executed, it will print out the following
      message:</p><pre class="screen">Starting background file system checks in 60 seconds.</pre><p>Therefore this file is used for background file system
      checks, which are done only during system initialization.</p><p>Many system services depend on other services to function
      properly.  For example, NIS and other RPC-based services may
      fail to start until after the <code class="command">rpcbind</code>
      (portmapper) service has started.  To resolve this issue,
      information about dependencies and other meta-data is included
      in the comments at the top of each startup script.  The
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcorder&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rcorder</span>(8)</span></a> program is then used to parse these comments
      during system initialization to determine the order in which
      system services should be invoked to satisfy the dependencies.
      The following words may be included at the top of each startup
      file:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">PROVIDE</code>: Specifies the services this file provides.</p></li><li class="listitem"><p><code class="literal">REQUIRE</code>: Lists services which are required for this
	  service.  This file will run <span class="emphasis"><em>after</em></span>
	  the specified services.</p></li><li class="listitem"><p><code class="literal">BEFORE</code>: Lists services which depend on this service.
	  This file will run <span class="emphasis"><em>before</em></span>
	  the specified services.</p></li></ul></div><p>By using this method, an administrator can easily control system
      services without the hassle of <span class="quote">“<span class="quote">runlevels</span>”</span> like
      some other <span class="trademark">UNIX</span>® operating systems.</p><p>Additional information about the
      <code class="filename">rc.d</code> system can be found in the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a>
      and <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.subr&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc.subr</span>(8)</span></a> manual pages.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="configtuning-cron.html">前一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="config-tuning.html">上一層</a></td><td width="40%" align="right"> <a accesskey="n" href="config-network-setup.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">12.5. 設定 <code class="command">cron</code> </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 12.7. 設定網路卡</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文及其他文件，可由此下載：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>若有 FreeBSD 方面疑問，請先閱讀
    <a href="http://www.FreeBSD.org/docs.html">FreeBSD 相關文件</a>，如不能解決的話，再洽詢
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;。<br></br>
    關於本文件的問題，請洽詢
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;。</small></p></body></html>