<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>27.7. Using SLIP</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 使用手冊" /><link rel="up" href="ppp-and-slip.html" title="章 27. PPP and SLIP" /><link rel="prev" href="pppoa.html" title="27.6. Using PPP over ATM (PPPoA)" /><link rel="next" href="mail.html" title="章 28. 電子郵件" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">27.7. Using SLIP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="pppoa.html">前一頁</a> </td><th width="60%" align="center">章 27. PPP and SLIP</th><td width="20%" align="right"> <a accesskey="n" href="mail.html">下一頁</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="slip"></a>27.7. Using SLIP</h2></div><div><span class="authorgroup">Originally contributed by <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Satoshi</span> <span class="surname">Asami</span></span>. </span></div><div><span class="authorgroup">With input from <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Guy</span> <span class="surname">Helmer</span></span> 且 <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Piero</span> <span class="surname">Serini</span></span>. </span></div></div></div><a id="idp86318160" class="indexterm"></a><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="slipc"></a>27.7.1. Setting Up a SLIP Client</h3></div></div></div><a id="idp86319440" class="indexterm"></a><p>The following is one way to set up a FreeBSD machine for SLIP
	on a static host network.  For dynamic hostname assignments (your
	address changes each time you dial up), you probably need to
	have a more complex setup.</p><p>First, determine which serial port your modem is connected to.
	Many people set up a symbolic link, such as
	<code class="filename">/dev/modem</code>, to point to the real device name,
	<code class="filename">/dev/cuaaN</code> (or <code class="filename">/dev/cuadN</code> under FreeBSD 6.X).  This allows you to
	abstract the actual device name should you ever need to move
	the modem to a different port.  It can become quite cumbersome when you
	need to fix a bunch of files in <code class="filename">/etc</code> and
	<code class="filename">.kermrc</code> files all over the system!</p><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="filename">/dev/cuaa0</code> (or <code class="filename">/dev/cuad0</code> under FreeBSD 6.X) is
	  <code class="filename">COM1</code>, <code class="filename">cuaa1</code> (or <code class="filename">/dev/cuad1</code>) is
	  <code class="filename">COM2</code>, etc.</p></div><p>Make sure you have the following in your kernel configuration
	file:</p><pre class="programlisting">device   sl</pre><p>Under FreeBSD 4.X, use instead the following
	line:</p><pre class="programlisting">pseudo-device   sl      1</pre><p>It is included in the <code class="filename">GENERIC</code> kernel, so
	this should not be a problem unless you have deleted it.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86332496"></a>27.7.1.1. Things You Have to Do Only Once</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Add your home machine, the gateway and nameservers to
	      your <code class="filename">/etc/hosts</code> file.  Ours looks like
	      this:</p><pre class="programlisting">127.0.0.1               localhost loghost
136.152.64.181          water.CS.Example.EDU water.CS water
136.152.64.1            inr-3.CS.Example.EDU inr-3 slip-gateway
128.32.136.9            ns1.Example.EDU ns1
128.32.136.12           ns2.Example.EDU ns2</pre></li><li class="step"><p>Make sure you have <code class="literal">hosts</code> before
	      <code class="literal">bind</code> in your
	      <code class="filename">/etc/host.conf</code> on FreeBSD versions
	      prior to 5.0.  Since FreeBSD 5.0, the system uses
	      the file <code class="filename">/etc/nsswitch.conf</code> instead,
	      make sure you have <code class="literal">files</code> before
	      <code class="literal">dns</code> in the <code class="option">hosts</code> line
	      of this file.  Without these parameters funny
	      things may happen.</p></li><li class="step"><p>Edit the <code class="filename">/etc/rc.conf</code> file.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Set your hostname by editing the line that
		  says:</p><pre class="programlisting">hostname="myname.my.domain"</pre><p>Your machine's full Internet hostname should be
		  placed here.</p></li><li class="listitem"><a id="idp86341584" class="indexterm"></a><p>Designate the default router<a id="idp86342352" class="indexterm"></a> by changing the
		  line:</p><pre class="programlisting">defaultrouter="NO"</pre><p>to:</p><pre class="programlisting">defaultrouter="slip-gateway"</pre></li></ol></div></li><li class="step"><p>Make a file <code class="filename">/etc/resolv.conf</code> which
	      contains:</p><pre class="programlisting">domain CS.Example.EDU
nameserver 128.32.136.9
nameserver 128.32.136.12</pre><a id="idp86345936" class="indexterm"></a><a id="idp86346448" class="indexterm"></a><p>As you can see, these set up the nameserver hosts.  Of
	      course, the actual domain names and addresses depend on your
	      environment.</p></li><li class="step"><p>Set the password for <code class="systemitem">root</code> and
	      <code class="systemitem">toor</code> (and any other
	      accounts that do not have a password).</p></li><li class="step"><p>Reboot your machine and make sure it comes up with the
	      correct hostname.</p></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86354512"></a>27.7.1.2. Making a SLIP Connection</h4></div></div></div><a id="idp86355152" class="indexterm"></a><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Dial up, type <code class="command">slip</code> at the prompt,
	      enter your machine name and password.  What is required to
	      be entered depends on your environment.  If you use
	      <span class="application">Kermit</span>, you can try a script like this:</p><pre class="programlisting"># kermit setup
set modem hayes
set line /dev/modem
set speed 115200
set parity none
set flow rts/cts
set terminal bytesize 8
set file type binary
# The next macro will dial up and login
define slip dial 643-9600, input 10 =&gt;, if failure stop, -
output slip\x0d, input 10 Username:, if failure stop, -
output silvia\x0d, input 10 Password:, if failure stop, -
output ***\x0d, echo \x0aCONNECTED\x0a</pre><p>Of course, you have to change the username and password
	      to fit yours.  After doing so, you can just type
	      <code class="command">slip</code> from the <span class="application">Kermit</span> prompt to
	      connect.</p><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">Leaving your password in plain text anywhere in the
	        filesystem is generally a <span class="emphasis"><em>bad</em></span> idea.
		Do it at your own risk.</p></div></li><li class="step"><p>Leave the <span class="application">Kermit</span> there (you can suspend it by
	      <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>z</strong></span>) and as <code class="systemitem">root</code>, type:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>slattach -h -c -s 115200 /dev/modem</code></strong></pre><p>If you are able to <code class="command">ping</code> hosts on the
	      other side of the router, you are connected!  If it does not
	      work, you might want to try <code class="option">-a</code> instead of
	      <code class="option">-c</code> as an argument to
              <code class="command">slattach</code>.</p></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86370768"></a>27.7.1.3. How to Shutdown the Connection</h4></div></div></div><p>Do the following:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kill -INT `cat /var/run/slattach.modem.pid`</code></strong></pre><p>to kill <code class="command">slattach</code>.  Keep in mind you must be
	  <code class="systemitem">root</code> to do the above.  Then go back to
	  <code class="command">kermit</code> (by running <code class="command">fg</code> if you suspended it) and
	  exit from
	  it (<span class="keycap"><strong>q</strong></span>).</p><p>The <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=slattach&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">slattach</span>(8)</span></a> manual page says you have
	  to use <code class="command">ifconfig sl0 down</code>
          to mark the interface down, but this does not
	  seem to make any difference.
	  (<code class="command">ifconfig sl0</code> reports the same thing.)</p><p>Some times, your modem might refuse to drop the carrier.
	  In that case, simply start <code class="command">kermit</code> and quit
	  it again. It usually goes out on the second try.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86378064"></a>27.7.1.4. Troubleshooting</h4></div></div></div><p>If it does not work, feel free to ask on <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-net" target="_top">freebsd-net</a> mailing list.  The things that
	  people tripped over so far:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Not using <code class="option">-c</code> or <code class="option">-a</code> in
	      <code class="command">slattach</code> (This should not be fatal,
	      but some users have reported that this solves their
	      problems.)</p></li><li class="listitem"><p>Using <code class="option">s10</code> instead of
	      <code class="option">sl0</code> (might be hard to see the difference on
	      some fonts).</p></li><li class="listitem"><p>Try <code class="command">ifconfig sl0</code> to see your
	      interface status.  For example, you might get:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ifconfig sl0</code></strong>
sl0: flags=10&lt;POINTOPOINT&gt;
        inet 136.152.64.181 --&gt; 136.152.64.1 netmask ffffff00</pre></li><li class="listitem"><p>If you get <span class="errorname">no route to host</span>
            messages from <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ping&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ping</span>(8)</span></a>, there may be a problem with your
            routing table.  You can use the <code class="command">netstat -r</code>
            command to display the current routes :</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>netstat -r</code></strong>
Routing tables
Destination      Gateway            Flags     Refs     Use  IfaceMTU    Rtt    Netmasks:

(root node)
(root node)

Route Tree for Protocol Family inet:
(root node) =&gt;
default          inr-3.Example.EDU  UG          8   224515  sl0 -      -
localhost.Exampl localhost.Example. UH          5    42127  lo0 -       0.438
inr-3.Example.ED water.CS.Example.E UH          1        0  sl0 -      -
water.CS.Example localhost.Example. UGH        34 47641234  lo0 -       0.438
(root node)</pre><p>The preceding examples are from a relatively busy system.
              The numbers on your system will vary depending on
              network activity.</p></li></ul></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="slips"></a>27.7.2. Setting Up a SLIP Server</h3></div></div></div><a id="idp86403024" class="indexterm"></a><p>This document provides suggestions for setting up SLIP Server
	services on a FreeBSD system, which typically means configuring
	your system to automatically startup connections upon login for
	remote SLIP clients.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="slips-prereqs"></a>27.7.2.1. Prerequisites</h4></div></div></div><a id="idp86405200" class="indexterm"></a><p>This section is very technical in nature, so background
	  knowledge is required.  It is assumed that you are familiar with
	  the TCP/IP network protocol, and in particular, network and node
	  addressing, network address masks, subnetting, routing, and
	  routing protocols, such as RIP.  Configuring SLIP services on a
	  dial-up server requires a knowledge of these concepts, and if
	  you are not familiar with them, please read a copy of either
	  Craig Hunt's <span class="emphasis"><em>TCP/IP Network Administration</em></span>
	  published by O'Reilly &amp; Associates, Inc. (ISBN Number
	  0-937175-82-X), or Douglas Comer's books on the TCP/IP
	  protocol.</p><a id="idp86406480" class="indexterm"></a><p>It is further assumed that you have already set up your
	  modem(s) and configured the appropriate system files to allow
	  logins through your modems.  If you have not prepared your
	  system for this yet, please see <a class="xref" href="dialup.html" title="26.4. Dial-in Service">節 26.4, “Dial-in Service”</a> for details on dialup services
	  configuration.
	  You may also want to check the manual pages for <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sio&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sio</span>(4)</span></a> for
	  information on the serial port device driver and <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ttys&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ttys</span>(5)</span></a>,
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gettytab&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">gettytab</span>(5)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=getty&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">getty</span>(8)</span></a>, &amp; <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=init&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">init</span>(8)</span></a> for
	  information relevant to configuring the system to accept logins
	  on modems, and perhaps <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stty&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stty</span>(1)</span></a> for information on setting
	  serial port parameters (such as <code class="literal">clocal</code> for
	  directly-connected serial interfaces).</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86421200"></a>27.7.2.2. Quick Overview</h4></div></div></div><p>In its typical configuration, using FreeBSD as a SLIP server
	  works as follows:  a SLIP user dials up your FreeBSD SLIP Server
	  system and logs in with a special SLIP login ID that uses
	  <code class="filename">/usr/sbin/sliplogin</code> as the special user's
	  shell.  The <code class="command">sliplogin</code> program browses the
	  file <code class="filename">/etc/sliphome/slip.hosts</code> to find a
	  matching line for the special user, and if it finds a match,
	  connects the serial line to an available SLIP interface and then
	  runs the shell script
	  <code class="filename">/etc/sliphome/slip.login</code> to configure the
	  SLIP interface.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86423760"></a>27.7.2.2.1. An Example of a SLIP Server Login</h5></div></div></div><p>For example, if a SLIP user ID were
	    <code class="systemitem">Shelmerg</code>, <code class="systemitem">Shelmerg</code>'s
	    entry in <code class="filename">/etc/master.passwd</code> would look
	    something like this:</p><pre class="programlisting">Shelmerg:password:1964:89::0:0:Guy Helmer - SLIP:/usr/users/Shelmerg:/usr/sbin/sliplogin</pre><p>When <code class="systemitem">Shelmerg</code> logs in,
	    <code class="command">sliplogin</code> will search
	    <code class="filename">/etc/sliphome/slip.hosts</code> for a line that
	    had a matching user ID; for example, there may be a line in
	    <code class="filename">/etc/sliphome/slip.hosts</code> that
	    reads:</p><pre class="programlisting">Shelmerg        dc-slip sl-helmer       0xfffffc00		  autocomp</pre><p><code class="command">sliplogin</code> will find that matching line,
	    hook the serial line into the next available SLIP interface,
	    and then execute <code class="filename">/etc/sliphome/slip.login</code>
	    like this:</p><pre class="programlisting">/etc/sliphome/slip.login 0 19200 Shelmerg dc-slip sl-helmer 0xfffffc00 autocomp</pre><p>If all goes well,
	    <code class="filename">/etc/sliphome/slip.login</code> will issue an
	    <code class="command">ifconfig</code> for the SLIP interface to which
	    <code class="command">sliplogin</code> attached itself (SLIP interface
	    0, in the above example, which was the first parameter in the
	    list given to <code class="filename">slip.login</code>) to set the
	    local IP address (<code class="systemitem">dc-slip</code>), remote IP address
	    (<code class="systemitem">sl-helmer</code>), network mask for the SLIP
	    interface (<code class="systemitem">0xfffffc00</code>), and
	    any additional flags (<code class="literal">autocomp</code>).  If
	    something goes wrong, <code class="command">sliplogin</code> usually
	    logs good informational messages via the
	    <span class="application">syslogd</span> daemon facility, which usually logs
	    to <code class="filename">/var/log/messages</code> (see the manual
	    pages for <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">syslogd</span>(8)</span></a> and <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslog.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">syslog.conf</span>(5)</span></a> and perhaps
	    check <code class="filename">/etc/syslog.conf</code> to see to what
	    <span class="application">syslogd</span> is logging and where it is
	    logging to).</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86446416"></a>27.7.2.3. Kernel Configuration</h4></div></div></div><a id="idp86447056" class="indexterm"></a><a id="idp86447824" class="indexterm"></a><p>FreeBSD's default kernel (<code class="filename">GENERIC</code>)
	  comes with SLIP (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sl&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sl</span>(4)</span></a>) support; in case of a custom
	  kernel, you have to add the following line to your kernel
	  configuration file:</p><pre class="programlisting">device   sl</pre><p>Under FreeBSD 4.X, use instead the following
	  line:</p><pre class="programlisting">pseudo-device   sl      2</pre><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">The number at the end of the line is the maximum
	    number of SLIP connections that may be operating
	    simultaneously.  Since FreeBSD 5.0, the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sl&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sl</span>(4)</span></a>
	    driver is <span class="quote">“<span class="quote">auto-cloning</span>”</span>.</p></div><p>By default, your FreeBSD machine will not forward packets.
	  If you want your FreeBSD SLIP Server to act as a router, you
	  will have to edit the <code class="filename">/etc/rc.conf</code> file and
	  change the setting of the <code class="literal">gateway_enable</code> variable to
	  <code class="option">YES</code>.</p><p>You will then need to reboot for the new settings to take
	  effect.</p><p>Please refer to <a class="xref" href="kernelconfig.html" title="章 9. 設定 FreeBSD Kernel">章 9, <em>設定 FreeBSD Kernel</em></a> on
	  Configuring the FreeBSD Kernel for help in
	  reconfiguring your kernel.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86460112"></a>27.7.2.4. Sliplogin Configuration</h4></div></div></div><p>As mentioned earlier, there are three files in the
	  <code class="filename">/etc/sliphome</code> directory that are part of
	  the configuration for <code class="filename">/usr/sbin/sliplogin</code>
	  (see <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sliplogin&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sliplogin</span>(8)</span></a> for the actual manual page for
	  <code class="command">sliplogin</code>): <code class="filename">slip.hosts</code>,
	  which defines the SLIP users and their associated IP
	  addresses; <code class="filename">slip.login</code>, which usually just
	  configures the SLIP interface; and (optionally)
	  <code class="filename">slip.logout</code>, which undoes
	  <code class="filename">slip.login</code>'s effects when the serial
	  connection is terminated.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86464720"></a>27.7.2.4.1. <code class="filename">slip.hosts</code> Configuration</h5></div></div></div><p><code class="filename">/etc/sliphome/slip.hosts</code> contains
	    lines which have at least four items separated by
	    whitespace:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>SLIP user's login ID</p></li><li class="listitem"><p>Local address (local to the SLIP server) of the SLIP
		link</p></li><li class="listitem"><p>Remote address of the SLIP link</p></li><li class="listitem"><p>Network mask</p></li></ul></div><p>The local and remote addresses may be host names
	    (resolved to IP addresses by
	    <code class="filename">/etc/hosts</code> or by the domain name
	    service, depending on your specifications in the file
	    <code class="filename">/etc/nsswitch.conf</code>,
	    or in <code class="filename">/etc/host.conf</code>
	    if you use FreeBSD 4.X), and the network mask may be
	    a name that can be resolved by a lookup into
	    <code class="filename">/etc/networks</code>.  On a sample system,
	    <code class="filename">/etc/sliphome/slip.hosts</code> looks like
	    this:</p><pre class="programlisting">#
# login local-addr      remote-addr     mask            opt1    opt2
#                                               (normal,compress,noicmp)
#
Shelmerg  dc-slip       sl-helmerg      0xfffffc00      autocomp</pre><p>At the end of the line is one or more of the
	    options:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="option">normal</code> —— no header
		compression</p></li><li class="listitem"><p><code class="option">compress</code> —— compress
		headers</p></li><li class="listitem"><p><code class="option">autocomp</code> —— compress headers if
		the remote end allows it</p></li><li class="listitem"><p><code class="option">noicmp</code> —— disable ICMP packets
		(so any <span class="quote">“<span class="quote">ping</span>”</span> packets will be dropped instead
		of using up your bandwidth)</p></li></ul></div><a id="idp86481872" class="indexterm"></a><a id="idp86482384" class="indexterm"></a><p>Your choice of local and remote addresses for your SLIP
	    links depends on whether you are going to dedicate a TCP/IP
	    subnet or if you are going to use <span class="quote">“<span class="quote">proxy ARP</span>”</span> on
	    your SLIP server (it is not <span class="quote">“<span class="quote">true</span>”</span> proxy ARP, but
	    that is the terminology used in this section to describe it).
	    If you are not sure which method to select or how to assign IP
	    addresses, please refer to the TCP/IP books referenced in
	    the SLIP Prerequisites (<a class="xref" href="slip.html#slips-prereqs" title="27.7.2.1. Prerequisites">節 27.7.2.1, “Prerequisites”</a>)
	    and/or consult your IP network manager.</p><p>If you are going to use a separate subnet for your SLIP
	    clients, you will need to allocate the subnet number out of
	    your assigned IP network number and assign each of your SLIP
	    client's IP numbers out of that subnet.  Then, you will
	    probably need to configure a static route to the SLIP
	    subnet via your SLIP server on your nearest IP router.</p><a id="idp86484944" class="indexterm"></a><p>Otherwise, if you will use the <span class="quote">“<span class="quote">proxy ARP</span>”</span>
	    method, you will need to assign your SLIP client's IP
	    addresses out of your SLIP server's Ethernet subnet, and you
	    will also need to adjust your
	    <code class="filename">/etc/sliphome/slip.login</code> and
	    <code class="filename">/etc/sliphome/slip.logout</code> scripts to use
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=arp&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">arp</span>(8)</span></a> to manage the proxy-ARP entries in the SLIP
	    server's ARP table.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86487888"></a>27.7.2.4.2. <code class="filename">slip.login</code> Configuration</h5></div></div></div><p>The typical <code class="filename">/etc/sliphome/slip.login</code>
	    file looks like this:</p><pre class="programlisting">#!/bin/sh -
#
#       @(#)slip.login  5.1 (Berkeley) 7/1/90

#
# generic login file for a slip line.  sliplogin invokes this with
# the parameters:
#      1        2         3        4          5         6     7-n
#   slipunit ttyspeed loginname local-addr remote-addr mask opt-args
#
/sbin/ifconfig sl$1 inet $4 $5 netmask $6</pre><p>This <code class="filename">slip.login</code> file merely runs
	    <code class="command">ifconfig</code> for the appropriate SLIP interface
	    with the local and remote addresses and network mask of the
	    SLIP interface.</p><p>If you have decided to use the <span class="quote">“<span class="quote">proxy ARP</span>”</span>
	    method (instead of using a separate subnet for your SLIP
	    clients), your <code class="filename">/etc/sliphome/slip.login</code>
	    file will need to look something like this:</p><pre class="programlisting">#!/bin/sh -
#
#       @(#)slip.login  5.1 (Berkeley) 7/1/90

#
# generic login file for a slip line.  sliplogin invokes this with
# the parameters:
#      1        2         3        4          5         6     7-n
#   slipunit ttyspeed loginname local-addr remote-addr mask opt-args
#
/sbin/ifconfig sl$1 inet $4 $5 netmask $6
# Answer ARP requests for the SLIP client with our Ethernet addr
/usr/sbin/arp -s $5 00:11:22:33:44:55 pub</pre><p>The additional line in this
	    <code class="filename">slip.login</code>, <code class="command">arp -s
	    $5 00:11:22:33:44:55 pub</code>, creates an ARP entry
	    in the SLIP server's ARP table.  This ARP entry causes the
	    SLIP server to respond with the SLIP server's Ethernet MAC
	    address whenever another IP node on the Ethernet asks to
	    speak to the SLIP client's IP address.</p><a id="idp86498128" class="indexterm"></a><p>When using the example above, be sure to replace the
	    Ethernet MAC address (<code class="systemitem">00:11:22:33:44:55</code>) with the MAC address of
	    your system's Ethernet card, or your <span class="quote">“<span class="quote">proxy ARP</span>”</span>
	    will definitely not work!  You can discover your SLIP server's
	    Ethernet MAC address by looking at the results of running
	    <code class="command">netstat -i</code>; the second line of the output
	    should look something like:</p><pre class="screen">ed0   1500  &lt;Link&gt;0.2.c1.28.5f.4a         191923	0   129457     0   116</pre><p>This indicates that this particular system's Ethernet MAC
	    address is <code class="systemitem">00:02:c1:28:5f:4a</code>
	    —— the periods in the Ethernet MAC address given by
	    <code class="command">netstat -i</code> must be changed to colons and
	    leading zeros should be added to each single-digit hexadecimal
	    number to convert the address into the form that <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=arp&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">arp</span>(8)</span></a>
	    desires; see the manual page on <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=arp&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">arp</span>(8)</span></a> for complete
	    information on usage.</p><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">When you create
	      <code class="filename">/etc/sliphome/slip.login</code> and
	      <code class="filename">/etc/sliphome/slip.logout</code>, the
	      <span class="quote">“<span class="quote">execute</span>”</span> bit (i.e., <code class="command">chmod 755
	      /etc/sliphome/slip.login /etc/sliphome/slip.logout</code>)
	      must be set, or <code class="command">sliplogin</code> will be unable
	      to execute it.</p></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86523088"></a>27.7.2.4.3. <code class="filename">slip.logout</code> Configuration</h5></div></div></div><p><code class="filename">/etc/sliphome/slip.logout</code> is not
	    strictly needed (unless you are implementing <span class="quote">“<span class="quote">proxy
	    ARP</span>”</span>), but if you decide to create it, this is an
	    example of a basic
	    <code class="filename">slip.logout</code> script:</p><pre class="programlisting">#!/bin/sh -
#
#       slip.logout

#
# logout file for a slip line.  sliplogin invokes this with
# the parameters:
#      1        2         3        4          5         6     7-n
#   slipunit ttyspeed loginname local-addr remote-addr mask opt-args
#
/sbin/ifconfig sl$1 down</pre><p>If you are using <span class="quote">“<span class="quote">proxy ARP</span>”</span>, you will want to
	    have <code class="filename">/etc/sliphome/slip.logout</code> remove the
	    ARP entry for the SLIP client:</p><pre class="programlisting">#!/bin/sh -
#
#       @(#)slip.logout

#
# logout file for a slip line.  sliplogin invokes this with
# the parameters:
#      1        2         3        4          5         6     7-n
#   slipunit ttyspeed loginname local-addr remote-addr mask opt-args
#
/sbin/ifconfig sl$1 down
# Quit answering ARP requests for the SLIP client
/usr/sbin/arp -d $5</pre><p>The <code class="command">arp -d $5</code> removes the ARP entry
	    that the <span class="quote">“<span class="quote">proxy ARP</span>”</span>
	    <code class="filename">slip.login</code> added when the SLIP client
	    logged in.</p><p>It bears repeating: make sure
	    <code class="filename">/etc/sliphome/slip.logout</code> has the execute
	    bit set after you create it (i.e., <code class="command">chmod 755
	    /etc/sliphome/slip.logout</code>).</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86559056"></a>27.7.2.5. Routing Considerations</h4></div></div></div><a id="idp86559696" class="indexterm"></a><p>If you are not using the <span class="quote">“<span class="quote">proxy ARP</span>”</span> method for
	  routing packets between your SLIP clients and the rest of your
	  network (and perhaps the Internet), you will probably
	  have to add static routes to your closest default router(s) to
	  route your SLIP clients subnet via your SLIP server.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86561616"></a>27.7.2.5.1. Static Routes</h5></div></div></div><a id="idp86562256" class="indexterm"></a><p>Adding static routes to your nearest default routers
	    can be troublesome (or impossible if you do not have
	    authority to do so...).  If you have a multiple-router
	    network in your organization, some routers, such as those
	    made by Cisco and Proteon, may not only need to be
	    configured with the static route to the SLIP subnet, but
	    also need to be told which static routes to tell other
	    routers about, so some expertise and
	    troubleshooting/tweaking may be necessary to get
	    static-route-based routing to work.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86563280"></a>27.7.2.5.2. Running <span class="application"><span class="trademark">GateD</span>®</span></h5></div></div></div><a id="idp86564432" class="indexterm"></a><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml"><span class="application"><span class="trademark">GateD</span>®</span> is proprietary software now and
	    will not be available as source code to the public anymore
	    (more info on the <a class="link" href="http://www.gated.org/" target="_top"><span class="trademark">GateD</span>®</a> website). This
	    section only exists to ensure backwards compatibility for
	    those that are still using an older version.</p></div><p>An alternative to the headaches of static routes is to
	    install <span class="application"><span class="trademark">GateD</span>®</span> on your FreeBSD SLIP server
	    and configure it to use the appropriate routing protocols
	    (RIP/OSPF/BGP/EGP) to tell other routers about your SLIP
	    subnet.
	    You will need to write a <code class="filename">/etc/gated.conf</code>
	    file to configure your <span class="application"><span class="trademark">GateD</span>®</span>; here is a sample, similar to
	    what the author used on a FreeBSD SLIP server:</p><pre class="programlisting">#
# gated configuration file for dc.dsu.edu; for gated version 3.5alpha5
# Only broadcast RIP information for xxx.xxx.yy out the ed Ethernet interface
#
#
# tracing options
#
traceoptions "/var/tmp/gated.output" replace size 100k files 2 general ;

rip yes {
  interface sl noripout noripin ;
  interface ed ripin ripout version 1 ;
  traceoptions route ;
} ;

#
# Turn on a bunch of tracing info for the interface to the kernel:
kernel {
  traceoptions remnants request routes info interface ;
} ;

#
# Propagate the route to xxx.xxx.yy out the Ethernet interface via RIP
#

export proto rip interface ed {
  proto direct {
      <em class="replaceable"><code>xxx.xxx.yy</code></em> mask 255.255.252.0 metric 1; # SLIP connections
  } ;
} ;

#
# Accept routes from RIP via ed Ethernet interfaces

import proto rip interface ed {
  all ;
} ;</pre><a id="idp86570704" class="indexterm"></a><p>The above sample <code class="filename">gated.conf</code> file
	    broadcasts routing information regarding the SLIP subnet
	    <em class="replaceable"><code>xxx.xxx.yy</code></em> via RIP onto the
	    Ethernet; if you are using a different Ethernet driver than
	    the <code class="filename">ed</code> driver, you will need to
	    change the references to the <code class="filename">ed</code>
	    interface appropriately.  This sample file also sets up
	    tracing to <code class="filename">/var/tmp/gated.output</code> for
	    debugging <span class="application"><span class="trademark">GateD</span>®</span>'s activity; you can
	    certainly turn off the tracing options if
	    <span class="application"><span class="trademark">GateD</span>®</span> works correctly for you.  You will need to
	    change the <em class="replaceable"><code>xxx.xxx.yy</code></em>'s into the
	    network address of your own SLIP subnet (be sure to change the
	    net mask in the <code class="literal">proto direct</code> clause as
	    well).</p><p>Once you have installed and configured
	    <span class="application"><span class="trademark">GateD</span>®</span> on your system, you will need to
	    tell the FreeBSD startup scripts to run
	    <span class="application"><span class="trademark">GateD</span>®</span> in place of
	    <span class="application">routed</span>.  The easiest way to accomplish
	    this is to set the <code class="varname">router</code> and
	    <code class="varname">router_flags</code> variables in
	    <code class="filename">/etc/rc.conf</code>.  Please see the manual
	    page for <span class="application"><span class="trademark">GateD</span>®</span> for information on
	    command-line parameters.</p></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="pppoa.html">前一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="ppp-and-slip.html">上一層</a></td><td width="40%" align="right"> <a accesskey="n" href="mail.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">27.6. Using <span class="application">PPP</span> over ATM (PPPoA) </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 章 28. 電子郵件</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文及其他文件，可由此下載：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>若有 FreeBSD 方面疑問，請先閱讀
    <a href="http://www.FreeBSD.org/docs.html">FreeBSD 相關文件</a>，如不能解決的話，再洽詢
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;。<br></br>
    關於本文件的問題，請洽詢
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;。</small></p></body></html>