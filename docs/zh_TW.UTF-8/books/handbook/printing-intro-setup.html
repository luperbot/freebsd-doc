<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>10.3. 基礎設定</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 使用手冊" /><link rel="up" href="printing.html" title="章 10. 列印" /><link rel="prev" href="printing-intro-spooler.html" title="10.2. 介紹" /><link rel="next" href="printing-advanced.html" title="10.4. Advanced Printer Setup" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">10.3. 基礎設定</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="printing-intro-spooler.html">前一頁</a> </td><th width="60%" align="center">章 10. 列印</th><td width="20%" align="right"> <a accesskey="n" href="printing-advanced.html">下一頁</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="printing-intro-setup"></a>10.3. 基礎設定</h2></div></div></div><p>要用印表機搭配 <span class="application">LPD</span>
      多工緩衝系統，您需要有印表機這個硬體以及
      <span class="application">LPD</span> 這套軟體。
      本手冊提供了兩階段的設定說明：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>閱讀 <a class="link" href="printing-intro-setup.html#printing-simple" title="10.3.1. 簡易印表機設定">簡易印表機設定</a>
	  來學習如何連接印表機、讓印表機和 <span class="application">LPD</span>
	  溝通以及列印純文字文件。</p></li><li class="listitem"><p>閱讀 <a class="link" href="printing-advanced.html" title="10.4. Advanced Printer Setup">進階印表機設定</a>
	  來學習如何列印各種特殊格式文件、列印首頁、網路列印、
	  控制印表機權限以及統計使用狀況等。</p></li></ul></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-simple"></a>10.3.1. 簡易印表機設定</h3></div></div></div><p>本章節會告訴您如何設定印表機設備和
	<span class="application">LPD</span> 軟體以使用印表機，
	  基本教學內容：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="printing-intro-setup.html#printing-hardware" title="10.3.1.1. 硬體設定">硬體設定</a>
	    會提示如何將印表機接上電腦的連接埠。</p></li><li class="listitem"><p><a class="link" href="printing-intro-setup.html#printing-software" title="10.3.1.2. Software Setup">軟體設定</a>
	    會示範如何寫 <span class="application">LPD</span> 緩衝器設定檔
	    (<code class="filename">/etc/printcap</code>)。</p></li></ul></div><p>如果您要把印表機設定接收網路列印資料而不是本機端的話，請參考
	<a class="link" href="printing-advanced.html#printing-advanced-network-net-if" title="10.4.3.2. Printers with Networked Data Stream Interfaces">
	印表機及網路資料傳輸介面</a>。</p><p>這個章節雖然叫做<span class="quote">“<span class="quote">簡易印表機設定</span>”</span>，
        實際上還是有點複雜的。 最困難的部份是讓你的印表機和電腦上的
	<span class="application">LPD</span> 緩衝器能夠正常運作。
	  一旦印表機可以正常工作之後，
	  像是印首頁或是做列印統計這些進階的功能就不難做到了。
	  </p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-hardware"></a>10.3.1.1. 硬體設定</h4></div></div></div><p>本章節討論各種連接印表機到 PC 的方式。
	  這裡會提到不同種類的連接埠和連接線，
	  以及為了讓 FreeBSD 能和印表機溝通您可能會需要開啟的核心參數等。
	  </p><p>如果您已經把印表機接上電腦，
	  而且在其他作業系統上有成功列印過的話，可以直接跳至
	  <a class="link" href="printing-intro-setup.html#printing-software" title="10.3.1.2. Software Setup">軟體設定</a>。</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-ports"></a>10.3.1.1.1. 連接埠和排線</h5></div></div></div><p>市售個人電腦印表機一般來說不出這三種界面：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="emphasis"><em>序列 (Serial)</em></span><a id="idp73376336" class="indexterm"></a>
		界面，又稱為 RS-232 或 COM 埠，
		用您電腦上的序列埠傳送資料到印表機。
		序列界面廣泛的為電腦業界所採用，
		所以排線容易取得，要設定連線並不困難。
		然而序列介面有時候會需要使用較特別的排線，
		這時候就有可能需要設定一些較為複雜的通訊參數了。
		大部份 PC 序列埠的傳輸速度最高只到 115200 bps，
		因此想要用序列埠來列印大圖是不切實際的。</p></li><li class="listitem"><p><span class="emphasis"><em>並列 (Parallel)</em></span><a id="idp73378000" class="indexterm"></a>
		界面利用電腦的並列埠將資料送到印表機。
		並列埠比 RS-232 序列埠還快，也是一種電腦業界常用的界面。
		這種界面的排線非常容易取得，但是較難用手工打造。
		通常來說並列界面並沒有什麼通訊參數需要指定，
		所以設定起來超級容易。</p><p>並列埠界面有時候也會被稱為 <span class="quote">“<span class="quote">Centronics</span>”</span><a id="idp73379408" class="indexterm"></a>
		界面，這是印表機的接頭的名稱。</p></li><li class="listitem"><p>USB<a id="idp73385168" class="indexterm"></a> 界面，也就是通用序列匯流排，傳輸速率比並列界面或是
		RS-232 序列界面都來得快，而且 USB 排線單純又便宜。
		對列印工作而言，USB 比 RS-232
		序列埠或是並列埠都來得好，但是在
		<span class="trademark">UNIX</span>® 系統上的支援度較差。 購買同時具有 USB
		及並列埠兩種界面的印表機可以避免掉這種問題。</p></li></ul></div><p>一般而言，並列界面只能提供單向傳輸
	    (電腦至印表機)，而要用 USB 才能提供雙向。 然而在 FreeBSD
	    下，使用較新的並列埠 (EPP 和 ECP) 以及印表機，再配合使用
	    IEEE-1284 相容排線也可以做到雙向溝通。</p><a id="idp73387216" class="indexterm"></a><p>電腦和印表機之間藉由並列埠行進雙向溝通的方式有兩種。
	    第一種是使用特製的、能和特定印表機溝通的 FreeBSD 印表機驅動程式。
	    這種方式在噴墨印表機上很常見，用來回報墨水存量以及其他狀態資訊等。
	    第二種方法是用 <span class="trademark">PostScript</span>®，如果印表機有支援的話。</p><p><span class="trademark">PostScript</span>® jobs are
	    actually programs sent to the printer; they need not produce
	    paper at all and may return results directly to the computer.
	    <span class="trademark">PostScript</span>® also uses two-way communication to tell the
	    computer about problems, such as errors in the <span class="trademark">PostScript</span>®
	    program or paper jams.  Your users may be appreciative of such
	    information.  Furthermore, the best way to do effective
	    accounting with a <span class="trademark">PostScript</span>® printer requires two-way
	    communication: you ask the printer for its page count (how
	    many pages it has printed in its lifetime), then send the
	    user's job, then ask again for its page count.  Subtract the
	    two values and you know how much paper to charge to the
	    user.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-parallel"></a>10.3.1.1.2. Parallel Ports</h5></div></div></div><p>To hook up a printer using a parallel interface, connect
	    the Centronics cable between the printer and the computer.
	    The instructions that came with the printer, the computer, or
	    both should give you complete guidance.</p><p>Remember which parallel port you used on the computer.
	    The first parallel port is <code class="filename">ppc0</code> to
	    FreeBSD; the second is <code class="filename">ppc1</code>, and so
	    on.  The printer device name uses the same scheme:
	    <code class="filename">/dev/lpt0</code> for the printer on the first
	    parallel ports etc.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-serial"></a>10.3.1.1.3. Serial Ports</h5></div></div></div><p>To hook up a printer using a serial interface, connect the
	    proper serial cable between the printer and the computer.  The
	    instructions that came with the printer, the computer, or both
	    should give you complete guidance.</p><p>If you are unsure what the <span class="quote">“<span class="quote">proper serial
	    cable</span>”</span> is, you may wish to try one of the following
	    alternatives:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A <span class="emphasis"><em>modem</em></span> cable connects each pin
		of the connector on one end of the cable straight through
		to its corresponding pin of the connector on the other
		end.  This type of cable is also known as a
		<span class="quote">“<span class="quote">DTE-to-DCE</span>”</span> cable.</p></li><li class="listitem"><p>A <span class="emphasis"><em>null-modem</em></span><a id="idp73398480" class="indexterm"></a> cable connects some
		pins straight through, swaps others (send data to receive
		data, for example), and shorts some internally in each
		connector hood.  This type of cable is also known as a
		<span class="quote">“<span class="quote">DTE-to-DTE</span>”</span> cable.</p></li><li class="listitem"><p>A <span class="emphasis"><em>serial printer</em></span> cable, required
		for some unusual printers, is like the null-modem cable,
		but sends some signals to their counterparts instead of
		being internally shorted.</p></li></ul></div><a id="idp73417424" class="indexterm"></a><a id="idp73417936" class="indexterm"></a><a id="idp73418448" class="indexterm"></a><p>You should also set up the communications parameters for
	    the printer, usually through front-panel controls or DIP
	    switches on the printer.  Choose the highest
	    <code class="literal">bps</code> (bits per second, sometimes
	    <span class="emphasis"><em>baud rate</em></span>) that both your computer
	    and the printer can support.  Choose 7 or 8 data bits; none,
	    even, or odd parity; and 1 or 2 stop bits.  Also choose a flow
	    control protocol:  either none, or XON/XOFF (also known as
	    <span class="quote">“<span class="quote">in-band</span>”</span> or <span class="quote">“<span class="quote">software</span>”</span>) flow control.
	    Remember these settings for the software configuration that
	    follows.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-software"></a>10.3.1.2. Software Setup</h4></div></div></div><p>This section describes the software setup necessary to print
	  with the <span class="application">LPD</span> spooling system in FreeBSD.
	</p><p>Here is an outline of the steps involved:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Configure your kernel, if necessary, for the port you
	      are using for the printer; section <a class="link" href="printing-intro-setup.html#printing-kernel" title="10.3.1.2.1. Kernel Configuration">Kernel Configuration</a> tells
	      you what you need to do.</p></li><li class="step"><p>Set the communications mode for the parallel port, if
	      you are using a parallel port; section <a class="link" href="printing-intro-setup.html#printing-parallel-port-mode" title="10.3.1.3. Setting the Communication Mode for the Parallel Port">Setting the
	      Communication Mode for the Parallel Port</a> gives
	      details.</p></li><li class="step"><p>Test if the operating system can send data to the printer.
	      Section <a class="link" href="printing-intro-setup.html#printing-testing" title="10.3.1.4. Checking Printer Communications">Checking Printer
	      Communications</a> gives some suggestions on how to do
	      this.</p></li><li class="step"><p>Set up <span class="application">LPD</span> for the printer by
	      modifying the file
	      <code class="filename">/etc/printcap</code>.  You will find out how
	      to do this later in this chapter.</p></li></ol></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-kernel"></a>10.3.1.2.1. Kernel Configuration</h5></div></div></div><p>The operating system kernel is compiled to work with a
	    specific set of devices.  The serial or parallel interface for
	    your printer is a part of that set.  Therefore, it might be
	    necessary to add support for an additional serial or parallel
	    port if your kernel is not already configured for one.</p><p>To find out if the kernel you are currently using supports
	    a serial interface, type:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>grep sioN /var/run/dmesg.boot</code></strong></pre><p>Where <em class="replaceable"><code>N</code></em> is the number of the
	    serial port, starting from zero.  If you see output similar to
	    the following:</p><pre class="screen">sio2 at port 0x3e8-0x3ef irq 5 on isa
sio2: type 16550A</pre><p>then the kernel supports the port.</p><p>To find out if the kernel supports a parallel interface,
	    type:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>grep ppcN /var/run/dmesg.boot</code></strong></pre><p>Where <em class="replaceable"><code>N</code></em> is the number of the
	    parallel port, starting from zero.  If you see output similar
	    to the following:</p><pre class="screen">ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
ppc0: SMC-like chipset (ECP/EPP/PS2/NIBBLE) in COMPATIBLE mode
ppc0: FIFO with 16/16/8 bytes threshold</pre><p>then the kernel supports the port.</p><p>You might have to reconfigure your kernel in order for the
	    operating system to recognize and use the parallel or serial
	    port you are using for the printer.</p><p>To add support for a serial port, see the section on
	    kernel configuration.  To add support for a parallel port, see
	    that section <span class="emphasis"><em>and</em></span> the section that
	    follows.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-parallel-port-mode"></a>10.3.1.3. Setting the Communication Mode for the Parallel
	    Port</h4></div></div></div><p>When you are using the parallel interface, you can choose
	    whether FreeBSD should use interrupt-driven or polled
	    communication with the printer.  The generic printer
	    device driver (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpt&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">lpt</span>(4)</span></a>) on FreeBSD
	    uses the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppbus&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ppbus</span>(4)</span></a> system, which controls the port
	    chipset with the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ppc</span>(4)</span></a> driver.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The <span class="emphasis"><em>interrupt-driven</em></span> method is
		the default with the GENERIC kernel.  With this method,
		the operating system uses an IRQ line to determine when
		the printer is ready for data.</p></li><li class="listitem"><p>The <span class="emphasis"><em>polled</em></span> method directs the
		operating system to repeatedly ask the printer if it is
		ready for more data.  When it responds ready, the kernel
		sends more data.</p></li></ul></div><p>The interrupt-driven method is usually somewhat faster
	    but uses up a precious IRQ line.  Some newer HP printers
	    are claimed not to work correctly in interrupt mode,
	    apparently due to some (not yet exactly understood) timing
	    problem.  These printers need polled mode.  You should use
	    whichever one works.  Some printers will work in both
	    modes, but are painfully slow in interrupt mode.</p><p>You can set the communications mode in two ways: by
	    configuring the kernel or by using the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lptcontrol</span>(8)</span></a>
	    program.</p><p><span class="emphasis"><em>To set the communications mode by configuring
	    the kernel:</em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Edit your kernel configuration file.  Look for
		an <code class="literal">ppc0</code> entry.  If you are setting up
		the second parallel port, use <code class="literal">ppc1</code>
		instead.  Use <code class="literal">ppc2</code> for the third port,
		and so on.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>If you want interrupt-driven mode, edit the following line:</p><pre class="programlisting">hint.ppc.0.irq="<em class="replaceable"><code>N</code></em>"</pre><p>in the <code class="filename">/boot/device.hints</code> file
		    and replace <em class="replaceable"><code>N</code></em> with the right
		    IRQ number.  The kernel configuration file must
		    also contain the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppc&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ppc</span>(4)</span></a> driver:</p><pre class="screen">device ppc</pre></li><li class="listitem"><p>If you want polled mode, remove in your
		    <code class="filename">/boot/device.hints</code> file, the
		    following line:</p><pre class="programlisting">hint.ppc.0.irq="<em class="replaceable"><code>N</code></em>"</pre><p>In some cases, this is not enough to put the
		    port in polled mode under FreeBSD.  Most of
		    time it comes from <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">acpi</span>(4)</span></a> driver, this latter
		    is able to probe and attach devices, and therefore,
		    control the access mode to the printer port.  You
		    should check your <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">acpi</span>(4)</span></a> configuration to
		    correct this problem.</p></li></ul></div></li><li class="step"><p>Save the file.  Then configure, build, and install the
		kernel, then reboot.  See <a class="link" href="kernelconfig.html" title="章 9. 設定 FreeBSD Kernel">kernel configuration</a> for
		more details.</p></li></ol></div><p><span class="emphasis"><em>To set the communications mode with</em></span>
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lptcontrol</span>(8)</span></a>:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Type:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptcontrol -i -d /dev/lptN</code></strong></pre><p>to set interrupt-driven mode for
		<code class="literal">lptN</code>.</p></li><li class="step"><p>Type:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptcontrol -p -d /dev/lptN</code></strong></pre><p>to set polled-mode for
		<code class="literal">lptN</code>.</p></li></ol></div><p>You could put these commands in your
	    <code class="filename">/etc/rc.local</code> file to set the mode each
	    time your system boots.  See <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lptcontrol</span>(8)</span></a> for more
	    information.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-testing"></a>10.3.1.4. Checking Printer Communications</h4></div></div></div><p>Before proceeding to configure the spooling system, you
	    should make sure the operating system can successfully send
	    data to your printer.  It is a lot easier to debug printer
	    communication and the spooling system separately.</p><p>To test the printer, we will send some text to it.  For
	    printers that can immediately print characters sent to them,
	    the program  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a> is perfect: it generates all 96
	    printable ASCII characters in 96 lines.</p><a id="idp73505232" class="indexterm"></a><p>For a <span class="trademark">PostScript</span>® (or other language-based) printer, we
	    will need a more sophisticated test.  A small <span class="trademark">PostScript</span>®
	    program, such as the following, will suffice:</p><pre class="programlisting">%!PS
100 100 moveto 300 300 lineto stroke
310 310 moveto /Helvetica findfont 12 scalefont setfont
(Is this thing working?) show
showpage</pre><p>The above <span class="trademark">PostScript</span>® code can be placed into a file and
	    used as shown in the examples appearing in the following
	    sections.</p><a id="idp73508560" class="indexterm"></a><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">When this document refers to a printer language, it is
	      assuming a language like <span class="trademark">PostScript</span>®, and not Hewlett
	      Packard's PCL.  Although PCL has great functionality, you
	      can intermingle plain text with its escape sequences.
	      <span class="trademark">PostScript</span>® cannot directly print plain text, and that is the
	      kind of printer language for which we must make special
	      accommodations.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-checking-parallel"></a>10.3.1.4.1. Checking a Parallel Printer</h5></div></div></div><a id="idp73519952" class="indexterm"></a><p>This section tells you how to check if FreeBSD can
	      communicate with a printer connected to a parallel
	      port.</p><p><span class="emphasis"><em>To test a printer on a parallel
	      port:</em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Become <code class="systemitem">root</code> with  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=su&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">su</span>(1)</span></a>.</p></li><li class="step"><p>Send data to the printer.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>If the printer can print plain text, then use
		      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a>.  Type:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptest &gt; /dev/lptN</code></strong></pre><p>Where <em class="replaceable"><code>N</code></em> is the number
		      of the parallel port, starting from zero.</p></li><li class="listitem"><p>If the printer understands <span class="trademark">PostScript</span>® or other
		      printer language, then send a small program to the
		      printer.  Type:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cat &gt; /dev/lptN</code></strong></pre><p>Then, line by line, type the program
		      <span class="emphasis"><em>carefully</em></span> as you cannot edit a
		      line once you have pressed <code class="literal">RETURN</code>
		      or <code class="literal">ENTER</code>.  When you have finished
		      entering the program, press
		      <code class="literal">CONTROL+D</code>, or whatever your end
		      of file key is.</p><p>Alternatively, you can put the program in a file
		      and type:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cat file &gt; /dev/lptN</code></strong></pre><p>Where <em class="replaceable"><code>file</code></em> is the
		      name of the file containing the program you want to
		      send to the printer.</p></li></ul></div></li></ol></div><p>You should see something print.  Do not worry if the
	      text does not look right; we will fix such things
	      later.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-checking-serial"></a>10.3.1.4.2. Checking a Serial Printer</h5></div></div></div><a id="idp73540816" class="indexterm"></a><p>This section tells you how to check if FreeBSD can
	      communicate with a printer on a serial port.</p><p><span class="emphasis"><em>To test a printer on a serial
	      port:</em></span></p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Become <code class="systemitem">root</code> with <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=su&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">su</span>(1)</span></a>.</p></li><li class="step"><p>Edit the file <code class="filename">/etc/remote</code>.  Add
		  the following entry:</p><pre class="programlisting">printer:dv=/dev/<em class="replaceable"><code>port</code></em>:br#<em class="replaceable"><code>bps-rate</code></em>:pa=<em class="replaceable"><code>parity</code></em></pre><a id="idp73547600" class="indexterm"></a><a id="idp73548112" class="indexterm"></a><a id="idp73548752" class="indexterm"></a><p>Where <em class="replaceable"><code>port</code></em> is the device
		  entry for the serial port (<code class="literal">ttyd0</code>,
		  <code class="literal">ttyd1</code>, etc.),
		  <em class="replaceable"><code>bps-rate</code></em> is the
		  bits-per-second rate at which the printer communicates,
		  and <em class="replaceable"><code>parity</code></em> is the parity
		  required by the printer (either <code class="literal">even</code>,
		  <code class="literal">odd</code>, <code class="literal">none</code>, or
		  <code class="literal">zero</code>).</p><p>Here is a sample entry for a printer connected via
		  a serial line to the third serial port at 19200 bps with
		  no parity:</p><pre class="programlisting">printer:dv=/dev/ttyd2:br#19200:pa=none</pre></li><li class="step"><p>Connect to the printer with <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a>.
		  Type:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>tip printer</code></strong></pre><p>If this step does not work, edit the file
		  <code class="filename">/etc/remote</code> again and try using
		  <code class="filename">/dev/cuaaN</code>
		  instead of
		  <code class="filename">/dev/ttydN</code>.</p></li><li class="step"><p>Send data to the printer.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>If the printer can print plain text, then use
		      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a>.  Type:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>$lptest</code></strong></pre></li><li class="listitem"><p>If the printer understands <span class="trademark">PostScript</span>® or other
		      printer language, then send a small program to the
		      printer.  Type the program, line by line,
		      <span class="emphasis"><em>very carefully</em></span> as backspacing
		      or other editing keys may be significant to the
		      printer.  You may also need to type a special
		      end-of-file key for the printer so it knows it
		      received the whole program.  For <span class="trademark">PostScript</span>®
		      printers, press <code class="literal">CONTROL+D</code>.</p><p>Alternatively, you can put the program in a file
		      and type:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>&gt;file</code></strong></pre><p>Where <em class="replaceable"><code>file</code></em> is the
		      name of the file containing the program.  After
		      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tip</span>(1)</span></a> sends the file, press any required
		      end-of-file key.</p></li></ul></div></li></ol></div><p>You should see something print.  Do not worry if the
	      text does not look right; we will fix that later.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-printcap"></a>10.3.1.5. Enabling the Spooler: the <code class="filename">/etc/printcap</code>
	  File</h4></div></div></div><p>At this point, your printer should be hooked up, your kernel
	  configured to communicate with it (if necessary), and you have
	  been able to send some simple data to the printer.  Now, we are
	  ready to configure <span class="application">LPD</span> to control access
	  to your printer.</p><p>You configure <span class="application">LPD</span> by editing the file
	  <code class="filename">/etc/printcap</code>.  The
	  <span class="application">LPD</span> spooling system
	  reads this file each time the spooler is used, so updates to the
	  file take immediate effect.</p><a id="idp73583952" class="indexterm"></a><p>The format of the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=printcap&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">printcap</span>(5)</span></a> file is straightforward.
	  Use your favorite text editor to make changes to
	  <code class="filename">/etc/printcap</code>.  The format is identical to
	  other capability files like
	  <code class="filename">/usr/share/misc/termcap</code> and
	  <code class="filename">/etc/remote</code>.  For complete information
	  about the format, see the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cgetent&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">cgetent</span>(3)</span></a>.</p><p>The simple spooler configuration consists of the following
	  steps:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Pick a name (and a few convenient aliases) for the
	      printer, and put them in the
	      <code class="filename">/etc/printcap</code> file; see the
	      <a class="link" href="printing-intro-setup.html#printing-naming" title="10.3.1.5.1. Naming the Printer">Naming the Printer</a>
	      section for more information on naming.</p></li><li class="step"><p>Turn off header pages<a id="idp73591120" class="indexterm"></a> (which are on by default) by
	      inserting the <code class="literal">sh</code> capability; see the
	      <a class="link" href="printing-intro-setup.html#printing-no-header-pages" title="10.3.1.5.2. Suppressing Header Pages">Suppressing Header
	      Pages</a> section for more information.</p></li><li class="step"><p>Make a spooling directory, and specify its location with
	      the <code class="literal">sd</code> capability; see the <a class="link" href="printing-intro-setup.html#printing-spooldir" title="10.3.1.5.3. Making the Spooling Directory">Making the Spooling
	      Directory</a> section for more information.</p></li><li class="step"><p>Set the <code class="filename">/dev</code> entry to use for the
	      printer, and note it in <code class="filename">/etc/printcap</code>
	      with the <code class="literal">lp</code> capability; see the <a class="link" href="printing-intro-setup.html#printing-device" title="10.3.1.5.4. Identifying the Printer Device">Identifying the Printer
	      Device</a> for more information.  Also, if the printer is
	      on a serial port, set up the communication parameters with
	      the <code class="literal">ms#</code> capability which is discussed in the <a class="link" href="printing-intro-setup.html#printing-commparam" title="10.3.1.5.5. Configuring Spooler Communication Parameters">Configuring Spooler
	      Communications Parameters</a> section.</p></li><li class="step"><p>Install a plain text input filter; see the <a class="link" href="printing-intro-setup.html#printing-textfilter" title="10.3.1.5.6. Installing the Text Filter">Installing the Text
	    Filter</a> section for details.</p></li><li class="step"><p>Test the setup by printing something with the
	      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> command.  More details are available in the
	      <a class="link" href="printing-intro-setup.html#printing-trying" title="10.3.1.5.8. Trying It Out">Trying It Out</a> and
	      <a class="link" href="printing-troubleshooting.html" title="10.7. Troubleshooting">Troubleshooting</a>
	      sections.</p></li></ol></div><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">Language-based printers, such as <span class="trademark">PostScript</span>® printers,
	    cannot directly print plain text.  The simple setup outlined
	    above and described in the following sections assumes that if
	    you are installing such a printer you will print only files
	    that the printer can understand.</p></div><p>Users often expect that they can print plain text to any of
	  the printers installed on your system.  Programs that interface
	  to <span class="application">LPD</span> to do their printing usually
	  make the same assumption.
	  If you are installing such a printer and want to be able to
	  print jobs in the printer language <span class="emphasis"><em>and</em></span>
	  print plain text jobs, you are strongly urged to add an
	  additional step to the simple setup outlined above: install an
	  automatic plain-text-to-<span class="trademark">PostScript</span>® (or other printer language)
	  conversion program.  The section entitled <a class="link" href="printing-advanced.html#printing-advanced-if-conversion" title="10.4.1.2. Accommodating Plain Text Jobs on PostScript® Printers">Accommodating Plain
	  Text Jobs on <span class="trademark">PostScript</span>® Printers</a> tells how to do
	  this.</p><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-naming"></a>10.3.1.5.1. Naming the Printer</h5></div></div></div><p>The first (easy) step is to pick a name for your printer.
	    It really does not matter whether you choose functional or
	    whimsical names since you can also provide a number of aliases
	    for the printer.</p><p>At least one of the printers specified in the
	    <code class="filename">/etc/printcap</code> should have the alias
	    <code class="literal">lp</code>.  This is the default printer's name.
	    If users do not have the <code class="envar">PRINTER</code> environment
	    variable nor specify a printer name on the command line of any
	    of the <span class="application">LPD</span> commands,
	    then <code class="literal">lp</code> will be the
	    default printer they get to use.</p><p>Also, it is common practice to make the last alias for a
	    printer be a full description of the printer, including make
	    and model.</p><p>Once you have picked a name and some common aliases, put
	    them in the <code class="filename">/etc/printcap</code> file.  The name
	    of the printer should start in the leftmost column.  Separate
	    each alias with a vertical bar and put a colon after the last
	    alias.</p><p>In the following example, we start with a skeletal
	    <code class="filename">/etc/printcap</code> that defines two printers
	    (a Diablo 630 line printer and a Panasonic KX-P4455 <span class="trademark">PostScript</span>®
	    laser printer):</p><pre class="programlisting">#
#  /etc/printcap for host rose
#
rattan|line|diablo|lp|Diablo 630 Line Printer:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:</pre><p>In this example, the first printer is named
	    <code class="literal">rattan</code> and has as aliases
	    <code class="literal">line</code>, <code class="literal">diablo</code>,
	    <code class="literal">lp</code>, and <code class="literal">Diablo 630 Line
	    Printer</code>.  Since it has the alias
	    <code class="literal">lp</code>, it is also the default printer.  The
	    second is named <code class="literal">bamboo</code>, and has as aliases
	    <code class="literal">ps</code>, <code class="literal">PS</code>,
	    <code class="literal">S</code>, <code class="literal">panasonic</code>, and
	    <code class="literal">Panasonic KX-P4455 PostScript v51.4</code>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-no-header-pages"></a>10.3.1.5.2. Suppressing Header Pages</h5></div></div></div><a id="idp73626704" class="indexterm"></a><p>The <span class="application">LPD</span> spooling system will
	    by default print a
	    <span class="emphasis"><em>header page</em></span> for each job.  The header
	    page contains the user name who requested the job, the host
	    from which the job came, and the name of the job, in nice
	    large letters.  Unfortunately, all this extra text gets in the
	    way of debugging the simple printer setup, so we will suppress
	    header pages.</p><p>To suppress header pages, add the <code class="literal">sh</code>
	    capability to the entry for the printer in
	    <code class="filename">/etc/printcap</code>.  Here is an example
	    <code class="filename">/etc/printcap</code> with <code class="literal">sh</code>
	    added:</p><pre class="programlisting">#
#  /etc/printcap for host rose - no header pages anywhere
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:</pre><p>Note how we used the correct format: the first line starts
	    in the leftmost column, and subsequent lines are indented.
	    Every line in an entry except the last ends in
	    a backslash character.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-spooldir"></a>10.3.1.5.3. Making the Spooling Directory</h5></div></div></div><a id="idp73632592" class="indexterm"></a><a id="idp73633104" class="indexterm"></a><p>The next step in the simple spooler setup is to make a
	    <span class="emphasis"><em>spooling directory</em></span>, a directory where
	    print jobs reside until they are printed, and where a number
	    of other spooler support files live.</p><p>Because of the variable nature of spooling directories, it
	    is customary to put these directories under
	    <code class="filename">/var/spool</code>.  It is not necessary to
	    backup the contents of spooling directories, either.
	    Recreating them is as simple as running <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mkdir&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">mkdir</span>(1)</span></a>.</p><p>It is also customary to make the directory with a name
	    that is identical to the name of the printer, as shown
	    below:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/printer-name</code></strong></pre><p>However, if you have a lot of printers on your network,
	    you might want to put the spooling directories under a single
	    directory that you reserve just for printing with
	    <span class="application">LPD</span>.  We
	    will do this for our two example printers
	    <code class="literal">rattan</code> and
	    <code class="literal">bamboo</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/lpd</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/lpd/rattan</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/spool/lpd/bamboo</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">If you are concerned about the privacy of jobs that
	      users print, you might want to protect the spooling
	      directory so it is not publicly accessible.  Spooling
	      directories should be owned and be readable, writable, and
	      searchable by user daemon and group daemon, and no one else.
	      We will do this for our example printers:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chown daemon:daemon /var/spool/lpd/rattan</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chown daemon:daemon /var/spool/lpd/bamboo</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chmod 770 /var/spool/lpd/rattan</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chmod 770 /var/spool/lpd/bamboo</code></strong></pre></div><p>Finally, you need to tell <span class="application">LPD</span>
	    about these directories
	    using the <code class="filename">/etc/printcap</code> file.  You
	    specify the pathname of the spooling directory with the
	    <code class="literal">sd</code> capability:</p><pre class="programlisting">#
#  /etc/printcap for host rose - added spooling directories
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:</pre><p>Note that the name of the printer starts in the first
	    column but all other entries describing the printer should be
	    indented and each line end escaped with a
	    backslash.</p><p>If you do not specify a spooling directory with
	    <code class="literal">sd</code>, the spooling system will use
	    <code class="filename">/var/spool/lpd</code> as a default.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-device"></a>10.3.1.5.4. Identifying the Printer Device</h5></div></div></div><p>In the
	     Entries for the Ports
	    section, we identified which entry in the
	    <code class="filename">/dev</code> directory FreeBSD will use to
	    communicate with the printer.  Now, we tell
	    <span class="application">LPD</span> that
	    information.  When the spooling system has a job to print, it
	    will open the specified device on behalf of the filter program
	    (which is responsible for passing data to the printer).</p><p>List the <code class="filename">/dev</code> entry pathname in the
	    <code class="filename">/etc/printcap</code> file using the
	    <code class="literal">lp</code> capability.</p><p>In our running example, let us assume that
	    <code class="literal">rattan</code> is on the first parallel port, and
	    <code class="literal">bamboo</code> is on a sixth serial port; here are
	    the additions to <code class="filename">/etc/printcap</code>:</p><pre class="programlisting">#
#  /etc/printcap for host rose - identified what devices to use
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:</pre><p>If you do not specify the <code class="literal">lp</code> capability
	    for a printer in your <code class="filename">/etc/printcap</code> file,
	    <span class="application">LPD</span> uses <code class="filename">/dev/lp</code>
	    as a default.
	    <code class="filename">/dev/lp</code> currently does not exist in
	    FreeBSD.</p><p>If the printer you are installing is connected to a
	    parallel port, skip to the section entitled, <a class="link" href="printing-intro-setup.html#printing-textfilter" title="10.3.1.5.6. Installing the Text Filter">Installing the Text
	    Filter</a>.  Otherwise, be sure to follow the instructions
	    in the next section.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-commparam"></a>10.3.1.5.5. Configuring Spooler Communication Parameters</h5></div></div></div><a id="idp73675472" class="indexterm"></a><p>For printers on serial ports, <span class="application">LPD</span>
	    can set up the bps rate,
	    parity, and other serial communication parameters on behalf of
	    the filter program that sends data to the printer.  This is
	    advantageous since:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>It lets you try different communication parameters by
		simply editing the <code class="filename">/etc/printcap</code>
		file; you do not have to recompile the filter
		program.</p></li><li class="listitem"><p>It enables the spooling system to use the same filter
		program for multiple printers which may have different
		serial communication settings.</p></li></ul></div><p>The following <code class="filename">/etc/printcap</code>
	    capabilities control serial communication parameters of the
	    device listed in the <code class="literal">lp</code> capability:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">br#bps-rate</code></span></dt><dd><p>Sets the communications speed of the device to
		  <em class="replaceable"><code>bps-rate</code></em>, where
		  <em class="replaceable"><code>bps-rate</code></em> can be 50, 75, 110,
		  134, 150, 200, 300, 600, 1200, 1800, 2400, 4800, 9600,
		  19200, 38400, 57600, or 115200 bits-per-second.</p></dd><dt><span class="term"><code class="literal">ms#stty-mode</code></span></dt><dd><p>Sets the options for the terminal device after
		  opening the device.  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stty&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stty</span>(1)</span></a> explains the
		  available options.</p></dd></dl></div><p>When <span class="application">LPD</span> opens the device
	    specified by the <code class="literal">lp</code> capability, it sets
	    the characteristics of the device to those specified with
	    the <code class="literal">ms#</code> capability.  Of particular
	    interest will be the <code class="literal">parenb</code>,
	    <code class="literal">parodd</code>, <code class="literal">cs5</code>,
	    <code class="literal">cs6</code>, <code class="literal">cs7</code>,
	    <code class="literal">cs8</code>, <code class="literal">cstopb</code>,
	    <code class="literal">crtscts</code>, and <code class="literal">ixon</code>
	    modes, which are explained in the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stty&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stty</span>(1)</span></a>
	    manual page.</p><p>Let us add to our example printer on the sixth serial
	    port.  We will set the bps rate to 38400.  For the mode,
	    we will set no parity with <code class="literal">-parenb</code>,
	    8-bit characters with <code class="literal">cs8</code>,
	    no modem control with <code class="literal">clocal</code> and
	    hardware flow control with <code class="literal">crtscts</code>:</p><pre class="programlisting">bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:</pre></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-textfilter"></a>10.3.1.5.6. Installing the Text Filter</h5></div></div></div><a id="idp73695312" class="indexterm"></a><p>We are now ready to tell <span class="application">LPD</span>
	    what text filter to use to
	    send jobs to the printer.  A <span class="emphasis"><em>text filter</em></span>,
	    also known as an <span class="emphasis"><em>input filter</em></span>, is a
	    program that <span class="application">LPD</span> runs when it
	    has a job to print.  When <span class="application">LPD</span>
	    runs the text filter for a printer, it sets the filter's
	    standard input to the job to print, and its standard output to
	    the printer device specified with the <code class="literal">lp</code>
	    capability.  The filter is expected to read the job from
	    standard input, perform any necessary translation for the
	    printer, and write the results to standard output, which will
	    get printed.  For more information on the text filter, see
	    the <a class="link" href="printing-advanced.html#printing-advanced-filters" title="10.4.1.1. How Filters Work">Filters</a>
	    section.</p><p>For our simple printer setup, the text filter can be a
	    small shell script that just executes
	    <code class="command">/bin/cat</code> to send the job to the printer.
	    FreeBSD comes with another filter called
	    <code class="filename">lpf</code> that handles backspacing and
	    underlining for printers that might not deal with such
	    character streams well.  And, of course, you can use any other
	    filter program you want.  The filter <code class="command">lpf</code> is
	    described in detail in section entitled <a class="link" href="printing-advanced.html#printing-advanced-lpf" title="10.4.1.6. lpf: a Text Filter">lpf: a Text
	    Filter</a>.</p><p>First, let us make the shell script
	    <code class="filename">/usr/local/libexec/if-simple</code> be a simple
	    text filter.  Put the following text into that file with your
	    favorite text editor:</p><pre class="programlisting">#!/bin/sh
#
# if-simple - Simple text input filter for lpd
# Installed in /usr/local/libexec/if-simple
#
# Simply copies stdin to stdout.  Ignores all filter arguments.

/bin/cat &amp;&amp; exit 0
exit 2</pre><p>Make the file executable:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chmod 555 /usr/local/libexec/if-simple</code></strong></pre><p>And then tell LPD to use it by specifying it with the
	    <code class="literal">if</code> capability in
	    <code class="filename">/etc/printcap</code>.  We will add it to the two
	    printers we have so far in the example
	    <code class="filename">/etc/printcap</code>:</p><pre class="programlisting">#
#  /etc/printcap for host rose - added text filter
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\ :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:\
        :if=/usr/local/libexec/if-simple:</pre><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">A copy of the <code class="filename">if-simple</code> script
	      can be found in the <code class="filename">/usr/share/examples/printing</code>
	      directory.</p></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp73711952"></a>10.3.1.5.7. Turn on <span class="application">LPD</span></h5></div></div></div><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lpd</span>(8)</span></a> is run from <code class="filename">/etc/rc</code>,
	    controlled by the <code class="literal">lpd_enable</code> variable.  This
	    variable defaults to <code class="literal">NO</code>.  If you have not done
	    so already, add the line:</p><pre class="programlisting">lpd_enable="YES"</pre><p>to <code class="filename">/etc/rc.conf</code>, and then either restart
	    your machine, or just run <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">lpd</span>(8)</span></a>.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lpd</code></strong></pre></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="printing-trying"></a>10.3.1.5.8. Trying It Out</h5></div></div></div><p>You have reached the end of the simple
	    <span class="application">LPD</span> setup.
	    Unfortunately, congratulations are not quite yet in order,
	    since we still have to test the setup and correct any
	    problems.  To test the setup, try printing something.  To
	    print with the <span class="application">LPD</span> system, you
	    use the command <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a>,
	    which submits a job for printing.</p><p>You can combine <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> with the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a>
	    program, introduced in section <a class="link" href="printing-intro-setup.html#printing-testing" title="10.3.1.4. Checking Printer Communications">Checking Printer
	    Communications</a> to generate some test text.</p><p><span class="emphasis"><em>To test the simple <span class="application">LPD</span>
	      setup:</em></span></p><p>Type:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lptest 20 5 | lpr -Pprinter-name</code></strong></pre><p>Where <em class="replaceable"><code>printer-name</code></em> is a the
	    name of a printer (or an alias) specified in
	    <code class="filename">/etc/printcap</code>.  To test the default
	    printer, type <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a> without any <code class="option">-P</code>
	    argument.  Again, if you are testing a printer that expects
	    <span class="trademark">PostScript</span>®, send a <span class="trademark">PostScript</span>® program in that language instead
	    of using <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a>.  You can do so by putting the program
	    in a file and typing <code class="command">lpr
	    file</code>.</p><p>For a <span class="trademark">PostScript</span>® printer, you should get the results of
	    the program.  If you are using <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a>, then your
	    results should look like the following:</p><pre class="programlisting">!"#$%&amp;'()*+,-./01234
"#$%&amp;'()*+,-./012345
#$%&amp;'()*+,-./0123456
$%&amp;'()*+,-./01234567
%&amp;'()*+,-./012345678</pre><p>To further test the printer, try downloading larger
	    programs (for language-based printers) or running
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">lptest</span>(1)</span></a> with different arguments.  For example,
	    <code class="command">lptest 80 60</code> will produce 60 lines of 80
	    characters each.</p><p>If the printer did not work, see the <a class="link" href="printing-troubleshooting.html" title="10.7. Troubleshooting">Troubleshooting</a>
	    section.</p></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="printing-intro-spooler.html">前一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="printing.html">上一層</a></td><td width="40%" align="right"> <a accesskey="n" href="printing-advanced.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">10.2. 介紹 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 10.4. Advanced Printer Setup</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文及其他文件，可由此下載：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>若有 FreeBSD 方面疑問，請先閱讀
    <a href="http://www.FreeBSD.org/docs.html">FreeBSD 相關文件</a>，如不能解決的話，再洽詢
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;。<br></br>
    關於本文件的問題，請洽詢
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;。</small></p></body></html>