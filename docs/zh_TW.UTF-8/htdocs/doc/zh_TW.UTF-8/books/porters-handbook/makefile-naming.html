<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>5.2. Naming</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD Porter's Handbook" /><link rel="up" href="makefile.html" title="章 5. 設定 Makefile" /><link rel="prev" href="makefile.html" title="章 5. 設定 Makefile" /><link rel="next" href="makefile-categories.html" title="5.3. Categorization" /><link rel="copyright" href="trademarks.html" title="Legal Notice" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.2. Naming</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="makefile.html">前一頁</a> </td><th width="60%" align="center">章 5. 設定 Makefile</th><td width="20%" align="right"> <a accesskey="n" href="makefile-categories.html">下一頁</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-naming"></a>5.2. Naming</h2></div></div></div><p>The first part of the port's <code class="filename">Makefile</code> names
	the port, describes its version number, and lists it in the correct
	category.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp64047952"></a>5.2.1. <code class="varname">PORTNAME</code> and <code class="varname">PORTVERSION</code></h3></div></div></div><p>You should set <code class="varname">PORTNAME</code> to the
	  base name of your port, and <code class="varname">PORTVERSION</code>
	  to the version number of the port.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-naming-revepoch"></a>5.2.2. <code class="varname">PORTREVISION</code> and
	  <code class="varname">PORTEPOCH</code></h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp64066000"></a>5.2.2.1. <code class="varname">PORTREVISION</code></h4></div></div></div><p>The <code class="varname">PORTREVISION</code> variable is a
	    monotonically increasing value which is reset to 0 with
	    every increase of <code class="varname">PORTVERSION</code> (i.e.
	    every time a new official vendor release is made), and
	    appended to the package name if non-zero.
	    Changes to <code class="varname">PORTREVISION</code> are
	    used by automated tools (e.g.  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pkg_version&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pkg_version</span>(1)</span></a>)
	    to highlight the fact that a new package is
	    available.</p><p><code class="varname">PORTREVISION</code> should be increased
	    each time a change is made to the port which significantly
	    affects the content or structure of the derived
	    package.</p><p>Examples of when <code class="varname">PORTREVISION</code>
	    should be bumped:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Addition of patches to correct security
		vulnerabilities, bugs, or to add new functionality to
		the port.</p></li><li class="listitem"><p>Changes to the port <code class="filename">Makefile</code> to enable or disable
		compile-time options in the package.</p></li><li class="listitem"><p>Changes in the packing list or the install-time
		behavior of the package (e.g. change to a script
		which generates initial data for the package, like ssh
		host keys).</p></li><li class="listitem"><p>Version bump of a port's shared library dependency
		(in this case, someone trying to install the old
		package after installing a newer version of the
		dependency will fail since it will look for the old
		libfoo.x instead of libfoo.(x+1)).</p></li><li class="listitem"><p>Silent changes to the port distfile which have
		significant functional differences, i.e. changes to
		the distfile requiring a correction to
		<code class="filename">distinfo</code> with no corresponding change to
		<code class="varname">PORTVERSION</code>, where a <code class="command">diff
		-ru</code> of the old and new versions shows
		non-trivial changes to the code.</p></li></ul></div><p>Examples of changes which do not require a
	    <code class="varname">PORTREVISION</code> bump:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Style changes to the port skeleton with no
		functional change to what appears in the resulting
		package.</p></li><li class="listitem"><p>Changes to <code class="varname">MASTER_SITES</code> or
		other functional changes to the port which do not
		affect the resulting package.</p></li><li class="listitem"><p>Trivial patches to the distfile such as correction
		of typos, which are not important enough that users of
		the package should go to the trouble of
		upgrading.</p></li><li class="listitem"><p>Build fixes which cause a package to become
		compilable where it was previously failing (as long as
		the changes do not introduce any functional change on
		any other platforms on which the port did previously
		build). Since <code class="varname">PORTREVISION</code> reflects
		the content of the package, if the package was not
		previously buildable then there is no need to increase
		<code class="varname">PORTREVISION</code> to mark a
		change.</p></li></ul></div><p>A rule of thumb is to ask yourself whether a change
	    committed to a port is something which everyone
	    would benefit from having (either because of an
	    enhancement, fix, or by virtue that the new package will
	    actually work at all), and weigh that against that fact
	    that it will cause everyone who regularly updates their
	    ports tree to be compelled to update. If yes, the
	    <code class="varname">PORTREVISION</code> should be bumped.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp64128976"></a>5.2.2.2. <code class="varname">PORTEPOCH</code></h4></div></div></div><p>From time to time a software vendor or FreeBSD porter
	    will do something silly and release a version of their
	    software which is actually numerically less than the
	    previous version. An example of this is a port which goes
	    from foo-20000801 to foo-1.0 (the former will be
	    incorrectly treated as a newer version since 20000801 is a
	    numerically greater value than 1).</p><p>In situations such as this, the
	    <code class="varname">PORTEPOCH</code> version should be increased.
	    If <code class="varname">PORTEPOCH</code> is nonzero it is appended
	    to the package name as described in section 0 above.
	    <code class="varname">PORTEPOCH</code> must never be decreased or reset
	    to zero, because that would cause comparison to a package
	    from an earlier epoch to fail (i.e. the package would not
	    be detected as out of date): the new version number (e.g.
	    <code class="literal">1.0,1</code> in the above example) is still
	    numerically less than the previous version (20000801), but
	    the <code class="literal">,1</code> suffix is treated specially by
	    automated tools and found to be greater than the implied
	    suffix <code class="literal">,0</code> on the earlier package.</p><p>Dropping or resetting <code class="varname">PORTEPOCH</code>
	    incorrectly leads
	    to no end of grief; if you do not understand the above discussion,
	    please keep after it until you do, or ask questions on
	    the mailing lists.</p><p>It is expected that <code class="varname">PORTEPOCH</code> will
	    not be used for the majority of ports, and that sensible
	    use of <code class="varname">PORTVERSION</code> can often pre-empt
	    it becoming necessary if a future release of the software
	    should change the version structure. However, care is
	    needed by FreeBSD porters when a vendor release is made
	    without an official version number —— such as a code
	    <span class="quote">“<span class="quote">snapshot</span>”</span> release.  The temptation is to label the
	    release with the release date, which will cause problems
	    as in the example above when a new <span class="quote">“<span class="quote">official</span>”</span> release is
	    made.</p><p>For example, if a snapshot release is made on the date
	    20000917, and the previous version of the software was
	    version 1.2, the snapshot release should be given a
	    <code class="varname">PORTVERSION</code> of 1.2.20000917 or similar,
	    not 20000917, so that the succeeding release, say 1.3, is
	    still a numerically greater value.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp64156112"></a>5.2.2.3. Example of <code class="varname">PORTREVISION</code> and
	    <code class="varname">PORTEPOCH</code> usage</h4></div></div></div><p>The <code class="literal">gtkmumble</code> port, version
	    <code class="literal">0.10</code>, is committed to the ports
	    collection:</p><pre class="programlisting">PORTNAME=       gtkmumble
PORTVERSION=    0.10</pre><p><code class="varname">PKGNAME</code> becomes
	    <code class="literal">gtkmumble-0.10</code>.</p><p>A security hole is discovered which requires a local
	    FreeBSD patch. <code class="varname">PORTREVISION</code> is bumped
	    accordingly.</p><pre class="programlisting">PORTNAME=       gtkmumble
PORTVERSION=    0.10
PORTREVISION=   1</pre><p><code class="varname">PKGNAME</code> becomes
	    <code class="literal">gtkmumble-0.10_1</code></p><p>A new version is released by the vendor, numbered <code class="literal">0.2</code>
	    (it turns out the author actually intended
	    <code class="literal">0.10</code> to actually mean
	    <code class="literal">0.1.0</code>, not <span class="quote">“<span class="quote">what comes after
	      0.9</span>”</span> - oops, too late now). Since the new minor
	    version <code class="literal">2</code> is numerically less than the
	    previous version <code class="literal">10</code>, the
	    <code class="varname">PORTEPOCH</code> must be bumped to manually
	    force the new package to be detected as <span class="quote">“<span class="quote">newer</span>”</span>. Since it
	    is a new vendor release of the code,
	    <code class="varname">PORTREVISION</code> is reset to 0 (or removed
	    from the <code class="filename">Makefile</code>).</p><pre class="programlisting">PORTNAME=       gtkmumble
PORTVERSION=    0.2
PORTEPOCH=      1</pre><p><code class="varname">PKGNAME</code> becomes
	    <code class="literal">gtkmumble-0.2,1</code></p><p>The next release is 0.3. Since
	    <code class="varname">PORTEPOCH</code> never decreases, the version
	    variables are now:</p><pre class="programlisting">PORTNAME=       gtkmumble
PORTVERSION=    0.3
PORTEPOCH=      1</pre><p><code class="varname">PKGNAME</code> becomes
	    <code class="literal">gtkmumble-0.3,1</code></p><div xmlns="" class="note"><h3 class="admontitle">注意: </h3><p xmlns="http://www.w3.org/1999/xhtml">If <code class="varname">PORTEPOCH</code> were reset
	      to <code class="literal">0</code> with this upgrade, someone who had
	      installed the <code class="literal">gtkmumble-0.10_1</code> package would not detect
	      the <code class="literal">gtkmumble-0.3</code> package as newer, since
	      <code class="literal">3</code> is still numerically less than
	      <code class="literal">10</code>.  Remember, this is the whole point of
	      <code class="varname">PORTEPOCH</code> in the first place.</p></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp64218448"></a>5.2.3. <code class="varname">PKGNAMEPREFIX</code> and <code class="varname">PKGNAMESUFFIX</code></h3></div></div></div><p>Two optional variables, <code class="varname">PKGNAMEPREFIX</code> and
	  <code class="varname">PKGNAMESUFFIX</code>, are combined with
	  <code class="varname">PORTNAME</code> and
	  <code class="varname">PORTVERSION</code> to
	  form <code class="varname">PKGNAME</code> as
	  <code class="literal">${PKGNAMEPREFIX}${PORTNAME}${PKGNAMESUFFIX}-${PORTVERSION}</code>.
	  Make sure this conforms to our <a class="link" href="makefile-naming.html#porting-pkgname" title="5.2.5. Package Naming Conventions">guidelines for a good package
	  name</a>.  In particular, you are <span class="emphasis"><em>not</em></span> allowed to use a
	  hyphen (<code class="literal">-</code>) in
	  <code class="varname">PORTVERSION</code>.  Also, if the package name
	  has the <em class="replaceable"><code>language-</code></em> or the
	  <em class="replaceable"><code>-compiled.specifics</code></em> part (see below), use
	  <code class="varname">PKGNAMEPREFIX</code> and
	  <code class="varname">PKGNAMESUFFIX</code>, respectively.  Do not make
	  them part of <code class="varname">PORTNAME</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp64245712"></a>5.2.4. <code class="varname">LATEST_LINK</code></h3></div></div></div><p>在某些情況，可能會同時存在有不同版本的同一程式。
	  由於它們可能會有同樣的 <code class="varname">PORTNAME</code>、
	  <code class="varname">PKGNAMEPREFIX</code>，甚至
	  <code class="varname">PKGNAMESUFFIX</code> 也相同，所以得讓這些程式有所不同，
	  才能讓 port 的 index 以及 package 能順利產生。  遇到這類情況，
	  the optional <code class="varname">LATEST_LINK</code> variable should be set to
	  a different value for all ports except the <span class="quote">“<span class="quote">main</span>”</span>
	  one —— see the <code class="filename">editors/vim5</code> and
	  <code class="filename">editors/vim</code> ports, and the
	  <code class="filename">www/apache*</code> family for examples of its use.
	  Note that how to choose a <span class="quote">“<span class="quote">main</span>”</span> version ——
	  <span class="quote">“<span class="quote">most popular</span>”</span>, <span class="quote">“<span class="quote">best supported</span>”</span>,
	  <span class="quote">“<span class="quote">least patched</span>”</span>, and so on —— is outside the
	  scope of this handbook's recommendations; we only tell you how to
	  specify the other ports' versions after you have picked a
	  <span class="quote">“<span class="quote">main</span>”</span> one.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-pkgname"></a>5.2.5. Package Naming Conventions</h3></div></div></div><p>The following are the conventions you should follow in naming your
	packages.  This is to have our package directory easy to scan, as
	there are already thousands of packages and users are going to
	turn away if they hurt their eyes!</p><p>The package name should look like
	<code class="filename">language_region-name-compiled.specifics-version.numbers</code>.</p><p>The package name is defined as
	<code class="literal">${PKGNAMEPREFIX}${PORTNAME}${PKGNAMESUFFIX}-${PORTVERSION}</code>.
	Make sure to set the variables to conform to that format.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>FreeBSD strives to support the native language of its users.
	    The <em class="replaceable"><code>language-</code></em> part should be a two
	    letter abbreviation of the natural language defined by ISO-639 if
	    the port is specific to a certain language.  Examples are
	    <code class="literal">ja</code> for Japanese, <code class="literal">ru</code> for
	    Russian, <code class="literal">vi</code> for Vietnamese,
	    <code class="literal">zh</code> for Chinese, <code class="literal">ko</code> for
	    Korean and <code class="literal">de</code> for German.</p><p>If the port is specific to a certain region within the
	    language area, add the two letter country code as well.
	    Examples are <code class="literal">en_US</code> for US English and
	    <code class="literal">fr_CH</code> for Swiss French.</p><p>The <em class="replaceable"><code>language-</code></em> part should
	    be set in the <code class="varname">PKGNAMEPREFIX</code> variable.</p></li><li class="listitem"><p>The first letter of the <code class="filename">name</code> part
	    should be lowercase.  (The rest of the name may contain
	    capital letters, so use your own discretion when you are
	    converting a software name that has some capital letters in it.)
	    There is a tradition of naming <code class="literal">Perl 5</code> modules by
	    prepending <code class="literal">p5-</code> and converting the double-colon
	    separator to a hyphen; for example, the
	    <code class="literal">Data::Dumper</code> module becomes
	    <code class="literal">p5-Data-Dumper</code>.</p></li><li class="listitem"><p>Make sure that the port's name and version are clearly
	    separated and placed into the <code class="varname">PORTNAME</code> and
	    <code class="varname">PORTVERSION</code> variables.  The only reason for
	    <code class="varname">PORTNAME</code> to contain a version part is if
	    the upstream distribution is really named that way, as in
	    the <code class="filename">textproc/libxml2</code> or
	    <code class="filename">japanese/kinput2-freewnn</code> ports.  Otherwise,
	    the <code class="varname">PORTNAME</code> should not contain any
	    version-specific information.  It is quite normal for several
	    ports to have the same <code class="varname">PORTNAME</code>, as the
	    <code class="filename">www/apache*</code> ports do; in that case,
	    different versions (and different index entries) are
	    distinguished by the <code class="varname">PKGNAMEPREFIX</code>,
	    <code class="varname">PKGNAMESUFFIX</code>, and
	    <code class="varname">LATEST_LINK</code> values.</p></li><li class="listitem"><p>If the port can be built with different <a class="link" href="makefile-masterdir.html" title="5.8. MASTERDIR">hardcoded defaults</a> (usually
	    part of the directory name in a family of ports), the
	    <em class="replaceable"><code>-compiled.specifics</code></em> part should state
	    the compiled-in defaults (the hyphen is optional).  Examples are
	    papersize and font units.</p><p>The <em class="replaceable"><code>-compiled.specifics</code></em> part
	    should be set in the <code class="varname">PKGNAMESUFFIX</code>
	    variable.</p></li><li class="listitem"><p>The version string should follow a dash
	    (<code class="literal">-</code>) and be a period-separated list of
	    integers and single lowercase alphabetics.  In particular,
	    it is not permissible to have another dash inside the
	    version string.  The only exception is the string
	    <code class="literal">pl</code> (meaning <span class="quote">“<span class="quote">patchlevel</span>”</span>), which can be
	    used <span class="emphasis"><em>only</em></span> when there are no major and
	    minor version numbers in the software.  If the software
	    version has strings like <span class="quote">“<span class="quote">alpha</span>”</span>, <span class="quote">“<span class="quote">beta</span>”</span>, <span class="quote">“<span class="quote">rc</span>”</span>, or <span class="quote">“<span class="quote">pre</span>”</span>, take
	    the first letter and put it immediately after a period.
	    If the version string continues after those names, the
	    numbers should follow the single alphabet without an extra
	    period between them.</p><p>The idea is to make it easier to sort ports by looking
	    at the version string.  In particular, make sure version
	    number components are always delimited by a period, and
	    if the date is part of the string, use the
	    <code class="literal">yyyy.mm.dd</code>
	    format, not
	    <code class="literal">dd.mm.yyyy</code>
	    or the non-Y2K compliant
	    <code class="literal">yy.mm.dd</code>
	    format.</p></li></ol></div><p>Here are some (real) examples on how to convert the name
	as called by the software authors to a suitable package
	name:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /><col /><col /><col /></colgroup><thead><tr><th>Distribution Name</th><th><code class="varname">PKGNAMEPREFIX</code></th><th><code class="varname">PORTNAME</code></th><th><code class="varname">PKGNAMESUFFIX</code></th><th><code class="varname">PORTVERSION</code></th><th>Reason</th></tr></thead><tbody><tr><td>mule-2.2.2</td><td>(empty)</td><td>mule</td><td>(empty)</td><td>2.2.2</td><td>No changes required</td></tr><tr><td>EmiClock-1.0.2</td><td>(empty)</td><td>emiclock</td><td>(empty)</td><td>1.0.2</td><td>No uppercase names for single programs</td></tr><tr><td>rdist-1.3alpha</td><td>(empty)</td><td>rdist</td><td>(empty)</td><td>1.3.a</td><td>No strings like <code class="literal">alpha</code>
		allowed</td></tr><tr><td>es-0.9-beta1</td><td>(empty)</td><td>es</td><td>(empty)</td><td>0.9.b1</td><td>No strings like <code class="literal">beta</code>
		allowed</td></tr><tr><td>mailman-2.0rc3</td><td>(empty)</td><td>mailman</td><td>(empty)</td><td>2.0.r3</td><td>No strings like <code class="literal">rc</code>
		allowed</td></tr><tr><td>v3.3beta021.src</td><td>(empty)</td><td>tiff</td><td>(empty)</td><td>3.3</td><td>What the heck was that anyway?</td></tr><tr><td>tvtwm</td><td>(empty)</td><td>tvtwm</td><td>(empty)</td><td>pl11</td><td>Version string always required</td></tr><tr><td>piewm</td><td>(empty)</td><td>piewm</td><td>(empty)</td><td>1.0</td><td>Version string always required</td></tr><tr><td>xvgr-2.10pl1</td><td>(empty)</td><td>xvgr</td><td>(empty)</td><td>2.10.1</td><td><code class="literal">pl</code> allowed only when no
		major/minor version numbers</td></tr><tr><td>gawk-2.15.6</td><td>ja-</td><td>gawk</td><td>(empty)</td><td>2.15.6</td><td>Japanese language version</td></tr><tr><td>psutils-1.13</td><td>(empty)</td><td>psutils</td><td>-letter</td><td>1.13</td><td>Papersize hardcoded at package build time</td></tr><tr><td>pkfonts</td><td>(empty)</td><td>pkfonts</td><td>300</td><td>1.0</td><td>Package for 300dpi fonts</td></tr></tbody></table></div><p>If there is absolutely no trace of version information in the
	original source and it is unlikely that the original author will ever
	release another version, just set the version string to
	<code class="literal">1.0</code> (like the <code class="literal">piewm</code> example above).  Otherwise, ask
	the original author or use the date string
	(<code class="literal">yyyy.mm.dd</code>)
	as the version.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="makefile.html">前一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="makefile.html">上一層</a></td><td width="40%" align="right"> <a accesskey="n" href="makefile-categories.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">章 5. 設定 Makefile </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 5.3. Categorization</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文及其他文件，可由此下載：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>。</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>若有 FreeBSD 方面疑問，請先閱讀
    <a href="http://www.FreeBSD.org/docs.html">FreeBSD 相關文件</a>，如不能解決的話，再洽詢
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;。<br></br>
    關於本文件的問題，請洽詢
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;。</small></p></body></html>