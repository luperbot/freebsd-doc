<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>15.10. OpenSSH</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="security.html" title="Hoofdstuk 15. Beveiliging" /><link rel="prev" href="ipsec.html" title="15.9. VPN via IPsec" /><link rel="next" href="fs-acl.html" title="15.11. Bestandssysteem toegangscontrolelijsten (ACLs)" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.10. OpenSSH</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ipsec.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 15. Beveiliging</th><td width="20%" align="right"> <a accesskey="n" href="fs-acl.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="openssh"></a>15.10. OpenSSH</h2></div><div><span class="authorgroup">Bijgedragen door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Chern</span> <span class="surname">Lee</span></span>. </span></div></div></div><a id="idp77727056" class="indexterm"></a><a id="idp77727568" class="indexterm"></a><p><span class="application">OpenSSH</span> is een groep
      netwerkverbindingsprogramma's waarmee computers via het netwerk
      veilig benaderd kunnen worden.  Het kan ingezet worden als een
      directe vervanger van <code class="command">rlogin</code>,
      <code class="command">rsh</code>, <code class="command">rcp</code> en
      <code class="command">telnet</code>.  Daarnaast kunnen
      <acronym class="acronym">TCP</acronym>/<acronym class="acronym">IP</acronym>-verbindingen veilig
      getunneld of geforward worden door SSH.
      <span class="application">OpenSSH</span> versleutelt al het verkeer om
      afluisteren, het stelen van een verbinding en andere
      netwerkaanvallen effectief te voorkomen.</p><p><span class="application">OpenSSH</span> wordt onderhouden door het
      OpenBSD project en is gebaseerd op SSH v1.2.12 met alle recente
      bugfixes en updates.  Het is compatibel met beide protocollen SSH
      1 en 2.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77732688"></a>15.10.1. Voordelen van gebruik van OpenSSH</h3></div></div></div><p>Als gewoonlijk <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=telnet&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">telnet</span>(1)</span></a> of <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rlogin&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rlogin</span>(1)</span></a> wordt
	gebruikt, wordt de data in platte tekst en niet versleuteld
	verzonden.  Netwerksnuffelaars die ergens tussen de cliënt
	en de server meeluisteren, kunnen een gebruikersnaam en
	wachtwoord stelen en zien welke gegevens er worden overgezonden
	tijdens een sessie.  <span class="application">OpenSSH</span> biedt
	een verscheidenheid aan autenticatie en versleutelingsmethoden
	die het voorgaande voorkomen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77735888"></a>15.10.2. <span class="application">sshd</span> inschakelen</h3></div></div></div><a id="idp77736784" class="indexterm"></a><p>De <span class="application">sshd</span> is een optie die wordt
	aangeboden tijdens een <code class="literal">Standard</code>-installatie
	van FreeBSD.  <span class="application">sshd</span> is ingeschakeld als
	de volgende regel voorkomt in <code class="filename">rc.conf</code>:</p><pre class="programlisting">sshd_enable="YES"</pre><p>Hierdoor wordt <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sshd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sshd</span>(8)</span></a> geladen, het daemonprogramma
	voor <span class="application">OpenSSH</span>, als het systeem de
	volgende keer opstart.  Als alternatief is het mogelijk om
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a> te
	gebruiken om <span class="application">OpenSSH</span> te starten:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service sshd start</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77748176"></a>15.10.3. SSH-cliënt</h3></div></div></div><a id="idp77748816" class="indexterm"></a><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a> werkt net zoals <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rlogin&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rlogin</span>(1)</span></a>.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ssh user@example.com</code></strong>
Host key not found from the list of known hosts.
Are you sure you want to continue connecting (yes/no)? <strong class="userinput"><code>yes</code></strong>
Host 'example.com' added to the list of known hosts.
user@example.com's password: <strong class="userinput"><code>*******</code></strong></pre><p>Het aanmelden gaat nu net zoals het zou gaan als wanneer
	er een sessie gestart zou worden met <code class="command">rlogin</code>
	of <code class="command">telnet</code>.  SSH maakt gebruik van een
	systeem met vingerafdrukken als sleutels voor het vaststellen
	met welke server verbinding wordt gemaakt op het moment
	dat de cliënt verbinding zoekt.  De gebruiker krijgt alleen
	de eerste keer dat verbinding wordt gezocht met de server een
	vraag waarop <code class="literal">yes</code> geantwoord dient te worden.
	Bij volgende pogingen om aan te melden wordt de
	vingerafdruksleutel vergeleken met de sleutel die is
	opgeslagen.  De SSH-cliënt alarmeert de gebruiker als de
	opgeslagen vingerafdruk sleutel anders is dan de sleutel die
	de server meldt.  De vingerafdrukken worden opgeslagen in
	<code class="filename">~/.ssh/known_hosts</code> of in
	<code class="filename">~/.ssh/known_hosts2</code> voor SSH v2
	vingerafdrukken.</p><p>Recente <span class="application">OpenSSH</span> servers staan
	standaard ingesteld om alleen SSH v2 connecties toe te staan.
	De cliënt gebruikt versie 2 als dat mogelijk is en valt
	anders terug op versie 1.  De cliënt kan ook gedwongen
	worden om een van de twee protocollen te gebruiken door de optie
	<code class="option">-1</code> of <code class="option">-2</code> voor respectievelijk
	versie 1 en versie 2 aan te geven.  De mogelijkheid versie 1 te
	gebruiken blijft in de cliënt bestaan om compatibiliteit
	met oudere versies te behouden.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77757520"></a>15.10.4. Veilig kopiëren</h3></div></div></div><a id="idp77758160" class="indexterm"></a><a id="idp77759312" class="indexterm"></a><p>Het commando <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=scp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">scp</span>(1)</span></a> (secure copy) werkt gelijk aan
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rcp</span>(1)</span></a>.  Het kopieert een bestand van of naar een andere
	machine, maar doet dat veilig.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code> scp user@example.com:/COPYRIGHT COPYRIGHT</code></strong>
user@example.com's password: <strong class="userinput"><code>*******</code></strong>
COPYRIGHT            100% |*****************************|  4735
00:00
<code class="prompt">#</code></pre><p>Omdat de vingerafdruk al is opgeslagen voor deze host in
	het vorige voorbeeld, is die al geverifieerd als <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=scp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">scp</span>(1)</span></a>
	gebruik wordt.</p><p>De argumenten die aan <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=scp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">scp</span>(1)</span></a> gegeven worden zijn
	vrijwel gelijk aan die voor <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">cp</span>(1)</span></a> met het bestand of
	de bestanden als het eerste argument en de bestemming als het
	tweede.  Omdat het bestand over het netwerk gaat, door SSH,
	hebben een of meer van de bestandsargumenten de vorm
	<code class="option">user@host:&lt;path_to_remote_file&gt;</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77771344"></a>15.10.5. Instellen</h3></div></div></div><a id="idp77771984" class="indexterm"></a><p>Het instellingenbestand dat voor het hele systeem geldt
	voor zowel de <span class="application">OpenSSH</span> daemon als
	cliënt staat in de map <code class="filename">/etc/ssh</code>.</p><p><code class="filename">ssh_config</code> bevat de instellingen voor
	de cliënt en <code class="filename">sshd_config</code> bevat ze voor
	de daemon.</p><p>Daarnaast bieden het <code class="option">sshd_program</code>
	(standaard <code class="filename">/usr/sbin/sshd</code>) en
	<code class="option">sshd_flags</code> <code class="filename">rc.conf</code>
	opties nog meer mogelijkheden voor instellingen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="security-ssh-keygen"></a>15.10.6. <span class="application">ssh-keygen</span></h3></div></div></div><p>In plaats van het gebruik van wachtwoorden kan
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a> gebruikt worden om DSA en RSA sleutels te
	maken om een gebruiker te autenticeren:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ssh-keygen -t dsa</code></strong>
Generating public/private dsa key pair.
Enter file in which to save the key (/home/user/.ssh/id_dsa):
Created directory '/home/user/.ssh'.
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/user/.ssh/id_dsa.
Your public key has been saved in /home/user/.ssh/id_dsa.pub.
The key fingerprint is:
bb:48:db:f2:93:57:80:b6:aa:bc:f5:d5:ba:8f:79:17 user@host.example.com</pre><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a> maakt een publiek en privaat sleutelpaar
	aan dat gebruikt kan worden voor autenticatie.  De private
	sleutel staat opgeslagen in
	<code class="filename">~/.ssh/id_dsa</code> of
	<code class="filename">~/.ssh/id_rsa</code> en de publieke sleutel
	staat in <code class="filename">~/.ssh/id_dsa.pub</code> of
	<code class="filename">~/.ssh/id_rsa.pub</code> voor respectievelijk
	sleuteltypen <acronym class="acronym">DSA</acronym> en <acronym class="acronym">RSA</acronym>.
	De publieke sleutel moet voor beide <acronym class="acronym">RSA</acronym>- of
	<acronym class="acronym">DSA</acronym>-sleutels in het bestand
	<code class="filename">~/.ssh/authorized_keys</code> van de andere
	machine staan om dit te laten werken.</p><p>Nu is het mogelijk een verbinding te maken met een andere
	machine die gebaseerd is op SSH sleutels in plaats van op
	wachtwoorden.</p><p>Als er een wachtwoordzin is gebruikt bij <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a>
	dan wordt de gebruiker iedere keer dat de private sleutel wordt
	gebruikt een wachtwoord gevraagd.  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> kan het
	ongemak van steeds opnieuw een lange wachtwoordzin moeten
	ingeven verlichten en wordt beschreven in het onderdeel <a class="xref" href="openssh.html#security-ssh-agent" title="15.10.7. ssh-agent en ssh-add">Paragraaf 15.10.7, &#8220;<span class="application">ssh-agent</span> en
	<span class="application">ssh-add</span>&#8221;</a>.</p><div xmlns="" class="warning"><h3 class="admontitle">Waarschuwing: </h3><p xmlns="http://www.w3.org/1999/xhtml">Afhankelijk van de gebruikte versie van
	  <span class="application">OpenSSH</span> kunnen opties en bestanden
	  verschillen.  Het is verstandig de handleiding
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a> te raadplegen.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="security-ssh-agent"></a>15.10.7. <span class="application">ssh-agent</span> en
	<span class="application">ssh-add</span></h3></div></div></div><p>De hulpprogramma's <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> en <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-add</span>(1)</span></a>
	bieden de mogelijkheid om <span class="application">SSH</span>
	in het geheugen te laden zodat niet iedere keer de
	wachtwoordzin ingegeven hoeft te worden.</p><p>Het hulpprogramma <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> handelt de
	autenticatie af voor de geheime sleutels die erin geladen
	zijn.  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> wordt gebruikt om andere programma's
	te starten.  Bij eenvoudig gebruik kan er een shell mee
	gestart worden of meer complex een schermbeheerprogramma.</p><p>Voordat <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> in een shell gebruikt kan worden
	dient het eerst gestart te worden met een shell als argument.
	Daarna kan de identiteit toegevoegd worden daar <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-add</span>(1)</span></a>
	aan te roepen en de wachtwoordzin voor de geheime sleutel op te
	geven.  Als deze stappen zijn voltooid kan een gebruiker met
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a> naar iedere host waar de corresponderende publieke
	sleutel is geïnstalleerd:</p><pre class="screen"><code class="prompt">%</code> ssh-agent <em class="replaceable"><code>csh</code></em>
<code class="prompt">%</code> ssh-add
Enter passphrase for /home/user/.ssh/id_dsa:
Identity added: /home/user/.ssh/id_dsa (/home/user/.ssh/id_dsa)
<code class="prompt">%</code></pre><p>Om <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> te gebruiken in X11 dient er een
	verwijzing naar <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> in
	<code class="filename">~/.xinitrc</code> te staan.  Dan zijn de diensten
	van <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> beschikbaar voor alle programma's die in
	X11 gestart worden.  Een <code class="filename">~/.xinitrc</code> zou er
	als volgt uit kunnen zien:</p><pre class="programlisting">exec ssh-agent <em class="replaceable"><code>startxfce4</code></em></pre><p>Hiermee wordt <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> gestart die op zijn beurt
	<span class="application">XFCE</span> start, iedere keer dat X11
	start.  Als dat is gebeurd en X11 is herstart zodat de
	wijzigingen actief zijn, dan kan eenvoudigweg <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-add</span>(1)</span></a>
	gestart worden om alle beschikbare SSH sleutels te
	laden.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="security-ssh-tunneling"></a>15.10.8. SSH tunnels</h3></div></div></div><a id="idp77819856" class="indexterm"></a><p><span class="application">OpenSSH</span> kan een tunnel maken
	waarin een ander protocol ingepakt kan worden zodat er een
	versleutelde sessie ontstaat.</p><p>Het volgende commando geeft <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a> aan dat er een
	tunnel voor <span class="application">telnet</span> gemaakt moet
	worden:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ssh -2 -N -f -L 5023:localhost:23 user@foo.example.com</code></strong>
<code class="prompt">%</code></pre><p>Aan het <code class="command">ssh</code> commando worden de volgende
	opties meegegeven:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-2</code></span></dt><dd><p>Dit dwingt <code class="command">ssh</code> om versie 2 van het
	      protocol te gebruiken.  Gebruik van deze optie wordt
	      afgeraden als er verbinding wordt gemaakt met oudere SSH
	      servers.</p></dd><dt><span class="term"><code class="option">-N</code></span></dt><dd><p>Dit geeft aan dat er geen commando volgt, maar dat er
	      een tunnel opgezet moet worden.  Als deze optie niet
	      aanwezig was, zou <code class="command">ssh</code> een normale
	      sessie starten.</p></dd><dt><span class="term"><code class="option">-f</code></span></dt><dd><p>Dit dwingt <code class="command">ssh</code> om in de
	      achtergrond te draaien.</p></dd><dt><span class="term"><code class="option">-L</code></span></dt><dd><p>Dit geeft aan dat de lokaal een tunnel wordt gemaakt
	      in de vorm
	      <em class="replaceable"><code>lokale_poort:netwerk_host:netwerk_poort</code></em>.</p></dd><dt><span class="term"><code class="option">user@foo.example.com</code></span></dt><dd><p>Wijst naar een gebruiker op de SSH server op het
	      netwerk.</p></dd></dl></div><p>Een SSH tunnel werkt doordat een luistersocket wordt
	gemaakt op <code class="systemitem">localhost</code> op de aangegeven poort.
	Die stuurt dan iedere ontvangen verbinding op de lokale
	host/poort via de SSH verbinding door naar de aangegeven host
	en poort op het netwerk.</p><p>In het voorbeeld wordt poort
	<em class="replaceable"><code>5023</code></em> op <code class="systemitem">localhost</code>
	doorgestuurd naar poort <em class="replaceable"><code>23</code></em> op
	<code class="systemitem">localhost</code> van de machine op het netwerk.
	Omdat <em class="replaceable"><code>23</code></em>
	<span class="application">telnet</span> is, zou dit een veilige
	<span class="application">telnet</span> verbinding opleveren door
	een SSH tunnel.</p><p>Dit kan gebruikt worden om ieder willekeurig onveilig
	TCP protocol in te pakken als <acronym class="acronym">SMTP</acronym>,
	<acronym class="acronym">POP</acronym>3, <acronym class="acronym">FTP</acronym>, etc.</p><div class="example"><a id="idp77845456"></a><div class="example-title">Voorbeeld 15.1. SSH gebruiken om een veilige tunnel te maken voor
	  SMTP</div><div class="example-contents"><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ssh -2 -N -f -L 5025:localhost:25 user@mailserver.example.com</code></strong>
user@mailserver.example.com's password: <strong class="userinput"><code>*****</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>telnet localhost 5025</code></strong>
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
220 mailserver.example.com ESMTP</pre><p>Dit kan samen met een <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a> en extra
	  gebruikersaccounts gebruikt worden om een min of meer
	  naadloze en eenvoudige SSH tunnelomgeving te maken.  In
	  plaats van wachtwoorden kunnen sleutels gebruikt worden en de
	  tunnels kunnen in de omgeving van een aparte gebruiker
	  draaien.</p></div></div><br class="example-break" /><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77853776"></a>15.10.8.1. Praktische voorbeelden van een SSH tunnel</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77854416"></a>15.10.8.1.1. Veilige toegang tot een POP3 server</h5></div></div></div><p>Op het werk staat een SSH server die verbindingen van
	    buitenaf toestaat.  Op hetzelfde netwerk op kantoor staat
	    een mailserver waarop POP3 draait.  Het netwerk of het
	    netwerkpad tussen de locatie op Internet en kantoor is
	    wellicht niet helemaal te vertrouwen.  Om deze reden dient
	    de mailserver op een veilige manier benaderd te worden.  De
	    oplossing is een SSH verbinding opzetten naar de SSH server
	    op kantoor en dan door de tunnel heen een verbinding
	    opzetten met de mailserver.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ssh -2 -N -f -L 2110:mail.example.com:110 user@ssh-server.example.com</code></strong>
user@ssh-server.example.com's password: <strong class="userinput"><code>******</code></strong></pre><p>Als de tunnel eenmaal draait, dan kan de mailcliënt
	    naar <code class="systemitem">localhost</code> poort 2110 gewezen worden.
	    Alle verbinding naar die poort worden veilig doorgestuurd
	    door de tunnel naar
	    <code class="systemitem">mail.example.com</code>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77858256"></a>15.10.8.1.2. Een draconische firewall omzeilen</h5></div></div></div><p>Sommige netwerkbeheerders stellen draconische
	    firewallregels op en filteren niet alleen inkomende
	    verbindingen, maar ook uitgaande.  Meestal mag dan alleen
	    maar verbinding gemaakt worden met andere machines op
	    poorten 22 en 80 voor SSH en websurfen.</p><p>Soms wil een gebruiker dan toch toegang krijgen tot
	    andere (wellicht niet netwerkgerelateerde) diensten, zoals
	    een Ogg Vorbis server om muziek te streamen.  Als die Ogg
	    Vorbis server streamt op een andere poort dan 22 of 80, dan
	    kan deze niet bereikt worden.</p><p>De oplossing ligt in het opzetten van een SSH
	    verbinding naar een machine buiten de firewall en die
	    tunnel te gebruiken om bij de Ogg Vorbis server te
	    komen.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ssh -2 -N -f -L 8888:music.example.com:8000 user@unfirewalled-system.example.org</code></strong>
user@unfirewalled-system.example.org's password: <strong class="userinput"><code>*******</code></strong></pre><p>De streamingcliënt kan nu gewezen worden naar
	    <code class="systemitem">localhost</code> poort 8888 vanwaar er wordt
	    doorverwezen naar <code class="systemitem">music.example.com</code> poort
	    8000 en zo wordt de firewall succesvol ontwerken.</p></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77867088"></a>15.10.9. De optie <code class="varname">AllowUsers</code></h3></div></div></div><p>Vaak is het verstandig om beperkingen aan te brengen op het
	gebied van welke gebruikers kunnen aanmelden en van waar.  De
	optie <code class="literal">AllowUsers</code> biedt deze mogelijkheid.
	Om bijvoorbeeld alleen <code class="systemitem">root</code> toe te staan
	zich aan te melden van <code class="systemitem">192.168.1.32</code>, kan iets als de volgende
	regel worden opgenomen in het bestand
	<code class="filename">/etc/ssh/sshd_config</code>:</p><pre class="programlisting">AllowUsers root@192.168.1.32</pre><p>Om de gebruiker <code class="systemitem">admin</code> het recht te
	geven zich van overal aan te melden hoeft alleen de
	gebruikersnaam vermeld te worden:</p><pre class="programlisting">AllowUsers admin</pre><p>Meerdere gebruikers met rechten of beperkingen horen op
	dezelfde regel te staan:</p><pre class="programlisting">AllowUsers root@192.168.1.32 admin</pre><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">Het is van belang dat iedere gebruiker die zich moet
	  kunnen aanmelden wordt genoemd.  De overige gebruikers
	  worden buitengesloten.</p></div><p>Nadat er wijzigingen zijn gemaakt aan
	<code class="filename">/etc/ssh/sshd_config</code> dienen de bestanden
	in <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sshd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sshd</span>(8)</span></a> geladen te worden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service sshd reload</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77876048"></a>15.10.10. Meer informatie</h3></div></div></div><p><a class="link" href="http://www.openssh.com/" target="_top">OpenSSH</a></p><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=scp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">scp</span>(1)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a>
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-add</span>(1)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh_config&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ssh_config</span>(5)</span></a></p><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sshd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sshd</span>(8)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sftp-server&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sftp-server</span>(8)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sshd_config&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">sshd_config</span>(5)</span></a></p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ipsec.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="security.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="fs-acl.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">15.9. VPN via IPsec </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 15.11. Bestandssysteem toegangscontrolelijsten
      (<acronym class="acronym">ACL</acronym>s)</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>