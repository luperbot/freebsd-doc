<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>15.5. Eenmalige wachtwoorden</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="security.html" title="Hoofdstuk 15. Beveiliging" /><link rel="prev" href="crypt.html" title="15.4. DES, Blowfish, MD5, SHA256, SHA512 en crypt" /><link rel="next" href="tcpwrappers.html" title="15.6. TCP Wrappers" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.5. Eenmalige wachtwoorden</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="crypt.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 15. Beveiliging</th><td width="20%" align="right"> <a accesskey="n" href="tcpwrappers.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="one-time-passwords"></a>15.5. Eenmalige wachtwoorden</h2></div></div></div><a id="idp77139664" class="indexterm"></a><a id="idp77140176" class="indexterm"></a><p>Standaard biedt FreeBSD ondersteuning voor OPIE (Eenmalige
      Wachtwoorden in Alles - <span class="quote">&#8220;<span class="quote">One-time Passwords In
	Everything</span>&#8221;</span>), wat standaard een MD5-hash gebruikt.</p><p>Hier worden drie verschillende soorten wachtwoorden
      besproken.  De eerste is het normale <span class="trademark">UNIX</span>® of Kerberos
      wachtwoord.  Dit heet het <span class="quote">&#8220;<span class="quote"><span class="trademark">UNIX</span>® wachtwoord</span>&#8221;</span>.  Het
      tweede type is een eenmalig wachtwoord dat wordt gemaakt met het
      OPIE-programma <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=opiekey&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">opiekey</span>(1)</span></a> en dat wordt geaccepteerd door
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=opiepasswd&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">opiepasswd</span>(1)</span></a> en de aanmeldprocedure.  Dit heet het
      <span class="quote">&#8220;<span class="quote">eenmalige wachtwoord</span>&#8221;</span>.  Het laatste type wachtwoord
      is het wachtwoord dat wordt opgegeven aan het programma
      <code class="command">opiekey</code> (en soms aan het programma
      <code class="command">opiepasswd</code>) dat gebruikt wordt om eenmalige
      wachtwoorden te maken.  Dit type heet <span class="quote">&#8220;<span class="quote">geheim
      wachtwoord</span>&#8221;</span> of gewoon een <span class="quote">&#8220;<span class="quote">wachtwoord</span>&#8221;</span> zonder
      toevoeging.</p><p>Het geheime wachtwoord heeft niets te maken met het <span class="trademark">UNIX</span>®
      wachtwoord; ze kunnen hetzelfde zijn, dat wordt afgeraden.
      OPIE geheime wachtwoorden kennen niet de beperking van 8
      karakters zoals de oude <span class="trademark">UNIX</span>® wachtwoorden.

      <a href="#ftn.idp77152720" class="footnote" id="idp77152720"><sup class="footnote">[8]</sup></a>

      Ze mogen onbeperkt lang zijn.  Wachtwoorden van een zes of zeven
      woorden lange zin zijn niet ongewoon.  Voor het overgrote deel
      werkt het OPIE-systeem volledig onafhankelijk van het <span class="trademark">UNIX</span>®
      wachtwoordsysteem.</p><p>Buiten het wachtwoord zijn er nog twee stukjes gegevens die
      van belang zijn voor OPIE.  Het eerste wordt <span class="quote">&#8220;<span class="quote">zaad</span>&#8221;</span>
      (<span class="quote">&#8220;<span class="quote">seed</span>&#8221;</span>) of <span class="quote">&#8220;<span class="quote">sleutel</span>&#8221;</span>
      (<span class="quote">&#8220;<span class="quote">key</span>&#8221;</span>) genoemd en bestaat uit twee letters en vijf
      cijfers.  Het tweede stukje gegevens heet de
      <span class="quote">&#8220;<span class="quote">iteratieteller</span>&#8221;</span>, een nummer tussen 1 en 100.  OPIE
      maakt een eenmalig wachtwoord door het zaad en het geheime
      wachtwoord aaneen te schakelen en daarop het door de
      iteratieteller aangegeven keren MD5-hash toe te passen.  Daarna
      wordt het resultaat omgezet in zes korte Engelse woorden.  Deze
      zes woorden zijn een eenmalige wachtwoord.  Het
      autenticatiesysteem (hoofdzakelijk PAM) houdt bij welk
      eenmalig wachtwoord het laatst is gebruikt en de gebruiker wordt
      geautenticeerd als de hash van het door de gebruiker ingegeven
      wachtwoord gelijk is aan het vorige wachtwoord.  Omdat er een
      eenweg hash wordt gebruikt, is het onmogelijk om toekomstige
      eenmalige wachtwoorden te maken als iemand toch een eenmalig
      wachtwoord heeft afgevangen.  De iteratieteller wordt verlaagd na
      iedere succesvolle aanmelding om de gebruiker en het
      aanmeldprogramma synchroon te houden.  Als de iteratieteller op 1
      staat, moet OPIE opnieuw ingesteld worden.</p><p>Er zijn enkele programma's bij ieder systeem betrokken die
      hieronder worden besproken.  Het programma
      <code class="command">opiekey</code> heeft een iteratieteller,
      zaad en een geheim wachtwoord nodig en maakt dan een eenmalig
      wachtwoord of een lijst van opeenvolgende eenmalige wachtwoorden.
      Het programma <code class="command">opiepasswd</code> wordt gebruikt om OPIE
      te initialiseren en om wachtwoorden, iteratietellers en zaad te
      wijzigen.  Het accepteert zowel wachtwoordzinnen als een
      iteratieteller, zaad en een eenmalig wachtwoord.  Het programma
      <code class="command">opieinfo</code> bekijkt de relevante bestanden waarin
      de eigenschappen staan (<code class="filename">/etc/opiekeys</code>) en
      toont de huidige iteratieteller en zaad van de gebruiker die het
      commando uitvoert.</p><p>Nu worden vier verschillende acties besproken.  Bij de eerste
      wordt <code class="command">opiepasswd</code> gebruikt in een beveiligde
      verbinding om voor het eerst eenmalige wachtwoorden in te stellen
      of om een wachtwoord of zaad aan te passen.  Bij de tweede wordt
      <code class="command">opiepasswd</code> gebruikt over een onbeveiligde
      verbinding samen met <code class="command">opiekey</code> over een
      beveiligde verbinding om hetzelfde te bereiken.  In een derde
      scenario wordt <code class="command">opiekey</code> gebruikt om aan te
      melden over een onveilige verbinding.  Het vierde
      scenario behandelt het gebruik van <code class="command">opiekey</code> om
      een aantal sleutels aan te maken die opgeschreven of afgedrukt
      kunnen worden, zodat ze meegenomen kunnen worden naar een plaats
      van waar geen enkele veilige verbinding opgezet kan worden.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77160912"></a>15.5.1. Veilige verbinding initialiseren</h3></div></div></div><p>Gebruik het commando <code class="command">opiepasswd</code> om OPIE
	voor de eerste keer te initialiseren:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>opiepasswd -c</code></strong>
[grimreaper] ~ $ opiepasswd -f -c
Adding unfurl:
Only use this method from the console; NEVER from remote. If you are using
telnet, xterm, or a dial-in, type ^C now or exit with no password.
Then run opiepasswd without the -c parameter.
Using MD5 to compute responses.
Enter new secret pass phrase:
Again new secret pass phrase:

ID unfurl OTP key is 499 to4268
MOS MALL GOAT ARM AVID COED</pre><p>Als <code class="prompt">Enter new secret pass phrase:</code> of
	<code class="prompt">Enter secret password:</code> op het scherm
	verschijnt, dient een wachtwoord of wachtwoordzin ingevoerd te
	worden.  Dit is dus niet het aanmeldwachtwoord is, maar dit
	wordt gebruikt om eenmalige wachtwoorden te maken.  De
	<span class="quote">&#8220;<span class="quote">ID</span>&#8221;</span> regel geeft de parameters van het verzoek
	weer: de aanmeldnaam, de iteratieteller en zaad.  Bij het
	aanmelden kent het systeem deze parameters en worden deze
	weergegeven zodat ze niet onthouden hoeven te worden.  Op de
	laatste regel staat het eenmalige wachtwoord dat overeenkomt met
	die parameters en het geheime wachtwoord.  Als de gebruiker
	direct opnieuw zou aanmelden, zou hij dat eenmalige wachtwoord
	moeten gebruiken.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77165136"></a>15.5.2. Onveilige verbinding initialiseren</h3></div></div></div><p>Om een wachtwoord te initialiseren of te wijzigen over een
	onveilige verbinding, moet er al ergens een veilige verbinding
	bestaan waar de gebruiker <code class="command">opiekey</code> kan
	uitvoeren.  Dit kan een shellprompt zijn op een machine die
	vertrouwd wordt.  De gebruiker moet ook een iteratieteller
	verzinnen (100 is wellicht een prima getal) en een eigen zaad
	bedenken of er een laten fabriceren.  Over de onveilige
	verbinding (naar de machine die de gebruiker wil initialiseren)
	wordt het commando <code class="command">opiepasswd</code> gebruikt:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>opiepasswd</code></strong>

Updating unfurl:
You need the response from an OTP generator.
Old secret pass phrase:
	otp-md5 498 to4268 ext
	Response: GAME GAG WELT OUT DOWN CHAT
New secret pass phrase:
	otp-md5 499 to4269
	Response: LINE PAP MILK NELL BUOY TROY

ID mark OTP key is 499 gr4269
LINE PAP MILK NELL BUOY TROY</pre><p>Druk op <span class="keycap"><strong>Return</strong></span> om het standaardzaad te
	accepteren.  Voor een toegangswachtwoord wordt ingevoerd, dient
	eerst gewisseld te worden naar de veilige verbinding en dienen
	dezelfde parameters ingegeven te worden:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>opiekey 498 to4268</code></strong>
Using the MD5 algorithm to compute response.
Reminder: Don't use opiekey from telnet or dial-in sessions.
Enter secret pass phrase:
GAME GAG WELT OUT DOWN CHAT</pre><p>In de onveilige verbinding wordt nu het eenmalige wachtwoord
	in het relevante programma gekopieerd.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77170256"></a>15.5.3. Een enkel eenmalig wachtwoord maken</h3></div></div></div><p>Als OPIE eenmaal is ingesteld staat er bij het
	aanmelden iets als het volgende:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>telnet example.com</code></strong>
Trying 10.0.0.1...
Connected to example.com
Escape character is '^]'.

FreeBSD/i386 (example.com) (ttypa)

login: <strong class="userinput"><code>&lt;gebruikersnaam&gt;</code></strong>
otp-md5 498 gr4269 ext
Password: </pre><p>NB: de OPIE-prompt heeft een handige optie (die hier niet te
	zien is): als er op <span class="keycap"><strong>Return</strong></span> wordt gedrukt bij de
	wachtwoordregel, wordt de echo aangezet, zodat de invoer
	zichtbaar is.  Dit is erg handig als er met de hand een
	wachtwoord wordt ingegeven, zoals wanneer het wordt ingevoerd
	vanaf een afdruk.</p><a id="idp77177808" class="indexterm"></a><a id="idp77178320" class="indexterm"></a><a id="idp77178832" class="indexterm"></a><p>Nu moet het eenmalige wachtwoord gemaakt worden om het
	aanmeldprompt mee te antwoorden.  Dit moet gedaan worden op een
	vertrouwd systeem waarop <code class="command">opiekey</code> beschikbaar
	is.  Er zijn ook versies voor <span class="trademark">MS-DOS</span>®, <span class="trademark">Windows</span>® en <span class="trademark">Mac OS</span>®.
	Voor het commando moet zowel de iteratieteller als het zaad
	ingeven worden op de commandoregel.  Deze kan zo overgenomen
	worden vanaf het aanmeldprompt op de machine waarop de gebruiker
	zich wil aanmelden.</p><p>Op het vertrouwde systeem:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>opiekey 498 to4268</code></strong>
Using the MD5 algorithm to compute response.
Reminder: Don't use opiekey from telnet or dial-in sessions.
Enter secret pass phrase:
GAME GAG WELT OUT DOWN CHAT</pre><p>Nu het eenmalige wachtwoord er is, kan het aanmelden
	doorgang vinden.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77183568"></a>15.5.4. Meerdere eenmalige wachtwoorden maken</h3></div></div></div><p>Soms moet een gebruiker ergens naar toe gaan waar er geen
	toegang is tot een vertrouwde machine of een beveiligde
	verbinding.  In dat geval is het mogelijk om met het commando
	<code class="command">opiekey</code> een aantal eenmalige wachtwoorden te
	maken om uit te printen en mee te nemen:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>opiekey -n 5 30 zz99999</code></strong>
Using the MD5 algorithm to compute response.
Reminder: Don't use opiekey from telnet or dial-in sessions.
Enter secret pass phrase: <strong class="userinput"><code>&lt;geheim wachtwoord&gt;</code></strong>
26: JOAN BORE FOSS DES NAY QUIT
27: LATE BIAS SLAY FOLK MUCH TRIG
28: SALT TIN ANTI LOON NEAL USE
29: RIO ODIN GO BYE FURY TIC
30: GREW JIVE SAN GIRD BOIL PHI</pre><p>Met <code class="option">-n 5</code> worden vijf opeenvolgende
	sleutels aangevraagd, <code class="option">30</code> geeft aan wat het
	laatste iteratiegetal moet zijn.  Deze wachtwoorden worden
	weergegeven in <span class="emphasis"><em>omgekeerde</em></span> volgorde voor
	gebruik.  Als de gebruiker echt paranoïde bent kan hij ze
	opschrijven of hij kan er ook voor kiezen ze af te drukken met
	<code class="command">lpr</code>.  Op iedere regel staat dus de
	iteratieteller en het eenmalige wachtwoord, maar misschien is
	het toch handig om ze na gebruik af te strepen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77192656"></a>15.5.5. Gebruik van <span class="trademark">UNIX</span>® wachtwoorden beperken</h3></div></div></div><p>Met OPIE kan paal en perk gesteld worden aan het gebruik van
	<span class="trademark">UNIX</span>® wachtwoorden op basis van het <acronym class="acronym">IP</acronym>-adres
	van een aanmeldsessie.  Dat kan met het bestand
	<code class="filename">/etc/opieaccess</code> dat standaard aanwezig is.
	Bij <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=opieaccess&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">opieaccess</span>(5)</span></a> staat meer informatie over dit bestand en
	welke beveiligingsoverwegingen bestaan bij het gebruik.</p><p>Hieronder een voorbeeld voor een
	<code class="filename">opieaccess</code> bestand:</p><pre class="programlisting">permit 192.168.0.0 255.255.0.0</pre><p>In deze regel (<code class="literal">permit Internet</code>) staat
	dat gebruikers met een bron <acronym class="acronym">IP</acronym> adres (wat
	gefingeerd kan worden) dat past binnen de aangegeven waarde en
	masker altijd <span class="trademark">UNIX</span>® wachtwoorden mogen gebruiken.</p><p>Als geen van de regels uit <code class="filename">opieaccess</code>
	van toepassing is, worden standaard pogingen zonder OPIE
	geweigerd.</p></div><div class="footnotes"><br /><hr class="footnote-hr" /><div id="ftn.idp77152720" class="footnote"><p><a href="#idp77152720" class="para"><sup class="para">[8] </sup></a>Bij FreeBSD mag het wachtwoord voor aanmelden tot 128
	  karakters lang zijn.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="crypt.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="security.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="tcpwrappers.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">15.4. DES, Blowfish, MD5, SHA256, SHA512 en crypt </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 15.6. TCP Wrappers</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>