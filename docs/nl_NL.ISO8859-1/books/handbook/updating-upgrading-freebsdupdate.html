<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>24.2. FreeBSD Update</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="updating-upgrading.html" title="Hoofdstuk 24. FreeBSD updaten en upgraden" /><link rel="prev" href="updating-upgrading.html" title="Hoofdstuk 24. FreeBSD updaten en upgraden" /><link rel="next" href="updating-upgrading-portsnap.html" title="24.3. Portsnap: een updategereedschap voor de Portscollectie" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">24.2. FreeBSD Update</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="updating-upgrading.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 24. FreeBSD updaten en upgraden</th><td width="20%" align="right"> <a accesskey="n" href="updating-upgrading-portsnap.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="updating-upgrading-freebsdupdate"></a>24.2. FreeBSD Update</h2></div><div><span class="authorgroup">Geschreven door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div><div><span class="authorgroup">Gebaseerd op notities aangeleverd door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Colin</span> <span class="surname">Percival</span></span>. </span></div></div></div><a id="idp82470608" class="indexterm"></a><a id="idp82471120" class="indexterm"></a><p>Het toepassen van beveiligingspatches is een belangrijk
      onderdeel van het beheren van computersoftware, met name het
      besturingssysteem.  Dit was voor een lange tijd geen gemakkelijk
      proces op FreeBSD.  Er moesten patches op de broncode worden
      toegepast,  de code moest herbouwd worden tot binairen, en daarna
      moesten de binairen worden geherinstalleerd.</p><p>Dit is niet langer het geval aangezien FreeBSD nu een gereedschap
      heeft dat eenvoudigweg <code class="command">freebsd-update</code> heet.
      Dit gereedschap biedt twee gescheiden functies.  Ten eerste
      voorziet het in het toepassen van binaire beveiligings- en
      errata-updates op het basissysteem van FreeBSD zonder de eis om te
      bouwen en te installeren.  Ten tweede ondersteunt het gereedschap
      kleine en grote uitgave-upgrades.</p><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">Binaire updates zijn beschikbaar voor alle architecturen en
	uitgaveaankondigingen dienen gelezen te worden aangezien deze
	belangrijke informatie over de gewenste uitgave kunnen bevatten.
	De aankondigingen kunnen op de volgende koppelin bekeken worden:
	<code class="uri"><a class="uri" href="http://www.FreeBSD.org/releases/" target="_top">http://www.FreeBSD.org/releases/</a></code>.</p></div><p>Als er een <code class="command">crontab</code> bestaat die de
      mogelijkheden van <code class="command">freebsd-update</code> gebruikt, moet
      het uitgeschakeld worden voordat aan de volgende operatie wordt
      begonnen.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="freebsdupdate-config-file"></a>24.2.1. Het configuratiebestand</h3></div></div></div><p>Sommige gebruikers willen het standaard configuratiebestand
	optimaliseren, waardoor het proces beter gecontroleerd kan
	worden.  De opties zijn goed gedocumenteerd, maar voor de
	volgenden is wat extra uitleg nodig:</p><pre class="programlisting"># Componenten van het basissysteem die bijgewerkt moeten blijven
Components src world kernel</pre><p>Deze parameter bepaalt welke delen van FreeBSD bijgewerkt
	blijven.  Standaard wordt de broncode bijgewerkt, het hele
	basissysteem, en de kernel.  Dezelfde componenten als tijdens de
	installatie zijn beschikbaar, het toevoegen van bijvoorbeeld
	<code class="literal">world/games</code> zou de spelpatches toepassen.  Het
	gebruik van <code class="literal">src/bin</code> zou de broncode in <code class="filename">src/bin</code> bijgewerkt houden.</p><p>Het beste kan dit op de standaardwaarde blijven aangezien
	het veranderen hiervan om specifieke items te bevatten de
	gebruiker dwingt om alle items die bijgewerkt dienen te worden
	op te noemen.  Dit kan rampzalige gevolgen hebben aangezien de
	broncode en de binairen asynchroon kunnen raken.</p><pre class="programlisting"># Paden die beginnen met iets wat overeenkomt met een regel in een IgnorePaths
# statement zullen genegeerd worden.
IgnorePaths</pre><p>Voeg paden, zoals
	<code class="filename">/bin</code> of
	<code class="filename">/sbin</code> toe om deze
	specifieke mappen ongemoeid te laten tijdens het updateproces.
	Deze optie kan gebruikt worden om te voorkomen dat
	<code class="command">freebsd-update</code> lokale wijzigingen
	overschrijft.</p><pre class="programlisting"># Paden die beginnen met iets wat overeenkomt met een regel in een UpdateIfUnmodified
# statement zullen alleen worden bijgewerkt als de inhoud van het bestand niet is
# gewijzigd door de gebruiker (tenzij veranderingen zijn samengevoegd; zie beneden).
UpdateIfUnmodified /etc/ /var/ /root/ /.cshrc /.profile</pre><p>Werk configuratiebestanden in de aangegeven mappen alleen
	bij als ze niet zijn gewijzigd.  Alle veranderingen die door de
	gebruiker zijn gemaakt maken het automatisch bijwerken van deze
	bestanden ongeldig.  Er is een andere optie,
	<code class="literal">KeepModifiedMetadata</code>, die
	<code class="command">freebsd-update</code> instrueert om de veranderingen
	tijdens het samenvoegen te bewaren.</p><pre class="programlisting"># Wanneer naar een nieuwe uitgave van FreeBSD wordt ge-upgraded, worden lokale veranderingen van bestanden die overeenkomen met MergeChanges
# samengevoegd in de versie van de nieuwe uitgave.
MergeChanges /etc/ /var/named/etc/</pre><p>Lijst van mappen met instellingenbestanden waar
	<code class="command">freebsd-update</code> moet proberen om in samen te
	voegen.  Het proces van bestanden samenvoegen is een serie
	van <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>-patches die ongeveer gelijk is aan
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> met minder opties, de samenvoegingen worden
	ofwel geaccepteerd, of openen een tekstverwerker, of zorgen
	ervoor dat <code class="command">freebsd-update</code> afbreekt.  Maak in
	geval van twijfel een reservekopie van <code class="filename">/etc</code> en accepteer de
	samenvoegingen.  In <a class="xref" href="makeworld.html#mergemaster" title="24.7.11.1. mergemaster">Paragraaf 24.7.11.1, &#8220;<code class="command">mergemaster</code>&#8221;</a> staat meer
	informatie over het commando <code class="command">mergemaster</code>.</p><pre class="programlisting"># Map waarin de gedownloade updates en tijdelijke
bestanden
# die door een FreeBSD Update worden gebruikt worden opgeslagen.
# WorkDir /var/db/freebsd-update</pre><p>Dit is de map waarin alle patches en tijdelijke bestanden
	worden geplaatst.  In het geval dat de gebruiker een
	versie-upgrade uitvoert, dient deze locatie tenminste een
	gigabyte aan vrije schijfruimte te hebben.</p><pre class="programlisting"># Wanneer tussen uitgaven wordt ge-upgraded, dient de lijst van Componenten dan
# strikt gelezen te worden (StrictComponents yes) of slechts als een lijst van componenten

# die geïnstalleerd *kunnen* worden en waarvan FreeBSD Update uit dient te zoeken
# welke daadwerkelijk zijn geïnstalleerd en die te upgraden (StrictComponents no)?
# StrictComponents no</pre><p>Wanneer ingesteld op <code class="literal">yes</code>, zal
	<code class="command">freebsd-update</code> aannemen dat de lijst
	<code class="literal">Components</code> compleet is en zal het niet
	proberen om wijzigingen buiten de lijst te maken.  Effectief zal
	<code class="command">freebsd-update</code> proberen om elk bestand bij te
	werken dat op de lijst <code class="literal">Components</code> staat.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="freebsdupdate-security-patches"></a>24.2.2. Beveiligingspatches</h3></div></div></div><p>Beveiligingspatches staan op een verre machine en kunnen met
	het volgende commando gedownload en geïnstalleerd
	worden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update fetch</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>freebsd-update install</code></strong></pre><p>Als er kernelpatches zijn toegepast moet het systeem opnieuw
	opgestart worden.  Als alles goed is gegaan dient het systeem
	gepatcht te zijn en kan <code class="command">freebsd-update</code> als
	een nachtelijke <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a>-taak gedraaid worden.  Een regel
	in <code class="filename">/etc/crontab</code> zou genoeg moeten zijn om
	deze taak te volbrengen:</p><pre class="programlisting">@daily                                  root    freebsd-update cron</pre><p>Deze regel verklaart dat eenmaal per dag het commando
	<code class="command">freebsd-update</code> gedraaid zal worden.  Op deze
	manier, door het argument <code class="option">cron</code> te gebruiken,
	zal het gereedschap <code class="command">freebsd-update</code> alleen kijken of
	er updates bestaan.  Als er patches bestaan, zullen ze automatisch
	worden gedownload naar de plaatselijke schijf maar niet worden
	toegepast.  Er zal een email aan de gebruiker
	<code class="systemitem">root</code> worden verstuurd zodat ze handmatig
	geïnstalleerd kunnen worden.</p><p>Als er iets misging, heeft <code class="command">freebsd-update</code>
	de mogelijkheid om de laatste verzamelingen veranderingen terug
	te draaien met het volgende commando:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update rollback</code></strong></pre><p>Eenmaal voltooid, dient het systeem herstart te worden als
	de kernel of enige kernelmodule is gewijzigd.  Dit stelt FreeBSD in
	staat om de nieuwe binairen in het geheugen te laden.</p><p>Het gereedschap <code class="command">freebsd-update</code> kan alleen
	de kernel <code class="filename">GENERIC</code> automatisch bijwerken.  Als
	een eigen kernel wordt gebruikt, moet het herbouwd en
	geherinstalleerd worden nadat <code class="command">freebsd-update</code>
	klaar is met het installeren de rest van de updates.
	<code class="command">freebsd-update</code> zal echter de kernel
	<code class="filename">GENERIC</code> in <code class="filename">/boot/GENERIC</code> detecteren en
	bijwerken (als het bestaat), zelfs als het niet de huidige
	(draaiende) kernel van het systeem is.</p><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">Het is een goed idee om altijd een kopie van de kernel
	  <code class="filename">GENERIC</code> in <code class="filename">/boot/GENERIC</code> te bewaren.  Het
	  kan van pas komen bij het vaststellen van een keur aan
	  problemen, en bij het uitvoeren van versie-upgrades met
	  <code class="command">freebsd-update</code> zoals beschreven in
	  <a class="xref" href="updating-upgrading-freebsdupdate.html#freebsdupdate-upgrade" title="24.2.3. Grote en kleine upgrades">Paragraaf 24.2.3, &#8220;Grote en kleine upgrades&#8221;</a>.</p></div><p>Tenzij de standaardconfiguratie in
	<code class="filename">/etc/freebsd-update.conf</code> is gewijzigd, zal
	<code class="command">freebsd-update</code> de bijgewerkte kernelbronnen
	samen met de rest van de updates installeren.  Het herbouwen en
	herinstalleren van uw nieuwe eigen kernel kan daarna op de
	gebruikelijke manier gedaan worden.</p><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">De updates die via <code class="command">freebsd-update</code>
	  verspreid worden hebben niet altijd betrekking op de kernel.
	  Het is niet nodig om uw eigen kernel te herbouwen als de
	  kernelbronnen niet zijn aangepast door het uitvoeren van
	  <code class="command">freebsd-update install</code>.
	  <code class="command">freebsd-update install</code> zal echter altijd
	  het bestand <code class="filename">/usr/src/sys/conf/newvers.sh</code>
	  bijwerken.  Het huidige patchniveau (zoals aangegeven door het
	  <code class="literal">-p</code>-nummer gerapporteerd door <code class="command">uname
	    -r</code>) wordt uit dit bestand gehaald.  Het herbouwen
	  van uw eigen kernel, zelfs als er niets veranderd is, stelt
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=uname&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">uname</span>(1)</span></a> in staat om het huidige patchniveau van het
	  systeem accuraat te rapporteren.  Dit is in het bijzonder
	  behulpzaam wanneer meerdere systemen onderhouden worden,
	  aangezien hierdoor snel de geïnstalleerde updates op elk
	  ervan kunnen worden nagegaan.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="freebsdupdate-upgrade"></a>24.2.3. Grote en kleine upgrades</h3></div></div></div><p>Dit proces ruimt oude objectbestanden en bibliotheken op
	waardoor de meeste applicaties van derde partijen kapot gaan.
	Het wordt aangeraden dat alle geïnstalleerde poorten ofwel
	verwijderd en geherinstalleerd worden of later ge-upgraded
	worden met het hulpmiddel <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/portupgrade/pkg-descr">ports-mgmt/portupgrade</a>.  De meeste
	gebruikers zullen willen proefdraaien met het volgende
	commando:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portupgrade -af</code></strong></pre><p>Dit zorgt ervoor dat alles juist wordt geherinstalleerd.
	Merk op dat het instellen van de omgevingsvariabele
	<code class="varname">BATCH</code> op <code class="literal">yes</code> het antwoord
	<code class="literal">yes</code> zal geven op alle prompts tijdens dit
	proces, waardoor het niet nodig is om handmatig in het
	bouwproces in te grijpen.</p><p>Als een eigen kernel wordt gebruikt, is het upgradeproces
	iets ingewikkelder.  Een kopie van de kernel
	<code class="filename">GENERIC</code> is nodig en dient in <code class="filename">/boot/GENERIC</code> geplaatst te
	worden.  Als de kernel <code class="filename">GENERIC</code> niet reeds op
	het systeem aanwezig is, moet het met één van de
	volgende methoden verkregen worden:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Als er slechts eenmaal een eigen kernel is gebouwd, dan
	    is de kernel in <code class="filename">/boot/kernel.old</code> eigenlijk de
	    <code class="filename">GENERIC</code>.  Hernoem deze map naar <code class="filename">/boot/GENERIC</code>.</p></li><li class="listitem"><p>Aannemende dat fysieke toegang tot de machine mogelijk
	    is, kan een kopie van de kernel <code class="filename">GENERIC</code>
	    van het CD-ROM-medium worden geïnstalleerd.  Laad de
	    installatieschijf en geef de volgende commando's:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /cdrom</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /cdrom/X.Y-RELEASE/kernels</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>./install.sh GENERIC</code></strong></pre><p>Vervang <code class="filename">X.Y-RELEASE</code>
	    met de versie van de uitgave die u gebruikt.  De kernel
	    <code class="filename">GENERIC</code> zal standaard in <code class="filename">/boot/GENERIC</code> worden
	    geïnstalleerd.</p></li><li class="listitem"><p>Als al het bovenstaande niet lukt, kan de kernel
	    <code class="filename">GENERIC</code> herbouwd en geherinstalleerd
	    worden vanaf de broncode:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>env DESTDIR=/boot/GENERIC make kernel</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mv /boot/GENERIC/boot/kernel/* /boot/GENERIC</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm -rf /boot/GENERIC/boot</code></strong></pre><p>Om deze kernel door <code class="command">freebsd-update</code>
	    als <code class="filename">GENERIC</code> te laten herkennen, mag het
	    configuratiebestand voor <code class="filename">GENERIC</code> niet op
	    enige wijze veranderd zijn.  Het is ook aan te raden dat het
	    zonder andere speciale opties wordt gebouwd (bij voorkeur
	    met een leeg <code class="filename">/etc/make.conf</code>).</p></li></ul></div><p>Opnieuw opstarten naar de kernel <code class="filename">GENERIC</code>
	is in dit stadium niet nodig.</p><p>Updates van grote en kleine versies kunnen worden uitgevoerd
	door een uitgaveversie als doel aan
	<code class="command">freebsd-update</code> op te geven, het volgende
	commando zal bijvoorbeeld updaten naar FreeBSD 8.1:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update -r 8.1-RELEASE upgrade</code></strong></pre><p>Nadat het commando is ontvangen, zal
	<code class="command">freebsd-update</code> het instellingenbestand en het
	huidige systeem evalueren in een poging om de benodigde
	informatie te verzamelen om het systeem te updaten.  Een lijst
	op het scherm zal aangeven welke componenten zijn gedetecteerd
	en welke niet.  Bijvoorbeeld:</p><pre class="screen">Looking up update.FreeBSD.org mirrors... 1 mirrors found.
Fetching metadata signature for 8.0-RELEASE from update1.FreeBSD.org... done.
Fetching metadata index... done.
Inspecting system... done.

The following components of FreeBSD seem to be installed:
kernel/smp src/base src/bin src/contrib src/crypto src/etc src/games
src/gnu src/include src/krb5 src/lib src/libexec src/release src/rescue
src/sbin src/secure src/share src/sys src/tools src/ubin src/usbin
world/base world/info world/lib32 world/manpages

The following components of FreeBSD do not seem to be installed:
kernel/generic world/catpages world/dict world/doc world/games
world/proflibs

Does this look reasonable (y/n)? y</pre><p>Nu zal <code class="command">freebsd-update</code> proberen om alle
	bestanden die nodig zijn voor de upgrade te downloaden.  In
	sommige gevallen kan de gebruiker worden gevraagd wat te
	installeren of hoe verder te gaan.</p><p>Wanneer een eigen kernel wordt gebruikt, zal de bovenstaande
	stap een waarschuwing geven die lijkt op de volgende:</p><pre class="screen">WARNING: This system is running a "<em class="replaceable"><code>MIJNKERNEL</code></em>" kernel, which is not a
kernel configuration distributed as part of FreeBSD 8.0-RELEASE.
This kernel will not be updated: you MUST update the kernel manually
before running "/usr/sbin/freebsd-update install"</pre><p>Deze waarschuwing kan op dit moment veilig worden
	genegeerd.  De bijgewerkte kernel <code class="filename">GENERIC</code>
	zal als tussenliggende stap in het upgradeproces worden
	gebruikt.</p><p>Nadat alle patches zijn gedownload naar het plaatselijke
	systeem zullen ze worden toegepast.  Dit proces kan afhankelijk
	van de snelheid en werklast van de machine even duren.  Hierna
	zullen instellingenbestanden worden samengevoegd &#8212;
	voor dit gedeelte van het proces is enige tussenkomst van de
	gebruiker nodig aangezien een bestand kan worden samengevoegd of
	omdat er een tekstverwerker op het scherm kan verschijnen om het
	bestand handmatig samen te voegen.  Het resultaat van elke
	succesvolle samenvoeging zal aan de gebruiker worden getoond
	naarmate het proces verder gaat.  Een mislukte of genegeerde
	samenvoegpoging zal het proces afbreken.  Het is mogelijk voor
	gebruikers om een reservekopie van <code class="filename">/etc</code> te maken en belangrijke
	bestanden, zoals <code class="filename">master.passwd</code> of
	<code class="filename">group</code>, later samen te voegen.</p><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">Het systeem is nog niet veranderd, al het patchen en
	  samenvoegen gebeurt in een andere map.  Wanneer alle patches
	  succesvol zijn toegepast, alle instellingenbestanden zijn
	  samengevoegd en het erop lijkt dat het proces soepel verloopt,
	  dienen de veranderingen verzegeld te worden door de
	  gebruiker.</p></div><p>Als dit proces eenmaal voltooid is, kan de upgrade aan de
	schijf toevertrouwd worden met het volgende commando.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update install</code></strong></pre><p>De kernel en kernelmodules zullen als eerste gepatcht
	worden.  Nu moet de machine opnieuw opgestart worden.  Als het
	systeem een eigen kernel draaide, gebruik dan het commando
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=nextboot&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">nextboot</span>(8)</span></a> om de kernel voor de volgende keer dat
	opgestart wordt in te stellen op <code class="filename">/boot/GENERIC</code> (welke is
	bijgewerkt):</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>nextboot -k GENERIC</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Waarschuwing: </h3><p xmlns="http://www.w3.org/1999/xhtml">Voordat er met de kernel <code class="filename">GENERIC</code> wordt
	  opgestart, dient te worden gecontroleerd dat het alle
	  stuurprogramma's bevat om uw systeem juist te laten opstarten
	  (en met het netwerk te verbinden, als de machine die
	  bijgewerkt wordt van afstand wordt benaderd).  In het
	  bijzonder, als de vorige kernel die draaide ingebouwde
	  functionaliteit bevatte die normaalgesproken door
	  kernelmodules wordt geleverd, zorg er dan voor dat deze
	  modules tijdelijk in de kernel <code class="filename">GENERIC</code>
	  worden geladen door de faciliteit
	  <code class="filename">/boot/loader.conf</code> te gebruiken.  U kunt
	  er ook voor kiezen om niet-essentiële diensten, schijf-
	  en netwerkkoppelingen, enzovoorts uit te zetten totdat het
	  upgradeproces voltooid is.</p></div><p>De machine dient nu te worden herstart met de bijgewerkte
	kernel:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>shutdown -r now</code></strong></pre><p>Als het systeem weer actief is, moet
	<code class="command">freebsd-update</code> nogmaals gestart worden.
	De toestand van het proces is opgeslagen en dus zal
	<code class="command">freebsd-update</code> niet vooraan beginnen, maar
	zal het alle oude gedeelde bibliotheken en objectbestanden
	verwijderen.  Geef het volgende commando om verder te gaan op
	dit punt:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update install</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">Afhankelijk van het feit of er versienummers van
	  bibliotheken zijn opgehoogd, kunnen er slechts twee in plaats
	  van drie installatiefasen zijn.</p></div><p>Alle software van derde partijen dient nu opnieuw gebouwd en
	geïnstalleerd te worden.  Dit is nodig omdat
	geïnstalleerde software van bibliotheken afhankelijk kan
	zijn die tijdens het upgradeproces zijn verwijderd.  Het
	commando <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/portupgrade/pkg-descr">ports-mgmt/portupgrade</a> kan gebruikt
	worden om dit proces te automatiseren.  Dit proces kan met de
	volgende commando's gestart worden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portupgrade -f ruby</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm /var/db/pkg/pkgdb.db</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>portupgrade -f ruby18-bdb</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm /var/db/pkg/pkgdb.db /usr/ports/INDEX-*.db</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>portupgrade -af</code></strong></pre><p>Voltooi, nadat dit voltooid is, het upgradeproces met een
	laatste aanroep naar <code class="command">freebsd-update</code>.  Geef
	het volgende commando om alle losse eindjes in het upgradeproces
	samen te knopen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update install</code></strong></pre><p>Als de kernel <code class="filename">GENERIC</code> tijdelijk werd
	gebruikt, is dit het moment om een nieuwe eigen kernel op de
	gebruikelijke manier te bouwen en installeren.</p><p>Start de machine opnieuw op in de nieuwe FreeBSD-versie.  Het
	proces is voltooid.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="freebsdupdate-system-comparison"></a>24.2.4. Het vergelijken van systeemtoestanden</h3></div></div></div><p>Het gereedschap <code class="command">freebsd-update</code> kan
	gebruikt worden om de toestand van de geïnstalleerde versie
	van FreeBSD met een bekende goede kopie te vergelijken.  Deze optie
	evalueert de huidige versie van systeemgereedschappen,
	bibliotheken, en instellingenbestanden.  Geef het volgende
	commando om met de vergelijking te beginnen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>freebsd-update IDS &gt;&gt; uitvoerbestand.ids</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Waarschuwing: </h3><p xmlns="http://www.w3.org/1999/xhtml">Hoewel de commandonaam <acronym class="acronym">IDS</acronym> is, is het
	  in geen geval een vervanging voor een indringdetectiesysteem
	  zoals <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/snort/pkg-descr">security/snort</a>.
	  Aangezien <code class="command">freebsd-update</code> gegevens op schijf
	  opslaat, is de mogelijkheid om te knoeien duidelijk.  Hoewel
	  deze mogelijkheid verminderd kan worden door de instelling
	  <code class="varname">kern.securelevel</code> te gebruiken en de
	  gegevens van <code class="command">freebsd-update</code> op een
	  bestandssysteem dat alleen gelezen kan worden op te slaan
	  wanneer deze niet gebruikt worden, zou een betere oplossing
	  zijn om het systeem met een veilige schijf te vergelijken,
	  zoals een <acronym class="acronym">DVD</acronym> of een veilig opgeslagen
	  externe <acronym class="acronym">USB</acronym>-schijf.</p></div><p>Het systeem zal nu geïnspecteerd worden, en er zal een
	lijst van hun <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sha256&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">sha256</span>(1)</span></a>-hashwaarden, zowel de bekende
	waarde in de uitgave en de huidige geïnstalleerde waarde,
	afgebeeld worden.  Hierom wordt de uitvoer naar het bestand
	<code class="filename">uitvoerbestand.ids</code> gezonden.  Het scrollt
	te snel voorbij om het met het oog te vergelijken, en het vult
	al snel de gehele consolebuffer op.</p><p>Deze regels zijn ook extreem lang, maar het uitvoerformaat
	kan vrij eenvoudig geparsed worden.  Geef, om bijvoorbeeld een
	lijst van alle bestanden te krijgen die verschillen van die in
	de uitgave, het volgende commando:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cat uitvoerbestand.ids | awk '{ print $1 }' | more</code></strong>
/etc/master.passwd
/etc/motd
/etc/passwd
/etc/pf.conf</pre><p>Deze uitvoer is afgekapt, er bestaan veel meer bestanden.
	Sommige van deze bestanden hebben natuurlijke veranderingen, het
	<code class="filename">/etc/passwd</code> is gewijzigd omdat er
	gebruikers aan het systeem zijn toegevoegd.  In sommige gevallen
	kunnen er andere bestanden zijn, zoals kernelmodules, die
	verschillen aangezien <code class="command">freebsd-update</code> ze
	ge-updated kan hebben.  Voeg, om bepaalde bestanden of mappen
	uit te sluiten, deze toe aan de optie
	<code class="literal">IDSIgnorePaths</code> in
	<code class="filename">/etc/freebsd-update.conf</code>.</p><p>Dit systeem kan gebruikt worden als deel van een uitgebreide
	upgrademethode, afgezien van de eerder besproken versie.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="updating-upgrading.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="updating-upgrading.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="updating-upgrading-portsnap.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">Hoofdstuk 24. FreeBSD updaten en upgraden </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 24.3. Portsnap: een updategereedschap voor de Portscollectie</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>