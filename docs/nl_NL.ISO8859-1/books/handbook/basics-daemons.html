<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>4.8. Daemons, signalen en het stoppen van processen</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="basics.html" title="Hoofdstuk 4. UNIX® beginselen" /><link rel="prev" href="basics-processes.html" title="4.7. Processen" /><link rel="next" href="shells.html" title="4.9. Shells" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4.8. Daemons, signalen en het stoppen van processen</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="basics-processes.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 4. <span class="trademark">UNIX</span>® beginselen</th><td width="20%" align="right"> <a accesskey="n" href="shells.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="basics-daemons"></a>4.8. Daemons, signalen en het stoppen van processen</h2></div></div></div><p>Als een gebruiker een editor draait is het makkelijk om de
      editor te besturen, te vertellen om bestanden te openen, etc.
      Dit kan omdat de editor de mogelijkheden geeft om dat te doen en
      omdat de editor gekoppeld is aan een
      <em class="firstterm">terminal</em>.  Sommige programma's zijn niet
      ontworpen om te draaien met continue gebruikersinvoer, dus
      als zij de kans krijgen ontkoppelen zij zich van de terminal.
      Een webserver reageert bijvoorbeeld de hele dag op webaanvragen
      en heeft eigenlijk geen input van een lokale gebruiker nodig.
      Programma's die email van locatie naar locatie transporteren zijn
      een ander voorbeeld.</p><p>Deze programma's heten <em class="firstterm">daemons</em>.
      Daemons waren karakters in de Griekste mythologie, goed noch
      slecht, ze waren dienende geesten die op grote schaal nuttige
      dingen deden voor de mensheid.  Net zoals de huidige webservers
      en mailservers nuttige dingen doen.  Dit is waarom de mascotte
      voor BSD al lang een vrolijk kijkende daemon met puntoren en een
      drietand is.</p><p>Er is een overeenkomst om programma's die meestal draaien als
      daemon te voorzien van het achtervoegsel <span class="quote">&#8220;<span class="quote">d</span>&#8221;</span>.
      <span class="application">BIND</span> is de Berkeley Internet Name
      Domain (het echte programma heet <code class="command">named</code>), de
      <span class="application">Apache</span> webserver heet
      <code class="command">httpd</code>, de printerspooldriver heet
      <code class="command">lpd</code>, etc.  Deze overeenkomst geldt niet
      altijd.  De hoofd maildaemon voor
      <span class="application">Sendmail</span> heet bijvoorbeeld
      <code class="command">sendmail</code> en niet
      <code class="command">maild</code>.</p><p>Soms is communicatie met een daemon nodig.  Een manier om dit te
      doen is het versturen van een signaal (<em class="firstterm">signals</em>).
      Er zijn een verschillende signalen.  Sommige hebben een specifieke
      bedoeling, andere worden geïntrepeteerd door de applicatie.
      In de documentatie van de applicatie staat hoe de applicatie
      signalen intrepeteert.  Er kan alleen een signaal naar een proces
      gezonden worden waar de uitvoerende gebruiker eigenaar van is.
      Als met <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> of <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">kill</span>(2)</span></a> een signaal naar een proces
      van een andere gebruiker wordt gestuurd, wordt de toegang
      geweigerd.  De enige uitzondering hierop is de
      <code class="systemitem">root</code> gebruiker, die signalen naar processen
      van alle gebruikers kan sturen.</p><p>FreeBSD stuurt soms ook signalen naar applicaties.  Als een
      applicatie slecht geschreven is en hij probeert geheugen te
      benaderen waar hij niet naartoe mag, stuurt FreeBSD het proces een
      <em class="firstterm">Segmentation Violation</em> signaal
      (<code class="literal">SIGSEGV</code>).  Als een applicatie de
      systeemaanroep <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=alarm&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">alarm</span>(3)</span></a> heeft gebruikt om na een bepaalde
      periode een alarm te ontvangen, wordt er een Alarm signaal
      heen gestuurd (<code class="literal">SIGALRM</code>), etc.</p><p>Twee signalen kunnen gebruikt worden om een proces te
      stoppen: <code class="literal">SIGTERM</code> en
      <code class="literal">SIGKILL</code>.  <code class="literal">SIGTERM</code> is de
      nette manier om een proces te killen.  Het proces kan het signaal
      <span class="emphasis"><em>afvangen</em></span>, begrijpen dat de eigenaar wil dat
      het wordt afgesloten, wellicht logboekbestanden sluiten die
      geopend zijn en alle onderhanden activiteiten afhandelen.  In een
      aantal gevallen kan een proces <code class="literal">SIGTERM</code>
      negeren: als het midden in een taak zit die niet beëindigd
      kan worden.</p><p><code class="literal">SIGKILL</code> mag niet worden genegeerd door een
      proces.  Dit is het <span class="quote">&#8220;<span class="quote">Wat je ook aan het doen bent, stop er
	nu mee</span>&#8221;</span> signaal.  Na een <code class="literal">SIGKILL</code>
      stopt FreeBSD het proces meteen.
      <a href="#ftn.idp69418576" class="footnote" id="idp69418576"><sup class="footnote">[4]</sup></a></p><p>Andere veelgebruikte signalen zijn <code class="literal">SIGHUP</code>,
      <code class="literal">SIGUSR1</code> en <code class="literal">SIGUSR2</code>.  Dit
      zijn algemeen bruikbare signalen en verschillende applicaties
      zullen verschillend reageren als ze verstuurd worden.</p><p>Stel dat het bestand met instellingen voor de webserver is
      aangepast.  Dan moet aan de webserver verteld worden dat die de
      instellingen opnieuw moet lezen.  Hiervoor zou
      <code class="command">httpd</code> gestopt en gestart kunnen worden, maar
      dit resulteert in een korte onderbreking van de webserverdienst,
      wat ongewenst kan zijn.  De meeste daemons zijn geschreven om te
      reageren op het <code class="literal">SIGHUP</code> signaal door het
      opnieuw inlezen van het instellingenbestand.  Dus in plaats van
      het stoppen en herstarten van <code class="command">httpd</code> kan het
      <code class="literal">SIGHUP</code> signaal gezonden worden.  Omdat er geen
      standaard manier is om op deze signalen te reageren, reageren
      verschillende daemons anders.  Het is verstandig eerst de
      documentatie van de daemon in kwestie te lezen.</p><p>Zoals onderstaand voorbeeld laat zien, worden signalen door
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> verzonden.</p><div class="procedure"><a id="idp69424464"></a><div class="procedure-title">Procedure 4.1. Het versturen van een signaal naar een proces</div><p>Dit voorbeeld toont hoe een signaal naar <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a>
	wordt verstuurd.  Het bestand met instellingen voor
	<code class="command">inetd</code> is
	<code class="filename">/etc/inetd.conf</code> en
	<code class="command">inetd</code> leest dit bestand opnieuw in als er
	een <code class="literal">SIGHUP</code> wordt verstuurd.</p><ol class="procedure" type="1"><li class="step"><p>Eerst moet het proces ID worden opgezocht van het proces
	  waar een signaal naar verzonden moeten worden.  Dit kan door
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pgrep&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">pgrep</span>(1)</span></a> te gebruiken.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>pgrep -l inetd</code></strong>
198  inetd -wW</pre><p>Dus het PID van <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> is 198.</p></li><li class="step"><p>Met <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> kan het signaal verzonden worden.  Omdat
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> wordt gedraaid door <code class="systemitem">root</code>
	  moet <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=su&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">su</span>(1)</span></a> gebruikt worden om <code class="systemitem">root</code>
	  te worden.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>su</code></strong>
<code class="prompt">Password:</code>
<code class="prompt">#</code> <strong class="userinput"><code>/bin/kill -s HUP 198</code></strong></pre><p>Zoals zovaak met <span class="trademark">UNIX</span>® commando's, geeft <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a>
	  geen uitvoer als het succesvol uitgevoerd is.  Als een
	  signaal wordt verzonden naar een proces waarvan de gebruiker
	  niet zelf de eigenaar is, dan is de melding: <span class="errorname">kill:
	    <em class="replaceable"><code>PID</code></em>: Operation not
	    permitted</span>.  Als het PID verkeerd wordt
	  ingevuld, wordt het signaal naar het verkeerde proces
	  verzonden, wat slecht kan zijn, of, als de gebruiker geluk
	  heeft, wordt het verzonden naar een PID dat momenteel niet in
	  gebruik is, waarop de foutmelding <span class="errorname">kill:
	    <em class="replaceable"><code>PID</code></em>: No such process</span>
	  verschijnt.</p><div xmlns="" class="note"><h3 class="admontitle">Waarom <code xmlns="http://www.w3.org/1999/xhtml" class="command">/bin/kill</code> gebruiken?: </h3><p xmlns="http://www.w3.org/1999/xhtml">Veel shells leveren <code class="command">kill</code> als
	    ingebouwd commando.  Dat betekent dat de shell het
	    signaal direct verstuurt in plaats van door het starten van
	    <code class="filename">/bin/kill</code>.  Dit kan erg nuttig zijn,
	    maar verschillende shells hebben een verschillende
	    opdrachtregel voor het specificeren van de naam van het
	    signaal dat verstuurd moet worden.  In plaats van ze
	    allemaal te leren, is het eenvoudiger om gewoon
	    <code class="command">/bin/kill PID</code>
	    te gebruiken.</p></div></li></ol></div><p>Andere signalen versturen werkt bijna hetzelfde door
      <code class="literal">TERM</code> of <code class="literal">KILL</code> op de
      commandoregel te vervangen door wat nodig is.</p><div xmlns="" class="important"><h3 class="admontitle">Belangrijk: </h3><p xmlns="http://www.w3.org/1999/xhtml">Het stoppen van willekeurige processen op een systeem is
	meestal een slecht idee.  In het bijzonder bij <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=init&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">init</span>(8)</span></a> met
	proces ID 1.  Het draaien van <code class="command">/bin/kill -s KILL
	  1</code> is een snelle manier om een systeem uit te
	zetten.  Argumenten die aan <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">kill</span>(1)</span></a> worden meegegeven
	moeten <span class="emphasis"><em>altijd</em></span> twee keer gecontroleerd
	worden <span class="emphasis"><em>voordat</em></span> op <span class="keycap"><strong>Enter</strong></span>
	gedrukt wordt.</p></div><div class="footnotes"><br /><hr class="footnote-hr" /><div id="ftn.idp69418576" class="footnote"><p><a href="#idp69418576" class="para"><sup class="para">[4] </sup></a>Dit is niet geheel waar.  Er zijn een aantal dingen
	  die niet onderbroken kunnen worden.  Als het proces
	  bijvoorbeeld een bestand probeert uit te lezen dat op een
	  andere computer in het netwerk staat en de andere computer
	  is verdwenen (uitgezet of het netwerk heeft een fout), dan
	  wordt er gezegd dat het proces niet
	  <span class="quote">&#8220;<span class="quote">onderbroken</span>&#8221;</span> kan worden.  Uiteindelijk loopt
	  het proces uit de tijd, meestal na twee minuten.  Zodra het
	  uit de tijd loopt, wordt het proces alsnog
	  gestopt.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="basics-processes.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="basics.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="shells.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">4.7. Processen </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 4.9. Shells</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>