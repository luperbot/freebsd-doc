<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>28.5. Problemen oplossen</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="mail.html" title="Hoofdstuk 28. Elektronische mail" /><link rel="prev" href="mail-changingmta.html" title="28.4. De Mail Transfer Agent vervangen" /><link rel="next" href="mail-advanced.html" title="28.6. Geavanceerde onderwerpen" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">28.5. Problemen oplossen</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mail-changingmta.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 28. Elektronische mail</th><td width="20%" align="right"> <a accesskey="n" href="mail-advanced.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mail-trouble"></a>28.5. Problemen oplossen</h2></div></div></div><a id="idp85717968" class="indexterm"></a><div class="qandaset"><a id="idp85719120"></a><dl><dt>28.5.1. <a href="mail-trouble.html#idp85719376">Waarom is het nodig om de FQDN te gebruiken voor hosts
	    op de site?</a></dt><dt>28.5.2. <a href="mail-trouble.html#idp85734608">sendmail zegt mail
	      loops back to myself</a></dt><dt>28.5.3. <a href="mail-trouble.html#idp85739856">Hoe kan een mailserver op een inbel-PPP-host gedraaid
	    worden?</a></dt><dt>28.5.4. <a href="mail-trouble.html#idp85759696">Waarom blijven er fouten als Relaying Denied
	       verchijnen wanneer er mail van andere hosts
	    wordt verstuurd?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp85719376"></a><a id="idp85719632"></a><p><strong>28.5.1.</strong></p></td><td align="left" valign="top"><p>Waarom is het nodig om de FQDN te gebruiken voor hosts
	    op de site?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Het is waarschijnlijk dat de host zich in een ander
	    domein bevindt; bijvoorbeeld als het gewenst is om host
	    <code class="systemitem">mompel </code> in het domein <code class="systemitem">bar.edu</code> vanuit domein <code class="systemitem">foo.bar.edu</code> te bereiken, is het nodig
	    om er met de volledig gekwalificeerde domeinnaam naar te
	    verwijzen, <code class="systemitem">mompel.bar.edu</code>, in
	    plaats van slechts <code class="systemitem">mompel</code>.</p><p>Traditioneel werd dit door BSD BIND<a id="idp85727952" class="indexterm"></a> resolvers toegestaan.  De
	    huidige versie van <span class="application">BIND</span> die
	    met FreeBSD wordt geleverd levert niet langer standaard
	    afkortingen voor onvolledig gekwalificeerde domeinnamen
	    anders dan het huidige domein.  Dus moet een
	    ongekwalificeerde host <code class="systemitem">mompel</code> òf als
	    <code class="systemitem">mompel.foo.bar.edu</code> gevonden
	    worden, òf wordt er naar gezocht in het root-domein.</p><p>Dit verschilt van het vorige gedrag, waar de zoektocht
	    doorging over <code class="systemitem">mompel.bar.edu</code>,
	    en <code class="systemitem">bar.edu</code>.
	    Zie RFC 1535 voor de redenen waarom dit als een slechte
	    gewoonte en zelfs als beveiligingslek werd beschouwd.</p><p>Als een goede tussenoplossing kan deze regel:</p><pre class="programlisting">search foo.bar.edu bar.edu</pre><p>in plaats van het voorgaande:</p><pre class="programlisting">domain foo.bar.edu</pre><p>in <code class="filename">/etc/resolv.conf</code> geplaatst worden.
	    Ben er echter zeker van dat de zoekvolgorde niet verder gaat
	    dan de <span class="quote">&#8220;<span class="quote">grens tussen lokale en publieke regelgeving</span>&#8221;</span>,
	    zoals RFC 1535 het noemt.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp85734608"></a><a id="idp85734864"></a><p><strong>28.5.2.</strong></p></td><td align="left" valign="top"><p><span class="application">sendmail</span> zegt <span class="errorname">mail
	      loops back to myself</span></p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Dit wordt in de FAQ van <span class="application">sendmail</span>
	    als volgt beantwoord:</p><pre class="programlisting">Deze foutmeldingen verschijnen:

553 MX list for domain.net points back to relay.domain.net
554 &lt;user@domain.net&gt;... Local configuration error

Hoe kan dit probleem worden opgelost?

Er is gevraagd om mail van het domein (bijvoorbeeld domain.net) naar een
specifieke host door te sturen (in dit geval relay.domain.net) door
gebruik te maken van een MX-regel, maar de machine die het door moet
sturen herkent zichzelf niet als domain.net.  Voeg domain.net toe aan
/etc/mail/local-host-names [bekend als /etc/sendmail.cw voor versies
eerder dan 8.10] (als FEATURE(use_cw_file) gebruikt wordt) of voeg
<span class="quote">&#8220;<span class="quote">Cw domain.net</span>&#8221;</span> toe aan /etc/mail/sendmail.cf.</pre><p>De FAQ van <span class="application">sendmail</span> is te
	    vinden op <code class="uri"><a class="uri" href="http://www.sendmail.org/faq/" target="_top">http://www.sendmail.org/faq/</a></code>
	    en wordt aangeraden om te lezen indien enig <span class="quote">&#8220;<span class="quote">tweaken
	      </span>&#8221;</span> van de mailinstallatie gewenst is.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp85739856"></a><a id="idp85740112"></a><p><strong>28.5.3.</strong></p></td><td align="left" valign="top"><p>Hoe kan een mailserver op een inbel-PPP-host gedraaid
	    worden?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Het is gewenst om een FreeBSD-computer in een LAN met het
	    Internet te verbinden.  De FreeBSD-computer zal en mail-gateway
	    voor het LAN zijn.  De PPP-verbinding is niet toegewijd.</p><p>Er zijn minstens twee manieren om dit te doen.
	    Eén manier is om UUCP<a id="idp85741776" class="indexterm"></a> te gebruiken.</p><p>Een andere manier is ervoor te zorgen dat een server die
	    altijd met het Internet verbonden is secundaire
	    MX-diensten<a id="idp85747152" class="indexterm"></a>
	    voor het domein biedt.  Als het domein bijvoorbeeld <code class="systemitem">example.com</code> is en de
	    internetprovider <code class="systemitem">example.net
	    </code> heeft ingesteld om secundaire MX-diensten voor het
	    domein te bieden:</p><pre class="programlisting">example.com.		MX	10	example.com.
			MX	20	example.net.</pre><p>Er dient slechts één host als de
	    uiteindelijke ontvanger gespecificeerd te worden (voeg
	    <code class="literal">CW example.com</code> toe aan <code class="filename">
	      /etc/mail/sendmail.cf</code> op <code class="systemitem">example.com&gt;</code>).</p><p>Wanneer de verzendende <code class="command">sendmail</code>
	    probeert om mail af te leveren zal het proberen met <code class="systemitem">example.com</code> te verbinden via de
	    modemverbinding.  Waarschijnlijk zal dit een time-out geven
	    omdat de computer niet online is.  Het programma
	    <span class="application">sendmail</span> zal het automatisch aan
	    de secundaire MX-site, de internetprovider (<code class="systemitem">example.net</code>) afleveren.  De
	    secundaire MX zal dan periodiek proberen om een verbinding te
	    maken met de computer en de mail aan de primaire MX-host
	    leveren (<code class="systemitem">example.com</code>).</p><p>Het kan wenselijk zijn om iets als het onderstaande als
	    inlogscript te gebruiken:</p><pre class="programlisting">#!/bin/sh
# Zet mij in /usr/local/bin/pppmyisp
( sleep 60 ; /usr/sbin/sendmail -q ) &amp;
/usr/sbin/ppp -direct pppmyisp</pre><p>Indien er een apart inlogscript voor een gebruiker wordt
	    aangemaakt, kan <code class="command">sendmail -qRexample.com</code>
	    gebruikt worden in plaats van het bovenstaande script.  Dit
	    zorgt ervoor dat alle mail in de mailrij voor <code class="systemitem">example.com</code> onmiddellijk
	    verwerkt wordt.</p><p>Een verdere verfijning van de situatie is deze:</p><p>Bericht gestolen van de <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-isp" target="_top">FreeBSD Internet service provider mailinglijst</a>.</p><pre class="programlisting">&gt; we bieden de secundaire MX voor een klant.
&gt; De klant maakt automatisch verschillende keren per dag een verbinding
&gt; met onze diensten om de mailberichten naar zijn primaire MX te
&gt; sturen (we bellen zijn site niet indien er een mail voor zijn
&gt; domein arriveert).  Onze sendmail verstuurt de mailrij om de 30
&gt; minuten.  Op het moment moet de klant 30 minuten online blijven om
&gt; er zeker van te zijn dat alle mail naar de primaire MX is gegaan.
&gt;
&gt; Is er een commando dat sendmail er toe aanzet om alle mailberichten
&gt; nu te versturen?  De gebruiker heeft uiteraard geen root-rechten op
&gt; onze machine.

In de sectie <span class="quote">&#8220;<span class="quote">privacy flags</span>&#8221;</span> van sendmail.cf staat een
definitie Opgoaway,restrictqrun

Verwijder restrictqrun om niet-root-gebruikers toe te staan te beginnen
de rij te verwerken.  Het kan ook wenselijk zijn om de MXs opnieuw te
rangschikken.  Wij zijn zo de eerste MX voor onze klanten, en we hebben
dit gedefinieerd:

# Als we de beste MX voor een host zijn, probeer direct in plaats van
# een lokale configuratiefout te genereren.
OwTrue

Op deze manier zal een site op afstand rechtstreeks hier afleveren,
zonder de verbinding van de klant te proberen.  Vervolgens wordt er naar
de klant verstuurd.  Dit werkt alleen voor <span class="quote">&#8220;<span class="quote">hosts</span>&#8221;</span>, dus
dient de klant hun mailcomputer <span class="quote">&#8220;<span class="quote">customer.com</span>&#8221;</span> te noemen en
<span class="quote">&#8220;<span class="quote">hostname.customer.com</span>&#8221;</span> in de DNS de plaatsen.  Plaats een
A-regel in de DNS voor <span class="quote">&#8220;<span class="quote">customer.com</span>&#8221;</span>.</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp85759696"></a><a id="idp85759952"></a><p><strong>28.5.4.</strong></p></td><td align="left" valign="top"><p>Waarom blijven er fouten als <span class="errorname">Relaying Denied
	      </span> verchijnen wanneer er mail van andere hosts
	    wordt verstuurd?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>In standaard FreeBSD-installaties is <span class="application">sendmail
	      </span> geconfigureerd om alleen mail te versturen
	    van de host waarop het draait.  Als bijvoorbeeld een
	    <acronym class="acronym">POP</acronym>-server beschikbaar is, kunnen
	    gebruikers mail controleren vanuit school, werk, of andere
	    lokaties op afstand, maar zullen ze nog steeds niet in staat
	    zijn om uitgaande emails van lokaties van buitenaf te
	    versturen.  Gewoonlijk zal er na enkele ogenblikken na de
	    poging een email van <span class="application">MAILER-DAEMON</span>
	    worden verzonden met een foutbericht
	    <span class="errorname">5.7 Relaying Denied</span>.</p><p>Er zijn verschillende manieren om dit te omzeilen.  De
	    oplossing die het meest voor de hand ligt, is om het adres
	    van de internetprovider in een bestand relay-domains op
	    <code class="filename">/etc/mail/relay-domains</code> te zetten.
	    Een snelle manier om dit te doen is:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>echo "your.isp.example.com" &gt; /etc/mail/relay-domains</code></strong></pre><p>Nadat dit bestand is aangemaakt of bewerkt dient
	    <span class="application">sendmail</span> opnieuw gestart te
	    worden.  Dit werkt prima indien u een serverbeheerder bent
	    en het niet wenselijk is om mail lokaal te verzenden, of
	    indien het gewenst is om een point-en-click client/systeem
	    op een andere machine of zelfs bij een andere
	    internetprovider te gebruiken.  Het is ook erg bruikbaar
	    indien er slechts enkele email-accounts zijn aangemaakt.
	    Als er een groot aantal adressen dient te worden toegevoegd,
	    kan dit bestand in een tekstverwerker worden geopend en de
	    domeinen worden toegevoegd, één per regel:</p><pre class="programlisting">your.isp.example.com
other.isp.example.net
users-isp.example.org
www.example.org</pre><p>Nu zal het verzenden van elke mail door dit systeem,
	    verstuurd door elke host in deze lijst, lukken (aangenomen
	    dat de gebruiker een account op het systeem heeft).  Dit is
	    een aardige manier om gebruikers toe te staan op afstand mail
	    vanaf het systeem te verzenden zonder dat mensen wordt
	    toegestaan om spam vanaf het systeem te verzenden.</p></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail-changingmta.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="mail-advanced.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">28.4. De Mail Transfer Agent vervangen </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 28.6. Geavanceerde onderwerpen</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>