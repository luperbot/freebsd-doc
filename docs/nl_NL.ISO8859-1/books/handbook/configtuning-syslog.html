<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>12.10. De systeemlogger syslogd configureren</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="config-tuning.html" title="Hoofdstuk 12. Instellingen en optimalisatie" /><link rel="prev" href="configtuning-virtual-hosts.html" title="12.9. Virtuele hosts" /><link rel="next" href="configtuning-configfiles.html" title="12.11. Instellingenbestanden" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">12.10. De systeemlogger <span class="application">syslogd</span>
      configureren</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="configtuning-virtual-hosts.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 12. Instellingen en optimalisatie</th><td width="20%" align="right"> <a accesskey="n" href="configtuning-configfiles.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="configtuning-syslog"></a>12.10. De systeemlogger <span class="application">syslogd</span>
      configureren</h2></div><div><span class="authorgroup">Bijgedragen door <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Niclas</span> <span class="surname">Zeising</span></span>. </span></div></div></div><a id="idp75082448" class="indexterm"></a><a id="idp75082960" class="indexterm"></a><a id="idp75083472" class="indexterm"></a><p>Systeemlogging is een belangrijk aspect van systeembeheer.  Het wordt
     zowel gebruikt voor het opsporen van hardware-problemen als voor
     software-problemen in het systeem.  Het speelt ook zeer belangrijke rol bij
     het controleren van de beveiliging en het reageren op incidenten.
     Systeem-daemons die niet in een terminal beheerd worden, loggen gewoonlijk
     informatie naar een systeemlogfaciliteit of een ander logbestand.</p><p>Deze sectie beschrijft hoe de FreeBSD systeemlogger, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">syslogd</span>(8)</span></a>, te
      configureren en te gebruiken, en behandelt logrotatie en logbeheer met
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newsyslog&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newsyslog</span>(8)</span></a>.  De focus ligt bij het opzetten en gebruiken van
      <code class="command">syslogd</code> op een lokale machine.  Meer geavanceerdere
      opstellingen die een aparte loghost gebruiken staan in <a class="xref" href="network-syslogd.html" title="29.11. Hosts op afstand loggen met syslogd">Paragraaf 29.11, &#8220;Hosts op afstand loggen met
      <code class="command">syslogd</code>&#8221;</a>.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75091280"></a>12.10.1. <span class="application">syslogd</span> gebruiken</h3></div></div></div><p>In de standaardconfiguratie van FreeBSD wordt <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">syslogd</span>(8)</span></a> gestart
	tijdens het opstarten.  Dit wordt bepaald door de variabele
	<code class="literal">syslogd_enable</code> in <code class="filename">/etc/rc.conf</code>.
	Er zijn vele toepassingsargumenten die het gedrag van <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">syslogd</span>(8)</span></a>
	beïnvloeden.  Gebruik <code class="literal">syslogd_flags</code> in
	<code class="filename">/etc/rc.conf</code> om ze te veranderen.  Bekijk
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">syslogd</span>(8)</span></a> voor meer informatie over de argumenten, en
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">rc.conf</span>(5)</span></a>, <a class="xref" href="configtuning-core-configuration.html" title="12.3. Hoofdinstellingen">Paragraaf 12.3, &#8220;Hoofdinstellingen&#8221;</a> en
	<a class="xref" href="configtuning-rcd.html" title="12.7. Gebruik van rc met FreeBSD">Paragraaf 12.7, &#8220;Gebruik van rc met FreeBSD&#8221;</a> voor meer informatie over
	<code class="filename">/etc/rc.conf</code> en het deelsysteem <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75099344"></a>12.10.2. <span class="application">syslogd</span> configureren</h3></div></div></div><a id="idp75100240" class="indexterm"></a><p>Het configuratiebestand, standaard
	<code class="filename">/etc/syslog.conf</code>, bepaalt wat <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">syslogd</span>(8)</span></a> doet
	met de logregels nadat ze eenmaal ontvangen zijn.  Er zijn verschillende
	parameters om de afhandeling van binnenkomende gebeurtenissen te
	beheren, waarvan de twee basaalste <em class="firstterm">faciliteit</em> en
	<em class="firstterm">niveau</em> zijn.  De faciliteit beschrijft welk
	deelsysteem het bericht genereerde, zoals de kernel of een daemon, het
	niveau beschrijft de ernst van de opgetreden gebeurtenis.  Dit maakt het
	mogelijk om het bericht naar verschillende logbestanden te loggen, of
	het weg te gooien, afhankelijk van de faciliteit en het niveau.  Het is
	ook mogelijk om actie te nemen afhankelijk van de toepassing dat het
	bericht verstuurde, en in het geval van loggen op afstand, ook de
	hostnaam van de machine dat het logbericht genereerde.</p><p>Het configureren van <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">syslogd</span>(8)</span></a> is vrij rechttoe-rechtaan.  Het
	configuratiebestand bevat één regel per actie, de syntaxis
	van elke regel is een selecteerderveld gevolgd door een actieveld.  De
	syntaxis van het selecteerderveld is
	<em class="replaceable"><code>faciliteit.niveau</code></em> dat overeenkomt met
	logberichten van <em class="replaceable"><code>faciliteit</code></em> op niveau
	<em class="replaceable"><code>niveau</code></em> of hoger.  Het is ook mogelijk om een
	optionele vergelijkingsvlag voor het niveau toe te voegen om meer
	precies te specificeren wat er gelogd wordt.  Er kunnen meerdere
	selecteerdervelden worden gebruikt voor dezelfde actie, ze worden
	gescheiden door een puntkomma (<code class="literal">;</code>).  Het gebruik van
	<code class="literal">*</code> zal met alles overeenkomen.  Het actieveld bepaalt
	waar het logbericht naar toe wordt gezonden, zoals een bestand of een
	loghost op afstand.  Als voorbeeld is hier de standaard
	<code class="filename">syslog.conf</code> van FreeBSD:</p><pre class="programlisting"># $FreeBSD$
#
#       Spaces ARE valid field separators in this file. However,
#       other *nix-like systems still insist on using tabs as field
#       separators. If you are sharing this file between systems, you
#       may want to use only tabs as field separators here.
#       Consult the <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslog.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">syslog.conf</span>(5)</span></a> manpage.
*.err;kern.warning;auth.notice;mail.crit                /dev/console <a id="co-syslog-many-match"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
*.notice;authpriv.none;kern.debug;lpr.info;mail.crit;news.err   /var/log/messages
security.*                                      /var/log/security
auth.info;authpriv.info                         /var/log/auth.log
mail.info                                       /var/log/maillog <a id="co-syslog-one-match"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>
lpr.info                                        /var/log/lpd-errs
ftp.info                                        /var/log/xferlog
cron.*                                          /var/log/cron
*.=debug                                        /var/log/debug.log <a id="co-syslog-comparison"></a><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span>
*.emerg                                         *
# uncomment this to log all writes to /dev/console to /var/log/console.log
#console.info                                   /var/log/console.log
# uncomment this to enable logging of all log messages to /var/log/all.log
# touch /var/log/all.log and chmod it to mode 600 before it will work
#*.*                                            /var/log/all.log
# uncomment this to enable logging to a remote loghost named loghost
#*.*                                            @loghost
# uncomment these if you're running inn
# news.crit                                     /var/log/news/news.crit
# news.err                                      /var/log/news/news.err
# news.notice                                   /var/log/news/news.notice
!ppp <a id="co-syslog-prog-spec"></a><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span>
*.*                                             /var/log/ppp.log
!*</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co-syslog-many-match"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Komt overeen met alle berichten met een <code class="literal">err</code>
	    of hoger, alsook met <code class="literal">kern.warning</code>,
	    <code class="literal">auth.notice</code> en <code class="literal">mail.crit</code>, en
	    stuur deze logberichten naar de console (
	   <code class="filename">/dev/console</code>).</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-syslog-one-match"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Komt overeen met alle berichten van de faciliteit
	    <code class="literal">mail</code> op niveau <code class="literal">info</code> of hoger,
	    en logt de berichten in
	    <code class="filename">/var/log/maillog</code>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-syslog-comparison"><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Deze regel gebruikt een vergelijkingsvlag, <code class="literal">=</code>
	    om alleen met de berichten op niveau <code class="literal">debug</code>
	    overeen te komen en ze op te slaan in
	    <code class="filename">/var/log/debug.log</code>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-syslog-prog-spec"><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Hier volgt een gebruiksvoorbeeld van een
	    <span class="emphasis"><em>programmaspecificatie</em></span>.  Dit zorgt ervoor dat de
	    regels alleen geldig zijn voor het programma in de
	    programmaspecificatie.  In dit geval zorgen deze en de volgende
	    regel ervoor dat alle berichten van <code class="command">ppp</code>, maar
	    niet van andere programma's, in
	    <code class="filename">/var/log/ppp.log</code> terechtkomen.</p></td></tr></table></div><p>Dit voorbeeld toont dat er vele niveaus en deelsystemen zijn.  De
	niveaus zijn, in volgorde van meest naar minst kritisch:
	<code class="literal">emerg</code>, <code class="literal">alert</code>,
	<code class="literal">crit</code>, <code class="literal">err</code>,
	<code class="literal">warning</code>, <code class="literal">notice</code>,
	<code class="literal">info</code> en <code class="literal">debug</code>.</p><p>De faciliteiten zijn, in geen specifieke volgorde:
	<code class="literal">auth</code>, <code class="literal">authpriv</code>,
	<code class="literal">console</code>, <code class="literal">cron</code>,
	<code class="literal">daemon</code>, <code class="literal">ftp</code>,
	<code class="literal">kern</code>, <code class="literal">lpr</code>,
	<code class="literal">mail</code>, <code class="literal">mark</code>,
	<code class="literal">news</code>, <code class="literal">security</code>,
	<code class="literal">syslog</code>, <code class="literal">user</code>,
	<code class="literal">uucp</code> en <code class="literal">local0</code> tot en met
	<code class="literal">local7</code>.  Let erop dat andere besturingssystemen
	andere faciliteiten kunnen hebben.</p><p>Met deze kennis is het eenvoudig om een nieuwe regel aan
	<code class="filename">/etc/syslog.conf</code> toe te voegen om alles van de
	verschillende daemons op niveau <code class="literal">notice</code> en hoger naar
	<code class="filename">/var/log/daemon.log</code> te loggen:</p><pre class="programlisting">daemon.notice                                        /var/log/daemon.log</pre><p>Bekijk <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslog&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">syslog</span>(3)</span></a> en <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">syslogd</span>(8)</span></a> voor meer informatie over
	de verschillende niveaus en faciliteiten. Zie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslog.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">syslog.conf</span>(5)</span></a> en
	<a class="xref" href="network-syslogd.html" title="29.11. Hosts op afstand loggen met syslogd">Paragraaf 29.11, &#8220;Hosts op afstand loggen met
      <code class="command">syslogd</code>&#8221;</a> voor meer informatie over
	<code class="filename">syslog.conf</code>, de syntaxis, en geavanceerdere
	gebruiksvoorbeelden.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75143248"></a>12.10.3. Logbeheer en -rotatie met
	<span class="application">newsyslog</span></h3></div></div></div><a id="idp75144144" class="indexterm"></a><a id="idp75144656" class="indexterm"></a><a id="idp75145168" class="indexterm"></a><a id="idp75149904" class="indexterm"></a><p>Logbestanden hebben de neiging om snel te groeien en gestadig
	 opgehoopt te raken.  Dit leidt tot bestanden die vol zitten met minder
	 direct bruikbare informatie en de harde schijf volmaken.  Logbeheer
	 kan gebruikt worden om dit te beheersen.  In FreeBSD wordt
	 <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newsyslog&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newsyslog</span>(8)</span></a> gebruikt om logbestanden te beheren.  Dit programma
	 wordt gebruikt om periodiek logbestanden te roteren en te comprimeren
	 en om optioneel ontbrekende logbestanden aan te maken en programma's
	 te signaleren dat logbestanden zijn verplaatst.  De logbestanden hoeven
	 niet per sé van syslog afkomstig te zijn; <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newsyslog&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newsyslog</span>(8)</span></a>
	 werkt met elke log van elk programma.  Het is belangrijk om op te
	 merken dat <code class="command">newsyslog</code> normaliter vanuit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a>
	 wordt gedraaid en niet een systeem-daemon is.  In de
	 standaardconfiguratie wordt het elk uur gedraaid.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp75153488"></a>12.10.3.1. <span class="application">newsyslog</span> configureren</h4></div></div></div><p>Om te weten wat het moet doen leest <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newsyslog&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newsyslog</span>(8)</span></a> zijn
	  configuratiebestand, standaard is dit
	  <code class="filename">/etc/newsyslog.conf</code>.  Dit configuratiebestand
	  bevat één regel voor elk bestand dat <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newsyslog&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newsyslog</span>(8)</span></a>
	  beheert.  Elke regel noemt de eigenaar van het bestand, rechten, en
	  wanneer dat bestand te roteren, alsook optionele vlaggen die de
	  logrotatie beïnvloeden (zoals compressie) en naar welke
	  programma's een signaal te sturen wanner de log is geroteerd.  Als
	  voorbeeld is hier de standaard configuratie in FreeBSD:</p><pre class="programlisting"># configuration file for newsyslog
# $FreeBSD$
#
# Entries which do not specify the '/pid_file' field will cause the
# syslogd process to be signalled when that log file is rotated.  This
# action is only appropriate for log files which are written to by the
# syslogd process (ie, files listed in /etc/syslog.conf).  If there
# is no process which needs to be signalled when a given log file is
# rotated, then the entry for that file should include the 'N' flag.
#
# The 'flags' field is one or more of the letters: BCDGJNUXZ or a '-'.
#
# Note: some sites will want to select more restrictive protections than the
# defaults.  In particular, it may be desirable to switch many of the 644
# entries to 640 or 600.  For example, some sites will consider the
# contents of maillog, messages, and lpd-errs to be confidential.  In the
# future, these defaults may change to more conservative ones.
#
# logfilename          [owner:group]    mode count size when  flags [/pid_file] [sig_num]
/var/log/all.log                        600  7     *    @T00  J
/var/log/amd.log                        644  7     100  *     J
/var/log/auth.log                       600  7     100  @0101T JC
/var/log/console.log                    600  5     100  *     J
/var/log/cron                           600  3     100  *     JC
/var/log/daily.log                      640  7     *    @T00  JN
/var/log/debug.log                      600  7     100  *     JC
/var/log/init.log                       644  3     100  *     J
/var/log/kerberos.log                   600  7     100  *     J
/var/log/lpd-errs                       644  7     100  *     JC
/var/log/maillog                        640  7     *    @T00  JC
/var/log/messages                       644  5     100  @0101T JC
/var/log/monthly.log                    640  12    *    $M1D0 JN
/var/log/pflog                          600  3     100  *     JB    /var/run/pflogd.pid
/var/log/ppp.log        root:network    640  3     100  *     JC
/var/log/security                       600  10    100  *     JC
/var/log/sendmail.st                    640  10    *    168   B
/var/log/utx.log                        644  3     *    @01T05 B
/var/log/weekly.log                     640  5     1    $W6D0 JN
/var/log/xferlog                        600  7     100  *     JC</pre><p>Elke regel begint met de naam van het bestand dat geroteerd moet
	  worden, optioneel gevolgd door een eigenaar en groep voor zowel de
	  geroteerde als nieuw aangemaakte bestanden.  Het volgende veld,
	  <code class="literal">mode</code> is de modus van de bestanden en
	  <code class="literal">count</code> geeft aan hoeveel geroteerde logbestanden
	  bewaard moeten worden.  De velden <code class="literal">size</code> en
	  <code class="literal">when</code> vertellen <code class="command">newyslog</code> wanneer
	  het bestand geroteerd moet worden.  Een logbestand wordt geroteerd
	  wanneer òfwel de grootte meer is dan de waarde in het veld
	  <code class="literal">size</code>, òfwel wanneer de tijd in het veld
	  <code class="literal">when</code> is verstreken.  <code class="literal">*</code> geeft aan
	  dat dit veld genegeerd wordt.  Het veld
	  <em class="replaceable"><code>flags</code></em> geeft <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newsyslog&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newsyslog</span>(8)</span></a> verdere
	  instructies, zoals hoe het geroteerde bestand te comprimeren of om het
	  logbestand aan te maken als het ontbreekt.  De laatste twee velden
	  zijn optioneel en specificeren het <acronym class="acronym">PID</acronym>-bestand van een proces en
	  een naar dat proces te verzenden signaalnummer wanneer het bestand
	  wordt geroteerd.  Raadpleeg <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newsyslog.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">newsyslog.conf</span>(5)</span></a> voor meer
	  informatie over alle velden, geldige vlaggen en hoe de rotatietijd te
	  specificeren.  Herinner dat <code class="command">newsyslog</code> wordt
	  gedraaid vanuit <code class="command">cron</code> en niet vaker bestanden kan
	  roteren dan dat het gedraaid wordt vanuit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a>.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="configtuning-virtual-hosts.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="config-tuning.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="configtuning-configfiles.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">12.9. Virtuele hosts </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 12.11. Instellingenbestanden</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>