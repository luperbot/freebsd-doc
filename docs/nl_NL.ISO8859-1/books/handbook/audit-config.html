<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>18.4. Audit Configuratie</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD handboek" /><link rel="up" href="audit.html" title="Hoofdstuk 18. Security Event Auditing" /><link rel="prev" href="audit-install.html" title="18.3. Installeren van audit ondersteuning." /><link rel="next" href="audit-administration.html" title="18.5. Het audit subsysteem beheren." /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">18.4. Audit Configuratie</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="audit-install.html">Terug</a> </td><th width="60%" align="center">Hoofdstuk 18. Security Event Auditing</th><td width="20%" align="right"> <a accesskey="n" href="audit-administration.html">Volgende</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="audit-config"></a>18.4. Audit Configuratie</h2></div></div></div><p>Alle configuratie bestanden voor beveiligings audit kunnen
      worden gevonden in
      <code class="filename">/etc/security</code>.  De volgende
      bestanden moeten aanwezig zijn voor de audit daemon wordt
      gestart:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">audit_class</code> - Bevat de definities
	  van de audit klasses.</p></li><li class="listitem"><p><code class="filename">audit_control</code> - Controleert aspecten
	  van het audit subsysteem, zoals de standaard audit klassen,
	  minimale hoeveelheid diskruimte die moet overblijven op de
	  audit log schijf, de maximale audit trail grootte, etc.</p></li><li class="listitem"><p><code class="filename">audit_event</code> - Tekst namen en
	  beschrijvingen van systeem audit evenementen, evenals een
	  lijst van klassen waarin elk evenement zich bevind.</p></li><li class="listitem"><p><code class="filename">audit_user</code> - Gebruiker specifieke
	  audit benodigdheden welke gecombineerd worden met de globale
	  standaarden tijdens het inloggen.</p></li><li class="listitem"><p><code class="filename">audit_warn</code> - Een bewerkbaar shell
	  script gebruikt door de <span class="application">auditd</span>
	  applicatie welke waarschuwings berichten genereert in
	  bijzondere situaties zoals wanneer de ruimte voor audit
	  records te laagis of wanneer het audit trail bestand is
	  geroteerd.</p></li></ul></div><div xmlns="" class="warning"><h3 class="admontitle">Waarschuwing: </h3><p xmlns="http://www.w3.org/1999/xhtml">Audit configuratie bestanden moeten voorzichtig worden
	bewerkt en onderhouden, omdat fouten in de configuratie kunnen
	resulteren in het verkeerd loggen van evenementen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp79082832"></a>18.4.1. Evenement selectie expressies</h3></div></div></div><p>Selectie expressies worden gebruikt op een aantal plaatsen
	in de audit configuratie om te bepalen welke evenementen er
	geaudit moeten worden.  Expressies bevatten een lijst van
	evenement klassen welke gelijk zijn aan een prefix welke
	aangeeft of gelijke records geaccepteerd moeten worden of
	genegeerd en optioneel om aan te geven of de regel is bedoeld
	om succesvolle of mislukte operaties te matchen.  Selectie
	expressies worden geevalueerd van links naar rechts en twee
	expressies worden gecombineerd door de één aan de
	ander toe te voegen.</p><p>De volgende lijst bevat de standaard audit evenement klassen
	welke aanwezig zijn in het <code class="filename">audit_class</code>
	bestand:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">all</code> - <span class="emphasis"><em>all</em></span> -
	    Matched alle evenement klasses.</p></li><li class="listitem"><p><code class="literal">ad</code> -
	    <span class="emphasis"><em>administrative</em></span> - Administratieve acties
	    welke uitgevoerd worden op het gehele systeem.</p></li><li class="listitem"><p><code class="literal">ap</code> - <span class="emphasis"><em>application</em></span> -
	    Applicatie gedefinieerde acties.</p></li><li class="listitem"><p><code class="literal">cl</code> - <span class="emphasis"><em>file close</em></span> -
	    Audit aanroepen naar de <code class="function">close</code> systeem
	    aanroep.</p></li><li class="listitem"><p><code class="literal">ex</code> - <span class="emphasis"><em>exec</em></span> - Audit
	    programma uitvoer.  Het auditen van command line argumenten
	    en omgevings variabelen wordt gecontroleerd via
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=audit_control&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">audit_control</span>(5)</span></a> door gebruik te maken van de
	    <code class="literal">argv</code> en <code class="literal">envv</code> parameters
	    in de <code class="literal">policy</code> setting.</p></li><li class="listitem"><p><code class="literal">fa</code> -
	    <span class="emphasis"><em>file attribute access</em></span> - Audit de
	    toevoeging van object attributen zoals <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stat&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stat</span>(1)</span></a>,
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pathconf&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">pathconf</span>(2)</span></a> en gelijkwaardige evenementen.</p></li><li class="listitem"><p><code class="literal">fc</code> - <span class="emphasis"><em>file create</em></span>
	    - Audit evenementen waar een bestand wordt gecreëerd als
	    resultaat.</p></li><li class="listitem"><p><code class="literal">fd</code> - <span class="emphasis"><em>file delete</em></span>
	    - Audit evenementen waarbij bestanden verwijderd
	    worden.</p></li><li class="listitem"><p><code class="literal">fm</code> -
	    <span class="emphasis"><em>file attribute modify</em></span> - Audit
	    evenementen waarbij bestandsattribuut wijzigingen
	    plaatsvinden zoals bij <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chown&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">chown</span>(8)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chflags&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">chflags</span>(1)</span></a>,
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=flock&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">flock</span>(2)</span></a>, etc.</p></li><li class="listitem"><p><code class="literal">fr</code> - <span class="emphasis"><em>file read</em></span>
	    - Audit evenementen waarbij data wordt gelezen, bestanden
	    worden geopend voor lezen etc.</p></li><li class="listitem"><p><code class="literal">fw</code> - <span class="emphasis"><em>file write</em></span>
	    - Audit evenementen waarbij data wordt geschreven, bestanden
	    worden geschreven of gewijzigd, etc.</p></li><li class="listitem"><p><code class="literal">io</code> - <span class="emphasis"><em>ioctl</em></span> -
	    Audit het gebruik van de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ioctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a> systeem aanroep.</p></li><li class="listitem"><p><code class="literal">ip</code> - <span class="emphasis"><em>ipc</em></span> - Audit
	    verschillende vormen van Inter-Process Communication, zoals
	    POSIX pipes en System V <acronym class="acronym">IPC</acronym> operaties.</p></li><li class="listitem"><p><code class="literal">lo</code> - <span class="emphasis"><em>login_logout</em></span> -
	    Audit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=login&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">login</span>(1)</span></a> en <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=logout&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">logout</span>(1)</span></a> evenementen die
	    plaatsvinden op het systeem.</p></li><li class="listitem"><p><code class="literal">na</code> -
	    <span class="emphasis"><em>non attributable</em></span> - Audit
	    non-attributable evenementen.</p></li><li class="listitem"><p><code class="literal">no</code> -
	    <span class="emphasis"><em>invalid class</em></span> - Matched geen enkel
	    audit evenement.</p></li><li class="listitem"><p><code class="literal">nt</code> - <span class="emphasis"><em>network</em></span> -
	    Audit evenementen die gerelateerd zijn aan netwerk acties
	    zoals <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=connect&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">connect</span>(2)</span></a> en <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=accept&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>.</p></li><li class="listitem"><p><code class="literal">ot</code> - <span class="emphasis"><em>other</em></span> -
	    Audit diverse evenementen.</p></li><li class="listitem"><p><code class="literal">pc</code> - <span class="emphasis"><em>process</em></span> -
	    Audit process operaties zoals <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exec&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">exec</span>(3)</span></a> en
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exit&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">exit</span>(3)</span></a></p></li></ul></div><p>Deze audit evenement klassen kunnen veranderd worden door
	het wijzigingen van de <code class="filename">audit_class</code> en
	<code class="filename">audit_event</code> configuratie bestanden.</p><p>Elke audit klasse in de lijst wordt gecombineerd met een
	voorzetsel welke aangeeft of er succesvolle of mislukte
	operaties hebben plaatsgevonden en of de regel wordt toegevoegd
	of verwijderd van het matchen van de klasse en het type.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>(none) Audit zowel succesvolle als mislukte informatie
	    van het evenement.</p></li><li class="listitem"><p><code class="literal">+</code> Audit succesvolle evenementen in
	    deze klasse.</p></li><li class="listitem"><p><code class="literal">-</code> Audit mislukte evenementen in deze
	    klasse.</p></li><li class="listitem"><p><code class="literal">^</code> Audit geen enkele succesvolle of
	    mislukte evenementen in deze klasse.</p></li><li class="listitem"><p><code class="literal">^+</code> Audit geen succesvolle evenementen
	    in deze klasse.</p></li><li class="listitem"><p><code class="literal">^-</code> Audit geen mislukte evenementen
	    in deze klasse.</p></li></ul></div><p>De volgende voorbeeld selectie strings selecteren zowel
	succesvolle als mislukte login/logout evenementen, maar alleen
	succesvolle uitvoer evenementen:</p><pre class="programlisting">lo,+ex</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp79149392"></a>18.4.2. Configuratie bestanden</h3></div></div></div><p>In de meeste gevallen moet een beheerder twee bestanden
	wijzigingen wanneer het audit systeem wordt geconfigureerd:
	<code class="filename">audit_control</code> en
	<code class="filename">audit_user</code>.  Het eerste controleert systeem
	brede audit eigenschappen en policies, het tweede kan gebruikt
	worden om diepgaande auditing per gebruiker uit te voeren.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="audit-auditcontrol"></a>18.4.2.1. Het <code class="filename">audit_control</code> bestand</h4></div></div></div><p>Het <code class="filename">audit_control</code> bestand specificeert
	  een aantal standaarden van het audit subsysteem.  Als de inhoud
	  bekeken wordt van dit bestand is het volgende te zien:</p><pre class="programlisting">dir:/var/audit
flags:lo
minfree:20
naflags:lo
policy:cnt
filesz:0</pre><p>De <code class="option">dir</code> optie wordt gebruikt om
	  één of meerdere directories te specificeren die
	  gebruikt worden voor de opslag van audit logs.  Als er meer
	  dan één directory wordt gespecificeerd, worden ze
	  op volgorde gebruikt naarmate ze gevuld worden.  Het is
	  standaard dat audit geconfigureerd wordt dat audit logs
	  worden bewaard op een eigen bestandssysteem, om te
	  voorkomen dat het audit subsysteem en andere subsystemen met
	  elkaar botsen als het bestandssysteem volraakt.</p><p>Het <code class="option">flags</code> veld stelt de systeem brede
	  standaard preselection maskers voor attributable evenementen
	  in.  In het voorbeeld boven worden succesvolle en mislukte
	  login en logout evenementen geaudit voor alle gebruikers.</p><p>De <code class="option">minfree</code> optie definieerd het minimale
	  percentage aan vrije ruimte voor dit bestandssysteem waar de
	  audit trails worden opgeslagen.  Wanneer deze limiet wordt
	  overschreven wordt er een waarschuwing gegenereerd.  In het
	  bovenstaande voorbeeld wordt de minimale vrije ruimte ingesteld
	  op 20 procent.</p><p>De<code class="option">naflags</code> optie specificeerd audit klasses
	  welke geaudit moeten worden voor non-attributed evenementen
	  zoals het login proces en voor systeem daemons.</p><p>De<code class="option">policy</code> optie specificeert een komma
	  gescheiden lijst van policy vlaggen welke diverse aspecten
	  van het audit proces beheren.  De standaard
	  <code class="literal">cnt</code> vlag geeft aan dat het systeem moet
	  blijven draaien ook al treden er audit fouten op (deze vlag
	  wordt sterk aangeraden).  Een andere veel gebruikte vlag is
	  <code class="literal">argv</code>, wat het mogelijk maakt om command
	  line argumenten aan de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=execve&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">execve</span>(2)</span></a> systeem aanroep te
	  auditen als onderdeel van het uitvoeren van commando's.</p><p>De <code class="option">filesz</code> optie specificeert de maximale
	  grootte in bytes hoeveel een audit trail bestand mag groeien
	  voordat het automatisch getermineerd en geroteerd wordt.  De
	  standaard, 0, schakelt automatische log rotatie uit.  Als de
	  gevraagde bestands grootte niet nul is en onder de minimale
	  512k zit, wordt de optie genegeerd en wordt er een log bericht
	  gegenereerd.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="audit-audituser"></a>18.4.2.2. Het <code class="filename">audit_user</code> bestand</h4></div></div></div><p>Het <code class="filename">audit_user</code> bestand staat de
	  beheerder toe om verdere audit benodigdheden te
	  specificeren voor gebruikers.  Elke regel configureert
	  auditing voor een gebruiker via twee velden, het eerste is het
	  <code class="literal">alwaysaudit</code> veld, welke een set van
	  evenementen specificeert welke altijd moet worden geaudit voor
	  de gebruiker, en de tweede is het <code class="literal">neveraudit</code>
	  veld, welke een set van evenementen specificeerd die nooit
	  geaudit moeten worden voor de gebruiker.</p><p>Het volgende voorbeeld <code class="filename">audit_user</code>
	  bestand audit login/logout evenementen en succesvolle commando
	  uitvoer voor de <code class="systemitem">root</code> gebruiker, en audit
	  bestands creatie en succesvolle commando uitvoer voor de
	  <code class="systemitem">www</code> gebruiker.  Als dit gebruikt wordt
	  in combinatie met het voorbeeld
	  <code class="filename">audit_control</code> bestand hierboven, is de
	  <code class="systemitem">root</code> regel dubbelop en zullen login/logout
	  evenementen ook worden geaudit voor de
	  <code class="systemitem">www</code> gebruiker.</p><pre class="programlisting">root:lo,+ex:no
www:fc,+ex:no</pre></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="audit-install.html">Terug</a> </td><td width="20%" align="center"><a accesskey="u" href="audit.html">Omhoog</a></td><td width="40%" align="right"> <a accesskey="n" href="audit-administration.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">18.3. Installeren van audit ondersteuning. </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> 18.5. Het audit subsysteem beheren.</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>