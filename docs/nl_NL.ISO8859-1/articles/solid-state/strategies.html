<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>5. Systeemstragiën voor kleine en alleen-lezen omgevingen.</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD en Solid State Apparaten" /><link rel="up" href="index.html" title="FreeBSD en Solid State Apparaten" /><link rel="prev" href="ar01s04.html" title="4. Een bestandssysteem uit het niets opbouwen" /><link rel="copyright" href="trademarks.html" title="Juridische kennisgeving" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5. Systeemstragiën voor kleine en alleen-lezen
      omgevingen.</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s04.html">Terug</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> </td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="strategies"></a>5. Systeemstragiën voor kleine en alleen-lezen
      omgevingen.</h2></div></div></div><p>In <a class="xref" href="ro-fs.html" title="3. Het rc-deelsysteem en alleen-lezen bestandssystemen">Paragraaf 3, &#8220;Het <code class="literal">rc</code>-deelsysteem en alleen-lezen
      bestandssystemen&#8221;</a> werd erop gewezen dat het
      bestandssysteem <code class="filename">/var</code> zoals geconstrueerd
      door <code class="filename">/etc/rc.d/var</code> en de aanwezigheid van
      een hoofdbestandssysteem dat alleen gelezen kan worden problemen
      veroorzaakt met veel alledaagse softwarepakketten die door FreeBSD
      gebruikt worden.  In dit artikel zullen suggesties voor het
      succesvol draaien van cron, syslog, ports-installaties en de
      webserver Apache worden gegeven.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63781840"></a>5.1. cron</h3></div></div></div><p>Tijdens het opstarten wordt <code class="filename">/var</code> bevolkt door
	<code class="filename">/etc/rc.d/var</code> dat de lijst van
	<code class="filename">/etc/mtree/BSD.var.dist</code> gebruikt, dus
	<code class="filename">cron</code>, <code class="filename">cron/tabs</code>, <code class="filename">at</code>, en nog wat andere
	standaardmappen worden aangemaakt.</p><p>Dit lost echter nog niet het probleem van het
	behouden van cron-tabellen na het opnieuw opstarten op.  Wanneer
	het systeem opnieuw opstart, zal het bestandssysteem
	<code class="filename">/var</code> dat in het geheugen staat verdwijnen
	en zullen alle cron-tabellen die er in stonden ook verdwijnen.
	Daarom is een oplossing hiervoor het aanmaken van cron-tabellen
	voor de gebruikers die ze nodig hebben, uw bestandssysteem
	<code class="filename">/</code> als lezen-schrijven aan te koppelen en
	die cron-tabellen naar een veilige plaats zoals
	<code class="filename">/etc/tabs</code> te kopiëren en een regel aan
	het einde van <code class="filename">/etc/rc.initdiskless</code> toe te
	voegen die deze cron-tabellen naar
	<code class="filename">/var/cron/tabs</code> kopieert nadat die map is
	aangemaakt tijdens de syseeminitialisatie.  U moet misschien ook
	een regel toevoegen die de modi en toestemmingen van de mappen
	die u aanmaakt en de bestanden die u met
	<code class="filename">etc/rc.initdiskless</code> kopieert verandert.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63797328"></a>5.2. syslog</h3></div></div></div><p><code class="filename">syslog.conf</code> specificeert de plaats van
	bepaalde logbestanden die in <code class="filename">/var/log</code>
	bestaan.  Deze bestanden worden niet door
	<code class="filename">/etc/rc.d/var</code> tijdens de
	systeeminitialisatie aangemaakt.  Daarom dient u ergens na de
	sectie die de mappen in <code class="filename">/var</code> aanmaakt in
	<code class="filename">/etc/rc.d/var</code> iets als het volgende
	toevoegen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>touch /var/log/security /var/log/maillog /var/log/cron /var/log/messages</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chmod 0644 /var/log/*</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63823184"></a>5.3. Ports installeren</h3></div></div></div><p>Voordat de veranderingen die nodig zijn om succesvol de
	portsboom te gebruiken besproken worden, is een herinnering ten
	aanzien van de alleen-lezen-natuur van uw bestandssystemen op
	het flash-medium op zijn plaats.  Aangezien ze alleen-lezen zijn,
	dient u ze tijdelijk als lezen-schrijven aan te koppelen waarbij
	de koppelsyntaxis zoals getoond in <a class="xref" href="ro-fs.html" title="3. Het rc-deelsysteem en alleen-lezen bestandssystemen">Paragraaf 3, &#8220;Het <code class="literal">rc</code>-deelsysteem en alleen-lezen
      bestandssystemen&#8221;</a> wordt
	gebruikt.  U dient deze bestandssystemen altijd als alleen-lezen
	te herkoppelen als u klaar bent met enig onderhoud - onnodige
	schrijfacties naar het flash-medium kunnen de levensduur ervan
	aanzienlijk verkorten.</p><p>Om het mogelijk te maken om een portsmap binnen te gaan en
	succesvol <code class="command">make</code> <code class="buildtarget">install</code>
	uit te voeren, moeten we een pakketmap op een bestandssysteem
	aanmaken dat niet geheugengebaseerd is en dat onze pakketten
	tussen herstarts bijhoudt.  Omdat het toch nodig is om uw
	bestandssystemen als lezen-schrijven te koppelen voor het
	installeren van een pakket, is het zinnig om aan te nemen dat
	een gebied op het flash-medium ook gebruikt kan worden om
	pakketinformatie naar te schrijven.</p><p>Maak als eerste een map aan voor de pakketdatabase.  Dit is
	normaliter <code class="filename">/var/db/pkg</code>, maar we kunnen het
	daar niet plaatsen aangezien het telkens als het systeem wordt
	opgestart zal verdwijnen.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /etc/pkg</code></strong></pre><p>Voeg nu een regel aan <code class="filename">/etc/rc.d/var</code>
	toe die de map <code class="filename">/etc/pkg</code> aan
	<code class="filename">/var/db/pkg</code> koppelt.  Een voorbeeld:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ln -s /etc/pkg /var/db/pkg</code></strong></pre><p>Nu zal telkens wanneer u uw bestandssystemen als
	lezen-schrijven aankoppelt en een pakket installeert,
	<code class="command">make</code> <code class="buildtarget">install</code> werken,
	en zal de pakketinformatie succesvol naar
	<code class="filename">/etc/pkg</code> worden geschreven (omdat het
	bestandssysteem op dat moment als lezen-schrijven is aangekoppeld)
	wat altijd als <code class="filename">/var/db/pkg</code> beschikbaar is
	voor het besturingssysteem.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp63844176"></a>5.4. Apache Web Server</h3></div></div></div><div xmlns="" class="note"><h3 class="admontitle">Opmerking: </h3><p xmlns="http://www.w3.org/1999/xhtml">De stappen in deze sectie zijn alleen nodig indien Apache
	  is ingesteld om de pid- of loginformatie buiten <code class="filename">/var</code> te schrijven.  Standaard
	  houdt Apache het pid-bestand in <code class="filename">/var/run/httpd.pid</code> en de
	  logbestanden in <code class="filename">/var/log</code>.</p></div><p>Er wordt nu aangenomen dat Apache de logbestanden in een map
	<code class="filename">apache_log_map</code>
	buiten <code class="filename">/var</code> bewaart.
	Wanneer deze map op een alleen-lezen bestandssysteem staat, zal
	Apache geen logbestanden kunnen opslaan, en kan het werkproblemen
	hebben.  Indien dit zo is, is het noodzakelijk om een nieuwe map
	aan de lijst met mappen in <code class="filename">/etc/rc.d/var</code> die
	in <code class="filename">/var</code> worden aangemaakt toe te voegen, en om
	<code class="filename">apache_log_map</code>
	aan <code class="filename">/var/log/apache</code> te koppelen.  Het is
	ook nodig om de toestemmingen en eigenaarschappen van deze
	nieuwe map in te stellen.</p><p>Voeg eerst de map <code class="literal">log/apache</code> toe aan de
	lijst van mappen die in <code class="filename">/etc/rc.d/var</code>
	aangemaakt moeten worden.</p><p>Voeg ten tweede deze commando's toe aan
	<code class="filename">/etc/rc.d/var</code> na de sectie die mappen
	aanmaakt:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chmod 0774 /var/log/apache</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chown nobody:nobody /var/log/apache</code></strong></pre><p>Verwijder als laatste de bestaande map
	<code class="filename">apache_log_map</code>
	en vervang het door een koppeling:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>rm -rf apache_log_map</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ln -s /var/log/apache apache_log_map</code></strong></pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s04.html">Terug</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> </td></tr><tr><td width="40%" align="left" valign="top">4. Een bestandssysteem uit het niets opbouwen </td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="http://ftp.FreeBSD.org/pub/FreeBSD/doc/">http://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>