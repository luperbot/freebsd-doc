<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>A.6. Usare Portsnap</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuale di FreeBSD" /><link rel="up" href="mirrors.html" title="Appendice A. Ottenere FreeBSD" /><link rel="prev" href="cvsup.html" title="A.5. Uso di CVSup" /><link rel="next" href="cvs-tags.html" title="A.7. Tag CVS" /><link rel="copyright" href="legalnotice.html" title="Nota Legale" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">A.6. Usare Portsnap</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="cvsup.html">Indietro</a> </td><th width="60%" align="center">Appendice A. Ottenere FreeBSD</th><td width="20%" align="right"> <a accesskey="n" href="cvs-tags.html">Avanti</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="portsnap"></a>A.6. Usare Portsnap</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="portsnap-intro"></a>A.6.1. Introduzione</h3></div></div></div><p><span class="application">Portsnap</span> è un
        sistema per distribuire in modo sicuro l'albero dei port
        di FreeBSD.  Circa ogni ora, viene generata una
        <span class="quote">«<span class="quote">snapshot</span>»</span> dell'albero dei port, che viene
        impacchettata e firmata criptograficamente.
        I file risultanti sono quindi distribuiti via HTTP.</p><p>Come <span class="application">CVSup</span>,
        <span class="application">Portsnap</span> usa un modello
        di aggiornamento a <span class="emphasis"><em>rchiesta</em></span>: gli alberi
        dei port impacchettati e firmati sono messi sul server web che
        attende in modo passivo le richieste dei client.  Gli utenti
        devono eseguire <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=portsnap&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">portsnap</span>(8)</span></a>
        manualmente o schedulare il job con <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a>
        per scaricare periodicamente gli aggiornamenti in modo
        automatico.</p><p>Per ragioni tecniche, <span class="application">Portsnap</span>
        non aggiorna direttamente il <span class="quote">«<span class="quote">reale</span>»</span> albero
        dei port in <code class="filename">/usr/ports/</code>; invece, lavora
        con una copia compressa dell'albero dei port memorizzata
        di default in <code class="filename">/var/db/portsnap/</code>.  Questa
        copia compressa viene quindi usata per aggiornare
        l'albero dei port effettivo.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Se <span class="application">Portsnap</span> è
          installato dalla collezione dei port di FreeBSD, la locazione
          di default per la sua snapshot compressa è
          <code class="filename">/usr/local/portsnap/</code>
          invece di <code class="filename">/var/db/portsnap/</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="portsnap-install"></a>A.6.2. Instalazione</h3></div></div></div><p>Su FreeBSD 6.0 e versioni più recenti,
        <span class="application">Portsnap</span> è contenuto nel
        sistema base.  Su versioni di FreeBSD più datate, può
        essere installato usando il port
        <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/sysutils/portsnap/pkg-descr">sysutils/portsnap</a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="portsnap-config"></a>A.6.3. Configurazione di Portsnap</h3></div></div></div><p>Il funzionamento di <span class="application">Portsnap</span>
        è controllato dal file di configurazione
        <code class="filename">/etc/portsnap.conf</code>.  Per la
        maggior parte degli utenti, la configurazione di default
        sarà sufficiente; per maggiori dettagli, consultare
        la pagina man <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=portsnap.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">portsnap.conf</span>(5)</span></a>.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Se <span class="application">Portsnap</span> è
          installato dalla collezione dei port di FreeBSD,
          userà il file di configurazione posto in
          <code class="filename">/usr/local/etc/portsnap.conf</code> invece
          di <code class="filename">/etc/portsnap.conf</code>.
          Questo file di configurazione non viene creato quando
          viene installato il port, ma viene dato un file
          di configurazione di base; per copiarlo nella giusta
          posizione, esegui il comando seguente:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/local/etc &amp;&amp; cp portsnap.conf.sample portsnap.conf</code></strong></pre></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90374864"></a>A.6.4. Eseguire <span class="application">Portsnap</span> per
        la Prima Volta</h3></div></div></div><p>La prima volta che <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=portsnap&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">portsnap</span>(8)</span></a>
        viene eseguito,
        ha bisogno di scaricare una snapshot compressa
        dell'intero albero dei port in
        <code class="filename">/var/db/portsnap/</code> (o
        <code class="filename">/usr/local/portsnap/</code> se
        <span class="application">Portsnap</span> è stato
        installato dalla collezione dei port).
        Dall'inizio del 2006 la sua dimensione
        è di circa 41 MB.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portsnap fetch</code></strong></pre><p>Una volta che la snapshot compressa è stata
        scaricata, una copia dell'albero dei port può
        estratta in <code class="filename">/usr/ports/</code>.
        Questo è necessario perfino se l'albero dei port
        è già stato creato in quella directory
        (es., usando <span class="application">CVSup</span>), poichè
        stabilisce un punto di inizio dal qualche
        <code class="command">portsnap</code> può
        determinare quale parte dell'albero dei port necessita
        di essere aggiornata.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portsnap extract</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Nell'installazione di default la directory
          <code class="filename">/usr/ports</code>
          non viene creata.  Se usi FreeBSD 6.0-RELEASE,
          la directory dovrebbe essere creata prima di
          usare <code class="command">portsnap</code>.  Su versioni
          di FreeBSD e <span class="application">Portsnap</span> più recenti
          questa operazione viene fatta in automatico al primo
          utilizzo del comando <code class="command">portsnap</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90396496"></a>A.6.5. Aggiornare l'Albero dei Port</h3></div></div></div><p>Dopo che una prima snapshot compressa
        dell'albero dei port è stata scaricata
        ed estratta in <code class="filename">/usr/ports/</code>,
        l'aggiornamento dell'albero dei port consiste
        in due passi: <span class="emphasis"><em>scaricando</em></span> gli
        aggiornamenti della snapshot compressa, e usare questi
        per <span class="emphasis"><em>aggiornare</em></span> l'albero
        dei port effettivo.  Questi due passi possono
        essere specificati a
        <code class="command">portsnap</code> con un
        comando singolo.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portsnap fetch update</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Alcune versioni vecchie di <code class="command">portsnap</code>
          non supportano questa sintassi; se fallisce, prova
          in questo modo:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>portsnap fetch</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>portsnap update</code></strong></pre></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90402896"></a>A.6.6. Avviare Portsnap tramite cron</h3></div></div></div><p>Al fine di evitare problemi di
        <span class="quote">«<span class="quote">affollamenti istantanei</span>»</span>
        accedendo ai server di <span class="application">Portsnap</span>,
        <code class="command">portsnap fetch</code> non funziona
        da un job <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a>.  Esiste invece
        un comando apposito <code class="command">portsnap cron</code>,
        che attende una durata random fino a 3600 secondi prima
        di scaricare gli aggiornamenti.</p><p>Inoltre, è fortemente racomandato che
        <code class="command">portsnap update</code> non sia eseguito
        da un job <code class="command">cron</code>, poichè
        è soggetto a causare problemi se viene avviato
        allo stesso tempo di compilazione o installazione di
        un port.  Ad ogni modo, è possibile aggiornare
        i file <code class="filename">INDEX</code> dei port, e può
        essere fatto passando il flag <code class="option">-I</code> a
        <code class="command">portsnap</code>.  (Ovviamente, se
        <code class="command">portsnap -I update</code> viene eseguito da
        <code class="command">cron</code>, sarà necessario eseguire
        successivamnte <code class="command">portsnap update</code> senza
        la flag <code class="option">-I</code> al fine di aggiornare
        il resto dell'albero.)</p><p>Aggiungendo la riga seguente in <code class="filename">/etc/crontab</code>,
        <code class="command">portsnap</code> aggiornerà
        la snapshot compressa e i file <code class="filename">INDEX</code> in
        <code class="filename">/usr/ports/</code>, e manderà una email
        se qualche port installato non è
        aggiornato:</p><pre class="programlisting">0 3 * * * root portsnap -I cron update &amp;&amp; pkg_version -vIL=</pre><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Se l'ora di sistema non è settata all'ora locale,
          sostituisci <code class="literal">3</code> con un valore random
          tra 0 e 23, al fine di disporre il carico sui server
          <span class="application">Portsnap</span> in modo uniforme.</p></div><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Alcune versioni datate di <code class="command">portsnap</code>
          non supportano l'elenco di comandi multipli
          (es., <code class="literal">cron update</code>)
          nella stessa invocazione di <code class="command">portsnap</code>.
          Se la riga di comando
          precedente fallisce, prova a sostituire
          <code class="command">portsnap -I cron update</code> con
          <code class="command">portsnap cron &amp;&amp; portsnap -I update</code>.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="cvsup.html">Indietro</a> </td><td width="20%" align="center"><a accesskey="u" href="mirrors.html">Risali</a></td><td width="40%" align="right"> <a accesskey="n" href="cvs-tags.html">Avanti</a></td></tr><tr><td width="40%" align="left" valign="top">A.5. Uso di CVSup </td><td width="20%" align="center"><a accesskey="h" href="index.html">Partenza</a></td><td width="40%" align="right" valign="top"> A.7. Tag CVS</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Questo, ed altri documenti, possono essere scaricati da
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Per domande su FreeBSD, leggi la
    <a href="http://www.FreeBSD.org/docs.html">documentazione</a> prima di contattare
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Per domande su questa documentazione, invia una e-mail a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>