<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>27.2. Il «Super-Server» inetd</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuale di FreeBSD" /><link rel="up" href="network-servers.html" title="Capitolo 27. Server di rete" /><link rel="prev" href="network-servers.html" title="Capitolo 27. Server di rete" /><link rel="next" href="network-nfs.html" title="27.3. Network File System (NFS)" /><link rel="copyright" href="legalnotice.html" title="Nota Legale" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">27.2. Il
      <span class="quote">«<span class="quote">Super-Server</span>»</span> <span class="application">inetd</span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-servers.html">Indietro</a> </td><th width="60%" align="center">Capitolo 27. Server di rete</th><td width="20%" align="right"> <a accesskey="n" href="network-nfs.html">Avanti</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-inetd"></a>27.2. Il
      <span class="quote">«<span class="quote">Super-Server</span>»</span> <span class="application">inetd</span></h2></div><div><span class="authorgroup">Grazie al contributo di <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Chern</span> <span class="surname">Lee</span></span>. </span></div><div><span class="authorgroup">Aggiornato per FreeBSD 6.1-RELEASE da <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="othername">The FreeBSD Documentation Project</span></span>. </span></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-overview"></a>27.2.1. Uno sguardo d'insieme</h3></div></div></div><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> viene talvolta definito l'<span class="quote">«<span class="quote">Internet
        Super-Server</span>»</span> perchè gestisce le connessioni verso
        molti servizi.  Quando una connessione
        viene ricevuta da <span class="application">inetd</span>, questo
        determina per quale programma la connessione sia
        destinata, esegue quel particolare processo e affida a
        lui la socket (il programma è invocato con la socket
        del servizio come descrittore di standard input, output
        ed error).  Eseguire <span class="application">inetd</span>
        per server dal carico non troppo alto può ridurre il carico
        complessivo di sistema, rispetto all'esecuzione individuale
        di ogni demone in modalità stand-alone.</p><p>Principalmente, <span class="application">inetd</span> è
        usato per lanciare altri demoni, ma molti protocolli
        triviali sono gestiti direttamente, come ad esempio
        i protocolli <span class="application">chargen</span>,
        <span class="application">auth</span>, e
        <span class="application">daytime</span>.</p><p>Questa sezione coprirà le basi della configurazione
        di <span class="application">inetd</span> attraverso le
        opzioni da linea di comando
        ed il suo file di configurazione,
        <code class="filename">/etc/inetd.conf</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-settings"></a>27.2.2. Impostazioni</h3></div></div></div><p><span class="application">inetd</span> viene inizializzato
        attraverso il sistema <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a>.
        L'opzione <code class="literal">inetd_enable</code> è
        impostata a <code class="literal">NO</code> di default, ma può essere
        attivata da <span class="application">sysinstall</span>
        durante l'installazione, a seconda della configurazione
        scelta dall'utente.  Inserendo:</p><pre class="programlisting">inetd_enable="YES"</pre><p>o</p><pre class="programlisting">inetd_enable="NO"</pre><p>in
        <code class="filename">/etc/rc.conf</code> si abiliterà o meno
        la partenza di
        <span class="application">inetd</span> al boot.
        Il comando:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/inetd rcvar</code></strong></pre><p>può essere utilizzato per mostrare le impostazioni
        attive al momento.</p><p>Inoltre, diverse opzioni di linea di comando possono
        essere passate a <span class="application">inetd</span> attraverso
        l'opzione <code class="literal">inetd_flags</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-cmdline"></a>27.2.3. Opzioni su linea di comando</h3></div></div></div><p>Come molti server di rete, <span class="application">inetd</span>
        ha un numero di opzioni che possono essergli passate
        per modificare il suo comportamento.  La lista di tutte le opzioni è:</p><p><span class="application">inetd</span> synopsis:</p><p><code class="option">inetd [-d] [-l] [-w] [-W] [-c maximum] [-C rate]
        [-a address | hostname] [-p filename] [-R rate] [configuration
          file]</code></p><p>Si possono passare opzioni ad <span class="application">inetd</span> usando
        l'opzione <code class="literal">inetd_flags</code> in
        <code class="filename">/etc/rc.conf</code>.  Di default,
        <code class="literal">inetd_flags</code> è impostato a
        <code class="literal">-wW -C 60</code>, il che attiva il TCP wrapping per i servizi di
        <span class="application">inetd</span>, ed impedisce ad ogni singolo
        indirizzo IP di richiedere qualsiasi servizio piùdi 60 volte
        al minuto.</p><p>Gli utenti novizi possono notare con piacere che
        questi parametri di solito non devono essere modificati,
        anche se bisogna menzionare il fatto che le opzioni di
        limitazione delle connessioni sono utili solo se ci si accorge
        di ricevere un numero eccessivo di connessioni.  L'intera lista
        delle opzioni di <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a> può essere trovata
        nel manuale di <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">-c maximum</span></dt><dd><p>Specifica il numero massimo di invocazioni simultanee
              per ogni servizio; il default è illimitato.
              Può essere sovrascritto per ogni servizio dal
              parametro <code class="option">max-child</code>.</p></dd><dt><span class="term">-C rate</span></dt><dd><p>Specifica un numero massimo di volte in cui
              un servizio può essere invocato da un singolo
              indirizzo IP in un
              minuto; il default è illimitato.  Può essere
              sovrascritto per ogni servizio con il parametro
              <code class="option">max-connections-per-ip-per-minute</code>.</p></dd><dt><span class="term">-R rate</span></dt><dd><p>Specifica il numero massimo di volte che un servizio
              può essere invocato in un minuto; il default è
              256.  L'impostazione 0 permette un numero illimitato di
              invocazioni.</p></dd><dt><span class="term">-s maximum</span></dt><dd><p>Specifica il numero massimo di volte
              che un servizio può essere invocato per ogni periodo di
              tempo; il default è illimitato.  Può essere sovrascritto
              per ogni singolo servizio con il parametro <code class="option">max-child-per-ip</code>.
            </p></dd></dl></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-conf"></a>27.2.4. <code class="filename">inetd.conf</code></h3></div></div></div><p> La configurazione di <span class="application">inetd</span>
        è fatta  attraverso il file
        <code class="filename">/etc/inetd.conf</code>.</p><p>Quando viene apportata una modifica a
        <code class="filename">/etc/inetd.conf</code>,
        si può forzare <span class="application">inetd</span>
        a rileggere il suo file di configurazione
        eseguendo il comando:</p><div class="example"><a id="network-inetd-reread"></a><div class="example-title">Esempio 27.1. Ricaricare il file di configurazione
          di <span class="application">inetd</span>
        </div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/inetd reload </code></strong></pre></div></div><br class="example-break" /><p>Ogni linea del file di configurazione specifica un
        singolo demone.  I commenti nel file sono preceduti da un
        <span class="quote">«<span class="quote">#</span>»</span>.  Il formato di ogni riga del file
        <code class="filename">/etc/inetd.conf</code> è il seguente:</p><pre class="programlisting">nome del servizio
tipo della socket
protocollo
{wait|nowait}[/max-child[/max-connections-per-ip-per-minute]]
utente[:gruppo][/classe-di-login]
programma-server
argomenti-del-programma-server</pre><p>Un esempio di linea per il
        demone <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ftpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ftpd</span>(8)</span></a>
        usando l'IPv4:</p><pre class="programlisting">ftp     stream  tcp     nowait  root /usr/libexec/ftpd       ftpd -l</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term">nome-del-servizio</span></dt><dd><p>È il nome del servizio per il demone.
              Deve corrispondere ad un servizio elencato in
              <code class="filename">/etc/services</code>.  Questo
              determina su quale porta
              <span class="application">inetd</span> deve restare
              in ascolto.  Se viene creato un nuovo servizio,
              deve essere messo prima
              in <code class="filename">/etc/services</code>.</p></dd><dt><span class="term">tipo-di-socket</span></dt><dd><p>Una a scelta fra <code class="literal">stream</code>,
              <code class="literal">dgram</code>, <code class="literal">raw</code>, o
              <code class="literal">seqpacket</code>.
              <code class="literal">stream</code>
              deve essere usata per demoni basati sulla
              connessione, tipo TCP, mentre
              <code class="literal">dgram</code> è usato per demoni che usano
              il protocollo di trasporto <acronym class="acronym">UDP</acronym>.</p></dd><dt><span class="term">protocollo</span></dt><dd><p>Uno dei seguenti:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Protocollo</th><th>Spiegazione</th></tr></thead><tbody><tr><td>tcp, tcp4</td><td>TCP IPv4</td></tr><tr><td>udp, udp4</td><td>UDP IPv4</td></tr><tr><td>tcp6</td><td>TCP IPv6</td></tr><tr><td>udp6</td><td>UDP IPv6</td></tr><tr><td>tcp46</td><td>Entrambi TCP IPv4 e v6</td></tr><tr><td>udp46</td><td>Entrambi UDP IPv4 e v6</td></tr></tbody></table></div></dd><dt><span class="term">{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]</span></dt><dd><p><code class="option">wait|nowait</code> indica se il demone
              invocato da <span class="application">inetd</span> è
              in grado di gestire la sua socket o meno.
              Il tipo di socket <code class="option">dgram</code> deve usare
              l'opzione <code class="option">wait</code>, mentre i demoni
              con socket stream,
              che sono in genere multi-thread, devono usare
              <code class="option">nowait</code>.  <code class="option">wait</code> in
              genere fornisce socket multiple ad un singolo demone,
              mentre <code class="option">nowait</code> lancia un demone figlio
              per ogni nuova socket.</p><p>Il massimo numero di demoni figli che
              <span class="application">inetd</span> può lanciare si imposta
              attraverso l'opzione <code class="option">max-child</code>.
              Se è richiesto un limite di dieci istanze per un
              particolare demone, un
              <code class="literal">/10</code> dovrebbe essere inserito
              dopo l'opzione <code class="option">nowait</code>.  Specificando
              <code class="literal">/0</code> si lascia un numero illimitato di figli.</p><p>Oltre all'opzione <code class="option">max-child</code>,
              possono essere attivate due altre opzioni che limitano
              il massimo numero di connessioni da un singolo ip
              verso un particolare demone.
              <code class="option">max-connections-per-ip-per-minute</code> limita
              il numero di connessioni da un particolare indirizzo IP per
              minuto, ad esempio un valore di dieci limiterebbe ogni
              singolo indirizzo IP a connettersi verso un certo servizio
              a dieci connessioni al minuto.
              <code class="option">max-child-per-ip</code>
              limita il numero di figli che possono essere avviati su richiesta
              di un singolo indirizzo IP in ogni momento.
              Queste opzioni sono utili per prevenire
              eccessivo consumo delle risorse intenzionale o non intenzionale
              e attacchi Denial of Service (DoS) ad una macchina.</p><p>In questo campo, <code class="option">wait</code> o
              <code class="option">nowait</code> sono obbligatorie.
              <code class="option">max-child</code> e
              <code class="option">max-connections-per-ip-per-minute</code>
              e <code class="option">max-child-per-ip</code> sono
              opzionali.</p><p>Un demone tipo-stream multi-thread senza
              i limiti <code class="option">max-child</code> o
              <code class="option">max-connections-per-ip-per-minute</code>
              dovrebbe essere semplicemente:
              <code class="literal">nowait</code>.</p><p>Lo stesso demone con un limite massimo di
              dieci demoni dovrebbe avere:
              <code class="literal">nowait/10</code>.</p><p>In aggiunta, la stessa impostazione con
              un limite di venti connessioni per IP al
              minuto ed un limite massimo di
              dieci demoni figli avrebbe:
              <code class="literal">nowait/10/20</code>.</p><p>Queste opzioni sono tutte utilizzate
              di default nelle impostazioni del demone
              <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fingerd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fingerd</span>(8)</span></a> come si vede di seguito:</p><pre class="programlisting">finger stream  tcp     nowait/3/10 nobody /usr/libexec/fingerd fingerd -s</pre><p>Alla fine, un esempio di questo campo
              con 100 figli in tutto, con un massimo di 5 per singolo
              indirizzo IP sarebbe:
              <code class="literal">nowait/100/0/5</code>.</p></dd><dt><span class="term">user</span></dt><dd><p>Questo è lo username sotto il quale un
              particolare demone dovrebbe girare.  Di
              frequente, i demoni girano
              come utente <code class="systemitem">root</code>.
              Per motivi di sicurezza, è normale
              trovare alcuni server che girano con l'utente
              <code class="systemitem">daemon</code>, o il meno privilegiato
              utente <code class="systemitem">nobody</code>.</p></dd><dt><span class="term">server-program</span></dt><dd><p>Il percorso assoluto del demone che deve essere
              eseguito quando è ricevuta una connessione .  Se
              il demone è un servizio
              offerto da <span class="application">inetd</span> internamente,
              bisogna usare <code class="option">internal</code>.</p></dd><dt><span class="term">server-program-arguments</span></dt><dd><p>Questa opzione funziona in congiunzione con
              <code class="option">server-program</code> specificando gli
              argomenti, cominciando con <code class="literal">argv[0]</code>,
              passati al demone al momento dell'invocazione.
              Se <code class="command">mydaemon -d</code> è la linea di comando,
              <code class="literal">mydaemon -d</code> sarà il valore
              dell'opzione <code class="option">server-program-arguments</code>.
              Ancora, se un demone è un servizio interno,
              usa <code class="option">internal</code>.</p></dd></dl></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-security"></a>27.2.5. Sicurezza</h3></div></div></div><p>A seconda delle scelte fatte all'installazione,
        molti servizi di <span class="application">inetd</span>
        potrebbero essere attivi di default.  Se
        non c'è necessità
        apparente per un particolare demone,
        considera di disabilitarlo.  Usa un <span class="quote">«<span class="quote">#</span>»</span> a capo della
        riga del demone in questione in <code class="filename">/etc/inetd.conf</code>,
        e quindi <a class="link" href="network-inetd.html#network-inetd-reread" title="Esempio 27.1. Ricaricare il file di configurazione di inetd">ricarica la
        configurazione di inetd</a>.  Alcuni demoni, come
        <span class="application">fingerd</span>, potrebbero
        non essere assolutamente desiderati,
        poichè forniscono all'attaccante informazioni che gli potrebbero
        risultare utili.</p><p>Alcuni demoni non sono stati creati coll'obiettivo
        della sicurezza ed hanno timeout lunghi, o non esistenti.
        Questo permette ad un attaccante di inviare
        lentamente connessioni
        ad un particolare demone, saturando in questo modo
        le risorse disponibile.  Può essere una buona idea
        impostare le limitazioni
        <code class="option">max-connections-per-ip-per-minute</code> e
        <code class="option">max-child</code> o <code class="option">max-child-per-ip</code> su certi
        demoni se scopri di avere troppe connessioni.</p><p>Di default, il TCP wrapping è attivo.
        Consulta la pagina del manuale
        di <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hosts_access&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">hosts_access</span>(5)</span></a> per impostare
        delle restrizioni TCP su certi demoni
        invocati da <span class="application">inetd</span>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="network-inetd-misc"></a>27.2.6. Miscellanei</h3></div></div></div><p><span class="application">daytime</span>,
        <span class="application">time</span>,
        <span class="application">echo</span>,
        <span class="application">discard</span>,
        <span class="application">chargen</span>, e
        <span class="application">auth</span> sono tutti servizi interni
        di <span class="application">inetd</span>.</p><p>Il servizio <span class="application">auth</span>
        fornisce servizi di rete di identificazione
        ed è configurabile fino ad un certo punto,
        mentre gli altri possono solo essere accesi o spenti.</p><p>Consulta la paigna di manuale di <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=inetd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">inetd</span>(8)</span></a>
         per dettagli più approfonditi.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-servers.html">Indietro</a> </td><td width="20%" align="center"><a accesskey="u" href="network-servers.html">Risali</a></td><td width="40%" align="right"> <a accesskey="n" href="network-nfs.html">Avanti</a></td></tr><tr><td width="40%" align="left" valign="top">Capitolo 27. Server di rete </td><td width="20%" align="center"><a accesskey="h" href="index.html">Partenza</a></td><td width="40%" align="right" valign="top"> 27.3. Network File System (NFS)</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Questo, ed altri documenti, possono essere scaricati da
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Per domande su FreeBSD, leggi la
    <a href="http://www.FreeBSD.org/docs.html">documentazione</a> prima di contattare
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Per domande su questa documentazione, invia una e-mail a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>