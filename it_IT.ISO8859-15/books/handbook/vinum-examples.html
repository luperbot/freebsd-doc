<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>20.6. Alcuni Esempi</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuale di FreeBSD" /><link rel="up" href="vinum-vinum.html" title="Capitolo 20. Il Gestore di Volumi Vinum" /><link rel="prev" href="vinum-objects.html" title="20.5. Oggetti Vinum" /><link rel="next" href="vinum-object-naming.html" title="20.7. Nomenclatura degli Oggetti" /><link rel="copyright" href="legalnotice.html" title="Nota Legale" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">20.6. Alcuni Esempi</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="vinum-objects.html">Indietro</a> </td><th width="60%" align="center">Capitolo 20. Il Gestore di Volumi Vinum</th><td width="20%" align="right"> <a accesskey="n" href="vinum-object-naming.html">Avanti</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="vinum-examples"></a>20.6. Alcuni Esempi</h2></div></div></div><p>Vinum mantiene un <span class="emphasis"><em>database della configurazione</em></span>
      che descrive gli oggetti del sistema conosciuti.  Inizialmente l'utente
      crea il database della configurazione da uno o più file di
      configurazione, con l'aiuto del programma <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vinum&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">vinum</span>(8)</span></a>.  Vinum
      immagazzina una copia del database di configurazione in ogni slice del
      disco (che Vinum chiama <span class="emphasis"><em>device</em></span>, ovvero
      <span class="quote">«<span class="quote">dispositivo</span>»</span>) sotto il suo controllo.
      Questo database è aggiornato a ogni cambio
      di stato in modo che un riavvio possa recuperare accuratamente lo stato di
      ogni oggetto Vinum.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85100240"></a>20.6.1. Il File di Configurazione</h3></div></div></div><p>Il file di configurazione descrive singoli oggetti Vinum.  La
        definizione di un semplice volume potrebbe essere:</p><pre class="programlisting">    drive a device /dev/da3h
    volume myvol
      plex org concat
        sd length 512m drive a</pre><p>Questo file descrive quattro oggetti Vinum:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>La linea <span class="emphasis"><em>drive</em></span> descrive la partizione del
            disco (<span class="emphasis"><em>drive</em></span>) e la sua locazione relativa
            all'hardware sottostante.  Gli viene assegnato il nome simbolico
            <span class="emphasis"><em>a</em></span>.  Questa separazione dei nomi simbolici dai
            nomi di dispositivo permette di muovere i dischi da una locazione ad
            un'altra senza confusione.</p></li><li class="listitem"><p>La linea <span class="emphasis"><em>volume</em></span> descrive un volume.
           L'unico attributo richiesto è il nome, in questo caso
           <span class="emphasis"><em>myvol</em></span>.</p></li><li class="listitem"><p>La linea <span class="emphasis"><em>plex</em></span> definisce un plex.
            L'unico parametro richiesto è il tipo di organizzazione, in
            questo caso <span class="emphasis"><em>concat</em></span>.  Non è necessario
            un nome: il sistema genera un nome automaticamente a partire dal
            nome del volume, aggiungendo un suffisso
            <span class="emphasis"><em>.p</em></span><span class="emphasis"><em>x</em></span>, dove
            <span class="emphasis"><em>x</em></span> indica il numero del plex nel volume.  Il
            plex verrà quindi chiamato
            <span class="emphasis"><em>myvol.p0</em></span>.</p></li><li class="listitem"><p>La linea <span class="emphasis"><em>sd</em></span> descrive un sottodisco.
            Le specifiche minime sono il nome del drive su cui immagazzinarlo e
            la lunghezza del sottodisco.  Come per i plex non è
            necessario un nome: il sistema assegna automaticamente nomi
            derivati dal nome del plex, aggiungendo il suffisso
            <span class="emphasis"><em>.s</em></span><span class="emphasis"><em>x</em></span>, dove
            <span class="emphasis"><em>x</em></span> indica il numero del sottodisco nel plex,
            quindi Vinum darà a questo sottodisco il nome di
            <span class="emphasis"><em>myvol.p0.s0</em></span>.</p></li></ul></div><p>Dopo aver elaborato questo file, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vinum&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">vinum</span>(8)</span></a> produce il seguente
        output:</p><pre class="programlisting" width="97">      <code class="prompt">#</code> vinum -&gt; <strong class="userinput"><code>create config1</code></strong>
      Configuration summary
      Drives:         1 (4 configured)
      Volumes:        1 (4 configured)
      Plexes:         1 (8 configured)
      Subdisks:       1 (16 configured)

    D a                     State: up       Device /dev/da3h        Avail: 2061/2573 MB (80%)

    V myvol                 State: up       Plexes:       1 Size:        512 MB

    P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB

    S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB</pre><p>Questo output mostra il formato di elenco breve di <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=vinum&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">vinum</span>(8)</span></a>,
        che è rappresentato graficamente nella
        <a class="xref" href="vinum-examples.html#vinum-simple-vol" title="Figura 20.4. Un Semplice Volume Vinum">Figura 20.4, «Un Semplice Volume Vinum»</a>.</p><p>
        </p><div class="figure"><a id="vinum-simple-vol"></a><div class="figure-title">Figura 20.4. Un Semplice Volume Vinum</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-simple-vol.png" alt="Un Semplice Volume Vinum" /></div></div></div><p><br class="figure-break" />
      </p><p>Questa figura e quelle che seguono rappresentano un volume
        contenente dei plex che a loro volta contengono dei sottodischi.
        In questo semplice esempio il volume contiene un plex e il plex
        contiene un sottodisco.</p><p>Questo particolare volume non ha specifici vantaggi su una
        convenzionale partizione di disco.  Contiene un singolo plex, quindi non
        è ridondante.  Il plex contiene un solo sottodisco, quindi non
        c'è differenza nell'immagazzinamento dei dati.  Le sezioni
        seguenti mostrano vari metodi di configurazione più
        interessanti.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85122896"></a>20.6.2. Aumentare la Resistenza alle Rotture: il Mirroring</h3></div></div></div><p>Il mirroring può aumentare, in un volume, la resistenza alle
        rotture.  Quando si definisce un volume in mirroring è importante
        assicurarsi che i sottodischi di ogni plex siano su dischi differenti,
        in modo che la rottura di un drive non blocchi entrambi i plex.  La
        seguente configurazione mostra un volume in mirroring:</p><pre class="programlisting">    drive b device /dev/da4h
    volume mirror
      plex org concat
        sd length 512m drive a
          plex org concat
            sd length 512m drive b</pre><p>In questo esempio non è necessario specificare nuovamente la
        definizione del drive <span class="emphasis"><em>a</em></span>, dato che Vinum mantiene
        traccia di tutti gli oggetti nel suo database di configurazione.  Dopo
        aver elaborato questa definizione, la configurazione appare
        così:</p><pre class="programlisting" width="97">    Drives:         2 (4 configured)
    Volumes:        2 (4 configured)
    Plexes:         3 (8 configured)
    Subdisks:       3 (16 configured)

    D a                     State: up       Device /dev/da3h        Avail: 1549/2573 MB (60%)
    D b                     State: up       Device /dev/da4h        Avail: 2061/2573 MB (80%)

    V myvol                 State: up       Plexes:       1 Size:        512 MB
    V mirror                State: up       Plexes:       2 Size:        512 MB

    P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p0           C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p1           C State: initializing     Subdisks:     1 Size:        512 MB

    S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB
    S mirror.p0.s0          State: up       PO:        0  B Size:        512 MB
    S mirror.p1.s0          State: empty    PO:        0  B Size:        512 MB</pre><p><a class="xref" href="vinum-examples.html#vinum-mirrored-vol" title="Figura 20.5. Un Volume Vinum in Mirroring">Figura 20.5, «Un Volume Vinum in Mirroring»</a> mostra la struttura
        graficamente.</p><p>
        </p><div class="figure"><a id="vinum-mirrored-vol"></a><div class="figure-title">Figura 20.5. Un Volume Vinum in Mirroring</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-mirrored-vol.png" alt="Un Volume Vinum in Mirroring" /></div></div></div><p><br class="figure-break" />
      </p><p>In questo esempio ogni plex contiene l'intero spazio di
        indirizzamento di 512 MB.  Come nel precedente esempio ogni plex
        contiene un solo sottodisco.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85128784"></a>20.6.3. Ottimizzazione delle Prestazioni</h3></div></div></div><p>Il volume in mirroring dell'esempio precedente è più
        resistente alle rotture di un volume non in mirroring, ma le sue
        prestazioni sono inferiori: ogni scrittura sul volume richiede una
        scrittura su ognuno dei drive, utilizzando quindi una maggior frazione
        della banda passante totale dei dischi.  Considerazioni sulle
        prestazioni portano ad un differente approccio: al posto del mirroring,
        i dati vengono posti sul maggior numero di dischi possibile utilizzando lo
        striping.  La seguente configurazione mostra un volume con un plex in
        striping su quattro dischi:</p><pre class="programlisting">        drive c device /dev/da5h
        drive d device /dev/da6h
        volume stripe
        plex org striped 512k
          sd length 128m drive a
          sd length 128m drive b
          sd length 128m drive c
          sd length 128m drive d</pre><p>Come prima non è necessario definire i drive che Vinum
        già conosce.  Dopo aver elaborato queste definizioni la
        configurazione appare così:</p><pre class="programlisting" width="92">    Drives:         4 (4 configured)
    Volumes:        3 (4 configured)
    Plexes:         4 (8 configured)
    Subdisks:       7 (16 configured)

    D a                     State: up       Device /dev/da3h        Avail: 1421/2573 MB (55%)
    D b                     State: up       Device /dev/da4h        Avail: 1933/2573 MB (75%)
    D c                     State: up       Device /dev/da5h        Avail: 2445/2573 MB (95%)
    D d                     State: up       Device /dev/da6h        Avail: 2445/2573 MB (95%)

    V myvol                 State: up       Plexes:       1 Size:        512 MB
    V mirror                State: up       Plexes:       2 Size:        512 MB
    V striped               State: up       Plexes:       1 Size:        512 MB

    P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p0           C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p1           C State: initializing     Subdisks:     1 Size:        512 MB
    P striped.p1            State: up       Subdisks:     1 Size:        512 MB

    S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB
    S mirror.p0.s0          State: up       PO:        0  B Size:        512 MB
    S mirror.p1.s0          State: empty    PO:        0  B Size:        512 MB
    S striped.p0.s0         State: up       PO:        0  B Size:        128 MB
    S striped.p0.s1         State: up       PO:      512 kB Size:        128 MB
    S striped.p0.s2         State: up       PO:     1024 kB Size:        128 MB
    S striped.p0.s3         State: up       PO:     1536 kB Size:        128 MB</pre><p>
        </p><div class="figure"><a id="vinum-striped-vol"></a><div class="figure-title">Figura 20.6. Un Volume Vinum in Striping</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-striped-vol.png" alt="Un Volume Vinum in Striping" /></div></div></div><p><br class="figure-break" />
      </p><p>Questo volume è rappresentato nella
        <a class="xref" href="vinum-examples.html#vinum-striped-vol" title="Figura 20.6. Un Volume Vinum in Striping">Figura 20.6, «Un Volume Vinum in Striping»</a>.  L'intensità del colore delle strisce
        indica la posizione all'interno dello spazio di indirizzamento del
        plex: le più chiare all'inizio, le più scure alla
        fine.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85133904"></a>20.6.4. Resistenza alle Rotture e Prestazioni</h3></div></div></div><p><a id="vinum-resilience"></a>Con hardware a sufficenza è
        possibile creare volumi con miglioramenti sia nella resistenza alle
        rotture che nelle prestazioni, comparati alle normali partizioni
        <span class="trademark">UNIX</span>®.  Una tipica configurazione potrebbe essere:</p><pre class="programlisting">    volume raid10
      plex org striped 512k
        sd length 102480k drive a
        sd length 102480k drive b
        sd length 102480k drive c
        sd length 102480k drive d
        sd length 102480k drive e
      plex org striped 512k
        sd length 102480k drive c
        sd length 102480k drive d
        sd length 102480k drive e
        sd length 102480k drive a
        sd length 102480k drive b</pre><p>I sottodischi del secondo plex sono spostati di due posti rispetto a
        quelli del primo plex: questo aumenta le probabilità che le
        scritture non utilizzino lo stesso sottodisco anche nel caso in cui un
        trasferimento utilizzi entrambi i drive.</p><p>La <a class="xref" href="vinum-examples.html#vinum-raid10-vol" title="Figura 20.7. Un Volume Vinum in Mirroring e Striping">Figura 20.7, «Un Volume Vinum in Mirroring e Striping»</a> rappresenta la struttura di
        questo volume.</p><p>
        </p><div class="figure"><a id="vinum-raid10-vol"></a><div class="figure-title">Figura 20.7. Un Volume Vinum in Mirroring e Striping</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-raid10-vol.png" alt="Un Volume Vinum in Mirroring e Striping" /></div></div></div><p><br class="figure-break" />
      </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="vinum-objects.html">Indietro</a> </td><td width="20%" align="center"><a accesskey="u" href="vinum-vinum.html">Risali</a></td><td width="40%" align="right"> <a accesskey="n" href="vinum-object-naming.html">Avanti</a></td></tr><tr><td width="40%" align="left" valign="top">20.5. Oggetti Vinum </td><td width="20%" align="center"><a accesskey="h" href="index.html">Partenza</a></td><td width="40%" align="right" valign="top"> 20.7. Nomenclatura degli Oggetti</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Questo, ed altri documenti, possono essere scaricati da
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Per domande su FreeBSD, leggi la
    <a href="http://www.FreeBSD.org/docs.html">documentazione</a> prima di contattare
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Per domande su questa documentazione, invia una e-mail a
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>