<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>Capítulo 8. Configuraçãao do Kernel</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Perguntas mais freqüentes sobre FreeBSD 2.X, 3.X e 4.X" /><link rel="up" href="index.html" title="Perguntas mais freqüentes sobre FreeBSD 2.X, 3.X e 4.X" /><link rel="prev" href="applications.html" title="Capítulo 7. Aplicações de Usuário" /><link rel="next" href="disks.html" title="Capítulo 9. Discos, Sistemas de Arquivos e Carregadores de Inicialização (Boot Loaders)" /><link rel="copyright" href="legalnotice.html" title="Nota Legal" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Capítulo 8. Configuraçãao do
      <span class="foreignphrase"><em class="foreignphrase">Kernel</em></span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="applications.html">Anterior</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="disks.html">Próxima</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="kernelconfig"></a>Capítulo 8. Configuraçãao do
      <span class="foreignphrase"><em class="foreignphrase">Kernel</em></span></h1></div></div></div><div class="qandaset"><a id="idp68408656"></a><dl><dt>8.1. <a href="kernelconfig.html#idp68408912">Eu gostaria de configurar meu
	    kernel.  É
	    difícil?</a></dt><dt>8.2. <a href="kernelconfig.html#idp68420176">A compilação do meu
	    kernel falha porque
	    está faltando o _hw_float.  Como
	    eu resolvo o problema?</a></dt><dt>8.3. <a href="kernelconfig.html#idp68430288">Por que meu kernel
	    é tão grande (cerca de 10MB)?</a></dt><dt>8.4. <a href="kernelconfig.html#idp68442064">Porque estão ocorrendo conflitos de
	    interrupção com portas multi-seriais?</a></dt><dt>8.5. <a href="kernelconfig.html#idp68446160">Porque todo kernel que
	    eu tento construir falha na compilação,
	    mesmo o GENERIC?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp68408912"></a><a id="make-kernel"></a><p><strong>8.1.</strong></p></td><td align="left" valign="top"><p>Eu gostaria de configurar meu
	    <span class="foreignphrase"><em class="foreignphrase">kernel</em></span>.  É
	    difícil?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>De modo algum!  Veja a <a class="link" href="../handbook/kernelconfig.html" target="_top">seção
	      "kernel config" do Manual do FreeBSD</a>.</p><div xmlns="" class="note"><h3 class="admontitle">Nota: </h3><p xmlns="http://www.w3.org/1999/xhtml">Recomenda-se que você faça uma
	      cópia datada do seu <code class="filename">kernel</code>
	      na forma <code class="filename">/kernel.AAMMDD</code> e o
	      diretório <code class="filename">/modules</code> para
	      <code class="filename">/modules.AAMMDD</code> depois que estiver
	      tudo funcionando.  Desta forma se você fizer
	      alguma bobagem quando mexer com a sua
	      configuração, pode-se iniciar aquele
	      <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> ao invés de
	      ter que desfazer tudo novamente no
	      <code class="filename">kernel.GENERIC</code>.  Isso é
	      particularmente importante se você estiver dando
	      boot em um equipamento não suportado pelo
	      <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> genérico
	      (<code class="literal">GENERIC</code>).</p></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp68420176"></a><a id="missing-hw-float"></a><p><strong>8.2.</strong></p></td><td align="left" valign="top"><p>A compilação do meu
	    <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> falha porque
	    está faltando o <code class="literal">_hw_float</code>.  Como
	    eu resolvo o problema?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Deixa eu adivinhar.  Você removeu o
	    <code class="filename">npx0</code> (veja <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=npx&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">npx</span>(4)</span></a>) do
	    arquivo de configuração do
	    <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> porque você
	    não possui um co-processador aritmético,
	    certo?  Errado!  :-) O <code class="filename">npx0</code>
	    é <span class="emphasis"><em>OBRIGATÓRIO</em></span>.  Mesmo
	    que você não tenha um co-processador
	    aritmético, o dispositivo
	    <code class="filename">npx0</code> <span class="emphasis"><em>deve</em></span>
	    ser incluido.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp68430288"></a><a id="why-kernel-big"></a><p><strong>8.3.</strong></p></td><td align="left" valign="top"><p>Por que meu <span class="foreignphrase"><em class="foreignphrase">kernel</em></span>
	    é tão grande (cerca de 10MB)?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Provavelmente, seu
	    <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> foi compilado em
	    <span class="emphasis"><em>modo de depuração
	      (<code class="literal">debug</code>)</em></span>.  Um
	    <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> construído em
	    modo de depuração (<code class="literal">debug</code>)
	    contêm muitos símbolos usados para
	    depuração que aumentam muito o seu tamanho.
	    Note que se você está executando um FreeBSD
	    3.0 ou superior, terá pouca, ou nenhuma,  perda de
	    performance por usar um
	    <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> em modo de
	    depuração (<code class="literal">debug</code>), sendo
	    útil ter um para o caso de pane no sistema.
	  </p><p>Entretanto, se você possui pouco espaço
	    em disco, ou simplesmente não quer executar um
	    <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> para
	    depuração,  certifique-se que os dois itens
	    abaixo sejam verdadeiros:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Não existe a seguinte linha no arquivo de
		configuração do
		<span class="foreignphrase"><em class="foreignphrase">kernel</em></span></p><pre class="programlisting">makeoptions DEBUG=-g</pre></li><li class="listitem"><p>Você não está executando
		<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=config&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">config</span>(8)</span></a> com a opção
		<code class="option">-g</code>.</p></li></ul></div><p>Ambas as situações acima fazem com que o
	    <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> seja compilado no
	    modo de depuração
	    (<code class="literal">debug</code>).  Tão logo você
	    tenha certeza que não se enquadra naqueles itens, o
	    <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> poderá ser
	    compilado normalmente e notadamente diminuirá o
	    tamanho;  a maioria dos
	    <span class="foreignphrase"><em class="foreignphrase">kernels</em></span> tendem a ficar em
	    torno de 1.5MB a 2MB.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp68442064"></a><a id="multiport-serial-interrupts"></a><p><strong>8.4.</strong></p></td><td align="left" valign="top"><p>Porque estão ocorrendo conflitos de
	    interrupção com portas multi-seriais?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Quando se compila um
	    <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> com suporte a porta
	    multi-serial, ele avisa que somente a primeira porta
	    é testada e as demais são ignoradas devido a
	    conflitos de interrupção.  Como eu conserto
	    isto?</p><p>O problema, neste caso, é que o FreeBSD possui
	    código para evitar que o
	    <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> fique com lixo
	    (<span class="foreignphrase"><em class="foreignphrase">trashed kernel</em></span>) por causa
	    de conflitos de hardware ou software.  A maneira de
	    corrigir isto é excluindo as
	    definiçõs de IRQ em todas as portas exceto
	    uma.  Veja o exemplo:</p><pre class="programlisting">#
# Multiport high-speed serial line - 16550 UARTS
#
device sio2 at isa? port 0x2a0 tty irq 5 flags 0x501 vector siointr
device sio3 at isa? port 0x2a8 tty flags 0x501 vector siointr
device sio4 at isa? port 0x2b0 tty flags 0x501 vector siointr
device sio5 at isa? port 0x2b8 tty flags 0x501 vector siointr</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp68446160"></a><a id="generic-kernel-build-failure"></a><p><strong>8.5.</strong></p></td><td align="left" valign="top"><p>Porque todo <span class="foreignphrase"><em class="foreignphrase">kernel</em></span> que
	    eu tento construir falha na compilação,
	    mesmo o GENERIC?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Existem várias causas possíveis para
	    esse problema.  Elas são, sem uma ordem particular:
	  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Você não está usando os
		comandos <code class="command">make buildkernel</code> e
		<code class="command">make installkernel</code>, e seus fontes
		estão estruturados de forma diferente daqueles
		usados para construir o sistema atual (por exemplo,
		está sendo um 4.3-RELEASE em um sistema
		4.0-RELEASE).  Se estiver sendo feita uma
		atualização, leia o arquivo
		<code class="filename">/usr/src/UPDATING</code>, prestando
		atenção ao final da seção
		<span class="quote">&#8220;<span class="quote">COMMON ITEMS</span>&#8221;</span>.</p></li><li class="listitem"><p>Você está usando os comandos
		<code class="command">make buildkernel</code> e <code class="command">make
		  installkernel</code>, mas não garantiu a
		correta finalização do comando
		<code class="command">make buildworld</code>.  O <code class="command">make
		  buildkernel</code> depende de arquivos gerados
		pelo <code class="command">make buildworld</code> para fazer seu
		trabalho corretamente.</p></li><li class="listitem"><p>Mesmo que você esteja tentando construir um
		<a class="link" href="introduction.html#stable" title="1.8.">FreeBSD-STABLE</a>, é
		possível que os fontes tenham sido pegos quando
		estavam sendo modificados, ou inconsistentes por
		alguma outra razão; somente os releases
		são absolutamente garantidos de serem
		compilados, embora o <a class="link" href="introduction.html#stable" title="1.8.">FreeBSD-STABLE</a> possa ser
		compilado com sucesso na grande maioria das vezes.
		Caso já não tenha conseguido,  tente
		buscar os fontes novamente e veja se o problema
		já não foi resolvido.  Tente um servidor
		diferente, para o caso daquele que está sendo
		usado estar com problemas.</p></li></ul></div></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="applications.html">Anterior</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="disks.html">Próxima</a></td></tr><tr><td width="40%" align="left" valign="top">Capítulo 7. Aplicações de Usuário </td><td width="20%" align="center"><a accesskey="h" href="index.html">Principal</a></td><td width="40%" align="right" valign="top"> Capítulo 9. Discos, Sistemas de Arquivos e Carregadores de
      Inicialização (<span class="foreignphrase"><em class="foreignphrase">Boot
	Loaders</em></span>)</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Este, e outros documentos, podem ser obtidos em
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Para perguntas sobre FreeBSD, leia a
    <a href="http://www.FreeBSD.org/docs.html">documentação</a> antes de contatar
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Para perguntas sobre esta documentação, envie e-mail para
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>