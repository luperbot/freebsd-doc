<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>8.18. Comment configurer sendmail pour fonctionner avec UUCP ?</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Questions Fréquemment Posées sur FreeBSD 2.X, 3.X et 4.X" /><link rel="up" href="admin.html" title="Chapitre 8. Administration système. **Mise à jour en cours**" /><link rel="prev" href="ch08s17.html" title="8.17. Est-ce que FreeBSD supporte les communications inter-processus de type Système V (IPC) ?" /><link rel="next" href="ch08s19.html" title="8.19. Comment mettre en oeuvre le courrier électronique avec une connexion temporaire à un réseau ?" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">8.18. Comment configurer sendmail pour fonctionner avec UUCP ?</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch08s17.html">Précédent</a> </td><th width="60%" align="center">Chapitre 8. Administration système. **Mise à jour en cours**</th><td width="20%" align="right"> <a accesskey="n" href="ch08s19.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="idp67867600"></a>8.18. Comment configurer sendmail pour fonctionner avec UUCP ?</h2></div></div></div><p>La configuration de sendmail fournie avec FreeBSD,
correspond à un site directement connecté à l'Internet. Les sites qui
utilisent  UUCP pour échanger du courrier électronique doivent
installer un autre fichier de configuration pour sendmail. </p><p>Modifier directement le fichier <code class="filename">
/etc/sendmail.cf </code> est réservé la plupart du temps aux
gourous. La version 8 de sendmail dispose d'une interface <a class="link" href="http://www.freebsd.org/cgi/man.cgi?m4" target="_top">m4</a> de génération
du fichier de configuration, qui encapsule le fichier de configuration
dans un format abstrait de haut niveau. Vous devez trouvez les
différents fichiers de configuration dans le répertoire <code class="filename">
/usr/src/usr.sbin/sendmail/cf </code>.</p><p>Si vous n'avez pas installé tous les sources du système,
vous pouvez trouver les différents fichiers de configuration de
sendmail dans un fichier séparé des autres sources sur le CD-ROM. Si
vous avez monté le CD-ROM exécutez les commandes suivantes :</p><pre class="programlisting">
cd /usr/src
tar -xvzf /cdrom/dists/src/ssmailcf.aa
</pre><p>Cela correspond juste à une centaine de kilo-octets. Le
fichier <code class="filename">README</code> dans le répertoire
<code class="filename">cf</code> vous explique rapidement comment fonctionnne
m4.</p><p>Pour utiliser UUCP, vous devez utiliser la fonctionnnalité
<span class="emphasis"><em>mailertable</em></span>. Elle permet à sendmail de constituer
une base de données pour lui permettre de router le courrier
correctement.</p><p>Pour commencer, vous devez créer une fichier de
configuration <code class="filename">.mc</code>. Tous ces types de fichiers se
trouvent dans le répertoire
<code class="filename">/usr/src/usr.sbin/sendmail/cf/cf</code>. Il y a quelques
fichiers d'exemples dans ce répertoire pouvant vous aider. En
supposant que vous avez appelé ce fichier <code class="filename">foo.mc</code>,
tout ce que vous devez faire pour le convertir en un
fichier valide de configuration de sendmail,
<code class="filename">sendmail.cf</code> est :</p><pre class="programlisting">
cd /usr/src/usr.sbin/sendmail/cf/cf
make foo.cf
cp foo.cf /etc/sendmail.cf
</pre><p>Un fichier classique ressemble à ceci:</p><pre class="programlisting">
include(`../m4/cf.m4')
VERSIONID(`Votre numéro de version)
OSTYPE(bsd4.4)
FEATURE(nodns)
FEATURE(nocanonify)
FEATURE(mailertable)

define(`UUCP_RELAY', nom.du.relai.uucp)
define(`UUCP_MAX_SIZE', 200000)

MAILER(local)
MAILER(smtp)
MAILER(uucp)

Cw    alias.de.votre.nom.de.machine
Cw    votrenomdenoeuduucp.UUCP
</pre><p>Les directives <span class="emphasis"><em>nodns</em></span>et
<span class="emphasis"><em>nocanonify</em></span> forcent sendmail à ne pas utiliser le
DNS lors de l'envoi du courrier. La directive
<span class="emphasis"><em>UUCP_RELAY</em></span> est utilisée pour des raisons assez
bizarres; ne posez pas de questions et utilisez-la. Mettez juste un nom
de machine capable de recevoir du courrier en UUCP. La plupart du
temps il faut mettre le nom du serveur de messagerie de votre
fournisseur d'accès.</p><p>Après avoir défini tout ceci, vous avez besoin d'un
fichier <code class="filename">/etc/mailertable</code>. Voici un exemple de ce
type de fichier :</p><pre class="programlisting">
#
# makemap hash /etc/mailertable.db &lt; /etc/mailertable
#
horus.interface-business.de   uucp-dom:horus
.interface-business.de        uucp-dom:if-bus
interface-business.de         uucp-dom:if-bus
.heep.sax.de                  smtp8:%1
horus.UUCP                    uucp-dom:horus
if-bus.UUCP                   uucp-dom:if-bus
.			      uucp-dom:sax
</pre><p>Les trois premières lignes font en sorte d'envoyer
le courrier à des serveurs UUCP ``voisins'' et non pas au serveur par
défaut, pour permettre de racourcir le temps d'envoi des messages. La
ligne suivante permet d'envoyer le courrier sur le domaine local en
protocole SMTP. Et pour finir, les ``voisins'' UUCP sont mentionner
dans la la notation de domaine .UUCP, permettant au format de mail
``voisin-uucp!destinataire'' d'écraser les règles par défaut. La
dernière ligne doit toujours être un ``.'', qui représente toutes les
destinations, qui doit correspondre à un serveur de messagerie UUCP
voisin, et qui sert de passerelle de courrier éléctronique vers le
reste du monde. Tous les noms de noeuds se trouvant après le mot clé
<code class="filename">uucp-dom:</code>doivent être des noms valides de voisins
UUCP, que vous pouvez vérifier en utilisant la commande
<code class="filename">uuname</code></p><p>Pour vous rappeler que ce fichier doit être converti en
fichier DBM pour pouvoir être utilisé, la ligne de commande
nécessaire à sa création est rappelée dans les commentaires du fichier
mailertable. Vous devez lancer cette commande à chaque fois que vous
changez quelque chose dans ce fichier.</p><p>Pour finir : si vous n'etes pas certain de votre
configuration d'envoi de messages électroniques, rappellez-vous
l'option <code class="filename">-bt</code> de sendmail. Cela lance sendmail en
<span class="emphasis"><em>mode test</em></span> ; entrez simplement ``0 '' suivi de
l'adresse que vous voulez tester. La dernière ligne vous indiquera
alors le type d'agent utilisé pour l'envoi, la machine auquelle
l'agent enverra le courrier, et l'adresse à laquelle il l'enverra. Pour
quitter ce mode tapez Control-D.</p><pre class="programlisting">
j@uriah 191% sendmail -bt
ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)
Enter &lt;ruleset&gt; &lt;address&gt;
&gt; 0 foo@interface-business.de
rewrite: ruleset  0   input: foo @ interface-business . de
...
rewrite: ruleset  0 returns: $# uucp-dom $@ if-bus $: foo \
&lt; @ interface-business . de &gt;
&gt; ^D
j@uriah 192%
</pre></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch08s17.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="admin.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="ch08s19.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">8.17. Est-ce que FreeBSD supporte les communications inter-processus de type Système V (IPC) ? </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 8.19. Comment mettre en oeuvre le courrier électronique avec une connexion temporaire à un réseau ?</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>