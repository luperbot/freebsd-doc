<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>27.5. Utiliser PPP sur ATM (PPPoA)</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="ppp-and-slip.html" title="Chapitre 27. PPP et SLIP" /><link rel="prev" href="pppoe.html" title="27.4. Utiliser PPP sur Ethernet (PPPoE)" /><link rel="next" href="slip.html" title="27.6. Utiliser SLIP" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">27.5. Utiliser <span class="application">PPP</span> sur ATM (PPPoA)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="pppoe.html">Précédent</a> </td><th width="60%" align="center">Chapitre 27. PPP et SLIP</th><td width="20%" align="right"> <a accesskey="n" href="slip.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="pppoa"></a>27.5. Utiliser <span class="application">PPP</span> sur ATM (PPPoA)</h2></div></div></div><a id="idp83554000" class="indexterm"></a><a id="idp83554896" class="indexterm"></a><p>Ce qui suit décrit comment configurer PPP sur ATM
      (PPPoA).  PPPoA est très populaire parmi les fournisseurs
      d'accès DSL européens.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp83556432"></a>27.5.1. Utiliser PPPoA avec le modem Alcatel <span class="trademark">SpeedTouch</span>&#8482;
	USB</h3></div></div></div><p>Le support PPPoA pour ce périphérique est
	fourni sous la forme d'un logiciel porté sous FreeBSD car
	le &#8220;firmware&#8221; est distribué sous l'<a class="link" href="http://www.speedtouchdsl.com/disclaimer_lx.htm" target="_top">accord de
	licence d'Alcatel</a> et ne peut être
	redistribué librement avec le système de base de
	FreeBSD.</p><p>Pour installer le logiciel, utilisez simplement le <a class="link" href="ports.html" title="Chapitre 5. Installer des applications: les logiciels pré-compilés et les logiciels portés">catalogue des logiciels portés</a>.
	Installez le logiciel porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/pppoa/pkg-descr">net/pppoa</a> et suivez les instructions
	fournies avec.</p><p>Comme de nombreux périphériques, le modem
	USB Alcatel <span class="trademark">SpeedTouch</span>&#8482; a besoin de charger un
	&#8220;firmware&#8221; à partir de l'ordinateur
	hôte pour opérer correctement.  Il est possible
	d'automatiser ce processus sous FreeBSD de manière
	à ce que ce transfert ait lieu dès que le
	périphérique est branché dans un port
	USB.  L'information suivante peut être ajoutée au
	fichier <code class="filename">/etc/usbd.conf</code> pour autoriser ce
	transfert automatique de &#8220;firmware&#8221;.  Ce fichier
	doit être édité en tant que
	super-utilisateur.</p><pre class="programlisting">device "Alcatel SpeedTouch USB"
    devname "ugen[0-9]+"
    vendor 0x06b9
    product 0x4061
    attach "/usr/local/sbin/modem_run -f /usr/local/libdata/mgmt.o"</pre><p>Pour activer le &#8220;daemon&#8221; USB,
	<span class="application">usbd</span>, ajoutez la ligne suivante
	dans le fichier <code class="filename">/etc/rc.conf</code>:</p><pre class="programlisting">usbd_enable="YES"</pre><p>Il est également possible de paramétrer
	<span class="application">ppp</span> pour se connecter au
	démarrage.  Pour cela ajoutez les lignes suivantes au
	fichier <code class="filename">/etc/rc.conf</code>.  Encore une fois,
	vous devrez être attaché sous l'utilisateur
	<code class="systemitem">root</code> pour effectuer ces ajouts.</p><pre class="programlisting">ppp_enable="YES"
ppp_mode="ddial"
ppp_profile="adsl"</pre><p>Pour que cela fonctionne correctement, vous devrez
	utiliser le fichier d'exemple <code class="filename">ppp.conf</code>
	qui est fourni avec le logiciel porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/pppoa/pkg-descr">net/pppoa</a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp83570384"></a>27.5.2. Utiliser mpd</h3></div></div></div><p>Vous pouvez utiliser <span class="application">mpd</span> pour
	vous connecter à différents services, en
	particulier aux services PPTP.  Vous trouverez
	<span class="application">mpd</span> dans le catalogue des logiciels
	portés, <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/mpd/pkg-descr">net/mpd</a>.
	De nombreux modems ADSL demandent à ce qu'un tunnel
	PPTP soit créé entre le modem et l'ordinateur,
	le <span class="trademark">SpeedTouch</span>&#8482; Home d'Alcatel en fait partie.</p><p>Vous devez tout d'abord installer le logiciel
	porté, ensuite vous pouvez configurer
	<span class="application">mpd</span> selon vos besoins et les
	paramètres propres au fournisseur d'accès.  Le
	logiciel porté place un ensemble de fichiers de
	configuration très bien commentés dans le
	répertoire <code class="filename">PREFIX/etc/mpd/</code>.
	Notez qu'ici <em class="replaceable"><code>PREFIX</code></em>
	représente le répertoire dans lequel les
	logiciels portés sont installés, par
	défaut le répertoire <code class="filename">/usr/local/</code>.  Un guide complet
	pour la configuration de <span class="application">mpd</span> est
	disponible dans le format HTML, une fois que le logiciel a
	été installé.  Il se trouve dans le
	répertoire <code class="filename">PREFIX/share/doc/mpd/</code>.
	Voici un exemple de configuration pour se connecter à
	un service ADSL à l'aide de
	<span class="application">mpd</span>.  La configuration est
	séparée en deux fichiers, le premier est
	<code class="filename">mpd.conf</code>:</p><pre class="programlisting">default:
    load adsl

adsl:
    new -i ng0 adsl adsl
    set bundle authname <em class="replaceable"><code>username</code></em> <a id="co-mpd-ex-user"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
    set bundle password <em class="replaceable"><code>password</code></em> <a id="co-mpd-ex-pass"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>
    set bundle disable multilink

    set link no pap acfcomp protocomp
    set link disable chap
    set link accept chap
    set link keep-alive 30 10

    set ipcp no vjcomp
    set ipcp ranges 0.0.0.0/0 0.0.0.0/0

    set iface route default
    set iface disable on-demand
    set iface enable proxy-arp
    set iface idle 0

    open</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co-mpd-ex-user"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Le nom d'utilisateur utilisé pour vous identifier
	    auprès de votre FAI.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-mpd-ex-pass"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Le mot de passe utilisé pour vous identifier
	    auprès de votre FAI.</p></td></tr></table></div><p>Le fichier <code class="filename">mpd.links</code> contient les
	informations concernant la liaison, ou les liaisons, que vous
	souhaitez établir.  En exemple de fichier
	<code class="filename">mpd.links</code> accompagnant l'exemple
	précédent est donné ci-dessous:</p><pre class="programlisting">adsl:
    set link type pptp
    set pptp mode active
    set pptp enable originate outcall
    set pptp self <em class="replaceable"><code>10.0.0.1</code></em> <a id="co-mpd-ex-self"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
    set pptp peer <em class="replaceable"><code>10.0.0.138</code></em> <a id="co-mpd-ex-peer"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co-mpd-ex-self"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>L'adresse IP de la machine FreeBSD à partir de
	    laquelle vous utiliserez
	    <span class="application">mpd</span>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-mpd-ex-peer"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>L'adresse IP de votre modem ADSL.  Pour le
	    <span class="trademark">SpeedTouch</span>&#8482; Home d'Alcatel cette adresse est par
	    défaut <code class="systemitem">10.0.0.138</code>.</p></td></tr></table></div><p>Il est possible d'initialiser aisément une
	connexion en tapant la commande suivante en tant que
	<code class="systemitem">root</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mpd -b adsl</code></strong></pre><p>Vous pouvez voir quel est l'état de votre connexion
	à l'aide de la commande suivante:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ifconfig ng0</code></strong>
ng0: flags=88d1&lt;UP,POINTOPOINT,RUNNING,NOARP,SIMPLEX,MULTICAST&gt; mtu 1500
     inet 216.136.204.117 --&gt; 204.152.186.171 netmask 0xffffffff</pre><p>L'utilisation de <span class="application">mpd</span> est la
	méthode recommandée de connexion à un
	service ADSL sous FreeBSD.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp83611856"></a>27.5.3. Utiliser pptpclient</h3></div></div></div><p>Il est également possible d'utiliser FreeBSD pour se
	connecter à d'autres service PPPoA en utilisant
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/pptpclient/pkg-descr">net/pptpclient</a>.</p><p>Pour utiliser <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/net/pptpclient/pkg-descr">net/pptpclient</a> pour vous connecter
	à un service DSL, installez le logiciel porté ou
	le paquetage correspondant et éditez votre fichier
	<code class="filename">/etc/ppp/ppp.conf</code>.  Vous aurez besoin des
	droits de super-utilisateur pour effectuer ces deux
	opérations.  Un exemple de fichier
	<code class="filename">ppp.conf</code> est donné plus bas.  Pour
	plus d'information sur les options du fichier
	<code class="filename">ppp.conf</code>, consultez la page de manuel de
	<span class="application">ppp</span>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppp&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ppp</span>(8)</span></a>.</p><pre class="programlisting">adsl:
 set log phase chat lcp ipcp ccp tun command
 set timeout 0
 enable dns
 set authname <em class="replaceable"><code>username</code></em> <a id="co-pptp-ex-user"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
 set authkey <em class="replaceable"><code>password</code></em> <a id="co-pptp-ex-pass"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>
 set ifaddr 0 0
 add default HISADDR</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co-pptp-ex-user"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Le nom d'utilisateur de votre compte chez le
	    fournisseur d'accès DSL.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-pptp-ex-pass"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Le mot de passe de votre compte.</p></td></tr></table></div><div xmlns="" class="warning"><h3 class="admontitle">Avertissement: </h3><p xmlns="http://www.w3.org/1999/xhtml">Etant donné que vous devez mettre le mot de passe
	  de votre compte en clair dans le fichier
	  <code class="filename">ppp.conf</code>, vous devez vous assurer que
	  personne d'autre ne puisse lire le contenu de ce fichier.  La
	  série de commandes suivante s'assurera que ce fichier
	  n'est lisible que par <code class="systemitem">root</code>.
	  Référez-vous aux pages de manuel de
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chmod&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">chmod</span>(1)</span></a> et <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chown&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">chown</span>(8)</span></a> pour plus
	  d'informations.</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chown root:wheel /etc/ppp/ppp.conf</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chmod 600 /etc/ppp/ppp.conf</code></strong></pre></div><p>Cela créera un tunnel pour une session PPP vers
	votre routeur DSL.  Les modems DSL Ethernet ont une adresse IP
	pour le réseau local pré-configurée
	à laquelle vous vous connectez.  Dans le cas du modem
	<span class="trademark">SpeedTouch</span>&#8482; Home d'Alcatel cette adresse est <code class="systemitem">10.0.0.138</code>.  La documentation de votre
	routeur devrait mentionner quelle adresse utilise votre
	périphérique.  Pour créer le tunnel et
	démarrer une session PPP exécutez la commande
	suivante:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pptp address adsl</code></strong></pre><div xmlns="" class="tip"><h3 class="admontitle">Astuce: </h3><p xmlns="http://www.w3.org/1999/xhtml">Vous pourrez ajouter un &#8220;et commercial&#8221;
	  (&#8220;&amp;&#8221;) à la fin de la commande
	  précédente car sinon
	  <span class="application">pptp</span> ne vous rendra pas la
	  main.</p></div><p>Un périphérique virtuel de tunnel
	(<code class="filename">tun</code>) sera créé pour la
	communication entre les processus
	<span class="application">pptp</span> et
	<span class="application">ppp</span>.  Une fois
	retourné à l'invite, ou que le processus
	<span class="application">pptp</span> a confirmé la
	connexion, vous pouvez examiner le tunnel de cette
	manière:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ifconfig tun0</code></strong>
tun0: flags=8051&lt;UP,POINTOPOINT,RUNNING,MULTICAST&gt; mtu 1500
        inet 216.136.204.21 --&gt; 204.152.186.171 netmask 0xffffff00
        Opened by PID 918</pre><p>Si vous n'êtes pas en mesure de vous connecter,
	vérifiez la configuration de votre routeur qui est
	généralement accessible par
	<span class="application">telnet</span> ou avec un navigateur web.
	Si le problème persiste, vous devrez examiner la sortie
	de la commande <code class="command">pptp</code> et le contenu du
	fichier de trace de <span class="application">ppp</span>,
	<code class="filename">/var/log/ppp.log</code> à la recherche
	d'indices.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="pppoe.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="ppp-and-slip.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="slip.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">27.4. Utiliser PPP sur Ethernet (PPPoE) </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 27.6. Utiliser SLIP</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>