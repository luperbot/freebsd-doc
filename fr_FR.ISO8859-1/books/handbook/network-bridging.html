<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>31.5. Bridging</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="advanced-networking.html" title="Chapitre 31. Administration réseau avancée" /><link rel="prev" href="network-bluetooth.html" title="31.4. Bluetooth" /><link rel="next" href="network-diskless.html" title="31.6. Système sans disque dur" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">31.5. Bridging</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-bluetooth.html">Précédent</a> </td><th width="60%" align="center">Chapitre 31. Administration réseau avancée</th><td width="20%" align="right"> <a accesskey="n" href="network-diskless.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-bridging"></a>31.5. Bridging</h2></div><div><span class="authorgroup">Ecrit par <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Steve</span> <span class="surname">Peterson</span></span>. </span></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86880464"></a>31.5.1. Introduction</h3></div></div></div><a id="idp86881104" class="indexterm"></a><a id="idp86881616" class="indexterm"></a><p>Il est parfois utile de diviser un réseau physique
	(comme un réseau Ethernet) en deux réseaux
	séparés sans avoir à créer de
	sous-réseaux IPs et à utiliser un routeur pour
	connecter ces réseaux entre eux.  Le
	périphérique qui connecte ensemble deux
	réseaux de cette manière est appelé
	&#8220;bridge&#8221;&#8212;pont.  Un système FreeBSD avec
	deux cartes réseaux peut faire fonction de pont.</p><p>Le pont apprend les adresses MAC (adresses Ethernet) des
	périphériques branchés sur chacune de ses
	interfaces réseaux.  Il transmet le trafic entre deux
	réseaux uniquement quand la source et la destination
	sont sur des réseaux différents.</p><p>Sous de nombreux aspects, un pont ressemble à un
	switch (commutateur) Ethernet avec très peu de
	ports.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86883408"></a>31.5.2. Situations où l'utilisation d'un pont est
	appropriée</h3></div></div></div><p>Il existe deux situations dans lesquelles un pont est de
	nos jours utilisé.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86884432"></a>31.5.2.1. Trafic important sur un segment</h4></div></div></div><p>La première situation apparaît quand un
	  segment physique d'un réseau est submergé par
	  le trafic, mais vous ne voulez pas, pour différentes
	  raisons, subdiviser le réseau et interconnecter les
	  sous-réseaux à l'aide d'un routeur.</p><p>Prenons comme exemple un journal où les bureaux
	  de la rédaction et de la production sont sur le
	  même sous-réseau.  Les utilisateurs de la
	  rédaction utilisent tous le serveur de fichiers
	  <code class="systemitem">A</code>, et les utilisateurs de la production le
	  serveur <code class="systemitem">B</code>.  Un réseau Ethernet est
	  utilisé pour connecter ensemble les utilisateurs, et
	  des surcharges du réseau ralentissent les
	  échanges.</p><p>Si les utilisateurs de la rédaction peuvent
	  être cantonné sur un segment, et les
	  utilisateurs de la production sur un autre, les deux
	  réseaux pourront être connectés par un
	  pont.  Seul le trafic réseau destiné aux
	  interfaces réseaux situées de
	  l'&#8220;autre&#8221; côté du pont sera
	  transmis à l'autre réseau, réduisant
	  ainsi les congestions sur chaque segment.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86887248"></a>31.5.2.2. Coupe-feu filtrant/régulant le trafic</h4></div></div></div><a id="idp86887888" class="indexterm"></a><a id="idp86888400" class="indexterm"></a><p>La deuxième situation est quand un coupe-feu est
	  nécessaire mais sans translation d'adresses
	  (NAT).</p><p>Un exemple est une compagnie qui est connectée
	  à son fournisseur d'accès internet par
	  l'intermédiaire d'une connexion ISDN ou DSL.  Elle
	  dispose de 13 adresses IP routables fournies par le
	  fournisseur d'accès et dispose de 10 PCs sur son
	  réseau.  Dans cette situation, utiliser un
	  coupe-feu/routeur est complexe en raison des
	  problèmes de sous-réseaux.</p><a id="idp86889680" class="indexterm"></a><a id="idp86890192" class="indexterm"></a><a id="idp86890704" class="indexterm"></a><p>Un coupe-feu basé sur un pont peut être
	  configuré et positionné dans le flux juste en
	  aval de leur routeur DSL/ISDN sans aucun problème
	  d'adressage IP.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86891856"></a>31.5.3. Configuration d'un pont</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86892496"></a>31.5.3.1. Choix des cartes réseaux</h4></div></div></div><p>Un pont nécessite au moins deux cartes
	  réseaux pour fonctionner.  Malheureusement toutes les
	  cartes réseaux ne supportent pas le mode bridging.
	  Lisez la page de manuel <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bridge&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">bridge</span>(4)</span></a> pour des
	  détails sur les cartes supportées.</p><p>Installez et testez les deux cartes réseaux avant
	  de poursuivre.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86899024"></a>31.5.3.2. Modification de la configuration du noyau</h4></div></div></div><a id="idp86899664" class="indexterm"></a><p>Pour activer le support nécessaire pour mettre en
	  place un pont ajouter la ligne suivante:</p><pre class="programlisting">options BRIDGE</pre><p>à votre fichier de configuration du noyau, et
	  recompilez votre noyau.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86902096"></a>31.5.3.3. Support du coupe-feu</h4></div></div></div><a id="idp86902736" class="indexterm"></a><p>Si vous projetez d'utiliser un pont en tant que
	  coupe-feu, vous devrez également ajouter l'option
	  <code class="literal">IPFIREWALL</code>.  Lisez la <a class="xref" href="firewalls.html" title="Chapitre 30. Firewalls ** Traduction en Cours **">Chapitre 30, <em>Firewalls ** Traduction en Cours **</em></a> pour des informations
	  générales sur la configuration d'un pont en tant
	  que coupe-feu.</p><p>Si vous avez besoin de permettre le passage à
	  travers le pont des paquets non-IP (comme ARP), il existe
	  une option du coupe-feu qui doit être activée.
	  Cette option est
	  <code class="literal">IPFIREWALL_DEFAULT_TO_ACCEPT</code>.  Prennez
	  note que cela modifie le fonctionnement par défaut du
	  coupe-feu, ce dernier acceptera alors tous les paquets.
	  Assurez-vous de savoir ce que ce changement signifie pour
	  votre ensemble de règles de filtrage avant de
	  l'effectuer.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86909520"></a>31.5.3.4. Support de la régulation du trafic</h4></div></div></div><p>Si vous désirez utiliser le pont comme
	  régulateur de trafic, vous devrez ajouter l'option
	  <code class="literal">DUMMYNET</code> à votre fichier de
	  configuration du noyau.  Consultez la page de manuel
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dummynet&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">dummynet</span>(4)</span></a> pour plus d'information.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86911952"></a>31.5.4. Activer le pont</h3></div></div></div><p>Ajoutez la ligne:</p><pre class="programlisting">net.link.ether.bridge.enable=1</pre><p>au fichier <code class="filename">/etc/sysctl.conf</code> pour
	activer le pont au démarrage, et la ligne:</p><pre class="programlisting">net.link.ether.bridge.config=<em class="replaceable"><code>if1</code></em>,<em class="replaceable"><code>if2</code></em></pre><p>pour activer le mode bridging sur les interfaces
	spécifiées (remplacez
	<em class="replaceable"><code>if1</code></em> et
	<em class="replaceable"><code>if2</code></em> par les noms de vos interfaces
	réseaux).  Si vous désirez que les paquets
	traversant le pont soient filtrés par <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ipfw</span>(8)</span></a>,
	vous devrez ajouter également la ligne:</p><pre class="programlisting">net.link.ether.bridge.ipfw=1</pre><p>Pour les versions antérieures à FreeBSD 5.2-RELEASE, utilisez
	les lignes suivantes:</p><pre class="programlisting">net.link.ether.bridge=1
net.link.ether.bridge_cfg=<em class="replaceable"><code>if1</code></em>,<em class="replaceable"><code>if2</code></em>
net.link.ether.bridge_ipfw=1</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86923344"></a>31.5.5. Informations supplémentaires</h3></div></div></div><p>Si vous désirez être en mesure de vous
	connecter au pont par l'intermédiaire de
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a>, il est correct d'ajouter à l'une des
	cartes réseaux une adresse IP.  Il existe un consensus
	sur le fait qu'assigner une adresse aux deux cartes est une
	mauvaise idée.</p><p>Si vous avez plusieurs ponts sur votre réseau, il
	ne peut y en avoir plus d'un sur le chemin qui sera
	emprunté par le trafic entre deux stations de travail.
	Techniquement, cela signifie qu'il n'y a pas de support pour
	la gestion du &#8220;spanning tree&#8221;.</p><p>Un pont peut ajouter des temps de latence lors de
	l'utilisation de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ping&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ping</span>(8)</span></a>, et tout particulièrement
	dans le cas du trafic d'un segment vers un autre.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-bluetooth.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="advanced-networking.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="network-diskless.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">31.4. Bluetooth </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 31.6. Système sans disque dur</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>