<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>8.6. Scanners</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="multimedia.html" title="Chapitre 8. Multimédia" /><link rel="prev" href="tvcard.html" title="8.5. Configuration des cartes TV" /><link rel="next" href="kernelconfig.html" title="Chapitre 9. Configurer le noyau de FreeBSD" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">8.6. Scanners</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="tvcard.html">Précédent</a> </td><th width="60%" align="center">Chapitre 8. Multimédia</th><td width="20%" align="right"> <a accesskey="n" href="kernelconfig.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="scanners"></a>8.6. Scanners</h2></div><div><span class="authorgroup">Ecrit par <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Marc</span> <span class="surname">Fonvieille</span></span>. </span></div></div></div><a id="idp72958032" class="indexterm"></a><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp72971216"></a>8.6.1. Introduction</h3></div></div></div><p>Sous FreeBSD, l'accès aux scanners est
	possible grâce à l'<acronym class="acronym">API</acronym>
	<span class="application">SANE</span> (Scanner Access Now Easy)
	disponible dans le catalogue des logiciels portés.
	<span class="application">SANE</span> utilisera également
	certains pilotes de périphériques FreeBSD pour
	accéder à la partie matérielle du
	scanner.</p><p>FreeBSD supporte les scanners SCSI et USB.  Assurez-vous que
	votre scanner est supporté par
	<span class="application">SANE</span> avant d'effectuer une
	quelconque configuration.  <span class="application">SANE</span>
	dispose d'une liste des <a class="link" href="http://www.sane-project.org/sane-supported-devices.html" target="_top">périphériques
	supportés</a> qui peut vous informer sur le support
	et son statut pour un scanner particulier.  La page de manuel
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=uscanner&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">uscanner</span>(4)</span></a> donne également une liste des scanners
	USB supportés.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp72976336"></a>8.6.2. Configuration du noyau</h3></div></div></div><p>Comme mentionné plus haut les interfaces SCSI et
	USB sont supportées.  En fonction de l'interface de
	votre scanner, différents pilotes de
	périphérique sont nécessaires.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="scanners-kernel-usb"></a>8.6.2.1. Interface USB</h4></div></div></div><p>Le noyau <code class="filename">GENERIC</code> inclut par
	  défaut les pilotes nécessaires au support des
	  scanners USB.  Si vous décidez d'utiliser un noyau
	  personnalisé, assurez-vous que les lignes suivantes
	  sont présentes dans votre fichier de configuration du
	  noyau:</p><pre class="programlisting">device usb
device uhci
device ohci
device uscanner</pre><p>En fonction du contrôleur USB présent sur
	  votre carte mère, vous n'avez besoin que d'une des
	  deux lignes <code class="literal">device uhci</code> et
	  <code class="literal">device ohci</code>, cependant avoir ces deux
	  lignes simultanément dans la configuration du noyau
	  est sans risque.</p><p>Si vous ne désirez pas recompiler votre noyau et
	  que votre noyau n'est pas le <code class="filename">GENERIC</code>,
	  vous pouvez directement charger le module du pilote
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=uscanner&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">uscanner</span>(4)</span></a> à l'aide de la commande
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=kldload&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">kldload</span>(8)</span></a>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>kldload uscanner</code></strong></pre><p>Pour charger ce module à chaque démarrage
	  du système, ajoutez la ligne suivante au fichier
	  <code class="filename">/boot/loader.conf</code>:</p><pre class="programlisting">uscanner_load="YES"</pre><p>Après avoir redémarré avec le bon
	  noyau, ou après avoir chargé le module
	  nécessaire, branchez votre scanner USB.  Une ligne
	  montrant la détection de votre scanner
	  devrait apparaître dans le tampon des messages du
	  système (<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dmesg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dmesg</span>(8)</span></a>):</p><pre class="screen">uscanner0: EPSON EPSON Scanner, rev 1.10/3.02, addr 2</pre><p>Ceci nous indique que notre scanner utilise le fichier
	  spécial de périphérique
	  <code class="filename">/dev/uscanner0</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp72987472"></a>8.6.2.2. Interface SCSI</h4></div></div></div><p>Si votre scanner dispose d'une interface SCSI, il est
	  important de connaître quelle carte contrôleur
	  SCSI vous utiliserez.  En fonction du contrôleur sur
	  la carte, vous devrez adapter votre configuration du noyau.
	  Le noyau <code class="filename">GENERIC</code> supporte les
	  contrôleurs SCSI les plus courants.  Assurez-vous
	  d'avoir lu le fichier <code class="filename">NOTES</code>
	  et ajoutez la
	  ligne adéquate dans votre fichier de configuration du
	  noyau.  En plus du pilote de votre carte SCSI, vous avez
	  besoin des lignes suivantes dans votre fichier de
	  configuration du noyau:</p><pre class="programlisting">device scbus
device pass</pre><p>Une fois que votre noyau a été
	  correctement compilé et installé, vous devriez être en
	  mesure de voir les périphériques au
	  démarrage:</p><pre class="screen">pass2 at aic0 bus 0 target 2 lun 0
pass2: &lt;AGFA SNAPSCAN 600 1.10&gt; Fixed Scanner SCSI-2 device
pass2: 3.300MB/s transfers</pre><p>Si votre scanner n'était pas alimenté au
	  démarrage du système, il est encore possible
	  de forcer sa détection, en en sondant le bus SCSI
	  avec la commande <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=camcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">camcontrol</span>(8)</span></a>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>camcontrol rescan all</code></strong>
Re-scan of bus 0 was successful
Re-scan of bus 1 was successful
Re-scan of bus 2 was successful
Re-scan of bus 3 was successful</pre><p>Ensuite le scanner apparaîtra dans la liste des
	  périphériques SCSI:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>camcontrol devlist</code></strong>
&lt;IBM DDRS-34560 S97B&gt;              at scbus0 target 5 lun 0 (pass0,da0)
&lt;IBM DDRS-34560 S97B&gt;              at scbus0 target 6 lun 0 (pass1,da1)
&lt;AGFA SNAPSCAN 600 1.10&gt;           at scbus1 target 2 lun 0 (pass3)
&lt;PHILIPS CDD3610 CD-R/RW 1.00&gt;     at scbus2 target 0 lun 0 (pass2,cd0)</pre><p>Plus de détails sur les
	  périphériques SCSI sont disponibles dans les
	  pages de manuel <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=scsi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">scsi</span>(4)</span></a> et <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=camcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">camcontrol</span>(8)</span></a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp73000400"></a>8.6.3. Configuration de SANE</h3></div></div></div><p>Le système <span class="application">SANE</span> est
	divisé en deux parties: les
	<span class="quote">« <span class="quote">backend</span> »</span>s (<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sane-backends/pkg-descr">graphics/sane-backends</a>) et les
	<span class="quote">« <span class="quote">frontend</span> »</span>s (<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sane-frontends/pkg-descr">graphics/sane-frontends</a>).  Les
	<span class="quote">« <span class="quote">backend</span> »</span>s fournissent l'accès au scanner.
	La liste des <a class="link" href="http://www.sane-project.org/sane-supported-devices.html" target="_top">périphériques
	supportés</a> par <span class="application">SANE</span>
	indique quel <span class="quote">« <span class="quote">backend</span> »</span> supportera votre scanner.
	Il est indispensable de déterminer correctement le
	<span class="quote">« <span class="quote">backend</span> »</span> relatif à votre scanner si vous
	voulez être en mesure d'utiliser votre
	périphérique.  La partie
	<span class="quote">« <span class="quote">frontend</span> »</span>s fournie l'interface graphique de
	numérisation
	(<span class="application">xscanimage</span>).</p><p>La première étape est d'installer le
	logiciel porté <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sane-backends/pkg-descr">graphics/sane-backends</a> ou sa version
	pré-compilée.  Ensuite, utilisez la commande
	<code class="command">sane-find-scanner</code> pour contrôler la
	détection du scanner par l'ensemble
	<span class="application">SANE</span>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sane-find-scanner -q</code></strong>
found SCSI scanner "AGFA SNAPSCAN 600 1.10" at /dev/pass3</pre><p>Le résultat de la commande affichera le type
	d'interface utilisée par le scanner et le fichier
	spécial de périphérique utilisé
	pour attacher le scanner au système.  Le fabricant et
	le modèle peuvent ne pas apparaître, cela n'est
	pas important.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Certains scanners USB requièrent le chargement
	  préalable d'un <span class="quote">« <span class="quote">firmware</span> »</span>, cela est
	  expliqué dans la page de manuel du
	  <span class="quote">« <span class="quote">backend</span> »</span> utilisé.  Vous devriez
	  également consulter les pages de manuel de
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sane-find-scanner&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">sane-find-scanner</span>(1)</span></a> et <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sane&amp;sektion=7"><span class="citerefentry"><span class="refentrytitle">sane</span>(7)</span></a>.</p></div><p>Nous devons maintenant vérifier si le scanner sera
	identifié par un <span class="quote">« <span class="quote">frontend</span> »</span> de
	numérisation.  Par défaut, les
	<span class="quote">« <span class="quote">backend</span> »</span>s <span class="application">SANE</span> sont
	fournies avec un outil en ligne de commande appelé
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=scanimage&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">scanimage</span>(1)</span></a>.  Cette commande vous permet de lister les
	périphériques et d'effectuer une acquisition
	d'image à partir de la ligne de commande.  L'option
	<code class="option">-L</code> est employée pour afficher les
	scanners présents sur le système:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>scanimage -L</code></strong>
device `snapscan:/dev/pass3' is a AGFA SNAPSCAN 600 flatbed scanner</pre><p>Aucun résultat, ou un message disant qu'aucun
	scanner n'a été identifié indiquent que
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=scanimage&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">scanimage</span>(1)</span></a> est incapable d'identifier le scanner.  Si
	cela se produit, vous devrez éditer le fichier de
	configuration du <span class="quote">« <span class="quote">backend</span> »</span> du scanner et
	définir le type de scanner utilisé.  Le
	répertoire <code class="filename">/usr/local/etc/sane.d/</code> contient
	tous les fichiers de configurations des
	<span class="quote">« <span class="quote">backend</span> »</span>s.  Ce problème d'identification
	apparaît essentiellement avec certains scanners
	USB.</p><p>Par exemple, avec le scanner USB utilisé dans la
	<a class="xref" href="scanners.html#scanners-kernel-usb" title="8.6.2.1. Interface USB">Section 8.6.2.1, « Interface USB »</a>,
	<code class="command">sane-find-scanner</code> nous donne l'information
	suivante:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sane-find-scanner -q</code></strong>
found USB scanner (UNKNOWN vendor and product) at device /dev/uscanner0</pre><p>Le scanner est correctement détecté, il
	utilise l'interface USB et est attaché au fichier
	spécial de périphérique
	<code class="filename">/dev/uscanner0</code>.  Nous pouvons maintenant
	vérifier si le scanner est correctement
	identifié:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>scanimage -L</code></strong>

No scanners were identified. If you were expecting something different,
check that the scanner is plugged in, turned on and detected by the
sane-find-scanner tool (if appropriate). Please read the documentation
which came with this software (README, FAQ, manpages).</pre><p>Comme le scanner n'est pas identifié, nous devons
	éditer le fichier
	<code class="filename">/usr/local/etc/sane.d/epson.conf</code>.  Le
	scanner utilisé était un <span class="trademark">EPSON
  Perfection</span>®
	1650, nous en déduisons donc que ce scanner utilisera
	le <span class="quote">« <span class="quote">backend</span> »</span> <code class="literal">epson</code>.
	Assurez-vous de bien lire les commentaires d'aide
	présents dans les fichiers de configuration des
	<span class="quote">« <span class="quote">backend</span> »</span>s.  Les modifications à faire
	sont relativement simples: commentez toutes les lignes
	concernant une interface différente de celle
	utilisée par votre scanner (dans notre cas, nous
	commenterons toutes les lignes débutant par le mot
	<code class="literal">scsi</code> étant donné que notre
	scanner utilise une interface USB), ajoutez ensuite à
	la fin du fichier une ligne indiquant l'interface et le
	fichier spécial de périphérique
	utilisé.  Dans ce cas, nous ajoutons la ligne
	suivante:</p><pre class="programlisting">usb /dev/uscanner0</pre><p>Veuillez vous assurer de bien lire les commentaires
	fournis dans les fichiers de configurations des
	<span class="quote">« <span class="quote">backend</span> »</span>s ainsi que les pages de manuel
	correspondantes pour plus de détails concernant la
	syntaxe correcte à utiliser.  Nous pouvons maintenant
	vérifier si le scanner est identifié:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>scanimage -L</code></strong>
device `epson:/dev/uscanner0' is a Epson GT-8200 flatbed scanner</pre><p>Notre scanner a été identifié.  Ce
	n'est pas important si la marque et le modèle ne
	correspondent pas au scanner.  L'important est le champ
	<code class="literal">`epson:/dev/uscanner0'</code>, qui nous donne le
	<span class="quote">« <span class="quote">backend</span> »</span> et le fichier spécial de
	périphérique corrects.</p><p>Une fois que la commande <code class="command">scanimage -L</code>
	est en mesure d'identifier le scanner, la configuration est
	terminée.  Le périphérique est prêt
	à effectuer sa première
	numérisation.</p><p>Bien que <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=scanimage&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">scanimage</span>(1)</span></a> permette d'effectuer une
	numérisation à partir de la ligne de commande,
	il est préférable d'utiliser une interface
	graphique.  <span class="application">SANE</span> offre une
	interface graphique simple mais efficace:
	<span class="application">xscanimage</span> (<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/sane-frontends/pkg-descr">graphics/sane-frontends</a>).</p><p><span class="application">Xsane</span> (<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/graphics/xsane/pkg-descr">graphics/xsane</a>) est une autre
	interface graphique de numérisation assez populaire.
	Ce programme offre des fonctions avancées comme
	différents mode de numérisation (photocopie,
	fax, etc.), la correction des couleurs, la numérisation
	par lots, etc.  Ces deux applications sont utilisables comme
	greffon pour <span class="application">GIMP</span>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp73100112"></a>8.6.4. Donner l'accès au scanner aux autres
	utilisateurs</h3></div></div></div><p>Toutes les opérations précédentes ont
	été effectuées avec les privilèges
	<code class="systemitem">root</code>.  Vous pourrez, cependant, avoir
	besoin que d'autres utilisateurs puissent accéder au
	scanner.  L'utilisateur devra avoir les permissions de lecture
	et d'écriture sur le fichier spécial de
	périphérique <code class="filename">/dev/uscanner0</code>
	dont le propriétaire est le groupe
	<code class="systemitem">operator</code>.  L'ajout de l'utilisateur
	<code class="systemitem">joe</code> au groupe
	<code class="systemitem">operator</code> lui autorisera l'accès
	au scanner:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>pw groupmod operator -m joe</code></strong></pre><p>Pour plus de détails, consultez la page de manuel
	de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pw&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">pw</span>(8)</span></a>.  Vous devez également fixer les
	permissions d'écriture correctes (0660 or 0664) sur le
	fichier spécial de périphérique
	<code class="filename">/dev/uscanner0</code>, par défaut le
	groupe <code class="systemitem">operator</code> n'a qu'un accès
	en lecture.  Cela se fait en ajoutant les lignes suivantes au
	fichier <code class="filename">/etc/devfs.rules</code>:</p><pre class="programlisting">[system=5]
add path uscanner0 mode 660</pre><p>Ajoutez ensuite ce qui suit au fichier
	<code class="filename">/etc/rc.conf</code> et redémarrez la
	machine:</p><pre class="programlisting">devfs_system_ruleset="system"</pre><p>Plus d'information concernant ces lignes peut être
	trouvée dans la page de manuel <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">devfs</span>(8)</span></a>.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Bien sûr, pour des raisons de
	  sécurité, vous devriez réfléchir
	  à deux fois avant d'ajouter un utilisateur à
	  n'importe quel groupe, tout particulièrement au groupe
	  <code class="systemitem">operator</code>.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tvcard.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="multimedia.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="kernelconfig.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">8.5. Configuration des cartes TV </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> Chapitre 9. Configurer le noyau de FreeBSD</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>