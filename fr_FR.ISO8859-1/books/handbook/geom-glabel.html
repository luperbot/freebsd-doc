<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>20.6. Ajouter un label à un disque</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="GEOM.html" title="Chapitre 20. GEOM: architecture modulaire de gestion des disques" /><link rel="prev" href="geom-ggate.html" title="20.5. Périphériques réseau « GEOM Gate »" /><link rel="next" href="vinum-vinum.html" title="Chapitre 21. Le gestionnaire de volume Vinum" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">20.6. Ajouter un label à un disque</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="geom-ggate.html">Précédent</a> </td><th width="60%" align="center">Chapitre 20. GEOM: architecture modulaire de gestion des disques</th><td width="20%" align="right"> <a accesskey="n" href="vinum-vinum.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="geom-glabel"></a>20.6. Ajouter un label à un disque</h2></div></div></div><a id="idp81402064" class="indexterm"></a><a id="idp81402832" class="indexterm"></a><p>Lors de l'initialisation du système, le noyau FreeBSD
      créé les fichiers spéciaux de
      périphériques à mesure que les
      périphériques sont détectés.  Cette
      méthode de détection des
      périphériques soulève quelques
      problèmes, par exemple que se passe-t-il si un nouveau
      disque est ajouté par l'intermédiaire de
      l'interface <acronym class="acronym">USB</acronym>?  Il est très probable
      qu'un disque flash se verra proposer le nom de
      périphérique <code class="filename">da0</code> et le
      périphérique original <code class="filename">da0</code>
      déplacé en <code class="filename">da1</code>.  Cela
      sera à l'origine de problèmes de montage des
      systèmes de fichiers s'ils sont listés dans
      <code class="filename">/etc/fstab</code>, en fait cela pourra tout
      simplement empêcher le démarrage du
      système.</p><p>Une solution à ce problème est
      d'<span class="quote">« <span class="quote">enchaîner</span> »</span> les périphériques
      <acronym class="acronym">SCSI</acronym> afin que tout nouveau
      périphérique ajouté sur la carte
      <acronym class="acronym">SCSI</acronym> se voit assigné un numéro
      de périphérique non-utilisé.  Mais qu'en
      est-il des périphériques <acronym class="acronym">USB</acronym>
      qui peuvent remplacer le premier disque <acronym class="acronym">SCSI</acronym>?
      Cela se produit parce que les périphériques
      <acronym class="acronym">USB</acronym> sont en général
      détectés avant la carte <acronym class="acronym">SCSI</acronym>.
      Une solution est de brancher ces périphériques
      qu'après le démarrage du système.  Une
      autre méthode serait de n'utiliser qu'un seul disque
      <acronym class="acronym">ATA</acronym> et de ne jamais lister de
      périphériques <acronym class="acronym">SCSI</acronym> dans le
      fichier <code class="filename">/etc/fstab</code>.</p><p>Une meilleure solution existe.  En employant l'utilitaire
      <code class="command">glabel</code>, un administrateur ou un utilisateur
      peut attribuer un label à chacun de ses disques et
      utiliser ces labels dans <code class="filename">/etc/fstab</code>.  Comme
      <code class="command">glabel</code> conserve le label sur le dernier
      secteur du support concerné, le label persistera
      après redémarrage du système.  En utilisant
      ce label comme un véritable périphérique,
      le système de fichiers pourra toujours être
      monté indépendamment du fichier spécial de
      périphérique utilisé pour y
      accéder.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Cela se fait sans préciser qu'un label sera
	permanent.  L'utilitaire <code class="command">glabel</code> peut
	être utilisé pour créer des labels
	persistants et des labels éphémères.
	Seul le label persistant sera conservé après
	redémarrage du système.  Consultez la page de
	manuel de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=glabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">glabel</span>(8)</span></a> pour plus d'information sur les
	différences entre labels.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81446736"></a>20.6.1. Types et exemples de labels</h3></div></div></div><p>Il existe deux types de label, un label
	générique et un label de système de
	fichiers.  La différence entre les labels est le
	système d'auto-détection associé avec les
	labels permanents, et le fait que ce type de label sera
	persistant après redémarrage du système.
	A ces labels est attribué un sous-répertoire
	spécifique de <code class="filename">/dev</code> dont le nom sera basé
	sur le type de système de fichiers.  Par exemple, les
	labels de systèmes de fichiers <acronym class="acronym">UFS</acronym>2
	seront créés dans le répertoire <code class="filename">/dev/ufs2</code>.</p><p>Un label générique disparaîtra au
	redémarrage suivant.  Ces labels seront
	créés dans le répertoire <code class="filename">/dev/label</code> et sont parfaits pour
	faire des expériences.</p><p>Les labels permanents peuvent être placés sur
	le système de fichiers en utilisant les utilitaires
	<code class="command">tunefs</code> ou <code class="command">newfs</code>.  Pour
	créer un label permanent pour un système de
	fichier <acronym class="acronym">UFS</acronym>2 sans endommager de
	données, utilisez la commande suivante:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>tunefs -L home /dev/da3</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Avertissement: </h3><p xmlns="http://www.w3.org/1999/xhtml">Si le système de fichiers est plein, cette
	  opération pourra entraîner une corruption des
	  données; si le système de fichiers est plein,
	  alors la première chose à faire sera de
	  supprimer les fichiers inutiles et non pas l'ajout de
	  labels.</p></div><p>Un nouveau label devrait désormais apparaître
	dans <code class="filename">/dev/ufs2</code> et
	pourra être ajouté à
	<code class="filename">/etc/fstab</code>:</p><pre class="programlisting">/dev/ufs2/home		/home            ufs     rw              2      2</pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Le système de fichiers ne doit pas être
	  monté lors de l'utilisation de
	  <code class="command">tunefs</code>.</p></div><p>Le système de fichiers peut, maintenant, être
	normalement monté:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /home</code></strong></pre><p>La commande suivante peut être employée pour
	supprimer le label:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>glabel destroy home</code></strong></pre><p>A partir de cet instant, aussi longtemps que le module du
	noyau <code class="filename">geom_label.ko</code> est chargé au
	démarrage avec <code class="filename">/boot/loader.conf</code>
	ou que l'option <code class="literal">GEOM_LABEL</code> est
	présente dans le noyau, le fichier spécial de
	périphérique peut changer sans effet
	négatif pour le système.</p><p>Les systèmes de fichiers peuvent également
	être créés avec un label par défaut
	en utilisant l'option <code class="option">-L</code> avec
	<code class="command">newfs</code>.  Consultez la page de manuel de
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> pour plus d'information.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="geom-ggate.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="GEOM.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="vinum-vinum.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">20.5. Périphériques réseau <span class="quote">« <span class="quote">GEOM
      Gate</span> »</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> Chapitre 21. Le gestionnaire de volume Vinum</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>