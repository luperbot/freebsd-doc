<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>28.7. SMTP avec UUCP</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="mail.html" title="Chapitre 28. Courrier électronique" /><link rel="prev" href="mail-advanced.html" title="28.6. Sujets avancés" /><link rel="next" href="outgoing-only.html" title="28.8. Configuration pour l'envoi seul" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">28.7. SMTP avec UUCP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mail-advanced.html">Précédent</a> </td><th width="60%" align="center">Chapitre 28. Courrier électronique</th><td width="20%" align="right"> <a accesskey="n" href="outgoing-only.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="SMTP-UUCP"></a>28.7. SMTP avec UUCP</h2></div></div></div><p>La configuration de <span class="application">sendmail</span>
      fournie avec FreeBSD est conçue pour les sites directement
      connectés à l'Internet.  Les sites désirant
      échanger leur courrier électronique par
      l'intermédiaire d'UUCP doivent installer un autre fichier
      de configuration pour
      <span class="application">sendmail</span>.</p><p>Modifier manuellement le fichier
      <code class="filename">/etc/mail/sendmail.cf</code> est un sujet
      réservé aux spécialistes.  Dans version 8
      de <span class="application">sendmail</span> la
      génération des fichiers de configuration se fait
      par l'intermédiaire du processeur <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=m4&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">m4</span>(1)</span></a>, où
      la configuration se fait à un haut niveau d'abstraction.
      Les fichiers de configuration <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=m4&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">m4</span>(1)</span></a> se trouvent dans le
      répertoire <code class="filename">/usr/src/usr.sbin/sendmail/cf</code>.</p><p>Si vous n'avez pas installé toutes les sources du
      système, l'ensemble des fichiers de configuration de
      <span class="application">sendmail</span> a été
      regroupé dans une archive séparée des
      autres sources.  En supposant que vous avez monté votre
      CDROM FreeBSD contenant les sources, faites:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /cdrom/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cat scontrib.?? | tar xzf - -C /usr/src/contrib/sendmail</code></strong></pre><p>Cette extraction ne donne lieu qu'à une centaine de
      kilo-octets.  Le fichier <code class="filename">README</code> dans le
      répertoire <code class="filename">cf</code>
      pourra faire office d'une introduction à la configuration
      <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=m4&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">m4</span>(1)</span></a>.</p><p>La meilleure façon d'ajouter le support UUCP est
      d'utiliser la fonctionnalité
      <code class="literal">mailertable</code>.  Cela créé une
      base de données que <span class="application">sendmail</span>
      utilise pour décider de la manière dont il va
      router le courrier électronique.</p><p>Tout d'abord, vous devez créer votre fichier
      <code class="filename">.mc</code>.  Le répertoire <code class="filename">/usr/src/usr.sbin/sendmail/cf/cf</code>
      contient quelques exemples.  En supposant que vous avez
      appelé votre fichier <code class="filename">foo.mc</code>, tout ce
      dont vous avez besoin de faire pour le convertir en un fichier
      <code class="filename">sendmail.cf</code> valide est:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/usr.sbin/sendmail/cf/cf</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make foo.cf</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cp foo.cf /etc/mail/sendmail.cf</code></strong></pre><p>Un fichier <code class="filename">.mc</code> classique devrait
      ressembler à ceci:</p><pre class="programlisting">VERSIONID(`<em class="replaceable"><code>Votre numéro de version</code></em>') OSTYPE(bsd4.4)

FEATURE(accept_unresolvable_domains)
FEATURE(nocanonify)
FEATURE(mailertable, `hash -o /etc/mail/mailertable')

define(`UUCP_RELAY', <em class="replaceable"><code>votre.relai.uucp</code></em>)
define(`UUCP_MAX_SIZE', 200000)
define(`confDONT_PROBE_INTERFACES')

MAILER(local)
MAILER(smtp)
MAILER(uucp)

Cw    <em class="replaceable"><code>alias.de.votre.nom.de.machine</code></em>
Cw    <em class="replaceable"><code>votrenomdenoeuduucp.UUCP</code></em></pre><p>Les lignes contenant les directives
      <code class="literal">accept_unresolvable_domains</code>,
      <code class="literal">nocanonify</code>, et
      <code class="literal">confDONT_PROBE_INTERFACES</code> empêcheront
      l'utilisation du DNS lors de l'envoi du courrier
      électronique.  La directive <code class="literal">UUCP_RELAY</code>
      est nécessaire pour le support de l'UUCP.  Mettez juste
      un nom de machine Internet capable de gérer des adresses
      d'un pseudo-domaine .UUCP; la plupart du temps, vous mettrez le
      nom du serveur de messagerie de votre fournisseur
      d'accès.</p><p>Après avoir défini tout ceci, vous avez besoin
      d'un fichier <code class="filename">/etc/mail/mailertable</code>.  Si
      vous n'avez qu'un seul lien avec l'extérieur qui est
      utilisé pour votre courrier électronique, le
      fichier suivant devrait suffire:</p><pre class="programlisting">#
# makemap hash /etc/mail/mailertable.db &lt; /etc/mail/mailertable
.                             uucp-dom:<em class="replaceable"><code>your.uucp.relay</code></em></pre><p>Un exemple plus complexe ressemblerait à ceci:</p><pre class="programlisting">#
# makemap hash /etc/mail/mailertable.db &lt; /etc/mail/mailertable
#
horus.interface-business.de   uucp-dom:horus
.interface-business.de        uucp-dom:if-bus
interface-business.de         uucp-dom:if-bus
.heep.sax.de                  smtp8:%1
horus.UUCP                    uucp-dom:horus
if-bus.UUCP                   uucp-dom:if-bus
.                             uucp-dom:</pre><p>Les trois premières lignes gèrent les cas
      spécifiques où les courriers électroniques
      pour l'extérieur ne devraient pas être
      envoyés au serveur par défaut, mais plutôt
      à des serveurs UUCP voisins afin de
      &#8220;raccourcir&#8221; le chemin à parcourir.  La ligne
      suivante gère le courrier électronique
      destiné au domaine Ethernet local et qui peut être
      distribué en utilisant le protocole SMTP.  Et enfin, les
      voisins UUCP sont mentionnés dans la notation de
      pseudo-domaine UUCP, pour permettre à un courrier du type
      <code class="literal">voisin-uucp
      !destinataire</code>
      de passer outre les règles par défaut.  La
      dernière ligne doit toujours être un point, ce qui
      correspond à tout le reste, avec la distribution UUCP
      vers un voisin UUCP qui sert de passerelle universelle de
      courrier électronique vers le reste du monde.  Tous les
      noms de noeuds placés après le mot clé
      <code class="literal">uucp-dom:</code> doivent être des noms valides
      de voisins UUCP, que vous pouvez vérifier en utilisant la
      commande <code class="literal">uuname</code>.</p><p>Pour vous rappeler que ce fichier doit être converti
      en un fichier de base de données DBM avant d'être
      utilisable.  La ligne de commande pour accomplir cette
      conversion est rappelée dans les commentaires au
      début du fichier <code class="filename">mailertable</code>.  Vous
      devez lancer cette commande à chaque fois que vous
      modifiez votre fichier
      <code class="filename">mailertable</code>.</p><p>Pour finir: si vous n'êtes pas certain du bon
      fonctionnement de certaines configurations de routage du
      courrier électronique, rappelez-vous de l'option
      <code class="option">-bt</code> de <span class="application">sendmail</span>.
      Cela lance <span class="application">sendmail</span> dans le
      <span class="emphasis"><em>mode test d'adresse</em></span>; entrez simplement
      <code class="literal">3,0</code>, suivi de l'adresse que vous
      désirez tester.  La dernière ligne vous indiquera
      le type d'agent utilisé pour l'envoi, la machine de
      destination à laquelle l'agent doit envoyer le message,
      et l'adresse (peut-être traduite) à laquelle il
      l'enverra.  Pour quitter ce mode tapez <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>D</strong></span>.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>sendmail -bt</code></strong>
ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)
Enter &lt;ruleset&gt; &lt;address&gt;
<code class="prompt">&gt;</code> <strong class="userinput"><code>3,0 foo@example.com</code></strong>
canonify           input: foo @ example . com
...
parse            returns: $# uucp-dom $@ <em class="replaceable"><code>your.uucp.relay</code></em> $: foo &lt; @ example . com . &gt;
<code class="prompt">&gt;</code> <strong class="userinput"><code>^D</code></strong></pre></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail-advanced.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="outgoing-only.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">28.6. Sujets avancés </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 28.8. Configuration pour l'envoi seul</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>