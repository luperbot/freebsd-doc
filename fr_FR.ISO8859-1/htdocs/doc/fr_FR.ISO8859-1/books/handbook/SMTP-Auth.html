<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>28.10. Authentification SMTP</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Manuel FreeBSD" /><link rel="up" href="mail.html" title="Chapitre 28. Courrier électronique" /><link rel="prev" href="SMTP-dialup.html" title="28.9. Utiliser le courrier électronique avec une connexion temporaire" /><link rel="next" href="mail-agents.html" title="28.11. Clients de messagerie" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">28.10. Authentification SMTP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="SMTP-dialup.html">Précédent</a> </td><th width="60%" align="center">Chapitre 28. Courrier électronique</th><td width="20%" align="right"> <a accesskey="n" href="mail-agents.html">Suivant</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="SMTP-Auth"></a>28.10. Authentification SMTP</h2></div><div><span class="authorgroup">Ecrit par <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">James</span> <span class="surname">Gorham</span></span>. </span></div></div></div><p>Disposer de l'authentification <acronym class="acronym">SMTP</acronym>
      sur votre serveur de courrier présente un certain
      nombre d'avantages.  L'authentification <acronym class="acronym">SMTP</acronym>
      peut ajouter une autre couche de sécurité à
      <span class="application">sendmail</span>, et a l'avantage
      de donner aux utilisateurs mobiles la possibilité
      d'utiliser le même serveur de courrier sans avoir
      besoin de reconfigurer les paramètres de leur client
      courrier à chaque déplacement.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Installez <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/cyrus-sasl/pkg-descr">security/cyrus-sasl</a> à
	  partir du catalogue des logiciels portés.  Vous
	  pouvez trouver ce logiciel porté dans
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/cyrus-sasl/pkg-descr">security/cyrus-sasl</a>.
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/cyrus-sasl/pkg-descr">security/cyrus-sasl</a>
	  dispose de nombreuses options de compilation possibles,
	  pour la méthode que nous allons utiliser ici,
	  assurez-vous de sélectionner l'option
	  <code class="option">pwcheck</code>.</p></li><li class="step"><p>Après avoir installé
	  <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/cyrus-sasl/pkg-descr">security/cyrus-sasl</a>,
	  éditez
	  <code class="filename">/usr/local/lib/sasl/Sendmail.conf</code>
	  (ou créez-le s'il n'existe pas) et ajoutez la ligne
	  suivante:</p><pre class="programlisting">pwcheck_method: passwd</pre><p>Cette méthode activera au niveau de
	  <span class="application">sendmail</span> l'authentification par
	  l'intermédiaire de votre base de données
	  FreeBSD <code class="filename">passwd</code>.  Cela nous épargne
	  le problème de la création d'un nouvel ensemble
	  de nom d'utilisateur et de mot de passe pour chaque
	  utilisateur ayant besoin de recourir à
	  l'authentification <acronym class="acronym">SMTP</acronym>, et conserve le
	  même nom d'utilisateur et mot de passe pour le
	  courrier.</p></li><li class="step"><p>Maintenant éditez <code class="filename">/etc/make.conf</code>
	  et ajoutez les lignes suivantes:</p><pre class="programlisting">SENDMAIL_CFLAGS=-I/usr/local/include/sasl1 -DSASL
SENDMAIL_LDFLAGS=-L/usr/local/lib
SENDMAIL_LDADD=-lsasl</pre><p>Ces lignes passeront à
	<span class="application">sendmail</span> les bonnes options de
	configuration au moment de la compilation pour lier
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/cyrus-sasl/pkg-descr">cyrus-sasl</a>.
	Assurez-vous que <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/cyrus-sasl/pkg-descr">cyrus-sasl</a>
	a été installé avant de recompiler
	<span class="application">sendmail</span>.</p></li><li class="step"><p>Recompilez <span class="application">sendmail</span> en
	  lançant les commandes suivantes:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/usr.sbin/sendmail</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make cleandir</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make obj</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make install</code></strong></pre><p>La compilation de <span class="application">sendmail</span>
	  ne devrait pas présenter de problèmes si le
	  répertoire <code class="filename">/usr/src</code> n'a pas subi
	  d'énormes changements et si les bibliothèques
	  partagés nécessaires sont disponibles.</p></li><li class="step"><p>Une fois que <span class="application">sendmail</span> a
	  été compilé et réinstallé,
	  éditez votre fichier <code class="filename">/etc/mail/freebsd.mc</code>
	  (ou tout autre fichier que vous utilisez comme fichier
	  <code class="filename">.mc</code>.  De nombreux administrateurs
	  utilisent la sortie de <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=hostname&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">hostname</span>(1)</span></a> comme nom de fichier
	  <code class="filename">.mc</code> par unicité).  Ajoutez-y les
	  lignes qui suivents:</p><pre class="programlisting">dnl set SASL options
TRUST_AUTH_MECH(`GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl
define(`confAUTH_MECHANISMS', `GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl
define(`confDEF_AUTH_INFO', `/etc/mail/auth-info')dnl</pre><p>Ces options configurent les différentes méthodes
	  disponibles pour <span class="application">sendmail</span>
	  pour l'authentification des utilisateurs.  Si vous
	  désirez utiliser une méthode autre que
	  <span class="application">pwcheck</span>, veuillez consulter
	  la documentation fournie.</p></li><li class="step"><p>Enfin, exécutez <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> quand vous êtes
	  dans <code class="filename">/etc/mail</code>.  Cela prendra votre
	  nouveau fichier <code class="filename">.mc</code> et créera un
	  fichier <code class="filename">.cf</code> appelé
	  <code class="filename">freebsd.cf</code> (ou selon tout autre nom que
	  vous avez utilisé pour votre fichier
	  <code class="filename">.mc</code>).  Ensuite utilisez la commande
	  <code class="command">make install restart</code>, qui copiera le
	  fichier en <code class="filename">sendmail.cf</code>, et
	  redémarrera proprement
	  <span class="application">sendmail</span>.  Pour plus
	  d'informations sur ce processus, vous devriez vous
	  réferrer au fichier
	  <code class="filename">/etc/mail/Makefile</code>.</p></li></ol></div><p>Si tout s'est bien passé, vous devriez être
      en mesure d'entrer votre identifiant dans votre programme
      de courrier et d'envoyer un message de test.  Pour plus
      d'investigation, fixez le <code class="option">LogLevel</code> de
      <span class="application">sendmail</span> à 13 et scrutez
      <code class="filename">/var/log/maillog</code> à la recherche
      d'une erreur.</p><p>Vous pourrez rajouter les lignes suivantes au fichier
      <code class="filename">/etc/rc.conf</code> afin de rendre ce service
      disponible après chaque démarrage du
      système:</p><pre class="programlisting">sasl_pwcheck_enable="YES"
sasl_pwcheck_program="/usr/local/sbin/pwcheck"</pre><p>Cela assurera l'initialisation de
      <acronym class="acronym">SMTP_AUTH</acronym>, l'authentification SMTP, au
      démarrage du système.</p><p>Pour plus d'informations, veuillez consulter la page de la
      documentation de <span class="application">sendmail</span> concernant
      <a class="link" href="http://www.sendmail.org/~ca/email/auth.html" target="_top">
      l'authentification <acronym class="acronym">SMTP</acronym></a>.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="SMTP-dialup.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="mail.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="mail-agents.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">28.9. Utiliser le courrier électronique avec une connexion
      temporaire </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 28.11. Clients de messagerie</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Ce document, ainsi que d'autres peut être téléchargé sur
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a></small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Pour toutes questions à propos de FreeBSD, lisez la
    <a href="http://www.FreeBSD.org/docs.html">documentation</a> avant de contacter
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    Pour les questions sur cette documentation, contactez
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>