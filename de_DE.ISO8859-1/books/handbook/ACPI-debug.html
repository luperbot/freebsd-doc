<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>12.17. ACPI-Fehlersuche</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="config-tuning.html" title="Kapitel 12. Konfiguration und Tuning" /><link rel="prev" href="acpi-overview.html" title="12.16. Energie- und Ressourcenverwaltung" /><link rel="next" href="boot.html" title="Kapitel 13. FreeBSDs Bootvorgang" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">12.17. <acronym class="acronym">ACPI</acronym>-Fehlersuche</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="acpi-overview.html">Zurück</a> </td><th width="60%" align="center">Kapitel 12. Konfiguration und Tuning</th><td width="20%" align="right"> <a accesskey="n" href="boot.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="ACPI-debug"></a>12.17. <acronym class="acronym">ACPI</acronym>-Fehlersuche</h2></div><div><span class="authorgroup">Verfasst von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Nate</span> <span class="surname">Lawson</span></span>. </span></div><div><span class="authorgroup">Mit Beiträgen von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Peter</span> <span class="surname">Schultz</span></span> und <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><a id="idp77052880" class="indexterm"></a><p><acronym class="acronym">ACPI</acronym> ist ein gänzlich neuer
      Weg, um Geräte aufzufinden und deren Stromverbrauch
      zu regulieren.  Weiterhin bietet <acronym class="acronym">ACPI</acronym>
      einen einheitlichen Zugriff auf Geräte, die vorher
      vom <acronym class="acronym">BIOS</acronym> verwaltet wurden.  Es werden
      zwar Fortschritte gemacht, dass <acronym class="acronym">ACPI</acronym>
      auf allen Systemen läuft, doch tauchen immer wieder
      Fehler auf:  fehlerhafter Bytecode der
      <acronym class="acronym">ACPI</acronym>-Machine-Language
      (<acronym class="acronym">AML</acronym>) einiger Systemplatinen,
      ein unvollständiges FreeBSD-Kernel-Subsystem oder
      Fehler im <acronym class="acronym">ACPI-CA</acronym>-Interpreter
      von <span class="trademark">Intel</span>®.</p><p>Dieser Abschnitt hilft Ihnen, zusammen mit den Betreuern
      des FreeBSD-<acronym class="acronym">ACPI</acronym>-Subsystems, Fehlerquellen
      zu finden und Fehler zu beseitigen.  Danke, dass Sie diesen
      Abschnitt lesen; hoffentlich hilft er, Ihre Systemprobleme
      zu lösen.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ACPI-submitdebug"></a>12.17.1. Fehlerberichte einreichen</h3></div></div></div><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Bevor Sie einen Fehlerbericht einreichen, stellen
	  Sie bitte sicher, dass Ihr <acronym class="acronym">BIOS</acronym>
	  und die Firmware Ihres Controllers aktuell sind.</p></div><p>Wenn Sie sofort einen Fehlerbericht einsenden wollen,
	schicken Sie bitte die folgenden Informationen an
	die Mailingliste <a class="link" href="mailto:freebsd-acpi@FreeBSD.org" target="_top">freebsd-acpi</a>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Beschreiben Sie den Fehler und alle Umstände,
	    unter denen der Fehler auftritt.  Geben Sie
	    ebenfalls den Typ und das Modell Ihres Systems
	    an.  Wenn Sie einen neuen Fehler entdeckt haben,
	    versuchen Sie möglichst genau zu beschreiben,
	    wann der Fehler das erste Mal aufgetreten ist.</p></li><li class="listitem"><p>Die Ausgabe von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dmesg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dmesg</span>(8)</span></a> nach der Eingabe
	    von <code class="command">boot -v</code>.
	    Geben Sie auch alle Fehlermeldungen an, die erscheinen,
	    wenn Sie den Fehler provozieren.</p></li><li class="listitem"><p>Die Ausgabe von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dmesg&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dmesg</span>(8)</span></a> nach der Eingabe
	    von <code class="command">boot -v</code> und mit deaktiviertem
	    <acronym class="acronym">ACPI</acronym>, wenn das Problem ohne
	    <acronym class="acronym">ACPI</acronym> nicht auftritt.</p></li><li class="listitem"><p>Die Ausgabe von <code class="command">sysctl hw.acpi</code>.
	    Dieses Kommando zeigt die vom System unterstützten
	    <acronym class="acronym">ACPI</acronym>-Funktionen an.</p></li><li class="listitem"><p>Die <acronym class="acronym">URL</acronym>, unter der die
	    <acronym class="acronym">ACPI</acronym>-Source-Language
	    (<acronym class="acronym">ASL</acronym>) liegt.  Schicken Sie
	    bitte <span class="emphasis"><em>nicht</em></span> die
	    <acronym class="acronym">ASL</acronym> an die Mailingliste, da die
	    <acronym class="acronym">ASL</acronym> sehr groß sein kann.  Eine Kopie
	    der <acronym class="acronym">ASL</acronym> erstellen Sie mit dem
	    nachstehenden Befehl:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>acpidump -td &gt; name-system.asl</code></strong></pre><p>Setzen Sie bitte für <em class="replaceable"><code>name</code></em>
	    den Namen Ihres Kontos und für
	    <em class="replaceable"><code>system</code></em> den Hersteller und
	    das Modell Ihres Systems ein.  Zum Beispiel:
	    <code class="filename">njl-FooCo6000.asl</code>.</p></li></ul></div><p>Obwohl die meisten Entwickler die Mailingliste
	<a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-current" target="_top">freebsd-current</a> lesen, sollten Sie Fehlerberichte an
	die Liste <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-acpi" target="_top">freebsd-acpi</a> schicken.  Seien Sie bitte
	geduldig;  wir haben alle Arbeit außerhalb des Projekts.
	Wenn der Fehler nicht offensichtlich ist, bitten
	wir Sie vielleicht, einen offiziellen Fehlerbericht
	(<acronym class="acronym">PR</acronym>) mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=send-pr&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">send-pr</span>(1)</span></a> einzusenden.
	Geben Sie im Fehlerbericht bitte dieselben Informationen
	wie oben an.  Mithilfe der <acronym class="acronym">PR</acronym>s
	verfolgen und lösen wir Probleme.  Senden Sie
	bitte keinen <acronym class="acronym">PR</acronym> ein, ohne vorher
	den Fehlerbericht an die Liste <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-acpi" target="_top">freebsd-acpi</a> zu senden.
	Wir benutzen die <acronym class="acronym">PR</acronym>s als Erinnerung
	an bestehende Probleme und nicht zum Sammeln aller
	Probleme.  Es kann sein, dass der Fehler schon von
	jemand anderem gemeldet wurde.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ACPI-background"></a>12.17.2. <acronym class="acronym">ACPI</acronym>-Grundlagen</h3></div></div></div><a id="idp77096656" class="indexterm"></a><p><acronym class="acronym">ACPI</acronym> gibt es in allen modernen Rechnern
	der ia32- (x86), ia64- (Itanium) und amd64- (AMD) Architektur.
	Der vollständige Standard bietet Funktionen zur Steuerung und
	Verwaltung der <acronym class="acronym">CPU</acronym>-Leistung, der
	Stromversorgung, von Wärmebereichen, Batterien, eingebetteten
	Controllern und Bussen.  Auf den meisten Systemen wird nicht
	der vollständige Standard implementiert.  Arbeitsplatzrechner
	besitzen meist nur Funktionen zur Verwaltung der Busse,
	während Notebooks Funktionen zur Temperaturkontrolle und
	Ruhezustände besitzen.</p><p>Ein <acronym class="acronym">ACPI</acronym> konformes System besitzt
	verschiedene Komponenten.  Die <acronym class="acronym">BIOS</acronym>- und
	Chipsatz-Hersteller stellen mehrere statische Tabellen bereit
	(zum Beispiel die
	Fixed-<acronym class="acronym">ACPI</acronym>-Description-Table,
	<acronym class="acronym">FADT</acronym>).  Die Tabellen enthalten
	beispielsweise die mit <acronym class="acronym">SMP</acronym>-Systemen
	benutzte <acronym class="acronym">APIC</acronym>-Map, Konfigurationsregister
	und einfache Konfigurationen.  Zusätzlich gibt es die
	Differentiated-System-Description-Table
	(<acronym class="acronym">DSDT</acronym>), die Bytecode enthält.  Die Tabelle
	ordnet Geräte und Methoden in einem baumartigen Namensraum
	an.</p><p>Ein <acronym class="acronym">ACPI</acronym>-Treiber muss die statischen
	Tabellen einlesen, einen Interpreter für den Bytecode
	bereitstellen und die Gerätetreiber im Kernel so
	modifizieren, dass sie mit dem
	<acronym class="acronym">ACPI</acronym>-Subsystem kommunizieren.  Für FreeBSD,
	Linux und NetBSD hat <span class="trademark">Intel</span>® den Interpreter
	<acronym class="acronym">ACPI-CA</acronym>, zur Verfügung gestellt.  Der
	Quelltext zu <acronym class="acronym">ACPI-CA</acronym> befindet sich im
	Verzeichnis <code class="filename">src/sys/contrib/dev/acpica</code>.
	Die Schnittstelle von <acronym class="acronym">ACPI-CA</acronym> zu FreeBSD
	befindet sich unter
	<code class="filename">src/sys/dev/acpica/Osd</code>.  Treiber, die
	verschiedene <acronym class="acronym">ACPI</acronym>-Geräte implementieren,
	befinden sich im Verzeichnis
	<code class="filename">src/sys/dev/acpica</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ACPI-comprob"></a>12.17.3. Häufige Probleme</h3></div></div></div><a id="idp77123536" class="indexterm"></a><p>Damit <acronym class="acronym">ACPI</acronym> richtig funktioniert,
	müssen alle Teile funktionieren.  Im Folgenden
	finden Sie eine Liste mit Problemen und möglichen
	Umgehungen oder Fehlerbehebungen.  Die Liste ist nach
	der Häufigkeit, mit der die Probleme auftreten,
	sortiert.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77125456"></a>12.17.3.1. Mausprobleme</h4></div></div></div><p>Es kann vorkommen, dass die Maus nicht mehr
	  funktioniert, wenn Sie nach einem Suspend weiterarbeiten
	  wollen.  Ist dies bei Ihnen der Fall, reicht es meistens
	  aus, den Eintrag
	  <code class="literal">hint.psm.0.flags="0x3000"</code> in
	  <code class="filename">/boot/loader.conf</code> aufzunehmen.  Besteht
	  das Problem weiterhin, sollten Sie einen Fehlerbericht
	  an das FreeBSD Project senden.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77127504"></a>12.17.3.2. Suspend/Resume</h4></div></div></div><p><acronym class="acronym">ACPI</acronym> kennt drei
	  Suspend-to-<acronym class="acronym">RAM</acronym>-Zustände
	  (<acronym class="acronym">STR</acronym>):
	  <code class="literal">S1</code>-<code class="literal">S3</code>.
	  Es gibt einen Suspend-to-Disk-Zustand:
	  <code class="literal">S4</code>.  Der Zustand <code class="literal">S5</code>
	  wird Soft-Off genannt.  In diesem Zustand befindet
	  sich ein Rechner, wenn die Stromversorgung angeschlossen
	  ist, der Rechner aber nicht hochgefahren ist.  Der
	  Zustand <code class="literal">S4</code> kann auf zwei Arten
	  implementiert werden:
	  <code class="literal">S4</code><acronym class="acronym">BIOS</acronym> und
	  <code class="literal">S4</code><acronym class="acronym">OS</acronym>.
	  Im ersten Fall wird der Suspend-to-Disk-Zustand durch
	  das <acronym class="acronym">BIOS</acronym> hergestellt im zweiten
	  Fall alleine durch das Betriebssystem.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Die Suspend-Zustände sind Ruhezustände,
	    in denen der Rechner weniger Energie als im
	    Normalbetrieb benötigt.  Resume bezeichnet
	    die Rückkehr zum Normalbetrieb.</p></div><p>Die Suspend-Zustände können Sie mit
	  dem Kommando <code class="command">sysctl hw.acpi</code>
	  ermitteln.  Das Folgende könnte beispielsweise
	  ausgegeben werden:</p><pre class="screen">hw.acpi.supported_sleep_state: S3 S4 S5
hw.acpi.s4bios: 0</pre><p>Diese Ausgabe besagt, dass mit dem Befehl
	  <code class="command">acpiconf -s</code> die Zustände
	  <code class="literal">S3</code>, <code class="literal">S4</code><acronym class="acronym">OS</acronym>
	  und <code class="literal">S5</code> eingestellt werden können.
	  Hätte <code class="option">s4bios</code> den Wert
	  <code class="literal">1</code>, gäbe es den Zustand
	  <code class="literal">S4</code><acronym class="acronym">BIOS</acronym> anstelle
	  von <code class="literal">S4</code><acronym class="acronym">OS</acronym>.</p><p>Wenn Sie die Suspend- und Resume-Funktionen
	  testen, fangen Sie mit dem <code class="literal">S1</code>-Zustand
	  an, wenn er angeboten wird.  Dieser Zustand wird
	  am ehesten funktionieren, da der Zustand wenig
	  Treiber-Unterstützung benötigt.  Der Zustand
	  <code class="literal">S2</code> ist ähnlich wie
	  <code class="literal">S1</code>, allerdings hat ihn noch niemand
	  implementiert.  Als nächstes sollten Sie den
	  Zustand <code class="literal">S3</code> ausprobieren.  Dies
	  ist der tiefste <acronym class="acronym">STR</acronym>-Schlafzustand.
	  Dieser Zustand ist auf massive Treiber-Unterstützung
	  angewiesen, um die Geräte wieder richtig zu
	  initialisieren.  Wenn Sie Probleme mit diesem Zustand
	  haben, können Sie die Mailingliste
	  <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-acpi" target="_top">freebsd-acpi</a> anschreiben.  Erwarten Sie allerdings
	  nicht zu viel:  Es gibt viele Treiber und Geräte,
	  an denen noch gearbeitet und getestet wird.</p><p>Ein häufiges Problem mit Suspend/Resume ist,
	  dass viele Gerätetreiber ihre Firmware, Register
	  und Gerätespeicher nicht korrekt speichern,
	  wiederherstellen und/oder reinitialisieren.  Um dieses
	  Problem zu lösen, sollten Sie zuerst die
	  folgenden Befehle ausführen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysctl debug.bootverbose=1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sysctl debug.acpi.suspend_bounce=1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>acpiconf -s 3</code></strong></pre><p>Dieser Test emuliert einen Suspend/Resume-Zyklus für
	  alle Geräte (ohne dass diese dabei wirklich in den Status
	  <code class="literal">S3</code> wechseln).  In vielen Fällen
	  reicht dies bereits aus, um Probleme (beispielsweise
	  verlorener Firmware-Status, Timeouts, hängende Geräte)
	  zu entdecken.  Beachten Sie dabei, dass das Gerät bei
	  diesem Test nicht wirklich in den Status
	  <code class="literal">S3</code> wechseln.  Es kann also vorkommen,
	  dass manche Geräte weiterhin mit Strom versorgt werden (dies
	  wäre bei einem wirklichen Wechsel in den Status
	  <code class="literal">S3</code> NICHT möglich.
	  Andere Geräte werden normal weiterarbeiten, weil sie
	  über keine Suspend/Resume-Funktionen verfügen.</p><p>Schwierigere Fälle können den Einsatz
	  zusätzlicher Hardware (beispielsweise serielle
	  Ports/Kabel für die Verbindung über eine
	  serielle Konsole oder Firewire-Ports/Kabel für
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dcons&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">dcons</span>(4)</span></a>) sowie Kenntnisse im Bereich
	  Kerneldebugging erforderlich machen.</p><p>Um das Problem einzugrenzen, entfernen Sie soviele
	  Treiber wie möglich aus dem Kernel.  Sie können
	  das Problem isolieren, indem Sie einen Treiber nach
	  dem anderen laden, bis der Fehler wieder auftritt.
	  Typischerweise verursachen binäre Treiber wie
	  <code class="filename">nvidia.ko</code>,  X11-Grafiktreiber und
	  <acronym class="acronym">USB</acronym>-Treiber die meisten Fehler,
	  hingegen laufen Ethernet-Treiber für gewöhnlich
	  sehr zuverlässig.  Wenn ein Treiber
	  zuverlässig geladen und entfernt werden kann,
	  können Sie den Vorgang automatisieren, indem
	  Sie die entsprechenden Kommandos in die Dateien
	  <code class="filename">/etc/rc.suspend</code> und
	  <code class="filename">/etc/rc.resume</code> einfügen.
	  In den Dateien finden Sie ein deaktiviertes Beispiel,
	  das einen Treiber lädt und wieder entfernt.
	  Ist die Bildschirmanzeige bei der Wiederaufnahme
	  des Betriebs gestört, setzen Sie bitte die
	  Variable <code class="option">hw.acpi.reset_video</code> auf
	  <code class="literal">0</code>.  Versuchen Sie auch, die Variable
	  <code class="option">hw.acpi.sleep_delay</code> auf kürzere
	  Zeitspannen zu setzen.</p><p>Die Suspend- und Resume-Funktionen können
	  Sie auch auf einer neuen Linux-Distribution
	  mit <acronym class="acronym">ACPI</acronym> testen.  Wenn es mit
	  Linux funktioniert, liegt das Problem wahrscheinlich
	  bei einem FreeBSD-Treiber.  Es hilft uns, das Problem
	  zu lösen, wenn Sie feststellen können, welcher
	  Treiber das Problem verursacht.  Beachten Sie bitte,
	  dass die <acronym class="acronym">ACPI</acronym>-Entwickler normalerweise
	  keine anderen Treiber pflegen (beispielsweise Sound- oder
	  <acronym class="acronym">ATA</acronym>-Treiber).  Es ist wohl das beste,
	  die Ergebnisse der Fehlersuche an die Mailingliste
	  <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-current" target="_top">freebsd-current</a> und den Entwickler des Treibers
	  zu schicken.  Wenn Ihnen danach ist, versuchen Sie,
	  den Fehler in der Resume-Funktion zu finden, indem
	  Sie einige <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=printf&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">printf</span>(3)</span></a>-Anweisungen in den Code
	  des fehlerhaften Treibers einfügen.</p><p>Schließlich können Sie <acronym class="acronym">ACPI</acronym>
	  noch abschalten und stattdessen <acronym class="acronym">APM</acronym>
	  verwenden.  Wenn die Suspend- und Resume-Funktionen mit
	  <acronym class="acronym">APM</acronym> funktionieren, sollten Sie
	  vielleicht besser <acronym class="acronym">APM</acronym> verwenden
	  (insbesondere mit alter Hardware von vor dem Jahr 2000).
	  Die Hersteller benötigten einige Zeit, um
	  <acronym class="acronym">ACPI</acronym> korrekt zu implementieren, daher
	  gibt es mit älterer Hardware oft
	  <acronym class="acronym">ACPI</acronym>-Probleme.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77177552"></a>12.17.3.3. Temporäre oder permanente Systemhänger</h4></div></div></div><p>Die meisten Systemhänger entstehen durch verlorene
	  Interrupts oder einen Interrupt-Sturm.
	  Probleme werden verursacht durch die Art, in der das
	  <acronym class="acronym">BIOS</acronym> Interrupts vor dem Systemstart
	  konfiguriert, durch eine fehlerhafte
	  <acronym class="acronym">APIC</acronym>-Tabelle und durch die
	  Zustellung des System-Control-Interrupts
	  (<acronym class="acronym">SCI</acronym>).</p><a id="idp77179728" class="indexterm"></a><p>Anhand der Ausgabe des Befehls
	  <code class="command">vmstat -i</code> können Sie verlorene
	  Interrupts von einem Interrupt-Sturm unterscheiden.
	  Untersuchen Sie die Ausgabezeile, die
	  <code class="literal">acpi0</code> enthält.  Ein Interrupt-Sturm liegt
	  vor, wenn der Zähler öfter als ein paar Mal pro Sekunde
	  hochgezählt wird.  Wenn sich das System aufgehangen hat,
	  versuchen Sie mit der Tastenkombination
	  <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>Esc</strong></span> in den Debugger <acronym class="acronym">DDB</acronym>
	  zu gelangen.  Geben Sie dort den Befehl
	  <code class="literal">show interrupts</code> ein.</p><a id="idp77196496" class="indexterm"></a><p>Wenn Sie Interrupt-Probleme haben, ist es vorerst
	  wohl am besten, <acronym class="acronym">APIC</acronym> zu deaktivieren.
	  Tragen Sie dazu die Zeile
	  <code class="literal">hint.apic.0.disabled="1"</code> in
	  <code class="filename">loader.conf</code> ein.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77199312"></a>12.17.3.4. Abstürze (Panics)</h4></div></div></div><p><span class="foreignphrase"><em class="foreignphrase">Panics</em></span> werden so
	  schnell wie möglich behoben;  mit <acronym class="acronym">ACPI</acronym>
	  kommt es aber selten dazu.  Zuerst sollten Sie
	  die Panic reproduzieren und dann versuchen einen
	  <span class="foreignphrase"><em class="foreignphrase">backtrace</em></span> (eine
	  Rückverfolgung der Funktionsaufrufe) zu erstellen.
	  Richten Sie dazu den <acronym class="acronym">DDB</acronym> über
	  die serielle Schnittstelle (siehe
	  <a class="xref" href="serialconsole-setup.html#serialconsole-ddb" title="28.6.5.3. DDB Debugger über die serielle Schnittstelle">Abschnitt 28.6.5.3, &#8222;DDB Debugger über die serielle Schnittstelle&#8220;</a>) oder eine gesonderte
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a>-Partition ein.  In <acronym class="acronym">DDB</acronym>
	  können Sie den <span class="foreignphrase"><em class="foreignphrase">backtrace</em></span>
	  mit dem Kommando <code class="literal">tr</code> erstellen.
	  Falls Sie den <span class="foreignphrase"><em class="foreignphrase">backtrace</em></span>
	  vom Bildschirm abschreiben müssen, schreiben
	  Sie bitte mindestens die fünf ersten und die
	  fünf letzten Zeile der Ausgabe auf.</p><p>Versuchen Sie anschließend, das Problem
	  durch einen Neustart ohne <acronym class="acronym">ACPI</acronym>
	  zu beseitigen.  Wenn das funktioniert hat, können
	  Sie versuchen, das verantwortliche
	  <acronym class="acronym">ACPI</acronym>-Subsystem durch Setzen der
	  Variablen <code class="option">debug.acpi.disable</code>
	  herauszufinden.  Die Hilfeseite <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">acpi</span>(4)</span></a> enthält
	  dazu einige Beispiele.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77247952"></a>12.17.3.5. Nach einem Suspend oder einem Stopp startet
	  das System wieder</h4></div></div></div><p>Setzen Sie zuerst in <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=loader.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">loader.conf</span>(5)</span></a> die Variable
	  <code class="option">hw.acpi.disable_on_poweroff</code> auf
	  <code class="literal">0</code>.  Damit wird verhindert, dass
	  <acronym class="acronym">ACPI</acronym> während des Systemabschlusses
	  die Bearbeitung verschiedener Ereignisse deaktiviert.
	  Auf manchen Systemen muss die Variable den Wert
	  <code class="literal">1</code> besitzen (die Voreinstellung).
	  Normalerweise wird der unerwünschte Neustart
	  des Systems durch Setzen dieser Variablen behoben.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77251536"></a>12.17.3.6. Andere Probleme</h4></div></div></div><p>Wenn Sie weitere Probleme mit <acronym class="acronym">ACPI</acronym>
	  haben (Umgang mit einer Docking-Station, nicht erkannte
	  Geräte), schicken Sie bitte eine Beschreibung an die
	  Mailingliste.  Allerdings kann es sein, dass einige
	  Probleme von noch unvollständigen Teilen des
	  <acronym class="acronym">ACPI</acronym>-Subsystems abhängen und
	  es etwas dauern kann bis diese Teile fertig sind.
	  Seien Sie geduldig und rechnen Sie damit, dass wir
	  Ihnen Fehlerbehebungen zum Testen senden.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ACPI-aslanddump"></a>12.17.4. <acronym class="acronym">ASL</acronym>, <code class="command">acpidump</code> und
	<acronym class="acronym">IASL</acronym></h3></div></div></div><a id="idp77255248" class="indexterm"></a><p>Ein häufiges Problem ist fehlerhafter Bytecode
	des <acronym class="acronym">BIOS</acronym>-Herstellers.  Dies erkennen
	Sie an Kernelmeldungen auf der Konsole wie die
	folgende:</p><pre class="screen">ACPI-1287: *** Error: Method execution failed [\\_SB_.PCI0.LPC0.FIGD._STA] \\
(Node 0xc3f6d160), AE_NOT_FOUND</pre><p>Oft können Sie das Problem dadurch lösen,
	dass Sie eine aktuelle <acronym class="acronym">BIOS</acronym>-Version
	einspielen.  Die meisten Meldungen auf der Konsole sind
	harmlos,  wenn aber beispielsweise der Batteriestatus
	falsch angezeigt wird, können Sie in den
	Meldungen nach Problemen mit der
	<acronym class="acronym">AML</acronym>-Machine-Language
	(<acronym class="acronym">AML</acronym>) suchen.  Der Bytecode der
	<acronym class="acronym">AML</acronym> wird aus der
	<acronym class="acronym">ACPI</acronym>-Source-Language
	(<acronym class="acronym">ASL</acronym>) übersetzt und in einer Tabelle, der
	<acronym class="acronym">DSDT</acronym>, abgelegt.  Eine Kopie der
	<acronym class="acronym">ASL</acronym> können Sie mit dem Befehl
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpidump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">acpidump</span>(8)</span></a> erstellen.  Verwenden Sie mit diesem Befehl
	sowohl die Option <code class="option">-t</code> (die Inhalte der
	statischen Tabellen anzeigen) als auch die Option
	<code class="option">-d</code> (die <acronym class="acronym">AML</acronym> in
	<acronym class="acronym">ASL</acronym> zurückübersetzen).  Ein Beispiel für
	die Syntax finden Sie im Abschnitt
	<a class="link" href="ACPI-debug.html#ACPI-submitdebug" title="12.17.1. Fehlerberichte einreichen">Fehlerberichte einreichen</a>.</p><p>Sie können einfach prüfen, ob sich die
	<acronym class="acronym">ASL</acronym> übersetzen lässt.
	Für gewöhnlich können Sie Warnungen
	während des Übersetzens ignorieren.
	Fehlermeldungen führen normal dazu, dass
	<acronym class="acronym">ACPI</acronym> fehlerhaft arbeitet.  Ihre
	<acronym class="acronym">ASL</acronym> übersetzen Sie mit dem
	nachstehenden Kommando:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>iasl ihre.asl</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ACPI-fixasl"></a>12.17.5. Die <acronym class="acronym">ASL</acronym> reparieren</h3></div></div></div><a id="idp77271888" class="indexterm"></a><p>Auf lange Sicht ist es unser Ziel, dass
	<acronym class="acronym">ACPI</acronym> ohne Eingriffe des Benutzers
	läuft.  Zurzeit entwickeln wir allerdings noch
	Umgehungen für Fehler der <acronym class="acronym">BIOS</acronym>-Hersteller.
	Der <span class="trademark">Microsoft</span>®-Interpreter (<code class="filename">acpi.sys</code>
	und <code class="filename">acpiec.sys</code>) prüft die
	<acronym class="acronym">ASL</acronym> nicht streng gegen den Standard.
	Daher reparieren <acronym class="acronym">BIOS</acronym>-Hersteller,
	die <acronym class="acronym">ACPI</acronym> nur unter <span class="trademark">Windows</span>® testen,
	ihre <acronym class="acronym">ASL</acronym> nicht.  Wir hoffen, dass
	wir das vom Standard abweichende Verhalten des
	<span class="trademark">Microsoft</span>®-Interpreters dokumentieren und in FreeBSD replizieren
	können.  Dadurch müssen Benutzer ihre
	<acronym class="acronym">ASL</acronym> nicht selbst reparieren.
	Sie können Ihre <acronym class="acronym">ASL</acronym> selbst reparieren,
	wenn Sie ein Problem umgehen und uns helfen möchten.
	Senden Sie uns bitte die mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> erstellte Differenz
	zwischen alter und neuer <acronym class="acronym">ASL</acronym>.  Wir
	werden versuchen, den Interpreter <acronym class="acronym">ACPI-CA</acronym>
	zu korrigieren, damit die Fehlerbehebung nicht mehr
	erforderlich ist.</p><a id="idp77280464" class="indexterm"></a><p>Die nachfolgende Liste enthält häufige
	Fehlermeldungen, deren Ursache und eine Beschreibung,
	wie die Fehler korrigiert werden:</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77282000"></a>12.17.5.1. Abhängigkeiten vom Betriebssystem</h4></div></div></div><p>Einige <acronym class="acronym">AML</acronym>s gehen davon aus, dass
	  die Welt ausschließlich aus verschiedenen
	  <span class="trademark">Windows</span>®-Versionen besteht.  FreeBSD kann vorgeben, irgendein
	  Betriebssystem zu sein.  Versuchen Sie das Betriebssystem,
	  das Sie in der <acronym class="acronym">ASL</acronym> finden, in der
	  Datei <code class="filename">/boot/loader.conf</code> anzugeben:
	  <code class="literal">hw.acpi.osname="Windows 2001"</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77285200"></a>12.17.5.2. Fehlende Return-Anweisungen</h4></div></div></div><p>Einige Methoden verzichten auf die vom Standard
	  vorgeschriebene Rückgabe eines Wertes.  Obwohl
	  der Interpreter <acronym class="acronym">ACPI-CA</acronym> dies nicht
	  beheben kann, besitzt FreeBSD die Möglichkeit, den
	  Rückgabewert implizit zu setzen.  Wenn Sie
	  wissen, welcher Wert zurückgegeben werden muss,
	  können Sie die fehlenden Return-Anweisungen
	  selbst einsetzen.  Die Option <code class="option">-f</code>
	  zwingt <code class="command">iasl</code>, die <acronym class="acronym">ASL</acronym>
	  zu übersetzen.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp77292112"></a>12.17.5.3. Überschreiben der vorgegebenen
	  <acronym class="acronym">AML</acronym></h4></div></div></div><p>Nachdem Sie Ihre <acronym class="acronym">ASL</acronym> in der
	  Datei <code class="filename">ihre.asl</code> angepasst haben,
	  übersetzen Sie die <acronym class="acronym">ASL</acronym> wie folgt:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>iasl ihre.asl</code></strong></pre><p>Mit der Option <code class="option">-f</code> erzwingen Sie das
	  Erstellen der <acronym class="acronym">AML</acronym> auch wenn während
	  der Übersetzung Fehler auftreten.  Beachten Sie,
	  dass einige Fehler, wie fehlende Return-Anweisungen,
	  automatisch vom Interpreter umgangen werden.</p><p>In der Voreinstellung erstellt der Befehl
	  <code class="command">iasl</code> die Ausgabedatei
	  <code class="filename">DSDT.aml</code>.  Wenn Sie diese Datei
	  anstelle der fehlerhaften Kopie des <acronym class="acronym">BIOS</acronym>
	  laden wollen, editieren Sie
	  <code class="filename">/boot/loader.conf</code> wie folgt:</p><pre class="programlisting">acpi_dsdt_load="YES"
acpi_dsdt_name="/boot/DSDT.aml"</pre><p>Stellen Sie bitte sicher, dass sich die Datei
	  <code class="filename">DSDT.aml</code> im Verzeichnis
	  <code class="filename">/boot</code> befindet.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ACPI-debugoutput"></a>12.17.6. <acronym class="acronym">ACPI</acronym>-Meldungen zur
	Fehlersuche erzeugen</h3></div></div></div><a id="idp77305552" class="indexterm"></a><a id="idp77306704" class="indexterm"></a><p>Der <acronym class="acronym">ACPI</acronym>-Treiber besitzt
	flexible Möglichkeiten zur Fehlersuche.  Sie
	können sowohl die zu untersuchenden Subsysteme
	als auch die zu erzeugenden Ausgaben festlegen.  Die zu
	untersuchenden Subsysteme werden als so genannte
	<span class="quote">&#8222;<span class="quote">layers</span>&#8220;</span> angegeben.  Die Subsysteme sind in
	<acronym class="acronym">ACPI-CA</acronym>-Komponenten
	(<code class="literal">ACPI_ALL_COMPONENTS</code>) und
	<acronym class="acronym">ACPI</acronym>-Hardware
	(<code class="literal">ACPI_ALL_DRIVERS</code>) aufgeteilt.  Welche
	Meldungen ausgegeben werden, wird über
	<span class="quote">&#8222;<span class="quote">level</span>&#8220;</span> gesteuert.  <span class="quote">&#8222;<span class="quote">level</span>&#8220;</span> reicht
	von <code class="literal">ACPI_LV_ERROR</code> (es werden nur Fehler
	ausgegeben) bis zu <code class="literal">ACPI_LV_VERBOSE</code> (alles
	wird ausgegeben).  <span class="quote">&#8222;<span class="quote">level</span>&#8220;</span> ist eine Bitmaske,
	sodass verschiedene Stufen auf einmal (durch Leerzeichen
	getrennt) angegeben werden können.  Die erzeugte
	Ausgabemenge passt vielleicht nicht in den Konsolenpuffer.
	In diesem Fall sollten Sie die Ausgaben mithilfe einer
	seriellen Konsole sichern.  Die möglichen Werte
	für <span class="quote">&#8222;<span class="quote">layers</span>&#8220;</span> und <span class="quote">&#8222;<span class="quote">level</span>&#8220;</span>
	werden in der Hilfeseite <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">acpi</span>(4)</span></a> beschrieben.</p><p>Die Ausgaben zur Fehlersuche sind in der Voreinstellung
	nicht aktiviert.  Wenn <acronym class="acronym">ACPI</acronym> im Kernel
	enthalten ist, fügen Sie <code class="literal">options ACPI_DEBUG</code>
	zur Kernelkonfigurationsdatei hinzu.  Sie können die
	Ausgaben zur Fehlersuche global aktivieren, indem Sie in der
	Datei <code class="filename">/etc/make.conf</code> die Zeile
	<code class="literal">ACPI_DEBUG=1</code> einfügen.  Das Modul
	<code class="filename">acpi.ko</code> können Sie wie folgt
	neu übersetzen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /sys/modules/acpi/acpi
&amp;&amp; make clean &amp;&amp;
make ACPI_DEBUG=1</code></strong></pre><p>Installieren Sie anschließend
	<code class="filename">acpi.ko</code> im Verzeichnis
	<code class="filename">/boot/kernel</code>.
	In der Datei <code class="filename">loader.conf</code> stellen Sie
	<span class="quote">&#8222;<span class="quote">level</span>&#8220;</span> und <span class="quote">&#8222;<span class="quote">layer</span>&#8220;</span> ein.  Das
	folgende Beispiel aktiviert die Ausgabe von Fehlern für
	alle <acronym class="acronym">ACPI-CA</acronym>-Komponenten und alle
	<acronym class="acronym">ACPI</acronym>-Hardwaretreiber (wie
	<acronym class="acronym">CPU</acronym>, <acronym class="acronym">LID</acronym>):</p><pre class="programlisting">debug.acpi.layer="ACPI_ALL_COMPONENTS ACPI_ALL_DRIVERS"
debug.acpi.level="ACPI_LV_ERROR"</pre><p>Wenn ein Problem durch ein bestimmtes Ereignis,
	beispielsweise den Start nach einem Ruhezustand, hervorgerufen
	wird, können Sie die Einstellungen für
	<span class="quote">&#8222;<span class="quote">level</span>&#8220;</span> und <span class="quote">&#8222;<span class="quote">layer</span>&#8220;</span> auch mit dem
	Kommando <code class="command">sysctl</code> vornehmen.  In diesem
	Fall müssen Sie die Datei <code class="filename">loader.conf</code>
	nicht editieren.  Auf der
	<code class="command">sysctl</code>-Kommandozeile geben Sie dieselben
	Variablennamen wie in <code class="filename">loader.conf</code>
	an.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ACPI-References"></a>12.17.7. ACPI-Informationsquellen</h3></div></div></div><p>Weitere Informationen zu <acronym class="acronym">ACPI</acronym>
	erhalten Sie an den folgenden Stellen:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>die <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-acpi" target="_top">FreeBSD ACPI</a> Mailingliste,</p></li><li class="listitem"><p>die Archive der <acronym class="acronym">ACPI</acronym>-Mailingliste:
	    <code class="uri"><a class="uri" href="http://lists.FreeBSD.org/pipermail/freebsd-acpi/" target="_top">http://lists.FreeBSD.org/pipermail/freebsd-acpi/</a></code>,</p></li><li class="listitem"><p>die alten Archive der <acronym class="acronym">ACPI</acronym>-Mailingliste:
	    <code class="uri"><a class="uri" href="http://home.jp.FreeBSD.org/mail-list/acpi-jp/" target="_top">http://home.jp.FreeBSD.org/mail-list/acpi-jp/</a></code>,</p></li><li class="listitem"><p>die <acronym class="acronym">ACPI</acronym>-Spezifikation (Version 2.0):
	    <code class="uri"><a class="uri" href="http://acpi.info/spec.htm" target="_top">http://acpi.info/spec.htm</a></code>,</p></li><li class="listitem"><p>in den nachstehenden FreeBSD-Hilfeseiten:
	     <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">acpi</span>(4)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi_thermal&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">acpi_thermal</span>(4)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpidump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">acpidump</span>(8)</span></a>,
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=iasl&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">iasl</span>(8)</span></a> und <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=acpidb&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">acpidb</span>(8)</span></a>,</p></li><li class="listitem"><p><a class="link" href="http://www.cpqlinux.com/acpi-howto.html#fix_broken_dsdt" target="_top">
	    <acronym class="acronym">DSDT</acronym> debugging resource</a>
	    (als Beispiel wird Compaq erläutert, die
	    Ressource ist aber dennoch nützlich).</p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="acpi-overview.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="config-tuning.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="boot.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">12.16. Energie- und Ressourcenverwaltung </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> Kapitel 13. FreeBSDs Bootvorgang</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>