<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>19.15. Dateisystem-Quotas</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="disks.html" title="Kapitel 19. Speichermedien" /><link rel="prev" href="snapshots.html" title="19.14. Schnappschüsse von Dateisystemen" /><link rel="next" href="disks-encrypting.html" title="19.16. Partitionen verschlüsseln" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">19.15. Dateisystem-Quotas</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="snapshots.html">Zurück</a> </td><th width="60%" align="center">Kapitel 19. Speichermedien</th><td width="20%" align="right"> <a accesskey="n" href="disks-encrypting.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="quotas"></a>19.15. Dateisystem-Quotas</h2></div></div></div><a id="idp81893968" class="indexterm"></a><a id="idp81895120" class="indexterm"></a><p>Quotas sind eine optionale Funktion des Betriebssystems,
      die es Ihnen erlauben, den Plattenplatz und/oder die Anzahl
      der Dateien eines Benutzers oder der Mitglieder einer Gruppe,
      auf Dateisystemebene zu beschränken.  Oft wird dies
      auf Timesharing-Systemen (Mehrbenutzersystemen) genutzt, da
      es dort erwünscht ist, die Ressourcen, die ein Benutzer oder
      eine Gruppe von Benutzern belegen können, zu limitieren.  Das
      verhindert, dass ein Benutzer oder eine Gruppe von Benutzern
      den ganzen verfügbaren Plattenplatz belegt.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81896016"></a>19.15.1. Konfiguration des Systems, um Quotas zu
	aktivieren</h3></div></div></div><p>Bevor Quotas benutzt werden können, müssen
	sie im Kernel konfiguriert werden, wozu die folgende Zeile
	der Kernelkonfiguration hinzugefügt wird:</p><pre class="programlisting">options QUOTA</pre><p>Im gewöhnlichen <code class="filename">GENERIC</code> Kernel
        sind Quotas nicht aktiviert, so dass Sie einen angepassten
	Kernel konfigurieren und bauen müssen, um Quotas zu
	benutzen.  Weitere Informationen
	finden Sie in <a class="xref" href="kernelconfig.html" title="Kapitel 9. Konfiguration des FreeBSD-Kernels">Kapitel 9, <em>Konfiguration des FreeBSD-Kernels</em></a>.</p><p>Durch Hinzufügen der folgenden Zeile in
        <code class="filename">/etc/rc.conf</code> wird das Quota-System
	in FreeBSD 7.X und ältere aktiviert:</p><pre class="programlisting">enable_quotas="YES"</pre><p>Seit FreeBSD 8.0-RELEASE und dessen Nachfolger fügen
        Sie stattdessen die folgende Zeile hinzu:</p><pre class="programlisting">quota_enable="YES"</pre><a id="idp81900752" class="indexterm"></a><p>Um den Start des Quota-Systems zu beeinflussen, steht
	eine weitere Variable zur Verfügung.  Normalerweise
	wird beim Booten die Integrität der Quotas auf
	allen Dateisystemen mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotacheck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotacheck</span>(8)</span></a>
	überprüft.  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotacheck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotacheck</span>(8)</span></a> stellt
	sicher, dass die Quota-Datenbank mit den Daten auf
	einem Dateisystem übereinstimmt.  Dies ist allerdings
	ein sehr zeitraubender Prozess, der die Zeit, die
	das System zum Booten braucht, signifikant beeinflusst.
	Eine Variable in <code class="filename">/etc/rc.config</code> erlaubt es Ihnen,
	diesen Schritt zu überspringen:</p><pre class="programlisting">check_quotas="NO"</pre><p>Schließlich müssen Sie noch in
	<code class="filename">/etc/fstab</code> die Plattenquotas auf
	Dateisystemebene aktivieren.  Dort können Sie
	für alle Dateisysteme Quotas für Benutzer, Gruppen
	oder für beide aktivieren.</p><p>Um Quotas pro Benutzer für ein Dateisystem zu
        aktivieren, geben Sie für dieses Dateisystem die
	Option <code class="option">userquota</code> im Feld Optionen von
	<code class="filename">/etc/fstab</code> an.  Beispiel:</p><pre class="programlisting">/dev/da1s2g   /home    ufs rw,userquota 1 2</pre><p>Um Quotas für Gruppen einzurichten, verwenden
	Sie <code class="option">groupquota</code> anstelle von
	<code class="option">userquota</code>.  Um Quotas für Benutzer
	und Gruppen einzurichten, ändern Sie den Eintrag
	wie folgt ab:</p><pre class="programlisting">/dev/da1s2g    /home    ufs rw,userquota,groupquota 1 2</pre><p>Die Quotas werden jeweils im Rootverzeichnis des Dateisystems
	unter dem Namen <code class="filename">quota.user</code> für
	Benutzer-Quotas und <code class="filename">quota.group</code> für
	Gruppen-Quotas abgelegt.  Obwohl <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fstab&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">fstab</span>(5)</span></a> beschreibt,
	dass diese Dateien an anderer Stelle gespeichert werden
	können, wird das nicht empfohlen, da es den Anschein hat,
	dass die verschiedenen Quota-Utilities das nicht richtig
	unterstützen.</p><p>Jetzt sollten Sie Ihr System mit dem neuen Kernel booten.
	<code class="filename">/etc/rc</code> wird dann automatisch die
	richtigen Kommandos aufrufen, die die Quota-Dateien für
	alle Quotas, die Sie in <code class="filename">/etc/fstab</code>
	definiert haben, anlegen.  Deshalb müssen vorher auch keine
	leeren Quota-Dateien angelegt werden.</p><p>Normalerweise brauchen Sie die Kommandos
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotacheck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotacheck</span>(8)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotaon&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotaon</span>(8)</span></a> oder
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quotaoff&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">quotaoff</span>(8)</span></a> nicht händisch aufzurufen,
	obwohl Sie vielleicht die entsprechenden Seiten im
	Manual lesen sollten, um sich mit ihnen vertraut
	zu machen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81922640"></a>19.15.2. Setzen von Quota-Limits</h3></div></div></div><a id="idp81923280" class="indexterm"></a><p>Nachdem Sie Quotas in Ihrem System aktiviert haben, sollten
        Sie überprüfen, dass Sie auch tatsächlich
	aktiviert sind.  Führen Sie dazu einfach den folgenden
	Befehl aus:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>quota -v</code></strong></pre><p>Für jedes Dateisystem, auf dem Quotas aktiviert sind,
	sollten Sie eine Zeile mit der Plattenauslastung und den
	aktuellen Quota-Limits sehen.</p><p>Mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a> können Sie nun
	Quota-Limits setzen.</p><p>Sie haben mehrere Möglichkeiten, die Limits für
	den Plattenplatz, den ein Benutzer oder eine Gruppe verbrauchen
	kann, oder die Anzahl der Dateien, die angelegt werden dürfen,
	festzulegen.  Die Limits können auf dem Plattenplatz
	(Block-Quotas) oder der Anzahl der Dateien (Inode-Quotas) oder
	einer Kombination von beiden basieren.
	Jedes dieser Limits wird weiterhin in zwei Kategorien geteilt:
	Hardlimits und Softlimits.</p><a id="idp81927760" class="indexterm"></a><p>Ein Hardlimit kann nicht überschritten werden.
	Hat der Benutzer einmal ein Hardlimit erreicht, so kann er
	auf dem betreffenden Dateisystem keinen weiteren Platz mehr
	beanspruchen.  Hat ein Benutzer beispielsweise ein Hardlimit
	von 500 Kilobytes auf einem Dateisystem und benutzt davon
	490 Kilobyte, so kann er nur noch 10 weitere Kilobytes
	beanspruchen.  Der Versuch, weitere 11 Kilobytes zu beanspruchen,
	wird fehlschlagen.</p><a id="idp81928656" class="indexterm"></a><p>Im Gegensatz dazu können Softlimits für eine
	befristete Zeit überschritten werden.  Diese Frist
	beträgt in der Grundeinstellung
	eine Woche.  Hat der Benutzer das Softlimit über die
	Frist hinaus überschritten, so wird das Softlimit in
	ein Hardlimit umgewandelt und der Benutzer kann
	keinen weiteren Platz mehr beanspruchen.  Wenn er einmal
	das Softlimit unterschreitet, wird die Frist wieder
	zurückgesetzt.</p><p>Das folgende Beispiel zeigt die Benutzung von
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a>.  Wenn <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a> aufgerufen wird,
	wird der Editor gestartet, der durch <code class="envar">EDITOR</code>
	gegeben ist oder <span class="application">vi</span> falls
	<code class="envar">EDITOR</code> nicht gesetzt ist.  In dem Editor
	können Sie die Limits eingeben.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>edquota -u test</code></strong></pre><pre class="programlisting">Quotas for user test:
/usr: kbytes in use: 65, limits (soft = 50, hard = 75)
        inodes in use: 7, limits (soft = 50, hard = 60)
/usr/var: kbytes in use: 0, limits (soft = 50, hard = 75)
        inodes in use: 0, limits (soft = 50, hard = 60)</pre><p>Für jedes Dateisystem, auf dem Quotas aktiv sind,
	sehen Sie zwei Zeilen, eine für die Block-Quotas und die
	andere für die Inode-Quotas.  Um ein Limit zu modifizieren,
	ändern Sie einfach den angezeigten Wert.  Um beispielsweise
	das Blocklimit dieses Benutzers von einem Softlimit von 50
	und einem Hardlimit von 75 auf ein Softlimit von 500 und
	ein Hardlimit von 600 zu erhöhen, ändern Sie
	die Zeile</p><pre class="programlisting">/usr: kbytes in use: 65, limits (soft = 50, hard = 75)</pre><p>zu:</p><pre class="programlisting">/usr: kbytes in use: 65, limits (soft = 500, hard = 600)</pre><p>Die neuen Limits sind wirksam, wenn Sie den
	Editor verlassen.</p><p>Manchmal ist es erwünscht, die Limits für einen
	Bereich von UIDs zu setzen.  Dies kann mit der <code class="option">-p</code>
	Option von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a> bewerkstelligt werden.
	Weisen Sie dazu die Limits einem Benutzer zu und rufen danach
	<code class="command">edquota -p protouser startuid-enduid</code> auf.
	Besitzt beispielsweise der Benutzer <code class="systemitem">test</code>
	die gewünschten Limits, können diese mit
	dem folgenden Kommando für die UIDs 10.000 bis 19.999
	dupliziert werden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>edquota -p test 10000-19999</code></strong></pre><p>Weitere Informationen erhalten Sie in <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=edquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">edquota</span>(8)</span></a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81965136"></a>19.15.3. Überprüfen von Quota-Limits und Plattennutzung</h3></div></div></div><a id="idp81970000" class="indexterm"></a><p>Sie können <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a> oder
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=repquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">repquota</span>(8)</span></a> benutzen, um Quota-Limits
	und Plattennutzung zu überprüfen.  Um die Limits
	oder die Plattennutzung individueller Benutzer und Gruppen
	zu überprüfen, kann <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a>
	benutzt werden.  Ein Benutzer kann nur die eigenen Quotas und die
	Quotas der Gruppe, der er angehört untersuchen.  Nur der
	Superuser darf sich alle Limits ansehen.
	Mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=repquota&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">repquota</span>(8)</span></a> erhalten Sie eine Zusammenfassung
	von allen Limits und der Plattenausnutzung für alle
	Dateisysteme, auf denen Quotas aktiv sind.</p><p>Das folgende Beispiel zeigt die Ausgabe von
	<code class="command">quota -v</code> für einen Benutzer, der
	Quota-Limits auf zwei Dateisystemen besitzt:</p><pre class="programlisting">Disk quotas for user test (uid 1002):
     Filesystem  usage   quota   limit   grace   files   quota   limit   grace
           /usr      65*     50      75   5days       7      50      60
       /usr/var       0      50      75               0      50      60</pre><a id="idp81975760" class="indexterm"></a><p>Im Dateisystem <code class="filename">/usr</code> liegt der Benutzer
	momentan 15 Kilobytes über dem Softlimit von
	50 Kilobytes und hat noch 5 Tage seiner Frist übrig.
	Der Stern <code class="literal">*</code> zeigt an, dass der
	Benutzer sein Limit überschritten hat.</p><p>In der Ausgabe von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a> werden Dateisysteme,
	auf denen ein Benutzer keinen Platz verbraucht, nicht angezeigt,
	auch wenn diesem Quotas zugewiesen wurden.  Mit <code class="option">-v</code>
	werden diese Dateisysteme, wie <code class="filename">/usr/var</code>
	im obigen Beispiel, angezeigt.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81984464"></a>19.15.4. Quotas über NFS</h3></div></div></div><a id="idp81985104" class="indexterm"></a><p>Quotas werden von dem Quota-Subsystem auf dem NFS Server
	erzwungen.  Der <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rpc.rquotad&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rpc.rquotad</span>(8)</span></a> Dæmon stellt
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=quota&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">quota</span>(1)</span></a> die Quota Informationen auf dem NFS Client
	zur Verfügung, so dass Benutzer auf diesen
	Systemen ihre Quotas abfragen können.</p><p>Aktivieren Sie <code class="command">rpc.rquotad</code> in
	<code class="filename">/etc/inetd.conf</code> wie folgt:</p><pre class="programlisting">rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad</pre><p>Anschließend starten Sie <code class="command">inetd</code>
	neu:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service inetd restart</code></strong></pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="snapshots.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="disks.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="disks-encrypting.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">19.14. Schnappschüsse von Dateisystemen </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 19.16. Partitionen verschlüsseln</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>