<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>28.6. Einrichten der seriellen Konsole</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="serialcomms.html" title="Kapitel 28. Serielle Datenübertragung" /><link rel="prev" href="dialout.html" title="28.5. Verbindungen nach Außen" /><link rel="next" href="ppp-and-slip.html" title="Kapitel 29. PPP und SLIP" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">28.6. Einrichten der seriellen Konsole</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="dialout.html">Zurück</a> </td><th width="60%" align="center">Kapitel 28. Serielle Datenübertragung</th><td width="20%" align="right"> <a accesskey="n" href="ppp-and-slip.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="serialconsole-setup"></a>28.6. Einrichten der seriellen Konsole</h2></div><div><span class="authorgroup">Beigesteuert von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Kazutaka</span> <span class="surname">YOKOTA</span></span>. </span></div><div><span class="authorgroup">Auf Grundlage eines Dokuments von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Bill</span> <span class="surname">Paul</span></span>. </span></div></div></div><div xmlns="" class="warning"><h3 class="admontitle">Warnung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Mit FreeBSD 8.0 wurden die Gerätedateien für
	serielle Ports von
	<code class="filename">/dev/ttydN</code> in
	<code class="filename">/dev/ttyuN</code>
	umbenannt.  Setzen Sie noch FreeBSD 7.X ein, müssen
	Sie die Befehle in den folgenden Abschnitten entsprechend
	anpassen.</p></div><a id="idp87126992" class="indexterm"></a><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-intro"></a>28.6.1. Einführung</h3></div></div></div><p>FreeBSD kann ein System mit einem Dumb-Terminal (unintelligente
	Datenstation) an einer seriellen Schnittstelle als Konsole booten.
	Diese Konfiguration ist besonders nützlich für
	Systemadministratoren, die FreeBSD auf Systemen ohne Tastatur oder
	Monitor installieren wollen, und Entwickler, die den Kernel oder
	Gerätetreiber debuggen.</p><p>Wie in <a class="xref" href="boot.html" title="Kapitel 13. FreeBSDs Bootvorgang">Kapitel 13, <em>FreeBSDs Bootvorgang</em></a> beschrieben, besitzt FreeBSD drei
        Bootphasen.  Der Code für die ersten beiden Bootphasen befindet
	sich im Bootsektor am
	Anfang der FreeBSD-Slice der Bootplatte.  Dieser Bootblock
	lädt den Bootloader (<code class="filename">/boot/loader</code>) in
	Phase drei.</p><p>Um eine serielle Konsole einzurichten, müssen Sie den
        Bootblock, den Bootloader und den Kernel konfigurieren.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-howto-fast"></a>28.6.2. Serielle Konsole einrichten, Kurzfassung</h3></div></div></div><p>Dieser Abschnitt fasst zusammen, wie Sie eine
	serielle Konsole einrichten.  Es wird vorausgesetzt, dass
	Sie die Voreinstellungen verwenden und wissen, wie
	serielle Schnittstellen verbunden werden.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Verbinden Sie die serielle Konsole mit
	    <code class="filename">COM1</code> sowie dem Kontrollterminal.</p></li><li class="step"><p>Um die Startmeldungen der seriellen Konsole zu sehen,
	    geben Sie als <code class="systemitem">root</code> Folgendes ein:</p><pre class="screen"><code class="prompt">#</code> echo 'console="comconsole"' &gt;&gt; /boot/loader.conf</pre></li><li class="step"><p>Ändern Sie in <code class="filename">/etc/ttys</code>
	    den Eintrag für <code class="filename">ttyu0</code> von
	    <code class="literal">off</code> auf <code class="literal">on</code>.
	    Zusätzlich sollten Sie den Wert
	    <code class="literal">dialup</code> auf <code class="literal">vt100</code>
	    ändern.  Nur so wird auf der seriellen Konsole
	    eine Eingabeaufforderung mit einer Passwortabfrage
	    aktiviert.</p></li><li class="step"><p>Starten Sie nun das System neu, damit die serielle
	    Konsole aktiviert wird.</p></li></ol></div><p>Wenn Sie eine unterschiedliche Konfiguration benötigen,
        sollten Sie <a class="xref" href="serialconsole-setup.html#serialconsole-howto" title="28.6.3. Konfiguration der Konsole">Abschnitt 28.6.3, &#8222;Konfiguration der Konsole&#8220;</a> lesen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-howto"></a>28.6.3. Konfiguration der Konsole</h3></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Bereiten Sie ein serielles Kabel vor.</p><a id="idp87145680" class="indexterm"></a><p>Sie benötigen entweder ein Nullmodemkabel oder ein
	    serielles Standard Kabel mit einem Nullmodemkabel-Adapter.  In
	    <a class="xref" href="serial.html#serial-cables-ports" title="28.2.2. Kabel und Schnittstellen">Abschnitt 28.2.2, &#8222;Kabel und Schnittstellen&#8220;</a> wurden serielle Kabel
	    beschrieben.</p></li><li class="step"><p>Trennen Sie die Tastatur vom Computer.</p><p>Die meisten PC Systeme suchen beim Power On Self Test
	    (POST) nach einer Tastatur und geben eine Fehlermeldung aus,
	    wenn sie keine finden.  Einige Maschinen werden sich sogar
	    weigern, ohne Tastatur zu booten.</p><p>Wenn Ihr Rechner trotz einer Fehlermeldung normal
	    weiterbootet, brauchen Sie weiter nichts zu tun.
	    Beispielsweise geben einige Maschinen mit einem Phoenix BIOS
	    nur <span class="errorname">Keyboard failed</span> aus und booten dann
	    normal weiter.</p><p>Wenn Ihr System ohne Tastatur nicht booten will,
	    müssen Sie das BIOS so konfigurieren, das es diesen Fehler
	    ignoriert (wenn das möglich ist).  Das Handbuch zu Ihrem
	    Motherboard sollte beschreiben, wie das zu bewerkstelligen
	    ist.</p><div xmlns="" class="tip"><h3 class="admontitle">Tipp: </h3><p xmlns="http://www.w3.org/1999/xhtml">Selbst wenn Sie im BIOS <span class="quote">&#8222;<span class="quote">Not installed</span>&#8220;</span>
	      für die Tastatur einstellen, können Sie eine
	      Tastatur angeschlossen haben und diese auch weiterhin
	      benutzen, da sie mit dieser Anweisung das BIOS
	      lediglich anweisen, nach dem Einschalten des Rechners nicht
	      nach einer Tastatur zu suchen und den Rechner ohne
	      entsprechende Fehlermeldung zu starten.  Wenn die oben
	      beschriebene Option nicht im BIOS vorhanden ist, halten Sie
	      stattdessen Ausschau nach einer <span class="quote">&#8222;<span class="quote">Halt on Error</span>&#8220;</span>
	      Option.  Sie können den gleichen Effekt wie oben erzielen,
	      wenn Sie diese Option auf <span class="quote">&#8222;<span class="quote">All but Keyboard</span>&#8220;</span> oder
	      sogar <span class="quote">&#8222;<span class="quote">No Errors</span>&#8220;</span> setzen.</p></div><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Wenn Ihr System über eine <span class="trademark">PS/2</span>® Maus verfügt,
	      müssen Sie diese wahrscheinlich auch abziehen.  Da sich
	      die <span class="trademark">PS/2</span>® Maus und die Tastatur einige Hardwarekomponenten
	      teilen, kann das dazu führen, dass die
	      Hardwareerkennung fälschlicherweise eine Tastatur findet,
	      wenn eine <span class="trademark">PS/2</span>® Maus angeschlossen ist.  Gateway 2000
	      Pentium 90 MHz Systemen wird dieses Verhalten nachgesagt.
	      Normalerweise ist das kein Problem, da eine Maus ohne
	      Tastatur sowieso nicht sinnvoll einsetzbar ist.</p></div></li><li class="step"><p>Schließen Sie einen Dumb-Terminal an
	    <code class="filename">COM1</code> (<code class="filename">sio0</code>)
	    an.</p><p>Wenn Sie keinen Dumb-Terminal besitzen, können Sie
	    einen alten PC/XT mit einem Terminalemulator oder die serielle
	    Schnittstelle eines anderen <span class="trademark">UNIX</span>® Rechners benutzen.  Sie
	    benötigen auf jeden Fall eine freie erste serielle
	    Schnittstelle (<code class="filename">COM1</code>).  Zurzeit ist es
	    nicht möglich, in den Bootblöcken eine andere
	    Schnittstelle zu konfigurieren, ohne diese neu zu kompilieren.
	    Wenn Sie <code class="filename">COM1</code> bereits für ein
	    anderes Gerät benutzen, müssen Sie dieses Gerät
	    temporär entfernen und einen neuen Bootblock sowie Kernel
	    installieren, wenn Ihr FreeBSD erst einmal installiert ist.
	    Auf einem Server sollte <code class="filename">COM1</code> ohnehin
	    verfügbar sein.  Wenn Sie die Schnittstelle für ein
	    anderes Gerät benutzen und Sie dieses nicht auf
	    <code class="filename">COM2</code> (<code class="filename">sio1</code>)
	    legen können, sollten Sie sich nicht an erster Stelle mit
	    dem Aufsetzen einer seriellen Konsole beschäftigen.</p></li><li class="step"><p>Stellen Sie sicher, dass Ihre Kernelkonfiguration die
	    richtigen Optionen für <code class="filename">COM1</code>
	    (<code class="filename">sio0</code>) enthält.</p><p>Relevante Optionen sind:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">0x10</code></span></dt><dd><p>Aktiviert die Konsolenunterstützung für
		  dieses Gerät.  Zurzeit kann nur ein Gerät die
		  Konsolenunterstützung aktiviert haben.  Das erste,
		  in der Konfigurationsdatei aufgeführte Gerät,
		  mit dieser Option, verfügt über eine aktivierte
		  Konsolenunterstützung.  Beachten Sie, dass
		  diese Option alleine nicht ausreicht, um die serielle
		  Konsole zu aktivieren.  Setzen Sie entweder noch die
		  nachfolgend diskutierte Option oder verwenden Sie beim
		  Booten, wie unten beschrieben, den Schalter
		  <code class="option">-h</code>.</p></dd><dt><span class="term"><code class="literal">0x20</code></span></dt><dd><p>Das erste Gerät in der Kernelkonfigurationsdatei
		  mit dieser Option wird, unabhängig von dem unten
		  diskutierten Schalter <code class="option">-h</code>, zur Konsole.
		  Die Option <code class="option">0x20</code> muss zusammen mit
		  <code class="option">0x10</code> verwendet werden.</p></dd><dt><span class="term"><code class="literal">0x40</code></span></dt><dd><p>Reserviert dieses Gerät und sperrt es für
		  normale Zugriffe.  Sie sollten diese Option nicht auf dem
		  Gerät setzen, das Sie als serielle Konsole verwenden
		  wollen.  Der Zweck dieser Option ist es, dieses
		  Gerät für das Remote-Debuggen zu reservieren.
		  Das <a class="link" href="../../../../doc/en_US.ISO8859-1/books/developers-handbook/index.html" target="_top">
		    FreeBSD Developers' Handbook</a> enthält dazu weitere
		  Informationen.</p></dd></dl></div><p>Beispiel:</p><pre class="programlisting">device sio0 at isa? port IO_COM1 tty flags 0x10 irq 4</pre><p>Weitere Einzelheiten entnehmen Sie bitte
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sio&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">sio</span>(4)</span></a>.</p><p>Wenn diese Optionen nicht gesetzt sind, müssen Sie auf
	    einer anderen Konsole beim Booten UserConfig starten oder den
	    Kernel neu kompilieren.</p></li><li class="step"><p>Erstellen Sie <code class="filename">boot.config</code> im
	    Rootverzeichnis der <code class="literal">a</code>-Partition des
	    Bootlaufwerks.</p><p>Der Code des Bootblocks entnimmt dieser Datei, wie Sie Ihr
	    System booten möchten.  Um die serielle Konsole zu
	    aktivieren, müssen Sie hier eine oder mehrere Optionen
	    (alle in derselben Zeile) angeben.  Die folgenden Optionen
	    stehen zur Auswahl der Konsole zur Verfügung:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-h</code></span></dt><dd><p>Schaltet zwischen der internen und der seriellen
		  Konsole um.  Wenn Sie beispielsweise von der internen
		  Konsole (Bildschirm) booten, weist <code class="option">-h</code>
		  den Bootloader und den Kernel an, die serielle
		  Schnittstelle als Konsole zu nehmen.  Wenn die Konsole
		  normal auf der seriellen Schnittstelle liegt, wählen
		  Sie mit <code class="option">-h</code> den Bildschirm aus.</p></dd><dt><span class="term"><code class="option">-D</code></span></dt><dd><p>Schaltet zwischen Einzelkonsole und Dual-Konsole um.
		  Die Einzelkonsole ist entweder die interne Konsole
		  (der Bildschirm) oder die serielle Schnittstelle, je nach
		  dem Stand von <code class="option">-h</code>.  Im
		  Dual-Konsolen Betrieb ist die Konsole, unabhängig
		  von <code class="option">-h</code>, gleichzeitig der Bildschirm und
		  die serielle Schnittstelle.  Dies trifft aber nur zu,
		  wenn der Bootblock ausgeführt wird.  Sobald der
		  Bootloader ausgeführt wird, wird die durch
		  <code class="option">-h</code> gegebene Konsole die alleinige
		  Konsole.</p></dd><dt><span class="term"><code class="option">-P</code></span></dt><dd><p>Veranlasst den Bootblock nach einer Tastatur zu
		  suchen.  Wenn keine Tastatur gefunden wird, werden
		  <code class="option">-D</code> und <code class="option">-h</code> automatisch
		  gesetzt.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Wegen Platzbeschränkungen in den
		    Bootblöcken kann <code class="option">-P</code> nur
		    erweiterte Tastaturen erkennen.  Tastaturen mit weniger
		    als 101 Tasten (und ohne F11 und F12 Tasten) werden
		    wahrscheinlich, wie vielleicht auch die Tastaturen
		    einiger Laptops, nicht erkannt.  Wenn dies bei Ihrem
		    System der Fall ist, können Sie <code class="option">-P</code>
		    nicht verwenden, da es leider noch keine Umgehung
		    für dieses Problem gibt.</p></div></dd></dl></div><p>Benutzen Sie also entweder <code class="option">-P</code>, um die
	    Konsole automatisch zu setzen, oder <code class="option">-h</code>, um die
	    serielle Konsole zu verwenden.</p><p>In <code class="filename">boot.config</code> können Sie auch
	    andere, in <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=boot&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">boot</span>(8)</span></a> beschriebene Optionen,
	    aufnehmen.</p><p>Mit Ausnahme von <code class="option">-P</code> werden die Optionen an
	    den Bootloader (<code class="filename">/boot/loader</code>)
	    weitergegeben.  Der Bootloader untersucht dann einzig
	    <code class="option">-h</code> um festzustellen, welches Gerät die
	    Konsole wird.  Wenn Sie also nur <code class="option">-D</code> angegeben
	    haben, können Sie die serielle Schnittstelle nur als
	    Konsole verwenden während der Bootblock ausgeführt
	    wird.  Danach wird der Bootloader, da ja <code class="option">-h</code>
	    fehlt, den Bildschirm zur Konsole machen.</p></li><li class="step"><p>Booten Sie die Maschine.</p><p>Wenn Sie das FreeBSD-System starten, werden die
	    Bootblöcke den Inhalt von <code class="filename">/boot.config</code>
	    auf der Konsole ausgeben:</p><pre class="screen">/boot.config: -P
Keyboard: no</pre><p>Die zweite Zeile sehen Sie nur, wenn Sie in
	    <code class="filename">/boot.config</code> <code class="option">-P</code> angegeben
	    haben.  Sie zeigt an, ob eine Tastatur angeschlossen ist oder
	    nicht.  Die Meldungen gehen je nach den Einstellungen in
	    <code class="filename">/boot.config</code> auf die interne Konsole, die
	    serielle Konsole, oder beide Konsolen.</p><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Optionen</th><th align="left">Meldungen erscheinen auf</th></tr></thead><tbody><tr><td>keine</td><td>der internen Konsole</td></tr><tr><td><code class="option">-h</code></td><td>der seriellen Konsole</td></tr><tr><td><code class="option">-D</code></td><td>der seriellen und der internen Konsole</td></tr><tr><td><code class="option">-Dh</code></td><td>der seriellen und der internen Konsole</td></tr><tr><td><code class="option">-P</code>, mit Tastatur</td><td>der internen Konsole</td></tr><tr><td><code class="option">-P</code>, ohne Tastatur</td><td>der seriellen Konsole</td></tr></tbody></table></div><p>Nach den oben gezeigten Meldungen gibt es eine kleine
	    Verzögerung bevor die Bootblöcke den Bootloader
	    laden und weitere Meldungen auf der Konsole erscheinen.  Sie
	    können die Ausführung der Bootblöcke
	    unterbrechen, um zu überprüfen, ob auch alles richtig
	    aufgesetzt ist, brauchen das aber unter normalen Umständen
	    nicht zu tun.</p><p>Drücken Sie eine Taste außer
	    <span class="keycap"><strong>Enter</strong></span> um den Bootvorgang zu unterbrechen.  Sie
	    erhalten dann ein Prompt, an dem Sie weitere Eingaben
	    tätigen können:</p><pre class="screen">&gt;&gt; FreeBSD/i386 BOOT
Default: 0:ad(0,a)/boot/loader
boot:</pre><p>Je nach Inhalt von <code class="filename">/boot.config</code>
	    erscheint das Prompt auf der seriellen Konsole, der internen
	    Konsole oder beiden Konsolen.  Wenn die Meldung auf der
	    richtigen Konsole erscheint, drücken Sie
	    <span class="keycap"><strong>Enter</strong></span> um fortzufahren.</p><p>Wenn Sie das Prompt auf der seriellen Konsole erwartet
	    haben, dort aber nichts sehen, liegt ein Fehler in Ihren
	    Einstellungen vor.  Als Umgehung geben Sie an der momentanen
	    Konsole <code class="option">-h</code> ein, um den Bootblock und den
	    Bootloader auf die serielle Konsole umzustellen.  Führen
	    Sie dann den Bootvorgang mit <span class="keycap"><strong>Enter</strong></span> weiter
	    und wenn das System gebootet hat, können Sie die
	    fehlerhaften Einstellungen korrigieren.</p></li></ol></div><p>Nachdem der Bootloader geladen wurde und Sie sich in der
        dritten Bootphase befinden, können Sie immer noch zwischen der
	internen und der seriellen Konsole auswählen.  Setzen Sie dazu,
	wie in <a class="xref" href="serialconsole-setup.html#serialconsole-loader" title="28.6.6. Die Konsole im Bootloader ändern">Abschnitt 28.6.6, &#8222;Die Konsole im Bootloader ändern&#8220;</a> beschrieben, die
	entsprechenden Variablen des Bootloaders.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-summary"></a>28.6.4. Zusammenfassung</h3></div></div></div><p>Die folgende Übersicht zeigt, welche Konsole, abhängig
	von den getroffenen Einstellungen, ausgewählt wird.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87224656"></a>28.6.4.1. Fall 1: Option 0x10 für
	  <code class="filename">sio0</code></h4></div></div></div><pre class="programlisting">device sio0 at isa? port IO_COM1 tty flags 0x10 irq 4</pre><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th align="left">Optionen in <code class="filename">/boot.config</code></th><th align="left">Konsole in den Bootblöcken</th><th align="left">Konsole im Bootloader</th><th align="left">Konsole im Kernel</th></tr></thead><tbody><tr><td>keine</td><td>interne</td><td>interne</td><td>interne</td></tr><tr><td><code class="option">-h</code></td><td>serielle</td><td>serielle</td><td>serielle</td></tr><tr><td><code class="option">-D</code></td><td>serielle und interne</td><td>interne</td><td>interne</td></tr><tr><td><code class="option">-Dh</code></td><td>serielle und interne</td><td>serielle</td><td>serielle</td></tr><tr><td><code class="option">-P</code>, mit Tastatur</td><td>interne</td><td>interne</td><td>interne</td></tr><tr><td><code class="option">-P</code>, ohne Tastatur</td><td>serielle und interne</td><td>serielle</td><td>serielle</td></tr></tbody></table></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87309008"></a>28.6.4.2. Fall 2: Option 0x30 für
	  <code class="filename">sio0</code></h4></div></div></div><pre class="programlisting">device sio0 at isa? port IO_COM1 tty flags 0x30 irq 4</pre><div class="informaltable"><table width="100%" border="0"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th align="left">Optionen in <code class="filename">/boot.config</code></th><th align="left">Konsole in den Bootblöcken</th><th align="left">Konsole im Bootloader</th><th align="left">Konsole im Kernel</th></tr></thead><tbody><tr><td>keine</td><td>interne</td><td>interne</td><td>serielle</td></tr><tr><td><code class="option">-h</code></td><td>serielle</td><td>serielle</td><td>serielle</td></tr><tr><td><code class="option">-D</code></td><td>serielle und interne</td><td>interne</td><td>serielle</td></tr><tr><td><code class="option">-Dh</code></td><td>serielle und interne</td><td>serielle</td><td>serielle</td></tr><tr><td><code class="option">-P</code>, mit Tastatur</td><td>interne</td><td>interne</td><td>serielle</td></tr><tr><td><code class="option">-P</code>, ohne Tastatur</td><td>serielle und interne</td><td>serielle</td><td>serielle</td></tr></tbody></table></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-tips"></a>28.6.5. Hinweise zur seriellen Konsole</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87340880"></a>28.6.5.1. Verwenden einer höheren Geschwindigkeit</h4></div></div></div><p>Die Vorgabewerte für die Kommunikationsparameter der
	  seriellen Schnittstelle sind: 9600 baud, 8 Bit, keine
	  Parität und ein Stopp-Bit.  Wenn Sie die
	  Standardgeschwindigkeit ändern wollen, haben Sie folgende
	  Möglichkeiten:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Geben Sie die neue Konsolengeschwindigkeit mit
	      <code class="varname">BOOT_COMCONSOLE_SPEED</code> an und
	      kompilieren Sie die Bootblöcke neu.  Ausführliche
	      Informationen zum Bau und zur Installation von neuen
	      Bootblöcken finden Sie im
	      <a class="xref" href="serialconsole-setup.html#serialconsole-com2" title="28.6.5.2. Eine andere Schnittstelle als sio0 benutzen">Abschnitt 28.6.5.2, &#8222;Eine andere Schnittstelle als <code class="filename">sio0</code>
	  benutzen&#8220;</a> des Handbuchs.</p><p>Wenn die serielle Konsole nicht mit der Option
	      <code class="option">-h</code> gestartet wird,
	      oder wenn die verwendete serielle Konsole sich von
	      der von den Bootblöcken verwendeten unterscheidet,
	      müsssen Sie zusätzlich die folgende Option in
	      Ihre Kernelkonfigurationsdatei aufnehmen und den Kernel
	      neu bauen:</p><pre class="programlisting">options CONSPEED=19200</pre></li><li class="listitem"><p>Verwenden Sie die Option <code class="option">-S</code>, um den
	      Kernel zu booten.  Die Option <code class="option">-S</code> kann
	      auch in die Datei <code class="filename">/boot.config</code>
	      aufgenommen werden.  Eine Beschreibung dieses Vorgangs
	      sowie eine Auflistung der von
	      <code class="filename">/boot.config</code> unterstützten
	      Optionen finden Sie in der Manualpage <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=boot&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">boot</span>(8)</span></a>.</p></li><li class="listitem"><p>Aktivieren Sie die Option
	      <code class="varname">comconsole_speed</code> in der Datei
	      <code class="filename">/boot/loader.conf</code>.</p><p>Diese Option setzt voraus, dass auch die Optionen
	      <code class="varname">console</code>,
	      <code class="varname">boot_serial</code>, sowie
	      <code class="varname">boot_multicons</code> in der Datei
	      <code class="filename">/boot/loader.conf</code> gesetzt sind.
	      Im Folgenden finden Sie ein Beispiel, in dem
	      <code class="varname">comconsole_speed</code> verwendet wird,
	      um die Geschwindigkeit der seriellen Konsole zu
	      ändern:</p><pre class="programlisting">boot_multicons="YES"
boot_serial="YES"
comconsole_speed="115200"
console="comconsole,vidconsole"</pre></li></ul></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-com2"></a>28.6.5.2. Eine andere Schnittstelle als <code class="filename">sio0</code>
	  benutzen</h4></div></div></div><p>Wenn Sie, warum auch immer, ein anderes Gerät als
	  <code class="filename">sio0</code> für die serielle Konsole
	  einsetzen wollen, kompilieren Sie bitte die Bootblöcke, den
	  Bootloader und den Kernel nach dem folgenden Verfahren
	  neu.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Installieren Sie die Kernelquellen (siehe
	      <a class="xref" href="updating-upgrading.html" title="Kapitel 26. FreeBSD aktualisieren">Kapitel 26, <em>FreeBSD aktualisieren</em></a>).</p></li><li class="step"><p>Setzen Sie in <code class="filename">/etc/make.conf</code>
	      <code class="literal">BOOT_COMCONSOLE_PORT</code> auf die Adresse der
	      Schnittstelle (0x3F8, 0x2F8, 0x3E8 oder 0x2E8), die Sie
	      benutzen möchten.  Sie können nur
	      <code class="filename">sio0</code> bis
	      <code class="filename">sio3</code> (<code class="filename">COM1</code>
	      bis <code class="filename">COM4</code>) benutzen, Multiportkarten
	      können Sie nicht als Konsole benutzen.  Interrupts
	      müssen Sie hier nicht angeben.</p></li><li class="step"><p>Erstellen Sie eine angepasste Kernelkonfiguration
	      und geben Sie dort die richtigen Optionen für die
	      Schnittstelle, die Sie benutzen möchten, an.  Wenn Sie
	      zum Beispiel <code class="filename">sio1</code>
	      (<code class="filename">COM2</code>) zur Konsole machen wollen,
	      geben Sie dort entweder</p><pre class="programlisting">device sio1 at isa? port IO_COM2 tty flags 0x10 irq 3</pre><p>oder</p><pre class="programlisting">device sio1 at isa? port IO_COM2 tty flags 0x30 irq 3</pre><p>an.  Keine andere serielle Schnittstelle sollte als
	      Konsole definiert werden.</p></li><li class="step"><p>Übersetzen und installieren Sie die
	      Bootblöcke und den Bootloader:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /sys/boot</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make clean</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make install</code></strong></pre></li><li class="step"><p>Bauen und installieren Sie einen neuen Kernel.</p></li><li class="step"><p>Schreiben Sie die Bootblöcke mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">bsdlabel</span>(8)</span></a>
	      auf die Bootplatte und booten Sie den neuen Kernel.</p></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-ddb"></a>28.6.5.3. DDB Debugger über die serielle Schnittstelle</h4></div></div></div><p>Wenn Sie den Kerneldebugger über eine serielle
	  Verbindung bedienen möchten (nützlich, kann aber
	  gefährlich sein, wenn auf der Leitung falsche BREAK-Signale
	  generiert werden), sollten Sie einen Kernel mit
	  den folgenden Optionen erstellen:</p><pre class="programlisting">options BREAK_TO_DEBUGGER
options DDB</pre></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87403472"></a>28.6.5.4. Benutzung der seriellen Konsole zum Anmelden</h4></div></div></div><p>Da Sie schon die Bootmeldungen auf der Konsole verfolgen
	  können und den Kerneldebugger über die Konsole bedienen
	  können, wollen Sie sich vielleicht auch an der Konsole
	  anmelden.</p><p>Öffnen Sie <code class="filename">/etc/ttys</code> in einem
	  Editor und suchen Sie nach den folgenden Zeilen:</p><pre class="programlisting">ttyu0 "/usr/libexec/getty std.9600" unknown off secure
ttyu1 "/usr/libexec/getty std.9600" unknown off secure
ttyu2 "/usr/libexec/getty std.9600" unknown off secure
ttyu3 "/usr/libexec/getty std.9600" unknown off secure</pre><p><code class="filename">ttyu0</code> bis <code class="filename">ttyu3</code>
	  entsprechen <code class="filename">COM1</code> bis
	  <code class="filename">COM4</code>.  Ändern Sie für die
	  entsprechende Schnittstelle <code class="literal">off</code> zu
	  <code class="literal">on</code>.  Wenn Sie auch die Geschwindigkeit der
	  seriellen Schnittstelle geändert haben, müssen Sie
	  <code class="literal">std.9600</code> auf die momentane Geschwindigkeit, zum
	  Beispiel <code class="literal">std.19200</code>, anpassen.</p><p>Sie sollten auch den Terminaltyp von
	  <code class="literal">unknown</code> auf den tatsächlich verwendeten
	  Terminal setzen.</p><p>Damit die Änderungen an der Datei wirksam werden,
	  müssen Sie noch <code class="command">kill -HUP 1</code>
	  absetzen.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-loader"></a>28.6.6. Die Konsole im Bootloader ändern</h3></div></div></div><p>In den vorigen Abschnitten wurde beschrieben, wie Sie die
        serielle Konsole durch Änderungen im Bootblock aktivieren.
	Dieser Abschnitt zeigt Ihnen, wie Sie mit Kommandos und
	Umgebungsvariablen die Konsole im Bootloader definieren.  Da der
	Bootloader die dritte Phase im Bootvorgang ist und nach den
	Bootblöcken ausgeführt wird, überschreiben
	seine Einstellungen die des Bootblocks.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87416144"></a>28.6.6.1. Festlegen der Konsole</h4></div></div></div><p>Mit einer einzigen Zeile in
	  <code class="filename">/boot/loader.conf</code> können Sie den
	  Bootloader und den Kernel anweisen, die serielle Schnittstelle
	  zur Konsole zu machen:</p><pre class="programlisting">console="comconsole"</pre><p>Unabhängig von den Einstellungen im Bootblock legt dies
	  die Konsole fest.</p><p>Die obige Zeile sollte die erste Zeile in
	  <code class="filename">/boot/loader.conf</code> sein, so dass Sie die
	  Bootmeldungen so früh wie möglich auf der Konsole
	  sehen.</p><p>Analog können Sie die interne Konsole verwenden:</p><pre class="programlisting">console="vidconsole"</pre><p>Wenn Sie <code class="envar">console</code> nicht setzen, bestimmt der
	  Bootloader (und damit auch der Kernel) die Konsole über
	  die <code class="option">-h</code> Option des Bootblocks.</p><p>Sie können die Bootkonsole in
	  <code class="filename">/boot/loader.conf.local</code> oder
	  <code class="filename">/boot/loader.conf</code> angeben.</p><p>Weitere Informationen erhalten Sie in <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=loader.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">loader.conf</span>(5)</span></a>.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Momentan gibt es im Bootloader nichts vergleichbares zu
	    <code class="option">-P</code> im Bootblock.  Damit kann die Konsole nicht
	    automatisch über das Vorhandensein einer Tastatur
	    festgelegt werden.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp87428816"></a>28.6.6.2. Eine andere Schnittstelle als <code class="filename">sio0</code>
	  benutzen</h4></div></div></div><p>Sie müssen den Bootloader neu kompilieren, wenn Sie eine
	  andere Schnittstelle als <code class="filename">sio0</code> benutzen
	  wollen.  Folgen Sie der Anleitung aus
	  <a class="xref" href="serialconsole-setup.html#serialconsole-com2" title="28.6.5.2. Eine andere Schnittstelle als sio0 benutzen">Abschnitt 28.6.5.2, &#8222;Eine andere Schnittstelle als <code class="filename">sio0</code>
	  benutzen&#8220;</a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="serialconsole-caveats"></a>28.6.7. Vorbehalte</h3></div></div></div><p>Hinter dem ganzen steckt die Idee, Server ohne Hardware
        für Grafik und ohne Tastatur zu betreiben.  Obwohl es die
	meisten Systeme erlauben, ohne Tastatur zu booten, gibt es leider
	nur wenige Systeme, die ohne eine Grafikkarte booten.  Maschinen
	mit einem AMI BIOS können ohne Grafik booten, indem Sie den
	Grafikadapter im CMOS-Setup auf <code class="literal">Not installed</code>
	setzen.</p><p>Viele Maschinen unterstützen diese Option allerdings nicht.
        Damit diese Maschinen booten, müssen sie über eine
	Grafikkarte, auch wenn es nur eine alte Monochromkarte ist,
	verfügen.  Allerdings brauchen Sie keinen Monitor an die Karte
	anzuschließen.  Sie können natürlich auch
	versuchen, auf diesen Maschinen ein AMI BIOS zu
	installieren.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="dialout.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="serialcomms.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="ppp-and-slip.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">28.5. Verbindungen nach Außen </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> Kapitel 29. PPP und SLIP</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>