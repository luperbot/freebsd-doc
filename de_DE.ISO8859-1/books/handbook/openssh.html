<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>15.10. OpenSSH</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="security.html" title="Kapitel 15. Sicherheit" /><link rel="prev" href="ipsec.html" title="15.9. VPNs mit IPsec" /><link rel="next" href="fs-acl.html" title="15.11. Zugriffskontrolllisten für Dateisysteme" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.10. OpenSSH</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ipsec.html">Zurück</a> </td><th width="60%" align="center">Kapitel 15. Sicherheit</th><td width="20%" align="right"> <a accesskey="n" href="fs-acl.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="openssh"></a>15.10. OpenSSH</h2></div><div><span class="authorgroup">Beigetragen von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Chern</span> <span class="surname">Lee</span></span>. </span></div></div></div><a id="idp78948816" class="indexterm"></a><a id="idp78949328" class="indexterm"></a><p><span class="application">OpenSSH</span> stellt Werkzeuge bereit,
      um sicher auf entfernte
      Maschinen zuzugreifen.  Die Kommandos <code class="command">rlogin</code>,
      <code class="command">rsh</code>, <code class="command">rcp</code> und
      <code class="command">telnet</code> können durch
      <span class="application">OpenSSH</span> ersetzt werden.
      Zusätzlich können TCP/IP-Verbindungen sicher durch
      SSH weitergeleitet (getunnelt) werden.  Mit SSH werden alle
      Verbindungen verschlüsselt, dadurch wird verhindert, dass
      die Verbindung zum Beispiel abgehört oder übernommen
      (<span class="foreignphrase"><em class="foreignphrase">Hijacking</em></span>) werden kann.</p><p><span class="application">OpenSSH</span> wird vom OpenBSD-Projekt
      gepflegt und basiert auf SSH v1.2.12 mit allen aktuellen
      Fixen und Aktualisierungen.  <span class="application">OpenSSH</span>
      ist mit den SSH-Protokollen der Versionen 1 und 2 kompatibel.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78958672"></a>15.10.1. Vorteile von OpenSSH</h3></div></div></div><p>Mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=telnet&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">telnet</span>(1)</span></a> oder <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rlogin&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rlogin</span>(1)</span></a> werden Daten in
	einer unverschlüsselten Form über das Netzwerk
	gesendet.  Daher besteht die Gefahr, das Benutzer/Passwort
	Kombinationen oder alle Daten an beliebiger Stelle zwischen
	dem Client und dem Server abgehört werden.  Mit
	<span class="application">OpenSSH</span> stehen eine Reihe von
	Authentifizierungs- und Verschlüsselungsmethoden zur
	Verfügung, um das zu verhindern.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78961744"></a>15.10.2. Aktivieren von <span class="application">sshd</span></h3></div></div></div><a id="idp78962640" class="indexterm"></a><p>Unter FreeBSD entscheidet der
        Anwender bei einer <code class="literal">Standard</code>-Installation, ob
        der <span class="application">sshd</span>-Daemon aktiviert werden soll.
        Um zu überprüfen, ob  <span class="application">sshd</span>
        auf Ihrem System aktiviert ist, suchen Sie in
        <code class="filename">rc.conf</code> nach der folgenden Zeile:</p><pre class="programlisting">sshd_enable="YES"</pre><p>Ist diese Zeile vorhanden, wird <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sshd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sshd</span>(8)</span></a>, der
	<span class="application">OpenSSH</span>-Dæmon, beim
	Systemstart automatisch aktiviert.  Alternativ können Sie
	<span class="application">OpenSSH</span> auch über das
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a>-Skript <code class="filename">/etc/rc.d/sshd</code>
	starten:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/sshd start</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78970448"></a>15.10.3. SSH Client</h3></div></div></div><a id="idp78971088" class="indexterm"></a><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a> arbeitet ähnlich wie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rlogin&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rlogin</span>(1)</span></a>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ssh user@example.com</code></strong>
Host key not found from the list of known hosts.
Are you sure you want to continue connecting (yes/no)? <strong class="userinput"><code>yes</code></strong>
Host 'example.com' added to the list of known hosts.
user@example.com's password: <strong class="userinput"><code>*******</code></strong></pre><p>Der Anmeldevorgang wird danach, wie von
        <code class="command">rlogin</code> oder <code class="command">telnet</code> gewohnt,
	weiterlaufen.  SSH speichert einen Fingerabdruck des
	Serverschlüssels.  Die Aufforderung, <code class="literal">yes</code>
	einzugeben, erscheint nur bei der ersten Verbindung zu einem
	Server.  Weitere Verbindungen zu dem Server werden gegen den
	gespeicherten Fingerabdruck des Schlüssels geprüft und
	der Client gibt eine Warnung aus, wenn sich der empfangene
	Fingerabdruck von dem gespeicherten unterscheidet.  Die
	Fingerabdrücke der Version 1 werden in
	<code class="filename">~/.ssh/known_hosts</code>, die der Version 2 in
	<code class="filename">~/.ssh/known_hosts2</code>  gespeichert.</p><p>In der Voreinstellung akzeptieren aktuelle
	<span class="application">OpenSSH</span>-Server nur SSH v2
	Verbindungen.  Wenn möglich, wird Version 2 verwendet,
	ist dies nicht möglich, fällt der Server auf
	Version 1 zurück.  Der Client kann gezwungen werden,
	nur eine der beiden Versionen zu verwenden, indem die Option
	<code class="option">-1</code> (für die Version 1) oder
	<code class="option">-2</code> (für die Version 2) übergeben
	wird.  Die Unterstützung für Version 1 ist nur
	noch aus Kompatibilitätsgründen zu älteren
	Versionen enthalten.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78984016"></a>15.10.4. Secure Copy</h3></div></div></div><a id="idp78984656" class="indexterm"></a><a id="idp78985808" class="indexterm"></a><p>Mit  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=scp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">scp</span>(1)</span></a> lassen sich Dateien analog wie mit
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rcp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rcp</span>(1)</span></a> auf entfernte Maschinen kopieren.  Mit
	<code class="command">scp</code> werden die Dateien allerdings in einer
	sicheren Weise übertragen.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code> scp user@example.com:/COPYRIGHT COPYRIGHT</code></strong>
user@example.com's password:
COPYRIGHT            100% |*****************************|  4735
00:00
<code class="prompt">#</code></pre><p>Da der Fingerabdruck schon im vorigen Beispiel abgespeichert
        wurde, wird er bei der Verwendung von <code class="command">scp</code> in
	diesem Beispiel überprüft.  Da die Fingerabdrücke
	übereinstimmen, wird keine Warnung ausgegeben.</p><p>Die Argumente, die <code class="command">scp</code> übergeben
        werden, gleichen denen von <code class="command">cp</code> in der Beziehung,
	dass die ersten Argumente die zu kopierenden Dateien sind und
	das letzte Argument den Bestimmungsort angibt.  Da die Dateien
	über das Netzwerk kopiert werden, können ein oder mehrere
	Argumente die Form
	<code class="option">user@host:&lt;path_to_remote_file&gt;</code>
	besitzen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78996688"></a>15.10.5. Konfiguration</h3></div></div></div><a id="idp78997328" class="indexterm"></a><p>Die für das ganze System gültigen
        Konfigurationsdateien des
	<span class="application">OpenSSH</span>-Dæmons und des Clients
	finden sich in dem Verzeichnis
	<code class="filename">/etc/ssh</code>.</p><p>Die Client-Konfiguration befindet sich in
        <code class="filename">ssh_config</code>, die des Servers befindet sich in
	<code class="filename">sshd_config</code>.</p><p>Das SSH-System lässt sich weiterhin über die
        Anweisungen <code class="option">sshd_program</code> (Vorgabe ist
	<code class="filename">/usr/sbin/sshd</code>) und
	<code class="option">sshd_flags</code> in <code class="filename">/etc/rc.conf</code>
	konfigurieren.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="security-ssh-keygen"></a>15.10.6. <span class="application">ssh-keygen</span></h3></div></div></div><p>Mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a> können DSA- oder RSA-Schlüssel
        für einen Benutzer erzeugt werden, die anstelle von
	Passwörtern verwendet werden können:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ssh-keygen -t dsa</code></strong>
Generating public/private dsa key pair.
Enter file in which to save the key (/home/user/.ssh/id_dsa):
Created directory '/home/user/.ssh'.
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/user/.ssh/id_dsa.
Your public key has been saved in /home/user/.ssh/id_dsa.pub.
The key fingerprint is:
bb:48:db:f2:93:57:80:b6:aa:bc:f5:d5:ba:8f:79:17 user@host.example.com</pre><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a> erzeugt einen öffentlichen und einen
        privaten Schlüssel für die Authentifizierung.  Der private
        Schlüssel wird in <code class="filename">~/.ssh/id_dsa</code> oder
        <code class="filename">~/.ssh/id_rsa</code> gespeichert, während
        sich der öffentliche Schlüssel in
        <code class="filename">~/.ssh/id_dsa.pub</code> oder
        <code class="filename">~/.ssh/id_rsa.pub</code> befindet, je nachdem,
        ob es sich um einen <acronym class="acronym">DSA</acronym>- oder einen
        <acronym class="acronym">RSA</acronym>-Schlüssel handelt.
        Der öffentliche Schlüssel muss sowohl für
	<acronym class="acronym">RSA</acronym>- als auch für
	<acronym class="acronym">DSA</acronym>-Schlüssel in die Datei
        <code class="filename">~/.ssh/authorized_keys</code> auf dem entfernten
        Rechner aufgenommen werden, damit der Schlüssel
        funktioniert.</p><p>Damit werden Verbindungen zu der entfernten Maschine über
	SSH-Schlüsseln anstelle von Passwörtern
	authentifiziert.</p><p>Wenn bei der Erstellung der Schlüssel mit
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a> ein Passwort angegeben wurde, wird der
	Benutzer bei jeder Anmeldung zur Eingabe des Passworts
	aufgefordert.  Um den Umgang mit SSH-Schlüsseln zu
	erleichtern, kann <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> die Verwaltung dieser
	Schlüssel für Sie übernehmen.  Lesen Sie dazu
	den <a class="xref" href="openssh.html#security-ssh-agent" title="15.10.7. ssh-agent und ssh-add">Abschnitt 15.10.7, &#8222;ssh-agent und ssh-add&#8220;</a> weiter unten.</p><div xmlns="" class="warning"><h3 class="admontitle">Warnung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Die Kommandozeilenoptionen und Dateinamen sind
	  abhängig von der <span class="application">OpenSSH</span>-Version.
	  Die für Ihr System gültigen Optionen finden Sie
	  in der Hilfeseite <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="security-ssh-agent"></a>15.10.7. ssh-agent und ssh-add</h3></div></div></div><p>Mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> und <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-add</span>(1)</span></a> ist es
        möglich, <span class="application">SSH</span>-Schlüssel
        in den Speicher zu laden, damit die Passphrase nicht jedesmal
        eingegeben werden muss.</p><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> übernimmt die Authentifizierung
        von ihm geladener privater Schlüssel.
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> sollte nur dazu verwendet werden, ein
        anderes Programm zu starten, beispielsweise eine Shell oder
        einen Window-Manager.</p><p>Um <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> in einer Shell zu verwenden, muss
        es mit einer Shell als Argument aufgerufen werden.
        Zusätzlich müssen die zu verwaltende Identität
        (durch <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-add</span>(1)</span></a>) sowie deren Passphrase für den
        privaten Schlüssel übergeben werden.  Nachdem dies
        erledigt ist, kann sich ein Benutzer über <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a>
        auf jedem Rechner anmelden, der einen entsprechenden
        öffentlichen Schlüssel besitzt.  Dazu ein
        Beispiel:</p><pre class="screen"><code class="prompt">%</code> ssh-agent <em class="replaceable"><code>csh</code></em>
<code class="prompt">%</code> ssh-add
Enter passphrase for /home/user/.ssh/id_dsa:
Identity added: /home/user/.ssh/id_dsa (/home/user/.ssh/id_dsa)
<code class="prompt">%</code></pre><p>Um <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> unter X11 zu verwenden, müssen
        Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> in Ihre <code class="filename">~/.xinitrc</code>
        aufnehmen.  Dadurch können alle unter X11 gestarteten
        Programme die Dienste von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> nutzen.  Ihre
        <code class="filename">~/.xinitrc</code> könnte dazu etwas so
        aussehen:</p><pre class="programlisting">exec ssh-agent <em class="replaceable"><code>startxfce4</code></em></pre><p>Dadurch wird bei jedem Start von X11 zuerst
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> aufgerufen, das wiederum
        <span class="application">XFCE</span> startet.  Nachdem Sie diese
        Änderung durchgeführt haben, müssen Sie X11
        neu starten.  Danach können Sie mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-add</span>(1)</span></a>
        Ihre SSH-Schlüssel laden.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="security-ssh-tunneling"></a>15.10.8. SSH-Tunnel</h3></div></div></div><a id="idp79052880" class="indexterm"></a><p>Mit <span class="application">OpenSSH</span> ist es möglich,
	einen Tunnel zu erstellen, in dem ein anderes Protokoll
	verschlüsselt übertragen wird.</p><p>Das folgende Kommando erzeugt einen Tunnel für
        <span class="application">telnet</span>:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ssh -2 -N -f -L 5023:localhost:23 user@foo.example.com</code></strong>
<code class="prompt">%</code></pre><p>Dabei wurden die folgenden Optionen von <code class="command">ssh</code>
        verwendet:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-2</code></span></dt><dd><p>Erzwingt die Version 2 des Protokolls (Benutzen Sie die
	      Option nicht mit langsamen
	      <span class="application">SSH</span>-Servern).</p></dd><dt><span class="term"><code class="option">-N</code></span></dt><dd><p>Zeigt an, dass ein Tunnel erstellt werden soll.
	      Ohne diese Option würde <code class="command">ssh</code> eine
	      normale Sitzung öffnen.</p></dd><dt><span class="term"><code class="option">-f</code></span></dt><dd><p>Zwingt <code class="command">ssh</code> im Hintergrund zu
	      laufen.</p></dd><dt><span class="term"><code class="option">-L</code></span></dt><dd><p>Ein lokaler Tunnel wird in der Form
	      <em class="replaceable"><code>localport:remotehost:remoteport</code></em>
	      angegeben.  Die Verbindung wird dabei von dem lokalen Port
	      <em class="replaceable"><code>localport</code></em> auf einen entfernten
	      Rechner weitergeleitet.</p></dd><dt><span class="term"><code class="option">user@foo.example.com</code></span></dt><dd><p>Gibt den entfernten SSH-Server an.</p></dd></dl></div><p>Ein SSH-Tunnel erzeugt ein Socket auf
         <code class="systemitem">localhost</code> und dem angegebenen Port.  Jede
	 Verbindung, die auf dem angegebenen Socket aufgemacht wird, wird
	 dann auf den spezifizierten entfernten Rechner und Port
	 weitergeleitet.</p><p>Im Beispiel wird der Port <em class="replaceable"><code>5023</code></em> auf
	 die entfernte Maschine und dort auf <code class="systemitem">localhost</code>
	 Port <em class="replaceable"><code>23</code></em> weitergeleitet.  Da der Port
	 <em class="replaceable"><code>23</code></em> für
	 <span class="application">Telnet</span> reserviert ist,
	 erzeugt das eine sichere
	 <span class="application">Telnet</span>-Verbindung durch einen
	 SSH-Tunnel.</p><p>Diese Vorgehensweise kann genutzt werden, um jedes unsichere
         TCP-Protokoll wie SMTP, POP3, FTP, usw. weiterzuleiten.</p><div class="example"><a id="idp79072592"></a><div class="example-title">Beispiel 15.1. Mit SSH einen sicheren Tunnel für SMTP erstellen</div><div class="example-contents"><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ssh -2 -N -f -L 5025:localhost:25 user@mailserver.example.com</code></strong>
user@mailserver.example.com's password: <strong class="userinput"><code>*****</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>telnet localhost 5025</code></strong>
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
220 mailserver.example.com ESMTP</pre><p>Zusammen mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a> und zusätzlichen
         Benutzer-Accounts können Sie leicht benutzbare SSH-Tunnel
	 aufbauen.  Anstelle von Passwörtern können Sie
	 Schlüssel benutzen und jeder Tunnel kann unter einem eigenen
	 Benutzer laufen.</p></div></div><br class="example-break" /><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp79080912"></a>15.10.8.1. Beispiel für SSH-Tunnel</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp79081552"></a>15.10.8.1.1. Sicherer Zugriff auf einen POP3-Server</h5></div></div></div><p>Nehmen wir an, an Ihrer Arbeitsstelle gibt es einen
	    SSH-Server, der Verbindungen von außen akzeptiert.  Auf
	    dem Netzwerk Ihrer Arbeitsstelle soll sich zudem noch ein
	    Mail-Server befinden, der POP3 spricht.  Das Netzwerk oder die
	    Verbindung von Ihrem Haus zu Ihrer Arbeitsstelle ist unsicher
	    und daher müssen Sie Ihre E-Mail über eine gesicherte
	    Verbindung abholen können.  Die Lösung zu diesem
	    Problem besteht darin, eine SSH-Verbindung von Ihrem Haus zu
	    dem SSH-Server an Ihrer Arbeitsstelle aufzubauen, und von dort
	    weiter zum Mail-Server zu tunneln.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ssh -2 -N -f -L 2110:mail.example.com:110 user@ssh-server.example.com</code></strong>
user@ssh-server.example.com's password: <strong class="userinput"><code>******</code></strong></pre><p>Wenn Sie den Tunnel eingerichtet haben, konfigurieren Sie
	    Ihren Mail-Client so, dass er POP3 Anfragen zu
	    <code class="systemitem">localhost</code> Port 2110 sendet.  Die Verbindung
	    wird dann sicher zu <code class="systemitem">mail.example.com</code>
	    weitergeleitet.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp79085264"></a>15.10.8.1.2. Umgehen einer strengen Firewall</h5></div></div></div><p>Einige Netzwerkadministratoren stellen sehr drakonische
	    Firewall-Regeln auf, die nicht nur einkommende Verbindungen
	    filtern, sondern auch ausgehende.  Es kann sein, dass Sie
	    externe Maschinen nur über die Ports 22 und 80 (SSH und
	    Web) erreichen.</p><p>Sie wollen auf einen Dienst, der vielleicht nichts mit
	    Ihrer Arbeit zu tun hat, wie einen Ogg Vorbis Musik-Server,
	    zugreifen.  Wenn der Ogg Vorbis Server nicht auf den Ports 22
	    oder 80 läuft, können Sie aber nicht auf ihn
	    zugreifen.</p><p>Die Lösung hier ist es, eine SSH-Verbindung zu einer
	    Maschine außerhalb der Firewall aufzumachen und durch
	    diese zum Ogg Vorbis Server zu tunneln.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ssh -2 -N -f -L 8888:music.example.com:8000 user@unfirewalled-system.example.org</code></strong>
user@unfirewalled-system.example.org's password: <strong class="userinput"><code>*******</code></strong></pre><p>Konfigurieren Sie Ihren Client so, dass er
	    <code class="systemitem">localhost</code> und Port 8888 benutzt.  Die Verbindung
	    wird dann zu <code class="systemitem">music.example.com</code> Port 8000
	    weitergeleitet und Sie haben die Firewall erfolgreich
	    umgangen.</p></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp79094096"></a>15.10.9. Die Option <code class="varname">AllowUsers</code></h3></div></div></div><p>Es ist in der Regel ein gute Idee, festzulegen, welche
        Benutzer sich von welchem Rechner aus anmelden können.
        Dies lässt sich beispielsweise über die Option
        <code class="literal">AllowUsers</code> festlegen.  Soll sich etwa
        nur <code class="systemitem">root</code> vom Rechner mit der IP-Adresse
        <code class="systemitem">192.168.1.32</code> aus einwählen
        dürfen, würden Sie folgenden Eintrag in
        <code class="filename">/etc/ssh/sshd_config</code> aufnehmen:</p><pre class="programlisting">AllowUsers root@192.168.1.32</pre><p>Damit sich <code class="systemitem">admin</code> von jedem Rechner aus
        anmelden kann, geben Sie nur den Benutzernamen an:</p><pre class="programlisting">AllowUsers admin</pre><p>Sie können auch mehrere Benutzer in einer Zeile
        aufführen:</p><pre class="programlisting">AllowUsers root@192.168.1.32 admin</pre><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Nur ein Benutzer, der in dieser Liste aufgeführt ist,
          darf sich auf diesem Rechner anmelden.</p></div><p>Nachdem Sie <code class="filename">/etc/ssh/sshd_config</code>
        angepasst haben, muss <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sshd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sshd</span>(8)</span></a> seine Konfigurationsdateien
        neu einlesen.  Dazu geben Sie Folgendes ein:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/etc/rc.d/sshd reload</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp79107152"></a>15.10.10. Weiterführende Informationen</h3></div></div></div><p><a class="link" href="http://www.openssh.com/" target="_top">OpenSSH</a></p><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh</span>(1)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=scp&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">scp</span>(1)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-keygen</span>(1)</span></a>
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-agent</span>(1)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh-add&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ssh-add</span>(1)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ssh_config&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ssh_config</span>(5)</span></a></p><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sshd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sshd</span>(8)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sftp-server&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sftp-server</span>(8)</span></a> <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sshd_config&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">sshd_config</span>(5)</span></a></p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ipsec.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="security.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="fs-acl.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">15.9. VPNs mit IPsec </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 15.11. Zugriffskontrolllisten für Dateisysteme</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>