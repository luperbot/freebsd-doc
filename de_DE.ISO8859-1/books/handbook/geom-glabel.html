<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>20.6. Das Labeln von Laufwerken</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="GEOM.html" title="Kapitel 20. GEOM: Modulares Framework zur Plattentransformation" /><link rel="prev" href="geom-ggate.html" title="20.5. GEOM Gate Netzwerkgeräte" /><link rel="next" href="geom-gjournal.html" title="20.7. UFS Journaling in GEOM" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">20.6. Das Labeln von Laufwerken</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="geom-ggate.html">Zurück</a> </td><th width="60%" align="center">Kapitel 20. GEOM: Modulares Framework zur
    Plattentransformation</th><td width="20%" align="right"> <a accesskey="n" href="geom-gjournal.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="geom-glabel"></a>20.6. Das Labeln von Laufwerken</h2></div></div></div><a id="idp82475344" class="indexterm"></a><a id="idp82476112" class="indexterm"></a><p>Während der Initialisierung des Systems legt der
      FreeBSD-Kernel für jedes gefundene Gerät Knotenpunkte
      an. Diese Methode für die Überprüfung auf
      vorhandene Geräte wirft einige Fragen auf.  Was passiert
      beispielsweise, wenn ein neues
      <acronym class="acronym">USB</acronym>-Laufwerk hinzugefügt wird?
      Es ist sehr wahrscheinlich, dass ein
      Flash-Speicher-Gerät den Gerätenamen
      <code class="filename">da0</code> erhält, während
      gleichzeitig das bisherige <code class="filename">da0</code>
      zu <code class="filename">da1</code> wird. Dies verursacht
      Probleme beim Einhängen von Dateisystemen, wenn diese
      in der <code class="filename">/etc/fstab</code> aufgeführt
      sind und schlussendlich mag das auch dazu führen,
      dass das System nicht mehr startet.</p><p>Eine Lösung für dieses Problem ist das
      Aneinanderketten der <acronym class="acronym">SCSI</acronym>-Geräte,
      damit ein neues Gerät, welches der
      <acronym class="acronym">SCSI</acronym>-Karte hinzugefügt wird,
      unbenutzte Gerätenummern erhält. Aber was
      geschieht, wenn ein <acronym class="acronym">USB</acronym>-Gerät
      möglicherweise die primäre
      <acronym class="acronym">SCSI</acronym>-Platte ersetzt? Dies kann
      passieren, weil <acronym class="acronym">USB</acronym>-Geräte
      normalerweise vor der <acronym class="acronym">SCSI</acronym>-Karte
      geprüft werden. Eine Lösung ist das
      Hinzufügen dieser Geräte, nachdem das System
      gestartet ist. Eine andere Lösung könnte sein,
      nur ein einzelnes <acronym class="acronym">ATA</acronym>-Laufwerk zu
      nutzen und die <acronym class="acronym">SCSI</acronym>-Geräte niemals
      in der <code class="filename">/etc/fstab</code> aufzuführen.</p><p>Es gibt allerdings eine bessere Lösung. Durch
      Verwendung des <code class="command">glabel</code>-Dienstprogramms
      kann ein Administrator oder Benutzer seine Laufwerke mit
      Labeln versehen und diese in der <code class="filename">/etc/fstab</code>
      nutzen. Da <code class="command">glabel</code> seine Label im letzten
      Sektor jedes vorhandenen Datenträgers speichert, wird
      das Label persistent bleiben (auch über Neustarts hinweg).
      Durch Nutzung dieses Labels als Gerät kann das
      Dateisystem immer gemountet sein, unabhängig davon,
      durch welchen Geräte-Knotenpunkt auf ihn zugegriffen
      wird.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Der Label muss permanent (dauerhaft) sein.
	Man kann das Dienstprogramm <code class="command">glabel</code>
	nutzen, um sowohl transiniente als auch permanente Label
	zu erzeugen. Aber nur permanente (persistente) Label
	bleiben konsistent über Neustarts hinweg. Lesen
	Sie die <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=glabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">glabel</span>(8)</span></a>-Manualpage für weitere
	Unterschiede zwischen den Label-Typen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp82490960"></a>20.6.1. Label-Typen und Beispiele</h3></div></div></div><p>Es gibt zwei Arten von Labeln: generische Label und
	Dateisystem-Label.  Label können dauerhaft (permanent)
	oder temporär sein.  Permanente Label können mit
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tunefs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">tunefs</span>(8)</span></a> oder <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> in einem speziellen
	spezielles Verzeichnis in <code class="filename">/dev</code> erzeugt werden, welches
	entsprechend der Dateisystem-Art benannt wird.
	<acronym class="acronym">UFS</acronym>2-Dateisystem-Label werden zum
	Beispiel im Verzeichnis
	<code class="filename">/dev/ufs</code>
	angelegt.  Permanente Label können außerdem durch
	den Befehl <code class="command">glabel label</code> erzeugt werden.
	Diese Label sind dann allerdings nicht dateisystemspezisch
	und werden im Unterverzeichnis <code class="filename">/dev/label</code> erzeugt.</p><p>Ein temporäres Label verschwindet mit dem
	nächsten Systemstart. Diese Label werden im
	Verzeichnis <code class="filename">/dev/label</code>
	erzeugt und sind ideal für Testzwecke.  Ein temporäres
	Label kann durch den Befehl <code class="command">glabel create</code>
	erzeugt werden.  Weitere Informationen finden sich in der
	Manualpage <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=glabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">glabel</span>(8)</span></a>.</p><p>Um ein permanentes Label auf einem
	<acronym class="acronym">UFS</acronym>2-Dateisystem ohne
	Löschung von Daten zu erzeugen, kann man folgenden
	Befehl verwenden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>tunefs -L home /dev/da3</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Warnung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Wenn das Dateisystem voll ist, kann dies zu
	  Datenkorruption führen; aber egal wie, falls das
	  Dateisystem voll ist, sollte das Hauptziel die
	  Entfernung ungenützter Dateien und nicht das
	  Hinzufügen von Labeln sein.</p></div><p>Ein Label sollte nun in
	<code class="filename">/dev/ufs</code> vorhanden
	sein, der zu <code class="filename">/etc/fstab</code>
	hinzugefügt wird:</p><pre class="programlisting">/dev/ufs/home		/home            ufs     rw              2      2</pre><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Das Dateisystem darf nicht gemountet sein beim
	  Versuch, <code class="command">tunefs</code> auszuführen.</p></div><p>Nun kann das Dateisystem wie üblich gemountet
	werden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /home</code></strong></pre><p>Von nun an kann der Geräte-Knotenpunkt sich ohne
	negative Effekte auf das System ändern, solange das
	Kernelmodul <code class="filename">geom_label.ko</code> beim
	Systemstart mittels <code class="filename">/boot/loader.conf</code>
	geladen wird oder die
	<code class="literal">GEOM_LABEL</code>-Kernel-Option aktiv ist.</p><p>Dateisysteme können auch mit einem Standard-Label
	erzeugt werden (mittels des Flags <code class="option">-L</code> in
	<code class="command">newfs</code>). Lesen Sie bitte die Manualpage
	von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> für weitere Informationen.</p><p>Der folgende Befehl kann genutzt werden, um das Label
	zu beseitigen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>glabel destroy home</code></strong></pre><p>Das folgende Beispiel zeigt Ihnen, wie Sie Label für
	die Partitionen einer Bootplatte erzeugen.</p><div class="example"><a id="idp82517712"></a><div class="example-title">Beispiel 20.1. Die Partitionen einer Bootplatte labeln</div><div class="example-contents"><p>Durch das Erstellen von permanenten Labeln für die
	  Partitionen einer Bootplatte sollte das System selbst dann noch
	  normal starten können, wenn Sie die Platte an einen
	  anderen Controller anschließen oder in ein anderes
	  System installieren.  In diesem Beispiel nehmen wir an, dass
	  nur eine einzige <acronym class="acronym">ATA</acronym>-Platte verwendet wird,
	  die Ihr System derzeit als <code class="filename">ad0</code>
	  erkennt.  Weiters nehmen wir an, dass Sie das
	  Standard-Partionierungsschema von FreeBSD vewendet haben und Ihre
	  Platte daher die Dateisysteme
	  <code class="filename">/</code>,
	  <code class="filename">/var</code>,
	  <code class="filename">/usr</code> sowie
	  <code class="filename">/tmp</code> aufweist.
	  Zusätzlich wurde eine Swap-Partition angelegt.</p><p>Starten Sie das System neu.  Am <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=loader&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">loader</span>(8)</span></a>-Prompt
	  drücken Sie die Taste <span class="keycap"><strong>4</strong></span>, um in den
	  Single-User-Modus zu gelangen.  Dort führen Sie die
	  folgenden Befehle aus:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>glabel label rootfs /dev/ad0s1a</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1a is label/rootfs
<code class="prompt">#</code> <strong class="userinput"><code>glabel label var /dev/ad0s1d</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1d is label/var
<code class="prompt">#</code> <strong class="userinput"><code>glabel label usr /dev/ad0s1f</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1f is label/usr
<code class="prompt">#</code> <strong class="userinput"><code>glabel label tmp /dev/ad0s1e</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1e is label/tmp
<code class="prompt">#</code> <strong class="userinput"><code>glabel label swap /dev/ad0s1b</code></strong>
GEOM_LABEL: Label for provider /dev/ad0s1b is label/swap
<code class="prompt">#</code> <strong class="userinput"><code>exit</code></strong></pre><p>Das System startet daraufhin in den Multi-User-Modus.
	  Nachdem der Startvorgang abgeschlossen ist, editieren Sie die
	  Datei <code class="filename">/etc/fstab</code> und ersetzen die
	  konventionellen Gerätedateien durch die entsprechenden
	  Label.  Ihre modifizierte <code class="filename">/etc/fstab</code>
	  sollte nun ähnlich der folgenden Ausgabe aussehen:</p><pre class="programlisting"># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/label/swap         none            swap    sw              0       0
/dev/label/rootfs       /               ufs     rw              1       1
/dev/label/tmp          /tmp            ufs     rw              2       2
/dev/label/usr          /usr            ufs     rw              2       2
/dev/label/var          /var            ufs     rw              2       2</pre><p>Starten Sie Ihr System neu.  Traten keine Probleme auf,
	  wird das System normal hochfahren und Sie erhalten die folgende
	  Ausgabe, wenn Sie den Befehl <code class="command">mount</code>
	  ausführen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount</code></strong>
/dev/label/rootfs on / (ufs, local)
devfs on /dev (devfs, local)
/dev/label/tmp on /tmp (ufs, local, soft-updates)
/dev/label/usr on /usr (ufs, local, soft-updates)
/dev/label/var on /var (ufs, local, soft-updates)</pre></div></div><br class="example-break" /><p>Beginnend mit FreeBSD 7.2, unterstützt
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=glabel&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">glabel</span>(8)</span></a> einen neuen Labeltyp für
	<acronym class="acronym">UFS</acronym>-Dateisysteme.  Dieser basiert auf der
	eindeutigen Dateisystem-ID <code class="literal">ufsid</code>.
	Derartige Label finden sich im Verzeichnis
	<code class="filename">/dev/ufsid</code> und werden
	während des Systemstarts automatisch erzeugt.  Es ist
	möglich, diese <code class="literal">ufsid</code>-Label zum
	automatischen Einhängen von Partitionen in der Datei
	<code class="filename">/etc/fstab</code> einzusetzen.  Verwenden Sie
	den Befehl <code class="command">glabel status</code>, um eine Liste
	aller Dateisysteme und ihrer <code class="literal">ufsid</code>-Label
	zu erhalten:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>glabel status</code></strong>
                  Name  Status  Components
ufsid/486b6fc38d330916     N/A  ad4s1d
ufsid/486b6fc16926168e     N/A  ad4s1f</pre><p>In diesem Beispiel repräsentiert
	<code class="filename">ad4s1d</code> das
	<code class="filename">/var</code>-Dateisystem,
	während <code class="filename">ad4s1f</code> dem
	<code class="filename">/usr</code>-Dateisystem
	entspricht.  Wenn Sie die angegebenen
	<code class="literal">ufsid</code>-Werte verwenden, können
	diese Dateisysteme durch die folgenden Einträge in
	der Datei <code class="filename">/etc/fstab</code> gemountet
	werden:</p><pre class="programlisting">/dev/ufsid/486b6fc38d330916        /var        ufs        rw        2      2
/dev/ufsid/486b6fc16926168e        /usr        ufs        rw        2      2</pre><p>Jede Partition, die ein <code class="literal">ufsid</code>-Label
	aufweist, kann auf diese Art gemountet werden.  Dies hat
	den Vorteil, dass Sie keine permanenten Label mehr anlegen
	müssen, wobei sich die Platten nach wie vor über
	geräteunabhängige Namen ansprechen und mounten
	lassen.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="geom-ggate.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="GEOM.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="geom-gjournal.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">20.5. GEOM Gate Netzwerkgeräte </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 20.7. UFS Journaling in GEOM</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>