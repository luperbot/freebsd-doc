<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>19.13. Netzwerk-, speicher- und dateibasierte Dateisysteme</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="disks.html" title="Kapitel 19. Speichermedien" /><link rel="prev" href="backup-basics.html" title="19.12. Datensicherung" /><link rel="next" href="snapshots.html" title="19.14. Schnappschüsse von Dateisystemen" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">19.13. Netzwerk-, speicher- und dateibasierte Dateisysteme</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="backup-basics.html">Zurück</a> </td><th width="60%" align="center">Kapitel 19. Speichermedien</th><td width="20%" align="right"> <a accesskey="n" href="snapshots.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="disks-virtual"></a>19.13. Netzwerk-, speicher- und dateibasierte Dateisysteme</h2></div><div><span class="authorgroup">Verbessert und neu strukturiert von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Marc</span> <span class="surname">Fonvieille</span></span>. </span></div></div></div><a id="idp81715792" class="indexterm"></a><p>Neben Laufwerken, die sich physikalisch im Rechner befinden
      wie Diskettenlaufwerke, CDs, Festplatten usw., kann FreeBSD auch
      mit anderen Laufwerken, den <em class="firstterm">virtuellen Laufwerken</em>,
      umgehen.</p><a id="idp81717712" class="indexterm"></a><a id="idp81718224" class="indexterm"></a><a id="idp81718736" class="indexterm"></a><a id="idp81724112" class="indexterm"></a><p>Dazu zählen Netzwerkdateisysteme wie
      <a class="link" href="network-nfs.html" title="31.3. NFS &#8211; Network File System">Network Filesystem</a> und Coda,
      speicher- und dateibasierte Dateisysteme.</p><p>Abhängig von der verwendeten FreeBSD Version werden
      speicher- und dateibasierte Dateisysteme mit unterschiedlichen
      Werkzeugen angelegt.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Gerätedateien werden unter FreeBSD automatisch
	von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">devfs</span>(5)</span></a> angelegt.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="disks-mdconfig"></a>19.13.1. Dateibasierte Laufwerke unter FreeBSD</h3></div></div></div><a id="idp81728976" class="indexterm"></a><p>Unter FreeBSD werden virtuelle Laufwerke
	(<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a>) mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a> erzeugt.  Dazu muss das Modul
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a> geladen sein oder das entsprechende Gerät in der
	Kernelkonfiguration aktiviert sein:</p><pre class="programlisting">device md</pre><p>Mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a> können drei verschiedene virtuelle
        Laufwerke angelegt werden: speicherbasierte Laufwerke, deren
	Speicher von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> zur Verfügung gestellt wird, oder
	dateibasierte Laufwerke, deren Speicher von einer Datei oder dem
	Swap-Bereich zur Verfügung gestellt wird.  Eine mögliche
	Anwendung ist das Einhängen von Dateien, die Abbilder von
	CD-ROMs oder Disketten enthalten.</p><p>Das Abbild eines Dateisystems wird wie folgt
        eingehangen:</p><div class="example"><a id="idp81735632"></a><div class="example-title">Beispiel 19.3. Einhängen eines existierenden Abbildes unter
	  FreeBSD</div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t vnode -f diskimage -u 0</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/md0 /mnt</code></strong></pre></div></div><br class="example-break" /><p>Ein neues Dateisystem-Abbild erstellen Sie mit
        <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a> wie folgt:</p><div class="example"><a id="idp81739344"></a><div class="example-title">Beispiel 19.4. Erstellen eines dateibasierten Laufwerks mit
	  <code class="command">mdconfig</code></div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/dev/zero of=newimage bs=1k count=5k</code></strong>
5120+0 records in
5120+0 records out
<code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t vnode -f newimage -u 0</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>bsdlabel -w md0 auto</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>newfs md0a</code></strong>
/dev/md0a: 5.0MB (10224 sectors) block size 16384, fragment size 2048
        using 4 cylinder groups of 1.25MB, 80 blks, 192 inodes.
super-block backups (for fsck -b #) at:
 160, 2720, 5280, 7840
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/md0a /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>df /mnt</code></strong>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0a       4710    4  4330     0%    /mnt</pre></div></div><br class="example-break" /><p>Wenn Sie keine Gerätenummer mit dem Schalter
        <code class="option">-u</code> angeben, wird von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a> automatisch eine
	ungenutzte Gerätenummer zugewiesen.  Das zugewiesene Gerät
	wird auf der Standardausgabe ausgegeben (zum Beispiel
	<code class="filename">md4</code>).  Weitere Informationen entnehmen Sie
	bitte der Hilfeseite <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a>.</p><p>Das Werkzeug <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a> ist sehr nützlich, doch muss
        man viele Kommandos absetzen, um ein dateibasiertes Dateisystem zu
	erstellen.  FreeBSD enthält das Werkzeug <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdmfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdmfs</span>(8)</span></a>, das
	die notwendigen Schritte in einem Befehl zusammenfasst.  Es
	konfiguriert mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a> ein <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a>-Laufwerk, erstellt
	darauf mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> ein Dateisystem und hängt es
	anschließend mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> ein.  Das virtuelle Laufwerk
	aus dem obigen Beispiel kann somit einfach mit den nachstehenden
	Befehlen erstellt werden:</p><div class="example"><a id="idp81761488"></a><div class="example-title">Beispiel 19.5. Mit <code class="command">mdmfs</code> ein dateibasiertes
	  Dateisystem erstellen</div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>dd if=/dev/zero of=newimage bs=1k count=5k</code></strong>
5120+0 records in
5120+0 records out
<code class="prompt">#</code> <strong class="userinput"><code>mdmfs -F newimage -s 5m md0 /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>df /mnt</code></strong>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0        4718    4  4338     0%    /mnt</pre></div></div><br class="example-break" /><p>Wenn sie die Option <code class="option">md</code> ohne Gerätenummer
        verwenden, wählt <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a> automatisch ein ungenutztes
	Gerät aus.  Weitere Einzelheiten entnehmen Sie bitte der
	Hilfeseite <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdmfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdmfs</span>(8)</span></a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="disks-md-freebsd5"></a>19.13.2. Speicherbasierte Laufwerke unter FreeBSD</h3></div></div></div><a id="idp81772624" class="indexterm"></a><p>Verwenden Sie ein
	speicherbasiertes Dateisystem, sollten Sie die Option
	<span class="quote">&#8222;<span class="quote">swap backing</span>&#8220;</span> aktivieren.   Setzen Sie diese
	Option, heißt dies allerdings nicht, dass das
	speicherbasierte Laufwerk automatisch auf ihre Festplatte
	ausgelagert wird, vielmehr wird der Speicherplatz danach
	aus einem Speicherpool angefordert, der bei Bedarf auf
	die Platte ausgelagert werden kann.  Zusätzlich ist
	es möglich, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a>-gestützte
	speicherbasierte Laufwerke zu erstellen.  Das Anlegen solcher
	Laufwerke kann allerdings zu einer System-Panic führen,
	wenn der Kernel danach über zu wenig Speicher
	verfügt.</p><div class="example"><a id="idp81775312"></a><div class="example-title">Beispiel 19.6. Erstellen eines speicherbasierten Laufwerks mit
	  <code class="command">mdconfig</code></div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t swap -s 5m -u 1</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>newfs -U md1</code></strong>
/dev/md1: 5.0MB (10240 sectors) block size 16384, fragment size 2048
        using 4 cylinder groups of 1.27MB, 81 blks, 192 inodes.
        with soft updates
super-block backups (for fsck -b #) at:
 160, 2752, 5344, 7936
<code class="prompt">#</code> <strong class="userinput"><code>mount /dev/md1 /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>df /mnt</code></strong>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md1        4718    4  4338     0%    /mnt</pre></div></div><br class="example-break" /><div class="example"><a id="idp81787984"></a><div class="example-title">Beispiel 19.7. Erstellen eines speicherbasierten Laufwerks mit
	  <code class="command">mdmfs</code></div><div class="example-contents"><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdmfs -s 5m md2 /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>df /mnt</code></strong>

<code class="prompt">#</code> <strong class="userinput"><code>df /mnt</code></strong>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md2        4846    2  4458     0%    /mnt</pre></div></div><br class="example-break" /></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp81791696"></a>19.13.3. Virtuelle Laufwerke freigeben</h3></div></div></div><a id="idp81792336" class="indexterm"></a><p>Wenn ein virtuelles Laufwerk nicht mehr gebraucht wird, sollten
        Sie dem System die belegten Ressourcen zurückgeben.
	Hängen Sie dazu zuerst das Dateisystem ab und geben Sie dann
	die benutzten Ressourcen mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mdconfig&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mdconfig</span>(8)</span></a> frei.</p><p>Alle von <code class="filename">/dev/md4</code> belegten Ressourcen
        werden mit dem nachstehenden Kommando freigegeben:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -d -u 4</code></strong></pre><p>Eingerichtete <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a>-Geräte werden mit dem Befehl
        <code class="command">mdconfig -l</code> angezeigt.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="backup-basics.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="disks.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="snapshots.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">19.12. Datensicherung </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 19.14. Schnappschüsse von Dateisystemen</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>