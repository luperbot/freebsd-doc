<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>15.8. OpenSSL</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="security.html" title="Kapitel 15. Sicherheit" /><link rel="prev" href="kerberos5.html" title="15.7. Kerberos5" /><link rel="next" href="ipsec.html" title="15.9. VPNs mit IPsec" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.8. OpenSSL</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="kerberos5.html">Zurück</a> </td><th width="60%" align="center">Kapitel 15. Sicherheit</th><td width="20%" align="right"> <a accesskey="n" href="ipsec.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="openssl"></a>15.8. OpenSSL</h2></div><div><span class="authorgroup">Beigetragen von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><a id="idp78788944" class="indexterm"></a><a id="idp78790096" class="indexterm"></a><p>Es wird oft übersehen, dass
      <span class="application">OpenSSL</span> Teil des FreeBSD-Basissystems
      ist.  <span class="application">OpenSSL</span> bietet eine
      verschlüsselte Transportschicht oberhalb der
      normalen Kommunikationsschicht und kann daher zusammen
      mit vielen Netzdiensten benutzt werden.</p><p>Anwendungsbeispiele für <span class="application">OpenSSL</span>
      sind die verschlüsselte Authentifizierung von
      E-Mail-Clients oder Web-Transaktionen wie das Bezahlen mit
      einer Kreditkarte.  <span class="application">OpenSSL</span>
      kann während des Baus in viele Ports, wie
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/www/apache22/pkg-descr">www/apache22</a> und
      <a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/mail/claws-mail/pkg-descr">mail/claws-mail</a>,
      integriert werden.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ist beim Aufruf von <code class="command">make</code> die
	Variable <code class="varname">WITH_OPENSSL_BASE</code> nicht
	explizit auf <code class="literal">yes</code> gesetzt, baut
	die Ports-Sammlung meist den Port
	<a xmlns="" class="package" href="http://www.freebsd.org/cgi/url.cgi?ports/security/openssl/pkg-descr">security/openssl</a>.</p></div><p>Das <span class="application">OpenSSL</span> von FreeBSD stellt
      die Protokolle Secure Sockets Layer v2/v3 (SSLv2/SSLv3) und
      Transport Layer Security v1 (TLSv1) zur Verfügung.
      Die <span class="application">OpenSSL</span>-Bibliotheken stellen
      kryptographische Funktionen bereit.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Mit <span class="application">OpenSSL</span> kann der
	<acronym class="acronym">IDEA</acronym>-Algorithmus verwendet werden,
	wegen Patenten in den USA ist der Algorithmus in der
	Voreinstellung allerdings deaktiviert.  Wenn Sie die
	<acronym class="acronym">IDEA</acronym>-Lizenz akzeptieren, können
	Sie den <acronym class="acronym">IDEA</acronym>-Algorithmus aktivieren,
	indem Sie die Variable <code class="varname">MAKE_IDEA</code>
	in <code class="filename">make.conf</code> setzen.</p></div><p>Meist wird <span class="application">OpenSSL</span> eingesetzt,
      um Zertifikate für Anwendungen bereitzustellen.  Die
      Zertifikate stellen die Identität einer Firma oder
      eines Einzelnen sicher.  Wenn ein Zertifikat nicht von
      einer Zertifizierungsstelle (<span class="foreignphrase"><em class="foreignphrase">Certificate
        Authority</em></span>, <acronym class="acronym">CA</acronym>)
      gegengezeichnet wurde, erhalten Sie normalerweise eine
      Warnung.  Eine Zertifizierungsstelle ist eine Firma
      wie <a class="link" href="http://www.verisign.com/" target="_top">VeriSign</a>,
      die Zertifikate von Personen oder Firmen
      gegenzeichnet und damit die Korrektheit der Zertifikate
      bestätigt.  Diese Prozedur kostet Geld, ist aber
      keine Voraussetzung für den Einsatz von Zertifikaten,
      beruhigt aber sicherheitsbewusste Benutzer.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78823376"></a>15.8.1. Zertifikate erzeugen</h3></div></div></div><a id="idp78824016" class="indexterm"></a><p>Ein Zertifikat erzeugen Sie mit dem nachstehenden
	Kommando:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl req -new -nodes -out req.pem -keyout cert.pem</code></strong>
Generating a 1024 bit RSA private key
................++++++
.......................................++++++
writing new private key to 'cert.pem'
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:<strong class="userinput"><code>US</code></strong>
State or Province Name (full name) [Some-State]:<strong class="userinput"><code>PA</code></strong>
Locality Name (eg, city) []:<strong class="userinput"><code>Pittsburgh</code></strong>
Organization Name (eg, company) [Internet Widgits Pty Ltd]:<strong class="userinput"><code>My Company</code></strong>
Organizational Unit Name (eg, section) []:<strong class="userinput"><code>Systems Administrator</code></strong>
Common Name (eg, YOUR name) []:<strong class="userinput"><code>localhost.example.org</code></strong>
Email Address []:<strong class="userinput"><code>trhodes@FreeBSD.org</code></strong>

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:<strong class="userinput"><code>SOME PASSWORD</code></strong>
An optional company name []:<strong class="userinput"><code>Another Name</code></strong></pre><p>Beachten Sie bitte, dass die Eingabe bei
	<span class="quote">&#8222;<span class="quote">Common Name</span>&#8220;</span> ein gültiger Domain-Name
	sein muss.  Eine andere Eingabe erzeugt ein unbrauchbares
	Zertifikat.  Das Zertifikat kann mit einer
	Gültigkeitsdauer und anderen
	Verschlüsselungsalgorithmen erzeugt werden.
	Die Hilfeseite <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=openssl&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">openssl</span>(1)</span></a> beschreibt die zur
	Verfügung stehenden Optionen.</p><p>Das Verzeichnis, in dem Sie den letzten Befehl ausgeführt
	haben, enthält nun zwei Dateien:  Die Anforderung für
	ein neues Zertifikat wurde in <code class="filename">req.pem</code>
	gespeichert.  Diese Datei können Sie an eine
	Zertifizierungsstelle senden, wo Ihre Angaben geprüft werden.
	Nach erfolgreicher Prüfung wird das Zertifikat an Sie
	zurückgesandt.  Die zweite Datei, <code class="filename">cert.pem</code>,
	enthält den privaten Schlüssel für Ihr Zertifikat
	und darf auch keine Fall in fremde Hände geraten, da ein
	Angreifer sonst in der Lage ist, anderen Personen oder Rechnern
	vorzugaukeln, dass es sich bei ihm um Sie handelt.</p><p>Wenn Sie keine Signatur einer Zertifizierungsstelle
	benötigen, können Sie ein selbst-signiertes
	Zertifikat erstellen.  Erzeugen Sie dazu zuerst einen
	<acronym class="acronym">RSA</acronym>-Schlüssel:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl dsaparam -rand -genkey -out myRSA.key 1024</code></strong></pre><p>Erzeugen Sie dann den <acronym class="acronym">CA</acronym>-Schlüssel:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl gendsa -des3 -out myca.key myRSA.key</code></strong></pre><p>Erstellen Sie mit diesem Schlüssel das
        Zertifikat:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openssl req -new -x509 -days 365 -key myca.key -out new.crt</code></strong></pre><p>Zwei neue Dateien befinden sich nun im Verzeichnis:
	Der Schlüssel der Zertifizierungsstelle
	<code class="filename">myca.key</code> und das Zertifikat selbst,
	<code class="filename">new.crt</code>.  Sie sollten in einem
	Verzeichnis, vorzugsweise unterhalb von
	<code class="filename">/etc</code> abgelegt
	werden, das nur von <code class="systemitem">root</code> lesbar
	ist.  Setzen Sie die Zugriffsrechte der Dateien mit
	<code class="command">chmod</code> auf <code class="literal">0700</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp78844752"></a>15.8.2. Beispiel für Zertifikate</h3></div></div></div><p>Was fangen Sie mit einem Zertifikat an?  Sie
	könnten damit beispielsweise die Verbindungen zu
	<span class="application">Sendmail</span> verschlüsseln.
	Dies würde die Klartext-Authentifizierung
	für Benutzer des lokalen <acronym class="acronym">MTA</acronym>
	überflüssig machen.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Das ist nicht unbedingt die beste Lösung,
	  da einige <acronym class="acronym">MUA</acronym>s Warnungen ausgeben,
	  wenn ein Zertifikat nicht lokal installiert ist.
	  Die Installation von Zertifikaten wird in der
	  Dokumentation der <acronym class="acronym">MUA</acronym>s
	  beschrieben.</p></div><p>Ergänzen Sie die Konfigurationsdatei von
	<span class="application">sendmail</span> (<code class="filename">.mc</code>)
	um die nachstehenden Zeilen:</p><pre class="programlisting">dnl SSL Options
define(`confCACERT_PATH',`/etc/certs')dnl
define(`confCACERT',`/etc/certs/new.crt')dnl
define(`confSERVER_CERT',`/etc/certs/new.crt')dnl
define(`confSERVER_KEY',`/etc/certs/myca.key')dnl
define(`confTLS_SRV_OPTIONS', `V')dnl</pre><p>Im Verzeichnis <code class="filename">/etc/certs</code>
        befindet sich der Schlüssel und das Zertifikat.  Bauen Sie danach
        im Verzeichnis <code class="filename">/etc/mail</code>
	mit dem Kommando <code class="command">make
	install</code> die
	<code class="filename">.cf</code>-Datei und starten Sie anschließend
	<span class="application">sendmail</span> mit <code class="command">make
	restart</code> neu.</p><p>Wenn alles gut ging, erscheinen keine Fehlermeldungen
	in der Datei <code class="filename">/var/log/maillog</code> und
	Sie sehen <span class="application">sendmail</span> in der
	Prozessliste.</p><p>Testen Sie nun den Mailserver mit dem Kommando
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=telnet&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">telnet</span>(1)</span></a>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>telnet example.com 25</code></strong>
Trying 192.0.34.166...
Connected to <code class="systemitem">example.com</code>.
Escape character is '^]'.
220 <code class="systemitem">example.com</code> ESMTP Sendmail 8.12.10/8.12.10; Tue, 31 Aug 2004 03:41:22 -0400 (EDT)
<strong class="userinput"><code>ehlo example.com</code></strong>
250-example.com Hello example.com [192.0.34.166], pleased to meet you
250-ENHANCEDSTATUSCODES
250-PIPELINING
250-8BITMIME
250-SIZE
250-DSN
250-ETRN
250-AUTH LOGIN PLAIN
250-STARTTLS
250-DELIVERBY
250 HELP
<strong class="userinput"><code>quit</code></strong>
221 2.0.0 <code class="systemitem">example.com</code> closing connection
Connection closed by foreign host.</pre><p>Wenn in einer Zeile <code class="literal">STARTTLS</code>
	erscheint, hat alles funktioniert.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="kerberos5.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="security.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="ipsec.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">15.7. <span class="application">Kerberos5</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 15.9. VPNs mit IPsec</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>