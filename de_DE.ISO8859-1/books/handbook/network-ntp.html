<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>31.10. Die Uhrzeit mit NTP synchronisieren</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="network-servers.html" title="Kapitel 31. Netzwerkserver" /><link rel="prev" href="network-samba.html" title="31.9. Mit Samba einen Datei- und Druckserver für Microsoft® Windows®-Clients einrichten" /><link rel="next" href="network-syslogd.html" title="31.11. Protokollierung von anderen Hosts mittels syslogd" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">31.10. Die Uhrzeit mit NTP synchronisieren</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="network-samba.html">Zurück</a> </td><th width="60%" align="center">Kapitel 31. Netzwerkserver</th><td width="20%" align="right"> <a accesskey="n" href="network-syslogd.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="network-ntp"></a>31.10. Die Uhrzeit mit NTP synchronisieren</h2></div><div><span class="authorgroup">Beigetragen von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Hukins</span></span>. </span></div></div></div><a id="idp90828112" class="indexterm"></a><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90828624"></a>31.10.1. Überblick</h3></div></div></div><p>Da die interne Uhrzeit eines Computers nie ganz exakt ist,
	wurde mit NTP
	(<span class="foreignphrase"><em class="foreignphrase">Network Time Protocol</em></span>) eine
	Möglichkeit geschaffen, die exakte Uhrzeit zu ermitteln
	und festzulegen.</p><p>Viele Internetdienste sind von einer exakten Uhrzeit
	abhängig.  Ein Webserver könnte beispielsweise die
	Anforderung erhalten, eine Datei zu versenden, wenn sich diese
	in einer bestimmten Zeitspanne geändert hat.  In einem
	lokalen Netzwerk ist es unbedingt notwendig, dass Rechner, die
	Dateien von einem gemeinsamen Dateiserver beziehen, ihre
	Uhrzeit synchronisieren, damit die Zeitstempel der Dateien
	konstistent bleiben.  Dienste wie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a> führen
	Befehle zu einem bestimmten Zeitpunkt aus.  Ist die Uhrzeit
	nicht korrekt, kann dies zu Problemen führen.</p><a id="idp90831184" class="indexterm"></a><p>FreeBSD verwendet den <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a>-
	<acronym class="acronym">NTP</acronym>-Server,
	um die genaue Uhrzeit von anderen
	<acronym class="acronym">NTP</acronym>-Servern
	abzufragen, die eigene Systemzeit zu setzen, oder um diese
	anderen Rechnern anzubieten.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90838864"></a>31.10.2. Einen passenden NTP-Server auswählen</h3></div></div></div><a id="idp90839504" class="indexterm"></a><p>Um die Uhrzeit zu synchronisieren, müssen Sie sich mit
	einem
	<acronym class="acronym">NTP</acronym>-Server
	verbinden.  Ihr Netzwerkadministrator oder Ihr Internetprovider
	haben vielleicht schon einen NTP-Server eingerichtet.  Lesen Sie
	deren Dokumentation, um dies zu überprüfen.  Es gibt
	im Internet eine
	<a class="link" href="http://support.ntp.org/bin/view/Servers/WebHome" target="_top">
	Liste mit frei zugänglichen NTP-Servern</a>, aus der
	Sie sich einen in Ihrer Nähe gelegenen Server
	auswählen können.  Beachten Sie aber auf jeden Fall
	die Nutzungsbedingungen des entsprechenden Servers, und fragen
	Sie um Erlaubnis, wenn dies nötig ist.</p><p>Die Auswahl von mehreren NTP-Servern kann sinnvoll sein,
	wenn ein Server ausfällt oder falsche Zeiten liefert.
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> verwendet die Antworten anderer Server, um
	zuverlässige Server zu bestimmen, die dann bevorzugt
	abgefragt werden.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90843344"></a>31.10.3. NTP unter FreeBSD einrichten</h3></div></div></div><a id="idp90843984" class="indexterm"></a><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90845136"></a>31.10.3.1. NTP aktivieren</h4></div></div></div><a id="idp90845904" class="indexterm"></a><p>Wenn Sie Ihre Uhrzeit nur beim Systemstart
	  synchronisieren wollen, können Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a>
	  verwenden.  Für Desktoprechner, die regelmäßig
	  neu gestartet werden und keine ständige Synchronisation
	  benötigen, ist dies akzeptabel.  In allen anderen
	  Fällen sollten Sie jedoch <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> verwenden.</p><p>Die Ausführung von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a> während des
	  Systemstarts ist aber auch für Rechner, die <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a>
	  verwenden, sinnvoll.  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> passt die Systemzeit nur
	  bei größeren Abweichungen an, während
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a> die Zeit immer synchronisiert, egal wie
	  groß die Differenz zwischen Systemzeit und korrekter
	  Zeit ist.</p><p>Um <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a> beim Systemstart zu aktivieren,
	  fügen Sie den Eintrag
	  <code class="literal">ntpdate_enable="YES"</code> in
	  <code class="filename">/etc/rc.conf</code> ein.  Außerdem müssen
	  Sie alle Server, mit denen Sie sich synchronisieren wollen,
	  sowie alle an <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpdate&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpdate</span>(8)</span></a> zu übergebenden Optionen
	  in den <code class="varname">ntpdate_flags</code> angeben.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90859472"></a>31.10.3.2. NTP einrichten</h4></div></div></div><a id="idp90860112" class="indexterm"></a><p>Die Konfiguration von NTP erfolgt über die Datei
	  <code class="filename">/etc/ntp.conf</code>, und wird in der
	  Hilfeseite <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ntp.conf</span>(5)</span></a> beschrieben.  Dazu ein
	  einfaches Beispiel:</p><pre class="programlisting">server ntplocal.example.com prefer
server timeserver.example.org
server ntp2a.example.net

driftfile /var/db/ntp.drift</pre><p>Die Option <code class="literal">server</code> legt die zu
	  verwendenden Server fest, wobei jeder Server in einer eigenen
	  Zeile steht.  Wenn ein Server mit der Option
	  <code class="literal">prefer</code> versehen ist, wie dies hier bei
	  <code class="systemitem">ntplocal.example.com</code> der Fall
	  ist, wird dieser Server bevorzugt verwendet.  Eine Antwort von
	  einem bevorzugten Server wird nur dann verworfen, wenn sie
	  signifikant von denen anderer Server abweicht, ansonsten wird
	  sie ohne Abfrage weiterer Server verwendet.  Die Option
	  <code class="literal">prefer</code> wird gewöhnlich nur für
	  sehr zuverlässige und genaue Server verwendet, die
	  über eine spezielle Hardware zur Zeitüberwachung
	  verfügen.</p><p>Die Option <code class="literal">driftfile</code> legt fest, in
	  welcher Datei die Abweichungen der Systemuhr protokolliert
	  werden.  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> verwendet diese Datei, um die Systemzeit
	  automatisch anzupassen, selbst wenn kurzzeitig kein NTP-Server
	  zur Synchronisation verfügbar ist.</p><p>Weiterhin legt die Option <code class="literal">driftfile</code> fest,
	  wo Informationen über frühere Antworten des von
	  Ihnen verwendeten NTP-Servers gespeichert werden sollen.
	  Diese Datei enthält NTP-interne Informationen, sie sollte
	  daher von anderen Prozessen nicht verändert werden.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90872016"></a>31.10.3.3. Den Zugang zu Ihrem NTP-Server beschränken</h4></div></div></div><p>In der Voreinstellung ist Ihr NTP-Server für alle
	  Rechner im Internet erreichbar.  Über die Option
	  <code class="literal">restrict</code> in der Datei
	  <code class="filename">/etc/ntp.conf</code> können Sie den
	  Zugang zu Ihrem Server beschränken.</p><p>Wenn Sie alle Rechner vom Zugriff auf Ihren NTP-Server
	  ausschließen wollen, fügen Sie folgende Zeile in
	  <code class="filename">/etc/ntp.conf</code> ein:</p><pre class="programlisting">restrict default ignore</pre><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Durch diesen Eintrag verhindern Sie den Zugriff Ihres
	    Servers auf alle auf Ihrem System konfigurierten Server.
	    Müssen Sie Ihren NTP-Server mit einem externen
	    NTP-Server synchronisieren, müssen Sie dies daher
	    dezidiert zulassen.  Lesen Sie in diesem Fall die
	    Manualpage <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ntp.conf</span>(5)</span></a>.</p></div><p>Wenn Sie nur Rechnern Ihres eigenen Netzwerks die
	  Synchronisation mit Ihrem NTP-Server erlauben, gleichzeitig
	  aber verhindern wollen, dass diese den NTP-Server
	  konfigurieren oder als Server für andere Rechner dienen
	  können, fügen Sie folgende Zeile ein:</p><pre class="programlisting">restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap</pre><p>Bei <code class="systemitem">192.168.1.0</code> handelt es
	  sich um einen Rechner Ihres Netzwerks.
	  <code class="systemitem">255.255.255.0</code> ist die
	  Netzmaske Ihres Netzwerks.</p><p><code class="filename">/etc/ntp.conf</code> kann verschiedene
	  <code class="literal">restrict</code>-Optionen enthalten.
	  Weiteres erfahren Sie im Abschnitt
	  <code class="literal">Access Control Support</code> der
	  Hilfeseite <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">ntp.conf</span>(5)</span></a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90881360"></a>31.10.4. Den NTP-Server starten</h3></div></div></div><p>Damit der NTP-Server beim Systemstart automatisch gestartet
	wird, fügen Sie den Eintrag
	<code class="literal">ntpd_enable="YES"</code> in
	<code class="filename">/etc/rc.conf</code> ein.  Wenn Sie weitere
	Argumente an <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> übergeben wollen, passen Sie
	die Option <code class="varname">ntpd_flags</code> in der Datei
	<code class="filename">/etc/rc.conf</code> entsprechend an.</p><p>Um den NTP-Server ohne einen Systemneustart zu starten,
	rufen Sie <code class="command">ntpd</code> mit den unter
	<code class="varname">ntpd_flags</code> in
	<code class="filename">/etc/rc.conf</code> festgelegten Parametern auf.
	Hierzu ein Beispiel:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ntpd -p /var/run/ntpd.pid</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90887376"></a>31.10.5. <span class="application">ntpd</span> mit einer
        Einwahlverbindung verwenden</h3></div></div></div><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> benötigt keine ständige
	Internetverbindung.  Wenn Sie sich ins Internet einwählen,
	ist es sinnvoll, zu verhindern, dass NTP-Verkehr eine Verbindung
	aufbauen oder aufrechterhalten kann.  Wenn Sie user-PPP
	verwenden, können Sie dies in den
	<code class="literal">filter</code>-Direktiven von
	<code class="filename">/etc/ppp/ppp.conf</code> festlegen.  Sehen Sie
	sich dazu das folgende Beispiel ein:</p><pre class="programlisting">set filter dial 0 deny udp src eq 123
# Prevent NTP traffic from initiating dial out
set filter dial 1 permit 0 0
set filter alive 0 deny udp src eq 123
# Prevent incoming NTP traffic from keeping the connection open
set filter alive 1 deny udp dst eq 123
# Prevent outgoing NTP traffic from keeping the connection open
set filter alive 2 permit 0/0 0/0</pre><p>Weitere Informationen finden Sie im Abschnitt
	<code class="literal">PACKET FILTERING</code> von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ppp&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ppp</span>(8)</span></a> sowie in den
	Beispielen unter <code class="filename">/usr/share/examples/ppp/</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Einige Internetprovider blockieren Ports mit niedrigen
	Nummern.  In solchen Fällen funktioniert NTP leider
	nicht, da Antworten eines NTP-Servers Ihren Rechner nicht
	erreichen werden.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp90893008"></a>31.10.6. Weitere Informationen</h3></div></div></div><p>Weiterführende Dokumentation (im HTML-Format)
	zum NTP-Server finden Sie unter
	<code class="filename">/usr/share/doc/ntp/</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="network-samba.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="network-servers.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="network-syslogd.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">31.9. Mit Samba einen Datei- und Druckserver für
      <span class="trademark">Microsoft</span>® <span class="trademark">Windows</span>®-Clients einrichten </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 31.11. Protokollierung von anderen Hosts mittels
      <code class="command">syslogd</code></td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>