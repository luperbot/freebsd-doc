<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>26.7. Das komplette Basissystem neu bauen</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="updating-upgrading.html" title="Kapitel 26. FreeBSD aktualisieren" /><link rel="prev" href="synching.html" title="26.6. Synchronisation der Quellen" /><link rel="next" href="make-delete-old.html" title="26.8. Veraltete Dateien, Verzeichnisse und Bibliotheken löschen" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">26.7. Das komplette Basissystem neu bauen</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="synching.html">Zurück</a> </td><th width="60%" align="center">Kapitel 26. FreeBSD aktualisieren</th><td width="20%" align="right"> <a accesskey="n" href="make-delete-old.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makeworld"></a>26.7. Das komplette Basissystem neu bauen</h2></div></div></div><a id="idp85695440" class="indexterm"></a><p>Wenn Sie Ihren lokalen Quellbaum mit einer bestimmten FreeBSD
      Version (FreeBSD-STABLE, FreeBSD-CURRENT, usw.) synchronisiert haben,
      können Sie diesen benutzen, um das System neu zu
      bauen.</p><div xmlns="" class="warning"><h3 class="admontitle">Erstellen Sie eine Sicherungskopie!: </h3><p xmlns="http://www.w3.org/1999/xhtml">Es kann nicht oft genug betont werden, wie wichtig es ist, Ihr
        System zu sichern, <span class="emphasis"><em>bevor</em></span> Sie die nachfolgenden
	Schritte ausführen.  Obwohl der Neubau des Systems eine
	einfache Aufgabe ist, wenn Sie sich an die folgende Anleitung
	halten, kann es dennoch vorkommen, dass Sie einen Fehler machen,
	oder dass Ihr System nicht mehr bootet, weil andere Entwickler
	Fehler in den Quellbaum eingeführt haben.</p><p xmlns="http://www.w3.org/1999/xhtml">Stellen Sie sicher, dass Sie eine Sicherung erstellt haben
        und über eine Fixit-Floppy oder eine startfähige CD
	verfügen.  Wahrscheinlich werden Sie die Startmedien
	nicht benötigen, aber gehen Sie auf Nummer sicher!</p></div><div xmlns="" class="warning"><h3 class="admontitle">Abonnieren Sie die richtige Mailingliste: </h3><a xmlns="http://www.w3.org/1999/xhtml" id="idp85699152" class="indexterm"></a><p xmlns="http://www.w3.org/1999/xhtml">Die FreeBSD-STABLE und FreeBSD-CURRENT Zweige befinden sich in
        <span class="emphasis"><em>ständiger Entwicklung</em></span>.  Die Leute, die zu
	FreeBSD beitragen, sind Menschen und ab und zu machen sie
	Fehler.</p><p xmlns="http://www.w3.org/1999/xhtml">Manchmal sind diese Fehler harmlos und lassen Ihr System eine
        Warnung ausgeben.  Die Fehler können allerdings auch
	katastrophal sein und dazu führen, dass Sie Ihr System
	nicht mehr booten können, Dateisysteme beschädigt
	werden oder Schlimmeres passiert.</p><p xmlns="http://www.w3.org/1999/xhtml">Wenn solche Probleme auftauchen, wird ein
	<span class="quote">&#8222;<span class="quote">heads up</span>&#8220;</span> an die passende Mailingliste geschickt, welches
	das Problem erklärt und die betroffenen Systeme benennt.  Eine
	<span class="quote">&#8222;<span class="quote">all clear</span>&#8220;</span> Meldung wird versendet, wenn das
	Problem gelöst ist.</p><p xmlns="http://www.w3.org/1999/xhtml">Wenn Sie FreeBSD-STABLE oder FreeBSD-CURRENT benutzen und nicht die
        Mailinglisten <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-stable" target="_top">FreeBSD-STABLE</a> beziehungsweise <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/freebsd-current" target="_top">FreeBSD-CURRENT</a> lesen, bringen
	Sie sich nur unnötig in Schwierigkeiten.</p></div><div xmlns="" class="warning"><h3 class="admontitle">Finger weg von <code xmlns="http://www.w3.org/1999/xhtml" class="command">make world</code>: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ältere Dokumentationen empfehlen, das Kommando
	<code class="command">make world</code> für den Neubau.
	Das Kommando überspringt wichtige Schritte.  Setzen
	Sie es nur ein, wenn Sie wissen was Sie tun.  In fast
	allen Fällen ist <code class="command">make world</code>
	falsch, benutzen Sie stattdessen die nachstehende
	Anleitung.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="canonical-build"></a>26.7.1. Richtig aktualisieren</h3></div></div></div><p>Um Ihr System zu aktualisieren, sollten Sie zuerst
	<code class="filename">/usr/src/UPDATING</code> lesen, und
	eventuelle, für Ihre Quellcodeversion nötigen
	Aufgaben erledigen, bevor Sie das System bauen.  Danach
	aktualisieren Sie Ihr System mit den folgenden
	Schritten.</p><p>Bei den hier dargestellten Aktualisierungsschritten wird davon
        ausgegangen, dass Sie momentan eine alte FreeBSD-Version verwenden, die
        aus einem alten Compiler, Kernel, sowie einem alten Basissystem und
        veralteten Konfigurationsdateien besteht.  Mit
        <span class="quote">&#8222;<span class="quote">Basissystem</span>&#8220;</span> sind hier die zentralen Binärdateien,
        Bibliotheken und Entwicklerdateien gemeint.  Der Compiler ist Teil
        des <span class="quote">&#8222;<span class="quote">Basissystems</span>&#8220;</span>, beinhaltet aber ein paar
        Besonderheiten.</p><p>Es wird ausserdem davon ausgegangen, dass Sie bereits die Quellen
        für ein neues System bezogen haben.  Falls die Quellen in dem
        vorliegenden System zu alt sind, lesen Sie <a class="xref" href="synching.html" title="26.6. Synchronisation der Quellen">Abschnitt 26.6, &#8222;Synchronisation der Quellen&#8220;</a>,
        um detaillierte Hilfe über die Aktualisierung der Quellen zu
        erhalten.</p><p>Die Aktualisierung des Systems aus den Quellen ist ein wenig
        ausgetüftelter als es zunächst den Anschein hat. Die
        Entwickler von FreeBSD haben es über die Jahre für Nötig
        befunden, den vorgeschlagenen Ablauf ziemlich stark zu
        verändern, da neue Arten von unvermeidlichen Abhängigkeiten
        mit der Zeit ans Licht kamen.  Der übrige Teil dieses Abschnitts
        beschreibt die Überlegungen hinter der aktuell empfohlenen
        Aktualisierungsreihenfolge.</p><p>Jede erfolgreiche Aktualisierung muss sich mit den folgenden
        Sachverhalten auseinandersetzen:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Der alte Compiler ist möglicherweise nicht in der Lage,
            den neuen Kernel zu übersetzen (alte Compiler besitzen
            manchmal Fehler).  Deshalb sollte der neue Kernel mit dem neuen
            Compiler übersetzt werden.  Ganz besonders muss darauf
            geachtet werden, dass der neue Compiler vor dem neuen Kernel
            gebaut wird.  Das bedeutet nicht unbedingt, dass der neue
            Compiler auch <span class="emphasis"><em>installiert</em></span> werden muss, bevor
            der neue Kernel gebaut wird.</p></li><li class="listitem"><p>Das neue Basissystem benötigt eventuell neue
            Eigenschaften des Kernels. Also muss der neue Kernel installiert
            sein, bevor das neue Basissystem installiert wird.</p></li></ul></div><p>Diese ersten beiden Sachverhalte sind die Grundlage für die
        zentrale Sequenz von <code class="buildtarget">buildworld</code>,
        <code class="buildtarget">buildkernel</code>,
        <code class="buildtarget">installkernel</code> und
        <code class="buildtarget">installworld</code>, die in den folgenden
        Abschnitten beschrieben wird.  Dies ist keine vollständige Liste
        all der Gründe, warum Sie den aktuell empfohlenen Prozess der
        Aktualisierung bevorzugen sollten.  Ein paar der weniger
        naheliegenden Gründe sind im folgenden aufgezählt:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Das alte Basissystem wird möglicherweise nicht korrekt
           mit dem neuen Kernel funktionieren, weshalb Sie das neue
           Basissystem sofort nach der Installation des neuen Kernels
           installieren müssen.</p></li><li class="listitem"><p>Manche Änderungen an der Konfiguration müssen
  	   erledigt worden sein, bevor das neue Basissystem installiert wird,
  	   jedoch können andere die Funktionalität des alten
  	   Basissystems beeinträchtigen.  Aus diesem Grund sind zwei
  	   verschiedene Schritte notwendig, um eine Aktualisierung der
  	   Konfiguration durchzuführen.</p></li><li class="listitem"><p>Der Aktualisierungsprozess ersetzt zum Grossteil Dateien oder
           fügt neue hinzu, bestehende Dateien werden nicht
           gelöscht.  In wenigen Ausnahmefällen kann dies Probleme
           verursachen.  Aus diesem Grund wird der Aktualisierungsprozess
           manchmal bestimmte Dateien zum manuellen Löschen vorschlagen.
           Dies wird eventuell in der Zukunft automatisch
           durchgeführt.</p></li></ul></div><p>Diese Bedenken haben zu der folgenden Reihenfolge geführt.
       Beachten Sie, dass der genaue Ablauf für bestimmte
       Aktualisierungen zusätzliche Schritte nach sich zieht, jedoch
       sollte der Kernprozess davon nicht beeinträchtigt werden:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><code class="command">make
           buildworld</code></p><p>Dieser Schritt übersetzt zuerst den neuen Compiler und
           ein paar damit zusammenhängende Werkzeuge und verwendet dann
           den neuen Compiler, um den Rest des Basissystems zu erstellen.
           Das Ergebnis landet dann in <code class="filename">/usr/obj</code>.</p></li><li class="listitem"><p><code class="command">make
           buildkernel</code></p><p>Statt dem alten Ansatz, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=config&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">config</span>(8)</span></a> und
           <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> zu verwenden, nutzt dieser den
           <span class="emphasis"><em>neuen</em></span> Compiler, der in <code class="filename">/usr/obj</code> abgelegt ist.
           Das schützt Sie vor falschen
           Compiler-Kernel-Kombinationen.</p></li><li class="listitem"><p><code class="command">make
           installkernel</code></p><p>Platziert den neuen Kernel und Kernelmodule auf der Platte,
           was es erlaubt, mit dem frisch aktualisierten Kernel zu
           starten.</p></li><li class="listitem"><p>Starten Sie das System neu in den Single-User-Modus.</p><p>Der Single-User-Modus minimiert Probleme mit der
           Aktualisierung von Programmen, die bereits gestartet sind.  Ebenso
           minimiert es Probleme, die mit der Verwendung des alten
           Basissystems und des neuen Kernels zu tun haben
           könnten.</p></li><li class="listitem"><p><code class="command">mergemaster -p</code></p><p>Dieser Schritt aktualisiert ein paar initiale
           Konfigurationsdateien als Vorbereitung für das neue
           Basissystem.  Beispielsweise fügt es neue Benutzergruppen
           zum System oder neue Benutzernamen in die Passwortdatenbank hinzu.
           Dies wird oftmals benötigt, wenn neue Gruppen oder bestimmte
           Systembenutzerkonten seit der letzten Aktualisierung hinzu gekommen
           sind, so dass der <code class="buildtarget">installworld</code>-Schritt
           in der Lage ist, auf dem neu installierten System die Benutzer
           oder Systemgruppennamen ohne Probleme zu verwenden.</p></li><li class="listitem"><p><code class="command">make
           installworld</code></p><p>Kopiert das Basissystem aus <code class="filename">/usr/obj</code>.  Sie haben jetzt den
           neuen Kernel und das neue Basissystem auf der Festplatte.</p></li><li class="listitem"><p><code class="command">mergemaster</code></p><p>Sie können nun die verbleibenden Konfigurationsdateien
           aktualisieren, da Sie nun das neue Basissystem auf der Platte
           haben.</p></li><li class="listitem"><p>Starten Sie das System neu.</p><p>Ein kompletter Systemneustart ist notwendig, um den neuen
           Kernel und das neue Basissystem mit den neuen
           Konfigurationsdateien zu laden.</p></li></ol></div><p>Beachten Sie, dass wenn Sie von einem Release des gleichen
        FreeBSD-Zweigs auf ein aktuelleres Release des gleichen Zweigs, z.B.
        von 7.0 auf 7.1, aktualisieren, dann ist diese Vorgehensweise nicht
        unbedingt notwendig, da Sie nur sehr unwahrscheinlich in
        ungünstige Kombinationen zwischen Compiler, Kernel, Basissystem
        und den Konfigurationsdateien geraten werden.  Die ältere
        Vorgehensweise von <code class="command">make
        world</code>, gefolgt von der Erstellung
        und Installation des neuen Kernels funktioniert möglicherweise
        gut genug, um kleinere Aktualisierungen vorzunehmen.</p><p>Wenn Sie allerdings zwischen Hauptversionen aktualisieren wollen
        und befolgen diese Schritte nicht, sollten Sie sich auf Probleme
        gefasst machen.</p><p>Es ist auch wichtig zu wissen, dass viele Aktualisierungen, z.B.
        von 4.<em class="replaceable"><code>X</code></em> auf 5.0, viele spezielle und
        zusätzliche Schritte benötigt, wie beispielsweise das
        umbennen oder löschen von speziellen Dateien vor installworld.
        Lesen Sie die Datei <code class="filename">/usr/src/UPDATING</code>
        gründlich, besonders am Ende, wo die aktuell vorgeschlagene
        Aktualisierungssequenz explizit aufgelistet ist.</p><p>Diese Prozedur hat sich mit der Zeit weiterentwickelt, da die
        Entwickler es für unmöglich erachtet haben, bestimmte
        Arten von Kombinationsproblemen vollständig auszuschliessen.
        Hoffentlich wird die aktuelle Aktualisierungsprozedur für lange
        Zeit stabil bleiben.</p><p>Als Zusammenfassung ist hier nochmal die aktuell vorgeschlagene
        Vorgehensweise für die Aktualisierung von FreeBSD aus den Quellen
        aufgelistet:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make buildworld</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make buildkernel</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make installkernel</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>shutdown -r now</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Es gibt einige, sehr seltene Situationen, in denen Sie
	  <code class="command">mergemaster -p</code> zusätzlich
	  ausführen müssen, bevor Sie das System mit
	  <code class="buildtarget">buildworld</code> bauen.  Diese Situationen
	  werden in <code class="filename">UPDATING</code> beschrieben.  Solche
	  Situationen treten aber in der Regel nur dann auf, wenn Sie
	  Ihr FreeBSD-System um eine oder mehrere Hauptversionen
	  aktualisieren.</p></div><p>Nachdem <code class="buildtarget">installkernel</code> erfolgreich
	abgeschlossen wurde, starten Sie das System im Single-User-Modus
	(etwa durch die Eingabe von <code class="command">boot -s</code> am
	Loaderprompt).  Danach führen Sie die folgenden Anweisungen
	aus:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -u /</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount -a -t ufs</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>adjkerntz -i</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mergemaster -p</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make installworld</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mergemaster</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>reboot</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Lesen Sie bitte weiter: </h3><p xmlns="http://www.w3.org/1999/xhtml">Die obige Vorschrift ist nur eine
	  Gedächtnisstütze.  Um die einzelnen
	  Schritte zu verstehen, lesen Sie bitte die
	  folgenden Abschnitte, insbesondere wenn Sie
	  einen angepassten Kernel erstellen.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="src-updating"></a>26.7.2. Lesen Sie <code class="filename">/usr/src/UPDATING</code></h3></div></div></div><p>Bevor Sie etwas anderes tun, lesen Sie bitte
        <code class="filename">/usr/src/UPDATING</code> (oder die entsprechende
	Datei, wenn Sie den Quellcode woanders installiert haben).  Die
	Datei enthält wichtige Informationen zu Problemen, auf die Sie
	stoßen könnten oder gibt die Reihenfolge vor, in der Sie
	bestimmte Kommandos laufen lassen müssen.  Die Anweisungen in
	<code class="filename">UPDATING</code> sind aktueller als die in diesem
	Handbuch.  Im Zweifelsfall folgen Sie bitte den Anweisungen aus
	<code class="filename">UPDATING</code>.</p><div xmlns="" class="important"><h3 class="admontitle">Wichtig: </h3><p xmlns="http://www.w3.org/1999/xhtml">Das Lesen von <code class="filename">UPDATING</code> ersetzt nicht das
	  Abonnieren der richtigen Mailingliste.  Die beiden Voraussetzungen
	  ergänzen sich, es reicht nicht aus, nur eine zu
	  erfüllen.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="make-conf"></a>26.7.3. Überprüfen Sie
	<code class="filename">/etc/make.conf</code></h3></div></div></div><a id="idp85803728" class="indexterm"></a><p>Überprüfen Sie die Dateien
	<code class="filename">/usr/share/examples/etc/make.conf</code>
	und <code class="filename">/etc/make.conf</code>.  Die erste enthält
	Vorgabewerte, von denen die meisten auskommentiert sind.  Um diese
	während des Neubaus des Systems zu nutzen, tragen Sie die
	Werte in <code class="filename">/etc/make.conf</code> ein.  Beachten Sie,
	dass alles, was Sie in <code class="filename">/etc/make.conf</code>
	eintragen, bei jedem Aufruf von <code class="command">make</code> angezogen
	wird.  Es ist also klug, hier etwas Sinnvolles einzutragen.</p><p>Typischerweise wollen Sie die Zeilen, die
        <code class="varname">CFLAGS</code> und <code class="varname">NO_PROFILE</code>
	enthalten, aus
	<code class="filename">/usr/share/examples/etc/make.conf</code>
	nach <code class="filename">/etc/make.conf</code> übertragen und dort
	aktivieren.</p><p>Sehen Sie sich auch die anderen Definitionen, wie
        <code class="varname">COPTFLAGS</code> oder <code class="varname">NOPORTDOCS</code> an
	und entscheiden Sie, ob Sie diese aktivieren wollen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="updating-etc"></a>26.7.4. Aktualisieren Sie die Dateien in <code class="filename">/etc</code></h3></div></div></div><p>Das Verzeichnis <code class="filename">/etc</code> enthält den
        Großteil der Konfigurationsdateien des Systems und Skripten,
	die beim Start des Systems ausgeführt werden.  Einige dieser
	Skripten ändern sich bei einer Migration auf eine neue
	FreeBSD-Version.</p><p>Einige der Konfigurationsdateien, besonders
        <code class="filename">/etc/group</code>, werden für den Normalbetrieb
	des Systems gebraucht.</p><p>Es gab Fälle, in denen das Kommando
        <code class="command">make installworld</code> auf bestimmte
	Accounts oder Gruppen angewiesen war, die aber während
	der Aktualisierung fehlten.  Demzufolge kam es zu Problemen
	bei der Aktualisierung.  In einigen Fällen prüft
	<code class="command">make buildworld</code> ob die Accounts oder
	Gruppen vorhanden sind.</p><p>Ein Beispiel dafür trat beim Anlegen des Benutzers
	<code class="systemitem">smmsp</code> auf.  Die Installationsprozedur
	schlug an der Stelle fehl, an der <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mtree&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mtree</span>(8)</span></a>
	versuchte, <code class="filename">/var/spool/clientmqueue</code>
	anzulegen.</p><p>Um dieses Problem zu umgehen,rufen Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a>
	prä-buildworld-Modus auf, der mit <code class="option">-p</code> aktiviert
	wird.  In diesem Modus werden nur Dateien verglichen, die für
	den Erfolg von <code class="buildtarget">buildworld</code> oder
	<code class="buildtarget">installworld</code> essentiell sind.</p><div xmlns="" class="tip"><h3 class="admontitle">Tipp: </h3><p xmlns="http://www.w3.org/1999/xhtml">Wenn Sie besonders paranoid sind, sollten Sie Ihr System nach
	  Dateien absuchen, die der Gruppe, die Sie umbenennen oder
	  löschen, gehören:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>find / -group GID -print</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">Das obige Kommando zeigt alle Dateien an, die der Gruppe
	  <em class="replaceable"><code>GID</code></em> (dies kann entweder ein
	  Gruppenname oder eine numerische ID sein) gehören.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makeworld-singleuser"></a>26.7.5. Wechseln Sie in den Single-User-Modus</h3></div></div></div><a id="idp85834064" class="indexterm"></a><p>Sie können das System im Single-User-Modus
        übersetzen.  Abgesehen davon, dass dies etwas schneller
	ist, werden bei der Installation des Systems viele wichtige Dateien,
	wie die Standard-Systemprogramme, die Bibliotheken und
	Include-Dateien, verändert.  Sie bringen sich in
	Schwierigkeiten, wenn Sie diese Dateien auf einem laufenden System
	verändern, besonders dann, wenn zu dieser Zeit Benutzer auf
	dem System aktiv sind.</p><a id="idp85834960" class="indexterm"></a><p>Eine andere Methode übersetzt das System im
        Mehrbenutzermodus und wechselt für die Installation in den
	Single-User-Modus.  Wenn Sie diese Methode benutzen wollen, warten
	Sie mit den folgenden Schritten, bis der Bau des Systems fertig
	ist und Sie mit <code class="buildtarget">installkernel</code> oder
	<code class="buildtarget">installworld</code> installieren wollen.</p><p>Als Superuser können Sie mit dem folgenden Kommando ein
        laufendes System in den Single-User-Modus bringen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>shutdown now</code></strong></pre><p>Alternativ können Sie das System mit der Option
        <span class="quote">&#8222;<span class="quote">single user</span>&#8220;</span> in den Single-User-Modus booten.
	Danach geben Sie die folgenden Befehle ein:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>fsck -p</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount -u /</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount -a -t ufs</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>swapon -a</code></strong></pre><p>Die Kommandos überprüfen die Dateisysteme,
        hängen <code class="filename">/</code> wieder beschreibbar ein,
	hängen dann alle anderen UFS Dateisysteme aus
	<code class="filename">/etc/fstab</code> ein und aktivieren den
	Swap-Bereich.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Zeigt Ihre CMOS-Uhr die lokale Zeit und nicht GMT an, dies
	    erkennen Sie daran, dass <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=date&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">date</span>(1)</span></a> die
	    falsche Zeit und eine falsche Zeitzone anzeigt, setzen Sie das
	    folgende Kommando ab:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>adjkerntz -i</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">Dies stellt sicher, dass Ihre Zeitzone richtig
	    eingestellt ist.  Ohne dieses Kommando werden Sie
	    vielleicht später Probleme bekommen.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="cleaning-usr-obj"></a>26.7.6. Entfernen Sie <code class="filename">/usr/obj</code></h3></div></div></div><p>Die neu gebauten Teile des Systems werden in der Voreinstellung
        unter <code class="filename">/usr/obj</code> gespeichert.  Die Verzeichnisse
	dort spiegeln die Struktur unter
	<code class="filename">/usr/src</code>.</p><p>Sie können den <code class="command">make buildworld</code> Prozess
        beschleunigen, indem Sie dieses Verzeichnis entfernen.  Dies
	erspart Ihnen zudem einigen Ärger aufgrund von
	Abhängigkeiten.</p><p>Einige Dateien unter <code class="filename">/usr/obj</code> sind
        vielleicht durch die <code class="option">immutable</code>-Option
	(siehe <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chflags&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">chflags</span>(1)</span></a>) schreibgeschützt, die vor dem
	Löschen entfernt werden muss.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/obj</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chflags -R noschg *</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm -rf *</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="updating-upgrading-compilebase"></a>26.7.7. Übersetzen der Quellen des Basissystems</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85858896"></a>26.7.7.1. Sichern der Ausgaben</h4></div></div></div><p>Für den Fall, dass etwas schief geht, sollten Sie
	  die Ausgaben von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> in einer Datei sichern, damit Sie
	  eine Kopie der Fehlermeldung besitzen.  Das mag Ihnen nicht
	  helfen, den Fehler zu finden, kann aber anderen helfen, wenn Sie
	  Ihr Problem in einer der FreeBSD-Mailinglisten schildern.</p><p>Dazu können Sie einfach das Kommando <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=script&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">script</span>(1)</span></a>
	  benutzen, dem Sie beim Aufruf als Parameter den Dateinamen
	  für die Ausgaben mitgeben.  Setzen Sie das Kommando
	  unmittelbar vor dem Neubau ab und geben Sie
	  <strong class="userinput"><code>exit</code></strong> ein, wenn der Bau abgeschlossen
	  ist:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>script /var/tmp/mw.out</code></strong>
Script started, output file is /var/tmp/mw.out
<code class="prompt">#</code> <strong class="userinput"><code>make TARGET</code></strong>
<span class="emphasis"><em>&#8230; Ausgaben des Kommandos &#8230;</em></span>
<code class="prompt">#</code> <strong class="userinput"><code>exit</code></strong>
Script done, &#8230;</pre><p>Sichern Sie die Ausgaben nicht in <code class="filename">/tmp</code>,
	  da dieses Verzeichnis beim nächsten Boot aufgeräumt
	  werden kann.  Ein geeigneteres Verzeichnis ist
	  <code class="filename">/var/tmp</code>, wie im vorigen Beispiel gezeigt,
	  oder das Heimatverzeichnis von <code class="systemitem">root</code>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="make-buildworld"></a>26.7.7.2. Übersetzen des Basissystems</h4></div></div></div><p>Wechseln Sie in das Verzeichnis, in dem die Quellen liegen
	  (in der Voreinstellung ist das
	  <code class="filename">/usr/src</code>):</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong></pre><a id="idp85885904" class="indexterm"></a><p>Zum Neubau der Welt benutzen Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a>.  Dieses
	  Kommando liest ein <code class="filename">Makefile</code>, das Anweisungen
	  enthält, wie die Programme, aus denen FreeBSD besteht, zu bauen
	  sind und in welcher Reihenfolge diese zu bauen sind.</p><p>Ein typischer Aufruf von <code class="command">make</code> sieht wie
	  folgt aus:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make -x -DVARIABLE target</code></strong></pre><p>In diesem Beispiel ist
	  <code class="option">-<em class="replaceable"><code>x</code></em></code> eine Option, die
	  Sie an <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> weitergeben wollen.  Eine Liste gültiger
	  Optionen finden Sie in der <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> Manualpage.</p><p>Das Verhalten eines <code class="filename">Makefile</code>s wird von
	  Variablen bestimmt.  Mit
	  <code class="option">-D<em class="replaceable"><code>VARIABLE</code></em></code> setzen Sie
	  eine Variable.  Diese Variablen sind dieselben, die auch in
	  <code class="filename">/etc/make.conf</code> gesetzt werden, dies ist nur
	  ein alternativer Weg, Variablen zu setzen.</p><p>Um zu verhindern, dass die <span class="quote">&#8222;<span class="quote">profiled</span>&#8220;</span>
	  Bibliotheken gebaut werden, rufen Sie <code class="command">make</code> wie
	  folgt auf:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make -DNO_PROFILE target</code></strong></pre><p>Dieser Aufruf entspricht dem folgenden Eintrag in
	  <code class="filename">/etc/make.conf</code>:</p><pre class="programlisting">NO_PROFILE=    true     #    Avoid compiling profiled libraries</pre><p>Jedes <code class="filename">Makefile</code> definiert einige
	  <span class="quote">&#8222;<span class="quote">Ziele</span>&#8220;</span>, die festlegen, was genau zu tun ist.  Mit
	  <em class="replaceable"><code>target</code></em> wählen Sie eins dieser
	  Ziele aus.</p><p>Einige Ziele im <code class="filename">Makefile</code> sind nicht
	  für den Endanwender gedacht, sondern unterteilen den
	  Bauprozess in eine Reihe von Einzelschritten.</p><p>Im Regelfall müssen Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> keine Parameter
	  mitgeben, so dass Ihre Kommandozeile wie folgt aussehen
	  wird:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make target</code></strong></pre><p><em class="replaceable"><code>target</code></em> steht dabei für
	  die verschiedenen Ziele.  Das erste Ziel sollte immer
	  <code class="varname">buildworld</code> sein.</p><p>Mit <code class="buildtarget">buildworld</code> wird ein kompletter
	  Baum unterhalb von <code class="filename">/usr/obj</code> gebaut, der mit
	  <code class="buildtarget">installworld</code>, einem weiteren Ziel, auf
	  dem System installiert werden kann.</p><p>Über separate Optionen zu verfügen, ist aus
	  mehreren Gründen nützlich.  Erstens
	  können Sie das System auf einem laufenden System bauen, da die
	  Bauprozedur abgekapselt vom Rest des Systems ist.  Das System
	  lässt sich im Mehrbenutzermodus ohne negative
	  Seiteneffekte bauen.  Die Installation mit
	  <code class="buildtarget">installworld</code> sollte aber immer noch im
	  Single-User-Modus erfolgen.</p><p>Zweitens können Sie NFS benutzen, um mehrere Maschinen
	  in Ihrem Netzwerk zu aktualisieren.  Wenn Sie die Maschinen
	  <code class="systemitem">A</code>, <code class="systemitem">B</code> und <code class="systemitem">C</code>
	  aktualisieren wollen, lassen sie <code class="command">make
	    buildworld</code> und <code class="command">make installworld</code> auf
	  <code class="systemitem">A</code> laufen.  Auf den Maschinen <code class="systemitem">B</code>
	  und <code class="systemitem">C</code> können Sie die
	  Verzeichnisse <code class="filename">/usr/src</code> und
	  <code class="filename">/usr/obj</code> von <code class="systemitem">A</code> einhängen
	  und brauchen dort nur noch <code class="command">make installworld</code>
	  auszuführen, um die Bauresultate zu installieren.</p><p>Obwohl das Ziel <code class="buildtarget">world</code> noch
	  existiert, sollten Sie es wirklich nicht mehr benutzen.</p><p>Um das System zu bauen, setzen Sie das folgende Kommando
	  ab:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make buildworld</code></strong></pre><p>Mit <code class="option">-j</code> können Sie
	  <code class="command">make</code> anweisen, mehrere Prozesse zu starten.
	  Besonders effektiv ist das auf Mehrprozessor-Systemen.  Da aber
	  der Übersetzungsprozess hauptsächlich von IO statt
	  der CPU bestimmt wird, ist diese Option auch auf
	  Einprozessor-Systemen nützlich.</p><p>Auf einem typischen Einprozessor-System können Sie den
	  folgenden Befehl absetzen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make -j4 buildworld</code></strong></pre><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> wird dann bis zu vier Prozesse gleichzeitig
	  laufen lassen.  Erfahrungsberichte aus den Mailinglisten zeigen,
	  dass dieser Aufruf typischerweise den besten
	  Geschwindigkeitsgewinn bringt.</p><p>Wenn Sie ein Mehrprozessor-System besitzen und SMP in Ihrem
	  Kernel konfiguriert ist, probieren Sie Werte zwischen 6 und 10
	  aus.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp85920592"></a>26.7.7.3. Laufzeiten</h4></div></div></div><a id="idp85921232" class="indexterm"></a><p>Die Laufzeit eines Baus wird von vielen Faktoren
	  beeinflusst, ein aktuelles System benötigt aber etwa
	  zwei Stunden um FreeBSD-STABLE zu bauen.  Der Bau von
	  FreeBSD-CURRENT dauert etwas länger.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="new-kernel"></a>26.7.8. Übersetzen und Installation des Kernels</h3></div></div></div><a id="idp85923792" class="indexterm"></a><p>Um das Beste aus Ihrem System zu holen, sollten Sie einen neuen
	Kernel kompilieren.  Praktisch gesehen ist das sogar notwendig, da
	sich einige Datenstrukturen geändert haben und Programme wie
	<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ps&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ps</span>(1)</span></a> oder <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=top&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">top</span>(1)</span></a> nur mit einem Kernel zusammen arbeiten,
	der auch zu dem entsprechenden Quellcode passt.</p><p>Am einfachsten und sichersten bauen Sie dazu den
        <code class="filename">GENERIC</code> Kernel.  Obwohl der
        <code class="filename">GENERIC</code> Kernel vielleicht nicht alle
        Ihre Geräte unterstützt, sollte er alles enthalten,
        um das System in den Single-User-Modus zu booten.  Dies ist auch
        ein guter Test, um zu sehen, dass das System
        ordnungsgemäß funktioniert.  Nachdem Sie mit
        <code class="filename">GENERIC</code> gebootet und sichergestellt haben,
        dass Ihr System funktioniert, können Sie einen neuen
        Kernel mit Ihrer Konfigurationsdatei bauen.</p><p>In aktuellen FreeBSD-Versionen müssen Sie das
	<a class="link" href="makeworld.html#make-buildworld" title="26.7.7.2. Übersetzen des Basissystems">Basissystem neu bauen</a>,
	bevor Sie einen neuen Kernel erstellen.</p><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Wenn Sie einen angepassten Kernel erstellen wollen und
	  bereits über eine Konfigurationsdatei verfügen,
	  geben Sie diese, wie im folgenden Beispiel gezeigt, auf der
	  Kommandozeile an:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make buildkernel KERNCONF=MYKERNEL</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make installkernel KERNCONF=MYKERNEL</code></strong></pre></div><p>Wenn <code class="varname">kern.securelevel</code> einen Wert
	größer als <code class="literal">1</code> besitzt
	<span class="emphasis"><em>und</em></span> der Kernel mit <code class="literal">noschg</code>
	oder ähnlichen Optionen geschützt ist, müssen Sie
	<code class="buildtarget">installkernel</code> im Einbenutzermodus
	ausführen.  Wenn das nicht der Fall ist, sollten die beiden
	Kommandos problemlos im Mehrbenutzermodus laufen.  Weitere
	Informationen über <code class="varname">kern.securelevel</code> finden
	Sie in <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=init&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">init</span>(8)</span></a> und <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chflags&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">chflags</span>(1)</span></a> erläutert Optionen, die
	Sie auf Dateien setzen können.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="new-kernel-singleuser"></a>26.7.9. Booten Sie in den Single-User-Modus</h3></div></div></div><a id="idp85946320" class="indexterm"></a><p>Um zu prüfen, ob der neue Kernel funktioniert, sollten Sie
        in den Single-User-Modus booten.  Folgen Sie dazu der Anleitung aus
	<a class="xref" href="makeworld.html#makeworld-singleuser" title="26.7.5. Wechseln Sie in den Single-User-Modus">Abschnitt 26.7.5, &#8222;Wechseln Sie in den Single-User-Modus&#8220;</a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="make-installworld"></a>26.7.10. Installation des Systems</h3></div></div></div><p>Nun können Sie das neue System mit
	<code class="buildtarget">installworld</code> installieren.
	Rufen Sie dazu das folgende Kommando auf:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make installworld</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Anmerkung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Wenn Sie mit dem <code class="command">make buildworld</code> Kommando
	  Variablen verwendet haben, müssen Sie dieselben Variablen
	  auch bei dem <code class="command">make installworld</code> Kommando
	  angeben.  Auf die anderen Optionen trifft das nur bedingt zu:
	  <code class="option">-j</code> darf mit <code class="buildtarget">installworld</code>
	  nicht benutzt werden.</p><p xmlns="http://www.w3.org/1999/xhtml">Sie haben zum Bauen die folgende Kommandozeile
	  verwendet:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make -DNO_PROFILE buildworld</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">Bei der Installation setzen Sie dann das folgende Kommando
	  ab:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make -DNO_PROFILE installworld</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">Würden Sie die Variable bei der Installation weglassen,
	  so würde das System versuchen, die <span class="quote">&#8222;<span class="quote">profiled</span>&#8220;</span>
	  Bibliotheken, die aber gar nicht gebaut wurden, zu
	  installieren.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="post-installworld-updates"></a>26.7.11. Aktualisieren der von <code class="command">make installworld</code>
        ausgelassenen Dateien</h3></div></div></div><p>Neue oder geänderte Konfigurationsdateien aus einigen
        Verzeichnissen, besonders <code class="filename">/etc</code>,
	<code class="filename">/var</code> und <code class="filename">/usr</code> werden bei
	der Installationsprozedur nicht berücksichtigt.</p><p>Sie können diese Dateien mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a>
        aktualisieren.  Alternativ können Sie das auch manuell
	durchführen, obwohl wir diesen Weg nicht empfehlen.  Egal
	welchen Weg Sie beschreiten, sichern Sie vorher den Inhalt von
	<code class="filename">/etc</code> für den Fall, dass etwas schief
	geht.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mergemaster"></a>26.7.11.1. <code class="command">mergemaster</code></h4></div><div><span class="authorgroup">Beigetragen von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><a id="idp85968080" class="indexterm"></a><p>Das Bourne-Shell Skript <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> hilft Ihnen dabei,
	  die Unterschiede zwischen den Konfigurationsdateien in
	  <code class="filename">/etc</code> und denen im Quellbaum unter
	  <code class="filename">/usr/src/etc</code> zu finden.
	  <code class="command">mergemaster</code> ist der empfohlene Weg, Ihre
	  Systemkonfiguration mit dem Quellbaum abzugleichen.</p><p>Rufen Sie <code class="command">mergemaster</code> einfach auf und
	  schauen Sie zu.  Ausgehend von <code class="filename">/</code> wird
	  <code class="command">mergemaster</code> einen virtuellen Root-Baum
	  aufbauen und darin die neuen Konfigurationsdateien ablegen.
	  Diese Dateien werden dann mit den auf Ihrem System installierten
	  verglichen.  Unterschiede zwischen den Dateien werden im
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>-Format dargestellt.  Neue oder geänderte Zeilen
	  werden mit <code class="option">+</code> gekennzeichnet.  Zeilen die
	  gelöscht oder ersetzt werden, sind mit einem
	  <code class="option">-</code> gekennzeichnet.  Das Anzeigeformat wird in
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> genauer erklärt.</p><p><a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> zeigt Ihnen jede geänderte Datei an
	  und Sie haben die Wahl, die neue Datei (in
	  <code class="command">mergemaster</code> wird sie temporäre Datei
	  genannt) zu löschen, sie unverändert zu installieren,
	  den Inhalt der neuen Datei mit dem Inhalt der alten Datei
	  abzugleichen, oder die <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> Ausgabe noch einmal zu
	  sehen.  Sie können die aktuelle Datei auch
	  überspringen, sie wird dann noch einmal angezeigt, nachdem
	  alle anderen Dateien abgearbeitet wurden.  Sie erhalten Hilfe,
	  wenn Sie bei der Eingabeaufforderung von
	  <code class="command">mergemaster</code> ein <span class="keycap"><strong>?</strong></span>
	  eingeben.</p><p>Wenn Sie die temporäre Datei löschen, geht
	  <code class="command">mergemaster</code> davon aus, dass Sie Ihre
	  aktuelle Datei behalten möchten.  Wählen Sie die Option
	  bitte nur dann, wenn Sie keinen Grund sehen, die aktuelle Datei
	  zu ändern.</p><p>Wenn Sie die temporäre Datei installieren, wird Ihre
	  aktuelle Datei mit der neuen Datei überschrieben.  Sie
	  sollten alle unveränderten Konfigurationsdateien auf diese
	  Weise aktualisieren.</p><p>Wenn Sie sich entschließen den Inhalt beider Dateien
	  abzugleichen, wird ein Texteditor aufgerufen, indem Sie beide
	  Dateien nebeneinander betrachten können.  Mit der Taste
	  <span class="keycap"><strong>l</strong></span> übernehmen Sie die aktuelle Zeile der
	  links dargestellten Datei, mit der Taste <span class="keycap"><strong>r</strong></span>
	  übernehmen Sie die Zeile der rechts dargestellten Datei.
	  Das Ergebnis ist eine Datei, die aus Teilen der beiden
	  ursprünglichen Dateien besteht und installiert werden kann.
	  Dieses Verfahren wird gewöhnlich bei veränderten
	  Dateien genutzt.</p><p>Haben Sie sich entschieden die Differenzen noch einmal
	  anzuzeigen, zeigt Ihnen <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> dieselbe Ausgabe, die
	  Sie gesehen haben, bevor die Eingabeaufforderung ausgegeben
	  wurde.</p><p>Wenn <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mergemaster&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mergemaster</span>(8)</span></a> alle Systemdateien abgearbeitet hat,
	  werden weitere Optionen abgefragt.  Sie werden unter
	  Umständen gefragt, ob Sie die Passwort-Datei neu bauen
	  lassen wollen.  Am Ende haben Sie die Möglichkeit, den Rest
	  der temporären Dateien zu löschen.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86019664"></a>26.7.11.2. Manueller Abgleich der Konfigurationsdateien</h4></div></div></div><p>Wenn Sie den Abgleich lieber selbst ausführen wollen,
	  beachten Sie bitte, dass Sie nicht einfach die Dateien aus
	  <code class="filename">/usr/src/etc</code> nach <code class="filename">/etc</code>
	  kopieren können.  Einige dieser Dateien müssen zuerst
	  <span class="emphasis"><em>installiert</em></span> werden, bevor sie benutzt werden
	  können.  Das liegt daran, dass
	  <code class="filename">/usr/src/etc</code> keine exakte Kopie von
	  <code class="filename">/etc</code> ist.  Zudem gibt es Dateien, die sich
	  in <code class="filename">/etc</code> befinden aber nicht in
	  <code class="filename">/usr/src/etc</code>.</p><p>Wenn Sie, wie empfohlen, <code class="command">mergemaster</code>
	  benutzen, können Sie direkt in den nächsten
	  <a class="link" href="makeworld.html#updating-upgrading-rebooting" title="26.7.12. Das System neu starten">Abschnitt</a>
	  wechseln.</p><p>Am einfachsten ist es, wenn Sie die neuen Dateien in ein
	  temporäres Verzeichnis installieren und sie nacheinander auf
	  Differenzen zu den bestehenden Dateien durchsehen.</p><div xmlns="" class="warning"><h3 class="admontitle">Sichern Sie die Inhalte von <code xmlns="http://www.w3.org/1999/xhtml" class="filename">/etc</code>: </h3><p xmlns="http://www.w3.org/1999/xhtml">Obwohl bei dieser Prozedur keine Dateien in
	    <code class="filename">/etc</code> automatisch verändert werden,
	    sollten Sie dessen Inhalt an einen sicheren Ort
	    kopieren:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cp -Rp /etc /etc.old</code></strong></pre><p xmlns="http://www.w3.org/1999/xhtml">Mit <code class="option">-R</code> wird rekursiv kopiert und
	      <code class="option">-p</code> erhält die Attribute der kopierten
	      Dateien, wie Zugriffszeiten und Eigentümer.</p></div><p>Sie müssen die neuen Dateien in einem temporären
	  Verzeichnis installieren.  <code class="filename">/var/tmp/root</code> ist
	  eine gute Wahl für das temporäre Verzeichnis, in dem
	  auch noch einige Unterverzeichnisse angelegt werden
	  müssen.</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/tmp/root</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/etc</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make DESTDIR=/var/tmp/root distrib-dirs distribution</code></strong></pre><p>Die obigen Kommandos bauen die nötige
	  Verzeichnisstruktur auf und installieren die neuen Dateien in
	  diese Struktur.  Unterhalb von <code class="filename">/var/tmp/root</code>
	  wurden einige leere Verzeichnisse angelegt, die Sie am besten wie
	  folgt entfernen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /var/tmp/root</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>find -d . -type d | xargs rmdir 2&gt;/dev/null</code></strong></pre><p>Im obigen Beispiel wurde die Fehlerausgabe nach
	  <code class="filename">/dev/null</code> umgeleitet, um die Warnungen
	  über nicht leere Verzeichnisse zu unterdrücken.</p><p><code class="filename">/var/tmp/root</code> enthält nun alle
	  Dateien, die unterhalb von <code class="filename">/</code> installiert
	  werden müssen.  Sie müssen nun jede dieser Dateien mit
	  den schon existierenden Dateien vergleichen.</p><p>Einige der installierten Dateien unter
	  <code class="filename">/var/tmp/root</code> beginnen mit einem
	  <span class="quote">&#8222;<span class="quote">.</span>&#8220;</span>.
	  Als dieses Kapitel verfasst wurde, waren das nur die
	  Startdateien für die Shells in
	  <code class="filename">/var/tmp/root/</code> und
	  <code class="filename">/var/tmp/root/root/</code>.  Abhängig davon,
	  wann Sie dieses Handbuch lesen, können mehr Dateien dieser
	  Art existieren.  Verwenden Sie <code class="command">ls -a</code> um
	  sicherzustellen, dass Sie alle derartigen Dateien
	  finden.</p><p>Benutzen Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> um Unterschiede zwischen zwei
	  Dateien festzustellen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>diff /etc/shells /var/tmp/root/etc/shells</code></strong></pre><p>Das obige Kommando zeigt Ihnen die Unterschiede zwischen der
	  installierten Version von <code class="filename">/etc/shells</code> und
	  der neuen Version in <code class="filename">/var/tmp/root/etc/shells</code>.
	  Entscheiden Sie anhand der Unterschiede, ob
	  Sie beide Dateien abgleichen oder die neue Version über die
	  alte kopieren wollen.</p><div xmlns="" class="tip"><h3 class="admontitle">Versehen Sie das temporäre Verzeichnis mit einem
	    Zeitstempel: </h3><p xmlns="http://www.w3.org/1999/xhtml">Wenn Sie das System oft neu bauen, müssen Sie
	    <code class="filename">/etc</code> genauso oft aktualisieren.  Dies kann
	    mit der Zeit sehr lästig werden.</p><p xmlns="http://www.w3.org/1999/xhtml">Sie können das Verfahren beschleunigen, wenn Sie sich
	    eine Kopie der Dateien behalten, die Sie zuletzt nach
	    <code class="filename">/etc</code> installiert haben.  Das folgende
	    Verfahren zeigt Ihnen, wie das geht.</p><div xmlns="http://www.w3.org/1999/xhtml" class="procedure"><ol class="procedure" type="1"><li class="step"><p>Folgen Sie der normalen Prozedur um das System zu
	        bauen.  Wenn Sie <code class="filename">/etc</code> und die anderen
		Verzeichnisse aktualisieren wollen, geben Sie dem
		temporären Verzeichnis einen Namen, der das aktuelle
		Datum enthält.  Wenn Sie dies zum Beispiel am
		14. Februar 1998 durchführten, hätten Sie die
		folgenden Kommandos abgesetzt:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/tmp/root-19980214</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/etc</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make DESTDIR=/var/tmp/root-19980214 \
    distrib-dirs distribution</code></strong></pre></li><li class="step"><p>Gleichen Sie die Änderungen entsprechend der
		Anleitung von oben ab.</p><p>Wenn Sie fertig sind, entfernen Sie das Verzeichnis
		<code class="filename">/var/tmp/root-19980214</code>
		<span class="emphasis"><em>nicht</em></span>.</p></li><li class="step"><p>Wenn Sie nun neue Quellen heruntergeladen und gebaut
	        haben, folgen Sie bitte Schritt 1.  Wenn Sie zwischen den
		Updates eine Woche gewartet haben, haben Sie nun ein
		Verzeichnis mit dem Namen
		<code class="filename">/var/tmp/root-19980221</code>.</p></li><li class="step"><p>Sie können nun die Unterschiede, die sich in einer
		Woche ergeben haben, sehen, indem Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> rekursiv
		anwenden:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /var/tmp</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>diff -r root-19980214 root-19980221</code></strong></pre><p>Üblicherweise sind die Differenzen, die Sie jetzt
	        sehen, kleiner als die Differenzen zwischen
		<code class="filename">/var/tmp/root-19980221/etc</code> und
		<code class="filename">/etc</code>.  Da die angezeigten Differenzen
		kleiner sind, ist es jetzt einfacher den Abgleich der
		Dateien durchzuführen.</p></li><li class="step"><p>Sie können nun das älteste der beiden
	        <code class="filename">/var/tmp/root-*</code> Verzeichnisse
	        entfernen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>rm -rf /var/tmp/root-19980214</code></strong></pre></li><li class="step"><p>Wiederholen Sie diesen Prozess jedes Mal wenn Sie
		Dateien in <code class="filename">/etc</code> abgleichen
		müssen.</p></li></ol></div><p xmlns="http://www.w3.org/1999/xhtml">Mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=date&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">date</span>(1)</span></a> können Sie den Verzeichnisnamen
	    automatisch erzeugen:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir /var/tmp/root-`date "+%Y%m%d"`</code></strong></pre></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="updating-upgrading-rebooting"></a>26.7.12. Das System neu starten</h3></div></div></div><p>Sie sind nun am Ende der Prozedur angelangt.  Nachdem Sie sich
        davon überzeugt haben, dass Ihr System funktioniert,
        starten Sie Ihr System mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=shutdown&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">shutdown</span>(8)</span></a> neu:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>shutdown -r now</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp86081232"></a>26.7.13. Ende</h3></div></div></div><p>Herzlichen Glückwunsch!  Sie haben gerade erfolgreich Ihr
        FreeBSD System aktualisiert.</p><p>Es ist übrigens leicht einen Teil des Systems
        wiederherzustellen, für den Fall, dass Ihnen ein kleiner
	Fehler unterlaufen ist.  Wenn Sie beispielsweise während des
	Updates oder Abgleichs <code class="filename">/etc/magic</code> aus Versehen
	gelöscht haben, wird <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=file&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">file</span>(1)</span></a> nicht mehr funktionieren.
	In diesem Fall können Sie das Problem mit dem folgenden
	Kommando beheben:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src/usr.bin/file</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make all install</code></strong></pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="updating-questions"></a>26.7.14. Fragen</h3></div></div></div><div class="qandaset"><a id="idp86086480"></a><dl><dt>26.7.14.1. <a href="makeworld.html#idp86086736">Muss ich wirklich immer alles neu bauen, wenn sich
	      etwas geändert hat?</a></dt><dt>26.7.14.2. <a href="makeworld.html#idp86101456">Der Bau bricht mit vielen
	      Signal 11-Fehlern (oder anderen
	      Signalnummern) ab.  Was ist da passiert?</a></dt><dt>26.7.14.3. <a href="makeworld.html#idp86105168">Kann ich /usr/obj löschen, wenn
	      ich fertig bin?</a></dt><dt>26.7.14.4. <a href="makeworld.html#idp86109136">Kann ein abgebrochener Bau weitergeführt
	      werden?</a></dt><dt>26.7.14.5. <a href="makeworld.html#idp86117840">Wie kann ich den Bauprozess beschleunigen?</a></dt><dt>26.7.14.6. <a href="makeworld.html#idp86156752">Was mache ich, wenn etwas nicht funktioniert?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp86086736"></a><a id="idp86086992"></a><p><strong>26.7.14.1.</strong></p></td><td align="left" valign="top"><p>Muss ich wirklich immer alles neu bauen, wenn sich
	      etwas geändert hat?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Darauf gibt es keine einfache Antwort.  Was zu tun ist,
	      hängt von den Änderungen ab.  Es lohnt
	      wahrscheinlich nicht, alles neu zu bauen, wenn sich bei einem
	      <span class="application">CVSup</span>-Lauf nur die folgenden
	      Dateien geändert haben:</p><pre class="screen"><code class="filename">src/games/cribbage/instr.c</code>
<code class="filename">src/games/sail/pl_main.c</code>
<code class="filename">src/release/sysinstall/config.c</code>
<code class="filename">src/release/sysinstall/media.c</code>
<code class="filename">src/share/mk/bsd.port.mk</code></pre><p>In diesem Fall können Sie in die entsprechenden
	      Unterverzeichnisse wechseln und dort <code class="command">make all
	      install</code> ausführen.  Wenn sich allerdings etwas
	      Wichtiges, wie <code class="filename">src/lib/libc/stdlib</code>,
	      geändert hat, sollten Sie die Welt oder
	      mindestens die statisch gelinkten Teile des Systems (sowie
	      Ihre statisch gelinkten Ergänzungen) neu bauen.</p><p>Letztendlich ist das Ihre Entscheidung.  Sie sind
	      vielleicht damit zufrieden, das System alle zwei Wochen neu
	      zu bauen und in der Zwischenzeit die anfallenden
	      Änderungen zu sammeln.  Wenn Sie sich zutrauen, alle
	      Abhängigkeiten zu erkennen, bauen Sie vielleicht auch
	      nur die geänderten Sachen neu.</p><p>Das hängt natürlich auch noch davon ab, wie oft
	      Sie ein Update durchführen wollen und ob Sie FreeBSD-STABLE
	      oder FreeBSD-CURRENT benutzen.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp86101456"></a><a id="idp86101712"></a><p><strong>26.7.14.2.</strong></p></td><td align="left" valign="top"><p>Der Bau bricht mit vielen
	      <span class="errorname">Signal 11</span>-Fehlern<a id="idp86102608" class="indexterm"></a> (oder anderen
	      Signalnummern) ab.  Was ist da passiert?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Normalerweise zeigen diese Meldungen Hardwarefehler an.
	      Ein Neubau der Welt ist ein guter Belastungstest für
	      Ihre Hardware und zeigt oft Probleme mit dem Speicher auf.
	      Dies äußert sich darin, dass der Compiler
	      mit dem Erhalt von seltsamen Signalen abbricht.</p><p>Es liegt garantiert ein Hardwarefehler vor, wenn ein
	      neuer Übersetzungslauf an einer anderen Stelle
	      abbricht.</p><p>In diesem Fall können Sie nur einzelne Komponenten
	      Ihres Systems tauschen, um zu bestimmen, welche Komponente den
	      Fehler verursacht.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp86105168"></a><a id="idp86105424"></a><p><strong>26.7.14.3.</strong></p></td><td align="left" valign="top"><p>Kann ich <code class="filename">/usr/obj</code> löschen, wenn
	      ich fertig bin?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Kurze Antwort: Ja.</p><p>In <code class="filename">/usr/obj</code> werden alle Dateien
	      abgelegt, die während der Übersetzungsphase erstellt
	      wurden.  Dieses Verzeichnis wird in einem der ersten Schritte
	      der Bauprozedur entfernt.  Es macht daher
	      wenig Sinn, dieses Verzeichnis zu behalten und Sie setzen
	      eine Menge Plattenplatz, momentan ungefähr 2 GB,
	      frei, wenn Sie es löschen.</p><p>Wenn Sie allerdings genau wissen, was Sie tun, können
	      Sie diesen Schritt bei <code class="command">make buildworld</code>
	      auslassen.  Nachfolgende Bauprozeduren werden dadurch erheblich
	      schneller, da die meisten Quelldateien nicht mehr neu
	      übersetzt werden.  Dafür können aber subtile
	      Abhängigkeitsprobleme entstehen, die dazu führen,
	      dass der Bau auf merkwürdige Weise abbrechen kann.
	      Dies führt häufig zu unnötigen Diskussionen auf
	      den FreeBSD Mailinglisten, wenn sich jemand über einen
	      kaputten Bau beschwert, aber nicht sieht, dass er
	      Probleme hat, weil er eine Abkürzung genommen hat.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp86109136"></a><a id="idp86109392"></a><p><strong>26.7.14.4.</strong></p></td><td align="left" valign="top"><p>Kann ein abgebrochener Bau weitergeführt
	      werden?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Das hängt davon ab, wieweit der Bauprozess
	      fortgeschritten ist.</p><p><span class="emphasis"><em>Üblicherweise</em></span> werden
	      essentielle Werkzeuge, wie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gcc&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">gcc</span>(1)</span></a> und <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a>,
	      und die Systembibliotheken während des Bauprozesses
	      neu erstellt (dies ist aber keine allgemein gültige
	      Regel).  Die neu erstellen Werkzeuge und Bibliotheken werden
	      dann benutzt, um sich selbst noch einmal zu bauen, und wieder
	      installiert.  Anschließend wird das Gesamtsystem mit
	      den neu erstellten Systemdateien gebaut.</p><p>Wenn Sie sich im letzten Schritt befinden und Sie wissen,
	      dass Sie dort sind, weil Sie durch die Ausgaben, die Sie
	      ja sichern, der Bauprozedur gesehen haben, können Sie
	      mit ziemlicher Sicherheit den Bau weiterführen:</p><pre class="screen"><span class="emphasis"><em>&#8230; Fehler beheben &#8230;</em></span>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make -DNO_CLEAN all</code></strong></pre><p>Diese Variablen verhindern,
	      dass <code class="command">make buildworld</code> die vorher erstellten
	      Dateien löscht.</p><p>Das Sie sich im letzten Schritt der Bauprozedur
	      befinden, erkennen Sie daran, dass Sie in der Ausgabe die
	      folgenden Zeilen finden:</p><pre class="screen">--------------------------------------------------------------
Building everything..
--------------------------------------------------------------</pre><p>Wenn Sie diese Meldung nicht finden, oder sich nicht sicher
	      sind, dann ist es besser, noch einmal ganz von Vorne
	      anzufangen.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp86117840"></a><a id="idp86118096"></a><p><strong>26.7.14.5.</strong></p></td><td align="left" valign="top"><p>Wie kann ich den Bauprozess beschleunigen?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Bauen Sie im Single-User-Modus.</p></li><li class="listitem"><p>Legen Sie <code class="filename">/usr/src</code> und
		  <code class="filename">/usr/obj</code> in getrennte Dateisysteme auf
		  unterschiedliche Festplatten.  Benutzen Sie nach
		  Möglichkeit auch getrennte Platten-Controller.</p></li><li class="listitem"><p>Noch besser ist es, diese Dateisysteme auf mehrere
		  Festplatten mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ccd&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">ccd</span>(4)</span></a> zu verteilen.</p></li><li class="listitem"><p>Bauen Sie die <span class="quote">&#8222;<span class="quote">profiled</span>&#8220;</span>-Bibliotheken,
		  die Sie wahrscheinlich sowieso nicht brauchen, nicht.
		  <code class="filename">/etc/make.conf</code> sollte dazu
		  <code class="literal">NO_PROFILE=true</code> enthalten.</p></li><li class="listitem"><p>Setzen Sie die <code class="varname">CFLAGS</code> in
		  <code class="filename">/etc/make.conf</code> auf <code class="option">-O
		    -pipe</code>.  Die Optimierungsstufe
		  <code class="option">-O2</code> ist deutlich langsamer und die
		  Performance-Unterschiede zwischen <code class="option">-O</code> und
		  <code class="option">-O2</code> sind vernachlässigbar klein.
		  <code class="option">-pipe</code> veranlasst den Compiler Pipes
		  anstelle von Dateien für die Kommunikation zu
		  benutzen.  Dies spart einige Plattenzugriffe, geht aber
		  auf Kosten des Speichers.</p></li><li class="listitem"><p>Benutzen Sie
		  <code class="option">-j<em class="replaceable"><code>n</code></em></code>, um
		  mehrere Prozesse parallel laufen zu lassen.
		  Normalerweise beschleunigt dies den Bauprozess
		  unabhängig davon, ob Sie ein Einprozessor- oder
		  Mehrprozessorsystem einsetzen.</p></li><li class="listitem"><p>Sie können das Dateisystem
		  <code class="filename">/usr/src</code> mit der Option
		  <code class="option">noatime</code> einhängen.  Dies
		  verhindert, dass die Zugriffszeiten der Dateien
		  aktualisiert werden (eine Information, die Sie vielleicht
		  gar nicht brauchen).</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -u -o noatime /usr/src</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Warnung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Das Beispiel geht davon aus, dass sich
		    <code class="filename">/usr/src</code> auf einem separaten
		    Dateisystem befindet.  Wenn das nicht der Fall ist,
		    weil das Verzeichnis beispielsweise Teil des
		    <code class="filename">/usr</code> Dateisystems ist,
		    müssen Sie anstelle von
		    <code class="filename">/usr/src</code> den Mountpoint des
		    Dateisystems angeben.</p></div></li><li class="listitem"><p>Das Dateisystem, in dem sich
		  <code class="filename">/usr/obj</code> befindet, kann mit der
		  Option <code class="option">async</code> eingehangen werden.  Dies
		  bewirkt, dass Schreibzugriffe auf die Platte
		  asynchron stattfinden, das heißt ein Schreibzugriff
		  ist sofort beendet, die Daten werden allerdings erst einige
		  Sekunden später geschrieben.  Dadurch können
		  Schreibzugriffe zusammengefasst werden, was einen
		  erheblichen Geschwindigkeitszuwachs mit sich bringen
		  kann.</p><div xmlns="" class="warning"><h3 class="admontitle">Warnung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Beachten Sie, dass dies Ihr Dateisystem
		    anfälliger für Fehler macht.  Im Fall eines
		    Stromausfalls besteht eine erhöhte
		    Wahrscheinlichkeit, dass das Dateisystem beim
		    Start der Maschine zerstört ist.</p><p xmlns="http://www.w3.org/1999/xhtml">Wenn sich <code class="filename">/usr/obj</code> auf einem
		    extra Dateisystem befindet, ist das kein Problem.  Wenn
		    sich allerdings auf diesem Dateisystem noch andere
		    wertvolle Daten befinden, stellen Sie sicher, dass
		    Sie aktuelle Sicherungen besitzen.</p></div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -u -o async /usr/obj</code></strong></pre><div xmlns="" class="warning"><h3 class="admontitle">Warnung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Ersetzen Sie <code class="filename">/usr/obj</code> durch
		    den Mountpoint des entsprechenden Dateisystems, wenn es
		    sich nicht auf einem eigenen Dateisystem
		    befindet.</p></div></li></ul></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp86156752"></a><a id="idp86157008"></a><p><strong>26.7.14.6.</strong></p></td><td align="left" valign="top"><p>Was mache ich, wenn etwas nicht funktioniert?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Stellen Sie sicher, dass sich in Ihrer Umgebung
	      keine Reste eines vorherigen Baus befinden.  Das geht ganz
	      einfach:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chflags -R noschg /usr/obj/usr</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>rm -rf /usr/obj/usr</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/src</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make cleandir</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make cleandir</code></strong></pre><p>Ja, <code class="command">make cleandir</code> muss wirklich
	      zweimal aufgerufen werden.</p><p>Nachdem Sie aufgeräumt haben, starten Sie den
	      Bauprozess wieder mit <code class="command">make
	        buildworld</code>.</p><p>Wenn Sie immer noch Probleme haben, schicken Sie die
	      Fehlermeldungen und die Ausgabe von <code class="command">uname
	        -a</code> an die Mailingliste 'Fragen und Antworten zu FreeBSD'
  <code class="email">&lt;<a xmlns="" class="email" href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;</code>.  Bereiten
	      Sie sich darauf vor, weitere Fragen zu Ihrer Umgebung zu
	      beantworten.</p></td></tr></tbody></table></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="synching.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="updating-upgrading.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="make-delete-old.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">26.6. Synchronisation der Quellen </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 26.8. Veraltete Dateien, Verzeichnisse und Bibliotheken
      löschen</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>