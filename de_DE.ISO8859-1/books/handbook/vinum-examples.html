<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>23.6. Einige Beispiele</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="vinum-vinum.html" title="Kapitel 23. Der Vinum Volume Manager" /><link rel="prev" href="vinum-objects.html" title="23.5. Vinum-Objekte" /><link rel="next" href="vinum-object-naming.html" title="23.7. Objektbenennung" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">23.6. Einige Beispiele</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="vinum-objects.html">Zurück</a> </td><th width="60%" align="center">Kapitel 23. Der Vinum Volume Manager</th><td width="20%" align="right"> <a accesskey="n" href="vinum-object-naming.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="vinum-examples"></a>23.6. Einige Beispiele</h2></div></div></div><p>Vinum verwaltet eine
      <span class="emphasis"><em>Konfigurationsdatenbank</em></span> für alle
      einem individuellen System bekannten Objekte.  Zu Beginn
      erzeugt ein Benutzer mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gvinum&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gvinum</span>(8)</span></a>
      eine Konfigurationsdatenbank aus einer oder mehreren
      Konfigurationsdateien.  Vinum speichert danach eine Kopie der
      Konfigurationsdatenbank in jedem von ihm kontrollierten
      Slice (von Vinum als <span class="emphasis"><em>Device</em></span>
      bezeichnet).  Da die Datenbank bei jedem Statuswechsel
      aktualisiert wird, kann nach einem Neustart der Status
      jedes Vinum-Objekts exakt wiederhergestellt werden.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84180304"></a>23.6.1. Die Konfigurationsdatei</h3></div></div></div><p>Die Konfigurationsdatei beschreibt individuelle
        Vinum-Objekte.  Die Beschreibung eines einfachen Volumes
        könnte beispielsweise so aussehen:</p><pre class="programlisting">
    drive a device /dev/da3h
    volume myvol
      plex org concat
        sd length 512m drive a</pre><p>Diese Datei beschreibt vier Vinum-Objekte:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Die <span class="emphasis"><em>drive</em></span>-Zeile beschreibt eine
	    Plattenpartition (<span class="emphasis"><em>drive</em></span>) sowie ihre
	    Position in Bezug auf die darunter liegende Hardware.
	    Die Partition hat dabei den symbolischen Namen
	    <span class="emphasis"><em>a</em></span>.  Diese Trennung von symbolischen
	    Namen und Gerätenamen erlaubt es, die Position von
	    Platten zu ändern, ohne dass es zu Problemen
	    kommt.</p></li><li class="listitem"><p>Die <span class="emphasis"><em>volume</em></span>-Zeile beschreibt ein
	    Volume.  Dafür wird nur ein einziges Attribut, der
	    Name des Volumes, benötigt.  In unserem Fall hat das
	    Volume den Namen <span class="emphasis"><em>myvol</em></span>.</p></li><li class="listitem"><p>Die <span class="emphasis"><em>plex</em></span>-Zeile definiert einen
	    Plexus.  Auch hier wird nur ein Parameter, und zwar die
	    Art des Aufbau, benötigt (in unserem Fall
	    <span class="emphasis"><em>concat</em></span>).  Es wird kein Name
	    benötigt, das System generiert automatisch einen
	    Namen aus dem Volume-Namen und dem Suffix
	    <span class="emphasis"><em>.p</em></span><span class="emphasis"><em>x</em></span> wobei
	    <span class="emphasis"><em>x</em></span> die Nummer des Plexus innerhalb
	    des Volumes angibt.  So wird dieser Plexus den Namen
	    <span class="emphasis"><em>myvol.p0</em></span> erhalten.</p></li><li class="listitem"><p>Die <span class="emphasis"><em>sd</em></span>-Zeile beschreibt eine
	    Subdisk.  Um eine Subdisk einzurichten, müssen Sie
	    zumindest den Namen der Platte, auf der Sie die
	    Subdisk anlegen wollen, sowie die Größe der
	    Subdisk angeben. Analog zur Definition eines Plexus wird
	    auch hier kein Name benötigt:  Das System weist
	    automatisch Namen zu, die aus dem Namen des Plexus und
	    dem Suffix <span class="emphasis"><em>.s</em></span><span class="emphasis"><em>x</em></span>
	    gebildet werden, wobei <span class="emphasis"><em>x</em></span> die Nummer
	    der Subdisk innerhalb des Plexus ist.  Folglich gibt
	    Vinum dieser Subdisk den Namen
	    <span class="emphasis"><em>myvol.p0.s0</em></span>.</p></li></ul></div><p>Nach dem Verarbeiten dieser Datei erzeugt <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gvinum&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gvinum</span>(8)</span></a>
	die folgende Ausgabe:</p><pre class="programlisting" width="97">
      <code class="prompt">#</code> gvinum -&gt; <strong class="userinput"><code>create config1</code></strong>
      Configuration summary
      Drives:         1 (4 configured)
      Volumes:        1 (4 configured)
      Plexes:         1 (8 configured)
      Subdisks:       1 (16 configured)

	D a                     State: up       Device /dev/da3h        Avail: 2061/2573 MB (80%)

	V myvol                 State: up       Plexes:       1 Size:        512 MB

	P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB

	S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB</pre><p>Diese Ausgabe entspricht dem verkürzten
	Ausgabeformat von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=gvinum&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">gvinum</span>(8)</span></a> und wird in
	<a class="xref" href="vinum-examples.html#vinum-simple-vol" title="Abbildung 23.4. Ein einfaches Vinum-Volume">Abbildung 23.4, &#8222;Ein einfaches Vinum-Volume&#8220;</a> grafisch dargestellt.</p><p>
	</p><div class="figure"><a id="vinum-simple-vol"></a><div class="figure-title">Abbildung 23.4. Ein einfaches Vinum-Volume</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-simple-vol.png" alt="Ein einfaches Vinum-Volume" /></div></div></div><p><br class="figure-break" />
      </p><p>Dieses und die folgenden Beispiele zeigen jeweils ein
	Volume, welches die Plexus enthält, die wiederum die
	Subdisk enthalten.  In diesem trivialen Beispiel enthält
	das Volume nur einen Plexus, der wiederum nur aus einer
	Subdisk besteht.</p><p>Eine solche Konfiguration hätte allerdings keinen
	Vorteil gegenüber einer konventionellen Plattenpartion.
	Das Volume enthält nur einen einzigen Plexus, daher
	gibt es keine redundante Datenspeicherung.  Da der Plexus
	außerdem nur  eine einzige Subdisk enthält,
	unterscheidet sich auch die Speicherzuweisung nicht von der
	einer konventionellen Plattenpartition.  Die folgenden
	Abschnitte beschreiben daher verschiedene interessantere
	Konfigurationen.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84206928"></a>23.6.2. Verbesserte Ausfallsicherheit durch Spiegelung</h3></div></div></div><p>Die Ausfallsicherheit eines Volumes kann durch
	Spiegelung der Daten erhöht werden.  Beim Anlegen eines
	gespiegelten Volumes ist es wichtig, die Subdisks jedes
	Plexus auf verschiedene Platten zu verteilen, damit ein
	Plattenausfall nicht beide Plexus unbrauchbar macht.  Die
	folgende Konfiguration spiegelt ein Volume:</p><pre class="programlisting">
	drive b device /dev/da4h
	volume mirror
      plex org concat
        sd length 512m drive a
	  plex org concat
	    sd length 512m drive b</pre><p>Bei diesem Beispiel war es nicht nötig, noch einmal
	eine Platte <span class="emphasis"><em>a</em></span> zu spezifizieren, da
	Vinum die Übersicht über alle Objekte und seine
	Konfigurationsdatenbank behält.  Nach dem Abarbeiten
	dieser Definition sieht die Konfiguration wie folgt aus:</p><pre class="programlisting" width="97">
	Drives:         2 (4 configured)
	Volumes:        2 (4 configured)
	Plexes:         3 (8 configured)
	Subdisks:       3 (16 configured)

	D a                     State: up       Device /dev/da3h        Avail: 1549/2573 MB (60%)
	D b                     State: up       Device /dev/da4h        Avail: 2061/2573 MB (80%)

    V myvol                 State: up       Plexes:       1 Size:        512 MB
    V mirror                State: up       Plexes:       2 Size:        512 MB

    P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p0           C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p1           C State: initializing     Subdisks:     1 Size:        512 MB

    S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB
    S mirror.p0.s0          State: up       PO:        0  B Size:        512 MB
    S mirror.p1.s0          State: empty    PO:        0  B Size:        512 MB</pre><p><a class="xref" href="vinum-examples.html#vinum-mirrored-vol" title="Abbildung 23.5. Ein gespiegeltes Vinum Volume">Abbildung 23.5, &#8222;Ein gespiegeltes Vinum Volume&#8220;</a> stellt diese Struktur
	grafisch dar.</p><p>
	</p><div class="figure"><a id="vinum-mirrored-vol"></a><div class="figure-title">Abbildung 23.5. Ein gespiegeltes Vinum Volume</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-mirrored-vol.png" alt="Ein gespiegeltes Vinum Volume" /></div></div></div><p><br class="figure-break" />
      </p><p>In diesem Beispiel enthält jeder Plexus die vollen
	512 MB des Adressraumes.  Wie im vorangegangenen Beispiel
	enthält jeder Plexus nur eine Subdisk.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84212688"></a>23.6.3. Die Leistung optimieren</h3></div></div></div><p>Das gespiegelte Volume des letzten Beispieles ist
	resistenter gegenüber Fehlern als ein ungespiegeltes
	Volume, seine Leistung ist hingegen schlechter, da jeder
	Schreibzugriff auf das Volume einen Schreibzugriff auf beide
	Platten erfordert und damit mehr der insgesamt verfügbaren
	Datentransferrate  benötigt.  Steht also die optimale
	Leistung im Vordergrund, muss anders vorgegangen werden:
	Statt alle Daten zu spiegeln, werden die Daten über
	so viele Platten wie möglich gestriped.  Die folgende
	Konfiguration zeigt ein Volume
	mit einem über vier Platten hinwegreichenden Plexus:</p><pre class="programlisting">
	drive c device /dev/da5h
	drive d device /dev/da6h
	volume stripe
	plex org striped 512k
	  sd length 128m drive a
	  sd length 128m drive b
	  sd length 128m drive c
	  sd length 128m drive d</pre><p>Wie zuvor ist es nicht nötig, die Platten zu
	definieren, die Vinum schon bekannt sind.  Nach dem Abarbeiten
	dieser Definition sieht die Konfiguration wie folgt aus:</p><pre class="programlisting" width="92">
	Drives:         4 (4 configured)
	Volumes:        3 (4 configured)
	Plexes:         4 (8 configured)
	Subdisks:       7 (16 configured)

    D a                     State: up       Device /dev/da3h        Avail: 1421/2573 MB (55%)
    D b                     State: up       Device /dev/da4h        Avail: 1933/2573 MB (75%)
    D c                     State: up       Device /dev/da5h        Avail: 2445/2573 MB (95%)
    D d                     State: up       Device /dev/da6h        Avail: 2445/2573 MB (95%)

    V myvol                 State: up       Plexes:       1 Size:        512 MB
    V mirror                State: up       Plexes:       2 Size:        512 MB
    V striped               State: up       Plexes:       1 Size:        512 MB

    P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p0           C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p1           C State: initializing     Subdisks:     1 Size:        512 MB
    P striped.p1            State: up       Subdisks:     1 Size:        512 MB

    S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB
    S mirror.p0.s0          State: up       PO:        0  B Size:        512 MB
    S mirror.p1.s0          State: empty    PO:        0  B Size:        512 MB
    S striped.p0.s0         State: up       PO:        0  B Size:        128 MB
    S striped.p0.s1         State: up       PO:      512 kB Size:        128 MB
    S striped.p0.s2         State: up       PO:     1024 kB Size:        128 MB
    S striped.p0.s3         State: up       PO:     1536 kB Size:        128 MB</pre><p>
	</p><div class="figure"><a id="vinum-striped-vol"></a><div class="figure-title">Abbildung 23.6. Ein Striped Vinum Volume</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-striped-vol.png" alt="Ein Striped Vinum Volume" /></div></div></div><p><br class="figure-break" />
      </p><p>Dieses Volume wird in <a class="xref" href="vinum-examples.html#vinum-striped-vol" title="Abbildung 23.6. Ein Striped Vinum Volume">Abbildung 23.6, &#8222;Ein Striped Vinum Volume&#8220;</a>
        dargestellt.  Die Schattierung der Stripes zeigt die Position
	innerhalb des Plexus-Adressraumes an.  Die hellsten Stripes
	kommen zuerst, die dunkelsten zuletzt.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp84217936"></a>23.6.4. Ausfallsicherheit und Leistung</h3></div></div></div><p><a id="vinum-resilience"></a>Mit entsprechender Hardware
	ist es möglich, Volumes zu bauen, welche gegenüber
	Standard-<span class="trademark">UNIX</span>®-Partitionen beides, nämlich erhöhte
	Ausfallsicherheit und erhöhte Leistung, aufweisen
	können.  Eine typische Konfigurationsdatei könnte
	etwa so aussehen:</p><pre class="programlisting">
	volume raid10
      plex org striped 512k
        sd length 102480k drive a
        sd length 102480k drive b
        sd length 102480k drive c
        sd length 102480k drive d
        sd length 102480k drive e
      plex org striped 512k
        sd length 102480k drive c
        sd length 102480k drive d
        sd length 102480k drive e
        sd length 102480k drive a
        sd length 102480k drive b</pre><p>Die Subdisks des zweiten Plexus sind gegenüber denen
	des ersten Plexus um zwei Platten verschoben.  Dadurch wird
	sichergestellt, dass Schreibzugriffe nicht auf den gleichen
	Subdisks auftreten, auch wenn eine Übertragung über
	zwei Platten geht.</p><p><a class="xref" href="vinum-examples.html#vinum-raid10-vol" title="Abbildung 23.7. Ein gespiegeltes, Striped Vinum Volume">Abbildung 23.7, &#8222;Ein gespiegeltes, Striped Vinum Volume&#8220;</a> veranschaulicht die
	Struktur dieses Volumes.</p><p>
	</p><div class="figure"><a id="vinum-raid10-vol"></a><div class="figure-title">Abbildung 23.7. Ein gespiegeltes, Striped Vinum Volume</div><div class="figure-contents"><div class="mediaobject"><img src="vinum/vinum-raid10-vol.png" alt="Ein gespiegeltes, Striped Vinum Volume" /></div></div></div><p><br class="figure-break" />
      </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="vinum-objects.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="vinum-vinum.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="vinum-object-naming.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">23.5. Vinum-Objekte </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 23.7. Objektbenennung</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>