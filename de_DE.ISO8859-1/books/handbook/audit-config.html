<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>18.4. Die Konfiguration des Audit</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="audit.html" title="Kapitel 18. Security Event Auditing" /><link rel="prev" href="audit-install.html" title="18.3. Installation der Audit-Unterstützung" /><link rel="next" href="audit-administration.html" title="18.5. Administration des Audit-Subsystems" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">18.4. Die Konfiguration des Audit</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="audit-install.html">Zurück</a> </td><th width="60%" align="center">Kapitel 18. Security Event Auditing</th><td width="20%" align="right"> <a accesskey="n" href="audit-administration.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="audit-config"></a>18.4. Die Konfiguration des Audit</h2></div></div></div><p>Alle Konfigurationsdateien für das Sicherheits-Audit
      finden sich unter
      <code class="filename">/etc/security</code>.
      Die folgenden Dateien müssen vorhanden sein, bevor
      der Audit-Daemon gestartet wird:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">audit_class</code> &#8211; Enthält
	  die Definitionen der Audit-Klassen.</p></li><li class="listitem"><p><code class="filename">audit_control</code> &#8211; Steuert
	  Teile des Audit-Subsystems wie Audit-Klassen, minimaler
	  Plattenplatz auf dem Audit-Log-Datenträger, maximale
	  Größe des Audit-Pfades usw.</p></li><li class="listitem"><p><code class="filename">audit_event</code> &#8211; Wörtliche
	  Namen und Beschreibungen von System-Audit-Ereignissen sowie
	  eine Liste, welche Klassen welches Ereignis
	  aufzeichnen.</p></li><li class="listitem"><p><code class="filename">audit_user</code> &#8211; Benutzerspezifische
	  Audit-Erfordernisse, welche mit den globalen Vorgaben bei
	  der Anmeldung kombiniert werden.</p></li><li class="listitem"><p><code class="filename">audit_warn</code> &#8211; Ein
	  anpassbares Shell-Skript, welches von
	  <span class="application">auditd</span> benutzt wird, um
	  Warnhinweise in aussergewöhnlichen Situationen zu
	  erzeugen, z.B. wenn der Platz für die
	  Audit-Datensätze knapp wird oder wenn die Datei des
	  Audit-Pfades rotiert wurde.</p></li></ul></div><div xmlns="" class="warning"><h3 class="admontitle">Warnung: </h3><p xmlns="http://www.w3.org/1999/xhtml">Audit-Konfigurationsdateien sollten vorsichtig gewartet und
	bearbeitet werden, da Fehler in der Konfiguration zu falscher
	Aufzeichnung von Ereignissen führen könnten.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80599376"></a>18.4.1. Ereignis-Auswahlausdrücke</h3></div></div></div><p>Auswahlausdrücke werden an einigen Stellen
	der Audit-Konfiguration benützt, um zu bestimmen,
	welche Ereignisse auditiert werden sollen. Die Ausdrücke
	enthalten eine Liste der Ereignisklassen, welche verglichen
	werden sollen, jede mit einem Präfix, welches anzeigt,
	ob verglichene Datensätze akzeptiert oder ignoriert
	werden sollen und optional, um anzuzeigen, ob der Eintrag
	beabsichtigt, erfolgreiche oder fehlgeschlagene Operationen
	zu vergleichen. Auswahlausdrücke werden von links nach
	rechts ausgewertet und zwei Ausdrücke werden durch
	Aneinanderhängen miteinander kombiniert.</p><p>Die folgende Liste enthält die
	Standard-Ereignisklassen für das Audit und ist in
	<code class="filename">audit_class</code> festgehalten:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">all</code> &#8211; <span class="emphasis"><em>all</em></span> &#8211; Vergleiche
	      alle Ereignisklassen.</p></li><li class="listitem"><p><code class="literal">ad</code> &#8211; <span class="emphasis"><em>administrative</em></span> &#8211; Administrative
	    Aktionen ausgeführt auf dem System als Ganzes.</p></li><li class="listitem"><p><code class="literal">ap</code> &#8211; <span class="emphasis"><em>application</em></span> &#8211; Aktionen
	    definiert für Applikationen.</p></li><li class="listitem"><p><code class="literal">cl</code> &#8211; <span class="emphasis"><em>file
	    close</em></span> &#8211; Audit-Aufrufe für
	    den Systemaufruf <code class="function">close</code>.</p></li><li class="listitem"><p><code class="literal">ex</code> &#8211; <span class="emphasis"><em>exec</em></span> &#8211; Ausführung
	    des Audit-Programms. Auditierung von
	    Befehlszeilen-Argumenten und Umgebungsvariablen wird
	    gesteuert durch <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=audit_control&amp;sektion=5"><span class="citerefentry"><span class="refentrytitle">audit_control</span>(5)</span></a> mittels der
	    <code class="literal">argv</code> und
	    <code class="literal">envv</code>-Parametergemäss der
	    <code class="literal">Richtlinien</code>-Einstellungen.</p></li><li class="listitem"><p><code class="literal">fa</code> &#8211; <span class="emphasis"><em>file
	    attribute access</em></span> &#8211; Auditierung
	    des Zugriffs auf Objektattribute wie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=stat&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">stat</span>(1)</span></a>,
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=pathconf&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">pathconf</span>(2)</span></a> und ähnlichen Ereignissen.</p></li><li class="listitem"><p><code class="literal">fc</code> &#8211; <span class="emphasis"><em>file
	    create</em></span> &#8211; Audit-Ereignisse,
	    bei denen eine Datei als Ergebnis angelegt wird.</p></li><li class="listitem"><p><code class="literal">fd</code> &#8211; <span class="emphasis"><em>file
	    delete</em></span> &#8211; Audit-Ereignisse,
	    bei denen Dateilöschungen vorkommen.</p></li><li class="listitem"><p><code class="literal">fm</code> &#8211; <span class="emphasis"><em>file
	    attribute modify</em></span> &#8211; Audit-Ereignisse,
	    bei welchen Dateiattribute geändert werden, wie
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chown&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">chown</span>(8)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=chflags&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">chflags</span>(1)</span></a>, <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=flock&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">flock</span>(2)</span></a> etc.</p></li><li class="listitem"><p><code class="literal">fr</code> &#8211; <span class="emphasis"><em>file
	    read</em></span> &#8211; Audit-Ereignisse, bei
	    denen Daten gelesen oder Dateien zum lesen geöffnet
	    werden usw.</p></li><li class="listitem"><p><code class="literal">fw</code> &#8211; <span class="emphasis"><em>file write</em></span> &#8211; Audit-Ereignisse,
	    bei welchen Daten geschrieben oder Dateien geschrieben
	    oder verändert werden usw.</p></li><li class="listitem"><p><code class="literal">io</code> &#8211; <span class="emphasis"><em>ioctl</em></span> &#8211; Nutzung
	    des Systemaufrufes <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ioctl&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a> durch Audit.</p></li><li class="listitem"><p><code class="literal">ip</code> &#8211; <span class="emphasis"><em>ipc</em></span> &#8211; Auditierung
	    verschiedener Formen von Inter-Prozess-Kommunikation
	    einschliesslich POSIX-Pipes und System V
	    <acronym class="acronym">IPC</acronym>-Operationen.</p></li><li class="listitem"><p><code class="literal">lo</code> &#8211; <span class="emphasis"><em>login_logout</em></span> &#8211; Audit-Ereignisse
	    betreffend <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=login&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">login</span>(1)</span></a> und <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=logout&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">logout</span>(1)</span></a>, welche auf
	    dem System auftreten.</p></li><li class="listitem"><p><code class="literal">na</code> &#8211; <span class="emphasis"><em>non
	    attributable</em></span> &#8211; Auditierung
	    nicht-attributierbarer Ereignisse (Ereignisse, die nicht auf
	    einen bestimmten Benutzer zurückgeführt werden
	    können).</p></li><li class="listitem"><p><code class="literal">no</code> &#8211; <span class="emphasis"><em>invalid
	    class</em></span> &#8211; Kein Abgleich von
	    Audit-Ereignissen.</p></li><li class="listitem"><p><code class="literal">nt</code> &#8211; <span class="emphasis"><em>network</em></span> &#8211; Audit-Ereignisse
	    in Zusammenhang mit Netzwerkaktivitäten wie
	    z.B. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=connect&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">connect</span>(2)</span></a> und <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=accept&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>.</p></li><li class="listitem"><p><code class="literal">ot</code> &#8211; <span class="emphasis"><em>other</em></span> &#8211; Auditierung
	    verschiedener Ereignisse.</p></li><li class="listitem"><p><code class="literal">pc</code> &#8211; <span class="emphasis"><em>process</em></span> &#8211; Auditierung
	    von Prozess-Operationen wie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exec&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">exec</span>(3)</span></a> und
	    <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=exit&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">exit</span>(3)</span></a>.</p></li></ul></div><p>Diese Ereignisklassen können angepasst werden durch
	Modifizierung der Konfigurationsdateien
	<code class="filename">audit_class</code> und
	<code class="filename">audit_event</code>.</p><p>Jede Audit-Klasse in dieser Liste ist kombiniert mit
	einem Präfix, welches anzeigt, ob
	erfolgreiche/gescheiterte Operationen abgebildet werden, und
	ob der Eintrag den Abgleich hinzufügt oder entfernt
	für die Klasse und den Typ.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>(none) Kein Präfix, sowohl erfolgreiche als
	    auch gescheiterte Vorkommen eines Ereignisses werden
	    auditiert.</p></li><li class="listitem"><p><code class="literal">+</code> Auditiere nur erfolgreiche
	    Ereignisse in dieser Klasse.</p></li><li class="listitem"><p><code class="literal">-</code> Auditiere nur gescheiterte
	    Operationen in dieser Klasse.</p></li><li class="listitem"><p><code class="literal">^</code> Auditiere weder erfolgreiche
	    noch gescheiterte Ereignisse in dieser Klasse.</p></li><li class="listitem"><p><code class="literal">^+</code> Auditiere keine erfolgreichen
	    Ereignisse in dieser Klasse.</p></li><li class="listitem"><p><code class="literal">^-</code> Auditiere keine gescheiterten
	    Ereignisse in dieser Klasse.</p></li></ul></div><p>Das folgende Beispiel einer Auswahl-Zeichenkette
	wählt erfolgreiche und gescheiterte
	Anmelde/Abmelde-Ereignisse aus, aber nur erfolgreich beendete
	Ausführungs-Ereignisse:</p><pre class="programlisting">lo,+ex</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp80662224"></a>18.4.2. Konfigurationsdateien</h3></div></div></div><p>In den meisten Fällen müssen Administratoren
	nur zwei Dateien ändern, wenn sie das Audit-System
	konfigurieren: <code class="filename">audit_control</code> und
	<code class="filename">audit_user</code>. Die erste Datei steuert
	systemweite Audit-Eigenschaften und -Richtlinien; die zweite
	Datei kann für die Feinanpassung der Auditierung von
	Benutzern verwendet werden.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="audit-auditcontrol"></a>18.4.2.1. Die <code class="filename">audit_control</code>-Datei</h4></div></div></div><p>Die <code class="filename">audit_control</code>-Datei legt eine
	  Anzahl Vorgabewerte fest:</p><pre class="programlisting">dir:/var/audit
flags:lo
minfree:20
naflags:lo
policy:cnt
filesz:0</pre><p>Die Option <code class="option">dir</code> wird genutzt, um eines
	  oder mehrere Verzeichnisse festzulegen, in welchen
	  Audit-Protokolle gespeichert werden. Gibt es mehrere
	  Verzeichniseinträge, werden diese in der
	  angegebenen Reihenfolge genutzt, bis sie jeweils
	  gefüllt sind. Es ist üblich, Audit so zu
	  konfigurieren, dass die Audit-Logs auf einem dedizierten
	  Dateisystem abgelegt werden, um Wechselwirkungen zwischen
	  dem Audit-Subsystem und anderen Subsystemen zu verhindern,
	  falls das Dateisystem voll läuft.</p><p>Das <code class="option">flags</code>-Feld legt die systemweite
	  Standard-Vorauswahl-Maske für attributierbare (direkt
	  einem Benutzer zuordenbare) Ereignisse fest. Im
	  obigen Beispiel werden alle gescheiterten und erfolgreichen
	  Anmelde- und Abmelde-Ereignisse für alle Benutzer
	  aufgezeichnet.</p><p>Die Option <code class="option">minfree</code> definiert den
	  minimalen Prozentsatz an freiem Plattenplatz für das
	  Dateisystem, in welchem der Audit-Pfad abgespeichert wird.
	  Wenn diese Schwelle überschritten ist, wird ein
	  Warnhinweis erzeugt. Das obige Beispiel legt den minimalen
	  freien Platz auf zwanzig Prozent fest.</p><p>Die <code class="option">naflags</code>-Option bestimmt diejenigen
	  Audit-Klassen, für die nicht-attributierbare Ereignisse
	  aufgezeichnet werden sollen (beispielsweise Anmeldeprozesse
	  und System-Daemonen.</p><p>Die Option <code class="option">policy</code> legt eine durch Kommata
	  getrennte Liste von policy-Flags fest, welche verschiedene
	  Aspekte des Audit-Verhaltens steuern. Der vorgegebene Flag
	  <code class="literal">cnt</code> zeigt an, dass das System trotz eines
	  Audit-Fehlers weiterlaufen soll (dieses Flag wird dringend
	  angeraten). Ein anderes, häufig genutztes Flag ist
	  <code class="literal">argv</code>, welches dazu führt, dass
	  Befehlszeilen-Argumente für den Systemauruf
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=execve&amp;sektion=2"><span class="citerefentry"><span class="refentrytitle">execve</span>(2)</span></a> als Teil der Befehlsausführung
	  aufgezeichnet werden.</p><p>Die <code class="option">filesz</code>-Option spezifiziert die
	  maximale Größe in Bytes, welche eine
	  Audit-Pfad-Datei wachsen darf, bevor sie automatisch beendet
	  und rotiert wird. Die Standardvorgabe <code class="literal">0</code>
	  setzt die automatische Log-Rotation ausser Kraft. Falls die
	  angeforderte Dateigröße größer Null
	  und gleichzeitig unterhalb des Minimums von 512K ist, dann
	  wird die Angabe verworfen und ein Log-Hinweis wird
	  erzeugt.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="audit-audituser"></a>18.4.2.2. Die Datei <code class="filename">audit_user</code></h4></div></div></div><p>Die <code class="filename">audit_user</code>-Datei erlaubt es dem
	  Administrator, weitere Audit-Erfordernisse für bestimmte
	  Benutzer festzulegen. Jede Zeile konfiguriert das Auditing
	  für einen Benutzer über zwei Felder: Das erste Feld
	  ist <code class="literal">alwaysaudit</code>, welches eine Ansammlung
	  von Ereignissen vorgibt, welche immer für diesen Benutzer
	  aufgezeichnet werden. Das zweite Feld
	  <code class="literal">neveraudit</code> legt eine Menge an Ereignissen
	  fest, die niemals für diesen Benutzer auditiert werden
	  sollen.</p><p>Das folgende Beispiel einer
	  <code class="filename">audit_user</code>-Datei zeichnet
	  Anmelde/Abmelde-Ereignisse, erfolgreiche
	  Befehlsausführungen für den Benutzer
	  <code class="systemitem">root</code>, Anlegen von Dateien und
	  erfolgreiche Befehlsausführungen für den Benutzer
	  <code class="systemitem">www</code> auf. Falls das Beispiel zusammen
	  mit der vorstehend als Beispiel gezeigten Datei
	  <code class="filename">audit_control</code> benutzt wird, dann ist
	  der Eintrag <code class="literal">lo</code> für <code class="systemitem">root</code> überflüssig und
	  Anmelde/Abmelde-Ereignisse werden für <code class="systemitem">www</code> ebenfalls
	  aufgezeichnet.</p><pre class="programlisting">root:lo,+ex:no
www:fc,+ex:no</pre></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="audit-install.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="audit.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="audit-administration.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">18.3. Installation der Audit-Unterstützung </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 18.5. Administration des Audit-Subsystems</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>