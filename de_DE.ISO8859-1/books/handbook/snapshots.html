<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>19.14. Schnappschüsse von Dateisystemen</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Das FreeBSD-Handbuch" /><link rel="up" href="disks.html" title="Kapitel 19. Speichermedien" /><link rel="prev" href="disks-virtual.html" title="19.13. Netzwerk-, speicher- und dateibasierte Dateisysteme" /><link rel="next" href="quotas.html" title="19.15. Dateisystem-Quotas" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">19.14. Schnappschüsse von Dateisystemen</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="disks-virtual.html">Zurück</a> </td><th width="60%" align="center">Kapitel 19. Speichermedien</th><td width="20%" align="right"> <a accesskey="n" href="quotas.html">Weiter</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="snapshots"></a>19.14. Schnappschüsse von Dateisystemen</h2></div><div><span class="authorgroup">Beigetragen von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><a id="idp81854032" class="indexterm"></a><p>Zusammen mit <a class="link" href="configtuning-disk.html#soft-updates" title="12.13.2. Soft Updates">Soft Updates</a>
      bietet FreeBSD eine neue Funktion:  Schnappschüsse von
      Dateisystemen.</p><p>Schnappschüsse sind Dateien, die ein Abbild eines
      Dateisystems enthalten und müssen auf dem jeweiligen
      Dateisystem erstellt werden.  Pro Dateisystem darf es maximal
      20 Schnappschüsse, die im Superblock vermerkt werden, geben.
      Schnappschüsse bleiben erhalten, wenn das Dateisystem abgehangen,
      neu eingehangen oder das System neu gestartet wird.  Wenn Sie einen
      Schnappschuss nicht mehr benötigen, können Sie ihn
      mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rm&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">rm</span>(1)</span></a> löschen.  Es ist egal, in welcher Reihenfolge
      Schnappschüsse gelöscht werden.  Es kann allerdings
      vorkommen, dass nicht der gesamte Speicherplatz
      wieder freigegeben wird, da ein anderer
      Schnappschuss einen Teil der entfernten Blöcke für sich
      beanspruchen kann.</p><p>Das unveränderliche <code class="option">Snapshot</code>-Dateiflag
      wird nach der Erstellung des Snaphshots von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mksnap_ffs</span>(8)</span></a>
      gesetzt.  Durch die Verwendung von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=unlink&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">unlink</span>(1)</span></a> ist es allerdings
      möglich, einen Schnappschuss zu löschen.</p><p>Schnappschüsse werden mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mount&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mount</span>(8)</span></a> erstellt.  Das
      folgende Kommando legt einen Schnappschuss von
      <code class="filename">/var</code> in <code class="filename">/var/snapshot/snap</code>
      ab:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount -u -o snapshot /var/snapshot/snap /var</code></strong></pre><p>Den Schnappschuss können Sie auch mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">mksnap_ffs</span>(8)</span></a>
      erstellen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mksnap_ffs /var /var/snapshot/snap</code></strong></pre><p>Um einen Schnappschuss auf Ihrem System zu finden, verwenden
      Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=find&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">find</span>(1)</span></a>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>find /var -flags snapshot</code></strong></pre><p>Nachdem ein Schnappschuss erstellt wurde, können Sie
      ihn für verschiedene Zwecke benutzen:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Sie können den Schnappschuss für die
	  Datensicherung benutzen und ihn auf eine CD oder ein Band
	  schreiben.</p></li><li class="listitem"><p>Sie können den Schnappschuss mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a>
	  manuell prüfen.  Wenn das Dateisystem zum Zeitpunkt der
	  Erstellung des Schnappschusses in Ordnung war, sollte
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a> immer erfolgreich durchlaufen.  Der
	  Hintergrund-Prozess <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a> hat im Übrigen genau
	  diese Aufgabe.</p></li><li class="listitem"><p>Sie können den Schnappschuss mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a>
	  sichern.  Sie erhalten dann eine konsistente Sicherung des
	  Dateisystems zu dem Zeitpunkt, der durch den Zeitstempel des
	  Schnappschusses gegeben ist.  Der Schalter <code class="option">-L</code>
	  von <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a> erstellt für die Sicherung einen
	  Schnappschuss und entfernt diesen am Ende der Sicherung
	  wieder.</p></li><li class="listitem"><p>Sie können einen Schnappschuss in den
	  Verzeichnisbaum einhängen und sich dann den Zustand des
	  Dateisystems zu dem Zeitpunkt ansehen, an dem der
	  Schnappschuss erstellt wurde.  Der folgende Befehl
	  hängt den Schnappschuss
	  <code class="filename">/var/snapshot/snap</code> ein:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mdconfig -a -t vnode -f /var/snapshot/snap -u 4</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mount -r /dev/md4 /mnt</code></strong></pre></li></ul></div><p>Sie können sich nun den eingefrorenen Stand des
      <code class="filename">/var</code> Dateisystems unterhalb von
      <code class="filename">/mnt</code> ansehen.  Mit Ausnahme der früheren
      Schnappschüsse, die als leere Dateien auftauchen, wird zu
      Beginn alles so aussehen, wie zum Zeitpunkt der Erstellung des
      Schnappschusses.  Wenn Sie den Schnappschuss nicht mehr
      benötigen, können Sie ihn, wie nachfolgend gezeigt,
      abhängen:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>umount /mnt</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>mdconfig -d -u 4</code></strong></pre><p>Weitere Informationen über Soft Updates und
      Schnappschüsse von Dateisystemen sowie technische Artikel finden
      Sie auf der <a class="link" href="http://www.mckusick.com/" target="_top">Webseite
        von Marshall Kirk McKusick</a>.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="disks-virtual.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="disks.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="quotas.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">19.13. Netzwerk-, speicher- und dateibasierte Dateisysteme </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> 19.15. Dateisystem-Quotas</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>