<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>Kapitel 6. Regressions- und Performance-Tests</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD Developers' Handbook" /><link rel="up" href="Basics.html" title="Teil I. Grundlagen" /><link rel="prev" href="policies-shlib.html" title="5.5. Shared-Libraries" /><link rel="next" href="ipc.html" title="Teil II. Interprozess-Kommunikation" /><link rel="copyright" href="legalnotice.html" title="Rechtlicher Hinweis" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Kapitel 6. Regressions- und Performance-Tests</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="policies-shlib.html">Zurück</a> </td><th width="60%" align="center">Teil I. Grundlagen</th><td width="20%" align="right"> <a accesskey="n" href="ipc.html">Weiter</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="testing"></a>Kapitel 6. Regressions- und Performance-Tests</h2></div><div><span class="authorgroup">Übersetzt von <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Jürgen</span> <span class="surname">Lock</span></span>. </span></div></div></div><div class="toc"><div class="toc-title">Inhaltsverzeichnis</div><dl class="toc"><dt><span class="section"><a href="testing.html#testing-micro-benchmark">6.1. Mikro-Benchmark-Checkliste</a></span></dt></dl></div><p>Regressions-Tests werden durchgeführt, um zu überprüfen,
    ob ein bestimmter Teil des Systems wie erwartet funktioniert, und
    um sicherzustellen, dass bereits beseitigte Fehler nicht wieder eingebaut
    werden.</p><p>Die FreeBSD-Regressions-Testwerkzeuge finden Sie im
    FreeBSD-Quelltextbaum unter <code class="filename">src/tools/regression</code>.</p><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="testing-micro-benchmark"></a>6.1. Mikro-Benchmark-Checkliste</h2></div></div></div><p>Dieser Abschnitt enthält Tipps, wie
      ordnungsgemäße Mikro-Benchmarks unter FreeBSD oder für
      FreeBSD selbst erstellt werden.</p><p>Es ist nicht möglich, immer alle der folgenden
      Vorschläge zu berücksichtigen, aber je mehr davon,
      desto besser wird der Benchmark kleine
      Unterschiede nachweisen können.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Schalten Sie <acronym class="acronym">APM</acronym> und alles andere,
	  das den Systemtakt beeinflusst, ab
	  (<acronym class="acronym">ACPI</acronym>?).</p></li><li class="listitem"><p>Starten Sie in den Single-User-Modus. <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=cron&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">cron</span>(8)</span></a>
	  und andere Systemdienste verursachen nur Störungen.
	  Genauso der <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=sshd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">sshd</span>(8)</span></a>-Systemdienst.
	  Falls während des Tests
	  SSH-Zugriff benötigt wird, schalten Sie entweder die
	  Neuerstellung des SSHv1-Schlüssels ab oder beenden Sie
	  den <code class="command">sshd</code>-Elternprozess während der
	  Tests.</p></li><li class="listitem"><p>Beenden Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a>.</p></li><li class="listitem"><p>Falls <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslog&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">syslog</span>(3)</span></a>-Ereignisse erzeugt werden,
	  starten Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">syslogd</span>(8)</span></a> mit leerer
	  <code class="filename">/etc/syslogd.conf</code> oder beenden Sie
	  es.</p></li><li class="listitem"><p>Sorgen Sie für möglichst wenig Disk-I/O;
	  vermeiden Sie es ganz wenn möglich.</p></li><li class="listitem"><p>Hängen Sie keine Dateisysteme ein, die Sie nicht
	  benötigen.</p></li><li class="listitem"><p>Hängen Sie <code class="filename">/</code>, <code class="filename">/usr</code> und die anderen
	  Dateisysteme nur lesbar ein wenn möglich. Dies
	  verhindert, dass atime-Aktualisierungen auf der Festplatte (usw.) das
	  Ergebnis verfälschen.</p></li><li class="listitem"><p>Initialisieren Sie das beschreibbare
	  Test-Dateisystem mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">newfs</span>(8)</span></a> neu und füllen Sie es
	  aus einer <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=tar&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">tar</span>(1)</span></a>- oder <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dump&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">dump</span>(8)</span></a>-Datei vor jedem
	  Lauf. Hängen Sie es aus und wieder ein, bevor Sie den
	  Test starten. Dies sorgt für einen konsistenten
	  Dateisystemaufbau. Bei einem <span class="quote">&#8222;<span class="quote">worldstone</span>&#8220;</span>-Test
	  bezieht sich dies auf <code class="filename">/usr/obj</code> (Initialisieren Sie
	  es einfach mit <code class="command">newfs</code> neu und hängen Sie
	  es ein). Um absolut reproduzierbare Ergebnisse zu bekommen,
	  füllen Sie das Dateisystem aus einer <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=dd&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">dd</span>(1)</span></a>-Datei
	  (d.h. <code class="command">dd
	  if=myimage of=/dev/ad0s1h
	  bs=1m</code>).</p></li><li class="listitem"><p>Benutzen Sie malloc-gestützte oder vorbelastete
	  <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=md&amp;sektion=4"><span class="citerefentry"><span class="refentrytitle">md</span>(4)</span></a>-Partitionen.</p></li><li class="listitem"><p>Starten Sie zwischen den einzelnen
	  Durchläufen neu, dies sichert einen konsistenteren
	  Zustand.</p></li><li class="listitem"><p>Entfernen Sie alle nicht unbedingt benötigten
	  Gerätetreiber aus dem Kernel. Wenn z.B. USB für
	  den Test nicht benötigt wird, entfernen Sie es aus dem
	  Kernel. Gerätetreiber, die sich Hardware zuteilen, haben
	  oft <span class="quote">&#8222;<span class="quote">tickende</span>&#8220;</span> Timeouts.</p></li><li class="listitem"><p>Konfigurieren Sie nicht Hardware, die
	  nicht benutzt wird. Entfernen Sie Festplatten
	  mit <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=atacontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">atacontrol</span>(8)</span></a> und <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=camcontrol&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">camcontrol</span>(8)</span></a>, wenn diese
	  für den Test nicht gebraucht werden.</p></li><li class="listitem"><p>Konfigurieren Sie nicht das Netzwerk, es sei denn es
	  wird getestet, oder warten Sie, bis der Test fertig ist, wenn
	  Sie das Ergebnis auf einen anderen Rechner übertragen
	  wollen.</p><p>Falls das System an ein öffentliches Netzwerk
	  angeschlossen sein muss, achten Sie auf Spitzen im
	  Broadcast-Verkehr. Obwohl dieser kaum auffällt, wird
	  er CPU-Zyklen brauchen. Ähnliches gilt für
	  Multicast.</p></li><li class="listitem"><p>Legen Sie jedes Dateisystem auf eine eigene Festplatte.
	  Dies minimiert Jitter durch Optimierungen von
	  Lesekopfbewegungen.</p></li><li class="listitem"><p>Minimieren Sie Ausgaben auf serielle oder VGA-Konsolen.
	  Ausgabenumleitung in Dateien ergibt weniger Jitter
	  (serielle Konsolen werden leicht zum Flaschenhals).
	  Benutzen Sie die Tastatur nicht, während der Test
	  läuft, sogar <span class="keycap"><strong>space</strong></span> oder
	  <span class="keycap"><strong>back-space</strong></span> wirken sich auf die
	  Ergebnisse aus.</p></li><li class="listitem"><p>Stellen Sie sicher, dass der Test lang genug
	  läuft, aber nicht zu lange. Wenn er zu kurz ist, sind
	  Zeitstempel ein Problem. Wenn er zu lang ist, werden
	  Temperaturänderungen und Drift die Frequenz von
	  Quarzkristallen im Rechner beeinflussen. Daumenregel: mehr
	  als eine Minute, weniger als eine Stunde.</p></li><li class="listitem"><p>Versuchen Sie, die Temperatur in der Umgebung des
	  Rechners so stabil wie möglich zu halten. Diese beeinflusst
	  sowohl Quarzkristalle als auch Festplatten-Algorithmen.
	  Um einen wirklich stabilen Takt zu erhalten, wäre es auch
	  möglich, einen stabilisierten Takt anzuschließen.
	  D.h. besorgen Sie sich einen OCXO + PLL und koppeln Sie das
	  Ausgangssignal mit den Taktgeberschaltkreisen anstelle des
	  Quarzkristalls der Hauptplatine. Wenden Sie sich an
	  Poul-Henning Kamp, wenn Sie mehr Informationen hierüber
	  benötigen.</p></li><li class="listitem"><p>Lassen Sie den Test mindestens drei Mal laufen, besser
	  mehr als 20 Mal, sowohl
	  für <span class="quote">&#8222;<span class="quote">vor</span>&#8220;</span> als auch für
	  <span class="quote">&#8222;<span class="quote">nach</span>&#8220;</span> dem Code. Versuchen Sie abzuwechseln
	  (d.h. nicht erst 20 Mal <span class="quote">&#8222;<span class="quote">vorher</span>&#8220;</span> und dann 20
	  Mal <span class="quote">&#8222;<span class="quote">nachher</span>&#8220;</span>), dies ermöglicht,
	  umgebungsbedingte Effekte zu erkennen. Wechseln Sie nicht
	  1:1 ab, sondern 3:3; dies erlaubt,
	  Wechselwirkungseffekte zu erkennen.</p><p>Ein gutes Muster ist:
	  <code class="literal">bababa{bbbaaa}*</code>. Dies gibt Hinweise nach
	  den ersten 1+1-Läufen (sodass Sie den Test stoppen
	  können, falls er völlig daneben geht), Sie
	  können die Standardabweichung nach den ersten 3+3-Läufen
	  überprüfen (zeigt an, ob sich ein
	  längerer Lauf lohnt), später
	  Trends und Wechselwirkungen.</p></li><li class="listitem"><p>Benutzen Sie <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=ministat&amp;sektion=1"><span class="citerefentry"><span class="refentrytitle">ministat</span>(1)</span></a>, um
	  festzustellen, ob Ihre Ergebnisse signifikant sind.
	  Überlegen Sie sich, das Buch <span class="quote">&#8222;<span class="quote">Cartoon guide to
	  statistics</span>&#8220;</span> ISBN: 0062731025 zu kaufen. Es ist sehr
	  empfehlenswert, falls Sie Dinge wie Standardabweichung und
	  Studentsche t-Verteilung vergessen oder nie gelernt
	  haben.</p></li><li class="listitem"><p>Benutzen Sie keinen Hintergrund-<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">fsck</span>(8)</span></a>, wenn Sie
	  ihn nicht selbst testen
	  wollen. Schalten Sie auch <code class="varname">background_fsck</code>
	  in <code class="filename">/etc/rc.conf</code> aus, es sei denn der
	  Benchmark wird nicht mindestens 60+<span class="quote">&#8222;<span class="quote">Laufzeit von
	  <code class="command">fsck</code></span>&#8220;</span> Sekunden nach Systemstart
	  gestartet, da <a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=rc&amp;sektion=8"><span class="citerefentry"><span class="refentrytitle">rc</span>(8)</span></a> startet und prüft, ob
	  <code class="command">fsck</code> auf irgendeinem der Dateisysteme
	  laufen muss, wenn Hintergrund-<code class="command">fsck</code>
	  eingeschaltet ist. Stellen Sie ebenfalls sicher, dass keine
	  Snapshots herumliegen, falls der Benchmark nicht ein Test
	  mit Snapshots ist.</p></li><li class="listitem"><p>Falls der Benchmark unerwartet schlechte Performance
	  zeigt, überprüfen Sie Dinge wie große Mengen
	  Interrupts von unerwarteten Quellen. Es gibt Berichte, dass
	  einige <acronym class="acronym">ACPI</acronym>-Versionen sich <span class="quote">&#8222;<span class="quote">daneben
	  benehmen</span>&#8220;</span> und ein Übermaß an Interrupts
	  erzeugen. Um zu helfen, ungewöhnliche Testergebnisse zu
	  diagnostizieren, machen Sie ein paar Momentaufnahmen von
	  <code class="command">vmstat -i</code> und suchen Sie nach
	  Ungewöhnlichem.</p></li><li class="listitem"><p>Gehen Sie mit Parametern zur Optimierung
	  von Kernel, Userland und Fehlersuche vorsichtig um.
	  Es passiert schnell, irgendetwas durchrutschen zu
	  lassen und dann später festzustellen, dass der Test
	  nicht das gleiche verglichen hat.</p></li><li class="listitem"><p>Erstellen Sie nie Benchmarks unter Verwendung der Kernel-Optionen
	  <code class="literal">WITNESS</code> und <code class="literal">INVARIANTS</code>,
	  wenn der Test nicht diese Merkmale selbst
	  untersuchen soll. <code class="literal">WITNESS</code> kann zu 400% und
	  mehr Performance-Abnahme führen. Ähnliches gilt
	  für Userland-<a class="citerefentry" href="http://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=3"><span class="citerefentry"><span class="refentrytitle">malloc</span>(3)</span></a>-Parameter, Voreinstellungen
	  hierbei unterscheiden sich bei -CURRENT von denen bei
	  Production-Releases.</p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="policies-shlib.html">Zurück</a> </td><td width="20%" align="center"><a accesskey="u" href="Basics.html">Nach oben</a></td><td width="40%" align="right"> <a accesskey="n" href="ipc.html">Weiter</a></td></tr><tr><td width="40%" align="left" valign="top">5.5. Shared-Libraries </td><td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td><td width="40%" align="right" valign="top"> Teil II. Interprozess-Kommunikation</td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>Wenn Sie Fragen zu FreeBSD haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-questions@de.FreeBSD.org">de-bsd-questions@de.FreeBSD.org</a>&gt;.<br></br>
    Wenn Sie Fragen zu dieser Dokumentation haben, schicken Sie eine E-Mail an
    &lt;<a href="mailto:de-bsd-translators@de.FreeBSD.org">de-bsd-translators@de.FreeBSD.org</a>&gt;.</small></p></body></html>